{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3037970234329501, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.398643290996551, "policy_loss": -0.006770441914947393, "vf_loss": 9.403709109624227, "vf_explained_var": 0.034282246977090834, "kl": 0.008595146147960501, "entropy": 1.4429272968322038, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -149.50351134807633, "episode_reward_min": -1163.6781251356276, "episode_reward_mean": -693.8548436806035, "episode_len_mean": 136.55555555555554, "episode_media": {}, "episodes_timesteps_total": 3687, "policy_reward_min": {"policy_0": -1163.6781251356276}, "policy_reward_max": {"policy_0": -149.50351134807633}, "policy_reward_mean": {"policy_0": -693.8548436806035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-928.220396323472, -401.3274380621455, -1011.8157757430652, -1058.3950402905289, -513.6637050966888, -801.137678035525, -702.8206320414464, -621.5012592035753, -149.50351134807633, -450.98575885827944, -1163.6781251356276, -979.3723316394246, -153.89136428163818, -1124.3721211839752, -400.7202974690253, -675.6783294999789, -234.2587454973742, -1120.371345194702, -295.81582116164464, -1058.438605854, -955.6320844549883, -269.09282205895653, -227.52146473059943, -950.7848895916784, -857.6471250997799, -686.491596593177, -940.9425149269234], "episode_lengths": [150, 139, 150, 150, 121, 150, 150, 131, 62, 109, 150, 150, 114, 150, 150, 150, 137, 150, 90, 150, 150, 84, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-928.220396323472, -401.3274380621455, -1011.8157757430652, -1058.3950402905289, -513.6637050966888, -801.137678035525, -702.8206320414464, -621.5012592035753, -149.50351134807633, -450.98575885827944, -1163.6781251356276, -979.3723316394246, -153.89136428163818, -1124.3721211839752, -400.7202974690253, -675.6783294999789, -234.2587454973742, -1120.371345194702, -295.81582116164464, -1058.438605854, -955.6320844549883, -269.09282205895653, -227.52146473059943, -950.7848895916784, -857.6471250997799, -686.491596593177, -940.9425149269234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2792928852397558, "mean_inference_ms": 0.8630954194577122, "mean_action_processing_ms": 0.15941582082373681, "mean_env_wait_ms": 1.5109586127010393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005694671913429543, "StateBufferConnector_ms": 0.004482269287109375, "ViewRequirementAgentConnector_ms": 0.09518905922218605}, "num_episodes": 27, "episode_return_max": -149.50351134807633, "episode_return_min": -1163.6781251356276, "episode_return_mean": -693.8548436806035, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.16222569751085, "num_env_steps_trained_throughput_per_sec": 284.16222569751085, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 14076.477, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14076.421, "sample_time_ms": 2310.417, "learn_time_ms": 11745.228, "learn_throughput": 340.564, "synch_weights_time_ms": 20.027}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00003", "date": "2024-08-03_04-38-26", "timestamp": 1722640106, "time_this_iter_s": 14.083226203918457, "time_total_s": 14.083226203918457, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814f6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14.083226203918457, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.057142857142857, "ram_util_percent": 16.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.468077127697567, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.535910601417223, "policy_loss": -0.007951571717664288, "vf_loss": 9.54177417854468, "vf_explained_var": 0.1353703413779537, "kl": 0.01051706115965014, "entropy": 1.543703430891037, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -24.604924965204923, "episode_reward_min": -1215.1332508130065, "episode_reward_mean": -697.746322825144, "episode_len_mean": 132.1551724137931, "episode_media": {}, "episodes_timesteps_total": 7665, "policy_reward_min": {"policy_0": -1215.1332508130065}, "policy_reward_max": {"policy_0": -24.604924965204923}, "policy_reward_mean": {"policy_0": -697.746322825144}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-928.220396323472, -401.3274380621455, -1011.8157757430652, -1058.3950402905289, -513.6637050966888, -801.137678035525, -702.8206320414464, -621.5012592035753, -149.50351134807633, -450.98575885827944, -1163.6781251356276, -979.3723316394246, -153.89136428163818, -1124.3721211839752, -400.7202974690253, -675.6783294999789, -234.2587454973742, -1120.371345194702, -295.81582116164464, -1058.438605854, -955.6320844549883, -269.09282205895653, -227.52146473059943, -950.7848895916784, -857.6471250997799, -686.491596593177, -940.9425149269234, -1097.1927479721558, -942.5142786912228, -788.7385431273087, -451.7180669263544, -1215.1332508130065, -971.7645242344626, -36.6092568024305, -792.3402161505106, -900.9196537037639, -935.2898914356011, -596.1173440446651, -823.4358498178183, -511.91379494761736, -1031.373466162966, -468.12184015641435, -903.8503004161286, -847.3041178061937, -167.05425782938462, -1073.0568669952008, -24.604924965204923, -771.3639808725834, -177.9514884037321, -78.64861149790327, -1089.7649181259674, -36.368876257191744, -1067.084215203019, -1054.3674970758254, -221.59234747899734, -754.3931432967755, -1008.1265565748248, -896.4911166968323], "episode_lengths": [150, 139, 150, 150, 121, 150, 150, 131, 62, 109, 150, 150, 114, 150, 150, 150, 137, 150, 90, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 53, 150, 150, 150, 127, 150, 129, 150, 150, 150, 150, 64, 150, 49, 150, 87, 64, 150, 57, 150, 150, 83, 150, 150, 150], "policy_policy_0_reward": [-928.220396323472, -401.3274380621455, -1011.8157757430652, -1058.3950402905289, -513.6637050966888, -801.137678035525, -702.8206320414464, -621.5012592035753, -149.50351134807633, -450.98575885827944, -1163.6781251356276, -979.3723316394246, -153.89136428163818, -1124.3721211839752, -400.7202974690253, -675.6783294999789, -234.2587454973742, -1120.371345194702, -295.81582116164464, -1058.438605854, -955.6320844549883, -269.09282205895653, -227.52146473059943, -950.7848895916784, -857.6471250997799, -686.491596593177, -940.9425149269234, -1097.1927479721558, -942.5142786912228, -788.7385431273087, -451.7180669263544, -1215.1332508130065, -971.7645242344626, -36.6092568024305, -792.3402161505106, -900.9196537037639, -935.2898914356011, -596.1173440446651, -823.4358498178183, -511.91379494761736, -1031.373466162966, -468.12184015641435, -903.8503004161286, -847.3041178061937, -167.05425782938462, -1073.0568669952008, -24.604924965204923, -771.3639808725834, -177.9514884037321, -78.64861149790327, -1089.7649181259674, -36.368876257191744, -1067.084215203019, -1054.3674970758254, -221.59234747899734, -754.3931432967755, -1008.1265565748248, -896.4911166968323]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2804984367827211, "mean_inference_ms": 0.8628766650471115, "mean_action_processing_ms": 0.1590349355456931, "mean_env_wait_ms": 1.5141611783515287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00555761929216056, "StateBufferConnector_ms": 0.004382380123796134, "ViewRequirementAgentConnector_ms": 0.09600540687297952}, "num_episodes": 31, "episode_return_max": -24.604924965204923, "episode_return_min": -1215.1332508130065, "episode_return_mean": -697.746322825144, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.43681465872214, "num_env_steps_trained_throughput_per_sec": 281.43681465872214, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 14144.638, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14144.566, "sample_time_ms": 2301.534, "learn_time_ms": 11825.211, "learn_throughput": 338.26, "synch_weights_time_ms": 17.085}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00003", "date": "2024-08-03_04-38-40", "timestamp": 1722640120, "time_this_iter_s": 14.21930742263794, "time_total_s": 28.302533626556396, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580e9d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28.302533626556396, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 12.754999999999999, "ram_util_percent": 16.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2338331563708684, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.381353831291198, "policy_loss": -0.009630534055274136, "vf_loss": 9.387859149773915, "vf_explained_var": 0.12056181443234285, "kl": 0.015704405877507575, "entropy": 1.5682609636336564, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -24.604924965204923, "episode_reward_min": -1215.1332508130065, "episode_reward_mean": -685.9123046451424, "episode_len_mean": 131.86516853932585, "episode_media": {}, "episodes_timesteps_total": 11736, "policy_reward_min": {"policy_0": -1215.1332508130065}, "policy_reward_max": {"policy_0": -24.604924965204923}, "policy_reward_mean": {"policy_0": -685.9123046451424}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-928.220396323472, -401.3274380621455, -1011.8157757430652, -1058.3950402905289, -513.6637050966888, -801.137678035525, -702.8206320414464, -621.5012592035753, -149.50351134807633, -450.98575885827944, -1163.6781251356276, -979.3723316394246, -153.89136428163818, -1124.3721211839752, -400.7202974690253, -675.6783294999789, -234.2587454973742, -1120.371345194702, -295.81582116164464, -1058.438605854, -955.6320844549883, -269.09282205895653, -227.52146473059943, -950.7848895916784, -857.6471250997799, -686.491596593177, -940.9425149269234, -1097.1927479721558, -942.5142786912228, -788.7385431273087, -451.7180669263544, -1215.1332508130065, -971.7645242344626, -36.6092568024305, -792.3402161505106, -900.9196537037639, -935.2898914356011, -596.1173440446651, -823.4358498178183, -511.91379494761736, -1031.373466162966, -468.12184015641435, -903.8503004161286, -847.3041178061937, -167.05425782938462, -1073.0568669952008, -24.604924965204923, -771.3639808725834, -177.9514884037321, -78.64861149790327, -1089.7649181259674, -36.368876257191744, -1067.084215203019, -1054.3674970758254, -221.59234747899734, -754.3931432967755, -1008.1265565748248, -896.4911166968323, -894.0492665169969, -1044.6413077058446, -73.74145350364277, -69.1302272310923, -63.87567587210161, -502.8465966741415, -619.1094769168942, -1021.8641288863823, -694.6755278977117, -628.7085106244248, -301.5753875840851, -1062.0016167966971, -806.0847461641797, -510.06554361404113, -502.2657615052013, -519.5249153835955, -801.8873242715152, -1104.2215488700567, -861.9518889067899, -883.2462451347527, -828.1874280288874, -437.82845499837305, -169.86882197041405, -493.8370064981495, -1049.9869489552289, -525.5395257125093, -956.7951211244274, -184.31022485584478, -1020.7283691737164, -859.821129581463, -1084.538208600153], "episode_lengths": [150, 139, 150, 150, 121, 150, 150, 131, 62, 109, 150, 150, 114, 150, 150, 150, 137, 150, 90, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 53, 150, 150, 150, 127, 150, 129, 150, 150, 150, 150, 64, 150, 49, 150, 87, 64, 150, 57, 150, 150, 83, 150, 150, 150, 150, 150, 61, 47, 60, 117, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 68, 150, 150, 131, 150, 82, 150, 150, 150], "policy_policy_0_reward": [-928.220396323472, -401.3274380621455, -1011.8157757430652, -1058.3950402905289, -513.6637050966888, -801.137678035525, -702.8206320414464, -621.5012592035753, -149.50351134807633, -450.98575885827944, -1163.6781251356276, -979.3723316394246, -153.89136428163818, -1124.3721211839752, -400.7202974690253, -675.6783294999789, -234.2587454973742, -1120.371345194702, -295.81582116164464, -1058.438605854, -955.6320844549883, -269.09282205895653, -227.52146473059943, -950.7848895916784, -857.6471250997799, -686.491596593177, -940.9425149269234, -1097.1927479721558, -942.5142786912228, -788.7385431273087, -451.7180669263544, -1215.1332508130065, -971.7645242344626, -36.6092568024305, -792.3402161505106, -900.9196537037639, -935.2898914356011, -596.1173440446651, -823.4358498178183, -511.91379494761736, -1031.373466162966, -468.12184015641435, -903.8503004161286, -847.3041178061937, -167.05425782938462, -1073.0568669952008, -24.604924965204923, -771.3639808725834, -177.9514884037321, -78.64861149790327, -1089.7649181259674, -36.368876257191744, -1067.084215203019, -1054.3674970758254, -221.59234747899734, -754.3931432967755, -1008.1265565748248, -896.4911166968323, -894.0492665169969, -1044.6413077058446, -73.74145350364277, -69.1302272310923, -63.87567587210161, -502.8465966741415, -619.1094769168942, -1021.8641288863823, -694.6755278977117, -628.7085106244248, -301.5753875840851, -1062.0016167966971, -806.0847461641797, -510.06554361404113, -502.2657615052013, -519.5249153835955, -801.8873242715152, -1104.2215488700567, -861.9518889067899, -883.2462451347527, -828.1874280288874, -437.82845499837305, -169.86882197041405, -493.8370064981495, -1049.9869489552289, -525.5395257125093, -956.7951211244274, -184.31022485584478, -1020.7283691737164, -859.821129581463, -1084.538208600153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2807758448954373, "mean_inference_ms": 0.8650965081297816, "mean_action_processing_ms": 0.15908297571451702, "mean_env_wait_ms": 1.519583345210615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005509344379553634, "StateBufferConnector_ms": 0.004300106777234024, "ViewRequirementAgentConnector_ms": 0.09617644749330671}, "num_episodes": 31, "episode_return_max": -24.604924965204923, "episode_return_min": -1215.1332508130065, "episode_return_mean": -685.9123046451424, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.7391290125726, "num_env_steps_trained_throughput_per_sec": 282.7391290125726, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 14145.537, "restore_workers_time_ms": 0.029, "training_step_time_ms": 14145.461, "sample_time_ms": 2317.371, "learn_time_ms": 11811.22, "learn_throughput": 338.661, "synch_weights_time_ms": 16.135}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00003", "date": "2024-08-03_04-38-54", "timestamp": 1722640134, "time_this_iter_s": 14.154469013214111, "time_total_s": 42.45700263977051, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814c310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 42.45700263977051, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.825, "ram_util_percent": 16.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.688164378143847, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.870833619932334, "policy_loss": -0.008132916162139736, "vf_loss": 8.876151801645756, "vf_explained_var": 0.15178437444070975, "kl": 0.014153305546005872, "entropy": 1.598089041809241, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -24.604924965204923, "episode_reward_min": -1270.81950118336, "episode_reward_mean": -712.6655051439587, "episode_len_mean": 134.3, "episode_media": {}, "episodes_timesteps_total": 13430, "policy_reward_min": {"policy_0": -1270.81950118336}, "policy_reward_max": {"policy_0": -24.604924965204923}, "policy_reward_mean": {"policy_0": -712.6655051439587}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1120.371345194702, -295.81582116164464, -1058.438605854, -955.6320844549883, -269.09282205895653, -227.52146473059943, -950.7848895916784, -857.6471250997799, -686.491596593177, -940.9425149269234, -1097.1927479721558, -942.5142786912228, -788.7385431273087, -451.7180669263544, -1215.1332508130065, -971.7645242344626, -36.6092568024305, -792.3402161505106, -900.9196537037639, -935.2898914356011, -596.1173440446651, -823.4358498178183, -511.91379494761736, -1031.373466162966, -468.12184015641435, -903.8503004161286, -847.3041178061937, -167.05425782938462, -1073.0568669952008, -24.604924965204923, -771.3639808725834, -177.9514884037321, -78.64861149790327, -1089.7649181259674, -36.368876257191744, -1067.084215203019, -1054.3674970758254, -221.59234747899734, -754.3931432967755, -1008.1265565748248, -896.4911166968323, -894.0492665169969, -1044.6413077058446, -73.74145350364277, -69.1302272310923, -63.87567587210161, -502.8465966741415, -619.1094769168942, -1021.8641288863823, -694.6755278977117, -628.7085106244248, -301.5753875840851, -1062.0016167966971, -806.0847461641797, -510.06554361404113, -502.2657615052013, -519.5249153835955, -801.8873242715152, -1104.2215488700567, -861.9518889067899, -883.2462451347527, -828.1874280288874, -437.82845499837305, -169.86882197041405, -493.8370064981495, -1049.9869489552289, -525.5395257125093, -956.7951211244274, -184.31022485584478, -1020.7283691737164, -859.821129581463, -1084.538208600153, -845.4013015834167, -766.7088792522643, -393.67323519702757, -916.9188150429364, -600.149014564218, -962.4773787639433, -159.03810767358564, -579.1137293684816, -444.92785986444306, -336.8789265058828, -1156.5383926988864, -1099.3491377921148, -908.7769969607697, -690.6684788332603, -827.8936121026038, -945.6738879826615, -722.7903768937423, -755.9380714382838, -840.4640670826287, -533.2146361828994, -1270.81950118336, -1022.8547831791747, -677.220277091378, -985.8190066429898, -456.99182196420537, -912.7085576707026, -662.7437748974936, -1115.9452822747087], "episode_lengths": [150, 90, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 53, 150, 150, 150, 127, 150, 129, 150, 150, 150, 150, 64, 150, 49, 150, 87, 64, 150, 57, 150, 150, 83, 150, 150, 150, 150, 150, 61, 47, 60, 117, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 68, 150, 150, 131, 150, 82, 150, 150, 150, 150, 150, 115, 150, 131, 150, 93, 150, 105, 141, 150, 150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150], "policy_policy_0_reward": [-1120.371345194702, -295.81582116164464, -1058.438605854, -955.6320844549883, -269.09282205895653, -227.52146473059943, -950.7848895916784, -857.6471250997799, -686.491596593177, -940.9425149269234, -1097.1927479721558, -942.5142786912228, -788.7385431273087, -451.7180669263544, -1215.1332508130065, -971.7645242344626, -36.6092568024305, -792.3402161505106, -900.9196537037639, -935.2898914356011, -596.1173440446651, -823.4358498178183, -511.91379494761736, -1031.373466162966, -468.12184015641435, -903.8503004161286, -847.3041178061937, -167.05425782938462, -1073.0568669952008, -24.604924965204923, -771.3639808725834, -177.9514884037321, -78.64861149790327, -1089.7649181259674, -36.368876257191744, -1067.084215203019, -1054.3674970758254, -221.59234747899734, -754.3931432967755, -1008.1265565748248, -896.4911166968323, -894.0492665169969, -1044.6413077058446, -73.74145350364277, -69.1302272310923, -63.87567587210161, -502.8465966741415, -619.1094769168942, -1021.8641288863823, -694.6755278977117, -628.7085106244248, -301.5753875840851, -1062.0016167966971, -806.0847461641797, -510.06554361404113, -502.2657615052013, -519.5249153835955, -801.8873242715152, -1104.2215488700567, -861.9518889067899, -883.2462451347527, -828.1874280288874, -437.82845499837305, -169.86882197041405, -493.8370064981495, -1049.9869489552289, -525.5395257125093, -956.7951211244274, -184.31022485584478, -1020.7283691737164, -859.821129581463, -1084.538208600153, -845.4013015834167, -766.7088792522643, -393.67323519702757, -916.9188150429364, -600.149014564218, -962.4773787639433, -159.03810767358564, -579.1137293684816, -444.92785986444306, -336.8789265058828, -1156.5383926988864, -1099.3491377921148, -908.7769969607697, -690.6684788332603, -827.8936121026038, -945.6738879826615, -722.7903768937423, -755.9380714382838, -840.4640670826287, -533.2146361828994, -1270.81950118336, -1022.8547831791747, -677.220277091378, -985.8190066429898, -456.99182196420537, -912.7085576707026, -662.7437748974936, -1115.9452822747087]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28107474405816524, "mean_inference_ms": 0.8669543823628025, "mean_action_processing_ms": 0.15890841835656722, "mean_env_wait_ms": 1.5240835447819276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00562739372253418, "StateBufferConnector_ms": 0.004293680191040039, "ViewRequirementAgentConnector_ms": 0.09804248809814453}, "num_episodes": 28, "episode_return_max": -24.604924965204923, "episode_return_min": -1270.81950118336, "episode_return_mean": -712.6655051439587, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.43295763981973, "num_env_steps_trained_throughput_per_sec": 284.43295763981973, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 14124.923, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14124.849, "sample_time_ms": 2324.945, "learn_time_ms": 11783.387, "learn_throughput": 339.461, "synch_weights_time_ms": 15.761}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00003", "date": "2024-08-03_04-39-09", "timestamp": 1722640149, "time_this_iter_s": 14.071407318115234, "time_total_s": 56.52840995788574, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814e3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 56.52840995788574, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.635, "ram_util_percent": 16.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.991522880457342, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.328881304462751, "policy_loss": -0.014242748437391128, "vf_loss": 8.33915981600682, "vf_explained_var": 0.2795247544224064, "kl": 0.01989557455805577, "entropy": 1.4892737517754238, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -24.604924965204923, "episode_reward_min": -1416.0944675437281, "episode_reward_mean": -709.0589289252102, "episode_len_mean": 135.4, "episode_media": {}, "episodes_timesteps_total": 13540, "policy_reward_min": {"policy_0": -1416.0944675437281}, "policy_reward_max": {"policy_0": -24.604924965204923}, "policy_reward_mean": {"policy_0": -709.0589289252102}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1073.0568669952008, -24.604924965204923, -771.3639808725834, -177.9514884037321, -78.64861149790327, -1089.7649181259674, -36.368876257191744, -1067.084215203019, -1054.3674970758254, -221.59234747899734, -754.3931432967755, -1008.1265565748248, -896.4911166968323, -894.0492665169969, -1044.6413077058446, -73.74145350364277, -69.1302272310923, -63.87567587210161, -502.8465966741415, -619.1094769168942, -1021.8641288863823, -694.6755278977117, -628.7085106244248, -301.5753875840851, -1062.0016167966971, -806.0847461641797, -510.06554361404113, -502.2657615052013, -519.5249153835955, -801.8873242715152, -1104.2215488700567, -861.9518889067899, -883.2462451347527, -828.1874280288874, -437.82845499837305, -169.86882197041405, -493.8370064981495, -1049.9869489552289, -525.5395257125093, -956.7951211244274, -184.31022485584478, -1020.7283691737164, -859.821129581463, -1084.538208600153, -845.4013015834167, -766.7088792522643, -393.67323519702757, -916.9188150429364, -600.149014564218, -962.4773787639433, -159.03810767358564, -579.1137293684816, -444.92785986444306, -336.8789265058828, -1156.5383926988864, -1099.3491377921148, -908.7769969607697, -690.6684788332603, -827.8936121026038, -945.6738879826615, -722.7903768937423, -755.9380714382838, -840.4640670826287, -533.2146361828994, -1270.81950118336, -1022.8547831791747, -677.220277091378, -985.8190066429898, -456.99182196420537, -912.7085576707026, -662.7437748974936, -1115.9452822747087, -197.79524097965998, -792.5423799821526, -546.3145509008065, -574.4858513841567, -695.4136978433364, -1416.0944675437281, -1234.8141768736245, -724.520012101696, -275.7206517977358, -1048.3637347470308, -810.4980445339629, -509.7810355664436, -67.43719267265689, -1011.2037205666004, -1068.9099759991354, -677.7344945739607, -388.32784420192763, -753.060723631594, -1268.8054152219866, -523.6121331287309, -775.3782550775347, -593.9013085434487, -1227.7778845905357, -190.24013138104056, -906.9770951103562, -448.71184874375297, -1249.9734105040748, -505.0767706279293], "episode_lengths": [150, 49, 150, 87, 64, 150, 57, 150, 150, 83, 150, 150, 150, 150, 150, 61, 47, 60, 117, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 68, 150, 150, 131, 150, 82, 150, 150, 150, 150, 150, 115, 150, 131, 150, 93, 150, 105, 141, 150, 150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 81, 150, 129, 128, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150], "policy_policy_0_reward": [-1073.0568669952008, -24.604924965204923, -771.3639808725834, -177.9514884037321, -78.64861149790327, -1089.7649181259674, -36.368876257191744, -1067.084215203019, -1054.3674970758254, -221.59234747899734, -754.3931432967755, -1008.1265565748248, -896.4911166968323, -894.0492665169969, -1044.6413077058446, -73.74145350364277, -69.1302272310923, -63.87567587210161, -502.8465966741415, -619.1094769168942, -1021.8641288863823, -694.6755278977117, -628.7085106244248, -301.5753875840851, -1062.0016167966971, -806.0847461641797, -510.06554361404113, -502.2657615052013, -519.5249153835955, -801.8873242715152, -1104.2215488700567, -861.9518889067899, -883.2462451347527, -828.1874280288874, -437.82845499837305, -169.86882197041405, -493.8370064981495, -1049.9869489552289, -525.5395257125093, -956.7951211244274, -184.31022485584478, -1020.7283691737164, -859.821129581463, -1084.538208600153, -845.4013015834167, -766.7088792522643, -393.67323519702757, -916.9188150429364, -600.149014564218, -962.4773787639433, -159.03810767358564, -579.1137293684816, -444.92785986444306, -336.8789265058828, -1156.5383926988864, -1099.3491377921148, -908.7769969607697, -690.6684788332603, -827.8936121026038, -945.6738879826615, -722.7903768937423, -755.9380714382838, -840.4640670826287, -533.2146361828994, -1270.81950118336, -1022.8547831791747, -677.220277091378, -985.8190066429898, -456.99182196420537, -912.7085576707026, -662.7437748974936, -1115.9452822747087, -197.79524097965998, -792.5423799821526, -546.3145509008065, -574.4858513841567, -695.4136978433364, -1416.0944675437281, -1234.8141768736245, -724.520012101696, -275.7206517977358, -1048.3637347470308, -810.4980445339629, -509.7810355664436, -67.43719267265689, -1011.2037205666004, -1068.9099759991354, -677.7344945739607, -388.32784420192763, -753.060723631594, -1268.8054152219866, -523.6121331287309, -775.3782550775347, -593.9013085434487, -1227.7778845905357, -190.24013138104056, -906.9770951103562, -448.71184874375297, -1249.9734105040748, -505.0767706279293]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28095123488437085, "mean_inference_ms": 0.8686121455905842, "mean_action_processing_ms": 0.1587228151987757, "mean_env_wait_ms": 1.5305983162325614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005807638168334961, "StateBufferConnector_ms": 0.0042073726654052734, "ViewRequirementAgentConnector_ms": 0.09795093536376953}, "num_episodes": 28, "episode_return_max": -24.604924965204923, "episode_return_min": -1416.0944675437281, "episode_return_mean": -709.0589289252102, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.3030523075615, "num_env_steps_trained_throughput_per_sec": 286.3030523075615, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 14094.184, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14094.111, "sample_time_ms": 2329.053, "learn_time_ms": 11748.653, "learn_throughput": 340.465, "synch_weights_time_ms": 15.656}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00003", "date": "2024-08-03_04-39-23", "timestamp": 1722640163, "time_this_iter_s": 13.978513956069946, "time_total_s": 70.50692391395569, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270f520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 70.50692391395569, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.685, "ram_util_percent": 16.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.68794694058597, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.107792182763417, "policy_loss": -0.012070696012233383, "vf_loss": 8.116064391036828, "vf_explained_var": 0.46559594552963973, "kl": 0.01906774578431699, "entropy": 1.507521683598558, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -67.43719267265689, "episode_reward_min": -1416.0944675437281, "episode_reward_mean": -756.0402617494157, "episode_len_mean": 141.4, "episode_media": {}, "episodes_timesteps_total": 14140, "policy_reward_min": {"policy_0": -1416.0944675437281}, "policy_reward_max": {"policy_0": -67.43719267265689}, "policy_reward_mean": {"policy_0": -756.0402617494157}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-502.2657615052013, -519.5249153835955, -801.8873242715152, -1104.2215488700567, -861.9518889067899, -883.2462451347527, -828.1874280288874, -437.82845499837305, -169.86882197041405, -493.8370064981495, -1049.9869489552289, -525.5395257125093, -956.7951211244274, -184.31022485584478, -1020.7283691737164, -859.821129581463, -1084.538208600153, -845.4013015834167, -766.7088792522643, -393.67323519702757, -916.9188150429364, -600.149014564218, -962.4773787639433, -159.03810767358564, -579.1137293684816, -444.92785986444306, -336.8789265058828, -1156.5383926988864, -1099.3491377921148, -908.7769969607697, -690.6684788332603, -827.8936121026038, -945.6738879826615, -722.7903768937423, -755.9380714382838, -840.4640670826287, -533.2146361828994, -1270.81950118336, -1022.8547831791747, -677.220277091378, -985.8190066429898, -456.99182196420537, -912.7085576707026, -662.7437748974936, -1115.9452822747087, -197.79524097965998, -792.5423799821526, -546.3145509008065, -574.4858513841567, -695.4136978433364, -1416.0944675437281, -1234.8141768736245, -724.520012101696, -275.7206517977358, -1048.3637347470308, -810.4980445339629, -509.7810355664436, -67.43719267265689, -1011.2037205666004, -1068.9099759991354, -677.7344945739607, -388.32784420192763, -753.060723631594, -1268.8054152219866, -523.6121331287309, -775.3782550775347, -593.9013085434487, -1227.7778845905357, -190.24013138104056, -906.9770951103562, -448.71184874375297, -1249.9734105040748, -505.0767706279293, -563.4881586592878, -1131.483242506339, -905.2403338764161, -837.8804654129535, -602.6133846660882, -990.5249551059782, -929.1937840380765, -706.1958640002086, -690.6231517399079, -1216.452796006457, -807.320514404604, -1188.6236177691444, -948.1234847832925, -111.9387611320651, -314.83578812092117, -1091.2148544627223, -756.1212860027086, -1064.7564200233303, -855.2257824463135, -677.1434834083103, -499.08309957296746, -770.9722434055564, -345.19340378194914, -490.90524603194524, -590.4795829931196, -1142.4386770500516, -1016.2449104520882], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 99, 68, 150, 150, 131, 150, 82, 150, 150, 150, 150, 150, 115, 150, 131, 150, 93, 150, 105, 141, 150, 150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 81, 150, 129, 128, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 131, 150, 150, 150, 150, 150, 129, 150, 111, 150, 150, 150, 150], "policy_policy_0_reward": [-502.2657615052013, -519.5249153835955, -801.8873242715152, -1104.2215488700567, -861.9518889067899, -883.2462451347527, -828.1874280288874, -437.82845499837305, -169.86882197041405, -493.8370064981495, -1049.9869489552289, -525.5395257125093, -956.7951211244274, -184.31022485584478, -1020.7283691737164, -859.821129581463, -1084.538208600153, -845.4013015834167, -766.7088792522643, -393.67323519702757, -916.9188150429364, -600.149014564218, -962.4773787639433, -159.03810767358564, -579.1137293684816, -444.92785986444306, -336.8789265058828, -1156.5383926988864, -1099.3491377921148, -908.7769969607697, -690.6684788332603, -827.8936121026038, -945.6738879826615, -722.7903768937423, -755.9380714382838, -840.4640670826287, -533.2146361828994, -1270.81950118336, -1022.8547831791747, -677.220277091378, -985.8190066429898, -456.99182196420537, -912.7085576707026, -662.7437748974936, -1115.9452822747087, -197.79524097965998, -792.5423799821526, -546.3145509008065, -574.4858513841567, -695.4136978433364, -1416.0944675437281, -1234.8141768736245, -724.520012101696, -275.7206517977358, -1048.3637347470308, -810.4980445339629, -509.7810355664436, -67.43719267265689, -1011.2037205666004, -1068.9099759991354, -677.7344945739607, -388.32784420192763, -753.060723631594, -1268.8054152219866, -523.6121331287309, -775.3782550775347, -593.9013085434487, -1227.7778845905357, -190.24013138104056, -906.9770951103562, -448.71184874375297, -1249.9734105040748, -505.0767706279293, -563.4881586592878, -1131.483242506339, -905.2403338764161, -837.8804654129535, -602.6133846660882, -990.5249551059782, -929.1937840380765, -706.1958640002086, -690.6231517399079, -1216.452796006457, -807.320514404604, -1188.6236177691444, -948.1234847832925, -111.9387611320651, -314.83578812092117, -1091.2148544627223, -756.1212860027086, -1064.7564200233303, -855.2257824463135, -677.1434834083103, -499.08309957296746, -770.9722434055564, -345.19340378194914, -490.90524603194524, -590.4795829931196, -1142.4386770500516, -1016.2449104520882]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28021081911815704, "mean_inference_ms": 0.8696273174347067, "mean_action_processing_ms": 0.1585884770318869, "mean_env_wait_ms": 1.5332668435452796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0057179927825927734, "StateBufferConnector_ms": 0.004189252853393555, "ViewRequirementAgentConnector_ms": 0.09814834594726562}, "num_episodes": 27, "episode_return_max": -67.43719267265689, "episode_return_min": -1416.0944675437281, "episode_return_mean": -756.0402617494157, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.42384171224, "num_env_steps_trained_throughput_per_sec": 281.42384171224, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 14114.062, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14113.989, "sample_time_ms": 2329.055, "learn_time_ms": 11768.796, "learn_throughput": 339.882, "synch_weights_time_ms": 15.389}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00003", "date": "2024-08-03_04-39-37", "timestamp": 1722640177, "time_this_iter_s": 14.221097469329834, "time_total_s": 84.72802138328552, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b32780430>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 84.72802138328552, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.585, "ram_util_percent": 16.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.15983709593614, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.940821216007074, "policy_loss": -0.012052712501220716, "vf_loss": 6.949076000849406, "vf_explained_var": 0.7552501229569316, "kl": 0.01905737487029456, "entropy": 1.3538282096385956, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -67.43719267265689, "episode_reward_min": -1416.0944675437281, "episode_reward_mean": -738.9111312601854, "episode_len_mean": 143.21, "episode_media": {}, "episodes_timesteps_total": 14321, "policy_reward_min": {"policy_0": -1416.0944675437281}, "policy_reward_max": {"policy_0": -67.43719267265689}, "policy_reward_mean": {"policy_0": -738.9111312601854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1099.3491377921148, -908.7769969607697, -690.6684788332603, -827.8936121026038, -945.6738879826615, -722.7903768937423, -755.9380714382838, -840.4640670826287, -533.2146361828994, -1270.81950118336, -1022.8547831791747, -677.220277091378, -985.8190066429898, -456.99182196420537, -912.7085576707026, -662.7437748974936, -1115.9452822747087, -197.79524097965998, -792.5423799821526, -546.3145509008065, -574.4858513841567, -695.4136978433364, -1416.0944675437281, -1234.8141768736245, -724.520012101696, -275.7206517977358, -1048.3637347470308, -810.4980445339629, -509.7810355664436, -67.43719267265689, -1011.2037205666004, -1068.9099759991354, -677.7344945739607, -388.32784420192763, -753.060723631594, -1268.8054152219866, -523.6121331287309, -775.3782550775347, -593.9013085434487, -1227.7778845905357, -190.24013138104056, -906.9770951103562, -448.71184874375297, -1249.9734105040748, -505.0767706279293, -563.4881586592878, -1131.483242506339, -905.2403338764161, -837.8804654129535, -602.6133846660882, -990.5249551059782, -929.1937840380765, -706.1958640002086, -690.6231517399079, -1216.452796006457, -807.320514404604, -1188.6236177691444, -948.1234847832925, -111.9387611320651, -314.83578812092117, -1091.2148544627223, -756.1212860027086, -1064.7564200233303, -855.2257824463135, -677.1434834083103, -499.08309957296746, -770.9722434055564, -345.19340378194914, -490.90524603194524, -590.4795829931196, -1142.4386770500516, -1016.2449104520882, -582.4004788540718, -165.74812637808074, -291.70283033136457, -526.078946491305, -958.1011541539386, -929.3705423081517, -410.2696589917203, -356.84847330927187, -1031.9835222957981, -632.6095950140027, -244.65149220815601, -1084.442578266879, -820.1751693569141, -920.8337261476353, -774.4861731953082, -531.7398530114752, -640.6384316568493, -279.70573945280785, -706.861001744962, -1005.6109530580079, -325.5404978563383, -543.9693539132705, -965.6040161185954, -837.691083423516, -503.3150825703253, -260.3852485066708, -460.76706356668643, -941.9207229810479], "episode_lengths": [150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 81, 150, 129, 128, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 131, 150, 150, 150, 150, 150, 129, 150, 111, 150, 150, 150, 150, 150, 63, 95, 150, 150, 150, 150, 136, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150], "policy_policy_0_reward": [-1099.3491377921148, -908.7769969607697, -690.6684788332603, -827.8936121026038, -945.6738879826615, -722.7903768937423, -755.9380714382838, -840.4640670826287, -533.2146361828994, -1270.81950118336, -1022.8547831791747, -677.220277091378, -985.8190066429898, -456.99182196420537, -912.7085576707026, -662.7437748974936, -1115.9452822747087, -197.79524097965998, -792.5423799821526, -546.3145509008065, -574.4858513841567, -695.4136978433364, -1416.0944675437281, -1234.8141768736245, -724.520012101696, -275.7206517977358, -1048.3637347470308, -810.4980445339629, -509.7810355664436, -67.43719267265689, -1011.2037205666004, -1068.9099759991354, -677.7344945739607, -388.32784420192763, -753.060723631594, -1268.8054152219866, -523.6121331287309, -775.3782550775347, -593.9013085434487, -1227.7778845905357, -190.24013138104056, -906.9770951103562, -448.71184874375297, -1249.9734105040748, -505.0767706279293, -563.4881586592878, -1131.483242506339, -905.2403338764161, -837.8804654129535, -602.6133846660882, -990.5249551059782, -929.1937840380765, -706.1958640002086, -690.6231517399079, -1216.452796006457, -807.320514404604, -1188.6236177691444, -948.1234847832925, -111.9387611320651, -314.83578812092117, -1091.2148544627223, -756.1212860027086, -1064.7564200233303, -855.2257824463135, -677.1434834083103, -499.08309957296746, -770.9722434055564, -345.19340378194914, -490.90524603194524, -590.4795829931196, -1142.4386770500516, -1016.2449104520882, -582.4004788540718, -165.74812637808074, -291.70283033136457, -526.078946491305, -958.1011541539386, -929.3705423081517, -410.2696589917203, -356.84847330927187, -1031.9835222957981, -632.6095950140027, -244.65149220815601, -1084.442578266879, -820.1751693569141, -920.8337261476353, -774.4861731953082, -531.7398530114752, -640.6384316568493, -279.70573945280785, -706.861001744962, -1005.6109530580079, -325.5404978563383, -543.9693539132705, -965.6040161185954, -837.691083423516, -503.3150825703253, -260.3852485066708, -460.76706356668643, -941.9207229810479]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2795474819939244, "mean_inference_ms": 0.8714398534279073, "mean_action_processing_ms": 0.1583638608494201, "mean_env_wait_ms": 1.5339390362895613, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005852699279785156, "StateBufferConnector_ms": 0.004164218902587891, "ViewRequirementAgentConnector_ms": 0.09786200523376465}, "num_episodes": 28, "episode_return_max": -67.43719267265689, "episode_return_min": -1416.0944675437281, "episode_return_mean": -738.9111312601854, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.7519403044418, "num_env_steps_trained_throughput_per_sec": 280.7519403044418, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 14133.12, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14133.047, "sample_time_ms": 2348.99, "learn_time_ms": 11767.984, "learn_throughput": 339.905, "synch_weights_time_ms": 15.326}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00003", "date": "2024-08-03_04-39-51", "timestamp": 1722640191, "time_this_iter_s": 14.254547834396362, "time_total_s": 98.98256921768188, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270ef80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 98.98256921768188, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.466666666666665, "ram_util_percent": 16.190476190476186}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.7886148745815, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.9796316340565685, "policy_loss": -0.014595670257889045, "vf_loss": 6.990110822518667, "vf_explained_var": 0.7114546367898583, "kl": 0.02065181635001257, "entropy": 1.386422538633148, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -67.43719267265689, "episode_reward_min": -1274.7715139480335, "episode_reward_mean": -712.92377541973, "episode_len_mean": 142.21, "episode_media": {}, "episodes_timesteps_total": 14221, "policy_reward_min": {"policy_0": -1274.7715139480335}, "policy_reward_max": {"policy_0": -67.43719267265689}, "policy_reward_mean": {"policy_0": -712.92377541973}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-509.7810355664436, -67.43719267265689, -1011.2037205666004, -1068.9099759991354, -677.7344945739607, -388.32784420192763, -753.060723631594, -1268.8054152219866, -523.6121331287309, -775.3782550775347, -593.9013085434487, -1227.7778845905357, -190.24013138104056, -906.9770951103562, -448.71184874375297, -1249.9734105040748, -505.0767706279293, -563.4881586592878, -1131.483242506339, -905.2403338764161, -837.8804654129535, -602.6133846660882, -990.5249551059782, -929.1937840380765, -706.1958640002086, -690.6231517399079, -1216.452796006457, -807.320514404604, -1188.6236177691444, -948.1234847832925, -111.9387611320651, -314.83578812092117, -1091.2148544627223, -756.1212860027086, -1064.7564200233303, -855.2257824463135, -677.1434834083103, -499.08309957296746, -770.9722434055564, -345.19340378194914, -490.90524603194524, -590.4795829931196, -1142.4386770500516, -1016.2449104520882, -582.4004788540718, -165.74812637808074, -291.70283033136457, -526.078946491305, -958.1011541539386, -929.3705423081517, -410.2696589917203, -356.84847330927187, -1031.9835222957981, -632.6095950140027, -244.65149220815601, -1084.442578266879, -820.1751693569141, -920.8337261476353, -774.4861731953082, -531.7398530114752, -640.6384316568493, -279.70573945280785, -706.861001744962, -1005.6109530580079, -325.5404978563383, -543.9693539132705, -965.6040161185954, -837.691083423516, -503.3150825703253, -260.3852485066708, -460.76706356668643, -941.9207229810479, -378.29485487079256, -1179.3829920562323, -494.46493593185176, -775.7280106548508, -544.8361845877857, -422.3018508510718, -910.7470373914704, -963.5671573399932, -715.4262298616109, -1274.7715139480335, -655.1465889654125, -839.9724517155271, -295.10822051442074, -382.0403777804244, -813.1537988788302, -974.4797282259264, -277.52446444621404, -835.4629774406583, -798.2601578090469, -743.5536832749287, -153.7951578754912, -756.5894169837755, -943.1542363359014, -823.517905630451, -288.85679304797685, -768.5328085764595, -1204.1137688729605, -934.9161909472253], "episode_lengths": [150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 131, 150, 150, 150, 150, 150, 129, 150, 111, 150, 150, 150, 150, 150, 63, 95, 150, 150, 150, 150, 136, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 110, 150, 150, 86, 150, 150, 150, 82, 150, 150, 150, 88, 150, 150, 150], "policy_policy_0_reward": [-509.7810355664436, -67.43719267265689, -1011.2037205666004, -1068.9099759991354, -677.7344945739607, -388.32784420192763, -753.060723631594, -1268.8054152219866, -523.6121331287309, -775.3782550775347, -593.9013085434487, -1227.7778845905357, -190.24013138104056, -906.9770951103562, -448.71184874375297, -1249.9734105040748, -505.0767706279293, -563.4881586592878, -1131.483242506339, -905.2403338764161, -837.8804654129535, -602.6133846660882, -990.5249551059782, -929.1937840380765, -706.1958640002086, -690.6231517399079, -1216.452796006457, -807.320514404604, -1188.6236177691444, -948.1234847832925, -111.9387611320651, -314.83578812092117, -1091.2148544627223, -756.1212860027086, -1064.7564200233303, -855.2257824463135, -677.1434834083103, -499.08309957296746, -770.9722434055564, -345.19340378194914, -490.90524603194524, -590.4795829931196, -1142.4386770500516, -1016.2449104520882, -582.4004788540718, -165.74812637808074, -291.70283033136457, -526.078946491305, -958.1011541539386, -929.3705423081517, -410.2696589917203, -356.84847330927187, -1031.9835222957981, -632.6095950140027, -244.65149220815601, -1084.442578266879, -820.1751693569141, -920.8337261476353, -774.4861731953082, -531.7398530114752, -640.6384316568493, -279.70573945280785, -706.861001744962, -1005.6109530580079, -325.5404978563383, -543.9693539132705, -965.6040161185954, -837.691083423516, -503.3150825703253, -260.3852485066708, -460.76706356668643, -941.9207229810479, -378.29485487079256, -1179.3829920562323, -494.46493593185176, -775.7280106548508, -544.8361845877857, -422.3018508510718, -910.7470373914704, -963.5671573399932, -715.4262298616109, -1274.7715139480335, -655.1465889654125, -839.9724517155271, -295.10822051442074, -382.0403777804244, -813.1537988788302, -974.4797282259264, -277.52446444621404, -835.4629774406583, -798.2601578090469, -743.5536832749287, -153.7951578754912, -756.5894169837755, -943.1542363359014, -823.517905630451, -288.85679304797685, -768.5328085764595, -1204.1137688729605, -934.9161909472253]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2790848511374993, "mean_inference_ms": 0.8793918598254709, "mean_action_processing_ms": 0.15812524500459615, "mean_env_wait_ms": 1.5335378665920831, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005568504333496094, "StateBufferConnector_ms": 0.0040776729583740234, "ViewRequirementAgentConnector_ms": 0.09626889228820801}, "num_episodes": 28, "episode_return_max": -67.43719267265689, "episode_return_min": -1274.7715139480335, "episode_return_mean": -712.92377541973, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.56588130061226, "num_env_steps_trained_throughput_per_sec": 277.56588130061226, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 14167.855, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14167.785, "sample_time_ms": 2372.084, "learn_time_ms": 11779.716, "learn_throughput": 339.567, "synch_weights_time_ms": 15.239}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00003", "date": "2024-08-03_04-40-06", "timestamp": 1722640206, "time_this_iter_s": 14.419403791427612, "time_total_s": 113.4019730091095, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c787400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 113.4019730091095, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.24, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.63071532150109, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.707784194250902, "policy_loss": -0.007923596282489597, "vf_loss": 6.711177371939024, "vf_explained_var": 0.8135549761354923, "kl": 0.01514670702784618, "entropy": 1.3585523140927156, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -27.90801546160948, "episode_reward_min": -1274.7715139480335, "episode_reward_mean": -678.8564333764957, "episode_len_mean": 140.24, "episode_media": {}, "episodes_timesteps_total": 14024, "policy_reward_min": {"policy_0": -1274.7715139480335}, "policy_reward_max": {"policy_0": -27.90801546160948}, "policy_reward_mean": {"policy_0": -678.8564333764957}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-948.1234847832925, -111.9387611320651, -314.83578812092117, -1091.2148544627223, -756.1212860027086, -1064.7564200233303, -855.2257824463135, -677.1434834083103, -499.08309957296746, -770.9722434055564, -345.19340378194914, -490.90524603194524, -590.4795829931196, -1142.4386770500516, -1016.2449104520882, -582.4004788540718, -165.74812637808074, -291.70283033136457, -526.078946491305, -958.1011541539386, -929.3705423081517, -410.2696589917203, -356.84847330927187, -1031.9835222957981, -632.6095950140027, -244.65149220815601, -1084.442578266879, -820.1751693569141, -920.8337261476353, -774.4861731953082, -531.7398530114752, -640.6384316568493, -279.70573945280785, -706.861001744962, -1005.6109530580079, -325.5404978563383, -543.9693539132705, -965.6040161185954, -837.691083423516, -503.3150825703253, -260.3852485066708, -460.76706356668643, -941.9207229810479, -378.29485487079256, -1179.3829920562323, -494.46493593185176, -775.7280106548508, -544.8361845877857, -422.3018508510718, -910.7470373914704, -963.5671573399932, -715.4262298616109, -1274.7715139480335, -655.1465889654125, -839.9724517155271, -295.10822051442074, -382.0403777804244, -813.1537988788302, -974.4797282259264, -277.52446444621404, -835.4629774406583, -798.2601578090469, -743.5536832749287, -153.7951578754912, -756.5894169837755, -943.1542363359014, -823.517905630451, -288.85679304797685, -768.5328085764595, -1204.1137688729605, -934.9161909472253, -443.58345050194936, -651.4404676346456, -839.1540236347462, -661.3350695863073, -38.226454871799206, -378.2348928448099, -865.5794765999461, -646.7730085637761, -633.4022254108304, -739.8515594972633, -839.1560318842328, -265.61197054272236, -782.6977815684324, -696.5358771916611, -1206.7652582952967, -1180.607152561632, -27.90801546160948, -600.7932961478729, -697.1077933800372, -848.1807382952546, -600.9798477754322, -1013.5539385896801, -424.5943262436534, -894.9201241617797, -1130.951808341122, -179.94269380354768, -821.6717718499699, -818.9907345911096, -401.26551417264346], "episode_lengths": [150, 60, 131, 150, 150, 150, 150, 150, 129, 150, 111, 150, 150, 150, 150, 150, 63, 95, 150, 150, 150, 150, 136, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 110, 150, 150, 86, 150, 150, 150, 82, 150, 150, 150, 88, 150, 150, 150, 143, 150, 150, 150, 41, 118, 150, 150, 146, 150, 150, 103, 150, 150, 150, 150, 56, 150, 150, 150, 126, 150, 150, 150, 150, 104, 150, 150, 150], "policy_policy_0_reward": [-948.1234847832925, -111.9387611320651, -314.83578812092117, -1091.2148544627223, -756.1212860027086, -1064.7564200233303, -855.2257824463135, -677.1434834083103, -499.08309957296746, -770.9722434055564, -345.19340378194914, -490.90524603194524, -590.4795829931196, -1142.4386770500516, -1016.2449104520882, -582.4004788540718, -165.74812637808074, -291.70283033136457, -526.078946491305, -958.1011541539386, -929.3705423081517, -410.2696589917203, -356.84847330927187, -1031.9835222957981, -632.6095950140027, -244.65149220815601, -1084.442578266879, -820.1751693569141, -920.8337261476353, -774.4861731953082, -531.7398530114752, -640.6384316568493, -279.70573945280785, -706.861001744962, -1005.6109530580079, -325.5404978563383, -543.9693539132705, -965.6040161185954, -837.691083423516, -503.3150825703253, -260.3852485066708, -460.76706356668643, -941.9207229810479, -378.29485487079256, -1179.3829920562323, -494.46493593185176, -775.7280106548508, -544.8361845877857, -422.3018508510718, -910.7470373914704, -963.5671573399932, -715.4262298616109, -1274.7715139480335, -655.1465889654125, -839.9724517155271, -295.10822051442074, -382.0403777804244, -813.1537988788302, -974.4797282259264, -277.52446444621404, -835.4629774406583, -798.2601578090469, -743.5536832749287, -153.7951578754912, -756.5894169837755, -943.1542363359014, -823.517905630451, -288.85679304797685, -768.5328085764595, -1204.1137688729605, -934.9161909472253, -443.58345050194936, -651.4404676346456, -839.1540236347462, -661.3350695863073, -38.226454871799206, -378.2348928448099, -865.5794765999461, -646.7730085637761, -633.4022254108304, -739.8515594972633, -839.1560318842328, -265.61197054272236, -782.6977815684324, -696.5358771916611, -1206.7652582952967, -1180.607152561632, -27.90801546160948, -600.7932961478729, -697.1077933800372, -848.1807382952546, -600.9798477754322, -1013.5539385896801, -424.5943262436534, -894.9201241617797, -1130.951808341122, -179.94269380354768, -821.6717718499699, -818.9907345911096, -401.26551417264346]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2788680917456476, "mean_inference_ms": 0.8868875596130954, "mean_action_processing_ms": 0.15799842786800217, "mean_env_wait_ms": 1.5329875341391916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005322456359863281, "StateBufferConnector_ms": 0.0040740966796875, "ViewRequirementAgentConnector_ms": 0.09682917594909668}, "num_episodes": 29, "episode_return_max": -27.90801546160948, "episode_return_min": -1274.7715139480335, "episode_return_mean": -678.8564333764957, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.99958635926674, "num_env_steps_trained_throughput_per_sec": 284.99958635926674, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 14153.108, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14153.036, "sample_time_ms": 2367.771, "learn_time_ms": 11769.321, "learn_throughput": 339.867, "synch_weights_time_ms": 15.158}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00003", "date": "2024-08-03_04-40-20", "timestamp": 1722640220, "time_this_iter_s": 14.040375709533691, "time_total_s": 127.44234871864319, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814f640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 127.44234871864319, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 12.735000000000001, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 64.50442963341872, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.506255464007457, "policy_loss": -0.018078750028507784, "vf_loss": 5.518820461630821, "vf_explained_var": 0.8848745913555225, "kl": 0.018428587876951504, "entropy": 1.4841541480273008, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -27.90801546160948, "episode_reward_min": -1274.7715139480335, "episode_reward_mean": -701.8230320799107, "episode_len_mean": 142.59, "episode_media": {}, "episodes_timesteps_total": 14259, "policy_reward_min": {"policy_0": -1274.7715139480335}, "policy_reward_max": {"policy_0": -27.90801546160948}, "policy_reward_mean": {"policy_0": -701.8230320799107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-920.8337261476353, -774.4861731953082, -531.7398530114752, -640.6384316568493, -279.70573945280785, -706.861001744962, -1005.6109530580079, -325.5404978563383, -543.9693539132705, -965.6040161185954, -837.691083423516, -503.3150825703253, -260.3852485066708, -460.76706356668643, -941.9207229810479, -378.29485487079256, -1179.3829920562323, -494.46493593185176, -775.7280106548508, -544.8361845877857, -422.3018508510718, -910.7470373914704, -963.5671573399932, -715.4262298616109, -1274.7715139480335, -655.1465889654125, -839.9724517155271, -295.10822051442074, -382.0403777804244, -813.1537988788302, -974.4797282259264, -277.52446444621404, -835.4629774406583, -798.2601578090469, -743.5536832749287, -153.7951578754912, -756.5894169837755, -943.1542363359014, -823.517905630451, -288.85679304797685, -768.5328085764595, -1204.1137688729605, -934.9161909472253, -443.58345050194936, -651.4404676346456, -839.1540236347462, -661.3350695863073, -38.226454871799206, -378.2348928448099, -865.5794765999461, -646.7730085637761, -633.4022254108304, -739.8515594972633, -839.1560318842328, -265.61197054272236, -782.6977815684324, -696.5358771916611, -1206.7652582952967, -1180.607152561632, -27.90801546160948, -600.7932961478729, -697.1077933800372, -848.1807382952546, -600.9798477754322, -1013.5539385896801, -424.5943262436534, -894.9201241617797, -1130.951808341122, -179.94269380354768, -821.6717718499699, -818.9907345911096, -401.26551417264346, -969.5073172445958, -685.9929472952075, -709.1256612078726, -98.75576236302408, -781.8653256454529, -1235.7276093122002, -658.6891419625948, -786.051903781081, -484.12683135321646, -526.809171463445, -646.008826460501, -1071.9934045272225, -1182.936380028028, -978.3707109857398, -731.4538660333245, -569.498639131347, -353.0394073561127, -893.4414019558445, -832.6577359434519, -1224.9537645540045, -1022.5788345259679, -611.3540818442323, -191.06568466063413, -572.607990272063, -870.5749904008081, -595.4514734698317, -1011.5615509529454, -709.5190472377417], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 110, 150, 150, 86, 150, 150, 150, 82, 150, 150, 150, 88, 150, 150, 150, 143, 150, 150, 150, 41, 118, 150, 150, 146, 150, 150, 103, 150, 150, 150, 150, 56, 150, 150, 150, 126, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-920.8337261476353, -774.4861731953082, -531.7398530114752, -640.6384316568493, -279.70573945280785, -706.861001744962, -1005.6109530580079, -325.5404978563383, -543.9693539132705, -965.6040161185954, -837.691083423516, -503.3150825703253, -260.3852485066708, -460.76706356668643, -941.9207229810479, -378.29485487079256, -1179.3829920562323, -494.46493593185176, -775.7280106548508, -544.8361845877857, -422.3018508510718, -910.7470373914704, -963.5671573399932, -715.4262298616109, -1274.7715139480335, -655.1465889654125, -839.9724517155271, -295.10822051442074, -382.0403777804244, -813.1537988788302, -974.4797282259264, -277.52446444621404, -835.4629774406583, -798.2601578090469, -743.5536832749287, -153.7951578754912, -756.5894169837755, -943.1542363359014, -823.517905630451, -288.85679304797685, -768.5328085764595, -1204.1137688729605, -934.9161909472253, -443.58345050194936, -651.4404676346456, -839.1540236347462, -661.3350695863073, -38.226454871799206, -378.2348928448099, -865.5794765999461, -646.7730085637761, -633.4022254108304, -739.8515594972633, -839.1560318842328, -265.61197054272236, -782.6977815684324, -696.5358771916611, -1206.7652582952967, -1180.607152561632, -27.90801546160948, -600.7932961478729, -697.1077933800372, -848.1807382952546, -600.9798477754322, -1013.5539385896801, -424.5943262436534, -894.9201241617797, -1130.951808341122, -179.94269380354768, -821.6717718499699, -818.9907345911096, -401.26551417264346, -969.5073172445958, -685.9929472952075, -709.1256612078726, -98.75576236302408, -781.8653256454529, -1235.7276093122002, -658.6891419625948, -786.051903781081, -484.12683135321646, -526.809171463445, -646.008826460501, -1071.9934045272225, -1182.936380028028, -978.3707109857398, -731.4538660333245, -569.498639131347, -353.0394073561127, -893.4414019558445, -832.6577359434519, -1224.9537645540045, -1022.5788345259679, -611.3540818442323, -191.06568466063413, -572.607990272063, -870.5749904008081, -595.4514734698317, -1011.5615509529454, -709.5190472377417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2787843756626782, "mean_inference_ms": 0.8914685665746093, "mean_action_processing_ms": 0.15788134418205374, "mean_env_wait_ms": 1.5336312734152244, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055310726165771484, "StateBufferConnector_ms": 0.0040738582611083984, "ViewRequirementAgentConnector_ms": 0.09695816040039062}, "num_episodes": 28, "episode_return_max": -27.90801546160948, "episode_return_min": -1274.7715139480335, "episode_return_mean": -701.8230320799107, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.60564276931893, "num_env_steps_trained_throughput_per_sec": 281.60564276931893, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 14158.224, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14158.154, "sample_time_ms": 2366.441, "learn_time_ms": 11775.694, "learn_throughput": 339.683, "synch_weights_time_ms": 15.241}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00003", "date": "2024-08-03_04-40-34", "timestamp": 1722640234, "time_this_iter_s": 14.212798833847046, "time_total_s": 141.65514755249023, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270c0d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 141.65514755249023, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 12.545, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 81.61897143026194, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.7488680807252726, "policy_loss": -0.009256163231718044, "vf_loss": 5.753172420958678, "vf_explained_var": 0.8973449772844712, "kl": 0.016562467533882835, "entropy": 1.6902255597213904, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -27.90801546160948, "episode_reward_min": -1366.373239410274, "episode_reward_mean": -740.4509499415663, "episode_len_mean": 140.53, "episode_media": {}, "episodes_timesteps_total": 14053, "policy_reward_min": {"policy_0": -1366.373239410274}, "policy_reward_max": {"policy_0": -27.90801546160948}, "policy_reward_mean": {"policy_0": -740.4509499415663}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-382.0403777804244, -813.1537988788302, -974.4797282259264, -277.52446444621404, -835.4629774406583, -798.2601578090469, -743.5536832749287, -153.7951578754912, -756.5894169837755, -943.1542363359014, -823.517905630451, -288.85679304797685, -768.5328085764595, -1204.1137688729605, -934.9161909472253, -443.58345050194936, -651.4404676346456, -839.1540236347462, -661.3350695863073, -38.226454871799206, -378.2348928448099, -865.5794765999461, -646.7730085637761, -633.4022254108304, -739.8515594972633, -839.1560318842328, -265.61197054272236, -782.6977815684324, -696.5358771916611, -1206.7652582952967, -1180.607152561632, -27.90801546160948, -600.7932961478729, -697.1077933800372, -848.1807382952546, -600.9798477754322, -1013.5539385896801, -424.5943262436534, -894.9201241617797, -1130.951808341122, -179.94269380354768, -821.6717718499699, -818.9907345911096, -401.26551417264346, -969.5073172445958, -685.9929472952075, -709.1256612078726, -98.75576236302408, -781.8653256454529, -1235.7276093122002, -658.6891419625948, -786.051903781081, -484.12683135321646, -526.809171463445, -646.008826460501, -1071.9934045272225, -1182.936380028028, -978.3707109857398, -731.4538660333245, -569.498639131347, -353.0394073561127, -893.4414019558445, -832.6577359434519, -1224.9537645540045, -1022.5788345259679, -611.3540818442323, -191.06568466063413, -572.607990272063, -870.5749904008081, -595.4514734698317, -1011.5615509529454, -709.5190472377417, -1366.373239410274, -846.0500604577759, -414.0826893310212, -830.6560666284923, -994.0541227409602, -889.3710302988891, -705.7401770391858, -936.2900442986006, -1041.0570915973324, -728.4842704085056, -1053.086155899871, -157.27728081867474, -471.6185667510668, -923.8478015723532, -1022.6329073279751, -156.87718719113386, -968.5342115463754, -1185.8910612707532, -740.209118895323, -800.7498696509332, -1079.9854988992922, -651.4518507310338, -790.8473262884938, -485.31789953230214, -85.41893039267863, -1245.0563438699849, -1125.8569569073748, -1314.7910023014256], "episode_lengths": [110, 150, 150, 86, 150, 150, 150, 82, 150, 150, 150, 88, 150, 150, 150, 143, 150, 150, 150, 41, 118, 150, 150, 146, 150, 150, 103, 150, 150, 150, 150, 56, 150, 150, 150, 126, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 143, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 138, 84, 150, 150, 150], "policy_policy_0_reward": [-382.0403777804244, -813.1537988788302, -974.4797282259264, -277.52446444621404, -835.4629774406583, -798.2601578090469, -743.5536832749287, -153.7951578754912, -756.5894169837755, -943.1542363359014, -823.517905630451, -288.85679304797685, -768.5328085764595, -1204.1137688729605, -934.9161909472253, -443.58345050194936, -651.4404676346456, -839.1540236347462, -661.3350695863073, -38.226454871799206, -378.2348928448099, -865.5794765999461, -646.7730085637761, -633.4022254108304, -739.8515594972633, -839.1560318842328, -265.61197054272236, -782.6977815684324, -696.5358771916611, -1206.7652582952967, -1180.607152561632, -27.90801546160948, -600.7932961478729, -697.1077933800372, -848.1807382952546, -600.9798477754322, -1013.5539385896801, -424.5943262436534, -894.9201241617797, -1130.951808341122, -179.94269380354768, -821.6717718499699, -818.9907345911096, -401.26551417264346, -969.5073172445958, -685.9929472952075, -709.1256612078726, -98.75576236302408, -781.8653256454529, -1235.7276093122002, -658.6891419625948, -786.051903781081, -484.12683135321646, -526.809171463445, -646.008826460501, -1071.9934045272225, -1182.936380028028, -978.3707109857398, -731.4538660333245, -569.498639131347, -353.0394073561127, -893.4414019558445, -832.6577359434519, -1224.9537645540045, -1022.5788345259679, -611.3540818442323, -191.06568466063413, -572.607990272063, -870.5749904008081, -595.4514734698317, -1011.5615509529454, -709.5190472377417, -1366.373239410274, -846.0500604577759, -414.0826893310212, -830.6560666284923, -994.0541227409602, -889.3710302988891, -705.7401770391858, -936.2900442986006, -1041.0570915973324, -728.4842704085056, -1053.086155899871, -157.27728081867474, -471.6185667510668, -923.8478015723532, -1022.6329073279751, -156.87718719113386, -968.5342115463754, -1185.8910612707532, -740.209118895323, -800.7498696509332, -1079.9854988992922, -651.4518507310338, -790.8473262884938, -485.31789953230214, -85.41893039267863, -1245.0563438699849, -1125.8569569073748, -1314.7910023014256]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2789422815030107, "mean_inference_ms": 0.8936942882672213, "mean_action_processing_ms": 0.1578219207344033, "mean_env_wait_ms": 1.5357961100055846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005593538284301758, "StateBufferConnector_ms": 0.004109382629394531, "ViewRequirementAgentConnector_ms": 0.09801101684570312}, "num_episodes": 28, "episode_return_max": -27.90801546160948, "episode_return_min": -1366.373239410274, "episode_return_mean": -740.4509499415663, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.50309542872344, "num_env_steps_trained_throughput_per_sec": 281.50309542872344, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 14171.521, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14171.449, "sample_time_ms": 2378.542, "learn_time_ms": 11777.363, "learn_throughput": 339.635, "synch_weights_time_ms": 14.766}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00003", "date": "2024-08-03_04-40-48", "timestamp": 1722640248, "time_this_iter_s": 14.216564178466797, "time_total_s": 155.87171173095703, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327651b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 155.87171173095703, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 12.547619047619047, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 125.17715086738268, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.892309050013622, "policy_loss": -0.009795838233549148, "vf_loss": 4.897609782715638, "vf_explained_var": 0.9662135462587078, "kl": 0.015037651308860719, "entropy": 1.6206966940313579, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -23.783264959954938, "episode_reward_min": -1366.373239410274, "episode_reward_mean": -762.5654165433145, "episode_len_mean": 142.01, "episode_media": {}, "episodes_timesteps_total": 14201, "policy_reward_min": {"policy_0": -1366.373239410274}, "policy_reward_max": {"policy_0": -23.783264959954938}, "policy_reward_mean": {"policy_0": -762.5654165433145}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1180.607152561632, -27.90801546160948, -600.7932961478729, -697.1077933800372, -848.1807382952546, -600.9798477754322, -1013.5539385896801, -424.5943262436534, -894.9201241617797, -1130.951808341122, -179.94269380354768, -821.6717718499699, -818.9907345911096, -401.26551417264346, -969.5073172445958, -685.9929472952075, -709.1256612078726, -98.75576236302408, -781.8653256454529, -1235.7276093122002, -658.6891419625948, -786.051903781081, -484.12683135321646, -526.809171463445, -646.008826460501, -1071.9934045272225, -1182.936380028028, -978.3707109857398, -731.4538660333245, -569.498639131347, -353.0394073561127, -893.4414019558445, -832.6577359434519, -1224.9537645540045, -1022.5788345259679, -611.3540818442323, -191.06568466063413, -572.607990272063, -870.5749904008081, -595.4514734698317, -1011.5615509529454, -709.5190472377417, -1366.373239410274, -846.0500604577759, -414.0826893310212, -830.6560666284923, -994.0541227409602, -889.3710302988891, -705.7401770391858, -936.2900442986006, -1041.0570915973324, -728.4842704085056, -1053.086155899871, -157.27728081867474, -471.6185667510668, -923.8478015723532, -1022.6329073279751, -156.87718719113386, -968.5342115463754, -1185.8910612707532, -740.209118895323, -800.7498696509332, -1079.9854988992922, -651.4518507310338, -790.8473262884938, -485.31789953230214, -85.41893039267863, -1245.0563438699849, -1125.8569569073748, -1314.7910023014256, -358.4451484676083, -638.5638376495843, -453.95640114003635, -699.2707658230839, -797.0520388544096, -1222.6432119637307, -1151.961800994221, -1082.1476207484739, -864.8493288781422, -109.61433156115687, -1053.9634150371783, -286.9672948241652, -1045.1106453834288, -987.8472734026201, -944.8785214704916, -979.273407954981, -931.566483353815, -1199.8450106807873, -950.5401094589, -443.35124147388433, -23.783264959954938, -224.57734769778844, -716.5879094348634, -881.573135212741, -969.3685808243297, -747.638585708598, -727.4080856076772, -842.1287350077806, -730.9220555845806, -531.9100857705179], "episode_lengths": [150, 56, 150, 150, 150, 126, 150, 150, 150, 150, 104, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 143, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 138, 84, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 90, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 45, 92, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1180.607152561632, -27.90801546160948, -600.7932961478729, -697.1077933800372, -848.1807382952546, -600.9798477754322, -1013.5539385896801, -424.5943262436534, -894.9201241617797, -1130.951808341122, -179.94269380354768, -821.6717718499699, -818.9907345911096, -401.26551417264346, -969.5073172445958, -685.9929472952075, -709.1256612078726, -98.75576236302408, -781.8653256454529, -1235.7276093122002, -658.6891419625948, -786.051903781081, -484.12683135321646, -526.809171463445, -646.008826460501, -1071.9934045272225, -1182.936380028028, -978.3707109857398, -731.4538660333245, -569.498639131347, -353.0394073561127, -893.4414019558445, -832.6577359434519, -1224.9537645540045, -1022.5788345259679, -611.3540818442323, -191.06568466063413, -572.607990272063, -870.5749904008081, -595.4514734698317, -1011.5615509529454, -709.5190472377417, -1366.373239410274, -846.0500604577759, -414.0826893310212, -830.6560666284923, -994.0541227409602, -889.3710302988891, -705.7401770391858, -936.2900442986006, -1041.0570915973324, -728.4842704085056, -1053.086155899871, -157.27728081867474, -471.6185667510668, -923.8478015723532, -1022.6329073279751, -156.87718719113386, -968.5342115463754, -1185.8910612707532, -740.209118895323, -800.7498696509332, -1079.9854988992922, -651.4518507310338, -790.8473262884938, -485.31789953230214, -85.41893039267863, -1245.0563438699849, -1125.8569569073748, -1314.7910023014256, -358.4451484676083, -638.5638376495843, -453.95640114003635, -699.2707658230839, -797.0520388544096, -1222.6432119637307, -1151.961800994221, -1082.1476207484739, -864.8493288781422, -109.61433156115687, -1053.9634150371783, -286.9672948241652, -1045.1106453834288, -987.8472734026201, -944.8785214704916, -979.273407954981, -931.566483353815, -1199.8450106807873, -950.5401094589, -443.35124147388433, -23.783264959954938, -224.57734769778844, -716.5879094348634, -881.573135212741, -969.3685808243297, -747.638585708598, -727.4080856076772, -842.1287350077806, -730.9220555845806, -531.9100857705179]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27914265750952305, "mean_inference_ms": 0.8906516795079449, "mean_action_processing_ms": 0.1576934860703531, "mean_env_wait_ms": 1.538432924676381, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005528926849365234, "StateBufferConnector_ms": 0.004127979278564453, "ViewRequirementAgentConnector_ms": 0.09827923774719238}, "num_episodes": 30, "episode_return_max": -23.783264959954938, "episode_return_min": -1366.373239410274, "episode_return_mean": -762.5654165433145, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.06987408415597, "num_env_steps_trained_throughput_per_sec": 286.06987408415597, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 14148.503, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14148.433, "sample_time_ms": 2387.119, "learn_time_ms": 11745.787, "learn_throughput": 340.548, "synch_weights_time_ms": 14.749}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00003", "date": "2024-08-03_04-41-02", "timestamp": 1722640262, "time_this_iter_s": 13.98943281173706, "time_total_s": 169.8611445426941, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c787400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 169.8611445426941, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 12.69, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.8615151266257, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.010579623281956, "policy_loss": -0.009258291080671673, "vf_loss": 5.015384011715651, "vf_explained_var": 0.9396003807584444, "kl": 0.01489731088052699, "entropy": 1.5269366757323344, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -23.783264959954938, "episode_reward_min": -1366.373239410274, "episode_reward_mean": -785.1173190688368, "episode_len_mean": 143.47, "episode_media": {}, "episodes_timesteps_total": 14347, "policy_reward_min": {"policy_0": -1366.373239410274}, "policy_reward_max": {"policy_0": -23.783264959954938}, "policy_reward_mean": {"policy_0": -785.1173190688368}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1182.936380028028, -978.3707109857398, -731.4538660333245, -569.498639131347, -353.0394073561127, -893.4414019558445, -832.6577359434519, -1224.9537645540045, -1022.5788345259679, -611.3540818442323, -191.06568466063413, -572.607990272063, -870.5749904008081, -595.4514734698317, -1011.5615509529454, -709.5190472377417, -1366.373239410274, -846.0500604577759, -414.0826893310212, -830.6560666284923, -994.0541227409602, -889.3710302988891, -705.7401770391858, -936.2900442986006, -1041.0570915973324, -728.4842704085056, -1053.086155899871, -157.27728081867474, -471.6185667510668, -923.8478015723532, -1022.6329073279751, -156.87718719113386, -968.5342115463754, -1185.8910612707532, -740.209118895323, -800.7498696509332, -1079.9854988992922, -651.4518507310338, -790.8473262884938, -485.31789953230214, -85.41893039267863, -1245.0563438699849, -1125.8569569073748, -1314.7910023014256, -358.4451484676083, -638.5638376495843, -453.95640114003635, -699.2707658230839, -797.0520388544096, -1222.6432119637307, -1151.961800994221, -1082.1476207484739, -864.8493288781422, -109.61433156115687, -1053.9634150371783, -286.9672948241652, -1045.1106453834288, -987.8472734026201, -944.8785214704916, -979.273407954981, -931.566483353815, -1199.8450106807873, -950.5401094589, -443.35124147388433, -23.783264959954938, -224.57734769778844, -716.5879094348634, -881.573135212741, -969.3685808243297, -747.638585708598, -727.4080856076772, -842.1287350077806, -730.9220555845806, -531.9100857705179, -903.482218385482, -547.8619544055396, -567.8544475305231, -605.4333257310195, -980.8812863246308, -1137.812057047242, -425.9281984558242, -806.0271120663509, -1247.3050051737841, -799.104359723123, -766.4214764703933, -1010.9929937975116, -1033.6729622353494, -343.89696917923135, -1172.8897925335807, -734.247896342284, -239.81721153077075, -674.1014788469929, -1024.5078070343457, -969.6646022516732, -1278.490336612246, -634.4846168656337, -405.2608068930101, -490.389691935556, -1193.8905997221343, -556.8927034497473], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 143, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 138, 84, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 90, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 45, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1182.936380028028, -978.3707109857398, -731.4538660333245, -569.498639131347, -353.0394073561127, -893.4414019558445, -832.6577359434519, -1224.9537645540045, -1022.5788345259679, -611.3540818442323, -191.06568466063413, -572.607990272063, -870.5749904008081, -595.4514734698317, -1011.5615509529454, -709.5190472377417, -1366.373239410274, -846.0500604577759, -414.0826893310212, -830.6560666284923, -994.0541227409602, -889.3710302988891, -705.7401770391858, -936.2900442986006, -1041.0570915973324, -728.4842704085056, -1053.086155899871, -157.27728081867474, -471.6185667510668, -923.8478015723532, -1022.6329073279751, -156.87718719113386, -968.5342115463754, -1185.8910612707532, -740.209118895323, -800.7498696509332, -1079.9854988992922, -651.4518507310338, -790.8473262884938, -485.31789953230214, -85.41893039267863, -1245.0563438699849, -1125.8569569073748, -1314.7910023014256, -358.4451484676083, -638.5638376495843, -453.95640114003635, -699.2707658230839, -797.0520388544096, -1222.6432119637307, -1151.961800994221, -1082.1476207484739, -864.8493288781422, -109.61433156115687, -1053.9634150371783, -286.9672948241652, -1045.1106453834288, -987.8472734026201, -944.8785214704916, -979.273407954981, -931.566483353815, -1199.8450106807873, -950.5401094589, -443.35124147388433, -23.783264959954938, -224.57734769778844, -716.5879094348634, -881.573135212741, -969.3685808243297, -747.638585708598, -727.4080856076772, -842.1287350077806, -730.9220555845806, -531.9100857705179, -903.482218385482, -547.8619544055396, -567.8544475305231, -605.4333257310195, -980.8812863246308, -1137.812057047242, -425.9281984558242, -806.0271120663509, -1247.3050051737841, -799.104359723123, -766.4214764703933, -1010.9929937975116, -1033.6729622353494, -343.89696917923135, -1172.8897925335807, -734.247896342284, -239.81721153077075, -674.1014788469929, -1024.5078070343457, -969.6646022516732, -1278.490336612246, -634.4846168656337, -405.2608068930101, -490.389691935556, -1193.8905997221343, -556.8927034497473]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27914305124495015, "mean_inference_ms": 0.8884447786060307, "mean_action_processing_ms": 0.15762083986870756, "mean_env_wait_ms": 1.540749507654569, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005579948425292969, "StateBufferConnector_ms": 0.004133939743041992, "ViewRequirementAgentConnector_ms": 0.09851384162902832}, "num_episodes": 26, "episode_return_max": -23.783264959954938, "episode_return_min": -1366.373239410274, "episode_return_mean": -785.1173190688368, "episodes_this_iter": 26}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.62835899625196, "num_env_steps_trained_throughput_per_sec": 278.62835899625196, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 14169.374, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14169.307, "sample_time_ms": 2384.908, "learn_time_ms": 11768.878, "learn_throughput": 339.879, "synch_weights_time_ms": 14.742}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00003", "date": "2024-08-03_04-41-17", "timestamp": 1722640277, "time_this_iter_s": 14.365052223205566, "time_total_s": 184.22619676589966, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814f010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 184.22619676589966, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 12.645000000000001, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 101.84065951506297, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.077793855716785, "policy_loss": -0.015006657253737406, "vf_loss": 5.087239850064119, "vf_explained_var": 0.9490971732263763, "kl": 0.01858213976253563, "entropy": 1.3965838570147753, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -13.846685224369512, "episode_reward_min": -1314.7910023014256, "episode_reward_mean": -746.2699267647728, "episode_len_mean": 140.14, "episode_media": {}, "episodes_timesteps_total": 14014, "policy_reward_min": {"policy_0": -1314.7910023014256}, "policy_reward_max": {"policy_0": -13.846685224369512}, "policy_reward_mean": {"policy_0": -746.2699267647728}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-968.5342115463754, -1185.8910612707532, -740.209118895323, -800.7498696509332, -1079.9854988992922, -651.4518507310338, -790.8473262884938, -485.31789953230214, -85.41893039267863, -1245.0563438699849, -1125.8569569073748, -1314.7910023014256, -358.4451484676083, -638.5638376495843, -453.95640114003635, -699.2707658230839, -797.0520388544096, -1222.6432119637307, -1151.961800994221, -1082.1476207484739, -864.8493288781422, -109.61433156115687, -1053.9634150371783, -286.9672948241652, -1045.1106453834288, -987.8472734026201, -944.8785214704916, -979.273407954981, -931.566483353815, -1199.8450106807873, -950.5401094589, -443.35124147388433, -23.783264959954938, -224.57734769778844, -716.5879094348634, -881.573135212741, -969.3685808243297, -747.638585708598, -727.4080856076772, -842.1287350077806, -730.9220555845806, -531.9100857705179, -903.482218385482, -547.8619544055396, -567.8544475305231, -605.4333257310195, -980.8812863246308, -1137.812057047242, -425.9281984558242, -806.0271120663509, -1247.3050051737841, -799.104359723123, -766.4214764703933, -1010.9929937975116, -1033.6729622353494, -343.89696917923135, -1172.8897925335807, -734.247896342284, -239.81721153077075, -674.1014788469929, -1024.5078070343457, -969.6646022516732, -1278.490336612246, -634.4846168656337, -405.2608068930101, -490.389691935556, -1193.8905997221343, -556.8927034497473, -315.2663750177335, -432.33119029704494, -425.4720896997314, -1243.198267727116, -647.6993391907881, -438.96583505948666, -753.8748267698735, -1098.5035546405356, -993.5290274519142, -241.12854786576204, -542.3321654202649, -904.2191902744572, -1042.4192408308454, -37.23223531753839, -128.9557525583258, -468.54070184946534, -230.3253479085657, -521.8708379929689, -13.846685224369512, -838.8872138706773, -857.1980503130513, -1194.5523055488586, -1143.0697818904932, -690.454264657505, -644.4952357528026, -1039.827164662563, -973.7641727173849, -151.28579166807893, -1160.1817592986172, -818.0636847988511, -401.74600828987127, -610.5883761522373], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 138, 84, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 90, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 45, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 105, 150, 150, 150, 122, 150, 150, 150, 87, 137, 150, 150, 64, 73, 136, 77, 150, 49, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150], "policy_policy_0_reward": [-968.5342115463754, -1185.8910612707532, -740.209118895323, -800.7498696509332, -1079.9854988992922, -651.4518507310338, -790.8473262884938, -485.31789953230214, -85.41893039267863, -1245.0563438699849, -1125.8569569073748, -1314.7910023014256, -358.4451484676083, -638.5638376495843, -453.95640114003635, -699.2707658230839, -797.0520388544096, -1222.6432119637307, -1151.961800994221, -1082.1476207484739, -864.8493288781422, -109.61433156115687, -1053.9634150371783, -286.9672948241652, -1045.1106453834288, -987.8472734026201, -944.8785214704916, -979.273407954981, -931.566483353815, -1199.8450106807873, -950.5401094589, -443.35124147388433, -23.783264959954938, -224.57734769778844, -716.5879094348634, -881.573135212741, -969.3685808243297, -747.638585708598, -727.4080856076772, -842.1287350077806, -730.9220555845806, -531.9100857705179, -903.482218385482, -547.8619544055396, -567.8544475305231, -605.4333257310195, -980.8812863246308, -1137.812057047242, -425.9281984558242, -806.0271120663509, -1247.3050051737841, -799.104359723123, -766.4214764703933, -1010.9929937975116, -1033.6729622353494, -343.89696917923135, -1172.8897925335807, -734.247896342284, -239.81721153077075, -674.1014788469929, -1024.5078070343457, -969.6646022516732, -1278.490336612246, -634.4846168656337, -405.2608068930101, -490.389691935556, -1193.8905997221343, -556.8927034497473, -315.2663750177335, -432.33119029704494, -425.4720896997314, -1243.198267727116, -647.6993391907881, -438.96583505948666, -753.8748267698735, -1098.5035546405356, -993.5290274519142, -241.12854786576204, -542.3321654202649, -904.2191902744572, -1042.4192408308454, -37.23223531753839, -128.9557525583258, -468.54070184946534, -230.3253479085657, -521.8708379929689, -13.846685224369512, -838.8872138706773, -857.1980503130513, -1194.5523055488586, -1143.0697818904932, -690.454264657505, -644.4952357528026, -1039.827164662563, -973.7641727173849, -151.28579166807893, -1160.1817592986172, -818.0636847988511, -401.74600828987127, -610.5883761522373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2792167448233154, "mean_inference_ms": 0.8861139926665671, "mean_action_processing_ms": 0.1575149904564048, "mean_env_wait_ms": 1.5435002453957838, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005316019058227539, "StateBufferConnector_ms": 0.0041964054107666016, "ViewRequirementAgentConnector_ms": 0.09967160224914551}, "num_episodes": 32, "episode_return_max": -13.846685224369512, "episode_return_min": -1314.7910023014256, "episode_return_mean": -746.2699267647728, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.63339153715395, "num_env_steps_trained_throughput_per_sec": 281.63339153715395, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 14183.354, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14183.286, "sample_time_ms": 2384.854, "learn_time_ms": 11782.966, "learn_throughput": 339.473, "synch_weights_time_ms": 14.686}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00003", "date": "2024-08-03_04-41-31", "timestamp": 1722640291, "time_this_iter_s": 14.210301876068115, "time_total_s": 198.43649864196777, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270ee60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 198.43649864196777, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 12.919999999999998, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 149.3572994053364, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.34087954411904, "policy_loss": -0.008715358758733298, "vf_loss": 4.343943617244562, "vf_explained_var": 0.9650820532192786, "kl": 0.018884801413939098, "entropy": 1.416258193552494, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -13.846685224369512, "episode_reward_min": -1278.490336612246, "episode_reward_mean": -705.6972135230525, "episode_len_mean": 138.28, "episode_media": {}, "episodes_timesteps_total": 13828, "policy_reward_min": {"policy_0": -1278.490336612246}, "policy_reward_max": {"policy_0": -13.846685224369512}, "policy_reward_mean": {"policy_0": -705.6972135230525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-931.566483353815, -1199.8450106807873, -950.5401094589, -443.35124147388433, -23.783264959954938, -224.57734769778844, -716.5879094348634, -881.573135212741, -969.3685808243297, -747.638585708598, -727.4080856076772, -842.1287350077806, -730.9220555845806, -531.9100857705179, -903.482218385482, -547.8619544055396, -567.8544475305231, -605.4333257310195, -980.8812863246308, -1137.812057047242, -425.9281984558242, -806.0271120663509, -1247.3050051737841, -799.104359723123, -766.4214764703933, -1010.9929937975116, -1033.6729622353494, -343.89696917923135, -1172.8897925335807, -734.247896342284, -239.81721153077075, -674.1014788469929, -1024.5078070343457, -969.6646022516732, -1278.490336612246, -634.4846168656337, -405.2608068930101, -490.389691935556, -1193.8905997221343, -556.8927034497473, -315.2663750177335, -432.33119029704494, -425.4720896997314, -1243.198267727116, -647.6993391907881, -438.96583505948666, -753.8748267698735, -1098.5035546405356, -993.5290274519142, -241.12854786576204, -542.3321654202649, -904.2191902744572, -1042.4192408308454, -37.23223531753839, -128.9557525583258, -468.54070184946534, -230.3253479085657, -521.8708379929689, -13.846685224369512, -838.8872138706773, -857.1980503130513, -1194.5523055488586, -1143.0697818904932, -690.454264657505, -644.4952357528026, -1039.827164662563, -973.7641727173849, -151.28579166807893, -1160.1817592986172, -818.0636847988511, -401.74600828987127, -610.5883761522373, -571.1886088573997, -521.9893893677555, -634.0828865621764, -753.0781672844735, -1138.1039986600704, -499.6466120424173, -888.4568262709138, -928.5749816267924, -1212.6964051432187, -14.142472815079184, -1208.4448571193068, -437.09523206259644, -848.5146994769566, -57.33035551325543, -824.2084965774923, -502.6131801122725, -880.8016063557037, -81.72955014878929, -632.4016858975931, -623.318327732058, -60.976741246456214, -430.17504178870547, -871.8309329292257, -1031.8809131257249, -609.3755837179824, -891.2658150399496, -1218.054529753855, -721.4058930390596], "episode_lengths": [150, 150, 150, 150, 45, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 105, 150, 150, 150, 122, 150, 150, 150, 87, 137, 150, 150, 64, 73, 136, 77, 150, 49, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 42, 150, 126, 150, 66, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-931.566483353815, -1199.8450106807873, -950.5401094589, -443.35124147388433, -23.783264959954938, -224.57734769778844, -716.5879094348634, -881.573135212741, -969.3685808243297, -747.638585708598, -727.4080856076772, -842.1287350077806, -730.9220555845806, -531.9100857705179, -903.482218385482, -547.8619544055396, -567.8544475305231, -605.4333257310195, -980.8812863246308, -1137.812057047242, -425.9281984558242, -806.0271120663509, -1247.3050051737841, -799.104359723123, -766.4214764703933, -1010.9929937975116, -1033.6729622353494, -343.89696917923135, -1172.8897925335807, -734.247896342284, -239.81721153077075, -674.1014788469929, -1024.5078070343457, -969.6646022516732, -1278.490336612246, -634.4846168656337, -405.2608068930101, -490.389691935556, -1193.8905997221343, -556.8927034497473, -315.2663750177335, -432.33119029704494, -425.4720896997314, -1243.198267727116, -647.6993391907881, -438.96583505948666, -753.8748267698735, -1098.5035546405356, -993.5290274519142, -241.12854786576204, -542.3321654202649, -904.2191902744572, -1042.4192408308454, -37.23223531753839, -128.9557525583258, -468.54070184946534, -230.3253479085657, -521.8708379929689, -13.846685224369512, -838.8872138706773, -857.1980503130513, -1194.5523055488586, -1143.0697818904932, -690.454264657505, -644.4952357528026, -1039.827164662563, -973.7641727173849, -151.28579166807893, -1160.1817592986172, -818.0636847988511, -401.74600828987127, -610.5883761522373, -571.1886088573997, -521.9893893677555, -634.0828865621764, -753.0781672844735, -1138.1039986600704, -499.6466120424173, -888.4568262709138, -928.5749816267924, -1212.6964051432187, -14.142472815079184, -1208.4448571193068, -437.09523206259644, -848.5146994769566, -57.33035551325543, -824.2084965774923, -502.6131801122725, -880.8016063557037, -81.72955014878929, -632.4016858975931, -623.318327732058, -60.976741246456214, -430.17504178870547, -871.8309329292257, -1031.8809131257249, -609.3755837179824, -891.2658150399496, -1218.054529753855, -721.4058930390596]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2793202198397916, "mean_inference_ms": 0.8845460960478755, "mean_action_processing_ms": 0.15751525537017075, "mean_env_wait_ms": 1.5441039461793822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005262136459350586, "StateBufferConnector_ms": 0.004130840301513672, "ViewRequirementAgentConnector_ms": 0.09784173965454102}, "num_episodes": 28, "episode_return_max": -13.846685224369512, "episode_return_min": -1278.490336612246, "episode_return_mean": -705.6972135230525, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.8893917030588, "num_env_steps_trained_throughput_per_sec": 281.8893917030588, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 14205.229, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14205.161, "sample_time_ms": 2384.425, "learn_time_ms": 11805.215, "learn_throughput": 338.833, "synch_weights_time_ms": 14.734}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00003", "date": "2024-08-03_04-41-45", "timestamp": 1722640305, "time_this_iter_s": 14.19771432876587, "time_total_s": 212.63421297073364, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270d750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 212.63421297073364, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 12.695, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 161.98696126540503, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.049916273355484, "policy_loss": -0.013922647887375206, "vf_loss": 5.058258774131536, "vf_explained_var": 0.9553832431013386, "kl": 0.018645009887829182, "entropy": 1.334430427228411, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -13.846685224369512, "episode_reward_min": -1278.490336612246, "episode_reward_mean": -682.5912292185005, "episode_len_mean": 136.33, "episode_media": {}, "episodes_timesteps_total": 13633, "policy_reward_min": {"policy_0": -1278.490336612246}, "policy_reward_max": {"policy_0": -13.846685224369512}, "policy_reward_mean": {"policy_0": -682.5912292185005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-734.247896342284, -239.81721153077075, -674.1014788469929, -1024.5078070343457, -969.6646022516732, -1278.490336612246, -634.4846168656337, -405.2608068930101, -490.389691935556, -1193.8905997221343, -556.8927034497473, -315.2663750177335, -432.33119029704494, -425.4720896997314, -1243.198267727116, -647.6993391907881, -438.96583505948666, -753.8748267698735, -1098.5035546405356, -993.5290274519142, -241.12854786576204, -542.3321654202649, -904.2191902744572, -1042.4192408308454, -37.23223531753839, -128.9557525583258, -468.54070184946534, -230.3253479085657, -521.8708379929689, -13.846685224369512, -838.8872138706773, -857.1980503130513, -1194.5523055488586, -1143.0697818904932, -690.454264657505, -644.4952357528026, -1039.827164662563, -973.7641727173849, -151.28579166807893, -1160.1817592986172, -818.0636847988511, -401.74600828987127, -610.5883761522373, -571.1886088573997, -521.9893893677555, -634.0828865621764, -753.0781672844735, -1138.1039986600704, -499.6466120424173, -888.4568262709138, -928.5749816267924, -1212.6964051432187, -14.142472815079184, -1208.4448571193068, -437.09523206259644, -848.5146994769566, -57.33035551325543, -824.2084965774923, -502.6131801122725, -880.8016063557037, -81.72955014878929, -632.4016858975931, -623.318327732058, -60.976741246456214, -430.17504178870547, -871.8309329292257, -1031.8809131257249, -609.3755837179824, -891.2658150399496, -1218.054529753855, -721.4058930390596, -979.9883858582965, -182.71217996030896, -285.25641772787384, -1218.8783374899065, -262.4517272995367, -950.4889913242329, -356.150056302718, -1051.4644342707459, -817.951940270387, -696.8543345404792, -1239.5838830405198, -1128.4797130344227, -639.9956075818717, -665.1781000624345, -1018.5470288565001, -982.4588127940539, -641.6062032093618, -471.7435049597519, -94.60685336047102, -640.3307268868288, -362.48241272926543, -897.0722382058511, -261.5098025280912, -666.665559300088, -243.54587872099364, -781.8642591792337, -994.5661657484594, -997.4815842801845, -430.2512198577273], "episode_lengths": [150, 113, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 105, 150, 150, 150, 122, 150, 150, 150, 87, 137, 150, 150, 64, 73, 136, 77, 150, 49, 150, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 42, 150, 126, 150, 66, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 98, 150, 95, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 146, 150, 89, 150, 102, 150, 150, 150, 130], "policy_policy_0_reward": [-734.247896342284, -239.81721153077075, -674.1014788469929, -1024.5078070343457, -969.6646022516732, -1278.490336612246, -634.4846168656337, -405.2608068930101, -490.389691935556, -1193.8905997221343, -556.8927034497473, -315.2663750177335, -432.33119029704494, -425.4720896997314, -1243.198267727116, -647.6993391907881, -438.96583505948666, -753.8748267698735, -1098.5035546405356, -993.5290274519142, -241.12854786576204, -542.3321654202649, -904.2191902744572, -1042.4192408308454, -37.23223531753839, -128.9557525583258, -468.54070184946534, -230.3253479085657, -521.8708379929689, -13.846685224369512, -838.8872138706773, -857.1980503130513, -1194.5523055488586, -1143.0697818904932, -690.454264657505, -644.4952357528026, -1039.827164662563, -973.7641727173849, -151.28579166807893, -1160.1817592986172, -818.0636847988511, -401.74600828987127, -610.5883761522373, -571.1886088573997, -521.9893893677555, -634.0828865621764, -753.0781672844735, -1138.1039986600704, -499.6466120424173, -888.4568262709138, -928.5749816267924, -1212.6964051432187, -14.142472815079184, -1208.4448571193068, -437.09523206259644, -848.5146994769566, -57.33035551325543, -824.2084965774923, -502.6131801122725, -880.8016063557037, -81.72955014878929, -632.4016858975931, -623.318327732058, -60.976741246456214, -430.17504178870547, -871.8309329292257, -1031.8809131257249, -609.3755837179824, -891.2658150399496, -1218.054529753855, -721.4058930390596, -979.9883858582965, -182.71217996030896, -285.25641772787384, -1218.8783374899065, -262.4517272995367, -950.4889913242329, -356.150056302718, -1051.4644342707459, -817.951940270387, -696.8543345404792, -1239.5838830405198, -1128.4797130344227, -639.9956075818717, -665.1781000624345, -1018.5470288565001, -982.4588127940539, -641.6062032093618, -471.7435049597519, -94.60685336047102, -640.3307268868288, -362.48241272926543, -897.0722382058511, -261.5098025280912, -666.665559300088, -243.54587872099364, -781.8642591792337, -994.5661657484594, -997.4815842801845, -430.2512198577273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2792211883192362, "mean_inference_ms": 0.8832106380021163, "mean_action_processing_ms": 0.15749868082675922, "mean_env_wait_ms": 1.545316558468329, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004992961883544922, "StateBufferConnector_ms": 0.004105567932128906, "ViewRequirementAgentConnector_ms": 0.09709525108337402}, "num_episodes": 29, "episode_return_max": -13.846685224369512, "episode_return_min": -1278.490336612246, "episode_return_mean": -682.5912292185005, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.4506896057618, "num_env_steps_trained_throughput_per_sec": 298.4506896057618, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 14124.141, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14124.069, "sample_time_ms": 2388.214, "learn_time_ms": 11720.262, "learn_throughput": 341.289, "synch_weights_time_ms": 14.794}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00003", "date": "2024-08-03_04-41-59", "timestamp": 1722640319, "time_this_iter_s": 13.410146951675415, "time_total_s": 226.04435992240906, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327645e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 226.04435992240906, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.755, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 145.52684242328007, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.769528353214264, "policy_loss": -0.006949302917928435, "vf_loss": 4.771590047826369, "vf_explained_var": 0.9605589682857195, "kl": 0.016335674299322516, "entropy": 1.3091671694690983, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -4.057244666706021, "episode_reward_min": -1239.5838830405198, "episode_reward_mean": -675.1008616898051, "episode_len_mean": 135.48, "episode_media": {}, "episodes_timesteps_total": 13548, "policy_reward_min": {"policy_0": -1239.5838830405198}, "policy_reward_max": {"policy_0": -4.057244666706021}, "policy_reward_mean": {"policy_0": -675.1008616898051}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1194.5523055488586, -1143.0697818904932, -690.454264657505, -644.4952357528026, -1039.827164662563, -973.7641727173849, -151.28579166807893, -1160.1817592986172, -818.0636847988511, -401.74600828987127, -610.5883761522373, -571.1886088573997, -521.9893893677555, -634.0828865621764, -753.0781672844735, -1138.1039986600704, -499.6466120424173, -888.4568262709138, -928.5749816267924, -1212.6964051432187, -14.142472815079184, -1208.4448571193068, -437.09523206259644, -848.5146994769566, -57.33035551325543, -824.2084965774923, -502.6131801122725, -880.8016063557037, -81.72955014878929, -632.4016858975931, -623.318327732058, -60.976741246456214, -430.17504178870547, -871.8309329292257, -1031.8809131257249, -609.3755837179824, -891.2658150399496, -1218.054529753855, -721.4058930390596, -979.9883858582965, -182.71217996030896, -285.25641772787384, -1218.8783374899065, -262.4517272995367, -950.4889913242329, -356.150056302718, -1051.4644342707459, -817.951940270387, -696.8543345404792, -1239.5838830405198, -1128.4797130344227, -639.9956075818717, -665.1781000624345, -1018.5470288565001, -982.4588127940539, -641.6062032093618, -471.7435049597519, -94.60685336047102, -640.3307268868288, -362.48241272926543, -897.0722382058511, -261.5098025280912, -666.665559300088, -243.54587872099364, -781.8642591792337, -994.5661657484594, -997.4815842801845, -430.2512198577273, -646.7562751527737, -50.75038838851484, -612.3879209506651, -1064.3261543128735, -564.3923956990244, -624.1839123644437, -191.70592840832657, -708.6673011893233, -1079.7484210945324, -184.45808319181327, -964.5186608369996, -260.3495658457527, -732.393663304319, -279.64476791325995, -69.28962911605818, -968.3187416731063, -635.6024954814557, -737.7054523737002, -112.56309450565581, -439.09093956054784, -979.540433482484, -726.1879894663235, -868.024199424825, -637.5884463125315, -871.40858065168, -811.3802495360154, -454.78954762061176, -4.057244666706021, -527.4792685806666, -973.561551913931, -773.0605168320119, -1074.5756540444354], "episode_lengths": [150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 42, 150, 126, 150, 66, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 98, 150, 95, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 146, 150, 89, 150, 102, 150, 150, 150, 130, 150, 71, 150, 150, 150, 150, 66, 150, 150, 64, 150, 91, 150, 122, 71, 150, 150, 150, 81, 113, 150, 150, 150, 150, 150, 149, 150, 40, 150, 150, 150, 150], "policy_policy_0_reward": [-1194.5523055488586, -1143.0697818904932, -690.454264657505, -644.4952357528026, -1039.827164662563, -973.7641727173849, -151.28579166807893, -1160.1817592986172, -818.0636847988511, -401.74600828987127, -610.5883761522373, -571.1886088573997, -521.9893893677555, -634.0828865621764, -753.0781672844735, -1138.1039986600704, -499.6466120424173, -888.4568262709138, -928.5749816267924, -1212.6964051432187, -14.142472815079184, -1208.4448571193068, -437.09523206259644, -848.5146994769566, -57.33035551325543, -824.2084965774923, -502.6131801122725, -880.8016063557037, -81.72955014878929, -632.4016858975931, -623.318327732058, -60.976741246456214, -430.17504178870547, -871.8309329292257, -1031.8809131257249, -609.3755837179824, -891.2658150399496, -1218.054529753855, -721.4058930390596, -979.9883858582965, -182.71217996030896, -285.25641772787384, -1218.8783374899065, -262.4517272995367, -950.4889913242329, -356.150056302718, -1051.4644342707459, -817.951940270387, -696.8543345404792, -1239.5838830405198, -1128.4797130344227, -639.9956075818717, -665.1781000624345, -1018.5470288565001, -982.4588127940539, -641.6062032093618, -471.7435049597519, -94.60685336047102, -640.3307268868288, -362.48241272926543, -897.0722382058511, -261.5098025280912, -666.665559300088, -243.54587872099364, -781.8642591792337, -994.5661657484594, -997.4815842801845, -430.2512198577273, -646.7562751527737, -50.75038838851484, -612.3879209506651, -1064.3261543128735, -564.3923956990244, -624.1839123644437, -191.70592840832657, -708.6673011893233, -1079.7484210945324, -184.45808319181327, -964.5186608369996, -260.3495658457527, -732.393663304319, -279.64476791325995, -69.28962911605818, -968.3187416731063, -635.6024954814557, -737.7054523737002, -112.56309450565581, -439.09093956054784, -979.540433482484, -726.1879894663235, -868.024199424825, -637.5884463125315, -871.40858065168, -811.3802495360154, -454.78954762061176, -4.057244666706021, -527.4792685806666, -973.561551913931, -773.0605168320119, -1074.5756540444354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27908178561401376, "mean_inference_ms": 0.8817639595471212, "mean_action_processing_ms": 0.15745257994455727, "mean_env_wait_ms": 1.5458546798836377, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00504302978515625, "StateBufferConnector_ms": 0.004096031188964844, "ViewRequirementAgentConnector_ms": 0.09713006019592285}, "num_episodes": 32, "episode_return_max": -4.057244666706021, "episode_return_min": -1239.5838830405198, "episode_return_mean": -675.1008616898051, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.21059842301094, "num_env_steps_trained_throughput_per_sec": 305.21059842301094, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 14009.966, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14009.894, "sample_time_ms": 2375.395, "learn_time_ms": 11618.957, "learn_throughput": 344.265, "synch_weights_time_ms": 14.744}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00003", "date": "2024-08-03_04-42-12", "timestamp": 1722640332, "time_this_iter_s": 13.112387895584106, "time_total_s": 239.15674781799316, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b32764310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 239.15674781799316, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 12.905555555555555, "ram_util_percent": 16.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 160.3134011944135, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.120615960905949, "policy_loss": -0.010044154991434576, "vf_loss": 4.125985307494799, "vf_explained_var": 0.9660722722609838, "kl": 0.015626954361080924, "entropy": 1.3284396129349867, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -4.057244666706021, "episode_reward_min": -1239.5838830405198, "episode_reward_mean": -657.0037559907628, "episode_len_mean": 134.42, "episode_media": {}, "episodes_timesteps_total": 13442, "policy_reward_min": {"policy_0": -1239.5838830405198}, "policy_reward_max": {"policy_0": -4.057244666706021}, "policy_reward_mean": {"policy_0": -657.0037559907628}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-623.318327732058, -60.976741246456214, -430.17504178870547, -871.8309329292257, -1031.8809131257249, -609.3755837179824, -891.2658150399496, -1218.054529753855, -721.4058930390596, -979.9883858582965, -182.71217996030896, -285.25641772787384, -1218.8783374899065, -262.4517272995367, -950.4889913242329, -356.150056302718, -1051.4644342707459, -817.951940270387, -696.8543345404792, -1239.5838830405198, -1128.4797130344227, -639.9956075818717, -665.1781000624345, -1018.5470288565001, -982.4588127940539, -641.6062032093618, -471.7435049597519, -94.60685336047102, -640.3307268868288, -362.48241272926543, -897.0722382058511, -261.5098025280912, -666.665559300088, -243.54587872099364, -781.8642591792337, -994.5661657484594, -997.4815842801845, -430.2512198577273, -646.7562751527737, -50.75038838851484, -612.3879209506651, -1064.3261543128735, -564.3923956990244, -624.1839123644437, -191.70592840832657, -708.6673011893233, -1079.7484210945324, -184.45808319181327, -964.5186608369996, -260.3495658457527, -732.393663304319, -279.64476791325995, -69.28962911605818, -968.3187416731063, -635.6024954814557, -737.7054523737002, -112.56309450565581, -439.09093956054784, -979.540433482484, -726.1879894663235, -868.024199424825, -637.5884463125315, -871.40858065168, -811.3802495360154, -454.78954762061176, -4.057244666706021, -527.4792685806666, -973.561551913931, -773.0605168320119, -1074.5756540444354, -212.7796566646056, -800.5858197830253, -285.16159180291385, -844.7928125705876, -1119.8710671447732, -462.9570212559548, -948.0810340756722, -1196.3058254550422, -321.6363902807447, -486.36085057994933, -370.8098593126242, -228.18980037067303, -475.6972778899992, -142.28567871613214, -767.4235104077168, -711.4113162725528, -1151.272793778242, -763.1211721563441, -131.66778238948314, -429.18226385590015, -1147.451384778055, -785.5255247387189, -1034.8374912821873, -933.6067497880522, -727.1112306181086, -682.7692284567191, -892.2244851835027, -1035.8050733841717, -240.85815284921085, -323.6351415856159], "episode_lengths": [150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 98, 150, 95, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 146, 150, 89, 150, 102, 150, 150, 150, 130, 150, 71, 150, 150, 150, 150, 66, 150, 150, 64, 150, 91, 150, 122, 71, 150, 150, 150, 81, 113, 150, 150, 150, 150, 150, 149, 150, 40, 150, 150, 150, 150, 117, 150, 143, 150, 150, 150, 150, 150, 150, 150, 104, 93, 126, 75, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 146, 150, 150, 91, 85], "policy_policy_0_reward": [-623.318327732058, -60.976741246456214, -430.17504178870547, -871.8309329292257, -1031.8809131257249, -609.3755837179824, -891.2658150399496, -1218.054529753855, -721.4058930390596, -979.9883858582965, -182.71217996030896, -285.25641772787384, -1218.8783374899065, -262.4517272995367, -950.4889913242329, -356.150056302718, -1051.4644342707459, -817.951940270387, -696.8543345404792, -1239.5838830405198, -1128.4797130344227, -639.9956075818717, -665.1781000624345, -1018.5470288565001, -982.4588127940539, -641.6062032093618, -471.7435049597519, -94.60685336047102, -640.3307268868288, -362.48241272926543, -897.0722382058511, -261.5098025280912, -666.665559300088, -243.54587872099364, -781.8642591792337, -994.5661657484594, -997.4815842801845, -430.2512198577273, -646.7562751527737, -50.75038838851484, -612.3879209506651, -1064.3261543128735, -564.3923956990244, -624.1839123644437, -191.70592840832657, -708.6673011893233, -1079.7484210945324, -184.45808319181327, -964.5186608369996, -260.3495658457527, -732.393663304319, -279.64476791325995, -69.28962911605818, -968.3187416731063, -635.6024954814557, -737.7054523737002, -112.56309450565581, -439.09093956054784, -979.540433482484, -726.1879894663235, -868.024199424825, -637.5884463125315, -871.40858065168, -811.3802495360154, -454.78954762061176, -4.057244666706021, -527.4792685806666, -973.561551913931, -773.0605168320119, -1074.5756540444354, -212.7796566646056, -800.5858197830253, -285.16159180291385, -844.7928125705876, -1119.8710671447732, -462.9570212559548, -948.0810340756722, -1196.3058254550422, -321.6363902807447, -486.36085057994933, -370.8098593126242, -228.18980037067303, -475.6972778899992, -142.28567871613214, -767.4235104077168, -711.4113162725528, -1151.272793778242, -763.1211721563441, -131.66778238948314, -429.18226385590015, -1147.451384778055, -785.5255247387189, -1034.8374912821873, -933.6067497880522, -727.1112306181086, -682.7692284567191, -892.2244851835027, -1035.8050733841717, -240.85815284921085, -323.6351415856159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27878477922176403, "mean_inference_ms": 0.880737536147257, "mean_action_processing_ms": 0.15744593182128871, "mean_env_wait_ms": 1.546275909010833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005258798599243164, "StateBufferConnector_ms": 0.004086971282958984, "ViewRequirementAgentConnector_ms": 0.09671139717102051}, "num_episodes": 30, "episode_return_max": -4.057244666706021, "episode_return_min": -1239.5838830405198, "episode_return_mean": -657.0037559907628, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.27757293311987, "num_env_steps_trained_throughput_per_sec": 285.27757293311987, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13971.01, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13970.936, "sample_time_ms": 2353.961, "learn_time_ms": 11601.545, "learn_throughput": 344.782, "synch_weights_time_ms": 14.632}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00003", "date": "2024-08-03_04-42-26", "timestamp": 1722640346, "time_this_iter_s": 14.028403282165527, "time_total_s": 253.1851511001587, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270d750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 253.1851511001587, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 12.649999999999999, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 177.4236107627551, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.385522188618779, "policy_loss": -0.010352167081631098, "vf_loss": 3.390341644361615, "vf_explained_var": 0.9799134135246277, "kl": 0.018488346544290855, "entropy": 1.3793693246940772, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -4.057244666706021, "episode_reward_min": -1196.3058254550422, "episode_reward_mean": -649.959728332569, "episode_len_mean": 135.49, "episode_media": {}, "episodes_timesteps_total": 13549, "policy_reward_min": {"policy_0": -1196.3058254550422}, "policy_reward_max": {"policy_0": -4.057244666706021}, "policy_reward_mean": {"policy_0": -649.959728332569}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-641.6062032093618, -471.7435049597519, -94.60685336047102, -640.3307268868288, -362.48241272926543, -897.0722382058511, -261.5098025280912, -666.665559300088, -243.54587872099364, -781.8642591792337, -994.5661657484594, -997.4815842801845, -430.2512198577273, -646.7562751527737, -50.75038838851484, -612.3879209506651, -1064.3261543128735, -564.3923956990244, -624.1839123644437, -191.70592840832657, -708.6673011893233, -1079.7484210945324, -184.45808319181327, -964.5186608369996, -260.3495658457527, -732.393663304319, -279.64476791325995, -69.28962911605818, -968.3187416731063, -635.6024954814557, -737.7054523737002, -112.56309450565581, -439.09093956054784, -979.540433482484, -726.1879894663235, -868.024199424825, -637.5884463125315, -871.40858065168, -811.3802495360154, -454.78954762061176, -4.057244666706021, -527.4792685806666, -973.561551913931, -773.0605168320119, -1074.5756540444354, -212.7796566646056, -800.5858197830253, -285.16159180291385, -844.7928125705876, -1119.8710671447732, -462.9570212559548, -948.0810340756722, -1196.3058254550422, -321.6363902807447, -486.36085057994933, -370.8098593126242, -228.18980037067303, -475.6972778899992, -142.28567871613214, -767.4235104077168, -711.4113162725528, -1151.272793778242, -763.1211721563441, -131.66778238948314, -429.18226385590015, -1147.451384778055, -785.5255247387189, -1034.8374912821873, -933.6067497880522, -727.1112306181086, -682.7692284567191, -892.2244851835027, -1035.8050733841717, -240.85815284921085, -323.6351415856159, -1137.2237313730866, -834.6761349908778, -748.013917737438, -50.598625083046024, -1044.8300657155153, -907.205251618268, -750.9643114571988, -516.0006617681559, -1040.0414409687305, -574.7768495934357, -872.6356577024884, -830.0689687706541, -412.37743595926094, -854.4433089803234, -1045.89291709348, -935.5888387352379, -495.60215087084816, -830.342190924899, -415.9013982771997, -368.7795532242204, -686.5701701412248, -830.5772764297845, -699.6664346785907, -531.0702324398577, -816.4734384341089], "episode_lengths": [150, 150, 90, 150, 146, 150, 89, 150, 102, 150, 150, 150, 130, 150, 71, 150, 150, 150, 150, 66, 150, 150, 64, 150, 91, 150, 122, 71, 150, 150, 150, 81, 113, 150, 150, 150, 150, 150, 149, 150, 40, 150, 150, 150, 150, 117, 150, 143, 150, 150, 150, 150, 150, 150, 150, 104, 93, 126, 75, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 146, 150, 150, 91, 85, 150, 150, 150, 58, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 137, 106, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-641.6062032093618, -471.7435049597519, -94.60685336047102, -640.3307268868288, -362.48241272926543, -897.0722382058511, -261.5098025280912, -666.665559300088, -243.54587872099364, -781.8642591792337, -994.5661657484594, -997.4815842801845, -430.2512198577273, -646.7562751527737, -50.75038838851484, -612.3879209506651, -1064.3261543128735, -564.3923956990244, -624.1839123644437, -191.70592840832657, -708.6673011893233, -1079.7484210945324, -184.45808319181327, -964.5186608369996, -260.3495658457527, -732.393663304319, -279.64476791325995, -69.28962911605818, -968.3187416731063, -635.6024954814557, -737.7054523737002, -112.56309450565581, -439.09093956054784, -979.540433482484, -726.1879894663235, -868.024199424825, -637.5884463125315, -871.40858065168, -811.3802495360154, -454.78954762061176, -4.057244666706021, -527.4792685806666, -973.561551913931, -773.0605168320119, -1074.5756540444354, -212.7796566646056, -800.5858197830253, -285.16159180291385, -844.7928125705876, -1119.8710671447732, -462.9570212559548, -948.0810340756722, -1196.3058254550422, -321.6363902807447, -486.36085057994933, -370.8098593126242, -228.18980037067303, -475.6972778899992, -142.28567871613214, -767.4235104077168, -711.4113162725528, -1151.272793778242, -763.1211721563441, -131.66778238948314, -429.18226385590015, -1147.451384778055, -785.5255247387189, -1034.8374912821873, -933.6067497880522, -727.1112306181086, -682.7692284567191, -892.2244851835027, -1035.8050733841717, -240.85815284921085, -323.6351415856159, -1137.2237313730866, -834.6761349908778, -748.013917737438, -50.598625083046024, -1044.8300657155153, -907.205251618268, -750.9643114571988, -516.0006617681559, -1040.0414409687305, -574.7768495934357, -872.6356577024884, -830.0689687706541, -412.37743595926094, -854.4433089803234, -1045.89291709348, -935.5888387352379, -495.60215087084816, -830.342190924899, -415.9013982771997, -368.7795532242204, -686.5701701412248, -830.5772764297845, -699.6664346785907, -531.0702324398577, -816.4734384341089]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2786407814389583, "mean_inference_ms": 0.8798338726347873, "mean_action_processing_ms": 0.15742213319704093, "mean_env_wait_ms": 1.5458473166697917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00543665885925293, "StateBufferConnector_ms": 0.00408625602722168, "ViewRequirementAgentConnector_ms": 0.0971369743347168}, "num_episodes": 25, "episode_return_max": -4.057244666706021, "episode_return_min": -1196.3058254550422, "episode_return_mean": -649.959728332569, "episodes_this_iter": 25}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.37008888436907, "num_env_steps_trained_throughput_per_sec": 283.37008888436907, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13979.081, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13979.008, "sample_time_ms": 2352.811, "learn_time_ms": 11610.713, "learn_throughput": 344.509, "synch_weights_time_ms": 14.715}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00003", "date": "2024-08-03_04-42-40", "timestamp": 1722640360, "time_this_iter_s": 14.12288212776184, "time_total_s": 267.30803322792053, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270e710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 267.30803322792053, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 12.649999999999999, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 200.5196154654026, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.9595713672538597, "policy_loss": -0.012493243244534824, "vf_loss": 3.966755829254786, "vf_explained_var": 0.984964522284766, "kl": 0.017745245132437065, "entropy": 1.4792443737387657, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -4.057244666706021, "episode_reward_min": -1265.7274783099024, "episode_reward_mean": -694.2569532389767, "episode_len_mean": 138.13, "episode_media": {}, "episodes_timesteps_total": 13813, "policy_reward_min": {"policy_0": -1265.7274783099024}, "policy_reward_max": {"policy_0": -4.057244666706021}, "policy_reward_mean": {"policy_0": -694.2569532389767}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-439.09093956054784, -979.540433482484, -726.1879894663235, -868.024199424825, -637.5884463125315, -871.40858065168, -811.3802495360154, -454.78954762061176, -4.057244666706021, -527.4792685806666, -973.561551913931, -773.0605168320119, -1074.5756540444354, -212.7796566646056, -800.5858197830253, -285.16159180291385, -844.7928125705876, -1119.8710671447732, -462.9570212559548, -948.0810340756722, -1196.3058254550422, -321.6363902807447, -486.36085057994933, -370.8098593126242, -228.18980037067303, -475.6972778899992, -142.28567871613214, -767.4235104077168, -711.4113162725528, -1151.272793778242, -763.1211721563441, -131.66778238948314, -429.18226385590015, -1147.451384778055, -785.5255247387189, -1034.8374912821873, -933.6067497880522, -727.1112306181086, -682.7692284567191, -892.2244851835027, -1035.8050733841717, -240.85815284921085, -323.6351415856159, -1137.2237313730866, -834.6761349908778, -748.013917737438, -50.598625083046024, -1044.8300657155153, -907.205251618268, -750.9643114571988, -516.0006617681559, -1040.0414409687305, -574.7768495934357, -872.6356577024884, -830.0689687706541, -412.37743595926094, -854.4433089803234, -1045.89291709348, -935.5888387352379, -495.60215087084816, -830.342190924899, -415.9013982771997, -368.7795532242204, -686.5701701412248, -830.5772764297845, -699.6664346785907, -531.0702324398577, -816.4734384341089, -329.87099428703317, -699.7916355060935, -1058.7836260330055, -238.95232045747747, -756.6856588142663, -1228.1954790618317, -594.6094255486781, -861.4519033904288, -69.16038097820048, -488.7249192448304, -165.707945491045, -790.792121969532, -814.6312141667879, -1034.2417273482963, -1149.2651098177766, -518.6757733244169, -817.094659372047, -1099.3343691338057, -779.7898770937519, -1265.7274783099024, -795.1628717102004, -1144.149794271532, -462.624052836132, -1178.6756262949284, -337.7862086658199, -486.5651896236407, -903.8864140978193, -770.8509259450166, -427.6920851113361, -236.7872890689725, -79.57050308829737, -815.9741713467832], "episode_lengths": [113, 150, 150, 150, 150, 150, 149, 150, 40, 150, 150, 150, 150, 117, 150, 143, 150, 150, 150, 150, 150, 150, 150, 104, 93, 126, 75, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 146, 150, 150, 91, 85, 150, 150, 150, 58, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 137, 106, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 67, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 118, 150, 150, 150, 97, 47, 150], "policy_policy_0_reward": [-439.09093956054784, -979.540433482484, -726.1879894663235, -868.024199424825, -637.5884463125315, -871.40858065168, -811.3802495360154, -454.78954762061176, -4.057244666706021, -527.4792685806666, -973.561551913931, -773.0605168320119, -1074.5756540444354, -212.7796566646056, -800.5858197830253, -285.16159180291385, -844.7928125705876, -1119.8710671447732, -462.9570212559548, -948.0810340756722, -1196.3058254550422, -321.6363902807447, -486.36085057994933, -370.8098593126242, -228.18980037067303, -475.6972778899992, -142.28567871613214, -767.4235104077168, -711.4113162725528, -1151.272793778242, -763.1211721563441, -131.66778238948314, -429.18226385590015, -1147.451384778055, -785.5255247387189, -1034.8374912821873, -933.6067497880522, -727.1112306181086, -682.7692284567191, -892.2244851835027, -1035.8050733841717, -240.85815284921085, -323.6351415856159, -1137.2237313730866, -834.6761349908778, -748.013917737438, -50.598625083046024, -1044.8300657155153, -907.205251618268, -750.9643114571988, -516.0006617681559, -1040.0414409687305, -574.7768495934357, -872.6356577024884, -830.0689687706541, -412.37743595926094, -854.4433089803234, -1045.89291709348, -935.5888387352379, -495.60215087084816, -830.342190924899, -415.9013982771997, -368.7795532242204, -686.5701701412248, -830.5772764297845, -699.6664346785907, -531.0702324398577, -816.4734384341089, -329.87099428703317, -699.7916355060935, -1058.7836260330055, -238.95232045747747, -756.6856588142663, -1228.1954790618317, -594.6094255486781, -861.4519033904288, -69.16038097820048, -488.7249192448304, -165.707945491045, -790.792121969532, -814.6312141667879, -1034.2417273482963, -1149.2651098177766, -518.6757733244169, -817.094659372047, -1099.3343691338057, -779.7898770937519, -1265.7274783099024, -795.1628717102004, -1144.149794271532, -462.624052836132, -1178.6756262949284, -337.7862086658199, -486.5651896236407, -903.8864140978193, -770.8509259450166, -427.6920851113361, -236.7872890689725, -79.57050308829737, -815.9741713467832]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2784939979445835, "mean_inference_ms": 0.8786047738231447, "mean_action_processing_ms": 0.15733164418153392, "mean_env_wait_ms": 1.5459427917592905, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005875825881958008, "StateBufferConnector_ms": 0.004061222076416016, "ViewRequirementAgentConnector_ms": 0.09728574752807617}, "num_episodes": 32, "episode_return_max": -4.057244666706021, "episode_return_min": -1265.7274783099024, "episode_return_mean": -694.2569532389767, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 428.05484909966, "num_env_steps_trained_throughput_per_sec": 428.05484909966, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13493.115, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13493.04, "sample_time_ms": 2355.512, "learn_time_ms": 11122.228, "learn_throughput": 359.64, "synch_weights_time_ms": 14.53}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00003", "date": "2024-08-03_04-42-50", "timestamp": 1722640370, "time_this_iter_s": 9.351940870285034, "time_total_s": 276.65997409820557, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270f400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 276.65997409820557, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.742857142857144, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 188.5660826722781, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.483627311885357, "policy_loss": -0.016624776201691324, "vf_loss": 4.4949225145081675, "vf_explained_var": 0.9810916746035219, "kl": 0.017811506794866268, "entropy": 1.3880554970974723, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -23.67333419725936, "episode_reward_min": -1265.7274783099024, "episode_reward_mean": -678.5817342526055, "episode_len_mean": 134.23, "episode_media": {}, "episodes_timesteps_total": 13423, "policy_reward_min": {"policy_0": -1265.7274783099024}, "policy_reward_max": {"policy_0": -23.67333419725936}, "policy_reward_mean": {"policy_0": -678.5817342526055}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-131.66778238948314, -429.18226385590015, -1147.451384778055, -785.5255247387189, -1034.8374912821873, -933.6067497880522, -727.1112306181086, -682.7692284567191, -892.2244851835027, -1035.8050733841717, -240.85815284921085, -323.6351415856159, -1137.2237313730866, -834.6761349908778, -748.013917737438, -50.598625083046024, -1044.8300657155153, -907.205251618268, -750.9643114571988, -516.0006617681559, -1040.0414409687305, -574.7768495934357, -872.6356577024884, -830.0689687706541, -412.37743595926094, -854.4433089803234, -1045.89291709348, -935.5888387352379, -495.60215087084816, -830.342190924899, -415.9013982771997, -368.7795532242204, -686.5701701412248, -830.5772764297845, -699.6664346785907, -531.0702324398577, -816.4734384341089, -329.87099428703317, -699.7916355060935, -1058.7836260330055, -238.95232045747747, -756.6856588142663, -1228.1954790618317, -594.6094255486781, -861.4519033904288, -69.16038097820048, -488.7249192448304, -165.707945491045, -790.792121969532, -814.6312141667879, -1034.2417273482963, -1149.2651098177766, -518.6757733244169, -817.094659372047, -1099.3343691338057, -779.7898770937519, -1265.7274783099024, -795.1628717102004, -1144.149794271532, -462.624052836132, -1178.6756262949284, -337.7862086658199, -486.5651896236407, -903.8864140978193, -770.8509259450166, -427.6920851113361, -236.7872890689725, -79.57050308829737, -815.9741713467832, -1153.8074480257644, -1207.6128844158125, -905.2637604581502, -1004.6762890994131, -1060.9646709683902, -162.85044222818405, -32.693515497946805, -565.0817648277045, -417.0362676651515, -45.45835117157672, -572.0328901243762, -670.3034425653826, -493.50608338779296, -1147.374755639915, -745.9607469322677, -23.67333419725936, -29.837493483824037, -151.43247699081238, -724.7973972723828, -1121.1226600800971, -943.2964895306092, -51.67075536435161, -55.64789201621322, -591.304536634926, -707.227966488926, -603.8813768086437, -778.2155162123545, -963.1185453361463, -628.3884779645525, -344.6760389256956, -959.0519316585792], "episode_lengths": [69, 150, 150, 150, 150, 150, 150, 146, 150, 150, 91, 85, 150, 150, 150, 58, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 150, 137, 106, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 67, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 118, 150, 150, 150, 97, 47, 150, 150, 150, 150, 150, 150, 68, 52, 150, 109, 68, 150, 150, 148, 150, 150, 44, 58, 82, 150, 150, 150, 75, 71, 150, 150, 150, 150, 150, 150, 95, 150], "policy_policy_0_reward": [-131.66778238948314, -429.18226385590015, -1147.451384778055, -785.5255247387189, -1034.8374912821873, -933.6067497880522, -727.1112306181086, -682.7692284567191, -892.2244851835027, -1035.8050733841717, -240.85815284921085, -323.6351415856159, -1137.2237313730866, -834.6761349908778, -748.013917737438, -50.598625083046024, -1044.8300657155153, -907.205251618268, -750.9643114571988, -516.0006617681559, -1040.0414409687305, -574.7768495934357, -872.6356577024884, -830.0689687706541, -412.37743595926094, -854.4433089803234, -1045.89291709348, -935.5888387352379, -495.60215087084816, -830.342190924899, -415.9013982771997, -368.7795532242204, -686.5701701412248, -830.5772764297845, -699.6664346785907, -531.0702324398577, -816.4734384341089, -329.87099428703317, -699.7916355060935, -1058.7836260330055, -238.95232045747747, -756.6856588142663, -1228.1954790618317, -594.6094255486781, -861.4519033904288, -69.16038097820048, -488.7249192448304, -165.707945491045, -790.792121969532, -814.6312141667879, -1034.2417273482963, -1149.2651098177766, -518.6757733244169, -817.094659372047, -1099.3343691338057, -779.7898770937519, -1265.7274783099024, -795.1628717102004, -1144.149794271532, -462.624052836132, -1178.6756262949284, -337.7862086658199, -486.5651896236407, -903.8864140978193, -770.8509259450166, -427.6920851113361, -236.7872890689725, -79.57050308829737, -815.9741713467832, -1153.8074480257644, -1207.6128844158125, -905.2637604581502, -1004.6762890994131, -1060.9646709683902, -162.85044222818405, -32.693515497946805, -565.0817648277045, -417.0362676651515, -45.45835117157672, -572.0328901243762, -670.3034425653826, -493.50608338779296, -1147.374755639915, -745.9607469322677, -23.67333419725936, -29.837493483824037, -151.43247699081238, -724.7973972723828, -1121.1226600800971, -943.2964895306092, -51.67075536435161, -55.64789201621322, -591.304536634926, -707.227966488926, -603.8813768086437, -778.2155162123545, -963.1185453361463, -628.3884779645525, -344.6760389256956, -959.0519316585792]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2783932794940726, "mean_inference_ms": 0.8776748614640791, "mean_action_processing_ms": 0.15728837253786795, "mean_env_wait_ms": 1.5467587996317533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058710575103759766, "StateBufferConnector_ms": 0.004050016403198242, "ViewRequirementAgentConnector_ms": 0.09751486778259277}, "num_episodes": 31, "episode_return_max": -23.67333419725936, "episode_return_min": -1265.7274783099024, "episode_return_mean": -678.5817342526055, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.40435604715606, "num_env_steps_trained_throughput_per_sec": 277.40435604715606, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13514.11, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13514.035, "sample_time_ms": 2352.597, "learn_time_ms": 11145.767, "learn_throughput": 358.881, "synch_weights_time_ms": 14.864}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00003", "date": "2024-08-03_04-43-04", "timestamp": 1722640384, "time_this_iter_s": 14.425243139266968, "time_total_s": 291.08521723747253, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270d750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 291.08521723747253, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 12.695, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 226.28051427205403, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.059409138311943, "policy_loss": -0.014262268618525316, "vf_loss": 4.068258094290893, "vf_explained_var": 0.9824028737222155, "kl": 0.0180946317930951, "entropy": 1.5084901596109073, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -10.089071423009873, "episode_reward_min": -1474.6109382852246, "episode_reward_mean": -671.4771447428138, "episode_len_mean": 134.4, "episode_media": {}, "episodes_timesteps_total": 13440, "policy_reward_min": {"policy_0": -1474.6109382852246}, "policy_reward_max": {"policy_0": -10.089071423009873}, "policy_reward_mean": {"policy_0": -671.4771447428138}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-495.60215087084816, -830.342190924899, -415.9013982771997, -368.7795532242204, -686.5701701412248, -830.5772764297845, -699.6664346785907, -531.0702324398577, -816.4734384341089, -329.87099428703317, -699.7916355060935, -1058.7836260330055, -238.95232045747747, -756.6856588142663, -1228.1954790618317, -594.6094255486781, -861.4519033904288, -69.16038097820048, -488.7249192448304, -165.707945491045, -790.792121969532, -814.6312141667879, -1034.2417273482963, -1149.2651098177766, -518.6757733244169, -817.094659372047, -1099.3343691338057, -779.7898770937519, -1265.7274783099024, -795.1628717102004, -1144.149794271532, -462.624052836132, -1178.6756262949284, -337.7862086658199, -486.5651896236407, -903.8864140978193, -770.8509259450166, -427.6920851113361, -236.7872890689725, -79.57050308829737, -815.9741713467832, -1153.8074480257644, -1207.6128844158125, -905.2637604581502, -1004.6762890994131, -1060.9646709683902, -162.85044222818405, -32.693515497946805, -565.0817648277045, -417.0362676651515, -45.45835117157672, -572.0328901243762, -670.3034425653826, -493.50608338779296, -1147.374755639915, -745.9607469322677, -23.67333419725936, -29.837493483824037, -151.43247699081238, -724.7973972723828, -1121.1226600800971, -943.2964895306092, -51.67075536435161, -55.64789201621322, -591.304536634926, -707.227966488926, -603.8813768086437, -778.2155162123545, -963.1185453361463, -628.3884779645525, -344.6760389256956, -959.0519316585792, -513.0084686878336, -1474.6109382852246, -587.905215406904, -292.1812277478477, -10.089071423009873, -787.8569589912083, -1343.8814895789294, -746.522066399915, -912.9792491547399, -889.8251481312848, -1081.559864700223, -1141.157346627991, -245.20798904778408, -877.0373022597696, -754.5327501794419, -1151.6525728943973, -57.67972342160052, -47.276110201764794, -577.1693435562642, -861.0179905560493, -764.0219533095607, -480.44739386853223, -732.085466057064, -453.3859152695281, -748.2636586177168, -842.3642145034382, -899.5178645235524, -936.3163820761865], "episode_lengths": [150, 150, 137, 106, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 67, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 118, 150, 150, 150, 97, 47, 150, 150, 150, 150, 150, 150, 68, 52, 150, 109, 68, 150, 150, 148, 150, 150, 44, 58, 82, 150, 150, 150, 75, 71, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 133, 150, 150, 150, 73, 55, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-495.60215087084816, -830.342190924899, -415.9013982771997, -368.7795532242204, -686.5701701412248, -830.5772764297845, -699.6664346785907, -531.0702324398577, -816.4734384341089, -329.87099428703317, -699.7916355060935, -1058.7836260330055, -238.95232045747747, -756.6856588142663, -1228.1954790618317, -594.6094255486781, -861.4519033904288, -69.16038097820048, -488.7249192448304, -165.707945491045, -790.792121969532, -814.6312141667879, -1034.2417273482963, -1149.2651098177766, -518.6757733244169, -817.094659372047, -1099.3343691338057, -779.7898770937519, -1265.7274783099024, -795.1628717102004, -1144.149794271532, -462.624052836132, -1178.6756262949284, -337.7862086658199, -486.5651896236407, -903.8864140978193, -770.8509259450166, -427.6920851113361, -236.7872890689725, -79.57050308829737, -815.9741713467832, -1153.8074480257644, -1207.6128844158125, -905.2637604581502, -1004.6762890994131, -1060.9646709683902, -162.85044222818405, -32.693515497946805, -565.0817648277045, -417.0362676651515, -45.45835117157672, -572.0328901243762, -670.3034425653826, -493.50608338779296, -1147.374755639915, -745.9607469322677, -23.67333419725936, -29.837493483824037, -151.43247699081238, -724.7973972723828, -1121.1226600800971, -943.2964895306092, -51.67075536435161, -55.64789201621322, -591.304536634926, -707.227966488926, -603.8813768086437, -778.2155162123545, -963.1185453361463, -628.3884779645525, -344.6760389256956, -959.0519316585792, -513.0084686878336, -1474.6109382852246, -587.905215406904, -292.1812277478477, -10.089071423009873, -787.8569589912083, -1343.8814895789294, -746.522066399915, -912.9792491547399, -889.8251481312848, -1081.559864700223, -1141.157346627991, -245.20798904778408, -877.0373022597696, -754.5327501794419, -1151.6525728943973, -57.67972342160052, -47.276110201764794, -577.1693435562642, -861.0179905560493, -764.0219533095607, -480.44739386853223, -732.085466057064, -453.3859152695281, -748.2636586177168, -842.3642145034382, -899.5178645235524, -936.3163820761865]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2782302732024276, "mean_inference_ms": 0.8769957823533576, "mean_action_processing_ms": 0.15727750997224133, "mean_env_wait_ms": 1.5482224824187363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056149959564208984, "StateBufferConnector_ms": 0.004090070724487305, "ViewRequirementAgentConnector_ms": 0.0979452133178711}, "num_episodes": 28, "episode_return_max": -10.089071423009873, "episode_return_min": -1474.6109382852246, "episode_return_mean": -671.4771447428138, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.64749911403396, "num_env_steps_trained_throughput_per_sec": 312.64749911403396, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13395.246, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13395.171, "sample_time_ms": 2350.175, "learn_time_ms": 11029.176, "learn_throughput": 362.674, "synch_weights_time_ms": 15.013}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00003", "date": "2024-08-03_04-43-17", "timestamp": 1722640397, "time_this_iter_s": 12.800516128540039, "time_total_s": 303.8857333660126, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270e710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 303.8857333660126, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 12.936842105263157, "ram_util_percent": 16.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 197.2970885316531, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.7190135369698205, "policy_loss": -0.01227483439045803, "vf_loss": 3.7259398677696782, "vf_explained_var": 0.9843170386428635, "kl": 0.017879950882706927, "entropy": 1.5488339108725389, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -10.089071423009873, "episode_reward_min": -1474.6109382852246, "episode_reward_mean": -678.9853927102007, "episode_len_mean": 131.29, "episode_media": {}, "episodes_timesteps_total": 13129, "policy_reward_min": {"policy_0": -1474.6109382852246}, "policy_reward_max": {"policy_0": -10.089071423009873}, "policy_reward_mean": {"policy_0": -678.9853927102007}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-462.624052836132, -1178.6756262949284, -337.7862086658199, -486.5651896236407, -903.8864140978193, -770.8509259450166, -427.6920851113361, -236.7872890689725, -79.57050308829737, -815.9741713467832, -1153.8074480257644, -1207.6128844158125, -905.2637604581502, -1004.6762890994131, -1060.9646709683902, -162.85044222818405, -32.693515497946805, -565.0817648277045, -417.0362676651515, -45.45835117157672, -572.0328901243762, -670.3034425653826, -493.50608338779296, -1147.374755639915, -745.9607469322677, -23.67333419725936, -29.837493483824037, -151.43247699081238, -724.7973972723828, -1121.1226600800971, -943.2964895306092, -51.67075536435161, -55.64789201621322, -591.304536634926, -707.227966488926, -603.8813768086437, -778.2155162123545, -963.1185453361463, -628.3884779645525, -344.6760389256956, -959.0519316585792, -513.0084686878336, -1474.6109382852246, -587.905215406904, -292.1812277478477, -10.089071423009873, -787.8569589912083, -1343.8814895789294, -746.522066399915, -912.9792491547399, -889.8251481312848, -1081.559864700223, -1141.157346627991, -245.20798904778408, -877.0373022597696, -754.5327501794419, -1151.6525728943973, -57.67972342160052, -47.276110201764794, -577.1693435562642, -861.0179905560493, -764.0219533095607, -480.44739386853223, -732.085466057064, -453.3859152695281, -748.2636586177168, -842.3642145034382, -899.5178645235524, -936.3163820761865, -527.0262266787676, -1110.528016781448, -802.4533223239835, -1104.2156942640827, -236.76880788293678, -777.2566101127779, -105.92894097008418, -271.6394742365734, -195.10470187463142, -1105.8721447189491, -862.2296616627721, -752.1821020993934, -40.28268256188336, -1041.4280902014082, -1068.0030160752922, -303.7672600478085, -1092.2694126674583, -838.0718513998748, -56.70602357314641, -1122.9058556157188, -477.0786998729764, -1097.1873826742253, -1044.4280959428354, -1191.4320547514685, -627.2189258513863, -1068.8598168628903, -166.35042298986772, -971.8663012795528, -1236.4564259997474, -1106.9485112146294, -724.1403943017813], "episode_lengths": [150, 150, 129, 118, 150, 150, 150, 97, 47, 150, 150, 150, 150, 150, 150, 68, 52, 150, 109, 68, 150, 150, 148, 150, 150, 44, 58, 82, 150, 150, 150, 75, 71, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 133, 150, 150, 150, 73, 55, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 88, 150, 57, 103, 111, 150, 150, 150, 53, 150, 150, 150, 150, 150, 59, 150, 124, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150], "policy_policy_0_reward": [-462.624052836132, -1178.6756262949284, -337.7862086658199, -486.5651896236407, -903.8864140978193, -770.8509259450166, -427.6920851113361, -236.7872890689725, -79.57050308829737, -815.9741713467832, -1153.8074480257644, -1207.6128844158125, -905.2637604581502, -1004.6762890994131, -1060.9646709683902, -162.85044222818405, -32.693515497946805, -565.0817648277045, -417.0362676651515, -45.45835117157672, -572.0328901243762, -670.3034425653826, -493.50608338779296, -1147.374755639915, -745.9607469322677, -23.67333419725936, -29.837493483824037, -151.43247699081238, -724.7973972723828, -1121.1226600800971, -943.2964895306092, -51.67075536435161, -55.64789201621322, -591.304536634926, -707.227966488926, -603.8813768086437, -778.2155162123545, -963.1185453361463, -628.3884779645525, -344.6760389256956, -959.0519316585792, -513.0084686878336, -1474.6109382852246, -587.905215406904, -292.1812277478477, -10.089071423009873, -787.8569589912083, -1343.8814895789294, -746.522066399915, -912.9792491547399, -889.8251481312848, -1081.559864700223, -1141.157346627991, -245.20798904778408, -877.0373022597696, -754.5327501794419, -1151.6525728943973, -57.67972342160052, -47.276110201764794, -577.1693435562642, -861.0179905560493, -764.0219533095607, -480.44739386853223, -732.085466057064, -453.3859152695281, -748.2636586177168, -842.3642145034382, -899.5178645235524, -936.3163820761865, -527.0262266787676, -1110.528016781448, -802.4533223239835, -1104.2156942640827, -236.76880788293678, -777.2566101127779, -105.92894097008418, -271.6394742365734, -195.10470187463142, -1105.8721447189491, -862.2296616627721, -752.1821020993934, -40.28268256188336, -1041.4280902014082, -1068.0030160752922, -303.7672600478085, -1092.2694126674583, -838.0718513998748, -56.70602357314641, -1122.9058556157188, -477.0786998729764, -1097.1873826742253, -1044.4280959428354, -1191.4320547514685, -627.2189258513863, -1068.8598168628903, -166.35042298986772, -971.8663012795528, -1236.4564259997474, -1106.9485112146294, -724.1403943017813]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.278266730683449, "mean_inference_ms": 0.8759846049900182, "mean_action_processing_ms": 0.15716793424128667, "mean_env_wait_ms": 1.5489168139637703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005356788635253906, "StateBufferConnector_ms": 0.0041387081146240234, "ViewRequirementAgentConnector_ms": 0.0984492301940918}, "num_episodes": 31, "episode_return_max": -10.089071423009873, "episode_return_min": -1474.6109382852246, "episode_return_mean": -678.9853927102007, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.7237237582229, "num_env_steps_trained_throughput_per_sec": 277.7237237582229, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13399.923, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13399.847, "sample_time_ms": 2357.393, "learn_time_ms": 11026.667, "learn_throughput": 362.757, "synch_weights_time_ms": 14.978}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00003", "date": "2024-08-03_04-43-31", "timestamp": 1722640411, "time_this_iter_s": 14.410173892974854, "time_total_s": 318.2959072589874, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b32766dd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 318.2959072589874, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 12.510000000000002, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 219.2368963420391, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.893507946282625, "policy_loss": -0.008003105911484454, "vf_loss": 3.8946778804063795, "vf_explained_var": 0.9896053086345394, "kl": 0.022822214962343445, "entropy": 1.3491059077903629, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -10.089071423009873, "episode_reward_min": -1474.6109382852246, "episode_reward_mean": -689.1288049911791, "episode_len_mean": 132.71, "episode_media": {}, "episodes_timesteps_total": 13271, "policy_reward_min": {"policy_0": -1474.6109382852246}, "policy_reward_max": {"policy_0": -10.089071423009873}, "policy_reward_mean": {"policy_0": -689.1288049911791}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-51.67075536435161, -55.64789201621322, -591.304536634926, -707.227966488926, -603.8813768086437, -778.2155162123545, -963.1185453361463, -628.3884779645525, -344.6760389256956, -959.0519316585792, -513.0084686878336, -1474.6109382852246, -587.905215406904, -292.1812277478477, -10.089071423009873, -787.8569589912083, -1343.8814895789294, -746.522066399915, -912.9792491547399, -889.8251481312848, -1081.559864700223, -1141.157346627991, -245.20798904778408, -877.0373022597696, -754.5327501794419, -1151.6525728943973, -57.67972342160052, -47.276110201764794, -577.1693435562642, -861.0179905560493, -764.0219533095607, -480.44739386853223, -732.085466057064, -453.3859152695281, -748.2636586177168, -842.3642145034382, -899.5178645235524, -936.3163820761865, -527.0262266787676, -1110.528016781448, -802.4533223239835, -1104.2156942640827, -236.76880788293678, -777.2566101127779, -105.92894097008418, -271.6394742365734, -195.10470187463142, -1105.8721447189491, -862.2296616627721, -752.1821020993934, -40.28268256188336, -1041.4280902014082, -1068.0030160752922, -303.7672600478085, -1092.2694126674583, -838.0718513998748, -56.70602357314641, -1122.9058556157188, -477.0786998729764, -1097.1873826742253, -1044.4280959428354, -1191.4320547514685, -627.2189258513863, -1068.8598168628903, -166.35042298986772, -971.8663012795528, -1236.4564259997474, -1106.9485112146294, -724.1403943017813, -323.9581166336638, -1149.4701360764138, -89.30635695968769, -58.02222301180371, -645.2224428930366, -1037.0596887769964, -613.0453779892027, -687.3059579986997, -312.04843982443293, -39.33986342521208, -13.349408257050891, -963.2037461321604, -733.8069427157162, -902.956143973122, -1230.424313905991, -969.9725773983621, -70.41780844148846, -1330.0325363315287, -21.8963569226991, -685.2176796474985, -878.1433923172665, -999.162533956128, -64.1119727886627, -993.7577841863206, -536.0395688831409, -735.7617007112884, -721.4005356287921, -801.5529221908944, -731.6850062185974, -650.2785493085132, -905.5867752350365], "episode_lengths": [75, 71, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 133, 150, 150, 150, 73, 55, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 88, 150, 57, 103, 111, 150, 150, 150, 53, 150, 150, 150, 150, 150, 59, 150, 124, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 64, 68, 150, 150, 150, 150, 150, 66, 52, 150, 150, 150, 150, 150, 44, 150, 51, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-51.67075536435161, -55.64789201621322, -591.304536634926, -707.227966488926, -603.8813768086437, -778.2155162123545, -963.1185453361463, -628.3884779645525, -344.6760389256956, -959.0519316585792, -513.0084686878336, -1474.6109382852246, -587.905215406904, -292.1812277478477, -10.089071423009873, -787.8569589912083, -1343.8814895789294, -746.522066399915, -912.9792491547399, -889.8251481312848, -1081.559864700223, -1141.157346627991, -245.20798904778408, -877.0373022597696, -754.5327501794419, -1151.6525728943973, -57.67972342160052, -47.276110201764794, -577.1693435562642, -861.0179905560493, -764.0219533095607, -480.44739386853223, -732.085466057064, -453.3859152695281, -748.2636586177168, -842.3642145034382, -899.5178645235524, -936.3163820761865, -527.0262266787676, -1110.528016781448, -802.4533223239835, -1104.2156942640827, -236.76880788293678, -777.2566101127779, -105.92894097008418, -271.6394742365734, -195.10470187463142, -1105.8721447189491, -862.2296616627721, -752.1821020993934, -40.28268256188336, -1041.4280902014082, -1068.0030160752922, -303.7672600478085, -1092.2694126674583, -838.0718513998748, -56.70602357314641, -1122.9058556157188, -477.0786998729764, -1097.1873826742253, -1044.4280959428354, -1191.4320547514685, -627.2189258513863, -1068.8598168628903, -166.35042298986772, -971.8663012795528, -1236.4564259997474, -1106.9485112146294, -724.1403943017813, -323.9581166336638, -1149.4701360764138, -89.30635695968769, -58.02222301180371, -645.2224428930366, -1037.0596887769964, -613.0453779892027, -687.3059579986997, -312.04843982443293, -39.33986342521208, -13.349408257050891, -963.2037461321604, -733.8069427157162, -902.956143973122, -1230.424313905991, -969.9725773983621, -70.41780844148846, -1330.0325363315287, -21.8963569226991, -685.2176796474985, -878.1433923172665, -999.162533956128, -64.1119727886627, -993.7577841863206, -536.0395688831409, -735.7617007112884, -721.4005356287921, -801.5529221908944, -731.6850062185974, -650.2785493085132, -905.5867752350365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27832188722377665, "mean_inference_ms": 0.8752438539832899, "mean_action_processing_ms": 0.15719811855859778, "mean_env_wait_ms": 1.5501401898767682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005093097686767578, "StateBufferConnector_ms": 0.0041217803955078125, "ViewRequirementAgentConnector_ms": 0.09728002548217773}, "num_episodes": 31, "episode_return_max": -10.089071423009873, "episode_return_min": -1474.6109382852246, "episode_return_mean": -689.1288049911791, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.3986627009466, "num_env_steps_trained_throughput_per_sec": 280.3986627009466, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13406.177, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13406.101, "sample_time_ms": 2357.18, "learn_time_ms": 11033.062, "learn_throughput": 362.547, "synch_weights_time_ms": 15.016}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00003", "date": "2024-08-03_04-43-46", "timestamp": 1722640426, "time_this_iter_s": 14.27065372467041, "time_total_s": 332.56656098365784, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270d750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 332.56656098365784, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 12.614285714285714, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 270.53786494930586, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.6338570423424246, "policy_loss": -0.008760304045669425, "vf_loss": 3.636231659601132, "vf_explained_var": 0.9813241750622789, "kl": 0.014225000981302123, "entropy": 1.5560080570479233, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -13.349408257050891, "episode_reward_min": -1330.0325363315287, "episode_reward_mean": -706.478740751855, "episode_len_mean": 132.35, "episode_media": {}, "episodes_timesteps_total": 13235, "policy_reward_min": {"policy_0": -1330.0325363315287}, "policy_reward_max": {"policy_0": -13.349408257050891}, "policy_reward_mean": {"policy_0": -706.478740751855}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-764.0219533095607, -480.44739386853223, -732.085466057064, -453.3859152695281, -748.2636586177168, -842.3642145034382, -899.5178645235524, -936.3163820761865, -527.0262266787676, -1110.528016781448, -802.4533223239835, -1104.2156942640827, -236.76880788293678, -777.2566101127779, -105.92894097008418, -271.6394742365734, -195.10470187463142, -1105.8721447189491, -862.2296616627721, -752.1821020993934, -40.28268256188336, -1041.4280902014082, -1068.0030160752922, -303.7672600478085, -1092.2694126674583, -838.0718513998748, -56.70602357314641, -1122.9058556157188, -477.0786998729764, -1097.1873826742253, -1044.4280959428354, -1191.4320547514685, -627.2189258513863, -1068.8598168628903, -166.35042298986772, -971.8663012795528, -1236.4564259997474, -1106.9485112146294, -724.1403943017813, -323.9581166336638, -1149.4701360764138, -89.30635695968769, -58.02222301180371, -645.2224428930366, -1037.0596887769964, -613.0453779892027, -687.3059579986997, -312.04843982443293, -39.33986342521208, -13.349408257050891, -963.2037461321604, -733.8069427157162, -902.956143973122, -1230.424313905991, -969.9725773983621, -70.41780844148846, -1330.0325363315287, -21.8963569226991, -685.2176796474985, -878.1433923172665, -999.162533956128, -64.1119727886627, -993.7577841863206, -536.0395688831409, -735.7617007112884, -721.4005356287921, -801.5529221908944, -731.6850062185974, -650.2785493085132, -905.5867752350365, -904.231468396037, -935.375881990218, -664.7019562108818, -1099.5319786850982, -118.0325844832714, -203.6212973213167, -857.9306790885317, -933.3793545992899, -433.0315820500137, -1135.9904284979814, -734.9370513654756, -933.4645450131067, -787.6327454318487, -379.2825803979023, -1012.8421100122262, -847.3287230971127, -405.79869778381305, -1189.5414894531727, -965.304634251885, -122.1094018937247, -1249.1873579226135, -206.43225760704348, -110.36403880380571, -46.74730740744292, -686.6049557293179, -664.190327070211, -803.1152558449434, -1226.4017239703223, -885.8147509258869, -1228.4002754256605], "episode_lengths": [150, 137, 150, 150, 150, 150, 150, 150, 113, 150, 150, 150, 88, 150, 57, 103, 111, 150, 150, 150, 53, 150, 150, 150, 150, 150, 59, 150, 124, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 64, 68, 150, 150, 150, 150, 150, 66, 52, 150, 150, 150, 150, 150, 44, 150, 51, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 150, 49, 95, 150, 150, 108, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 86, 150, 101, 72, 48, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-764.0219533095607, -480.44739386853223, -732.085466057064, -453.3859152695281, -748.2636586177168, -842.3642145034382, -899.5178645235524, -936.3163820761865, -527.0262266787676, -1110.528016781448, -802.4533223239835, -1104.2156942640827, -236.76880788293678, -777.2566101127779, -105.92894097008418, -271.6394742365734, -195.10470187463142, -1105.8721447189491, -862.2296616627721, -752.1821020993934, -40.28268256188336, -1041.4280902014082, -1068.0030160752922, -303.7672600478085, -1092.2694126674583, -838.0718513998748, -56.70602357314641, -1122.9058556157188, -477.0786998729764, -1097.1873826742253, -1044.4280959428354, -1191.4320547514685, -627.2189258513863, -1068.8598168628903, -166.35042298986772, -971.8663012795528, -1236.4564259997474, -1106.9485112146294, -724.1403943017813, -323.9581166336638, -1149.4701360764138, -89.30635695968769, -58.02222301180371, -645.2224428930366, -1037.0596887769964, -613.0453779892027, -687.3059579986997, -312.04843982443293, -39.33986342521208, -13.349408257050891, -963.2037461321604, -733.8069427157162, -902.956143973122, -1230.424313905991, -969.9725773983621, -70.41780844148846, -1330.0325363315287, -21.8963569226991, -685.2176796474985, -878.1433923172665, -999.162533956128, -64.1119727886627, -993.7577841863206, -536.0395688831409, -735.7617007112884, -721.4005356287921, -801.5529221908944, -731.6850062185974, -650.2785493085132, -905.5867752350365, -904.231468396037, -935.375881990218, -664.7019562108818, -1099.5319786850982, -118.0325844832714, -203.6212973213167, -857.9306790885317, -933.3793545992899, -433.0315820500137, -1135.9904284979814, -734.9370513654756, -933.4645450131067, -787.6327454318487, -379.2825803979023, -1012.8421100122262, -847.3287230971127, -405.79869778381305, -1189.5414894531727, -965.304634251885, -122.1094018937247, -1249.1873579226135, -206.43225760704348, -110.36403880380571, -46.74730740744292, -686.6049557293179, -664.190327070211, -803.1152558449434, -1226.4017239703223, -885.8147509258869, -1228.4002754256605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.278387145262235, "mean_inference_ms": 0.874617324382043, "mean_action_processing_ms": 0.15720054704853398, "mean_env_wait_ms": 1.5509524511540898, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005122661590576172, "StateBufferConnector_ms": 0.004175901412963867, "ViewRequirementAgentConnector_ms": 0.09781765937805176}, "num_episodes": 30, "episode_return_max": -13.349408257050891, "episode_return_min": -1330.0325363315287, "episode_return_mean": -706.478740751855, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.8800520640555, "num_env_steps_trained_throughput_per_sec": 281.8800520640555, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 13406.223, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13406.149, "sample_time_ms": 2362.597, "learn_time_ms": 11027.69, "learn_throughput": 362.723, "synch_weights_time_ms": 15.015}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00003", "date": "2024-08-03_04-44-00", "timestamp": 1722640440, "time_this_iter_s": 14.198672771453857, "time_total_s": 346.7652337551117, "pid": 480235, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814f010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 346.7652337551117, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 12.715, "ram_util_percent": 16.199999999999996}}
