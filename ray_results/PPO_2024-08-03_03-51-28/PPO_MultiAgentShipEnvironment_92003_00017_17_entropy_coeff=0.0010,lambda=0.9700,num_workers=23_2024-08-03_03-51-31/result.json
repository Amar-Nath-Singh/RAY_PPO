{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0541525905641416, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.55012116630872, "policy_loss": -0.005984623763652053, "vf_loss": 9.5558229804039, "vf_explained_var": 0.03292684517800808, "kl": 0.008457337022196042, "entropy": 1.4086692615101735, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -77.26173752696644, "episode_reward_min": -1135.6668676624054, "episode_reward_mean": -697.9554637821047, "episode_len_mean": 141.17391304347825, "episode_media": {}, "episodes_timesteps_total": 3247, "policy_reward_min": {"policy_0": -1135.6668676624054}, "policy_reward_max": {"policy_0": -77.26173752696644}, "policy_reward_mean": {"policy_0": -697.9554637821047}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-733.6368426283508, -156.27597857897533, -624.7756698875637, -494.596206325333, -248.5388441614763, -782.4591152111128, -1135.6668676624054, -1122.5192338236363, -640.1625568647175, -1015.5057235124467, -841.4605334700701, -705.871889514178, -619.0656173579943, -540.3061758715088, -1068.3235929932314, -316.67387919710046, -909.5211754588428, -77.26173752696644, -946.8758136623553, -572.9511426501588, -1038.54321364449, -670.6394177605198, -791.3444392249738], "episode_lengths": [150, 91, 129, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-733.6368426283508, -156.27597857897533, -624.7756698875637, -494.596206325333, -248.5388441614763, -782.4591152111128, -1135.6668676624054, -1122.5192338236363, -640.1625568647175, -1015.5057235124467, -841.4605334700701, -705.871889514178, -619.0656173579943, -540.3061758715088, -1068.3235929932314, -316.67387919710046, -909.5211754588428, -77.26173752696644, -946.8758136623553, -572.9511426501588, -1038.54321364449, -670.6394177605198, -791.3444392249738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5771237106660945, "mean_inference_ms": 1.7059484589931382, "mean_action_processing_ms": 0.28553487470371786, "mean_env_wait_ms": 2.9986303154079397, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011560191278872282, "StateBufferConnector_ms": 0.008314588795537535, "ViewRequirementAgentConnector_ms": 0.18272503562595532}, "num_episodes": 23, "episode_return_max": -77.26173752696644, "episode_return_min": -1135.6668676624054, "episode_return_mean": -697.9554637821047, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.6879889865375, "num_env_steps_trained_throughput_per_sec": 290.6879889865375, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13760.469, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13760.402, "sample_time_ms": 1090.782, "learn_time_ms": 12604.032, "learn_throughput": 317.359, "synch_weights_time_ms": 64.706}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00017", "date": "2024-08-03_05-12-53", "timestamp": 1722642173, "time_this_iter_s": 13.77228569984436, "time_total_s": 13.77228569984436, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1357a0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.77228569984436, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.94, "ram_util_percent": 30.700000000000006}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.661722377811869, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.49380287528038, "policy_loss": -0.010628106369404122, "vf_loss": 9.503462449709575, "vf_explained_var": 0.08448763638734817, "kl": 0.011962208424180668, "entropy": 1.423875850190719, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -3.34613978664144, "episode_reward_min": -1247.4424624986173, "episode_reward_mean": -629.4451592950525, "episode_len_mean": 129.86274509803923, "episode_media": {}, "episodes_timesteps_total": 6623, "policy_reward_min": {"policy_0": -1247.4424624986173}, "policy_reward_max": {"policy_0": -3.34613978664144}, "policy_reward_mean": {"policy_0": -629.4451592950525}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-733.6368426283508, -156.27597857897533, -624.7756698875637, -494.596206325333, -248.5388441614763, -782.4591152111128, -1135.6668676624054, -1122.5192338236363, -640.1625568647175, -1015.5057235124467, -841.4605334700701, -705.871889514178, -619.0656173579943, -540.3061758715088, -1068.3235929932314, -316.67387919710046, -909.5211754588428, -77.26173752696644, -946.8758136623553, -572.9511426501588, -1038.54321364449, -670.6394177605198, -791.3444392249738, -566.177481338138, -640.9446898830898, -94.95551600695426, -185.159510963386, -965.3120288495754, -1193.5552468432834, -103.76196880689686, -309.1758015011956, -943.9141779243245, -1079.500690816187, -4.392751503769448, -418.8148324359801, -485.4956862120803, -829.6983526602693, -807.344702073382, -809.2543065414051, -743.4008918944681, -22.50348639467688, -144.88720748565075, -1076.1854072395797, -711.3307083613666, -874.314152978349, -542.4419298823542, -53.04225676663235, -239.3082961176696, -953.0667732933459, -3.34613978664144, -1247.4424624986173], "episode_lengths": [150, 91, 129, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 68, 70, 150, 150, 76, 91, 150, 150, 40, 150, 150, 150, 150, 150, 150, 56, 70, 150, 150, 150, 150, 68, 95, 150, 42, 150], "policy_policy_0_reward": [-733.6368426283508, -156.27597857897533, -624.7756698875637, -494.596206325333, -248.5388441614763, -782.4591152111128, -1135.6668676624054, -1122.5192338236363, -640.1625568647175, -1015.5057235124467, -841.4605334700701, -705.871889514178, -619.0656173579943, -540.3061758715088, -1068.3235929932314, -316.67387919710046, -909.5211754588428, -77.26173752696644, -946.8758136623553, -572.9511426501588, -1038.54321364449, -670.6394177605198, -791.3444392249738, -566.177481338138, -640.9446898830898, -94.95551600695426, -185.159510963386, -965.3120288495754, -1193.5552468432834, -103.76196880689686, -309.1758015011956, -943.9141779243245, -1079.500690816187, -4.392751503769448, -418.8148324359801, -485.4956862120803, -829.6983526602693, -807.344702073382, -809.2543065414051, -743.4008918944681, -22.50348639467688, -144.88720748565075, -1076.1854072395797, -711.3307083613666, -874.314152978349, -542.4419298823542, -53.04225676663235, -239.3082961176696, -953.0667732933459, -3.34613978664144, -1247.4424624986173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5794629534720583, "mean_inference_ms": 1.7228874066290112, "mean_action_processing_ms": 0.28963781244544173, "mean_env_wait_ms": 3.0094417056005094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013925982456581266, "StateBufferConnector_ms": 0.00865038703469669, "ViewRequirementAgentConnector_ms": 0.19538122064927044}, "num_episodes": 28, "episode_return_max": -3.34613978664144, "episode_return_min": -1247.4424624986173, "episode_return_mean": -629.4451592950525, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.79630423842355, "num_env_steps_trained_throughput_per_sec": 304.79630423842355, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13442.0, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13441.934, "sample_time_ms": 1077.776, "learn_time_ms": 12296.143, "learn_throughput": 325.305, "synch_weights_time_ms": 67.154}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00017", "date": "2024-08-03_05-13-06", "timestamp": 1722642186, "time_this_iter_s": 13.13645339012146, "time_total_s": 26.90873908996582, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1352bbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.90873908996582, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.69473684210526, "ram_util_percent": 30.75263157894736}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.6361968207173048, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.466143206755321, "policy_loss": -0.009455257097336774, "vf_loss": 9.474180972576141, "vf_explained_var": 0.14700505826622248, "kl": 0.014272401253704934, "entropy": 1.4369709346443416, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -3.34613978664144, "episode_reward_min": -1247.4424624986173, "episode_reward_mean": -671.0274381581645, "episode_len_mean": 133.17948717948718, "episode_media": {}, "episodes_timesteps_total": 10388, "policy_reward_min": {"policy_0": -1247.4424624986173}, "policy_reward_max": {"policy_0": -3.34613978664144}, "policy_reward_mean": {"policy_0": -671.0274381581645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-733.6368426283508, -156.27597857897533, -624.7756698875637, -494.596206325333, -248.5388441614763, -782.4591152111128, -1135.6668676624054, -1122.5192338236363, -640.1625568647175, -1015.5057235124467, -841.4605334700701, -705.871889514178, -619.0656173579943, -540.3061758715088, -1068.3235929932314, -316.67387919710046, -909.5211754588428, -77.26173752696644, -946.8758136623553, -572.9511426501588, -1038.54321364449, -670.6394177605198, -791.3444392249738, -566.177481338138, -640.9446898830898, -94.95551600695426, -185.159510963386, -965.3120288495754, -1193.5552468432834, -103.76196880689686, -309.1758015011956, -943.9141779243245, -1079.500690816187, -4.392751503769448, -418.8148324359801, -485.4956862120803, -829.6983526602693, -807.344702073382, -809.2543065414051, -743.4008918944681, -22.50348639467688, -144.88720748565075, -1076.1854072395797, -711.3307083613666, -874.314152978349, -542.4419298823542, -53.04225676663235, -239.3082961176696, -953.0667732933459, -3.34613978664144, -1247.4424624986173, -290.9755067363635, -627.6409510632659, -851.0957177244316, -779.3330408426522, -1154.6268918651022, -1111.0268278098347, -389.82442660989017, -219.98181939049374, -1026.594815018054, -279.0921750794837, -337.38055521813226, -916.652913621411, -920.4664837096834, -1140.4319302854096, -1152.9994795215898, -886.9881896103269, -631.3053488452056, -755.1338372734419, -631.5145085720073, -22.134011541360866, -1059.5574237313124, -1069.1465217036828, -822.7849663663324, -776.3517673727682, -943.4170750758425, -583.5998094922896, -858.3800582087846], "episode_lengths": [150, 91, 129, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 68, 70, 150, 150, 76, 91, 150, 150, 40, 150, 150, 150, 150, 150, 150, 56, 70, 150, 150, 150, 150, 68, 95, 150, 42, 150, 119, 150, 150, 150, 150, 150, 125, 103, 150, 127, 91, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-733.6368426283508, -156.27597857897533, -624.7756698875637, -494.596206325333, -248.5388441614763, -782.4591152111128, -1135.6668676624054, -1122.5192338236363, -640.1625568647175, -1015.5057235124467, -841.4605334700701, -705.871889514178, -619.0656173579943, -540.3061758715088, -1068.3235929932314, -316.67387919710046, -909.5211754588428, -77.26173752696644, -946.8758136623553, -572.9511426501588, -1038.54321364449, -670.6394177605198, -791.3444392249738, -566.177481338138, -640.9446898830898, -94.95551600695426, -185.159510963386, -965.3120288495754, -1193.5552468432834, -103.76196880689686, -309.1758015011956, -943.9141779243245, -1079.500690816187, -4.392751503769448, -418.8148324359801, -485.4956862120803, -829.6983526602693, -807.344702073382, -809.2543065414051, -743.4008918944681, -22.50348639467688, -144.88720748565075, -1076.1854072395797, -711.3307083613666, -874.314152978349, -542.4419298823542, -53.04225676663235, -239.3082961176696, -953.0667732933459, -3.34613978664144, -1247.4424624986173, -290.9755067363635, -627.6409510632659, -851.0957177244316, -779.3330408426522, -1154.6268918651022, -1111.0268278098347, -389.82442660989017, -219.98181939049374, -1026.594815018054, -279.0921750794837, -337.38055521813226, -916.652913621411, -920.4664837096834, -1140.4319302854096, -1152.9994795215898, -886.9881896103269, -631.3053488452056, -755.1338372734419, -631.5145085720073, -22.134011541360866, -1059.5574237313124, -1069.1465217036828, -822.7849663663324, -776.3517673727682, -943.4170750758425, -583.5998094922896, -858.3800582087846]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5804334138813368, "mean_inference_ms": 1.7303095220832232, "mean_action_processing_ms": 0.2908362251962949, "mean_env_wait_ms": 3.021070885289654, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013665358225504557, "StateBufferConnector_ms": 0.008694636516081981, "ViewRequirementAgentConnector_ms": 0.19533359087430513}, "num_episodes": 27, "episode_return_max": -3.34613978664144, "episode_return_min": -1247.4424624986173, "episode_return_mean": -671.0274381581645, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.62324935580904, "num_env_steps_trained_throughput_per_sec": 287.62324935580904, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13597.031, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13596.964, "sample_time_ms": 1067.585, "learn_time_ms": 12457.808, "learn_throughput": 321.084, "synch_weights_time_ms": 70.746}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00017", "date": "2024-08-03_05-13-20", "timestamp": 1722642200, "time_this_iter_s": 13.919719457626343, "time_total_s": 40.82845854759216, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0f520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 40.82845854759216, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.82, "ram_util_percent": 30.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2183866474156577, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.393326566616695, "policy_loss": -0.008238861511927098, "vf_loss": 9.400333877404531, "vf_explained_var": 0.20026401014377673, "kl": 0.013321968153710865, "entropy": 1.432823561752836, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -3.34613978664144, "episode_reward_min": -1352.3334417697863, "episode_reward_mean": -680.384606525198, "episode_len_mean": 133.06, "episode_media": {}, "episodes_timesteps_total": 13306, "policy_reward_min": {"policy_0": -1352.3334417697863}, "policy_reward_max": {"policy_0": -3.34613978664144}, "policy_reward_mean": {"policy_0": -680.384606525198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1122.5192338236363, -640.1625568647175, -1015.5057235124467, -841.4605334700701, -705.871889514178, -619.0656173579943, -540.3061758715088, -1068.3235929932314, -316.67387919710046, -909.5211754588428, -77.26173752696644, -946.8758136623553, -572.9511426501588, -1038.54321364449, -670.6394177605198, -791.3444392249738, -566.177481338138, -640.9446898830898, -94.95551600695426, -185.159510963386, -965.3120288495754, -1193.5552468432834, -103.76196880689686, -309.1758015011956, -943.9141779243245, -1079.500690816187, -4.392751503769448, -418.8148324359801, -485.4956862120803, -829.6983526602693, -807.344702073382, -809.2543065414051, -743.4008918944681, -22.50348639467688, -144.88720748565075, -1076.1854072395797, -711.3307083613666, -874.314152978349, -542.4419298823542, -53.04225676663235, -239.3082961176696, -953.0667732933459, -3.34613978664144, -1247.4424624986173, -290.9755067363635, -627.6409510632659, -851.0957177244316, -779.3330408426522, -1154.6268918651022, -1111.0268278098347, -389.82442660989017, -219.98181939049374, -1026.594815018054, -279.0921750794837, -337.38055521813226, -916.652913621411, -920.4664837096834, -1140.4319302854096, -1152.9994795215898, -886.9881896103269, -631.3053488452056, -755.1338372734419, -631.5145085720073, -22.134011541360866, -1059.5574237313124, -1069.1465217036828, -822.7849663663324, -776.3517673727682, -943.4170750758425, -583.5998094922896, -858.3800582087846, -472.7526323296599, -693.3274047282557, -777.918585769089, -597.1638083543359, -714.431331721407, -208.46209361209642, -319.9506485200367, -852.1450568035921, -1063.118937619834, -978.7650376673591, -841.9639588199155, -1113.239000544696, -1352.3334417697863, -934.3857469820414, -63.78166994970644, -861.3399761696762, -505.92541405359447, -1240.7642382140345, -930.657491979177, -1057.767000166824, -1065.0672913736794, -326.6409497986199, -581.3219972769949, -268.5520005883308, -78.18956104918104, -913.9947478168469, -664.1017232514146, -229.59735770397782, -166.61089600402536], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 68, 70, 150, 150, 76, 91, 150, 150, 40, 150, 150, 150, 150, 150, 150, 56, 70, 150, 150, 150, 150, 68, 95, 150, 42, 150, 119, 150, 150, 150, 150, 150, 125, 103, 150, 127, 91, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 91, 150, 150, 150, 150, 150, 150, 150, 61, 150, 119, 150, 150, 150, 150, 92, 150, 119, 67, 150, 150, 76, 108], "policy_policy_0_reward": [-1122.5192338236363, -640.1625568647175, -1015.5057235124467, -841.4605334700701, -705.871889514178, -619.0656173579943, -540.3061758715088, -1068.3235929932314, -316.67387919710046, -909.5211754588428, -77.26173752696644, -946.8758136623553, -572.9511426501588, -1038.54321364449, -670.6394177605198, -791.3444392249738, -566.177481338138, -640.9446898830898, -94.95551600695426, -185.159510963386, -965.3120288495754, -1193.5552468432834, -103.76196880689686, -309.1758015011956, -943.9141779243245, -1079.500690816187, -4.392751503769448, -418.8148324359801, -485.4956862120803, -829.6983526602693, -807.344702073382, -809.2543065414051, -743.4008918944681, -22.50348639467688, -144.88720748565075, -1076.1854072395797, -711.3307083613666, -874.314152978349, -542.4419298823542, -53.04225676663235, -239.3082961176696, -953.0667732933459, -3.34613978664144, -1247.4424624986173, -290.9755067363635, -627.6409510632659, -851.0957177244316, -779.3330408426522, -1154.6268918651022, -1111.0268278098347, -389.82442660989017, -219.98181939049374, -1026.594815018054, -279.0921750794837, -337.38055521813226, -916.652913621411, -920.4664837096834, -1140.4319302854096, -1152.9994795215898, -886.9881896103269, -631.3053488452056, -755.1338372734419, -631.5145085720073, -22.134011541360866, -1059.5574237313124, -1069.1465217036828, -822.7849663663324, -776.3517673727682, -943.4170750758425, -583.5998094922896, -858.3800582087846, -472.7526323296599, -693.3274047282557, -777.918585769089, -597.1638083543359, -714.431331721407, -208.46209361209642, -319.9506485200367, -852.1450568035921, -1063.118937619834, -978.7650376673591, -841.9639588199155, -1113.239000544696, -1352.3334417697863, -934.3857469820414, -63.78166994970644, -861.3399761696762, -505.92541405359447, -1240.7642382140345, -930.657491979177, -1057.767000166824, -1065.0672913736794, -326.6409497986199, -581.3219972769949, -268.5520005883308, -78.18956104918104, -913.9947478168469, -664.1017232514146, -229.59735770397782, -166.61089600402536]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5802214318285434, "mean_inference_ms": 1.738349927609222, "mean_action_processing_ms": 0.29183342215384017, "mean_env_wait_ms": 3.0302134027940526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014077901840209961, "StateBufferConnector_ms": 0.008723020553588867, "ViewRequirementAgentConnector_ms": 0.19542932510375977}, "num_episodes": 29, "episode_return_max": -3.34613978664144, "episode_return_min": -1352.3334417697863, "episode_return_mean": -680.384606525198, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.8531110988762, "num_env_steps_trained_throughput_per_sec": 304.8531110988762, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13478.046, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13477.972, "sample_time_ms": 1067.303, "learn_time_ms": 12339.753, "learn_throughput": 324.156, "synch_weights_time_ms": 70.084}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00017", "date": "2024-08-03_05-13-33", "timestamp": 1722642213, "time_this_iter_s": 13.13501787185669, "time_total_s": 53.96347641944885, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1357a0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 53.96347641944885, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.188888888888894, "ram_util_percent": 30.799999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.851120110352834, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.223391433556875, "policy_loss": -0.009830587034715184, "vf_loss": 9.231647995114326, "vf_explained_var": 0.3432028251389662, "kl": 0.015269626332383268, "entropy": 1.4798689045011997, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -3.34613978664144, "episode_reward_min": -1352.3334417697863, "episode_reward_mean": -703.3125378752011, "episode_len_mean": 134.15, "episode_media": {}, "episodes_timesteps_total": 13415, "policy_reward_min": {"policy_0": -1352.3334417697863}, "policy_reward_max": {"policy_0": -3.34613978664144}, "policy_reward_mean": {"policy_0": -703.3125378752011}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-807.344702073382, -809.2543065414051, -743.4008918944681, -22.50348639467688, -144.88720748565075, -1076.1854072395797, -711.3307083613666, -874.314152978349, -542.4419298823542, -53.04225676663235, -239.3082961176696, -953.0667732933459, -3.34613978664144, -1247.4424624986173, -290.9755067363635, -627.6409510632659, -851.0957177244316, -779.3330408426522, -1154.6268918651022, -1111.0268278098347, -389.82442660989017, -219.98181939049374, -1026.594815018054, -279.0921750794837, -337.38055521813226, -916.652913621411, -920.4664837096834, -1140.4319302854096, -1152.9994795215898, -886.9881896103269, -631.3053488452056, -755.1338372734419, -631.5145085720073, -22.134011541360866, -1059.5574237313124, -1069.1465217036828, -822.7849663663324, -776.3517673727682, -943.4170750758425, -583.5998094922896, -858.3800582087846, -472.7526323296599, -693.3274047282557, -777.918585769089, -597.1638083543359, -714.431331721407, -208.46209361209642, -319.9506485200367, -852.1450568035921, -1063.118937619834, -978.7650376673591, -841.9639588199155, -1113.239000544696, -1352.3334417697863, -934.3857469820414, -63.78166994970644, -861.3399761696762, -505.92541405359447, -1240.7642382140345, -930.657491979177, -1057.767000166824, -1065.0672913736794, -326.6409497986199, -581.3219972769949, -268.5520005883308, -78.18956104918104, -913.9947478168469, -664.1017232514146, -229.59735770397782, -166.61089600402536, -966.8891334616239, -868.6646798206093, -845.4763856977879, -1119.2746884306187, -461.44338140377357, -690.2561810472428, -82.38845858280324, -1076.9405487058518, -894.7087632627894, -854.557357406818, -501.703675332644, -38.96110174518497, -1235.8265229035167, -544.8970100868809, -704.441111423377, -40.480577976123556, -1103.9105040228735, -798.569023105834, -502.7925828438863, -725.4301707362517, -1130.6748732764072, -522.5549846292056, -1097.2488148596744, -885.3867583844665, -1136.4286475221902, -734.1140803348474, -887.646366279167, -912.2572529177196, -594.2615921142745, -32.49278496419554], "episode_lengths": [150, 150, 150, 56, 70, 150, 150, 150, 150, 68, 95, 150, 42, 150, 119, 150, 150, 150, 150, 150, 125, 103, 150, 127, 91, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 91, 150, 150, 150, 150, 150, 150, 150, 61, 150, 119, 150, 150, 150, 150, 92, 150, 119, 67, 150, 150, 76, 108, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 60, 150, 145, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53], "policy_policy_0_reward": [-807.344702073382, -809.2543065414051, -743.4008918944681, -22.50348639467688, -144.88720748565075, -1076.1854072395797, -711.3307083613666, -874.314152978349, -542.4419298823542, -53.04225676663235, -239.3082961176696, -953.0667732933459, -3.34613978664144, -1247.4424624986173, -290.9755067363635, -627.6409510632659, -851.0957177244316, -779.3330408426522, -1154.6268918651022, -1111.0268278098347, -389.82442660989017, -219.98181939049374, -1026.594815018054, -279.0921750794837, -337.38055521813226, -916.652913621411, -920.4664837096834, -1140.4319302854096, -1152.9994795215898, -886.9881896103269, -631.3053488452056, -755.1338372734419, -631.5145085720073, -22.134011541360866, -1059.5574237313124, -1069.1465217036828, -822.7849663663324, -776.3517673727682, -943.4170750758425, -583.5998094922896, -858.3800582087846, -472.7526323296599, -693.3274047282557, -777.918585769089, -597.1638083543359, -714.431331721407, -208.46209361209642, -319.9506485200367, -852.1450568035921, -1063.118937619834, -978.7650376673591, -841.9639588199155, -1113.239000544696, -1352.3334417697863, -934.3857469820414, -63.78166994970644, -861.3399761696762, -505.92541405359447, -1240.7642382140345, -930.657491979177, -1057.767000166824, -1065.0672913736794, -326.6409497986199, -581.3219972769949, -268.5520005883308, -78.18956104918104, -913.9947478168469, -664.1017232514146, -229.59735770397782, -166.61089600402536, -966.8891334616239, -868.6646798206093, -845.4763856977879, -1119.2746884306187, -461.44338140377357, -690.2561810472428, -82.38845858280324, -1076.9405487058518, -894.7087632627894, -854.557357406818, -501.703675332644, -38.96110174518497, -1235.8265229035167, -544.8970100868809, -704.441111423377, -40.480577976123556, -1103.9105040228735, -798.569023105834, -502.7925828438863, -725.4301707362517, -1130.6748732764072, -522.5549846292056, -1097.2488148596744, -885.3867583844665, -1136.4286475221902, -734.1140803348474, -887.646366279167, -912.2572529177196, -594.2615921142745, -32.49278496419554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5784829433072627, "mean_inference_ms": 1.7446412358738648, "mean_action_processing_ms": 0.29285106302580144, "mean_env_wait_ms": 3.043157082991633, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014240026473999023, "StateBufferConnector_ms": 0.00890970230102539, "ViewRequirementAgentConnector_ms": 0.19729280471801758}, "num_episodes": 30, "episode_return_max": -3.34613978664144, "episode_return_min": -1352.3334417697863, "episode_return_mean": -703.3125378752011, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.6959541142805, "num_env_steps_trained_throughput_per_sec": 291.6959541142805, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13525.021, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13524.944, "sample_time_ms": 1062.754, "learn_time_ms": 12393.12, "learn_throughput": 322.76, "synch_weights_time_ms": 68.241}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00017", "date": "2024-08-03_05-13-47", "timestamp": 1722642227, "time_this_iter_s": 13.727738618850708, "time_total_s": 67.69121503829956, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0cdc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 67.69121503829956, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.630000000000003, "ram_util_percent": 30.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.046105735562742, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.00676541030407, "policy_loss": -0.016749674153591815, "vf_loss": 9.020898958047232, "vf_explained_var": 0.45685356222093104, "kl": 0.019898046713357567, "entropy": 1.3634717808415493, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -22.134011541360866, "episode_reward_min": -1352.3334417697863, "episode_reward_mean": -753.7818714067769, "episode_len_mean": 137.81, "episode_media": {}, "episodes_timesteps_total": 13781, "policy_reward_min": {"policy_0": -1352.3334417697863}, "policy_reward_max": {"policy_0": -22.134011541360866}, "policy_reward_mean": {"policy_0": -753.7818714067769}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-920.4664837096834, -1140.4319302854096, -1152.9994795215898, -886.9881896103269, -631.3053488452056, -755.1338372734419, -631.5145085720073, -22.134011541360866, -1059.5574237313124, -1069.1465217036828, -822.7849663663324, -776.3517673727682, -943.4170750758425, -583.5998094922896, -858.3800582087846, -472.7526323296599, -693.3274047282557, -777.918585769089, -597.1638083543359, -714.431331721407, -208.46209361209642, -319.9506485200367, -852.1450568035921, -1063.118937619834, -978.7650376673591, -841.9639588199155, -1113.239000544696, -1352.3334417697863, -934.3857469820414, -63.78166994970644, -861.3399761696762, -505.92541405359447, -1240.7642382140345, -930.657491979177, -1057.767000166824, -1065.0672913736794, -326.6409497986199, -581.3219972769949, -268.5520005883308, -78.18956104918104, -913.9947478168469, -664.1017232514146, -229.59735770397782, -166.61089600402536, -966.8891334616239, -868.6646798206093, -845.4763856977879, -1119.2746884306187, -461.44338140377357, -690.2561810472428, -82.38845858280324, -1076.9405487058518, -894.7087632627894, -854.557357406818, -501.703675332644, -38.96110174518497, -1235.8265229035167, -544.8970100868809, -704.441111423377, -40.480577976123556, -1103.9105040228735, -798.569023105834, -502.7925828438863, -725.4301707362517, -1130.6748732764072, -522.5549846292056, -1097.2488148596744, -885.3867583844665, -1136.4286475221902, -734.1140803348474, -887.646366279167, -912.2572529177196, -594.2615921142745, -32.49278496419554, -540.6252902727697, -130.93231761844467, -32.927288764089134, -952.956654611589, -583.3722866636733, -1213.6515161637956, -1086.4664585093653, -983.1840260563736, -781.3845970394282, -63.96521608394557, -1249.0087208568348, -1284.4692491079966, -893.4594578089277, -1299.4041930389978, -963.6044080138518, -1155.1022231149327, -1052.273845459498, -352.23586215838424, -1017.5581171441107, -660.1643398779042, -858.9895710671666, -801.8207853282441, -1162.3251604006741, -301.71475808845145, -1195.6503182101105, -641.781053991275], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 91, 150, 150, 150, 150, 150, 150, 150, 61, 150, 119, 150, 150, 150, 150, 92, 150, 119, 67, 150, 150, 76, 108, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 60, 150, 145, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 85, 54, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-920.4664837096834, -1140.4319302854096, -1152.9994795215898, -886.9881896103269, -631.3053488452056, -755.1338372734419, -631.5145085720073, -22.134011541360866, -1059.5574237313124, -1069.1465217036828, -822.7849663663324, -776.3517673727682, -943.4170750758425, -583.5998094922896, -858.3800582087846, -472.7526323296599, -693.3274047282557, -777.918585769089, -597.1638083543359, -714.431331721407, -208.46209361209642, -319.9506485200367, -852.1450568035921, -1063.118937619834, -978.7650376673591, -841.9639588199155, -1113.239000544696, -1352.3334417697863, -934.3857469820414, -63.78166994970644, -861.3399761696762, -505.92541405359447, -1240.7642382140345, -930.657491979177, -1057.767000166824, -1065.0672913736794, -326.6409497986199, -581.3219972769949, -268.5520005883308, -78.18956104918104, -913.9947478168469, -664.1017232514146, -229.59735770397782, -166.61089600402536, -966.8891334616239, -868.6646798206093, -845.4763856977879, -1119.2746884306187, -461.44338140377357, -690.2561810472428, -82.38845858280324, -1076.9405487058518, -894.7087632627894, -854.557357406818, -501.703675332644, -38.96110174518497, -1235.8265229035167, -544.8970100868809, -704.441111423377, -40.480577976123556, -1103.9105040228735, -798.569023105834, -502.7925828438863, -725.4301707362517, -1130.6748732764072, -522.5549846292056, -1097.2488148596744, -885.3867583844665, -1136.4286475221902, -734.1140803348474, -887.646366279167, -912.2572529177196, -594.2615921142745, -32.49278496419554, -540.6252902727697, -130.93231761844467, -32.927288764089134, -952.956654611589, -583.3722866636733, -1213.6515161637956, -1086.4664585093653, -983.1840260563736, -781.3845970394282, -63.96521608394557, -1249.0087208568348, -1284.4692491079966, -893.4594578089277, -1299.4041930389978, -963.6044080138518, -1155.1022231149327, -1052.273845459498, -352.23586215838424, -1017.5581171441107, -660.1643398779042, -858.9895710671666, -801.8207853282441, -1162.3251604006741, -301.71475808845145, -1195.6503182101105, -641.781053991275]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.576818990188731, "mean_inference_ms": 1.746573436444311, "mean_action_processing_ms": 0.2928733802485225, "mean_env_wait_ms": 3.048404758063495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014065027236938477, "StateBufferConnector_ms": 0.00895547866821289, "ViewRequirementAgentConnector_ms": 0.19687867164611816}, "num_episodes": 26, "episode_return_max": -22.134011541360866, "episode_return_min": -1352.3334417697863, "episode_return_mean": -753.7818714067769, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.05043317246714, "num_env_steps_trained_throughput_per_sec": 287.05043317246714, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 13593.325, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13593.25, "sample_time_ms": 1060.304, "learn_time_ms": 12464.913, "learn_throughput": 320.901, "synch_weights_time_ms": 67.121}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00017", "date": "2024-08-03_05-14-01", "timestamp": 1722642241, "time_this_iter_s": 13.946295022964478, "time_total_s": 81.63751006126404, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8d120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 81.63751006126404, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.534999999999997, "ram_util_percent": 30.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.146513731280963, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.028523305555185, "policy_loss": -0.012498624033469241, "vf_loss": 9.039042407274247, "vf_explained_var": 0.39596999088923135, "kl": 0.01691249918536263, "entropy": 1.402978474770983, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -32.49278496419554, "episode_reward_min": -1299.4041930389978, "episode_reward_mean": -747.253699011292, "episode_len_mean": 138.81, "episode_media": {}, "episodes_timesteps_total": 13881, "policy_reward_min": {"policy_0": -1299.4041930389978}, "policy_reward_max": {"policy_0": -32.49278496419554}, "policy_reward_mean": {"policy_0": -747.253699011292}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-934.3857469820414, -63.78166994970644, -861.3399761696762, -505.92541405359447, -1240.7642382140345, -930.657491979177, -1057.767000166824, -1065.0672913736794, -326.6409497986199, -581.3219972769949, -268.5520005883308, -78.18956104918104, -913.9947478168469, -664.1017232514146, -229.59735770397782, -166.61089600402536, -966.8891334616239, -868.6646798206093, -845.4763856977879, -1119.2746884306187, -461.44338140377357, -690.2561810472428, -82.38845858280324, -1076.9405487058518, -894.7087632627894, -854.557357406818, -501.703675332644, -38.96110174518497, -1235.8265229035167, -544.8970100868809, -704.441111423377, -40.480577976123556, -1103.9105040228735, -798.569023105834, -502.7925828438863, -725.4301707362517, -1130.6748732764072, -522.5549846292056, -1097.2488148596744, -885.3867583844665, -1136.4286475221902, -734.1140803348474, -887.646366279167, -912.2572529177196, -594.2615921142745, -32.49278496419554, -540.6252902727697, -130.93231761844467, -32.927288764089134, -952.956654611589, -583.3722866636733, -1213.6515161637956, -1086.4664585093653, -983.1840260563736, -781.3845970394282, -63.96521608394557, -1249.0087208568348, -1284.4692491079966, -893.4594578089277, -1299.4041930389978, -963.6044080138518, -1155.1022231149327, -1052.273845459498, -352.23586215838424, -1017.5581171441107, -660.1643398779042, -858.9895710671666, -801.8207853282441, -1162.3251604006741, -301.71475808845145, -1195.6503182101105, -641.781053991275, -891.2169222713283, -402.39982167780875, -335.56670330332565, -827.8103352584774, -1206.6459807001809, -808.026132985188, -818.040897889789, -340.26235745820384, -1032.4903494592302, -775.6088087362389, -1171.7094865342385, -631.6411685835407, -362.0543788998636, -649.6751485118637, -656.8468943655661, -365.54497327728, -1033.5921002758023, -451.68911901110147, -710.7779859089927, -767.9501952691302, -1013.7335969494326, -1132.2057048491956, -1210.441625957543, -908.0011845322499, -817.828347858013, -739.2799934599312, -808.1675877670862, -717.7583082710001], "episode_lengths": [150, 61, 150, 119, 150, 150, 150, 150, 92, 150, 119, 67, 150, 150, 76, 108, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 60, 150, 145, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 85, 54, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-934.3857469820414, -63.78166994970644, -861.3399761696762, -505.92541405359447, -1240.7642382140345, -930.657491979177, -1057.767000166824, -1065.0672913736794, -326.6409497986199, -581.3219972769949, -268.5520005883308, -78.18956104918104, -913.9947478168469, -664.1017232514146, -229.59735770397782, -166.61089600402536, -966.8891334616239, -868.6646798206093, -845.4763856977879, -1119.2746884306187, -461.44338140377357, -690.2561810472428, -82.38845858280324, -1076.9405487058518, -894.7087632627894, -854.557357406818, -501.703675332644, -38.96110174518497, -1235.8265229035167, -544.8970100868809, -704.441111423377, -40.480577976123556, -1103.9105040228735, -798.569023105834, -502.7925828438863, -725.4301707362517, -1130.6748732764072, -522.5549846292056, -1097.2488148596744, -885.3867583844665, -1136.4286475221902, -734.1140803348474, -887.646366279167, -912.2572529177196, -594.2615921142745, -32.49278496419554, -540.6252902727697, -130.93231761844467, -32.927288764089134, -952.956654611589, -583.3722866636733, -1213.6515161637956, -1086.4664585093653, -983.1840260563736, -781.3845970394282, -63.96521608394557, -1249.0087208568348, -1284.4692491079966, -893.4594578089277, -1299.4041930389978, -963.6044080138518, -1155.1022231149327, -1052.273845459498, -352.23586215838424, -1017.5581171441107, -660.1643398779042, -858.9895710671666, -801.8207853282441, -1162.3251604006741, -301.71475808845145, -1195.6503182101105, -641.781053991275, -891.2169222713283, -402.39982167780875, -335.56670330332565, -827.8103352584774, -1206.6459807001809, -808.026132985188, -818.040897889789, -340.26235745820384, -1032.4903494592302, -775.6088087362389, -1171.7094865342385, -631.6411685835407, -362.0543788998636, -649.6751485118637, -656.8468943655661, -365.54497327728, -1033.5921002758023, -451.68911901110147, -710.7779859089927, -767.9501952691302, -1013.7335969494326, -1132.2057048491956, -1210.441625957543, -908.0011845322499, -817.828347858013, -739.2799934599312, -808.1675877670862, -717.7583082710001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5742833781349146, "mean_inference_ms": 1.7445072225557068, "mean_action_processing_ms": 0.29196239183812545, "mean_env_wait_ms": 3.0432763596193855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013623237609863281, "StateBufferConnector_ms": 0.008751869201660156, "ViewRequirementAgentConnector_ms": 0.19727873802185059}, "num_episodes": 28, "episode_return_max": -32.49278496419554, "episode_return_min": -1299.4041930389978, "episode_return_mean": -747.253699011292, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.0636481307314, "num_env_steps_trained_throughput_per_sec": 292.0636481307314, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 13607.944, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13607.87, "sample_time_ms": 1057.562, "learn_time_ms": 12482.485, "learn_throughput": 320.449, "synch_weights_time_ms": 66.931}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00017", "date": "2024-08-03_05-14-14", "timestamp": 1722642254, "time_this_iter_s": 13.708351850509644, "time_total_s": 95.34586191177368, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0f5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 95.34586191177368, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.763157894736846, "ram_util_percent": 30.799999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.257118120851617, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.801332413653533, "policy_loss": -0.012971609602876319, "vf_loss": 8.811744817594688, "vf_explained_var": 0.5103586879248421, "kl": 0.02002477056757925, "entropy": 1.4457292001694442, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -32.49278496419554, "episode_reward_min": -1299.4041930389978, "episode_reward_mean": -790.777300060104, "episode_len_mean": 142.67, "episode_media": {}, "episodes_timesteps_total": 14267, "policy_reward_min": {"policy_0": -1299.4041930389978}, "policy_reward_max": {"policy_0": -32.49278496419554}, "policy_reward_mean": {"policy_0": -790.777300060104}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-544.8970100868809, -704.441111423377, -40.480577976123556, -1103.9105040228735, -798.569023105834, -502.7925828438863, -725.4301707362517, -1130.6748732764072, -522.5549846292056, -1097.2488148596744, -885.3867583844665, -1136.4286475221902, -734.1140803348474, -887.646366279167, -912.2572529177196, -594.2615921142745, -32.49278496419554, -540.6252902727697, -130.93231761844467, -32.927288764089134, -952.956654611589, -583.3722866636733, -1213.6515161637956, -1086.4664585093653, -983.1840260563736, -781.3845970394282, -63.96521608394557, -1249.0087208568348, -1284.4692491079966, -893.4594578089277, -1299.4041930389978, -963.6044080138518, -1155.1022231149327, -1052.273845459498, -352.23586215838424, -1017.5581171441107, -660.1643398779042, -858.9895710671666, -801.8207853282441, -1162.3251604006741, -301.71475808845145, -1195.6503182101105, -641.781053991275, -891.2169222713283, -402.39982167780875, -335.56670330332565, -827.8103352584774, -1206.6459807001809, -808.026132985188, -818.040897889789, -340.26235745820384, -1032.4903494592302, -775.6088087362389, -1171.7094865342385, -631.6411685835407, -362.0543788998636, -649.6751485118637, -656.8468943655661, -365.54497327728, -1033.5921002758023, -451.68911901110147, -710.7779859089927, -767.9501952691302, -1013.7335969494326, -1132.2057048491956, -1210.441625957543, -908.0011845322499, -817.828347858013, -739.2799934599312, -808.1675877670862, -717.7583082710001, -740.8897882100282, -817.9604678746891, -810.7701753930851, -1244.6188286072697, -983.8055928417458, -1019.4017168080726, -332.0506549019262, -790.3343515859316, -859.0243236970971, -469.6281142823883, -1141.2728516948955, -710.6625988591061, -1016.7219009267608, -915.0203512486867, -1064.402357270975, -973.7452715300594, -39.99038308801531, -951.3467446522875, -914.0631153277043, -641.4881369585285, -879.9321130452118, -951.0083508719227, -146.19685144079492, -576.5340722341953, -904.7717778715763, -758.8354406463733, -1237.8621012365534, -838.813069486807, -1146.9975424678942], "episode_lengths": [145, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 85, 54, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-544.8970100868809, -704.441111423377, -40.480577976123556, -1103.9105040228735, -798.569023105834, -502.7925828438863, -725.4301707362517, -1130.6748732764072, -522.5549846292056, -1097.2488148596744, -885.3867583844665, -1136.4286475221902, -734.1140803348474, -887.646366279167, -912.2572529177196, -594.2615921142745, -32.49278496419554, -540.6252902727697, -130.93231761844467, -32.927288764089134, -952.956654611589, -583.3722866636733, -1213.6515161637956, -1086.4664585093653, -983.1840260563736, -781.3845970394282, -63.96521608394557, -1249.0087208568348, -1284.4692491079966, -893.4594578089277, -1299.4041930389978, -963.6044080138518, -1155.1022231149327, -1052.273845459498, -352.23586215838424, -1017.5581171441107, -660.1643398779042, -858.9895710671666, -801.8207853282441, -1162.3251604006741, -301.71475808845145, -1195.6503182101105, -641.781053991275, -891.2169222713283, -402.39982167780875, -335.56670330332565, -827.8103352584774, -1206.6459807001809, -808.026132985188, -818.040897889789, -340.26235745820384, -1032.4903494592302, -775.6088087362389, -1171.7094865342385, -631.6411685835407, -362.0543788998636, -649.6751485118637, -656.8468943655661, -365.54497327728, -1033.5921002758023, -451.68911901110147, -710.7779859089927, -767.9501952691302, -1013.7335969494326, -1132.2057048491956, -1210.441625957543, -908.0011845322499, -817.828347858013, -739.2799934599312, -808.1675877670862, -717.7583082710001, -740.8897882100282, -817.9604678746891, -810.7701753930851, -1244.6188286072697, -983.8055928417458, -1019.4017168080726, -332.0506549019262, -790.3343515859316, -859.0243236970971, -469.6281142823883, -1141.2728516948955, -710.6625988591061, -1016.7219009267608, -915.0203512486867, -1064.402357270975, -973.7452715300594, -39.99038308801531, -951.3467446522875, -914.0631153277043, -641.4881369585285, -879.9321130452118, -951.0083508719227, -146.19685144079492, -576.5340722341953, -904.7717778715763, -758.8354406463733, -1237.8621012365534, -838.813069486807, -1146.9975424678942]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5740450284739828, "mean_inference_ms": 1.7437477435450395, "mean_action_processing_ms": 0.29172883299463037, "mean_env_wait_ms": 3.044434864996114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013092756271362305, "StateBufferConnector_ms": 0.008856534957885742, "ViewRequirementAgentConnector_ms": 0.20254206657409668}, "num_episodes": 29, "episode_return_max": -32.49278496419554, "episode_return_min": -1299.4041930389978, "episode_return_mean": -790.777300060104, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.4708509141318, "num_env_steps_trained_throughput_per_sec": 292.4708509141318, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13616.526, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13616.451, "sample_time_ms": 1060.336, "learn_time_ms": 12486.928, "learn_throughput": 320.335, "synch_weights_time_ms": 68.284}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00017", "date": "2024-08-03_05-14-28", "timestamp": 1722642268, "time_this_iter_s": 13.691644668579102, "time_total_s": 109.03750658035278, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0e170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 109.03750658035278, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.59, "ram_util_percent": 30.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.073019279042878, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.9034471869468685, "policy_loss": -0.016529327441821805, "vf_loss": 7.915434208512306, "vf_explained_var": 0.7058748076980312, "kl": 0.019888111686486815, "entropy": 1.4241421769062679, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -39.99038308801531, "episode_reward_min": -1279.1578425147313, "episode_reward_mean": -784.5767931550566, "episode_len_mean": 142.79, "episode_media": {}, "episodes_timesteps_total": 14279, "policy_reward_min": {"policy_0": -1279.1578425147313}, "policy_reward_max": {"policy_0": -39.99038308801531}, "policy_reward_mean": {"policy_0": -784.5767931550566}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-963.6044080138518, -1155.1022231149327, -1052.273845459498, -352.23586215838424, -1017.5581171441107, -660.1643398779042, -858.9895710671666, -801.8207853282441, -1162.3251604006741, -301.71475808845145, -1195.6503182101105, -641.781053991275, -891.2169222713283, -402.39982167780875, -335.56670330332565, -827.8103352584774, -1206.6459807001809, -808.026132985188, -818.040897889789, -340.26235745820384, -1032.4903494592302, -775.6088087362389, -1171.7094865342385, -631.6411685835407, -362.0543788998636, -649.6751485118637, -656.8468943655661, -365.54497327728, -1033.5921002758023, -451.68911901110147, -710.7779859089927, -767.9501952691302, -1013.7335969494326, -1132.2057048491956, -1210.441625957543, -908.0011845322499, -817.828347858013, -739.2799934599312, -808.1675877670862, -717.7583082710001, -740.8897882100282, -817.9604678746891, -810.7701753930851, -1244.6188286072697, -983.8055928417458, -1019.4017168080726, -332.0506549019262, -790.3343515859316, -859.0243236970971, -469.6281142823883, -1141.2728516948955, -710.6625988591061, -1016.7219009267608, -915.0203512486867, -1064.402357270975, -973.7452715300594, -39.99038308801531, -951.3467446522875, -914.0631153277043, -641.4881369585285, -879.9321130452118, -951.0083508719227, -146.19685144079492, -576.5340722341953, -904.7717778715763, -758.8354406463733, -1237.8621012365534, -838.813069486807, -1146.9975424678942, -388.2782715622012, -878.4798549321807, -671.969208994229, -1098.73306213967, -138.5194958051955, -761.653994325109, -1279.1578425147313, -128.59025140652884, -132.20448887507547, -669.3409233495127, -549.4881798601868, -41.435929458166214, -238.95413548132208, -1234.2079160357566, -1229.315144131633, -776.4950882648106, -430.31427314966675, -1016.4635511198314, -1078.4163581926393, -1067.2309164174205, -1042.888944357213, -482.1521605540331, -888.1783571873399, -893.1320847576071, -908.5987398395662, -1179.909160416775, -736.8541363526208, -843.643977299054, -851.5612549483632, -1095.3672478925582, -97.80876794788475], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 77, 70, 150, 150, 47, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89], "policy_policy_0_reward": [-963.6044080138518, -1155.1022231149327, -1052.273845459498, -352.23586215838424, -1017.5581171441107, -660.1643398779042, -858.9895710671666, -801.8207853282441, -1162.3251604006741, -301.71475808845145, -1195.6503182101105, -641.781053991275, -891.2169222713283, -402.39982167780875, -335.56670330332565, -827.8103352584774, -1206.6459807001809, -808.026132985188, -818.040897889789, -340.26235745820384, -1032.4903494592302, -775.6088087362389, -1171.7094865342385, -631.6411685835407, -362.0543788998636, -649.6751485118637, -656.8468943655661, -365.54497327728, -1033.5921002758023, -451.68911901110147, -710.7779859089927, -767.9501952691302, -1013.7335969494326, -1132.2057048491956, -1210.441625957543, -908.0011845322499, -817.828347858013, -739.2799934599312, -808.1675877670862, -717.7583082710001, -740.8897882100282, -817.9604678746891, -810.7701753930851, -1244.6188286072697, -983.8055928417458, -1019.4017168080726, -332.0506549019262, -790.3343515859316, -859.0243236970971, -469.6281142823883, -1141.2728516948955, -710.6625988591061, -1016.7219009267608, -915.0203512486867, -1064.402357270975, -973.7452715300594, -39.99038308801531, -951.3467446522875, -914.0631153277043, -641.4881369585285, -879.9321130452118, -951.0083508719227, -146.19685144079492, -576.5340722341953, -904.7717778715763, -758.8354406463733, -1237.8621012365534, -838.813069486807, -1146.9975424678942, -388.2782715622012, -878.4798549321807, -671.969208994229, -1098.73306213967, -138.5194958051955, -761.653994325109, -1279.1578425147313, -128.59025140652884, -132.20448887507547, -669.3409233495127, -549.4881798601868, -41.435929458166214, -238.95413548132208, -1234.2079160357566, -1229.315144131633, -776.4950882648106, -430.31427314966675, -1016.4635511198314, -1078.4163581926393, -1067.2309164174205, -1042.888944357213, -482.1521605540331, -888.1783571873399, -893.1320847576071, -908.5987398395662, -1179.909160416775, -736.8541363526208, -843.643977299054, -851.5612549483632, -1095.3672478925582, -97.80876794788475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5728028093758666, "mean_inference_ms": 1.7436415388334112, "mean_action_processing_ms": 0.2913147853701909, "mean_env_wait_ms": 3.0470950395202094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012868404388427734, "StateBufferConnector_ms": 0.00859975814819336, "ViewRequirementAgentConnector_ms": 0.20497584342956543}, "num_episodes": 31, "episode_return_max": -39.99038308801531, "episode_return_min": -1279.1578425147313, "episode_return_mean": -784.5767931550566, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.3130980481839, "num_env_steps_trained_throughput_per_sec": 290.3130980481839, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 13634.494, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13634.418, "sample_time_ms": 1069.225, "learn_time_ms": 12496.893, "learn_throughput": 320.08, "synch_weights_time_ms": 67.408}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00017", "date": "2024-08-03_05-14-42", "timestamp": 1722642282, "time_this_iter_s": 13.791585922241211, "time_total_s": 122.829092502594, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1357a830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 122.829092502594, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.942105263157895, "ram_util_percent": 30.799999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.520116405685744, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.334171798328558, "policy_loss": -0.008334085339447484, "vf_loss": 7.339868128796419, "vf_explained_var": 0.697733507057031, "kl": 0.013559665298786676, "entropy": 1.4301208330939212, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -21.421346343948024, "episode_reward_min": -1400.600209290991, "episode_reward_mean": -776.1819274795903, "episode_len_mean": 139.99, "episode_media": {}, "episodes_timesteps_total": 13999, "policy_reward_min": {"policy_0": -1400.600209290991}, "policy_reward_max": {"policy_0": -21.421346343948024}, "policy_reward_mean": {"policy_0": -776.1819274795903}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-365.54497327728, -1033.5921002758023, -451.68911901110147, -710.7779859089927, -767.9501952691302, -1013.7335969494326, -1132.2057048491956, -1210.441625957543, -908.0011845322499, -817.828347858013, -739.2799934599312, -808.1675877670862, -717.7583082710001, -740.8897882100282, -817.9604678746891, -810.7701753930851, -1244.6188286072697, -983.8055928417458, -1019.4017168080726, -332.0506549019262, -790.3343515859316, -859.0243236970971, -469.6281142823883, -1141.2728516948955, -710.6625988591061, -1016.7219009267608, -915.0203512486867, -1064.402357270975, -973.7452715300594, -39.99038308801531, -951.3467446522875, -914.0631153277043, -641.4881369585285, -879.9321130452118, -951.0083508719227, -146.19685144079492, -576.5340722341953, -904.7717778715763, -758.8354406463733, -1237.8621012365534, -838.813069486807, -1146.9975424678942, -388.2782715622012, -878.4798549321807, -671.969208994229, -1098.73306213967, -138.5194958051955, -761.653994325109, -1279.1578425147313, -128.59025140652884, -132.20448887507547, -669.3409233495127, -549.4881798601868, -41.435929458166214, -238.95413548132208, -1234.2079160357566, -1229.315144131633, -776.4950882648106, -430.31427314966675, -1016.4635511198314, -1078.4163581926393, -1067.2309164174205, -1042.888944357213, -482.1521605540331, -888.1783571873399, -893.1320847576071, -908.5987398395662, -1179.909160416775, -736.8541363526208, -843.643977299054, -851.5612549483632, -1095.3672478925582, -97.80876794788475, -766.7384424732786, -1130.6229230017902, -1188.4643114616438, -1066.2864142458884, -1193.204438171409, -441.97299212473666, -151.13428555237957, -167.19320255574434, -723.6009083046016, -707.6208400155057, -1369.3142363436411, -21.421346343948024, -1083.181496825561, -695.37703060862, -1018.3425547192618, -535.9200181631084, -1400.600209290991, -1254.1952748631113, -262.8116622638285, -247.3121029617781, -245.10220777055858, -1384.7633267988404, -564.9561640278678, -737.5297100276558, -775.8416112832266, -663.9960220953133, -436.2255296485293], "episode_lengths": [120, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 77, 70, 150, 150, 47, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 120, 93, 84, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 110, 100, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-365.54497327728, -1033.5921002758023, -451.68911901110147, -710.7779859089927, -767.9501952691302, -1013.7335969494326, -1132.2057048491956, -1210.441625957543, -908.0011845322499, -817.828347858013, -739.2799934599312, -808.1675877670862, -717.7583082710001, -740.8897882100282, -817.9604678746891, -810.7701753930851, -1244.6188286072697, -983.8055928417458, -1019.4017168080726, -332.0506549019262, -790.3343515859316, -859.0243236970971, -469.6281142823883, -1141.2728516948955, -710.6625988591061, -1016.7219009267608, -915.0203512486867, -1064.402357270975, -973.7452715300594, -39.99038308801531, -951.3467446522875, -914.0631153277043, -641.4881369585285, -879.9321130452118, -951.0083508719227, -146.19685144079492, -576.5340722341953, -904.7717778715763, -758.8354406463733, -1237.8621012365534, -838.813069486807, -1146.9975424678942, -388.2782715622012, -878.4798549321807, -671.969208994229, -1098.73306213967, -138.5194958051955, -761.653994325109, -1279.1578425147313, -128.59025140652884, -132.20448887507547, -669.3409233495127, -549.4881798601868, -41.435929458166214, -238.95413548132208, -1234.2079160357566, -1229.315144131633, -776.4950882648106, -430.31427314966675, -1016.4635511198314, -1078.4163581926393, -1067.2309164174205, -1042.888944357213, -482.1521605540331, -888.1783571873399, -893.1320847576071, -908.5987398395662, -1179.909160416775, -736.8541363526208, -843.643977299054, -851.5612549483632, -1095.3672478925582, -97.80876794788475, -766.7384424732786, -1130.6229230017902, -1188.4643114616438, -1066.2864142458884, -1193.204438171409, -441.97299212473666, -151.13428555237957, -167.19320255574434, -723.6009083046016, -707.6208400155057, -1369.3142363436411, -21.421346343948024, -1083.181496825561, -695.37703060862, -1018.3425547192618, -535.9200181631084, -1400.600209290991, -1254.1952748631113, -262.8116622638285, -247.3121029617781, -245.10220777055858, -1384.7633267988404, -564.9561640278678, -737.5297100276558, -775.8416112832266, -663.9960220953133, -436.2255296485293]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5720842112209594, "mean_inference_ms": 1.7440219385587177, "mean_action_processing_ms": 0.2909547807041054, "mean_env_wait_ms": 3.051161069095958, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012519359588623047, "StateBufferConnector_ms": 0.008429288864135742, "ViewRequirementAgentConnector_ms": 0.20163226127624512}, "num_episodes": 27, "episode_return_max": -21.421346343948024, "episode_return_min": -1400.600209290991, "episode_return_mean": -776.1819274795903, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.16236051901956, "num_env_steps_trained_throughput_per_sec": 295.16236051901956, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13626.233, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13626.158, "sample_time_ms": 1070.44, "learn_time_ms": 12486.722, "learn_throughput": 320.34, "synch_weights_time_ms": 68.105}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00017", "date": "2024-08-03_05-14-56", "timestamp": 1722642296, "time_this_iter_s": 13.565075397491455, "time_total_s": 136.39416790008545, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b13529fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 136.39416790008545, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.520000000000003, "ram_util_percent": 30.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.89371937662363, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.9410400902231535, "policy_loss": -0.010733874161572506, "vf_loss": 6.948128751417001, "vf_explained_var": 0.7922673238441348, "kl": 0.016827759945241876, "entropy": 1.4031188748776913, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -21.421346343948024, "episode_reward_min": -1400.600209290991, "episode_reward_mean": -754.0656660191339, "episode_len_mean": 137.89, "episode_media": {}, "episodes_timesteps_total": 13789, "policy_reward_min": {"policy_0": -1400.600209290991}, "policy_reward_max": {"policy_0": -21.421346343948024}, "policy_reward_mean": {"policy_0": -754.0656660191339}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-973.7452715300594, -39.99038308801531, -951.3467446522875, -914.0631153277043, -641.4881369585285, -879.9321130452118, -951.0083508719227, -146.19685144079492, -576.5340722341953, -904.7717778715763, -758.8354406463733, -1237.8621012365534, -838.813069486807, -1146.9975424678942, -388.2782715622012, -878.4798549321807, -671.969208994229, -1098.73306213967, -138.5194958051955, -761.653994325109, -1279.1578425147313, -128.59025140652884, -132.20448887507547, -669.3409233495127, -549.4881798601868, -41.435929458166214, -238.95413548132208, -1234.2079160357566, -1229.315144131633, -776.4950882648106, -430.31427314966675, -1016.4635511198314, -1078.4163581926393, -1067.2309164174205, -1042.888944357213, -482.1521605540331, -888.1783571873399, -893.1320847576071, -908.5987398395662, -1179.909160416775, -736.8541363526208, -843.643977299054, -851.5612549483632, -1095.3672478925582, -97.80876794788475, -766.7384424732786, -1130.6229230017902, -1188.4643114616438, -1066.2864142458884, -1193.204438171409, -441.97299212473666, -151.13428555237957, -167.19320255574434, -723.6009083046016, -707.6208400155057, -1369.3142363436411, -21.421346343948024, -1083.181496825561, -695.37703060862, -1018.3425547192618, -535.9200181631084, -1400.600209290991, -1254.1952748631113, -262.8116622638285, -247.3121029617781, -245.10220777055858, -1384.7633267988404, -564.9561640278678, -737.5297100276558, -775.8416112832266, -663.9960220953133, -436.2255296485293, -976.7798505237625, -230.9999383284948, -769.32183871142, -1275.3483349479434, -843.495396864069, -441.6295981312292, -381.02994654978227, -1099.411749401055, -491.4804457843381, -481.4974855712612, -1125.3126903438922, -232.89275236671025, -650.6280402398121, -1060.9215483818605, -960.7356552945122, -256.8032978768686, -1334.2489989192284, -1040.5809710193175, -1029.9979669149807, -438.4703104977463, -939.430225484612, -818.1514827141166, -299.50878575126586, -809.0046192946113, -886.3937524847107, -1070.2301810600368, -1123.8791838631173, -313.72360422302864], "episode_lengths": [150, 58, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 77, 70, 150, 150, 47, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 120, 93, 84, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 110, 100, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 116, 150, 150, 150, 150, 150, 76, 150, 150, 150, 101, 150, 150, 150, 125, 150, 150, 119, 150, 150, 150, 150, 126], "policy_policy_0_reward": [-973.7452715300594, -39.99038308801531, -951.3467446522875, -914.0631153277043, -641.4881369585285, -879.9321130452118, -951.0083508719227, -146.19685144079492, -576.5340722341953, -904.7717778715763, -758.8354406463733, -1237.8621012365534, -838.813069486807, -1146.9975424678942, -388.2782715622012, -878.4798549321807, -671.969208994229, -1098.73306213967, -138.5194958051955, -761.653994325109, -1279.1578425147313, -128.59025140652884, -132.20448887507547, -669.3409233495127, -549.4881798601868, -41.435929458166214, -238.95413548132208, -1234.2079160357566, -1229.315144131633, -776.4950882648106, -430.31427314966675, -1016.4635511198314, -1078.4163581926393, -1067.2309164174205, -1042.888944357213, -482.1521605540331, -888.1783571873399, -893.1320847576071, -908.5987398395662, -1179.909160416775, -736.8541363526208, -843.643977299054, -851.5612549483632, -1095.3672478925582, -97.80876794788475, -766.7384424732786, -1130.6229230017902, -1188.4643114616438, -1066.2864142458884, -1193.204438171409, -441.97299212473666, -151.13428555237957, -167.19320255574434, -723.6009083046016, -707.6208400155057, -1369.3142363436411, -21.421346343948024, -1083.181496825561, -695.37703060862, -1018.3425547192618, -535.9200181631084, -1400.600209290991, -1254.1952748631113, -262.8116622638285, -247.3121029617781, -245.10220777055858, -1384.7633267988404, -564.9561640278678, -737.5297100276558, -775.8416112832266, -663.9960220953133, -436.2255296485293, -976.7798505237625, -230.9999383284948, -769.32183871142, -1275.3483349479434, -843.495396864069, -441.6295981312292, -381.02994654978227, -1099.411749401055, -491.4804457843381, -481.4974855712612, -1125.3126903438922, -232.89275236671025, -650.6280402398121, -1060.9215483818605, -960.7356552945122, -256.8032978768686, -1334.2489989192284, -1040.5809710193175, -1029.9979669149807, -438.4703104977463, -939.430225484612, -818.1514827141166, -299.50878575126586, -809.0046192946113, -886.3937524847107, -1070.2301810600368, -1123.8791838631173, -313.72360422302864]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5717294953659595, "mean_inference_ms": 1.7455812926663632, "mean_action_processing_ms": 0.2910808606172902, "mean_env_wait_ms": 3.05869887643929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012706518173217773, "StateBufferConnector_ms": 0.008306741714477539, "ViewRequirementAgentConnector_ms": 0.20254945755004883}, "num_episodes": 28, "episode_return_max": -21.421346343948024, "episode_return_min": -1400.600209290991, "episode_return_mean": -754.0656660191339, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.0980754494877, "num_env_steps_trained_throughput_per_sec": 286.0980754494877, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13648.309, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13648.233, "sample_time_ms": 1071.942, "learn_time_ms": 12505.762, "learn_throughput": 319.853, "synch_weights_time_ms": 69.636}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00017", "date": "2024-08-03_05-15-10", "timestamp": 1722642310, "time_this_iter_s": 13.99382209777832, "time_total_s": 150.38798999786377, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8df30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 150.38798999786377, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.665, "ram_util_percent": 30.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.251016075909135, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.642426646252473, "policy_loss": -0.017058674913520613, "vf_loss": 6.655280343691508, "vf_explained_var": 0.8583164799337586, "kl": 0.018428761107346266, "entropy": 1.3236448533833027, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -21.421346343948024, "episode_reward_min": -1400.600209290991, "episode_reward_mean": -733.2873484159304, "episode_len_mean": 139.12, "episode_media": {}, "episodes_timesteps_total": 13912, "policy_reward_min": {"policy_0": -1400.600209290991}, "policy_reward_max": {"policy_0": -21.421346343948024}, "policy_reward_mean": {"policy_0": -733.2873484159304}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1078.4163581926393, -1067.2309164174205, -1042.888944357213, -482.1521605540331, -888.1783571873399, -893.1320847576071, -908.5987398395662, -1179.909160416775, -736.8541363526208, -843.643977299054, -851.5612549483632, -1095.3672478925582, -97.80876794788475, -766.7384424732786, -1130.6229230017902, -1188.4643114616438, -1066.2864142458884, -1193.204438171409, -441.97299212473666, -151.13428555237957, -167.19320255574434, -723.6009083046016, -707.6208400155057, -1369.3142363436411, -21.421346343948024, -1083.181496825561, -695.37703060862, -1018.3425547192618, -535.9200181631084, -1400.600209290991, -1254.1952748631113, -262.8116622638285, -247.3121029617781, -245.10220777055858, -1384.7633267988404, -564.9561640278678, -737.5297100276558, -775.8416112832266, -663.9960220953133, -436.2255296485293, -976.7798505237625, -230.9999383284948, -769.32183871142, -1275.3483349479434, -843.495396864069, -441.6295981312292, -381.02994654978227, -1099.411749401055, -491.4804457843381, -481.4974855712612, -1125.3126903438922, -232.89275236671025, -650.6280402398121, -1060.9215483818605, -960.7356552945122, -256.8032978768686, -1334.2489989192284, -1040.5809710193175, -1029.9979669149807, -438.4703104977463, -939.430225484612, -818.1514827141166, -299.50878575126586, -809.0046192946113, -886.3937524847107, -1070.2301810600368, -1123.8791838631173, -313.72360422302864, -1112.1933733941319, -411.6104275633116, -975.4334597539382, -313.5781266011429, -228.89738363839692, -324.03174577014494, -665.8471824912299, -596.1203129308188, -661.057398676724, -146.54601778870298, -416.43405773649266, -679.8574636218822, -895.653755923579, -1125.8761089807456, -855.1239306520165, -1013.909785676894, -321.7972937954439, -178.8202715990453, -840.8363253212731, -941.7740063072973, -642.5790390313406, -432.7611232315155, -822.3488908355833, -872.9530850517216, -488.8483974305642, -883.4692942586101, -112.17833754347288, -671.1639323125305, -844.9157920356737, -787.9346909452943, -374.2715368331743, -908.5322742106742], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 120, 93, 84, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 110, 100, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 116, 150, 150, 150, 150, 150, 76, 150, 150, 150, 101, 150, 150, 150, 125, 150, 150, 119, 150, 150, 150, 150, 126, 150, 150, 150, 88, 101, 150, 150, 150, 150, 58, 141, 150, 150, 150, 150, 150, 97, 104, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1078.4163581926393, -1067.2309164174205, -1042.888944357213, -482.1521605540331, -888.1783571873399, -893.1320847576071, -908.5987398395662, -1179.909160416775, -736.8541363526208, -843.643977299054, -851.5612549483632, -1095.3672478925582, -97.80876794788475, -766.7384424732786, -1130.6229230017902, -1188.4643114616438, -1066.2864142458884, -1193.204438171409, -441.97299212473666, -151.13428555237957, -167.19320255574434, -723.6009083046016, -707.6208400155057, -1369.3142363436411, -21.421346343948024, -1083.181496825561, -695.37703060862, -1018.3425547192618, -535.9200181631084, -1400.600209290991, -1254.1952748631113, -262.8116622638285, -247.3121029617781, -245.10220777055858, -1384.7633267988404, -564.9561640278678, -737.5297100276558, -775.8416112832266, -663.9960220953133, -436.2255296485293, -976.7798505237625, -230.9999383284948, -769.32183871142, -1275.3483349479434, -843.495396864069, -441.6295981312292, -381.02994654978227, -1099.411749401055, -491.4804457843381, -481.4974855712612, -1125.3126903438922, -232.89275236671025, -650.6280402398121, -1060.9215483818605, -960.7356552945122, -256.8032978768686, -1334.2489989192284, -1040.5809710193175, -1029.9979669149807, -438.4703104977463, -939.430225484612, -818.1514827141166, -299.50878575126586, -809.0046192946113, -886.3937524847107, -1070.2301810600368, -1123.8791838631173, -313.72360422302864, -1112.1933733941319, -411.6104275633116, -975.4334597539382, -313.5781266011429, -228.89738363839692, -324.03174577014494, -665.8471824912299, -596.1203129308188, -661.057398676724, -146.54601778870298, -416.43405773649266, -679.8574636218822, -895.653755923579, -1125.8761089807456, -855.1239306520165, -1013.909785676894, -321.7972937954439, -178.8202715990453, -840.8363253212731, -941.7740063072973, -642.5790390313406, -432.7611232315155, -822.3488908355833, -872.9530850517216, -488.8483974305642, -883.4692942586101, -112.17833754347288, -671.1639323125305, -844.9157920356737, -787.9346909452943, -374.2715368331743, -908.5322742106742]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5707734612994811, "mean_inference_ms": 1.7460844224488126, "mean_action_processing_ms": 0.29060068500525227, "mean_env_wait_ms": 3.0605620555046813, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012679338455200195, "StateBufferConnector_ms": 0.008283138275146484, "ViewRequirementAgentConnector_ms": 0.20071721076965332}, "num_episodes": 32, "episode_return_max": -21.421346343948024, "episode_return_min": -1400.600209290991, "episode_return_mean": -733.2873484159304, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.46823874495516, "num_env_steps_trained_throughput_per_sec": 290.46823874495516, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13713.044, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13712.966, "sample_time_ms": 1072.663, "learn_time_ms": 12569.152, "learn_throughput": 318.239, "synch_weights_time_ms": 70.256}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00017", "date": "2024-08-03_05-15-23", "timestamp": 1722642323, "time_this_iter_s": 13.785031795501709, "time_total_s": 164.17302179336548, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0e170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.17302179336548, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.589473684210528, "ram_util_percent": 30.799999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.15242583354314, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.31366637746493, "policy_loss": -0.01111201829771744, "vf_loss": 6.321141493320465, "vf_explained_var": 0.8425143112118045, "kl": 0.016188799087134016, "entropy": 1.2197270089760424, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -112.17833754347288, "episode_reward_min": -1400.600209290991, "episode_reward_mean": -693.9301275278177, "episode_len_mean": 140.01, "episode_media": {}, "episodes_timesteps_total": 14001, "policy_reward_min": {"policy_0": -1400.600209290991}, "policy_reward_max": {"policy_0": -112.17833754347288}, "policy_reward_mean": {"policy_0": -693.9301275278177}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1018.3425547192618, -535.9200181631084, -1400.600209290991, -1254.1952748631113, -262.8116622638285, -247.3121029617781, -245.10220777055858, -1384.7633267988404, -564.9561640278678, -737.5297100276558, -775.8416112832266, -663.9960220953133, -436.2255296485293, -976.7798505237625, -230.9999383284948, -769.32183871142, -1275.3483349479434, -843.495396864069, -441.6295981312292, -381.02994654978227, -1099.411749401055, -491.4804457843381, -481.4974855712612, -1125.3126903438922, -232.89275236671025, -650.6280402398121, -1060.9215483818605, -960.7356552945122, -256.8032978768686, -1334.2489989192284, -1040.5809710193175, -1029.9979669149807, -438.4703104977463, -939.430225484612, -818.1514827141166, -299.50878575126586, -809.0046192946113, -886.3937524847107, -1070.2301810600368, -1123.8791838631173, -313.72360422302864, -1112.1933733941319, -411.6104275633116, -975.4334597539382, -313.5781266011429, -228.89738363839692, -324.03174577014494, -665.8471824912299, -596.1203129308188, -661.057398676724, -146.54601778870298, -416.43405773649266, -679.8574636218822, -895.653755923579, -1125.8761089807456, -855.1239306520165, -1013.909785676894, -321.7972937954439, -178.8202715990453, -840.8363253212731, -941.7740063072973, -642.5790390313406, -432.7611232315155, -822.3488908355833, -872.9530850517216, -488.8483974305642, -883.4692942586101, -112.17833754347288, -671.1639323125305, -844.9157920356737, -787.9346909452943, -374.2715368331743, -908.5322742106742, -1141.9141559218772, -342.9139544289959, -864.8644531423478, -268.92877412637404, -876.7304771415933, -682.5834949891419, -439.5071304178159, -567.6821514526072, -314.5098215198657, -517.0818419019183, -599.3495189539605, -894.6742808461336, -590.0102889885527, -723.6222075691641, -392.7017159684514, -960.3253488090724, -455.82998755410097, -676.3047900488198, -462.49840041641244, -818.7718680472514, -898.7960785578582, -173.05190954536602, -295.6887693289624, -1212.2844702290483, -937.1655271641101, -1012.7910939258666, -815.5703743848891], "episode_lengths": [150, 150, 150, 150, 110, 100, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 116, 150, 150, 150, 150, 150, 76, 150, 150, 150, 101, 150, 150, 150, 125, 150, 150, 119, 150, 150, 150, 150, 126, 150, 150, 150, 88, 101, 150, 150, 150, 150, 58, 141, 150, 150, 150, 150, 150, 97, 104, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 116, 150, 148, 140, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 86, 139, 150, 150, 150, 150], "policy_policy_0_reward": [-1018.3425547192618, -535.9200181631084, -1400.600209290991, -1254.1952748631113, -262.8116622638285, -247.3121029617781, -245.10220777055858, -1384.7633267988404, -564.9561640278678, -737.5297100276558, -775.8416112832266, -663.9960220953133, -436.2255296485293, -976.7798505237625, -230.9999383284948, -769.32183871142, -1275.3483349479434, -843.495396864069, -441.6295981312292, -381.02994654978227, -1099.411749401055, -491.4804457843381, -481.4974855712612, -1125.3126903438922, -232.89275236671025, -650.6280402398121, -1060.9215483818605, -960.7356552945122, -256.8032978768686, -1334.2489989192284, -1040.5809710193175, -1029.9979669149807, -438.4703104977463, -939.430225484612, -818.1514827141166, -299.50878575126586, -809.0046192946113, -886.3937524847107, -1070.2301810600368, -1123.8791838631173, -313.72360422302864, -1112.1933733941319, -411.6104275633116, -975.4334597539382, -313.5781266011429, -228.89738363839692, -324.03174577014494, -665.8471824912299, -596.1203129308188, -661.057398676724, -146.54601778870298, -416.43405773649266, -679.8574636218822, -895.653755923579, -1125.8761089807456, -855.1239306520165, -1013.909785676894, -321.7972937954439, -178.8202715990453, -840.8363253212731, -941.7740063072973, -642.5790390313406, -432.7611232315155, -822.3488908355833, -872.9530850517216, -488.8483974305642, -883.4692942586101, -112.17833754347288, -671.1639323125305, -844.9157920356737, -787.9346909452943, -374.2715368331743, -908.5322742106742, -1141.9141559218772, -342.9139544289959, -864.8644531423478, -268.92877412637404, -876.7304771415933, -682.5834949891419, -439.5071304178159, -567.6821514526072, -314.5098215198657, -517.0818419019183, -599.3495189539605, -894.6742808461336, -590.0102889885527, -723.6222075691641, -392.7017159684514, -960.3253488090724, -455.82998755410097, -676.3047900488198, -462.49840041641244, -818.7718680472514, -898.7960785578582, -173.05190954536602, -295.6887693289624, -1212.2844702290483, -937.1655271641101, -1012.7910939258666, -815.5703743848891]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5707156261613437, "mean_inference_ms": 1.7460749590019646, "mean_action_processing_ms": 0.290504543530686, "mean_env_wait_ms": 3.063433594928241, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012471675872802734, "StateBufferConnector_ms": 0.008226633071899414, "ViewRequirementAgentConnector_ms": 0.2004868984222412}, "num_episodes": 27, "episode_return_max": -112.17833754347288, "episode_return_min": -1400.600209290991, "episode_return_mean": -693.9301275278177, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.40436980745704, "num_env_steps_trained_throughput_per_sec": 277.40436980745704, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13764.275, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13764.195, "sample_time_ms": 1078.127, "learn_time_ms": 12615.817, "learn_throughput": 317.062, "synch_weights_time_ms": 69.345}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00017", "date": "2024-08-03_05-15-38", "timestamp": 1722642338, "time_this_iter_s": 14.43480396270752, "time_total_s": 178.607825756073, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0fc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 178.607825756073, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.257142857142853, "ram_util_percent": 30.799999999999994}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.46957261164983, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.586059501767158, "policy_loss": -0.009936921111269233, "vf_loss": 6.592653435468674, "vf_explained_var": 0.8764612653603157, "kl": 0.015918709612697077, "entropy": 1.4326416989167532, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -14.391069861226528, "episode_reward_min": -1289.675163804225, "episode_reward_mean": -684.5179886280254, "episode_len_mean": 138.41, "episode_media": {}, "episodes_timesteps_total": 13841, "policy_reward_min": {"policy_0": -1289.675163804225}, "policy_reward_max": {"policy_0": -14.391069861226528}, "policy_reward_mean": {"policy_0": -684.5179886280254}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1029.9979669149807, -438.4703104977463, -939.430225484612, -818.1514827141166, -299.50878575126586, -809.0046192946113, -886.3937524847107, -1070.2301810600368, -1123.8791838631173, -313.72360422302864, -1112.1933733941319, -411.6104275633116, -975.4334597539382, -313.5781266011429, -228.89738363839692, -324.03174577014494, -665.8471824912299, -596.1203129308188, -661.057398676724, -146.54601778870298, -416.43405773649266, -679.8574636218822, -895.653755923579, -1125.8761089807456, -855.1239306520165, -1013.909785676894, -321.7972937954439, -178.8202715990453, -840.8363253212731, -941.7740063072973, -642.5790390313406, -432.7611232315155, -822.3488908355833, -872.9530850517216, -488.8483974305642, -883.4692942586101, -112.17833754347288, -671.1639323125305, -844.9157920356737, -787.9346909452943, -374.2715368331743, -908.5322742106742, -1141.9141559218772, -342.9139544289959, -864.8644531423478, -268.92877412637404, -876.7304771415933, -682.5834949891419, -439.5071304178159, -567.6821514526072, -314.5098215198657, -517.0818419019183, -599.3495189539605, -894.6742808461336, -590.0102889885527, -723.6222075691641, -392.7017159684514, -960.3253488090724, -455.82998755410097, -676.3047900488198, -462.49840041641244, -818.7718680472514, -898.7960785578582, -173.05190954536602, -295.6887693289624, -1212.2844702290483, -937.1655271641101, -1012.7910939258666, -815.5703743848891, -329.6612113621766, -716.6629546126251, -948.0078009170317, -828.4145981016122, -54.919889108124714, -299.9518108625032, -37.77169849310499, -837.0315951954007, -1282.3935150028508, -1206.6444964106388, -975.7020634862297, -14.391069861226528, -377.5062437499135, -222.67876788770906, -450.7918793398553, -740.4960892870284, -919.6030817762326, -1049.0577278671867, -237.60292615940494, -702.4782464630741, -876.6568523534369, -693.3316459975462, -1289.675163804225, -953.6779625794487, -967.238543400144, -1092.4825680643196, -557.5723141228257, -730.8284458258539, -1238.6835697398792, -1130.701751041275, -476.88456031749814], "episode_lengths": [150, 125, 150, 150, 119, 150, 150, 150, 150, 126, 150, 150, 150, 88, 101, 150, 150, 150, 150, 58, 141, 150, 150, 150, 150, 150, 97, 104, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 116, 150, 148, 140, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 86, 139, 150, 150, 150, 150, 150, 150, 150, 150, 65, 87, 50, 150, 150, 150, 150, 55, 126, 100, 150, 150, 150, 150, 129, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 127], "policy_policy_0_reward": [-1029.9979669149807, -438.4703104977463, -939.430225484612, -818.1514827141166, -299.50878575126586, -809.0046192946113, -886.3937524847107, -1070.2301810600368, -1123.8791838631173, -313.72360422302864, -1112.1933733941319, -411.6104275633116, -975.4334597539382, -313.5781266011429, -228.89738363839692, -324.03174577014494, -665.8471824912299, -596.1203129308188, -661.057398676724, -146.54601778870298, -416.43405773649266, -679.8574636218822, -895.653755923579, -1125.8761089807456, -855.1239306520165, -1013.909785676894, -321.7972937954439, -178.8202715990453, -840.8363253212731, -941.7740063072973, -642.5790390313406, -432.7611232315155, -822.3488908355833, -872.9530850517216, -488.8483974305642, -883.4692942586101, -112.17833754347288, -671.1639323125305, -844.9157920356737, -787.9346909452943, -374.2715368331743, -908.5322742106742, -1141.9141559218772, -342.9139544289959, -864.8644531423478, -268.92877412637404, -876.7304771415933, -682.5834949891419, -439.5071304178159, -567.6821514526072, -314.5098215198657, -517.0818419019183, -599.3495189539605, -894.6742808461336, -590.0102889885527, -723.6222075691641, -392.7017159684514, -960.3253488090724, -455.82998755410097, -676.3047900488198, -462.49840041641244, -818.7718680472514, -898.7960785578582, -173.05190954536602, -295.6887693289624, -1212.2844702290483, -937.1655271641101, -1012.7910939258666, -815.5703743848891, -329.6612113621766, -716.6629546126251, -948.0078009170317, -828.4145981016122, -54.919889108124714, -299.9518108625032, -37.77169849310499, -837.0315951954007, -1282.3935150028508, -1206.6444964106388, -975.7020634862297, -14.391069861226528, -377.5062437499135, -222.67876788770906, -450.7918793398553, -740.4960892870284, -919.6030817762326, -1049.0577278671867, -237.60292615940494, -702.4782464630741, -876.6568523534369, -693.3316459975462, -1289.675163804225, -953.6779625794487, -967.238543400144, -1092.4825680643196, -557.5723141228257, -730.8284458258539, -1238.6835697398792, -1130.701751041275, -476.88456031749814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5703463545035182, "mean_inference_ms": 1.7470159400785967, "mean_action_processing_ms": 0.29048520310265036, "mean_env_wait_ms": 3.0651086650226755, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012237310409545898, "StateBufferConnector_ms": 0.008224010467529297, "ViewRequirementAgentConnector_ms": 0.19883489608764648}, "num_episodes": 31, "episode_return_max": -14.391069861226528, "episode_return_min": -1289.675163804225, "episode_return_mean": -684.5179886280254, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.4529453653585, "num_env_steps_trained_throughput_per_sec": 291.4529453653585, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13824.601, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13824.522, "sample_time_ms": 1083.884, "learn_time_ms": 12670.683, "learn_throughput": 315.689, "synch_weights_time_ms": 68.996}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00017", "date": "2024-08-03_05-15-52", "timestamp": 1722642352, "time_this_iter_s": 13.738501071929932, "time_total_s": 192.34632682800293, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0fd90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.34632682800293, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.7, "ram_util_percent": 30.799999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 75.74329226712386, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.300243487954139, "policy_loss": -0.00949620461469749, "vf_loss": 6.305446999768416, "vf_explained_var": 0.8751735496645172, "kl": 0.019028540100710735, "entropy": 1.4158722716073195, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -14.391069861226528, "episode_reward_min": -1437.6914013549583, "episode_reward_mean": -701.1428013098673, "episode_len_mean": 138.25, "episode_media": {}, "episodes_timesteps_total": 13825, "policy_reward_min": {"policy_0": -1437.6914013549583}, "policy_reward_max": {"policy_0": -14.391069861226528}, "policy_reward_mean": {"policy_0": -701.1428013098673}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.8202715990453, -840.8363253212731, -941.7740063072973, -642.5790390313406, -432.7611232315155, -822.3488908355833, -872.9530850517216, -488.8483974305642, -883.4692942586101, -112.17833754347288, -671.1639323125305, -844.9157920356737, -787.9346909452943, -374.2715368331743, -908.5322742106742, -1141.9141559218772, -342.9139544289959, -864.8644531423478, -268.92877412637404, -876.7304771415933, -682.5834949891419, -439.5071304178159, -567.6821514526072, -314.5098215198657, -517.0818419019183, -599.3495189539605, -894.6742808461336, -590.0102889885527, -723.6222075691641, -392.7017159684514, -960.3253488090724, -455.82998755410097, -676.3047900488198, -462.49840041641244, -818.7718680472514, -898.7960785578582, -173.05190954536602, -295.6887693289624, -1212.2844702290483, -937.1655271641101, -1012.7910939258666, -815.5703743848891, -329.6612113621766, -716.6629546126251, -948.0078009170317, -828.4145981016122, -54.919889108124714, -299.9518108625032, -37.77169849310499, -837.0315951954007, -1282.3935150028508, -1206.6444964106388, -975.7020634862297, -14.391069861226528, -377.5062437499135, -222.67876788770906, -450.7918793398553, -740.4960892870284, -919.6030817762326, -1049.0577278671867, -237.60292615940494, -702.4782464630741, -876.6568523534369, -693.3316459975462, -1289.675163804225, -953.6779625794487, -967.238543400144, -1092.4825680643196, -557.5723141228257, -730.8284458258539, -1238.6835697398792, -1130.701751041275, -476.88456031749814, -945.4050430263919, -550.484311121645, -609.6553021270616, -233.63349047777487, -485.9842132927862, -114.92174682267091, -938.3135440103551, -638.6298408454005, -1052.7561155518913, -972.9693730480141, -1245.3545000200675, -332.7412729988063, -49.497706645253245, -959.7925045446816, -1207.5499580688659, -1269.5319701178482, -1041.8052222870097, -1089.472191575105, -366.73414600575103, -207.23384056541542, -834.7523138487503, -456.7645445773579, -1437.6914013549583, -995.1897282117616, -447.6696959034684, -357.83493482206285, -1292.870293596854], "episode_lengths": [104, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 116, 150, 148, 140, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 86, 139, 150, 150, 150, 150, 150, 150, 150, 150, 65, 87, 50, 150, 150, 150, 150, 55, 126, 100, 150, 150, 150, 150, 129, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 90, 150, 59, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 118, 71, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-178.8202715990453, -840.8363253212731, -941.7740063072973, -642.5790390313406, -432.7611232315155, -822.3488908355833, -872.9530850517216, -488.8483974305642, -883.4692942586101, -112.17833754347288, -671.1639323125305, -844.9157920356737, -787.9346909452943, -374.2715368331743, -908.5322742106742, -1141.9141559218772, -342.9139544289959, -864.8644531423478, -268.92877412637404, -876.7304771415933, -682.5834949891419, -439.5071304178159, -567.6821514526072, -314.5098215198657, -517.0818419019183, -599.3495189539605, -894.6742808461336, -590.0102889885527, -723.6222075691641, -392.7017159684514, -960.3253488090724, -455.82998755410097, -676.3047900488198, -462.49840041641244, -818.7718680472514, -898.7960785578582, -173.05190954536602, -295.6887693289624, -1212.2844702290483, -937.1655271641101, -1012.7910939258666, -815.5703743848891, -329.6612113621766, -716.6629546126251, -948.0078009170317, -828.4145981016122, -54.919889108124714, -299.9518108625032, -37.77169849310499, -837.0315951954007, -1282.3935150028508, -1206.6444964106388, -975.7020634862297, -14.391069861226528, -377.5062437499135, -222.67876788770906, -450.7918793398553, -740.4960892870284, -919.6030817762326, -1049.0577278671867, -237.60292615940494, -702.4782464630741, -876.6568523534369, -693.3316459975462, -1289.675163804225, -953.6779625794487, -967.238543400144, -1092.4825680643196, -557.5723141228257, -730.8284458258539, -1238.6835697398792, -1130.701751041275, -476.88456031749814, -945.4050430263919, -550.484311121645, -609.6553021270616, -233.63349047777487, -485.9842132927862, -114.92174682267091, -938.3135440103551, -638.6298408454005, -1052.7561155518913, -972.9693730480141, -1245.3545000200675, -332.7412729988063, -49.497706645253245, -959.7925045446816, -1207.5499580688659, -1269.5319701178482, -1041.8052222870097, -1089.472191575105, -366.73414600575103, -207.23384056541542, -834.7523138487503, -456.7645445773579, -1437.6914013549583, -995.1897282117616, -447.6696959034684, -357.83493482206285, -1292.870293596854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5707985079604793, "mean_inference_ms": 1.7476649233776647, "mean_action_processing_ms": 0.29059969395772, "mean_env_wait_ms": 3.069483850556315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012063264846801758, "StateBufferConnector_ms": 0.008116006851196289, "ViewRequirementAgentConnector_ms": 0.1954352855682373}, "num_episodes": 27, "episode_return_max": -14.391069861226528, "episode_return_min": -1437.6914013549583, "episode_return_mean": -701.1428013098673, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 505.5106489718624, "num_env_steps_trained_throughput_per_sec": 505.5106489718624, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13244.589, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13244.513, "sample_time_ms": 1092.408, "learn_time_ms": 12083.75, "learn_throughput": 331.023, "synch_weights_time_ms": 67.407}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00017", "date": "2024-08-03_05-16-00", "timestamp": 1722642360, "time_this_iter_s": 7.926168203353882, "time_total_s": 200.2724950313568, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0d000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 200.2724950313568, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 21.866666666666664, "ram_util_percent": 30.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 91.07731122672558, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.011719541996717, "policy_loss": -0.011297934376246606, "vf_loss": 6.019264773527781, "vf_explained_var": 0.9324562366430958, "kl": 0.016774126945225967, "entropy": 1.279527890558044, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -14.391069861226528, "episode_reward_min": -1461.1279378558163, "episode_reward_mean": -715.1408475668968, "episode_len_mean": 137.61, "episode_media": {}, "episodes_timesteps_total": 13761, "policy_reward_min": {"policy_0": -1461.1279378558163}, "policy_reward_max": {"policy_0": -14.391069861226528}, "policy_reward_mean": {"policy_0": -715.1408475668968}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-960.3253488090724, -455.82998755410097, -676.3047900488198, -462.49840041641244, -818.7718680472514, -898.7960785578582, -173.05190954536602, -295.6887693289624, -1212.2844702290483, -937.1655271641101, -1012.7910939258666, -815.5703743848891, -329.6612113621766, -716.6629546126251, -948.0078009170317, -828.4145981016122, -54.919889108124714, -299.9518108625032, -37.77169849310499, -837.0315951954007, -1282.3935150028508, -1206.6444964106388, -975.7020634862297, -14.391069861226528, -377.5062437499135, -222.67876788770906, -450.7918793398553, -740.4960892870284, -919.6030817762326, -1049.0577278671867, -237.60292615940494, -702.4782464630741, -876.6568523534369, -693.3316459975462, -1289.675163804225, -953.6779625794487, -967.238543400144, -1092.4825680643196, -557.5723141228257, -730.8284458258539, -1238.6835697398792, -1130.701751041275, -476.88456031749814, -945.4050430263919, -550.484311121645, -609.6553021270616, -233.63349047777487, -485.9842132927862, -114.92174682267091, -938.3135440103551, -638.6298408454005, -1052.7561155518913, -972.9693730480141, -1245.3545000200675, -332.7412729988063, -49.497706645253245, -959.7925045446816, -1207.5499580688659, -1269.5319701178482, -1041.8052222870097, -1089.472191575105, -366.73414600575103, -207.23384056541542, -834.7523138487503, -456.7645445773579, -1437.6914013549583, -995.1897282117616, -447.6696959034684, -357.83493482206285, -1292.870293596854, -759.8214136316432, -951.2679448447727, -712.400020544484, -814.8054736113482, -728.551957290228, -303.4773881069611, -579.6551523483088, -777.7936026917918, -160.66121249939388, -915.9416944829254, -824.501674519907, -538.3718791122193, -570.7228993779939, -73.01989962574764, -405.20741876263185, -1296.242604782146, -784.7082889478775, -464.46167023876745, -82.2697480861577, -516.8926869372223, -440.19417927762925, -948.3699974098979, -1461.1279378558163, -815.2172314197833, -1062.6054366293124, -1059.5674986970323, -144.14375418554687, -961.7918490367502, -796.9184000837198, -469.55497498152516], "episode_lengths": [150, 150, 150, 150, 150, 150, 86, 139, 150, 150, 150, 150, 150, 150, 150, 150, 65, 87, 50, 150, 150, 150, 150, 55, 126, 100, 150, 150, 150, 150, 129, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 90, 150, 59, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 118, 71, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 94, 150, 150, 150, 150, 62, 138, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 110], "policy_policy_0_reward": [-960.3253488090724, -455.82998755410097, -676.3047900488198, -462.49840041641244, -818.7718680472514, -898.7960785578582, -173.05190954536602, -295.6887693289624, -1212.2844702290483, -937.1655271641101, -1012.7910939258666, -815.5703743848891, -329.6612113621766, -716.6629546126251, -948.0078009170317, -828.4145981016122, -54.919889108124714, -299.9518108625032, -37.77169849310499, -837.0315951954007, -1282.3935150028508, -1206.6444964106388, -975.7020634862297, -14.391069861226528, -377.5062437499135, -222.67876788770906, -450.7918793398553, -740.4960892870284, -919.6030817762326, -1049.0577278671867, -237.60292615940494, -702.4782464630741, -876.6568523534369, -693.3316459975462, -1289.675163804225, -953.6779625794487, -967.238543400144, -1092.4825680643196, -557.5723141228257, -730.8284458258539, -1238.6835697398792, -1130.701751041275, -476.88456031749814, -945.4050430263919, -550.484311121645, -609.6553021270616, -233.63349047777487, -485.9842132927862, -114.92174682267091, -938.3135440103551, -638.6298408454005, -1052.7561155518913, -972.9693730480141, -1245.3545000200675, -332.7412729988063, -49.497706645253245, -959.7925045446816, -1207.5499580688659, -1269.5319701178482, -1041.8052222870097, -1089.472191575105, -366.73414600575103, -207.23384056541542, -834.7523138487503, -456.7645445773579, -1437.6914013549583, -995.1897282117616, -447.6696959034684, -357.83493482206285, -1292.870293596854, -759.8214136316432, -951.2679448447727, -712.400020544484, -814.8054736113482, -728.551957290228, -303.4773881069611, -579.6551523483088, -777.7936026917918, -160.66121249939388, -915.9416944829254, -824.501674519907, -538.3718791122193, -570.7228993779939, -73.01989962574764, -405.20741876263185, -1296.242604782146, -784.7082889478775, -464.46167023876745, -82.2697480861577, -516.8926869372223, -440.19417927762925, -948.3699974098979, -1461.1279378558163, -815.2172314197833, -1062.6054366293124, -1059.5674986970323, -144.14375418554687, -961.7918490367502, -796.9184000837198, -469.55497498152516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5710832308866098, "mean_inference_ms": 1.7481537814784271, "mean_action_processing_ms": 0.29043776068222443, "mean_env_wait_ms": 3.076516465628611, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011928081512451172, "StateBufferConnector_ms": 0.008257865905761719, "ViewRequirementAgentConnector_ms": 0.20232200622558594}, "num_episodes": 30, "episode_return_max": -14.391069861226528, "episode_return_min": -1461.1279378558163, "episode_return_mean": -715.1408475668968, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 426.8362653047974, "num_env_steps_trained_throughput_per_sec": 426.8362653047974, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12788.233, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12788.157, "sample_time_ms": 1095.776, "learn_time_ms": 11625.524, "learn_throughput": 344.071, "synch_weights_time_ms": 65.969}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00017", "date": "2024-08-03_05-16-09", "timestamp": 1722642369, "time_this_iter_s": 9.383219003677368, "time_total_s": 209.65571403503418, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0cdc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 209.65571403503418, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 20.54615384615385, "ram_util_percent": 30.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 73.41220161517461, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.24294845710198, "policy_loss": -0.01177185367171963, "vf_loss": 6.249987737834454, "vf_explained_var": 0.9280559826021393, "kl": 0.02025209196108335, "entropy": 1.3430504464854798, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -25.373331240495492, "episode_reward_min": -1461.1279378558163, "episode_reward_mean": -723.0446742151038, "episode_len_mean": 137.82, "episode_media": {}, "episodes_timesteps_total": 13782, "policy_reward_min": {"policy_0": -1461.1279378558163}, "policy_reward_max": {"policy_0": -25.373331240495492}, "policy_reward_mean": {"policy_0": -723.0446742151038}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-702.4782464630741, -876.6568523534369, -693.3316459975462, -1289.675163804225, -953.6779625794487, -967.238543400144, -1092.4825680643196, -557.5723141228257, -730.8284458258539, -1238.6835697398792, -1130.701751041275, -476.88456031749814, -945.4050430263919, -550.484311121645, -609.6553021270616, -233.63349047777487, -485.9842132927862, -114.92174682267091, -938.3135440103551, -638.6298408454005, -1052.7561155518913, -972.9693730480141, -1245.3545000200675, -332.7412729988063, -49.497706645253245, -959.7925045446816, -1207.5499580688659, -1269.5319701178482, -1041.8052222870097, -1089.472191575105, -366.73414600575103, -207.23384056541542, -834.7523138487503, -456.7645445773579, -1437.6914013549583, -995.1897282117616, -447.6696959034684, -357.83493482206285, -1292.870293596854, -759.8214136316432, -951.2679448447727, -712.400020544484, -814.8054736113482, -728.551957290228, -303.4773881069611, -579.6551523483088, -777.7936026917918, -160.66121249939388, -915.9416944829254, -824.501674519907, -538.3718791122193, -570.7228993779939, -73.01989962574764, -405.20741876263185, -1296.242604782146, -784.7082889478775, -464.46167023876745, -82.2697480861577, -516.8926869372223, -440.19417927762925, -948.3699974098979, -1461.1279378558163, -815.2172314197833, -1062.6054366293124, -1059.5674986970323, -144.14375418554687, -961.7918490367502, -796.9184000837198, -469.55497498152516, -607.2045540963946, -632.1794971319549, -526.2578852385749, -610.6665510819838, -1067.4198175790063, -1204.390113183738, -1262.282968600743, -1267.791887365253, -189.48169045725197, -139.0528258818216, -720.1706904282446, -251.84507573766712, -25.373331240495492, -873.7727854622682, -775.0112351295011, -851.9492911540658, -619.071332602878, -931.9312582245167, -37.38807455133835, -321.7440144990192, -986.7649581135073, -582.8324747497454, -66.08057285599772, -709.680289282355, -1013.3688252185113, -741.1367410593465, -1121.5267754915048, -1159.0887227736425, -390.2538774905247, -159.54164208891967, -1193.4909435425395], "episode_lengths": [150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 90, 150, 59, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 118, 71, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 94, 150, 150, 150, 150, 62, 138, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 110, 131, 150, 150, 150, 150, 150, 150, 150, 71, 97, 150, 148, 48, 150, 150, 150, 150, 150, 57, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 99, 150], "policy_policy_0_reward": [-702.4782464630741, -876.6568523534369, -693.3316459975462, -1289.675163804225, -953.6779625794487, -967.238543400144, -1092.4825680643196, -557.5723141228257, -730.8284458258539, -1238.6835697398792, -1130.701751041275, -476.88456031749814, -945.4050430263919, -550.484311121645, -609.6553021270616, -233.63349047777487, -485.9842132927862, -114.92174682267091, -938.3135440103551, -638.6298408454005, -1052.7561155518913, -972.9693730480141, -1245.3545000200675, -332.7412729988063, -49.497706645253245, -959.7925045446816, -1207.5499580688659, -1269.5319701178482, -1041.8052222870097, -1089.472191575105, -366.73414600575103, -207.23384056541542, -834.7523138487503, -456.7645445773579, -1437.6914013549583, -995.1897282117616, -447.6696959034684, -357.83493482206285, -1292.870293596854, -759.8214136316432, -951.2679448447727, -712.400020544484, -814.8054736113482, -728.551957290228, -303.4773881069611, -579.6551523483088, -777.7936026917918, -160.66121249939388, -915.9416944829254, -824.501674519907, -538.3718791122193, -570.7228993779939, -73.01989962574764, -405.20741876263185, -1296.242604782146, -784.7082889478775, -464.46167023876745, -82.2697480861577, -516.8926869372223, -440.19417927762925, -948.3699974098979, -1461.1279378558163, -815.2172314197833, -1062.6054366293124, -1059.5674986970323, -144.14375418554687, -961.7918490367502, -796.9184000837198, -469.55497498152516, -607.2045540963946, -632.1794971319549, -526.2578852385749, -610.6665510819838, -1067.4198175790063, -1204.390113183738, -1262.282968600743, -1267.791887365253, -189.48169045725197, -139.0528258818216, -720.1706904282446, -251.84507573766712, -25.373331240495492, -873.7727854622682, -775.0112351295011, -851.9492911540658, -619.071332602878, -931.9312582245167, -37.38807455133835, -321.7440144990192, -986.7649581135073, -582.8324747497454, -66.08057285599772, -709.680289282355, -1013.3688252185113, -741.1367410593465, -1121.5267754915048, -1159.0887227736425, -390.2538774905247, -159.54164208891967, -1193.4909435425395]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5705103481024849, "mean_inference_ms": 1.748895555264915, "mean_action_processing_ms": 0.29008699952065276, "mean_env_wait_ms": 3.0819282950701665, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011733293533325195, "StateBufferConnector_ms": 0.008370637893676758, "ViewRequirementAgentConnector_ms": 0.20081543922424316}, "num_episodes": 31, "episode_return_max": -25.373331240495492, "episode_return_min": -1461.1279378558163, "episode_return_mean": -723.0446742151038, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.1951203715318, "num_env_steps_trained_throughput_per_sec": 295.1951203715318, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12773.705, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12773.627, "sample_time_ms": 1106.896, "learn_time_ms": 11599.905, "learn_throughput": 344.83, "synch_weights_time_ms": 65.929}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00017", "date": "2024-08-03_05-16-23", "timestamp": 1722642383, "time_this_iter_s": 13.566127061843872, "time_total_s": 223.22184109687805, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8d000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 223.22184109687805, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.915789473684207, "ram_util_percent": 30.799999999999997}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 99.48591702580453, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.496979933232069, "policy_loss": -0.008817432406552446, "vf_loss": 5.500380626817544, "vf_explained_var": 0.9224304760495822, "kl": 0.015004210700014202, "entropy": 1.3351493027061223, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -22.728872797894294, "episode_reward_min": -1471.7838209251952, "episode_reward_mean": -695.5973986262425, "episode_len_mean": 136.08, "episode_media": {}, "episodes_timesteps_total": 13608, "policy_reward_min": {"policy_0": -1471.7838209251952}, "policy_reward_max": {"policy_0": -22.728872797894294}, "policy_reward_mean": {"policy_0": -695.5973986262425}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1089.472191575105, -366.73414600575103, -207.23384056541542, -834.7523138487503, -456.7645445773579, -1437.6914013549583, -995.1897282117616, -447.6696959034684, -357.83493482206285, -1292.870293596854, -759.8214136316432, -951.2679448447727, -712.400020544484, -814.8054736113482, -728.551957290228, -303.4773881069611, -579.6551523483088, -777.7936026917918, -160.66121249939388, -915.9416944829254, -824.501674519907, -538.3718791122193, -570.7228993779939, -73.01989962574764, -405.20741876263185, -1296.242604782146, -784.7082889478775, -464.46167023876745, -82.2697480861577, -516.8926869372223, -440.19417927762925, -948.3699974098979, -1461.1279378558163, -815.2172314197833, -1062.6054366293124, -1059.5674986970323, -144.14375418554687, -961.7918490367502, -796.9184000837198, -469.55497498152516, -607.2045540963946, -632.1794971319549, -526.2578852385749, -610.6665510819838, -1067.4198175790063, -1204.390113183738, -1262.282968600743, -1267.791887365253, -189.48169045725197, -139.0528258818216, -720.1706904282446, -251.84507573766712, -25.373331240495492, -873.7727854622682, -775.0112351295011, -851.9492911540658, -619.071332602878, -931.9312582245167, -37.38807455133835, -321.7440144990192, -986.7649581135073, -582.8324747497454, -66.08057285599772, -709.680289282355, -1013.3688252185113, -741.1367410593465, -1121.5267754915048, -1159.0887227736425, -390.2538774905247, -159.54164208891967, -1193.4909435425395, -676.2272847346386, -704.3697882210487, -720.9544572370777, -437.5868062415308, -1179.0777070991646, -668.3456976408239, -1287.8779744799524, -828.8204844442364, -58.299389151781824, -969.6883969045278, -964.7526486198403, -22.728872797894294, -921.9826267368252, -1009.4283577493384, -371.7145774678932, -1471.7838209251952, -1140.8541262516253, -627.5566587715858, -864.575216508948, -405.1115504130005, -321.7874307116345, -952.4422927202002, -493.46067274207616, -274.6567994661955, -222.72136498564197, -698.7916341468831, -752.3313247309579, -1367.8011864548123, -198.7810314745853], "episode_lengths": [150, 118, 71, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 94, 150, 150, 150, 150, 62, 138, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 110, 131, 150, 150, 150, 150, 150, 150, 150, 71, 97, 150, 148, 48, 150, 150, 150, 150, 150, 57, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 41, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 121, 85, 86, 150, 150, 150, 115], "policy_policy_0_reward": [-1089.472191575105, -366.73414600575103, -207.23384056541542, -834.7523138487503, -456.7645445773579, -1437.6914013549583, -995.1897282117616, -447.6696959034684, -357.83493482206285, -1292.870293596854, -759.8214136316432, -951.2679448447727, -712.400020544484, -814.8054736113482, -728.551957290228, -303.4773881069611, -579.6551523483088, -777.7936026917918, -160.66121249939388, -915.9416944829254, -824.501674519907, -538.3718791122193, -570.7228993779939, -73.01989962574764, -405.20741876263185, -1296.242604782146, -784.7082889478775, -464.46167023876745, -82.2697480861577, -516.8926869372223, -440.19417927762925, -948.3699974098979, -1461.1279378558163, -815.2172314197833, -1062.6054366293124, -1059.5674986970323, -144.14375418554687, -961.7918490367502, -796.9184000837198, -469.55497498152516, -607.2045540963946, -632.1794971319549, -526.2578852385749, -610.6665510819838, -1067.4198175790063, -1204.390113183738, -1262.282968600743, -1267.791887365253, -189.48169045725197, -139.0528258818216, -720.1706904282446, -251.84507573766712, -25.373331240495492, -873.7727854622682, -775.0112351295011, -851.9492911540658, -619.071332602878, -931.9312582245167, -37.38807455133835, -321.7440144990192, -986.7649581135073, -582.8324747497454, -66.08057285599772, -709.680289282355, -1013.3688252185113, -741.1367410593465, -1121.5267754915048, -1159.0887227736425, -390.2538774905247, -159.54164208891967, -1193.4909435425395, -676.2272847346386, -704.3697882210487, -720.9544572370777, -437.5868062415308, -1179.0777070991646, -668.3456976408239, -1287.8779744799524, -828.8204844442364, -58.299389151781824, -969.6883969045278, -964.7526486198403, -22.728872797894294, -921.9826267368252, -1009.4283577493384, -371.7145774678932, -1471.7838209251952, -1140.8541262516253, -627.5566587715858, -864.575216508948, -405.1115504130005, -321.7874307116345, -952.4422927202002, -493.46067274207616, -274.6567994661955, -222.72136498564197, -698.7916341468831, -752.3313247309579, -1367.8011864548123, -198.7810314745853]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5703434284670508, "mean_inference_ms": 1.7491035550888163, "mean_action_processing_ms": 0.2897174224764431, "mean_env_wait_ms": 3.0844490556022093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012027263641357422, "StateBufferConnector_ms": 0.008465051651000977, "ViewRequirementAgentConnector_ms": 0.204603910446167}, "num_episodes": 29, "episode_return_max": -22.728872797894294, "episode_return_min": -1471.7838209251952, "episode_return_mean": -695.5973986262425, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.81152287992643, "num_env_steps_trained_throughput_per_sec": 290.81152287992643, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12781.509, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12781.427, "sample_time_ms": 1107.352, "learn_time_ms": 11607.02, "learn_throughput": 344.619, "synch_weights_time_ms": 66.108}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00017", "date": "2024-08-03_05-16-37", "timestamp": 1722642397, "time_this_iter_s": 13.767683506011963, "time_total_s": 236.98952460289001, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0d000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 236.98952460289001, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.62, "ram_util_percent": 30.829999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.07395659784476, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.2697061486542225, "policy_loss": -0.008356907083361875, "vf_loss": 5.272635701050361, "vf_explained_var": 0.952807176920275, "kl": 0.015242704533739033, "entropy": 1.4318528066078822, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -22.728872797894294, "episode_reward_min": -1471.7838209251952, "episode_reward_mean": -693.4239522347868, "episode_len_mean": 134.43, "episode_media": {}, "episodes_timesteps_total": 13443, "policy_reward_min": {"policy_0": -1471.7838209251952}, "policy_reward_max": {"policy_0": -22.728872797894294}, "policy_reward_mean": {"policy_0": -693.4239522347868}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-82.2697480861577, -516.8926869372223, -440.19417927762925, -948.3699974098979, -1461.1279378558163, -815.2172314197833, -1062.6054366293124, -1059.5674986970323, -144.14375418554687, -961.7918490367502, -796.9184000837198, -469.55497498152516, -607.2045540963946, -632.1794971319549, -526.2578852385749, -610.6665510819838, -1067.4198175790063, -1204.390113183738, -1262.282968600743, -1267.791887365253, -189.48169045725197, -139.0528258818216, -720.1706904282446, -251.84507573766712, -25.373331240495492, -873.7727854622682, -775.0112351295011, -851.9492911540658, -619.071332602878, -931.9312582245167, -37.38807455133835, -321.7440144990192, -986.7649581135073, -582.8324747497454, -66.08057285599772, -709.680289282355, -1013.3688252185113, -741.1367410593465, -1121.5267754915048, -1159.0887227736425, -390.2538774905247, -159.54164208891967, -1193.4909435425395, -676.2272847346386, -704.3697882210487, -720.9544572370777, -437.5868062415308, -1179.0777070991646, -668.3456976408239, -1287.8779744799524, -828.8204844442364, -58.299389151781824, -969.6883969045278, -964.7526486198403, -22.728872797894294, -921.9826267368252, -1009.4283577493384, -371.7145774678932, -1471.7838209251952, -1140.8541262516253, -627.5566587715858, -864.575216508948, -405.1115504130005, -321.7874307116345, -952.4422927202002, -493.46067274207616, -274.6567994661955, -222.72136498564197, -698.7916341468831, -752.3313247309579, -1367.8011864548123, -198.7810314745853, -846.1204108633281, -1146.1999771865806, -1059.6735788739236, -970.0960352409746, -449.63103749769436, -1030.9930583544124, -786.6674371707019, -1102.3890996692633, -645.6769058554733, -171.53395763423168, -648.0593105982551, -761.721373726415, -892.683224989828, -563.5486191546902, -66.73815929818763, -251.14030866087555, -725.9638090344911, -982.3579715681979, -53.49668763457125, -766.7444993672814, -972.5158468067306, -329.0122148088517, -355.9938261180353, -985.5916977220314, -637.5893594227243, -505.7303911583073, -536.2256030999549, -686.3862452190455], "episode_lengths": [82, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 110, 131, 150, 150, 150, 150, 150, 150, 150, 71, 97, 150, 148, 48, 150, 150, 150, 150, 150, 57, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 41, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 121, 85, 86, 150, 150, 150, 115, 150, 150, 150, 150, 143, 150, 150, 150, 150, 76, 150, 150, 150, 150, 63, 75, 150, 150, 45, 150, 150, 93, 103, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-82.2697480861577, -516.8926869372223, -440.19417927762925, -948.3699974098979, -1461.1279378558163, -815.2172314197833, -1062.6054366293124, -1059.5674986970323, -144.14375418554687, -961.7918490367502, -796.9184000837198, -469.55497498152516, -607.2045540963946, -632.1794971319549, -526.2578852385749, -610.6665510819838, -1067.4198175790063, -1204.390113183738, -1262.282968600743, -1267.791887365253, -189.48169045725197, -139.0528258818216, -720.1706904282446, -251.84507573766712, -25.373331240495492, -873.7727854622682, -775.0112351295011, -851.9492911540658, -619.071332602878, -931.9312582245167, -37.38807455133835, -321.7440144990192, -986.7649581135073, -582.8324747497454, -66.08057285599772, -709.680289282355, -1013.3688252185113, -741.1367410593465, -1121.5267754915048, -1159.0887227736425, -390.2538774905247, -159.54164208891967, -1193.4909435425395, -676.2272847346386, -704.3697882210487, -720.9544572370777, -437.5868062415308, -1179.0777070991646, -668.3456976408239, -1287.8779744799524, -828.8204844442364, -58.299389151781824, -969.6883969045278, -964.7526486198403, -22.728872797894294, -921.9826267368252, -1009.4283577493384, -371.7145774678932, -1471.7838209251952, -1140.8541262516253, -627.5566587715858, -864.575216508948, -405.1115504130005, -321.7874307116345, -952.4422927202002, -493.46067274207616, -274.6567994661955, -222.72136498564197, -698.7916341468831, -752.3313247309579, -1367.8011864548123, -198.7810314745853, -846.1204108633281, -1146.1999771865806, -1059.6735788739236, -970.0960352409746, -449.63103749769436, -1030.9930583544124, -786.6674371707019, -1102.3890996692633, -645.6769058554733, -171.53395763423168, -648.0593105982551, -761.721373726415, -892.683224989828, -563.5486191546902, -66.73815929818763, -251.14030866087555, -725.9638090344911, -982.3579715681979, -53.49668763457125, -766.7444993672814, -972.5158468067306, -329.0122148088517, -355.9938261180353, -985.5916977220314, -637.5893594227243, -505.7303911583073, -536.2256030999549, -686.3862452190455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5702697121433441, "mean_inference_ms": 1.7500122560133755, "mean_action_processing_ms": 0.2897406531432031, "mean_env_wait_ms": 3.0880516235325945, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012282848358154297, "StateBufferConnector_ms": 0.008525371551513672, "ViewRequirementAgentConnector_ms": 0.20220708847045898}, "num_episodes": 28, "episode_return_max": -22.728872797894294, "episode_return_min": -1471.7838209251952, "episode_return_mean": -693.4239522347868, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.41409873318946, "num_env_steps_trained_throughput_per_sec": 287.41409873318946, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12795.406, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12795.325, "sample_time_ms": 1115.68, "learn_time_ms": 11612.167, "learn_throughput": 344.466, "synch_weights_time_ms": 66.523}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00017", "date": "2024-08-03_05-16-51", "timestamp": 1722642411, "time_this_iter_s": 13.931316137313843, "time_total_s": 250.92084074020386, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa05e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 250.92084074020386, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.875000000000004, "ram_util_percent": 30.894999999999992}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.0767619907856, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.027532952775558, "policy_loss": -0.009831853425324274, "vf_loss": 5.032943227142096, "vf_explained_var": 0.9533726897711555, "kl": 0.01224822753512553, "entropy": 1.0901421191170813, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -22.728872797894294, "episode_reward_min": -1471.7838209251952, "episode_reward_mean": -665.153870566666, "episode_len_mean": 133.19, "episode_media": {}, "episodes_timesteps_total": 13319, "policy_reward_min": {"policy_0": -1471.7838209251952}, "policy_reward_max": {"policy_0": -22.728872797894294}, "policy_reward_mean": {"policy_0": -665.153870566666}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-321.7440144990192, -986.7649581135073, -582.8324747497454, -66.08057285599772, -709.680289282355, -1013.3688252185113, -741.1367410593465, -1121.5267754915048, -1159.0887227736425, -390.2538774905247, -159.54164208891967, -1193.4909435425395, -676.2272847346386, -704.3697882210487, -720.9544572370777, -437.5868062415308, -1179.0777070991646, -668.3456976408239, -1287.8779744799524, -828.8204844442364, -58.299389151781824, -969.6883969045278, -964.7526486198403, -22.728872797894294, -921.9826267368252, -1009.4283577493384, -371.7145774678932, -1471.7838209251952, -1140.8541262516253, -627.5566587715858, -864.575216508948, -405.1115504130005, -321.7874307116345, -952.4422927202002, -493.46067274207616, -274.6567994661955, -222.72136498564197, -698.7916341468831, -752.3313247309579, -1367.8011864548123, -198.7810314745853, -846.1204108633281, -1146.1999771865806, -1059.6735788739236, -970.0960352409746, -449.63103749769436, -1030.9930583544124, -786.6674371707019, -1102.3890996692633, -645.6769058554733, -171.53395763423168, -648.0593105982551, -761.721373726415, -892.683224989828, -563.5486191546902, -66.73815929818763, -251.14030866087555, -725.9638090344911, -982.3579715681979, -53.49668763457125, -766.7444993672814, -972.5158468067306, -329.0122148088517, -355.9938261180353, -985.5916977220314, -637.5893594227243, -505.7303911583073, -536.2256030999549, -686.3862452190455, -960.8347977328963, -1356.986139389686, -668.3354333514486, -1099.1541246668212, -555.6302103664341, -359.60701369857276, -63.052004448536046, -578.3247382258453, -855.8081449025485, -751.6609061131886, -605.8117890339488, -221.4432553711809, -1212.3553055041189, -726.7370896186442, -261.7020106499575, -198.6795654315335, -187.5861908622566, -52.68285852109632, -841.5686439380978, -830.226951980961, -463.46444300912185, -300.51591487637796, -304.9347260119426, -1045.384331754196, -126.89623773273514, -165.40415979526745, -527.2311915670182, -749.66836262602, -1308.0928003932727, -25.984890381279715, -1119.1221609810054], "episode_lengths": [150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 41, 150, 150, 104, 150, 150, 150, 150, 150, 150, 150, 121, 85, 86, 150, 150, 150, 115, 150, 150, 150, 150, 143, 150, 150, 150, 150, 76, 150, 150, 150, 150, 63, 75, 150, 150, 45, 150, 150, 93, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 138, 150, 150, 150, 117, 150, 150, 150, 87, 110, 47, 150, 150, 141, 124, 124, 150, 81, 89, 150, 150, 150, 52, 150], "policy_policy_0_reward": [-321.7440144990192, -986.7649581135073, -582.8324747497454, -66.08057285599772, -709.680289282355, -1013.3688252185113, -741.1367410593465, -1121.5267754915048, -1159.0887227736425, -390.2538774905247, -159.54164208891967, -1193.4909435425395, -676.2272847346386, -704.3697882210487, -720.9544572370777, -437.5868062415308, -1179.0777070991646, -668.3456976408239, -1287.8779744799524, -828.8204844442364, -58.299389151781824, -969.6883969045278, -964.7526486198403, -22.728872797894294, -921.9826267368252, -1009.4283577493384, -371.7145774678932, -1471.7838209251952, -1140.8541262516253, -627.5566587715858, -864.575216508948, -405.1115504130005, -321.7874307116345, -952.4422927202002, -493.46067274207616, -274.6567994661955, -222.72136498564197, -698.7916341468831, -752.3313247309579, -1367.8011864548123, -198.7810314745853, -846.1204108633281, -1146.1999771865806, -1059.6735788739236, -970.0960352409746, -449.63103749769436, -1030.9930583544124, -786.6674371707019, -1102.3890996692633, -645.6769058554733, -171.53395763423168, -648.0593105982551, -761.721373726415, -892.683224989828, -563.5486191546902, -66.73815929818763, -251.14030866087555, -725.9638090344911, -982.3579715681979, -53.49668763457125, -766.7444993672814, -972.5158468067306, -329.0122148088517, -355.9938261180353, -985.5916977220314, -637.5893594227243, -505.7303911583073, -536.2256030999549, -686.3862452190455, -960.8347977328963, -1356.986139389686, -668.3354333514486, -1099.1541246668212, -555.6302103664341, -359.60701369857276, -63.052004448536046, -578.3247382258453, -855.8081449025485, -751.6609061131886, -605.8117890339488, -221.4432553711809, -1212.3553055041189, -726.7370896186442, -261.7020106499575, -198.6795654315335, -187.5861908622566, -52.68285852109632, -841.5686439380978, -830.226951980961, -463.46444300912185, -300.51591487637796, -304.9347260119426, -1045.384331754196, -126.89623773273514, -165.40415979526745, -527.2311915670182, -749.66836262602, -1308.0928003932727, -25.984890381279715, -1119.1221609810054]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5700578762824858, "mean_inference_ms": 1.7514284753878542, "mean_action_processing_ms": 0.2901222469857264, "mean_env_wait_ms": 3.0912953501351534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012746095657348633, "StateBufferConnector_ms": 0.00826120376586914, "ViewRequirementAgentConnector_ms": 0.20203804969787598}, "num_episodes": 31, "episode_return_max": -22.728872797894294, "episode_return_min": -1471.7838209251952, "episode_return_mean": -665.153870566666, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.87302833403015, "num_env_steps_trained_throughput_per_sec": 282.87302833403015, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12854.282, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12854.197, "sample_time_ms": 1114.526, "learn_time_ms": 11672.234, "learn_throughput": 342.694, "synch_weights_time_ms": 66.483}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00017", "date": "2024-08-03_05-17-05", "timestamp": 1722642425, "time_this_iter_s": 14.15458083152771, "time_total_s": 265.07542157173157, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0ff40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 265.07542157173157, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.46, "ram_util_percent": 30.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 99.24987359642982, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.849491973718007, "policy_loss": -0.008365670156005459, "vf_loss": 4.852554508795341, "vf_explained_var": 0.9656264550363024, "kl": 0.014196311861481592, "entropy": 1.0852113937959076, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -25.984890381279715, "episode_reward_min": -1367.8011864548123, "episode_reward_mean": -620.2792450143957, "episode_len_mean": 131.86, "episode_media": {}, "episodes_timesteps_total": 13186, "policy_reward_min": {"policy_0": -1367.8011864548123}, "policy_reward_max": {"policy_0": -25.984890381279715}, "policy_reward_mean": {"policy_0": -620.2792450143957}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-321.7874307116345, -952.4422927202002, -493.46067274207616, -274.6567994661955, -222.72136498564197, -698.7916341468831, -752.3313247309579, -1367.8011864548123, -198.7810314745853, -846.1204108633281, -1146.1999771865806, -1059.6735788739236, -970.0960352409746, -449.63103749769436, -1030.9930583544124, -786.6674371707019, -1102.3890996692633, -645.6769058554733, -171.53395763423168, -648.0593105982551, -761.721373726415, -892.683224989828, -563.5486191546902, -66.73815929818763, -251.14030866087555, -725.9638090344911, -982.3579715681979, -53.49668763457125, -766.7444993672814, -972.5158468067306, -329.0122148088517, -355.9938261180353, -985.5916977220314, -637.5893594227243, -505.7303911583073, -536.2256030999549, -686.3862452190455, -960.8347977328963, -1356.986139389686, -668.3354333514486, -1099.1541246668212, -555.6302103664341, -359.60701369857276, -63.052004448536046, -578.3247382258453, -855.8081449025485, -751.6609061131886, -605.8117890339488, -221.4432553711809, -1212.3553055041189, -726.7370896186442, -261.7020106499575, -198.6795654315335, -187.5861908622566, -52.68285852109632, -841.5686439380978, -830.226951980961, -463.46444300912185, -300.51591487637796, -304.9347260119426, -1045.384331754196, -126.89623773273514, -165.40415979526745, -527.2311915670182, -749.66836262602, -1308.0928003932727, -25.984890381279715, -1119.1221609810054, -844.4194785526763, -504.6938708327235, -455.72075927333185, -883.9199731708567, -403.42406375343046, -492.1855738386468, -1174.5108292702207, -189.93440726622583, -258.8556415036553, -155.6999412285419, -1004.9087859222332, -792.9695608653625, -879.4087783425298, -168.11882854658674, -643.1374525798013, -1200.4849642434908, -785.7420922047617, -866.6458449729092, -792.3749848118513, -44.08990649796714, -181.27099512936056, -826.9902422117349, -406.06336113240087, -311.8174864903301, -853.9906821707622, -886.0148613216869, -555.1193150065984, -309.7033753077894, -156.82974313427553, -974.4601513942895, -339.82053748744704, -946.4572358710382], "episode_lengths": [150, 150, 121, 85, 86, 150, 150, 150, 115, 150, 150, 150, 150, 143, 150, 150, 150, 150, 76, 150, 150, 150, 150, 63, 75, 150, 150, 45, 150, 150, 93, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 138, 150, 150, 150, 117, 150, 150, 150, 87, 110, 47, 150, 150, 141, 124, 124, 150, 81, 89, 150, 150, 150, 52, 150, 150, 150, 124, 150, 150, 150, 150, 94, 82, 89, 150, 150, 150, 94, 150, 150, 150, 150, 150, 56, 125, 150, 150, 98, 150, 150, 150, 119, 93, 150, 143, 150], "policy_policy_0_reward": [-321.7874307116345, -952.4422927202002, -493.46067274207616, -274.6567994661955, -222.72136498564197, -698.7916341468831, -752.3313247309579, -1367.8011864548123, -198.7810314745853, -846.1204108633281, -1146.1999771865806, -1059.6735788739236, -970.0960352409746, -449.63103749769436, -1030.9930583544124, -786.6674371707019, -1102.3890996692633, -645.6769058554733, -171.53395763423168, -648.0593105982551, -761.721373726415, -892.683224989828, -563.5486191546902, -66.73815929818763, -251.14030866087555, -725.9638090344911, -982.3579715681979, -53.49668763457125, -766.7444993672814, -972.5158468067306, -329.0122148088517, -355.9938261180353, -985.5916977220314, -637.5893594227243, -505.7303911583073, -536.2256030999549, -686.3862452190455, -960.8347977328963, -1356.986139389686, -668.3354333514486, -1099.1541246668212, -555.6302103664341, -359.60701369857276, -63.052004448536046, -578.3247382258453, -855.8081449025485, -751.6609061131886, -605.8117890339488, -221.4432553711809, -1212.3553055041189, -726.7370896186442, -261.7020106499575, -198.6795654315335, -187.5861908622566, -52.68285852109632, -841.5686439380978, -830.226951980961, -463.46444300912185, -300.51591487637796, -304.9347260119426, -1045.384331754196, -126.89623773273514, -165.40415979526745, -527.2311915670182, -749.66836262602, -1308.0928003932727, -25.984890381279715, -1119.1221609810054, -844.4194785526763, -504.6938708327235, -455.72075927333185, -883.9199731708567, -403.42406375343046, -492.1855738386468, -1174.5108292702207, -189.93440726622583, -258.8556415036553, -155.6999412285419, -1004.9087859222332, -792.9695608653625, -879.4087783425298, -168.11882854658674, -643.1374525798013, -1200.4849642434908, -785.7420922047617, -866.6458449729092, -792.3749848118513, -44.08990649796714, -181.27099512936056, -826.9902422117349, -406.06336113240087, -311.8174864903301, -853.9906821707622, -886.0148613216869, -555.1193150065984, -309.7033753077894, -156.82974313427553, -974.4601513942895, -339.82053748744704, -946.4572358710382]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5708684681124623, "mean_inference_ms": 1.752984742396854, "mean_action_processing_ms": 0.2903368729559366, "mean_env_wait_ms": 3.0952867938421402, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012904167175292969, "StateBufferConnector_ms": 0.008318424224853516, "ViewRequirementAgentConnector_ms": 0.20427227020263672}, "num_episodes": 32, "episode_return_max": -25.984890381279715, "episode_return_min": -1367.8011864548123, "episode_return_mean": -620.2792450143957, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.5896884523044, "num_env_steps_trained_throughput_per_sec": 286.5896884523044, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12851.883, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12851.798, "sample_time_ms": 1117.397, "learn_time_ms": 11668.535, "learn_throughput": 342.802, "synch_weights_time_ms": 64.905}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00017", "date": "2024-08-03_05-17-19", "timestamp": 1722642439, "time_this_iter_s": 13.969412326812744, "time_total_s": 279.0448338985443, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1352acb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 279.0448338985443, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.27, "ram_util_percent": 30.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 127.11033319234848, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.613850545386473, "policy_loss": -0.014213408545280496, "vf_loss": 4.622831796606381, "vf_explained_var": 0.9595416560148199, "kl": 0.014409729415941304, "entropy": 1.2522190939635038, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -25.984890381279715, "episode_reward_min": -1356.986139389686, "episode_reward_mean": -619.6604427096493, "episode_len_mean": 133.31, "episode_media": {}, "episodes_timesteps_total": 13331, "policy_reward_min": {"policy_0": -1356.986139389686}, "policy_reward_max": {"policy_0": -25.984890381279715}, "policy_reward_mean": {"policy_0": -619.6604427096493}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-982.3579715681979, -53.49668763457125, -766.7444993672814, -972.5158468067306, -329.0122148088517, -355.9938261180353, -985.5916977220314, -637.5893594227243, -505.7303911583073, -536.2256030999549, -686.3862452190455, -960.8347977328963, -1356.986139389686, -668.3354333514486, -1099.1541246668212, -555.6302103664341, -359.60701369857276, -63.052004448536046, -578.3247382258453, -855.8081449025485, -751.6609061131886, -605.8117890339488, -221.4432553711809, -1212.3553055041189, -726.7370896186442, -261.7020106499575, -198.6795654315335, -187.5861908622566, -52.68285852109632, -841.5686439380978, -830.226951980961, -463.46444300912185, -300.51591487637796, -304.9347260119426, -1045.384331754196, -126.89623773273514, -165.40415979526745, -527.2311915670182, -749.66836262602, -1308.0928003932727, -25.984890381279715, -1119.1221609810054, -844.4194785526763, -504.6938708327235, -455.72075927333185, -883.9199731708567, -403.42406375343046, -492.1855738386468, -1174.5108292702207, -189.93440726622583, -258.8556415036553, -155.6999412285419, -1004.9087859222332, -792.9695608653625, -879.4087783425298, -168.11882854658674, -643.1374525798013, -1200.4849642434908, -785.7420922047617, -866.6458449729092, -792.3749848118513, -44.08990649796714, -181.27099512936056, -826.9902422117349, -406.06336113240087, -311.8174864903301, -853.9906821707622, -886.0148613216869, -555.1193150065984, -309.7033753077894, -156.82974313427553, -974.4601513942895, -339.82053748744704, -946.4572358710382, -757.6387552341248, -438.5353347702253, -751.6480446240046, -33.934864239176626, -166.52867211052555, -1346.353721221339, -926.1298542431065, -885.9783372117578, -767.6820904523951, -624.8345121443103, -908.7793645962084, -375.7111537189315, -426.09328875941054, -379.9458648193806, -1134.680515565653, -228.56861974864253, -1124.8451514307055, -804.2481008263162, -509.2698436655749, -1263.6276765937077, -433.31561420090765, -431.3738207601676, -444.8036745329233, -984.9754484332777, -438.6312696532784, -751.596217211611], "episode_lengths": [150, 45, 150, 150, 93, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 138, 150, 150, 150, 117, 150, 150, 150, 87, 110, 47, 150, 150, 141, 124, 124, 150, 81, 89, 150, 150, 150, 52, 150, 150, 150, 124, 150, 150, 150, 150, 94, 82, 89, 150, 150, 150, 94, 150, 150, 150, 150, 150, 56, 125, 150, 150, 98, 150, 150, 150, 119, 93, 150, 143, 150, 150, 150, 150, 60, 106, 150, 150, 150, 150, 150, 150, 109, 143, 123, 150, 82, 150, 150, 139, 150, 150, 147, 150, 150, 150, 150], "policy_policy_0_reward": [-982.3579715681979, -53.49668763457125, -766.7444993672814, -972.5158468067306, -329.0122148088517, -355.9938261180353, -985.5916977220314, -637.5893594227243, -505.7303911583073, -536.2256030999549, -686.3862452190455, -960.8347977328963, -1356.986139389686, -668.3354333514486, -1099.1541246668212, -555.6302103664341, -359.60701369857276, -63.052004448536046, -578.3247382258453, -855.8081449025485, -751.6609061131886, -605.8117890339488, -221.4432553711809, -1212.3553055041189, -726.7370896186442, -261.7020106499575, -198.6795654315335, -187.5861908622566, -52.68285852109632, -841.5686439380978, -830.226951980961, -463.46444300912185, -300.51591487637796, -304.9347260119426, -1045.384331754196, -126.89623773273514, -165.40415979526745, -527.2311915670182, -749.66836262602, -1308.0928003932727, -25.984890381279715, -1119.1221609810054, -844.4194785526763, -504.6938708327235, -455.72075927333185, -883.9199731708567, -403.42406375343046, -492.1855738386468, -1174.5108292702207, -189.93440726622583, -258.8556415036553, -155.6999412285419, -1004.9087859222332, -792.9695608653625, -879.4087783425298, -168.11882854658674, -643.1374525798013, -1200.4849642434908, -785.7420922047617, -866.6458449729092, -792.3749848118513, -44.08990649796714, -181.27099512936056, -826.9902422117349, -406.06336113240087, -311.8174864903301, -853.9906821707622, -886.0148613216869, -555.1193150065984, -309.7033753077894, -156.82974313427553, -974.4601513942895, -339.82053748744704, -946.4572358710382, -757.6387552341248, -438.5353347702253, -751.6480446240046, -33.934864239176626, -166.52867211052555, -1346.353721221339, -926.1298542431065, -885.9783372117578, -767.6820904523951, -624.8345121443103, -908.7793645962084, -375.7111537189315, -426.09328875941054, -379.9458648193806, -1134.680515565653, -228.56861974864253, -1124.8451514307055, -804.2481008263162, -509.2698436655749, -1263.6276765937077, -433.31561420090765, -431.3738207601676, -444.8036745329233, -984.9754484332777, -438.6312696532784, -751.596217211611]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5707173713284728, "mean_inference_ms": 1.7541917352133312, "mean_action_processing_ms": 0.2904628676787986, "mean_env_wait_ms": 3.097270534547191, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01289987564086914, "StateBufferConnector_ms": 0.009589672088623047, "ViewRequirementAgentConnector_ms": 0.20078730583190918}, "num_episodes": 26, "episode_return_max": -25.984890381279715, "episode_return_min": -1356.986139389686, "episode_return_mean": -619.6604427096493, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.59610450701376, "num_env_steps_trained_throughput_per_sec": 281.59610450701376, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12895.271, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12895.185, "sample_time_ms": 1121.224, "learn_time_ms": 11709.113, "learn_throughput": 341.614, "synch_weights_time_ms": 63.898}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00017", "date": "2024-08-03_05-17-33", "timestamp": 1722642453, "time_this_iter_s": 14.216568231582642, "time_total_s": 293.26140213012695, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8c430>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 293.26140213012695, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.590000000000007, "ram_util_percent": 30.884999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 101.33778472145399, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.095905169596275, "policy_loss": -0.003926056113171702, "vf_loss": 5.0948012513419, "vf_explained_var": 0.9527883998428782, "kl": 0.014497097548337478, "entropy": 1.4937110636383295, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -25.984890381279715, "episode_reward_min": -1346.353721221339, "episode_reward_mean": -665.0009412378548, "episode_len_mean": 135.66, "episode_media": {}, "episodes_timesteps_total": 13566, "policy_reward_min": {"policy_0": -1346.353721221339}, "policy_reward_max": {"policy_0": -25.984890381279715}, "policy_reward_mean": {"policy_0": -665.0009412378548}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-830.226951980961, -463.46444300912185, -300.51591487637796, -304.9347260119426, -1045.384331754196, -126.89623773273514, -165.40415979526745, -527.2311915670182, -749.66836262602, -1308.0928003932727, -25.984890381279715, -1119.1221609810054, -844.4194785526763, -504.6938708327235, -455.72075927333185, -883.9199731708567, -403.42406375343046, -492.1855738386468, -1174.5108292702207, -189.93440726622583, -258.8556415036553, -155.6999412285419, -1004.9087859222332, -792.9695608653625, -879.4087783425298, -168.11882854658674, -643.1374525798013, -1200.4849642434908, -785.7420922047617, -866.6458449729092, -792.3749848118513, -44.08990649796714, -181.27099512936056, -826.9902422117349, -406.06336113240087, -311.8174864903301, -853.9906821707622, -886.0148613216869, -555.1193150065984, -309.7033753077894, -156.82974313427553, -974.4601513942895, -339.82053748744704, -946.4572358710382, -757.6387552341248, -438.5353347702253, -751.6480446240046, -33.934864239176626, -166.52867211052555, -1346.353721221339, -926.1298542431065, -885.9783372117578, -767.6820904523951, -624.8345121443103, -908.7793645962084, -375.7111537189315, -426.09328875941054, -379.9458648193806, -1134.680515565653, -228.56861974864253, -1124.8451514307055, -804.2481008263162, -509.2698436655749, -1263.6276765937077, -433.31561420090765, -431.3738207601676, -444.8036745329233, -984.9754484332777, -438.6312696532784, -751.596217211611, -84.53799318052151, -1014.6406907889658, -342.797549244046, -896.6437643658375, -303.4399913586833, -568.810273159996, -895.2633193563393, -28.649385163220444, -1096.8740882474915, -557.2953863441634, -835.425192671411, -784.555741797208, -1038.8627402212664, -370.46247000625857, -480.7023781179428, -472.3324034793776, -484.0175315589191, -567.4149267840994, -1113.1826874959522, -765.4950271392686, -936.0527665169316, -633.5181383227749, -1204.012116341378, -605.6889701903282, -1124.8450694567434, -1216.5895986492526, -867.1519187110355, -1036.5439327385413, -1232.9903329717201, -1344.8580331934318], "episode_lengths": [150, 141, 124, 124, 150, 81, 89, 150, 150, 150, 52, 150, 150, 150, 124, 150, 150, 150, 150, 94, 82, 89, 150, 150, 150, 94, 150, 150, 150, 150, 150, 56, 125, 150, 150, 98, 150, 150, 150, 119, 93, 150, 143, 150, 150, 150, 150, 60, 106, 150, 150, 150, 150, 150, 150, 109, 143, 123, 150, 82, 150, 150, 139, 150, 150, 147, 150, 150, 150, 150, 78, 150, 110, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 106, 120, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-830.226951980961, -463.46444300912185, -300.51591487637796, -304.9347260119426, -1045.384331754196, -126.89623773273514, -165.40415979526745, -527.2311915670182, -749.66836262602, -1308.0928003932727, -25.984890381279715, -1119.1221609810054, -844.4194785526763, -504.6938708327235, -455.72075927333185, -883.9199731708567, -403.42406375343046, -492.1855738386468, -1174.5108292702207, -189.93440726622583, -258.8556415036553, -155.6999412285419, -1004.9087859222332, -792.9695608653625, -879.4087783425298, -168.11882854658674, -643.1374525798013, -1200.4849642434908, -785.7420922047617, -866.6458449729092, -792.3749848118513, -44.08990649796714, -181.27099512936056, -826.9902422117349, -406.06336113240087, -311.8174864903301, -853.9906821707622, -886.0148613216869, -555.1193150065984, -309.7033753077894, -156.82974313427553, -974.4601513942895, -339.82053748744704, -946.4572358710382, -757.6387552341248, -438.5353347702253, -751.6480446240046, -33.934864239176626, -166.52867211052555, -1346.353721221339, -926.1298542431065, -885.9783372117578, -767.6820904523951, -624.8345121443103, -908.7793645962084, -375.7111537189315, -426.09328875941054, -379.9458648193806, -1134.680515565653, -228.56861974864253, -1124.8451514307055, -804.2481008263162, -509.2698436655749, -1263.6276765937077, -433.31561420090765, -431.3738207601676, -444.8036745329233, -984.9754484332777, -438.6312696532784, -751.596217211611, -84.53799318052151, -1014.6406907889658, -342.797549244046, -896.6437643658375, -303.4399913586833, -568.810273159996, -895.2633193563393, -28.649385163220444, -1096.8740882474915, -557.2953863441634, -835.425192671411, -784.555741797208, -1038.8627402212664, -370.46247000625857, -480.7023781179428, -472.3324034793776, -484.0175315589191, -567.4149267840994, -1113.1826874959522, -765.4950271392686, -936.0527665169316, -633.5181383227749, -1204.012116341378, -605.6889701903282, -1124.8450694567434, -1216.5895986492526, -867.1519187110355, -1036.5439327385413, -1232.9903329717201, -1344.8580331934318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5705070534559006, "mean_inference_ms": 1.7538419186709415, "mean_action_processing_ms": 0.2902590553255449, "mean_env_wait_ms": 3.098215074862046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013262510299682617, "StateBufferConnector_ms": 0.009516477584838867, "ViewRequirementAgentConnector_ms": 0.19945120811462402}, "num_episodes": 30, "episode_return_max": -25.984890381279715, "episode_return_min": -1346.353721221339, "episode_return_mean": -665.0009412378548, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.256594258271, "num_env_steps_trained_throughput_per_sec": 292.256594258271, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12821.992, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12821.908, "sample_time_ms": 1121.738, "learn_time_ms": 11636.015, "learn_throughput": 343.76, "synch_weights_time_ms": 63.204}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00017", "date": "2024-08-03_05-17-47", "timestamp": 1722642467, "time_this_iter_s": 13.700565338134766, "time_total_s": 306.9619674682617, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0ff40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 306.9619674682617, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.857894736842102, "ram_util_percent": 30.889473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 128.388427066803, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.471759082128604, "policy_loss": -0.00849731721925006, "vf_loss": 4.475809973229965, "vf_explained_var": 0.9757736995195349, "kl": 0.01323536339392985, "entropy": 1.5094889591137568, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -14.412885522013639, "episode_reward_min": -1346.353721221339, "episode_reward_mean": -659.9361117341564, "episode_len_mean": 133.25, "episode_media": {}, "episodes_timesteps_total": 13325, "policy_reward_min": {"policy_0": -1346.353721221339}, "policy_reward_max": {"policy_0": -14.412885522013639}, "policy_reward_mean": {"policy_0": -659.9361117341564}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-181.27099512936056, -826.9902422117349, -406.06336113240087, -311.8174864903301, -853.9906821707622, -886.0148613216869, -555.1193150065984, -309.7033753077894, -156.82974313427553, -974.4601513942895, -339.82053748744704, -946.4572358710382, -757.6387552341248, -438.5353347702253, -751.6480446240046, -33.934864239176626, -166.52867211052555, -1346.353721221339, -926.1298542431065, -885.9783372117578, -767.6820904523951, -624.8345121443103, -908.7793645962084, -375.7111537189315, -426.09328875941054, -379.9458648193806, -1134.680515565653, -228.56861974864253, -1124.8451514307055, -804.2481008263162, -509.2698436655749, -1263.6276765937077, -433.31561420090765, -431.3738207601676, -444.8036745329233, -984.9754484332777, -438.6312696532784, -751.596217211611, -84.53799318052151, -1014.6406907889658, -342.797549244046, -896.6437643658375, -303.4399913586833, -568.810273159996, -895.2633193563393, -28.649385163220444, -1096.8740882474915, -557.2953863441634, -835.425192671411, -784.555741797208, -1038.8627402212664, -370.46247000625857, -480.7023781179428, -472.3324034793776, -484.0175315589191, -567.4149267840994, -1113.1826874959522, -765.4950271392686, -936.0527665169316, -633.5181383227749, -1204.012116341378, -605.6889701903282, -1124.8450694567434, -1216.5895986492526, -867.1519187110355, -1036.5439327385413, -1232.9903329717201, -1344.8580331934318, -1207.0935280331216, -949.5609411900838, -887.5547040246244, -782.7612026678889, -611.4763783052539, -966.0707747794025, -237.8475673884305, -951.6157395790622, -942.3923172717793, -1065.1924852767188, -669.7459438118319, -104.38868259069389, -764.7746184056485, -667.3000071329458, -547.6876079506579, -1179.298333401384, -1007.7186269349771, -262.7319847720396, -113.0958894703569, -428.5807844404229, -695.9423080354098, -113.50346497411032, -44.48057645706001, -479.78165422053394, -199.09243528111446, -512.7614053718038, -899.5627536636475, -268.620344346835, -14.412885522013639, -59.44553876052732, -1115.6333660872958, -251.5641082694856], "episode_lengths": [125, 150, 150, 98, 150, 150, 150, 119, 93, 150, 143, 150, 150, 150, 150, 60, 106, 150, 150, 150, 150, 150, 150, 109, 143, 123, 150, 82, 150, 150, 139, 150, 150, 147, 150, 150, 150, 150, 78, 150, 110, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 106, 120, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 133, 150, 75, 150, 150, 150, 150, 71, 150, 150, 146, 150, 150, 92, 59, 150, 150, 58, 52, 118, 100, 150, 150, 106, 47, 45, 150, 107], "policy_policy_0_reward": [-181.27099512936056, -826.9902422117349, -406.06336113240087, -311.8174864903301, -853.9906821707622, -886.0148613216869, -555.1193150065984, -309.7033753077894, -156.82974313427553, -974.4601513942895, -339.82053748744704, -946.4572358710382, -757.6387552341248, -438.5353347702253, -751.6480446240046, -33.934864239176626, -166.52867211052555, -1346.353721221339, -926.1298542431065, -885.9783372117578, -767.6820904523951, -624.8345121443103, -908.7793645962084, -375.7111537189315, -426.09328875941054, -379.9458648193806, -1134.680515565653, -228.56861974864253, -1124.8451514307055, -804.2481008263162, -509.2698436655749, -1263.6276765937077, -433.31561420090765, -431.3738207601676, -444.8036745329233, -984.9754484332777, -438.6312696532784, -751.596217211611, -84.53799318052151, -1014.6406907889658, -342.797549244046, -896.6437643658375, -303.4399913586833, -568.810273159996, -895.2633193563393, -28.649385163220444, -1096.8740882474915, -557.2953863441634, -835.425192671411, -784.555741797208, -1038.8627402212664, -370.46247000625857, -480.7023781179428, -472.3324034793776, -484.0175315589191, -567.4149267840994, -1113.1826874959522, -765.4950271392686, -936.0527665169316, -633.5181383227749, -1204.012116341378, -605.6889701903282, -1124.8450694567434, -1216.5895986492526, -867.1519187110355, -1036.5439327385413, -1232.9903329717201, -1344.8580331934318, -1207.0935280331216, -949.5609411900838, -887.5547040246244, -782.7612026678889, -611.4763783052539, -966.0707747794025, -237.8475673884305, -951.6157395790622, -942.3923172717793, -1065.1924852767188, -669.7459438118319, -104.38868259069389, -764.7746184056485, -667.3000071329458, -547.6876079506579, -1179.298333401384, -1007.7186269349771, -262.7319847720396, -113.0958894703569, -428.5807844404229, -695.9423080354098, -113.50346497411032, -44.48057645706001, -479.78165422053394, -199.09243528111446, -512.7614053718038, -899.5627536636475, -268.620344346835, -14.412885522013639, -59.44553876052732, -1115.6333660872958, -251.5641082694856]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.570715220321604, "mean_inference_ms": 1.7541616222263448, "mean_action_processing_ms": 0.2900632177756505, "mean_env_wait_ms": 3.1003797534916027, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013214349746704102, "StateBufferConnector_ms": 0.009491443634033203, "ViewRequirementAgentConnector_ms": 0.19900035858154297}, "num_episodes": 32, "episode_return_max": -14.412885522013639, "episode_return_min": -1346.353721221339, "episode_return_mean": -659.9361117341564, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.15505247632484, "num_env_steps_trained_throughput_per_sec": 278.15505247632484, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12887.605, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12887.52, "sample_time_ms": 1120.981, "learn_time_ms": 11701.193, "learn_throughput": 341.845, "synch_weights_time_ms": 64.456}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00017", "date": "2024-08-03_05-18-01", "timestamp": 1722642481, "time_this_iter_s": 14.392953395843506, "time_total_s": 321.3549208641052, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8df30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.3549208641052, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.514285714285712, "ram_util_percent": 30.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 132.5669214506944, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.3134617857635025, "policy_loss": -0.0072149926423056366, "vf_loss": 4.313633918265501, "vf_explained_var": 0.9775110791747769, "kl": 0.019199352062923964, "entropy": 1.5968583145489295, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -12.26755862903805, "episode_reward_min": -1344.8580331934318, "episode_reward_mean": -708.345760805791, "episode_len_mean": 132.31, "episode_media": {}, "episodes_timesteps_total": 13231, "policy_reward_min": {"policy_0": -1344.8580331934318}, "policy_reward_max": {"policy_0": -12.26755862903805}, "policy_reward_mean": {"policy_0": -708.345760805791}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-984.9754484332777, -438.6312696532784, -751.596217211611, -84.53799318052151, -1014.6406907889658, -342.797549244046, -896.6437643658375, -303.4399913586833, -568.810273159996, -895.2633193563393, -28.649385163220444, -1096.8740882474915, -557.2953863441634, -835.425192671411, -784.555741797208, -1038.8627402212664, -370.46247000625857, -480.7023781179428, -472.3324034793776, -484.0175315589191, -567.4149267840994, -1113.1826874959522, -765.4950271392686, -936.0527665169316, -633.5181383227749, -1204.012116341378, -605.6889701903282, -1124.8450694567434, -1216.5895986492526, -867.1519187110355, -1036.5439327385413, -1232.9903329717201, -1344.8580331934318, -1207.0935280331216, -949.5609411900838, -887.5547040246244, -782.7612026678889, -611.4763783052539, -966.0707747794025, -237.8475673884305, -951.6157395790622, -942.3923172717793, -1065.1924852767188, -669.7459438118319, -104.38868259069389, -764.7746184056485, -667.3000071329458, -547.6876079506579, -1179.298333401384, -1007.7186269349771, -262.7319847720396, -113.0958894703569, -428.5807844404229, -695.9423080354098, -113.50346497411032, -44.48057645706001, -479.78165422053394, -199.09243528111446, -512.7614053718038, -899.5627536636475, -268.620344346835, -14.412885522013639, -59.44553876052732, -1115.6333660872958, -251.5641082694856, -1007.7111802942145, -1191.265591788651, -1323.2015192255158, -1161.6603768530654, -848.0458871318801, -720.0347155406508, -887.6844336396716, -75.83502066196439, -1260.2589978327087, -12.26755862903805, -989.6020492762395, -558.1888540148417, -943.9194090176892, -72.28563693509216, -1245.8502664461057, -903.7937286055634, -799.1783815599849, -41.52065793481619, -958.8968477723677, -730.8251761220016, -278.1041559013017, -473.0351901810993, -1021.4633311924479, -1056.722400593982, -1018.6422150540114, -898.6372348246275, -412.2766408038204, -741.3982847339539, -69.67718744693306, -1081.781879963399, -44.343744475317045, -1151.1644513994336, -743.4523413369891, -1007.1688295506274, -1024.1355925506523], "episode_lengths": [150, 150, 150, 78, 150, 110, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 106, 120, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 133, 150, 75, 150, 150, 150, 150, 71, 150, 150, 146, 150, 150, 92, 59, 150, 150, 58, 52, 118, 100, 150, 150, 106, 47, 45, 150, 107, 150, 150, 150, 150, 150, 150, 150, 69, 150, 43, 150, 150, 150, 64, 150, 150, 150, 61, 150, 150, 130, 150, 150, 150, 150, 150, 128, 150, 78, 150, 70, 150, 150, 150, 150], "policy_policy_0_reward": [-984.9754484332777, -438.6312696532784, -751.596217211611, -84.53799318052151, -1014.6406907889658, -342.797549244046, -896.6437643658375, -303.4399913586833, -568.810273159996, -895.2633193563393, -28.649385163220444, -1096.8740882474915, -557.2953863441634, -835.425192671411, -784.555741797208, -1038.8627402212664, -370.46247000625857, -480.7023781179428, -472.3324034793776, -484.0175315589191, -567.4149267840994, -1113.1826874959522, -765.4950271392686, -936.0527665169316, -633.5181383227749, -1204.012116341378, -605.6889701903282, -1124.8450694567434, -1216.5895986492526, -867.1519187110355, -1036.5439327385413, -1232.9903329717201, -1344.8580331934318, -1207.0935280331216, -949.5609411900838, -887.5547040246244, -782.7612026678889, -611.4763783052539, -966.0707747794025, -237.8475673884305, -951.6157395790622, -942.3923172717793, -1065.1924852767188, -669.7459438118319, -104.38868259069389, -764.7746184056485, -667.3000071329458, -547.6876079506579, -1179.298333401384, -1007.7186269349771, -262.7319847720396, -113.0958894703569, -428.5807844404229, -695.9423080354098, -113.50346497411032, -44.48057645706001, -479.78165422053394, -199.09243528111446, -512.7614053718038, -899.5627536636475, -268.620344346835, -14.412885522013639, -59.44553876052732, -1115.6333660872958, -251.5641082694856, -1007.7111802942145, -1191.265591788651, -1323.2015192255158, -1161.6603768530654, -848.0458871318801, -720.0347155406508, -887.6844336396716, -75.83502066196439, -1260.2589978327087, -12.26755862903805, -989.6020492762395, -558.1888540148417, -943.9194090176892, -72.28563693509216, -1245.8502664461057, -903.7937286055634, -799.1783815599849, -41.52065793481619, -958.8968477723677, -730.8251761220016, -278.1041559013017, -473.0351901810993, -1021.4633311924479, -1056.722400593982, -1018.6422150540114, -898.6372348246275, -412.2766408038204, -741.3982847339539, -69.67718744693306, -1081.781879963399, -44.343744475317045, -1151.1644513994336, -743.4523413369891, -1007.1688295506274, -1024.1355925506523]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5709328389202227, "mean_inference_ms": 1.7547538754202523, "mean_action_processing_ms": 0.28979171626809225, "mean_env_wait_ms": 3.1035651892414036, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013362884521484375, "StateBufferConnector_ms": 0.008175373077392578, "ViewRequirementAgentConnector_ms": 0.20304489135742188}, "num_episodes": 35, "episode_return_max": -12.26755862903805, "episode_return_min": -1344.8580331934318, "episode_return_mean": -708.345760805791, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.78383530912265, "num_env_steps_trained_throughput_per_sec": 286.78383530912265, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 13491.105, "restore_workers_time_ms": 0.037, "training_step_time_ms": 13491.019, "sample_time_ms": 1120.959, "learn_time_ms": 12301.994, "learn_throughput": 325.151, "synch_weights_time_ms": 67.101}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00017", "date": "2024-08-03_05-18-15", "timestamp": 1722642495, "time_this_iter_s": 13.960354089736938, "time_total_s": 335.31527495384216, "pid": 486900, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8ec20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 335.31527495384216, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.765, "ram_util_percent": 30.899999999999995}}
