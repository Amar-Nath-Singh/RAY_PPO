{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.028875056343774, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.592024506131809, "policy_loss": -0.003625357898999937, "vf_loss": 9.594379260142643, "vf_explained_var": 0.04541794521113237, "kl": 0.0064238944123568825, "entropy": 1.4200048050532739, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -17.463378522334786, "episode_reward_min": -1127.0253763327837, "episode_reward_mean": -644.2036011007973, "episode_len_mean": 137.66666666666666, "episode_media": {}, "episodes_timesteps_total": 3717, "policy_reward_min": {"policy_0": -1127.0253763327837}, "policy_reward_max": {"policy_0": -17.463378522334786}, "policy_reward_mean": {"policy_0": -644.2036011007973}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-460.4200441118245, -207.54370834879342, -902.4278842127317, -920.8063710300514, -755.5411773582532, -914.4451256160108, -684.7260370177598, -30.818072928959065, -797.1905328086382, -874.6631479105067, -78.10325262186132, -700.7464602784842, -816.6345963520507, -602.7200773962093, -739.1799005823541, -428.07874534536046, -829.786802317674, -614.5386141022705, -1127.0253763327837, -17.463378522334786, -588.2412805372752, -171.22707504131907, -821.663854060191, -1106.9934305078646, -480.4285157989416, -898.724214008218, -823.3595545728108], "episode_lengths": [145, 101, 150, 150, 150, 150, 150, 55, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-460.4200441118245, -207.54370834879342, -902.4278842127317, -920.8063710300514, -755.5411773582532, -914.4451256160108, -684.7260370177598, -30.818072928959065, -797.1905328086382, -874.6631479105067, -78.10325262186132, -700.7464602784842, -816.6345963520507, -602.7200773962093, -739.1799005823541, -428.07874534536046, -829.786802317674, -614.5386141022705, -1127.0253763327837, -17.463378522334786, -588.2412805372752, -171.22707504131907, -821.663854060191, -1106.9934305078646, -480.4285157989416, -898.724214008218, -823.3595545728108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2756482349793854, "mean_inference_ms": 0.8530918159613626, "mean_action_processing_ms": 0.1568534412049782, "mean_env_wait_ms": 1.5028098609921852, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006623621340151186, "StateBufferConnector_ms": 0.004205880341706453, "ViewRequirementAgentConnector_ms": 0.09313424428304036}, "num_episodes": 27, "episode_return_max": -17.463378522334786, "episode_return_min": -1127.0253763327837, "episode_return_mean": -644.2036011007973, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.3630052355909, "num_env_steps_trained_throughput_per_sec": 267.3630052355909, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 14960.945, "restore_workers_time_ms": 0.022, "training_step_time_ms": 14960.881, "sample_time_ms": 2297.308, "learn_time_ms": 12647.573, "learn_throughput": 316.266, "synch_weights_time_ms": 15.181}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00006", "date": "2024-08-03_05-18-44", "timestamp": 1722642524, "time_this_iter_s": 14.966523170471191, "time_total_s": 14.966523170471191, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8ce50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14.966523170471191, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.354545454545455, "ram_util_percent": 19.10000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5224409304869673, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.57243387401104, "policy_loss": -0.007492834433408765, "vf_loss": 9.577701904376347, "vf_explained_var": 0.09553079487135013, "kl": 0.01119736820238965, "entropy": 1.4692725469668706, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -17.463378522334786, "episode_reward_min": -1203.3105663179215, "episode_reward_mean": -651.4150504984848, "episode_len_mean": 136.30357142857142, "episode_media": {}, "episodes_timesteps_total": 7633, "policy_reward_min": {"policy_0": -1203.3105663179215}, "policy_reward_max": {"policy_0": -17.463378522334786}, "policy_reward_mean": {"policy_0": -651.4150504984848}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-460.4200441118245, -207.54370834879342, -902.4278842127317, -920.8063710300514, -755.5411773582532, -914.4451256160108, -684.7260370177598, -30.818072928959065, -797.1905328086382, -874.6631479105067, -78.10325262186132, -700.7464602784842, -816.6345963520507, -602.7200773962093, -739.1799005823541, -428.07874534536046, -829.786802317674, -614.5386141022705, -1127.0253763327837, -17.463378522334786, -588.2412805372752, -171.22707504131907, -821.663854060191, -1106.9934305078646, -480.4285157989416, -898.724214008218, -823.3595545728108, -945.7111467477009, -209.25225810628385, -779.7816499321324, -836.461508076983, -539.1484399515581, -800.0373811064711, -214.72339361873924, -1203.3105663179215, -709.229672121585, -1045.451900672916, -753.5098041739941, -570.8005692828705, -775.527634675589, -275.9464292851927, -567.717945834301, -49.863041164405544, -507.8238118187696, -527.3771866932232, -282.1176308849785, -1119.0014515005032, -1067.7748969170948, -322.2443176913389, -1027.064391339988, -822.5338686436593, -466.6296354575062, -97.17480958587026, -940.1790301229531, -675.2439541216891, -954.1072723474002], "episode_lengths": [145, 101, 150, 150, 150, 150, 150, 55, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 99, 150, 150, 150, 150, 121, 150, 85, 150, 61, 150, 150, 103, 150, 150, 121, 150, 150, 150, 75, 150, 150, 150], "policy_policy_0_reward": [-460.4200441118245, -207.54370834879342, -902.4278842127317, -920.8063710300514, -755.5411773582532, -914.4451256160108, -684.7260370177598, -30.818072928959065, -797.1905328086382, -874.6631479105067, -78.10325262186132, -700.7464602784842, -816.6345963520507, -602.7200773962093, -739.1799005823541, -428.07874534536046, -829.786802317674, -614.5386141022705, -1127.0253763327837, -17.463378522334786, -588.2412805372752, -171.22707504131907, -821.663854060191, -1106.9934305078646, -480.4285157989416, -898.724214008218, -823.3595545728108, -945.7111467477009, -209.25225810628385, -779.7816499321324, -836.461508076983, -539.1484399515581, -800.0373811064711, -214.72339361873924, -1203.3105663179215, -709.229672121585, -1045.451900672916, -753.5098041739941, -570.8005692828705, -775.527634675589, -275.9464292851927, -567.717945834301, -49.863041164405544, -507.8238118187696, -527.3771866932232, -282.1176308849785, -1119.0014515005032, -1067.7748969170948, -322.2443176913389, -1027.064391339988, -822.5338686436593, -466.6296354575062, -97.17480958587026, -940.1790301229531, -675.2439541216891, -954.1072723474002]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27521121180324165, "mean_inference_ms": 0.8577117014783475, "mean_action_processing_ms": 0.15721591696942733, "mean_env_wait_ms": 1.50996494870245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0064100537981305805, "StateBufferConnector_ms": 0.0040727002280099055, "ViewRequirementAgentConnector_ms": 0.09377896785736084}, "num_episodes": 29, "episode_return_max": -17.463378522334786, "episode_return_min": -1203.3105663179215, "episode_return_mean": -651.4150504984848, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.2714339396375, "num_env_steps_trained_throughput_per_sec": 269.2714339396375, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 14907.932, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14907.855, "sample_time_ms": 2309.214, "learn_time_ms": 12582.7, "learn_throughput": 317.897, "synch_weights_time_ms": 15.115}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00006", "date": "2024-08-03_05-18-59", "timestamp": 1722642539, "time_this_iter_s": 14.861244678497314, "time_total_s": 29.827767848968506, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8f010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29.827767848968506, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 12.885714285714286, "ram_util_percent": 19.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.747456304760029, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.464290490746498, "policy_loss": -0.0074010908783141835, "vf_loss": 9.469169587890308, "vf_explained_var": 0.0733634906510512, "kl": 0.012683596761841425, "entropy": 1.4728253055363894, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -17.463378522334786, "episode_reward_min": -1203.3105663179215, "episode_reward_mean": -659.7945153500814, "episode_len_mean": 134.16091954022988, "episode_media": {}, "episodes_timesteps_total": 11672, "policy_reward_min": {"policy_0": -1203.3105663179215}, "policy_reward_max": {"policy_0": -17.463378522334786}, "policy_reward_mean": {"policy_0": -659.7945153500814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-460.4200441118245, -207.54370834879342, -902.4278842127317, -920.8063710300514, -755.5411773582532, -914.4451256160108, -684.7260370177598, -30.818072928959065, -797.1905328086382, -874.6631479105067, -78.10325262186132, -700.7464602784842, -816.6345963520507, -602.7200773962093, -739.1799005823541, -428.07874534536046, -829.786802317674, -614.5386141022705, -1127.0253763327837, -17.463378522334786, -588.2412805372752, -171.22707504131907, -821.663854060191, -1106.9934305078646, -480.4285157989416, -898.724214008218, -823.3595545728108, -945.7111467477009, -209.25225810628385, -779.7816499321324, -836.461508076983, -539.1484399515581, -800.0373811064711, -214.72339361873924, -1203.3105663179215, -709.229672121585, -1045.451900672916, -753.5098041739941, -570.8005692828705, -775.527634675589, -275.9464292851927, -567.717945834301, -49.863041164405544, -507.8238118187696, -527.3771866932232, -282.1176308849785, -1119.0014515005032, -1067.7748969170948, -322.2443176913389, -1027.064391339988, -822.5338686436593, -466.6296354575062, -97.17480958587026, -940.1790301229531, -675.2439541216891, -954.1072723474002, -940.1023734484535, -483.36898532166697, -951.7340383842653, -562.6126141122026, -414.87026255529594, -523.1054568302663, -459.29833681144396, -134.56687472670833, -554.9566868567229, -1060.5452406401466, -1091.2520042414676, -607.4110702285132, -1167.6922366879146, -679.1140179981485, -161.48967721006127, -1043.5363476508571, -1135.1134500103155, -789.7519518308169, -769.0420135800302, -957.2394035686996, -798.1289188042039, -1019.0336621862895, -829.635234273967, -76.3147697210278, -851.7583853094418, -388.7686966220833, -163.7509717854387, -147.89070345115528, -997.640344451948, -200.00697209149237, -963.1483061508898], "episode_lengths": [145, 101, 150, 150, 150, 150, 150, 55, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 99, 150, 150, 150, 150, 121, 150, 85, 150, 61, 150, 150, 103, 150, 150, 121, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 128, 103, 150, 150, 72, 116, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 51, 150, 112, 68, 66, 150, 88, 150], "policy_policy_0_reward": [-460.4200441118245, -207.54370834879342, -902.4278842127317, -920.8063710300514, -755.5411773582532, -914.4451256160108, -684.7260370177598, -30.818072928959065, -797.1905328086382, -874.6631479105067, -78.10325262186132, -700.7464602784842, -816.6345963520507, -602.7200773962093, -739.1799005823541, -428.07874534536046, -829.786802317674, -614.5386141022705, -1127.0253763327837, -17.463378522334786, -588.2412805372752, -171.22707504131907, -821.663854060191, -1106.9934305078646, -480.4285157989416, -898.724214008218, -823.3595545728108, -945.7111467477009, -209.25225810628385, -779.7816499321324, -836.461508076983, -539.1484399515581, -800.0373811064711, -214.72339361873924, -1203.3105663179215, -709.229672121585, -1045.451900672916, -753.5098041739941, -570.8005692828705, -775.527634675589, -275.9464292851927, -567.717945834301, -49.863041164405544, -507.8238118187696, -527.3771866932232, -282.1176308849785, -1119.0014515005032, -1067.7748969170948, -322.2443176913389, -1027.064391339988, -822.5338686436593, -466.6296354575062, -97.17480958587026, -940.1790301229531, -675.2439541216891, -954.1072723474002, -940.1023734484535, -483.36898532166697, -951.7340383842653, -562.6126141122026, -414.87026255529594, -523.1054568302663, -459.29833681144396, -134.56687472670833, -554.9566868567229, -1060.5452406401466, -1091.2520042414676, -607.4110702285132, -1167.6922366879146, -679.1140179981485, -161.48967721006127, -1043.5363476508571, -1135.1134500103155, -789.7519518308169, -769.0420135800302, -957.2394035686996, -798.1289188042039, -1019.0336621862895, -829.635234273967, -76.3147697210278, -851.7583853094418, -388.7686966220833, -163.7509717854387, -147.89070345115528, -997.640344451948, -200.00697209149237, -963.1483061508898]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27511446684449004, "mean_inference_ms": 0.86032075547213, "mean_action_processing_ms": 0.15720519471587993, "mean_env_wait_ms": 1.5139447432314956, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006052543377054149, "StateBufferConnector_ms": 0.004012557281844917, "ViewRequirementAgentConnector_ms": 0.09410710170351226}, "num_episodes": 31, "episode_return_max": -17.463378522334786, "episode_return_min": -1203.3105663179215, "episode_return_mean": -659.7945153500814, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.84859757991364, "num_env_steps_trained_throughput_per_sec": 267.84859757991364, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 14916.563, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14916.488, "sample_time_ms": 2322.458, "learn_time_ms": 12577.929, "learn_throughput": 318.017, "synch_weights_time_ms": 15.255}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00006", "date": "2024-08-03_05-19-14", "timestamp": 1722642554, "time_this_iter_s": 14.940986633300781, "time_total_s": 44.76875448226929, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8f880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 44.76875448226929, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.852380952380955, "ram_util_percent": 19.190476190476186}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3797927544762691, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.772477708260219, "policy_loss": -0.014641698407164465, "vf_loss": 9.784142479300499, "vf_explained_var": 0.12417164649814368, "kl": 0.014960311143416527, "entropy": 1.5135625620683035, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -17.463378522334786, "episode_reward_min": -1374.5204208451887, "episode_reward_mean": -713.6604720045289, "episode_len_mean": 137.74, "episode_media": {}, "episodes_timesteps_total": 13774, "policy_reward_min": {"policy_0": -1374.5204208451887}, "policy_reward_max": {"policy_0": -17.463378522334786}, "policy_reward_mean": {"policy_0": -713.6604720045289}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-602.7200773962093, -739.1799005823541, -428.07874534536046, -829.786802317674, -614.5386141022705, -1127.0253763327837, -17.463378522334786, -588.2412805372752, -171.22707504131907, -821.663854060191, -1106.9934305078646, -480.4285157989416, -898.724214008218, -823.3595545728108, -945.7111467477009, -209.25225810628385, -779.7816499321324, -836.461508076983, -539.1484399515581, -800.0373811064711, -214.72339361873924, -1203.3105663179215, -709.229672121585, -1045.451900672916, -753.5098041739941, -570.8005692828705, -775.527634675589, -275.9464292851927, -567.717945834301, -49.863041164405544, -507.8238118187696, -527.3771866932232, -282.1176308849785, -1119.0014515005032, -1067.7748969170948, -322.2443176913389, -1027.064391339988, -822.5338686436593, -466.6296354575062, -97.17480958587026, -940.1790301229531, -675.2439541216891, -954.1072723474002, -940.1023734484535, -483.36898532166697, -951.7340383842653, -562.6126141122026, -414.87026255529594, -523.1054568302663, -459.29833681144396, -134.56687472670833, -554.9566868567229, -1060.5452406401466, -1091.2520042414676, -607.4110702285132, -1167.6922366879146, -679.1140179981485, -161.48967721006127, -1043.5363476508571, -1135.1134500103155, -789.7519518308169, -769.0420135800302, -957.2394035686996, -798.1289188042039, -1019.0336621862895, -829.635234273967, -76.3147697210278, -851.7583853094418, -388.7686966220833, -163.7509717854387, -147.89070345115528, -997.640344451948, -200.00697209149237, -963.1483061508898, -1217.421778127627, -973.2068772981372, -67.93687447540174, -657.1082180188789, -1106.263685805791, -988.9726346616125, -908.6499494172573, -1060.141631362717, -250.26125578984713, -789.0167560769353, -993.4482831130753, -507.2666950827684, -1162.997025833791, -1374.5204208451887, -580.1325410461166, -1046.758805417477, -777.2694039348789, -802.4220018880758, -1026.1364966967803, -945.5476362587794, -810.5917183742702, -786.7542617372593, -686.4654643235267, -743.4105245756306, -986.7583702412345, -858.5314651886578], "episode_lengths": [150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 99, 150, 150, 150, 150, 121, 150, 85, 150, 61, 150, 150, 103, 150, 150, 121, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 128, 103, 150, 150, 72, 116, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 51, 150, 112, 68, 66, 150, 88, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-602.7200773962093, -739.1799005823541, -428.07874534536046, -829.786802317674, -614.5386141022705, -1127.0253763327837, -17.463378522334786, -588.2412805372752, -171.22707504131907, -821.663854060191, -1106.9934305078646, -480.4285157989416, -898.724214008218, -823.3595545728108, -945.7111467477009, -209.25225810628385, -779.7816499321324, -836.461508076983, -539.1484399515581, -800.0373811064711, -214.72339361873924, -1203.3105663179215, -709.229672121585, -1045.451900672916, -753.5098041739941, -570.8005692828705, -775.527634675589, -275.9464292851927, -567.717945834301, -49.863041164405544, -507.8238118187696, -527.3771866932232, -282.1176308849785, -1119.0014515005032, -1067.7748969170948, -322.2443176913389, -1027.064391339988, -822.5338686436593, -466.6296354575062, -97.17480958587026, -940.1790301229531, -675.2439541216891, -954.1072723474002, -940.1023734484535, -483.36898532166697, -951.7340383842653, -562.6126141122026, -414.87026255529594, -523.1054568302663, -459.29833681144396, -134.56687472670833, -554.9566868567229, -1060.5452406401466, -1091.2520042414676, -607.4110702285132, -1167.6922366879146, -679.1140179981485, -161.48967721006127, -1043.5363476508571, -1135.1134500103155, -789.7519518308169, -769.0420135800302, -957.2394035686996, -798.1289188042039, -1019.0336621862895, -829.635234273967, -76.3147697210278, -851.7583853094418, -388.7686966220833, -163.7509717854387, -147.89070345115528, -997.640344451948, -200.00697209149237, -963.1483061508898, -1217.421778127627, -973.2068772981372, -67.93687447540174, -657.1082180188789, -1106.263685805791, -988.9726346616125, -908.6499494172573, -1060.141631362717, -250.26125578984713, -789.0167560769353, -993.4482831130753, -507.2666950827684, -1162.997025833791, -1374.5204208451887, -580.1325410461166, -1046.758805417477, -777.2694039348789, -802.4220018880758, -1026.1364966967803, -945.5476362587794, -810.5917183742702, -786.7542617372593, -686.4654643235267, -743.4105245756306, -986.7583702412345, -858.5314651886578]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27550437520951143, "mean_inference_ms": 0.863843832657584, "mean_action_processing_ms": 0.15714376381942877, "mean_env_wait_ms": 1.5178439598763762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005912065505981445, "StateBufferConnector_ms": 0.003940105438232422, "ViewRequirementAgentConnector_ms": 0.09466552734375}, "num_episodes": 26, "episode_return_max": -17.463378522334786, "episode_return_min": -1374.5204208451887, "episode_return_mean": -713.6604720045289, "episodes_this_iter": 26}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.2108053644638, "num_env_steps_trained_throughput_per_sec": 267.2108053644638, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 14929.789, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14929.718, "sample_time_ms": 2336.042, "learn_time_ms": 12576.947, "learn_throughput": 318.042, "synch_weights_time_ms": 15.909}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00006", "date": "2024-08-03_05-19-29", "timestamp": 1722642569, "time_this_iter_s": 14.976083517074585, "time_total_s": 59.74483799934387, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8d990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 59.74483799934387, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.690909090909093, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.2144409988075493, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.282017208139102, "policy_loss": -0.007745476182996451, "vf_loss": 9.287019583582879, "vf_explained_var": 0.26288740541785954, "kl": 0.013790284557656685, "entropy": 1.4973169105748336, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -22.04807850032083, "episode_reward_min": -1374.5204208451887, "episode_reward_mean": -744.1766594894914, "episode_len_mean": 136.99, "episode_media": {}, "episodes_timesteps_total": 13699, "policy_reward_min": {"policy_0": -1374.5204208451887}, "policy_reward_max": {"policy_0": -22.04807850032083}, "policy_reward_mean": {"policy_0": -744.1766594894914}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.863041164405544, -507.8238118187696, -527.3771866932232, -282.1176308849785, -1119.0014515005032, -1067.7748969170948, -322.2443176913389, -1027.064391339988, -822.5338686436593, -466.6296354575062, -97.17480958587026, -940.1790301229531, -675.2439541216891, -954.1072723474002, -940.1023734484535, -483.36898532166697, -951.7340383842653, -562.6126141122026, -414.87026255529594, -523.1054568302663, -459.29833681144396, -134.56687472670833, -554.9566868567229, -1060.5452406401466, -1091.2520042414676, -607.4110702285132, -1167.6922366879146, -679.1140179981485, -161.48967721006127, -1043.5363476508571, -1135.1134500103155, -789.7519518308169, -769.0420135800302, -957.2394035686996, -798.1289188042039, -1019.0336621862895, -829.635234273967, -76.3147697210278, -851.7583853094418, -388.7686966220833, -163.7509717854387, -147.89070345115528, -997.640344451948, -200.00697209149237, -963.1483061508898, -1217.421778127627, -973.2068772981372, -67.93687447540174, -657.1082180188789, -1106.263685805791, -988.9726346616125, -908.6499494172573, -1060.141631362717, -250.26125578984713, -789.0167560769353, -993.4482831130753, -507.2666950827684, -1162.997025833791, -1374.5204208451887, -580.1325410461166, -1046.758805417477, -777.2694039348789, -802.4220018880758, -1026.1364966967803, -945.5476362587794, -810.5917183742702, -786.7542617372593, -686.4654643235267, -743.4105245756306, -986.7583702412345, -858.5314651886578, -728.6508682585361, -974.3450049281493, -913.2691206400813, -410.41704181507663, -1027.2704564957628, -864.2715561654655, -501.1059689904904, -22.04807850032083, -1230.5362571782846, -757.3805858302233, -999.4193505835647, -764.5333985572285, -911.294707345094, -53.641172688535526, -1127.4101291555157, -543.4877248579079, -248.74158101852734, -348.885292676683, -1205.37012308294, -1299.204070754168, -154.69395561814764, -492.4148653923827, -1009.6564641720511, -303.5216908187019, -1332.3332402620115, -1052.4632303830876, -893.5446924359582, -1353.8961724710402, -1003.8530664501936], "episode_lengths": [61, 150, 150, 103, 150, 150, 121, 150, 150, 150, 75, 150, 150, 150, 150, 150, 150, 128, 103, 150, 150, 72, 116, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 51, 150, 112, 68, 66, 150, 88, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 132, 60, 150, 150, 150, 150, 150, 70, 150, 150, 121, 150, 150, 150, 109, 150, 150, 90, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-49.863041164405544, -507.8238118187696, -527.3771866932232, -282.1176308849785, -1119.0014515005032, -1067.7748969170948, -322.2443176913389, -1027.064391339988, -822.5338686436593, -466.6296354575062, -97.17480958587026, -940.1790301229531, -675.2439541216891, -954.1072723474002, -940.1023734484535, -483.36898532166697, -951.7340383842653, -562.6126141122026, -414.87026255529594, -523.1054568302663, -459.29833681144396, -134.56687472670833, -554.9566868567229, -1060.5452406401466, -1091.2520042414676, -607.4110702285132, -1167.6922366879146, -679.1140179981485, -161.48967721006127, -1043.5363476508571, -1135.1134500103155, -789.7519518308169, -769.0420135800302, -957.2394035686996, -798.1289188042039, -1019.0336621862895, -829.635234273967, -76.3147697210278, -851.7583853094418, -388.7686966220833, -163.7509717854387, -147.89070345115528, -997.640344451948, -200.00697209149237, -963.1483061508898, -1217.421778127627, -973.2068772981372, -67.93687447540174, -657.1082180188789, -1106.263685805791, -988.9726346616125, -908.6499494172573, -1060.141631362717, -250.26125578984713, -789.0167560769353, -993.4482831130753, -507.2666950827684, -1162.997025833791, -1374.5204208451887, -580.1325410461166, -1046.758805417477, -777.2694039348789, -802.4220018880758, -1026.1364966967803, -945.5476362587794, -810.5917183742702, -786.7542617372593, -686.4654643235267, -743.4105245756306, -986.7583702412345, -858.5314651886578, -728.6508682585361, -974.3450049281493, -913.2691206400813, -410.41704181507663, -1027.2704564957628, -864.2715561654655, -501.1059689904904, -22.04807850032083, -1230.5362571782846, -757.3805858302233, -999.4193505835647, -764.5333985572285, -911.294707345094, -53.641172688535526, -1127.4101291555157, -543.4877248579079, -248.74158101852734, -348.885292676683, -1205.37012308294, -1299.204070754168, -154.69395561814764, -492.4148653923827, -1009.6564641720511, -303.5216908187019, -1332.3332402620115, -1052.4632303830876, -893.5446924359582, -1353.8961724710402, -1003.8530664501936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27553581239373776, "mean_inference_ms": 0.8653875730729652, "mean_action_processing_ms": 0.15691346349934684, "mean_env_wait_ms": 1.5220591514637787, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005672454833984375, "StateBufferConnector_ms": 0.003866910934448242, "ViewRequirementAgentConnector_ms": 0.09532451629638672}, "num_episodes": 29, "episode_return_max": -22.04807850032083, "episode_return_min": -1374.5204208451887, "episode_return_mean": -744.1766594894914, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.0532021521413, "num_env_steps_trained_throughput_per_sec": 269.0532021521413, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 14917.224, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14917.149, "sample_time_ms": 2334.97, "learn_time_ms": 12565.582, "learn_throughput": 318.33, "synch_weights_time_ms": 15.746}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00006", "date": "2024-08-03_05-19-44", "timestamp": 1722642584, "time_this_iter_s": 14.874136924743652, "time_total_s": 74.61897492408752, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fd9000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 74.61897492408752, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.995238095238093, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.078987723092238, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.233545841773351, "policy_loss": -0.011322011794739713, "vf_loss": 9.242078264057636, "vf_explained_var": 0.30370726430167755, "kl": 0.014022152028436121, "entropy": 1.4851741420725981, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -22.04807850032083, "episode_reward_min": -1374.5204208451887, "episode_reward_mean": -778.9445642159835, "episode_len_mean": 138.87, "episode_media": {}, "episodes_timesteps_total": 13887, "policy_reward_min": {"policy_0": -1374.5204208451887}, "policy_reward_max": {"policy_0": -22.04807850032083}, "policy_reward_mean": {"policy_0": -778.9445642159835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1135.1134500103155, -789.7519518308169, -769.0420135800302, -957.2394035686996, -798.1289188042039, -1019.0336621862895, -829.635234273967, -76.3147697210278, -851.7583853094418, -388.7686966220833, -163.7509717854387, -147.89070345115528, -997.640344451948, -200.00697209149237, -963.1483061508898, -1217.421778127627, -973.2068772981372, -67.93687447540174, -657.1082180188789, -1106.263685805791, -988.9726346616125, -908.6499494172573, -1060.141631362717, -250.26125578984713, -789.0167560769353, -993.4482831130753, -507.2666950827684, -1162.997025833791, -1374.5204208451887, -580.1325410461166, -1046.758805417477, -777.2694039348789, -802.4220018880758, -1026.1364966967803, -945.5476362587794, -810.5917183742702, -786.7542617372593, -686.4654643235267, -743.4105245756306, -986.7583702412345, -858.5314651886578, -728.6508682585361, -974.3450049281493, -913.2691206400813, -410.41704181507663, -1027.2704564957628, -864.2715561654655, -501.1059689904904, -22.04807850032083, -1230.5362571782846, -757.3805858302233, -999.4193505835647, -764.5333985572285, -911.294707345094, -53.641172688535526, -1127.4101291555157, -543.4877248579079, -248.74158101852734, -348.885292676683, -1205.37012308294, -1299.204070754168, -154.69395561814764, -492.4148653923827, -1009.6564641720511, -303.5216908187019, -1332.3332402620115, -1052.4632303830876, -893.5446924359582, -1353.8961724710402, -1003.8530664501936, -1026.5287686784477, -482.25628832826374, -1174.6504705331254, -760.9883706642809, -1207.3990509313242, -772.6946879396563, -1229.3528073955608, -885.3120471711925, -37.680677500938835, -775.3412282860259, -1060.641988288836, -656.5415635093326, -1005.2379573511629, -816.8358743424643, -550.8138371842045, -827.2239975969646, -156.24604972035627, -870.9868117837773, -692.286062865704, -818.294997565513, -184.59927223112348, -980.2300433142043, -179.07047019446222, -1121.0998356162013, -893.6746273153689, -534.6125120847703, -1123.357219273519, -735.4329801499532, -1022.0489467210064, -590.1425501049669], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 51, 150, 112, 68, 66, 150, 88, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 132, 60, 150, 150, 150, 150, 150, 70, 150, 150, 121, 150, 150, 150, 109, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 88, 150, 106, 150, 150, 126, 150, 150, 150, 150], "policy_policy_0_reward": [-1135.1134500103155, -789.7519518308169, -769.0420135800302, -957.2394035686996, -798.1289188042039, -1019.0336621862895, -829.635234273967, -76.3147697210278, -851.7583853094418, -388.7686966220833, -163.7509717854387, -147.89070345115528, -997.640344451948, -200.00697209149237, -963.1483061508898, -1217.421778127627, -973.2068772981372, -67.93687447540174, -657.1082180188789, -1106.263685805791, -988.9726346616125, -908.6499494172573, -1060.141631362717, -250.26125578984713, -789.0167560769353, -993.4482831130753, -507.2666950827684, -1162.997025833791, -1374.5204208451887, -580.1325410461166, -1046.758805417477, -777.2694039348789, -802.4220018880758, -1026.1364966967803, -945.5476362587794, -810.5917183742702, -786.7542617372593, -686.4654643235267, -743.4105245756306, -986.7583702412345, -858.5314651886578, -728.6508682585361, -974.3450049281493, -913.2691206400813, -410.41704181507663, -1027.2704564957628, -864.2715561654655, -501.1059689904904, -22.04807850032083, -1230.5362571782846, -757.3805858302233, -999.4193505835647, -764.5333985572285, -911.294707345094, -53.641172688535526, -1127.4101291555157, -543.4877248579079, -248.74158101852734, -348.885292676683, -1205.37012308294, -1299.204070754168, -154.69395561814764, -492.4148653923827, -1009.6564641720511, -303.5216908187019, -1332.3332402620115, -1052.4632303830876, -893.5446924359582, -1353.8961724710402, -1003.8530664501936, -1026.5287686784477, -482.25628832826374, -1174.6504705331254, -760.9883706642809, -1207.3990509313242, -772.6946879396563, -1229.3528073955608, -885.3120471711925, -37.680677500938835, -775.3412282860259, -1060.641988288836, -656.5415635093326, -1005.2379573511629, -816.8358743424643, -550.8138371842045, -827.2239975969646, -156.24604972035627, -870.9868117837773, -692.286062865704, -818.294997565513, -184.59927223112348, -980.2300433142043, -179.07047019446222, -1121.0998356162013, -893.6746273153689, -534.6125120847703, -1123.357219273519, -735.4329801499532, -1022.0489467210064, -590.1425501049669]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2761428174784312, "mean_inference_ms": 0.8666484466453713, "mean_action_processing_ms": 0.1567765820431183, "mean_env_wait_ms": 1.5250269567534251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005514621734619141, "StateBufferConnector_ms": 0.00392913818359375, "ViewRequirementAgentConnector_ms": 0.09819722175598145}, "num_episodes": 30, "episode_return_max": -22.04807850032083, "episode_return_min": -1374.5204208451887, "episode_return_mean": -778.9445642159835, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.2365588120388, "num_env_steps_trained_throughput_per_sec": 265.2365588120388, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 14944.502, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14944.429, "sample_time_ms": 2331.839, "learn_time_ms": 12596.308, "learn_throughput": 317.553, "synch_weights_time_ms": 15.444}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00006", "date": "2024-08-03_05-19-59", "timestamp": 1722642599, "time_this_iter_s": 15.087863683700562, "time_total_s": 89.70683860778809, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0d990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 89.70683860778809, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.890476190476189, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.890361132472753, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.179308981200059, "policy_loss": -0.013544044214844083, "vf_loss": 9.189590812722843, "vf_explained_var": 0.23417851266761622, "kl": 0.016389264087956698, "entropy": 1.5622172884643077, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -12.53681655464854, "episode_reward_min": -1374.5204208451887, "episode_reward_mean": -809.2589641976432, "episode_len_mean": 141.38, "episode_media": {}, "episodes_timesteps_total": 14138, "policy_reward_min": {"policy_0": -1374.5204208451887}, "policy_reward_max": {"policy_0": -12.53681655464854}, "policy_reward_mean": {"policy_0": -809.2589641976432}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1162.997025833791, -1374.5204208451887, -580.1325410461166, -1046.758805417477, -777.2694039348789, -802.4220018880758, -1026.1364966967803, -945.5476362587794, -810.5917183742702, -786.7542617372593, -686.4654643235267, -743.4105245756306, -986.7583702412345, -858.5314651886578, -728.6508682585361, -974.3450049281493, -913.2691206400813, -410.41704181507663, -1027.2704564957628, -864.2715561654655, -501.1059689904904, -22.04807850032083, -1230.5362571782846, -757.3805858302233, -999.4193505835647, -764.5333985572285, -911.294707345094, -53.641172688535526, -1127.4101291555157, -543.4877248579079, -248.74158101852734, -348.885292676683, -1205.37012308294, -1299.204070754168, -154.69395561814764, -492.4148653923827, -1009.6564641720511, -303.5216908187019, -1332.3332402620115, -1052.4632303830876, -893.5446924359582, -1353.8961724710402, -1003.8530664501936, -1026.5287686784477, -482.25628832826374, -1174.6504705331254, -760.9883706642809, -1207.3990509313242, -772.6946879396563, -1229.3528073955608, -885.3120471711925, -37.680677500938835, -775.3412282860259, -1060.641988288836, -656.5415635093326, -1005.2379573511629, -816.8358743424643, -550.8138371842045, -827.2239975969646, -156.24604972035627, -870.9868117837773, -692.286062865704, -818.294997565513, -184.59927223112348, -980.2300433142043, -179.07047019446222, -1121.0998356162013, -893.6746273153689, -534.6125120847703, -1123.357219273519, -735.4329801499532, -1022.0489467210064, -590.1425501049669, -800.3041654840018, -12.53681655464854, -933.4510824973315, -535.9673828580773, -1227.0551526949462, -1089.4087633273066, -497.6670400516635, -1248.7319411779206, -1097.8962978677487, -537.0972731226169, -608.7110014278838, -1189.5811303830892, -1060.1295129613995, -1148.5188282223464, -858.8160991829892, -823.9723482987039, -934.8763503819644, -585.5905607397664, -1110.1287856060055, -882.5570075969104, -943.8240111653841, -141.6245309417358, -1198.1394684737, -630.3069254245735, -855.6608952811088, -676.5063667107783, -1009.2986827992122], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 132, 60, 150, 150, 150, 150, 150, 70, 150, 150, 121, 150, 150, 150, 109, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 88, 150, 106, 150, 150, 126, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1162.997025833791, -1374.5204208451887, -580.1325410461166, -1046.758805417477, -777.2694039348789, -802.4220018880758, -1026.1364966967803, -945.5476362587794, -810.5917183742702, -786.7542617372593, -686.4654643235267, -743.4105245756306, -986.7583702412345, -858.5314651886578, -728.6508682585361, -974.3450049281493, -913.2691206400813, -410.41704181507663, -1027.2704564957628, -864.2715561654655, -501.1059689904904, -22.04807850032083, -1230.5362571782846, -757.3805858302233, -999.4193505835647, -764.5333985572285, -911.294707345094, -53.641172688535526, -1127.4101291555157, -543.4877248579079, -248.74158101852734, -348.885292676683, -1205.37012308294, -1299.204070754168, -154.69395561814764, -492.4148653923827, -1009.6564641720511, -303.5216908187019, -1332.3332402620115, -1052.4632303830876, -893.5446924359582, -1353.8961724710402, -1003.8530664501936, -1026.5287686784477, -482.25628832826374, -1174.6504705331254, -760.9883706642809, -1207.3990509313242, -772.6946879396563, -1229.3528073955608, -885.3120471711925, -37.680677500938835, -775.3412282860259, -1060.641988288836, -656.5415635093326, -1005.2379573511629, -816.8358743424643, -550.8138371842045, -827.2239975969646, -156.24604972035627, -870.9868117837773, -692.286062865704, -818.294997565513, -184.59927223112348, -980.2300433142043, -179.07047019446222, -1121.0998356162013, -893.6746273153689, -534.6125120847703, -1123.357219273519, -735.4329801499532, -1022.0489467210064, -590.1425501049669, -800.3041654840018, -12.53681655464854, -933.4510824973315, -535.9673828580773, -1227.0551526949462, -1089.4087633273066, -497.6670400516635, -1248.7319411779206, -1097.8962978677487, -537.0972731226169, -608.7110014278838, -1189.5811303830892, -1060.1295129613995, -1148.5188282223464, -858.8160991829892, -823.9723482987039, -934.8763503819644, -585.5905607397664, -1110.1287856060055, -882.5570075969104, -943.8240111653841, -141.6245309417358, -1198.1394684737, -630.3069254245735, -855.6608952811088, -676.5063667107783, -1009.2986827992122]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2763906041624245, "mean_inference_ms": 0.8691442918453063, "mean_action_processing_ms": 0.15677560466936166, "mean_env_wait_ms": 1.5276099078251384, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005567073822021484, "StateBufferConnector_ms": 0.003935337066650391, "ViewRequirementAgentConnector_ms": 0.09903955459594727}, "num_episodes": 27, "episode_return_max": -12.53681655464854, "episode_return_min": -1374.5204208451887, "episode_return_mean": -809.2589641976432, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 260.82574998097505, "num_env_steps_trained_throughput_per_sec": 260.82574998097505, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 15000.419, "restore_workers_time_ms": 0.025, "training_step_time_ms": 15000.346, "sample_time_ms": 2355.128, "learn_time_ms": 12628.706, "learn_throughput": 316.739, "synch_weights_time_ms": 15.678}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00006", "date": "2024-08-03_05-20-15", "timestamp": 1722642615, "time_this_iter_s": 15.34487009048462, "time_total_s": 105.0517086982727, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8d630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 105.0517086982727, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.086363636363638, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.141653890907765, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.281863382955391, "policy_loss": -0.010932562716091828, "vf_loss": 8.289252535502117, "vf_explained_var": 0.6299029855678479, "kl": 0.017789788555334484, "entropy": 1.45594776434203, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -12.53681655464854, "episode_reward_min": -1353.8961724710402, "episode_reward_mean": -775.752084244102, "episode_len_mean": 138.5, "episode_media": {}, "episodes_timesteps_total": 13850, "policy_reward_min": {"policy_0": -1353.8961724710402}, "policy_reward_max": {"policy_0": -12.53681655464854}, "policy_reward_mean": {"policy_0": -775.752084244102}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1205.37012308294, -1299.204070754168, -154.69395561814764, -492.4148653923827, -1009.6564641720511, -303.5216908187019, -1332.3332402620115, -1052.4632303830876, -893.5446924359582, -1353.8961724710402, -1003.8530664501936, -1026.5287686784477, -482.25628832826374, -1174.6504705331254, -760.9883706642809, -1207.3990509313242, -772.6946879396563, -1229.3528073955608, -885.3120471711925, -37.680677500938835, -775.3412282860259, -1060.641988288836, -656.5415635093326, -1005.2379573511629, -816.8358743424643, -550.8138371842045, -827.2239975969646, -156.24604972035627, -870.9868117837773, -692.286062865704, -818.294997565513, -184.59927223112348, -980.2300433142043, -179.07047019446222, -1121.0998356162013, -893.6746273153689, -534.6125120847703, -1123.357219273519, -735.4329801499532, -1022.0489467210064, -590.1425501049669, -800.3041654840018, -12.53681655464854, -933.4510824973315, -535.9673828580773, -1227.0551526949462, -1089.4087633273066, -497.6670400516635, -1248.7319411779206, -1097.8962978677487, -537.0972731226169, -608.7110014278838, -1189.5811303830892, -1060.1295129613995, -1148.5188282223464, -858.8160991829892, -823.9723482987039, -934.8763503819644, -585.5905607397664, -1110.1287856060055, -882.5570075969104, -943.8240111653841, -141.6245309417358, -1198.1394684737, -630.3069254245735, -855.6608952811088, -676.5063667107783, -1009.2986827992122, -1033.820796957904, -956.1841987289342, -1015.3830644099113, -831.4589509058501, -73.97465212177332, -560.9164693568372, -43.639596185201135, -23.05779402282154, -406.74494840822206, -898.6423437349946, -1057.2612812125358, -200.98651065097997, -572.3116677311823, -960.920654447668, -1293.8882288432287, -730.5065316878398, -1077.932227046454, -1115.7228130323956, -1193.9473105147224, -1060.108273649918, -912.0983348872521, -394.2488369413875, -999.7922784701888, -778.9417512702394, -35.379191484836824, -251.42013318121144, -106.16535494622731, -770.8589878172793, -224.61212520598698, -591.7028840884004, -910.938809868377, -580.7494348822584], "episode_lengths": [150, 150, 109, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 88, 150, 106, 150, 150, 126, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 62, 45, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 61, 150, 81, 150, 108, 150, 150, 150], "policy_policy_0_reward": [-1205.37012308294, -1299.204070754168, -154.69395561814764, -492.4148653923827, -1009.6564641720511, -303.5216908187019, -1332.3332402620115, -1052.4632303830876, -893.5446924359582, -1353.8961724710402, -1003.8530664501936, -1026.5287686784477, -482.25628832826374, -1174.6504705331254, -760.9883706642809, -1207.3990509313242, -772.6946879396563, -1229.3528073955608, -885.3120471711925, -37.680677500938835, -775.3412282860259, -1060.641988288836, -656.5415635093326, -1005.2379573511629, -816.8358743424643, -550.8138371842045, -827.2239975969646, -156.24604972035627, -870.9868117837773, -692.286062865704, -818.294997565513, -184.59927223112348, -980.2300433142043, -179.07047019446222, -1121.0998356162013, -893.6746273153689, -534.6125120847703, -1123.357219273519, -735.4329801499532, -1022.0489467210064, -590.1425501049669, -800.3041654840018, -12.53681655464854, -933.4510824973315, -535.9673828580773, -1227.0551526949462, -1089.4087633273066, -497.6670400516635, -1248.7319411779206, -1097.8962978677487, -537.0972731226169, -608.7110014278838, -1189.5811303830892, -1060.1295129613995, -1148.5188282223464, -858.8160991829892, -823.9723482987039, -934.8763503819644, -585.5905607397664, -1110.1287856060055, -882.5570075969104, -943.8240111653841, -141.6245309417358, -1198.1394684737, -630.3069254245735, -855.6608952811088, -676.5063667107783, -1009.2986827992122, -1033.820796957904, -956.1841987289342, -1015.3830644099113, -831.4589509058501, -73.97465212177332, -560.9164693568372, -43.639596185201135, -23.05779402282154, -406.74494840822206, -898.6423437349946, -1057.2612812125358, -200.98651065097997, -572.3116677311823, -960.920654447668, -1293.8882288432287, -730.5065316878398, -1077.932227046454, -1115.7228130323956, -1193.9473105147224, -1060.108273649918, -912.0983348872521, -394.2488369413875, -999.7922784701888, -778.9417512702394, -35.379191484836824, -251.42013318121144, -106.16535494622731, -770.8589878172793, -224.61212520598698, -591.7028840884004, -910.938809868377, -580.7494348822584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2768519121695854, "mean_inference_ms": 0.8801643410423545, "mean_action_processing_ms": 0.15694386176246763, "mean_env_wait_ms": 1.5309780525646395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005621671676635742, "StateBufferConnector_ms": 0.004000425338745117, "ViewRequirementAgentConnector_ms": 0.10039234161376953}, "num_episodes": 32, "episode_return_max": -12.53681655464854, "episode_return_min": -1353.8961724710402, "episode_return_mean": -775.752084244102, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.47678478557293, "num_env_steps_trained_throughput_per_sec": 261.47678478557293, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 15037.585, "restore_workers_time_ms": 0.025, "training_step_time_ms": 15037.511, "sample_time_ms": 2379.064, "learn_time_ms": 12641.921, "learn_throughput": 316.408, "synch_weights_time_ms": 15.691}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00006", "date": "2024-08-03_05-20-30", "timestamp": 1722642630, "time_this_iter_s": 15.306331157684326, "time_total_s": 120.35803985595703, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8d120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 120.35803985595703, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 12.936363636363636, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.680495442450045, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.936446035901706, "policy_loss": -0.011844727647257969, "vf_loss": 7.94459582567215, "vf_explained_var": 0.5943983624999721, "kl": 0.018546696067765347, "entropy": 1.4420385801543791, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -12.53681655464854, "episode_reward_min": -1293.8882288432287, "episode_reward_mean": -716.4898342397172, "episode_len_mean": 137.52, "episode_media": {}, "episodes_timesteps_total": 13752, "policy_reward_min": {"policy_0": -1293.8882288432287}, "policy_reward_max": {"policy_0": -12.53681655464854}, "policy_reward_mean": {"policy_0": -716.4898342397172}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-692.286062865704, -818.294997565513, -184.59927223112348, -980.2300433142043, -179.07047019446222, -1121.0998356162013, -893.6746273153689, -534.6125120847703, -1123.357219273519, -735.4329801499532, -1022.0489467210064, -590.1425501049669, -800.3041654840018, -12.53681655464854, -933.4510824973315, -535.9673828580773, -1227.0551526949462, -1089.4087633273066, -497.6670400516635, -1248.7319411779206, -1097.8962978677487, -537.0972731226169, -608.7110014278838, -1189.5811303830892, -1060.1295129613995, -1148.5188282223464, -858.8160991829892, -823.9723482987039, -934.8763503819644, -585.5905607397664, -1110.1287856060055, -882.5570075969104, -943.8240111653841, -141.6245309417358, -1198.1394684737, -630.3069254245735, -855.6608952811088, -676.5063667107783, -1009.2986827992122, -1033.820796957904, -956.1841987289342, -1015.3830644099113, -831.4589509058501, -73.97465212177332, -560.9164693568372, -43.639596185201135, -23.05779402282154, -406.74494840822206, -898.6423437349946, -1057.2612812125358, -200.98651065097997, -572.3116677311823, -960.920654447668, -1293.8882288432287, -730.5065316878398, -1077.932227046454, -1115.7228130323956, -1193.9473105147224, -1060.108273649918, -912.0983348872521, -394.2488369413875, -999.7922784701888, -778.9417512702394, -35.379191484836824, -251.42013318121144, -106.16535494622731, -770.8589878172793, -224.61212520598698, -591.7028840884004, -910.938809868377, -580.7494348822584, -694.6128461221381, -75.35940586060534, -1068.4527366690768, -694.3582417896827, -475.7401296581805, -1106.2225154941837, -665.8341267414071, -1088.9703521322745, -1209.4302139781034, -131.37324887024798, -538.9086372120047, -964.6076240207856, -660.2207919947137, -505.0247346727891, -423.8208410072176, -373.4102343339812, -983.4334759748003, -246.71400981849655, -533.9569130881521, -898.9909089239293, -187.06833809642694, -451.15562201175067, -394.5641559855707, -794.0572942057286, -620.7063213134843, -726.2916064795546, -776.8130030204552, -651.2607777350645, -530.0999413972901], "episode_lengths": [150, 150, 88, 150, 106, 150, 150, 126, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 62, 45, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 61, 150, 81, 150, 108, 150, 150, 150, 150, 65, 150, 150, 123, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 109, 150, 103, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 128], "policy_policy_0_reward": [-692.286062865704, -818.294997565513, -184.59927223112348, -980.2300433142043, -179.07047019446222, -1121.0998356162013, -893.6746273153689, -534.6125120847703, -1123.357219273519, -735.4329801499532, -1022.0489467210064, -590.1425501049669, -800.3041654840018, -12.53681655464854, -933.4510824973315, -535.9673828580773, -1227.0551526949462, -1089.4087633273066, -497.6670400516635, -1248.7319411779206, -1097.8962978677487, -537.0972731226169, -608.7110014278838, -1189.5811303830892, -1060.1295129613995, -1148.5188282223464, -858.8160991829892, -823.9723482987039, -934.8763503819644, -585.5905607397664, -1110.1287856060055, -882.5570075969104, -943.8240111653841, -141.6245309417358, -1198.1394684737, -630.3069254245735, -855.6608952811088, -676.5063667107783, -1009.2986827992122, -1033.820796957904, -956.1841987289342, -1015.3830644099113, -831.4589509058501, -73.97465212177332, -560.9164693568372, -43.639596185201135, -23.05779402282154, -406.74494840822206, -898.6423437349946, -1057.2612812125358, -200.98651065097997, -572.3116677311823, -960.920654447668, -1293.8882288432287, -730.5065316878398, -1077.932227046454, -1115.7228130323956, -1193.9473105147224, -1060.108273649918, -912.0983348872521, -394.2488369413875, -999.7922784701888, -778.9417512702394, -35.379191484836824, -251.42013318121144, -106.16535494622731, -770.8589878172793, -224.61212520598698, -591.7028840884004, -910.938809868377, -580.7494348822584, -694.6128461221381, -75.35940586060534, -1068.4527366690768, -694.3582417896827, -475.7401296581805, -1106.2225154941837, -665.8341267414071, -1088.9703521322745, -1209.4302139781034, -131.37324887024798, -538.9086372120047, -964.6076240207856, -660.2207919947137, -505.0247346727891, -423.8208410072176, -373.4102343339812, -983.4334759748003, -246.71400981849655, -533.9569130881521, -898.9909089239293, -187.06833809642694, -451.15562201175067, -394.5641559855707, -794.0572942057286, -620.7063213134843, -726.2916064795546, -776.8130030204552, -651.2607777350645, -530.0999413972901]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2772552253125085, "mean_inference_ms": 0.889614671194494, "mean_action_processing_ms": 0.1571256664819154, "mean_env_wait_ms": 1.5333221419468446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005489349365234375, "StateBufferConnector_ms": 0.003978729248046875, "ViewRequirementAgentConnector_ms": 0.100341796875}, "num_episodes": 29, "episode_return_max": -12.53681655464854, "episode_return_min": -1293.8882288432287, "episode_return_mean": -716.4898342397172, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.8896125962007, "num_env_steps_trained_throughput_per_sec": 269.8896125962007, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 15013.507, "restore_workers_time_ms": 0.025, "training_step_time_ms": 15013.434, "sample_time_ms": 2371.819, "learn_time_ms": 12625.008, "learn_throughput": 316.831, "synch_weights_time_ms": 15.774}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00006", "date": "2024-08-03_05-20-45", "timestamp": 1722642645, "time_this_iter_s": 14.828238487243652, "time_total_s": 135.18627834320068, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fd8790>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 135.18627834320068, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 12.985714285714282, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.956269745528697, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.186282271146775, "policy_loss": -0.01305625391638993, "vf_loss": 8.195679281155268, "vf_explained_var": 0.6416921364764373, "kl": 0.018367490841531737, "entropy": 1.424813256536921, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -23.05779402282154, "episode_reward_min": -1293.8882288432287, "episode_reward_mean": -695.350447718893, "episode_len_mean": 138.18, "episode_media": {}, "episodes_timesteps_total": 13818, "policy_reward_min": {"policy_0": -1293.8882288432287}, "policy_reward_max": {"policy_0": -23.05779402282154}, "policy_reward_mean": {"policy_0": -695.350447718893}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-858.8160991829892, -823.9723482987039, -934.8763503819644, -585.5905607397664, -1110.1287856060055, -882.5570075969104, -943.8240111653841, -141.6245309417358, -1198.1394684737, -630.3069254245735, -855.6608952811088, -676.5063667107783, -1009.2986827992122, -1033.820796957904, -956.1841987289342, -1015.3830644099113, -831.4589509058501, -73.97465212177332, -560.9164693568372, -43.639596185201135, -23.05779402282154, -406.74494840822206, -898.6423437349946, -1057.2612812125358, -200.98651065097997, -572.3116677311823, -960.920654447668, -1293.8882288432287, -730.5065316878398, -1077.932227046454, -1115.7228130323956, -1193.9473105147224, -1060.108273649918, -912.0983348872521, -394.2488369413875, -999.7922784701888, -778.9417512702394, -35.379191484836824, -251.42013318121144, -106.16535494622731, -770.8589878172793, -224.61212520598698, -591.7028840884004, -910.938809868377, -580.7494348822584, -694.6128461221381, -75.35940586060534, -1068.4527366690768, -694.3582417896827, -475.7401296581805, -1106.2225154941837, -665.8341267414071, -1088.9703521322745, -1209.4302139781034, -131.37324887024798, -538.9086372120047, -964.6076240207856, -660.2207919947137, -505.0247346727891, -423.8208410072176, -373.4102343339812, -983.4334759748003, -246.71400981849655, -533.9569130881521, -898.9909089239293, -187.06833809642694, -451.15562201175067, -394.5641559855707, -794.0572942057286, -620.7063213134843, -726.2916064795546, -776.8130030204552, -651.2607777350645, -530.0999413972901, -467.6803222593624, -274.87454922573636, -592.7219197703173, -294.86558547335915, -512.7972984976245, -779.1932190501291, -689.6948135515878, -1102.2630857931272, -290.08877598461083, -1217.1535824355592, -913.012871857331, -854.5257138646095, -650.5458890794768, -436.4147200235767, -884.3172309393834, -1005.6093896999245, -401.8474161919999, -859.9328322689258, -982.9587834357224, -835.4030215296978, -735.3519313043364, -941.2936714894374, -663.3066753923447, -1241.3809137780477, -291.5166509490325, -829.216390140078], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 62, 45, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 61, 150, 81, 150, 108, 150, 150, 150, 150, 65, 150, 150, 123, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 109, 150, 103, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 128, 150, 107, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 106, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 114, 150], "policy_policy_0_reward": [-858.8160991829892, -823.9723482987039, -934.8763503819644, -585.5905607397664, -1110.1287856060055, -882.5570075969104, -943.8240111653841, -141.6245309417358, -1198.1394684737, -630.3069254245735, -855.6608952811088, -676.5063667107783, -1009.2986827992122, -1033.820796957904, -956.1841987289342, -1015.3830644099113, -831.4589509058501, -73.97465212177332, -560.9164693568372, -43.639596185201135, -23.05779402282154, -406.74494840822206, -898.6423437349946, -1057.2612812125358, -200.98651065097997, -572.3116677311823, -960.920654447668, -1293.8882288432287, -730.5065316878398, -1077.932227046454, -1115.7228130323956, -1193.9473105147224, -1060.108273649918, -912.0983348872521, -394.2488369413875, -999.7922784701888, -778.9417512702394, -35.379191484836824, -251.42013318121144, -106.16535494622731, -770.8589878172793, -224.61212520598698, -591.7028840884004, -910.938809868377, -580.7494348822584, -694.6128461221381, -75.35940586060534, -1068.4527366690768, -694.3582417896827, -475.7401296581805, -1106.2225154941837, -665.8341267414071, -1088.9703521322745, -1209.4302139781034, -131.37324887024798, -538.9086372120047, -964.6076240207856, -660.2207919947137, -505.0247346727891, -423.8208410072176, -373.4102343339812, -983.4334759748003, -246.71400981849655, -533.9569130881521, -898.9909089239293, -187.06833809642694, -451.15562201175067, -394.5641559855707, -794.0572942057286, -620.7063213134843, -726.2916064795546, -776.8130030204552, -651.2607777350645, -530.0999413972901, -467.6803222593624, -274.87454922573636, -592.7219197703173, -294.86558547335915, -512.7972984976245, -779.1932190501291, -689.6948135515878, -1102.2630857931272, -290.08877598461083, -1217.1535824355592, -913.012871857331, -854.5257138646095, -650.5458890794768, -436.4147200235767, -884.3172309393834, -1005.6093896999245, -401.8474161919999, -859.9328322689258, -982.9587834357224, -835.4030215296978, -735.3519313043364, -941.2936714894374, -663.3066753923447, -1241.3809137780477, -291.5166509490325, -829.216390140078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27745008284413186, "mean_inference_ms": 0.8951062032867655, "mean_action_processing_ms": 0.15719531413142201, "mean_env_wait_ms": 1.5349358035320655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055959224700927734, "StateBufferConnector_ms": 0.0039250850677490234, "ViewRequirementAgentConnector_ms": 0.09871840476989746}, "num_episodes": 26, "episode_return_max": -23.05779402282154, "episode_return_min": -1293.8882288432287, "episode_return_mean": -695.350447718893, "episodes_this_iter": 26}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.51454283797176, "num_env_steps_trained_throughput_per_sec": 266.51454283797176, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 15013.014, "restore_workers_time_ms": 0.025, "training_step_time_ms": 15012.942, "sample_time_ms": 2371.549, "learn_time_ms": 12624.879, "learn_throughput": 316.835, "synch_weights_time_ms": 15.678}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00006", "date": "2024-08-03_05-21-00", "timestamp": 1722642660, "time_this_iter_s": 15.01609206199646, "time_total_s": 150.20237040519714, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8d630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 150.20237040519714, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 12.79090909090909, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.951289880772432, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.645866526663303, "policy_loss": -0.016197366193713, "vf_loss": 7.657313027977944, "vf_explained_var": 0.7318776858349642, "kl": 0.023828414584340877, "entropy": 1.4848616542915503, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -28.061482849436004, "episode_reward_min": -1411.5895207773697, "episode_reward_mean": -702.2598158996939, "episode_len_mean": 139.87, "episode_media": {}, "episodes_timesteps_total": 13987, "policy_reward_min": {"policy_0": -1411.5895207773697}, "policy_reward_max": {"policy_0": -28.061482849436004}, "policy_reward_mean": {"policy_0": -702.2598158996939}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1077.932227046454, -1115.7228130323956, -1193.9473105147224, -1060.108273649918, -912.0983348872521, -394.2488369413875, -999.7922784701888, -778.9417512702394, -35.379191484836824, -251.42013318121144, -106.16535494622731, -770.8589878172793, -224.61212520598698, -591.7028840884004, -910.938809868377, -580.7494348822584, -694.6128461221381, -75.35940586060534, -1068.4527366690768, -694.3582417896827, -475.7401296581805, -1106.2225154941837, -665.8341267414071, -1088.9703521322745, -1209.4302139781034, -131.37324887024798, -538.9086372120047, -964.6076240207856, -660.2207919947137, -505.0247346727891, -423.8208410072176, -373.4102343339812, -983.4334759748003, -246.71400981849655, -533.9569130881521, -898.9909089239293, -187.06833809642694, -451.15562201175067, -394.5641559855707, -794.0572942057286, -620.7063213134843, -726.2916064795546, -776.8130030204552, -651.2607777350645, -530.0999413972901, -467.6803222593624, -274.87454922573636, -592.7219197703173, -294.86558547335915, -512.7972984976245, -779.1932190501291, -689.6948135515878, -1102.2630857931272, -290.08877598461083, -1217.1535824355592, -913.012871857331, -854.5257138646095, -650.5458890794768, -436.4147200235767, -884.3172309393834, -1005.6093896999245, -401.8474161919999, -859.9328322689258, -982.9587834357224, -835.4030215296978, -735.3519313043364, -941.2936714894374, -663.3066753923447, -1241.3809137780477, -291.5166509490325, -829.216390140078, -954.1945335827272, -273.6800632061958, -514.189697465633, -652.8501668967864, -71.44480955591516, -475.8672078029447, -931.9063343587308, -1037.5534089881423, -429.1305962784992, -1242.594993463176, -944.3479425046442, -306.116482612818, -497.0957953205323, -1346.755004644381, -454.6945234667543, -28.061482849436004, -1411.5895207773697, -1076.2617090584165, -1188.5632074211683, -685.3604748241403, -280.65257506005145, -686.0812092947209, -1092.6628234565692, -1012.4051879248617, -1082.7665174992364, -1068.1596304665404, -986.1713507814311, -221.18863735458132, -1049.590653172408], "episode_lengths": [150, 150, 150, 150, 150, 145, 150, 150, 61, 150, 81, 150, 108, 150, 150, 150, 150, 65, 150, 150, 123, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 109, 150, 103, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 128, 150, 107, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 106, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 98, 135, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1077.932227046454, -1115.7228130323956, -1193.9473105147224, -1060.108273649918, -912.0983348872521, -394.2488369413875, -999.7922784701888, -778.9417512702394, -35.379191484836824, -251.42013318121144, -106.16535494622731, -770.8589878172793, -224.61212520598698, -591.7028840884004, -910.938809868377, -580.7494348822584, -694.6128461221381, -75.35940586060534, -1068.4527366690768, -694.3582417896827, -475.7401296581805, -1106.2225154941837, -665.8341267414071, -1088.9703521322745, -1209.4302139781034, -131.37324887024798, -538.9086372120047, -964.6076240207856, -660.2207919947137, -505.0247346727891, -423.8208410072176, -373.4102343339812, -983.4334759748003, -246.71400981849655, -533.9569130881521, -898.9909089239293, -187.06833809642694, -451.15562201175067, -394.5641559855707, -794.0572942057286, -620.7063213134843, -726.2916064795546, -776.8130030204552, -651.2607777350645, -530.0999413972901, -467.6803222593624, -274.87454922573636, -592.7219197703173, -294.86558547335915, -512.7972984976245, -779.1932190501291, -689.6948135515878, -1102.2630857931272, -290.08877598461083, -1217.1535824355592, -913.012871857331, -854.5257138646095, -650.5458890794768, -436.4147200235767, -884.3172309393834, -1005.6093896999245, -401.8474161919999, -859.9328322689258, -982.9587834357224, -835.4030215296978, -735.3519313043364, -941.2936714894374, -663.3066753923447, -1241.3809137780477, -291.5166509490325, -829.216390140078, -954.1945335827272, -273.6800632061958, -514.189697465633, -652.8501668967864, -71.44480955591516, -475.8672078029447, -931.9063343587308, -1037.5534089881423, -429.1305962784992, -1242.594993463176, -944.3479425046442, -306.116482612818, -497.0957953205323, -1346.755004644381, -454.6945234667543, -28.061482849436004, -1411.5895207773697, -1076.2617090584165, -1188.5632074211683, -685.3604748241403, -280.65257506005145, -686.0812092947209, -1092.6628234565692, -1012.4051879248617, -1082.7665174992364, -1068.1596304665404, -986.1713507814311, -221.18863735458132, -1049.590653172408]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2776526849700003, "mean_inference_ms": 0.8973969244335592, "mean_action_processing_ms": 0.15720089776817195, "mean_env_wait_ms": 1.5376317208114918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005352020263671875, "StateBufferConnector_ms": 0.0038466453552246094, "ViewRequirementAgentConnector_ms": 0.09755420684814453}, "num_episodes": 29, "episode_return_max": -28.061482849436004, "episode_return_min": -1411.5895207773697, "episode_return_mean": -702.2598158996939, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.35996530156694, "num_env_steps_trained_throughput_per_sec": 271.35996530156694, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 14990.979, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14990.903, "sample_time_ms": 2378.527, "learn_time_ms": 12595.413, "learn_throughput": 317.576, "synch_weights_time_ms": 16.127}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00006", "date": "2024-08-03_05-21-15", "timestamp": 1722642675, "time_this_iter_s": 14.747236967086792, "time_total_s": 164.94960737228394, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fda440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.94960737228394, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 12.938095238095238, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.24674440821012, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.1820519293348, "policy_loss": -0.006829744474089239, "vf_loss": 7.1848441476623215, "vf_explained_var": 0.8090579973533749, "kl": 0.013505071228458594, "entropy": 1.4003544254849354, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -24.050339282365172, "episode_reward_min": -1411.5895207773697, "episode_reward_mean": -698.1837969487725, "episode_len_mean": 138.22, "episode_media": {}, "episodes_timesteps_total": 13822, "policy_reward_min": {"policy_0": -1411.5895207773697}, "policy_reward_max": {"policy_0": -24.050339282365172}, "policy_reward_mean": {"policy_0": -698.1837969487725}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-373.4102343339812, -983.4334759748003, -246.71400981849655, -533.9569130881521, -898.9909089239293, -187.06833809642694, -451.15562201175067, -394.5641559855707, -794.0572942057286, -620.7063213134843, -726.2916064795546, -776.8130030204552, -651.2607777350645, -530.0999413972901, -467.6803222593624, -274.87454922573636, -592.7219197703173, -294.86558547335915, -512.7972984976245, -779.1932190501291, -689.6948135515878, -1102.2630857931272, -290.08877598461083, -1217.1535824355592, -913.012871857331, -854.5257138646095, -650.5458890794768, -436.4147200235767, -884.3172309393834, -1005.6093896999245, -401.8474161919999, -859.9328322689258, -982.9587834357224, -835.4030215296978, -735.3519313043364, -941.2936714894374, -663.3066753923447, -1241.3809137780477, -291.5166509490325, -829.216390140078, -954.1945335827272, -273.6800632061958, -514.189697465633, -652.8501668967864, -71.44480955591516, -475.8672078029447, -931.9063343587308, -1037.5534089881423, -429.1305962784992, -1242.594993463176, -944.3479425046442, -306.116482612818, -497.0957953205323, -1346.755004644381, -454.6945234667543, -28.061482849436004, -1411.5895207773697, -1076.2617090584165, -1188.5632074211683, -685.3604748241403, -280.65257506005145, -686.0812092947209, -1092.6628234565692, -1012.4051879248617, -1082.7665174992364, -1068.1596304665404, -986.1713507814311, -221.18863735458132, -1049.590653172408, -1012.5203996405698, -739.193843950028, -585.3544045326712, -49.945631406496695, -1113.8317616657707, -339.6509888248055, -796.80455384231, -124.05055181850133, -655.6002795163452, -823.4805365671044, -1047.5540092207289, -958.7576333933421, -763.1102886370331, -858.2585038218576, -725.2025548247199, -949.5108763905326, -134.42892896932898, -556.6757138094706, -24.050339282365172, -1037.7287254055784, -95.82127727553862, -354.7667343232977, -1146.0260872758984, -1093.9724822968221, -1027.2678344185708, -1053.64382205185, -377.3187506699901, -323.7236639133256, -160.21363382163418, -943.6147085001174, -1027.8737783518145], "episode_lengths": [109, 150, 103, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 128, 150, 107, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 106, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 98, 135, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 87, 117, 52, 150, 60, 113, 150, 150, 150, 150, 100, 150, 105, 150, 150], "policy_policy_0_reward": [-373.4102343339812, -983.4334759748003, -246.71400981849655, -533.9569130881521, -898.9909089239293, -187.06833809642694, -451.15562201175067, -394.5641559855707, -794.0572942057286, -620.7063213134843, -726.2916064795546, -776.8130030204552, -651.2607777350645, -530.0999413972901, -467.6803222593624, -274.87454922573636, -592.7219197703173, -294.86558547335915, -512.7972984976245, -779.1932190501291, -689.6948135515878, -1102.2630857931272, -290.08877598461083, -1217.1535824355592, -913.012871857331, -854.5257138646095, -650.5458890794768, -436.4147200235767, -884.3172309393834, -1005.6093896999245, -401.8474161919999, -859.9328322689258, -982.9587834357224, -835.4030215296978, -735.3519313043364, -941.2936714894374, -663.3066753923447, -1241.3809137780477, -291.5166509490325, -829.216390140078, -954.1945335827272, -273.6800632061958, -514.189697465633, -652.8501668967864, -71.44480955591516, -475.8672078029447, -931.9063343587308, -1037.5534089881423, -429.1305962784992, -1242.594993463176, -944.3479425046442, -306.116482612818, -497.0957953205323, -1346.755004644381, -454.6945234667543, -28.061482849436004, -1411.5895207773697, -1076.2617090584165, -1188.5632074211683, -685.3604748241403, -280.65257506005145, -686.0812092947209, -1092.6628234565692, -1012.4051879248617, -1082.7665174992364, -1068.1596304665404, -986.1713507814311, -221.18863735458132, -1049.590653172408, -1012.5203996405698, -739.193843950028, -585.3544045326712, -49.945631406496695, -1113.8317616657707, -339.6509888248055, -796.80455384231, -124.05055181850133, -655.6002795163452, -823.4805365671044, -1047.5540092207289, -958.7576333933421, -763.1102886370331, -858.2585038218576, -725.2025548247199, -949.5108763905326, -134.42892896932898, -556.6757138094706, -24.050339282365172, -1037.7287254055784, -95.82127727553862, -354.7667343232977, -1146.0260872758984, -1093.9724822968221, -1027.2678344185708, -1053.64382205185, -377.3187506699901, -323.7236639133256, -160.21363382163418, -943.6147085001174, -1027.8737783518145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2778615870130443, "mean_inference_ms": 0.8954322404720152, "mean_action_processing_ms": 0.15726839317300675, "mean_env_wait_ms": 1.540000962768092, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005258798599243164, "StateBufferConnector_ms": 0.0038747787475585938, "ViewRequirementAgentConnector_ms": 0.09863805770874023}, "num_episodes": 31, "episode_return_max": -24.050339282365172, "episode_return_min": -1411.5895207773697, "episode_return_mean": -698.1837969487725, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.60426434542177, "num_env_steps_trained_throughput_per_sec": 272.60426434542177, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 14972.817, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14972.743, "sample_time_ms": 2380.625, "learn_time_ms": 12574.887, "learn_throughput": 318.094, "synch_weights_time_ms": 16.385}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00006", "date": "2024-08-03_05-21-29", "timestamp": 1722642689, "time_this_iter_s": 14.681015729904175, "time_total_s": 179.6306231021881, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fdb010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 179.6306231021881, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.02, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.734860142072044, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.973511818051338, "policy_loss": -0.008143571051186882, "vf_loss": 6.97734796355168, "vf_explained_var": 0.8368776361768444, "kl": 0.014404985805352544, "entropy": 1.4083288727949064, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -15.843098965283106, "episode_reward_min": -1411.5895207773697, "episode_reward_mean": -686.9219419028534, "episode_len_mean": 133.06, "episode_media": {}, "episodes_timesteps_total": 13306, "policy_reward_min": {"policy_0": -1411.5895207773697}, "policy_reward_max": {"policy_0": -15.843098965283106}, "policy_reward_mean": {"policy_0": -686.9219419028534}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-735.3519313043364, -941.2936714894374, -663.3066753923447, -1241.3809137780477, -291.5166509490325, -829.216390140078, -954.1945335827272, -273.6800632061958, -514.189697465633, -652.8501668967864, -71.44480955591516, -475.8672078029447, -931.9063343587308, -1037.5534089881423, -429.1305962784992, -1242.594993463176, -944.3479425046442, -306.116482612818, -497.0957953205323, -1346.755004644381, -454.6945234667543, -28.061482849436004, -1411.5895207773697, -1076.2617090584165, -1188.5632074211683, -685.3604748241403, -280.65257506005145, -686.0812092947209, -1092.6628234565692, -1012.4051879248617, -1082.7665174992364, -1068.1596304665404, -986.1713507814311, -221.18863735458132, -1049.590653172408, -1012.5203996405698, -739.193843950028, -585.3544045326712, -49.945631406496695, -1113.8317616657707, -339.6509888248055, -796.80455384231, -124.05055181850133, -655.6002795163452, -823.4805365671044, -1047.5540092207289, -958.7576333933421, -763.1102886370331, -858.2585038218576, -725.2025548247199, -949.5108763905326, -134.42892896932898, -556.6757138094706, -24.050339282365172, -1037.7287254055784, -95.82127727553862, -354.7667343232977, -1146.0260872758984, -1093.9724822968221, -1027.2678344185708, -1053.64382205185, -377.3187506699901, -323.7236639133256, -160.21363382163418, -943.6147085001174, -1027.8737783518145, -105.98272711642926, -1247.6752694156648, -486.8132298856245, -151.39042461975873, -138.02253684746128, -111.22117011989499, -765.7839299603542, -518.4274163754985, -919.0704663269269, -75.29460214823452, -73.73643905940598, -1172.9363972056162, -478.6209535646493, -1114.791617874554, -726.5390739375468, -722.6630091896892, -384.921370149218, -1159.9899400098645, -87.57188212163842, -1025.4770821581628, -15.843098965283106, -838.0805647732794, -1082.8849301379782, -482.06396032812427, -202.32723133838837, -862.8807902755295, -1145.0319235591244, -333.06097777544375, -616.4064137383997, -704.1148536436848, -840.6753748810263, -1285.7595151813296, -195.3335109091613, -1016.8454351318982], "episode_lengths": [150, 150, 150, 150, 114, 150, 150, 98, 135, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 87, 117, 52, 150, 60, 113, 150, 150, 150, 150, 100, 150, 105, 150, 150, 64, 150, 150, 106, 81, 55, 150, 150, 150, 69, 80, 150, 150, 150, 150, 150, 150, 150, 74, 150, 46, 150, 150, 150, 84, 150, 150, 93, 150, 150, 150, 150, 64, 150], "policy_policy_0_reward": [-735.3519313043364, -941.2936714894374, -663.3066753923447, -1241.3809137780477, -291.5166509490325, -829.216390140078, -954.1945335827272, -273.6800632061958, -514.189697465633, -652.8501668967864, -71.44480955591516, -475.8672078029447, -931.9063343587308, -1037.5534089881423, -429.1305962784992, -1242.594993463176, -944.3479425046442, -306.116482612818, -497.0957953205323, -1346.755004644381, -454.6945234667543, -28.061482849436004, -1411.5895207773697, -1076.2617090584165, -1188.5632074211683, -685.3604748241403, -280.65257506005145, -686.0812092947209, -1092.6628234565692, -1012.4051879248617, -1082.7665174992364, -1068.1596304665404, -986.1713507814311, -221.18863735458132, -1049.590653172408, -1012.5203996405698, -739.193843950028, -585.3544045326712, -49.945631406496695, -1113.8317616657707, -339.6509888248055, -796.80455384231, -124.05055181850133, -655.6002795163452, -823.4805365671044, -1047.5540092207289, -958.7576333933421, -763.1102886370331, -858.2585038218576, -725.2025548247199, -949.5108763905326, -134.42892896932898, -556.6757138094706, -24.050339282365172, -1037.7287254055784, -95.82127727553862, -354.7667343232977, -1146.0260872758984, -1093.9724822968221, -1027.2678344185708, -1053.64382205185, -377.3187506699901, -323.7236639133256, -160.21363382163418, -943.6147085001174, -1027.8737783518145, -105.98272711642926, -1247.6752694156648, -486.8132298856245, -151.39042461975873, -138.02253684746128, -111.22117011989499, -765.7839299603542, -518.4274163754985, -919.0704663269269, -75.29460214823452, -73.73643905940598, -1172.9363972056162, -478.6209535646493, -1114.791617874554, -726.5390739375468, -722.6630091896892, -384.921370149218, -1159.9899400098645, -87.57188212163842, -1025.4770821581628, -15.843098965283106, -838.0805647732794, -1082.8849301379782, -482.06396032812427, -202.32723133838837, -862.8807902755295, -1145.0319235591244, -333.06097777544375, -616.4064137383997, -704.1148536436848, -840.6753748810263, -1285.7595151813296, -195.3335109091613, -1016.8454351318982]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2779695593097153, "mean_inference_ms": 0.8999539730905463, "mean_action_processing_ms": 0.1574676800883574, "mean_env_wait_ms": 1.545072897523189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005193471908569336, "StateBufferConnector_ms": 0.003939628601074219, "ViewRequirementAgentConnector_ms": 0.0991976261138916}, "num_episodes": 34, "episode_return_max": -15.843098965283106, "episode_return_min": -1411.5895207773697, "episode_return_mean": -686.9219419028534, "episodes_this_iter": 34}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.7960599215798, "num_env_steps_trained_throughput_per_sec": 263.7960599215798, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 14995.759, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14995.684, "sample_time_ms": 2409.32, "learn_time_ms": 12569.172, "learn_throughput": 318.239, "synch_weights_time_ms": 16.351}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00006", "date": "2024-08-03_05-21-45", "timestamp": 1722642705, "time_this_iter_s": 15.170707702636719, "time_total_s": 194.80133080482483, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8d83250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 194.80133080482483, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.350000000000001, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.32027744948864, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.6713849405447645, "policy_loss": -0.01457068297653071, "vf_loss": 6.680746819078922, "vf_explained_var": 0.8402220231170455, "kl": 0.017406913378181357, "entropy": 1.3290195555736621, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -15.843098965283106, "episode_reward_min": -1292.9381578664825, "episode_reward_mean": -672.3381313135578, "episode_len_mean": 130.82, "episode_media": {}, "episodes_timesteps_total": 13082, "policy_reward_min": {"policy_0": -1292.9381578664825}, "policy_reward_max": {"policy_0": -15.843098965283106}, "policy_reward_mean": {"policy_0": -672.3381313135578}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1092.6628234565692, -1012.4051879248617, -1082.7665174992364, -1068.1596304665404, -986.1713507814311, -221.18863735458132, -1049.590653172408, -1012.5203996405698, -739.193843950028, -585.3544045326712, -49.945631406496695, -1113.8317616657707, -339.6509888248055, -796.80455384231, -124.05055181850133, -655.6002795163452, -823.4805365671044, -1047.5540092207289, -958.7576333933421, -763.1102886370331, -858.2585038218576, -725.2025548247199, -949.5108763905326, -134.42892896932898, -556.6757138094706, -24.050339282365172, -1037.7287254055784, -95.82127727553862, -354.7667343232977, -1146.0260872758984, -1093.9724822968221, -1027.2678344185708, -1053.64382205185, -377.3187506699901, -323.7236639133256, -160.21363382163418, -943.6147085001174, -1027.8737783518145, -105.98272711642926, -1247.6752694156648, -486.8132298856245, -151.39042461975873, -138.02253684746128, -111.22117011989499, -765.7839299603542, -518.4274163754985, -919.0704663269269, -75.29460214823452, -73.73643905940598, -1172.9363972056162, -478.6209535646493, -1114.791617874554, -726.5390739375468, -722.6630091896892, -384.921370149218, -1159.9899400098645, -87.57188212163842, -1025.4770821581628, -15.843098965283106, -838.0805647732794, -1082.8849301379782, -482.06396032812427, -202.32723133838837, -862.8807902755295, -1145.0319235591244, -333.06097777544375, -616.4064137383997, -704.1148536436848, -840.6753748810263, -1285.7595151813296, -195.3335109091613, -1016.8454351318982, -338.6351926086307, -927.1018036280915, -723.1235096802532, -1292.9381578664825, -612.7235213707844, -310.13923877263124, -407.1522595456297, -971.834237246103, -420.17950858436683, -96.73462957754673, -343.6817185412631, -46.43254896505816, -875.833981504014, -838.4902268488916, -1072.5662982689446, -1184.7392445639553, -577.8049671214685, -211.8118997012616, -1121.0879181990308, -1063.692020605887, -91.14419431457009, -1081.7516211984937, -398.6706337981691, -792.0312771431417, -898.6606844766994, -128.6442108344654, -1065.9412631657206, -839.1301454253385], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 87, 117, 52, 150, 60, 113, 150, 150, 150, 150, 100, 150, 105, 150, 150, 64, 150, 150, 106, 81, 55, 150, 150, 150, 69, 80, 150, 150, 150, 150, 150, 150, 150, 74, 150, 46, 150, 150, 150, 84, 150, 150, 93, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 85, 150, 150, 124, 82, 112, 47, 150, 150, 150, 150, 150, 84, 150, 150, 68, 150, 150, 150, 150, 84, 150, 150], "policy_policy_0_reward": [-1092.6628234565692, -1012.4051879248617, -1082.7665174992364, -1068.1596304665404, -986.1713507814311, -221.18863735458132, -1049.590653172408, -1012.5203996405698, -739.193843950028, -585.3544045326712, -49.945631406496695, -1113.8317616657707, -339.6509888248055, -796.80455384231, -124.05055181850133, -655.6002795163452, -823.4805365671044, -1047.5540092207289, -958.7576333933421, -763.1102886370331, -858.2585038218576, -725.2025548247199, -949.5108763905326, -134.42892896932898, -556.6757138094706, -24.050339282365172, -1037.7287254055784, -95.82127727553862, -354.7667343232977, -1146.0260872758984, -1093.9724822968221, -1027.2678344185708, -1053.64382205185, -377.3187506699901, -323.7236639133256, -160.21363382163418, -943.6147085001174, -1027.8737783518145, -105.98272711642926, -1247.6752694156648, -486.8132298856245, -151.39042461975873, -138.02253684746128, -111.22117011989499, -765.7839299603542, -518.4274163754985, -919.0704663269269, -75.29460214823452, -73.73643905940598, -1172.9363972056162, -478.6209535646493, -1114.791617874554, -726.5390739375468, -722.6630091896892, -384.921370149218, -1159.9899400098645, -87.57188212163842, -1025.4770821581628, -15.843098965283106, -838.0805647732794, -1082.8849301379782, -482.06396032812427, -202.32723133838837, -862.8807902755295, -1145.0319235591244, -333.06097777544375, -616.4064137383997, -704.1148536436848, -840.6753748810263, -1285.7595151813296, -195.3335109091613, -1016.8454351318982, -338.6351926086307, -927.1018036280915, -723.1235096802532, -1292.9381578664825, -612.7235213707844, -310.13923877263124, -407.1522595456297, -971.834237246103, -420.17950858436683, -96.73462957754673, -343.6817185412631, -46.43254896505816, -875.833981504014, -838.4902268488916, -1072.5662982689446, -1184.7392445639553, -577.8049671214685, -211.8118997012616, -1121.0879181990308, -1063.692020605887, -91.14419431457009, -1081.7516211984937, -398.6706337981691, -792.0312771431417, -898.6606844766994, -128.6442108344654, -1065.9412631657206, -839.1301454253385]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.278124882552987, "mean_inference_ms": 0.9036050312737595, "mean_action_processing_ms": 0.1573927897988235, "mean_env_wait_ms": 1.5491313559058846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005031585693359375, "StateBufferConnector_ms": 0.0039806365966796875, "ViewRequirementAgentConnector_ms": 0.09932494163513184}, "num_episodes": 28, "episode_return_max": -15.843098965283106, "episode_return_min": -1292.9381578664825, "episode_return_mean": -672.3381313135578, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.17282207561846, "num_env_steps_trained_throughput_per_sec": 318.17282207561846, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 14755.992, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14755.917, "sample_time_ms": 2415.107, "learn_time_ms": 12324.263, "learn_throughput": 324.563, "synch_weights_time_ms": 15.711}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00006", "date": "2024-08-03_05-21-57", "timestamp": 1722642717, "time_this_iter_s": 12.579077243804932, "time_total_s": 207.38040804862976, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78e170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 207.38040804862976, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.411111111111111, "ram_util_percent": 19.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 63.54572318593661, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.080198949078719, "policy_loss": -0.008666385013687735, "vf_loss": 6.084420983990033, "vf_explained_var": 0.8726755620911717, "kl": 0.014864211370028612, "entropy": 1.492400298640132, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -15.843098965283106, "episode_reward_min": -1297.548979386931, "episode_reward_mean": -662.0910807308672, "episode_len_mean": 131.51, "episode_media": {}, "episodes_timesteps_total": 13151, "policy_reward_min": {"policy_0": -1297.548979386931}, "policy_reward_max": {"policy_0": -15.843098965283106}, "policy_reward_mean": {"policy_0": -662.0910807308672}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1027.2678344185708, -1053.64382205185, -377.3187506699901, -323.7236639133256, -160.21363382163418, -943.6147085001174, -1027.8737783518145, -105.98272711642926, -1247.6752694156648, -486.8132298856245, -151.39042461975873, -138.02253684746128, -111.22117011989499, -765.7839299603542, -518.4274163754985, -919.0704663269269, -75.29460214823452, -73.73643905940598, -1172.9363972056162, -478.6209535646493, -1114.791617874554, -726.5390739375468, -722.6630091896892, -384.921370149218, -1159.9899400098645, -87.57188212163842, -1025.4770821581628, -15.843098965283106, -838.0805647732794, -1082.8849301379782, -482.06396032812427, -202.32723133838837, -862.8807902755295, -1145.0319235591244, -333.06097777544375, -616.4064137383997, -704.1148536436848, -840.6753748810263, -1285.7595151813296, -195.3335109091613, -1016.8454351318982, -338.6351926086307, -927.1018036280915, -723.1235096802532, -1292.9381578664825, -612.7235213707844, -310.13923877263124, -407.1522595456297, -971.834237246103, -420.17950858436683, -96.73462957754673, -343.6817185412631, -46.43254896505816, -875.833981504014, -838.4902268488916, -1072.5662982689446, -1184.7392445639553, -577.8049671214685, -211.8118997012616, -1121.0879181990308, -1063.692020605887, -91.14419431457009, -1081.7516211984937, -398.6706337981691, -792.0312771431417, -898.6606844766994, -128.6442108344654, -1065.9412631657206, -839.1301454253385, -204.2678202227163, -980.7906055994783, -808.9288662134563, -1196.7121528315372, -862.7409951208477, -806.4640253593848, -786.9730912165028, -172.5744956939069, -1172.5863327422117, -1056.4691847428862, -665.0008096326387, -1020.4340805795696, -387.17538139239196, -1111.8005323465245, -1051.0850031652274, -203.90842964979421, -272.4744750209681, -830.0394982468827, -674.2025209372648, -511.39755063285435, -253.83114572189217, -627.307347608391, -585.0195280714947, -478.64460337745686, -888.8454309180961, -1297.548979386931, -764.5415621077163, -504.34048768274045, -439.7416365365632, -58.64486551831406, -800.0454108010532], "episode_lengths": [150, 150, 100, 150, 105, 150, 150, 64, 150, 150, 106, 81, 55, 150, 150, 150, 69, 80, 150, 150, 150, 150, 150, 150, 150, 74, 150, 46, 150, 150, 150, 84, 150, 150, 93, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 85, 150, 150, 124, 82, 112, 47, 150, 150, 150, 150, 150, 84, 150, 150, 68, 150, 150, 150, 150, 84, 150, 150, 115, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 69, 115, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 121, 54, 150], "policy_policy_0_reward": [-1027.2678344185708, -1053.64382205185, -377.3187506699901, -323.7236639133256, -160.21363382163418, -943.6147085001174, -1027.8737783518145, -105.98272711642926, -1247.6752694156648, -486.8132298856245, -151.39042461975873, -138.02253684746128, -111.22117011989499, -765.7839299603542, -518.4274163754985, -919.0704663269269, -75.29460214823452, -73.73643905940598, -1172.9363972056162, -478.6209535646493, -1114.791617874554, -726.5390739375468, -722.6630091896892, -384.921370149218, -1159.9899400098645, -87.57188212163842, -1025.4770821581628, -15.843098965283106, -838.0805647732794, -1082.8849301379782, -482.06396032812427, -202.32723133838837, -862.8807902755295, -1145.0319235591244, -333.06097777544375, -616.4064137383997, -704.1148536436848, -840.6753748810263, -1285.7595151813296, -195.3335109091613, -1016.8454351318982, -338.6351926086307, -927.1018036280915, -723.1235096802532, -1292.9381578664825, -612.7235213707844, -310.13923877263124, -407.1522595456297, -971.834237246103, -420.17950858436683, -96.73462957754673, -343.6817185412631, -46.43254896505816, -875.833981504014, -838.4902268488916, -1072.5662982689446, -1184.7392445639553, -577.8049671214685, -211.8118997012616, -1121.0879181990308, -1063.692020605887, -91.14419431457009, -1081.7516211984937, -398.6706337981691, -792.0312771431417, -898.6606844766994, -128.6442108344654, -1065.9412631657206, -839.1301454253385, -204.2678202227163, -980.7906055994783, -808.9288662134563, -1196.7121528315372, -862.7409951208477, -806.4640253593848, -786.9730912165028, -172.5744956939069, -1172.5863327422117, -1056.4691847428862, -665.0008096326387, -1020.4340805795696, -387.17538139239196, -1111.8005323465245, -1051.0850031652274, -203.90842964979421, -272.4744750209681, -830.0394982468827, -674.2025209372648, -511.39755063285435, -253.83114572189217, -627.307347608391, -585.0195280714947, -478.64460337745686, -888.8454309180961, -1297.548979386931, -764.5415621077163, -504.34048768274045, -439.7416365365632, -58.64486551831406, -800.0454108010532]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27822880786999854, "mean_inference_ms": 0.9073647353796765, "mean_action_processing_ms": 0.15740982083350608, "mean_env_wait_ms": 1.5533844301278645, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005143880844116211, "StateBufferConnector_ms": 0.0040264129638671875, "ViewRequirementAgentConnector_ms": 0.10018420219421387}, "num_episodes": 31, "episode_return_max": -15.843098965283106, "episode_return_min": -1297.548979386931, "episode_return_mean": -662.0910807308672, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.4142151473473, "num_env_steps_trained_throughput_per_sec": 311.4142151473473, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 14553.759, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14553.688, "sample_time_ms": 2421.08, "learn_time_ms": 12116.088, "learn_throughput": 330.14, "synch_weights_time_ms": 15.688}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00006", "date": "2024-08-03_05-22-10", "timestamp": 1722642730, "time_this_iter_s": 12.85414981842041, "time_total_s": 220.23455786705017, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8e200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 220.23455786705017, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 13.322222222222223, "ram_util_percent": 19.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 72.26454903781413, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.070737685014804, "policy_loss": -0.008837137480441015, "vf_loss": 6.074677827954292, "vf_explained_var": 0.8642061497395237, "kl": 0.01637124199954392, "entropy": 1.436438145612677, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -20.611499671043465, "episode_reward_min": -1551.1656088705813, "episode_reward_mean": -684.9533447308717, "episode_len_mean": 132.81, "episode_media": {}, "episodes_timesteps_total": 13281, "policy_reward_min": {"policy_0": -1551.1656088705813}, "policy_reward_max": {"policy_0": -20.611499671043465}, "policy_reward_mean": {"policy_0": -684.9533447308717}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1082.8849301379782, -482.06396032812427, -202.32723133838837, -862.8807902755295, -1145.0319235591244, -333.06097777544375, -616.4064137383997, -704.1148536436848, -840.6753748810263, -1285.7595151813296, -195.3335109091613, -1016.8454351318982, -338.6351926086307, -927.1018036280915, -723.1235096802532, -1292.9381578664825, -612.7235213707844, -310.13923877263124, -407.1522595456297, -971.834237246103, -420.17950858436683, -96.73462957754673, -343.6817185412631, -46.43254896505816, -875.833981504014, -838.4902268488916, -1072.5662982689446, -1184.7392445639553, -577.8049671214685, -211.8118997012616, -1121.0879181990308, -1063.692020605887, -91.14419431457009, -1081.7516211984937, -398.6706337981691, -792.0312771431417, -898.6606844766994, -128.6442108344654, -1065.9412631657206, -839.1301454253385, -204.2678202227163, -980.7906055994783, -808.9288662134563, -1196.7121528315372, -862.7409951208477, -806.4640253593848, -786.9730912165028, -172.5744956939069, -1172.5863327422117, -1056.4691847428862, -665.0008096326387, -1020.4340805795696, -387.17538139239196, -1111.8005323465245, -1051.0850031652274, -203.90842964979421, -272.4744750209681, -830.0394982468827, -674.2025209372648, -511.39755063285435, -253.83114572189217, -627.307347608391, -585.0195280714947, -478.64460337745686, -888.8454309180961, -1297.548979386931, -764.5415621077163, -504.34048768274045, -439.7416365365632, -58.64486551831406, -800.0454108010532, -620.8641585886836, -1071.4338660272151, -994.8154088498502, -20.611499671043465, -1308.6781294168682, -34.61969914512551, -608.1350509206189, -245.20369082161858, -842.2403296478923, -1126.6208282734167, -83.37111221711125, -1058.1235806604127, -816.2722100198456, -896.3031872644316, -256.6881213149866, -680.2707947332294, -429.8943059000719, -520.6914673780228, -181.06484086679336, -1551.1656088705813, -645.5059015264698, -1096.2213747256765, -1234.8913210845492, -106.11100441850691, -724.2412483485697, -733.6612468782233, -762.6681160997539, -769.8115492432141, -100.5561406397022], "episode_lengths": [150, 150, 84, 150, 150, 93, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 85, 150, 150, 124, 82, 112, 47, 150, 150, 150, 150, 150, 84, 150, 150, 68, 150, 150, 150, 150, 84, 150, 150, 115, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 69, 115, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 121, 54, 150, 150, 150, 150, 43, 150, 55, 150, 91, 150, 150, 81, 150, 150, 150, 86, 145, 150, 149, 119, 150, 150, 150, 150, 60, 150, 150, 150, 150, 81], "policy_policy_0_reward": [-1082.8849301379782, -482.06396032812427, -202.32723133838837, -862.8807902755295, -1145.0319235591244, -333.06097777544375, -616.4064137383997, -704.1148536436848, -840.6753748810263, -1285.7595151813296, -195.3335109091613, -1016.8454351318982, -338.6351926086307, -927.1018036280915, -723.1235096802532, -1292.9381578664825, -612.7235213707844, -310.13923877263124, -407.1522595456297, -971.834237246103, -420.17950858436683, -96.73462957754673, -343.6817185412631, -46.43254896505816, -875.833981504014, -838.4902268488916, -1072.5662982689446, -1184.7392445639553, -577.8049671214685, -211.8118997012616, -1121.0879181990308, -1063.692020605887, -91.14419431457009, -1081.7516211984937, -398.6706337981691, -792.0312771431417, -898.6606844766994, -128.6442108344654, -1065.9412631657206, -839.1301454253385, -204.2678202227163, -980.7906055994783, -808.9288662134563, -1196.7121528315372, -862.7409951208477, -806.4640253593848, -786.9730912165028, -172.5744956939069, -1172.5863327422117, -1056.4691847428862, -665.0008096326387, -1020.4340805795696, -387.17538139239196, -1111.8005323465245, -1051.0850031652274, -203.90842964979421, -272.4744750209681, -830.0394982468827, -674.2025209372648, -511.39755063285435, -253.83114572189217, -627.307347608391, -585.0195280714947, -478.64460337745686, -888.8454309180961, -1297.548979386931, -764.5415621077163, -504.34048768274045, -439.7416365365632, -58.64486551831406, -800.0454108010532, -620.8641585886836, -1071.4338660272151, -994.8154088498502, -20.611499671043465, -1308.6781294168682, -34.61969914512551, -608.1350509206189, -245.20369082161858, -842.2403296478923, -1126.6208282734167, -83.37111221711125, -1058.1235806604127, -816.2722100198456, -896.3031872644316, -256.6881213149866, -680.2707947332294, -429.8943059000719, -520.6914673780228, -181.06484086679336, -1551.1656088705813, -645.5059015264698, -1096.2213747256765, -1234.8913210845492, -106.11100441850691, -724.2412483485697, -733.6612468782233, -762.6681160997539, -769.8115492432141, -100.5561406397022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2782240907857902, "mean_inference_ms": 0.9054810305135561, "mean_action_processing_ms": 0.15723077130979182, "mean_env_wait_ms": 1.5563751045718703, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005262613296508789, "StateBufferConnector_ms": 0.0039441585540771484, "ViewRequirementAgentConnector_ms": 0.09883785247802734}, "num_episodes": 29, "episode_return_max": -20.611499671043465, "episode_return_min": -1551.1656088705813, "episode_return_mean": -684.9533447308717, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.65568248624623, "num_env_steps_trained_throughput_per_sec": 282.65568248624623, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 14460.822, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14460.747, "sample_time_ms": 2438.754, "learn_time_ms": 12005.257, "learn_throughput": 333.187, "synch_weights_time_ms": 15.893}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00006", "date": "2024-08-03_05-22-24", "timestamp": 1722642744, "time_this_iter_s": 14.159135341644287, "time_total_s": 234.39369320869446, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8e680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 234.39369320869446, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.933333333333332, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70.82404718697072, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.628909860303005, "policy_loss": -0.011188557417093155, "vf_loss": 5.6348778188228605, "vf_explained_var": 0.9012097104142109, "kl": 0.01744423585129579, "entropy": 1.2656508086870113, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -20.611499671043465, "episode_reward_min": -1551.1656088705813, "episode_reward_mean": -675.4159173496627, "episode_len_mean": 134.58, "episode_media": {}, "episodes_timesteps_total": 13458, "policy_reward_min": {"policy_0": -1551.1656088705813}, "policy_reward_max": {"policy_0": -20.611499671043465}, "policy_reward_mean": {"policy_0": -675.4159173496627}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1121.0879181990308, -1063.692020605887, -91.14419431457009, -1081.7516211984937, -398.6706337981691, -792.0312771431417, -898.6606844766994, -128.6442108344654, -1065.9412631657206, -839.1301454253385, -204.2678202227163, -980.7906055994783, -808.9288662134563, -1196.7121528315372, -862.7409951208477, -806.4640253593848, -786.9730912165028, -172.5744956939069, -1172.5863327422117, -1056.4691847428862, -665.0008096326387, -1020.4340805795696, -387.17538139239196, -1111.8005323465245, -1051.0850031652274, -203.90842964979421, -272.4744750209681, -830.0394982468827, -674.2025209372648, -511.39755063285435, -253.83114572189217, -627.307347608391, -585.0195280714947, -478.64460337745686, -888.8454309180961, -1297.548979386931, -764.5415621077163, -504.34048768274045, -439.7416365365632, -58.64486551831406, -800.0454108010532, -620.8641585886836, -1071.4338660272151, -994.8154088498502, -20.611499671043465, -1308.6781294168682, -34.61969914512551, -608.1350509206189, -245.20369082161858, -842.2403296478923, -1126.6208282734167, -83.37111221711125, -1058.1235806604127, -816.2722100198456, -896.3031872644316, -256.6881213149866, -680.2707947332294, -429.8943059000719, -520.6914673780228, -181.06484086679336, -1551.1656088705813, -645.5059015264698, -1096.2213747256765, -1234.8913210845492, -106.11100441850691, -724.2412483485697, -733.6612468782233, -762.6681160997539, -769.8115492432141, -100.5561406397022, -773.1021926514381, -638.7460750194555, -928.7766613080988, -1056.6876097384647, -603.7611860467337, -854.4858670850543, -138.3751208361771, -556.6391900525501, -991.9952592042565, -1269.986677118929, -1146.7625898207746, -263.7541795134074, -418.7538961426022, -836.4974939617655, -425.7744619689143, -850.674491109638, -697.8645440729717, -575.6847368023391, -511.86619275332515, -940.5900392749595, -52.19419863481674, -1028.0455238508619, -397.101972495696, -730.1018053015533, -515.0735341735917, -574.5542951829932, -309.03790018012836, -337.48252713733865, -166.73846187366507, -474.4564398620594], "episode_lengths": [150, 150, 68, 150, 150, 150, 150, 84, 150, 150, 115, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 69, 115, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 121, 54, 150, 150, 150, 150, 43, 150, 55, 150, 91, 150, 150, 81, 150, 150, 150, 86, 145, 150, 149, 119, 150, 150, 150, 150, 60, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 106, 112, 150, 107, 150, 150, 150, 118, 150, 72, 150, 150, 150, 150, 150, 150, 91, 101, 150], "policy_policy_0_reward": [-1121.0879181990308, -1063.692020605887, -91.14419431457009, -1081.7516211984937, -398.6706337981691, -792.0312771431417, -898.6606844766994, -128.6442108344654, -1065.9412631657206, -839.1301454253385, -204.2678202227163, -980.7906055994783, -808.9288662134563, -1196.7121528315372, -862.7409951208477, -806.4640253593848, -786.9730912165028, -172.5744956939069, -1172.5863327422117, -1056.4691847428862, -665.0008096326387, -1020.4340805795696, -387.17538139239196, -1111.8005323465245, -1051.0850031652274, -203.90842964979421, -272.4744750209681, -830.0394982468827, -674.2025209372648, -511.39755063285435, -253.83114572189217, -627.307347608391, -585.0195280714947, -478.64460337745686, -888.8454309180961, -1297.548979386931, -764.5415621077163, -504.34048768274045, -439.7416365365632, -58.64486551831406, -800.0454108010532, -620.8641585886836, -1071.4338660272151, -994.8154088498502, -20.611499671043465, -1308.6781294168682, -34.61969914512551, -608.1350509206189, -245.20369082161858, -842.2403296478923, -1126.6208282734167, -83.37111221711125, -1058.1235806604127, -816.2722100198456, -896.3031872644316, -256.6881213149866, -680.2707947332294, -429.8943059000719, -520.6914673780228, -181.06484086679336, -1551.1656088705813, -645.5059015264698, -1096.2213747256765, -1234.8913210845492, -106.11100441850691, -724.2412483485697, -733.6612468782233, -762.6681160997539, -769.8115492432141, -100.5561406397022, -773.1021926514381, -638.7460750194555, -928.7766613080988, -1056.6876097384647, -603.7611860467337, -854.4858670850543, -138.3751208361771, -556.6391900525501, -991.9952592042565, -1269.986677118929, -1146.7625898207746, -263.7541795134074, -418.7538961426022, -836.4974939617655, -425.7744619689143, -850.674491109638, -697.8645440729717, -575.6847368023391, -511.86619275332515, -940.5900392749595, -52.19419863481674, -1028.0455238508619, -397.101972495696, -730.1018053015533, -515.0735341735917, -574.5542951829932, -309.03790018012836, -337.48252713733865, -166.73846187366507, -474.4564398620594]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2782183534741824, "mean_inference_ms": 0.9036376369709077, "mean_action_processing_ms": 0.15729022424833494, "mean_env_wait_ms": 1.5582214393340543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005455493927001953, "StateBufferConnector_ms": 0.003976345062255859, "ViewRequirementAgentConnector_ms": 0.09991741180419922}, "num_episodes": 30, "episode_return_max": -20.611499671043465, "episode_return_min": -1551.1656088705813, "episode_return_mean": -675.4159173496627, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.5563906231641, "num_env_steps_trained_throughput_per_sec": 333.5563906231641, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 14126.429, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14126.352, "sample_time_ms": 2428.879, "learn_time_ms": 11681.301, "learn_throughput": 342.428, "synch_weights_time_ms": 15.336}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00006", "date": "2024-08-03_05-22-36", "timestamp": 1722642756, "time_this_iter_s": 11.999624490737915, "time_total_s": 246.39331769943237, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8d83250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 246.39331769943237, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.600000000000001, "ram_util_percent": 19.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 81.0767843991518, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.821765897423029, "policy_loss": -0.007860827253413543, "vf_loss": 5.825207251061996, "vf_explained_var": 0.8873841899136702, "kl": 0.014777195172609956, "entropy": 1.3673378699769576, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -2.0115741555099884, "episode_reward_min": -1551.1656088705813, "episode_reward_mean": -637.6550927420341, "episode_len_mean": 131.66, "episode_media": {}, "episodes_timesteps_total": 13166, "policy_reward_min": {"policy_0": -1551.1656088705813}, "policy_reward_max": {"policy_0": -2.0115741555099884}, "policy_reward_mean": {"policy_0": -637.6550927420341}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-627.307347608391, -585.0195280714947, -478.64460337745686, -888.8454309180961, -1297.548979386931, -764.5415621077163, -504.34048768274045, -439.7416365365632, -58.64486551831406, -800.0454108010532, -620.8641585886836, -1071.4338660272151, -994.8154088498502, -20.611499671043465, -1308.6781294168682, -34.61969914512551, -608.1350509206189, -245.20369082161858, -842.2403296478923, -1126.6208282734167, -83.37111221711125, -1058.1235806604127, -816.2722100198456, -896.3031872644316, -256.6881213149866, -680.2707947332294, -429.8943059000719, -520.6914673780228, -181.06484086679336, -1551.1656088705813, -645.5059015264698, -1096.2213747256765, -1234.8913210845492, -106.11100441850691, -724.2412483485697, -733.6612468782233, -762.6681160997539, -769.8115492432141, -100.5561406397022, -773.1021926514381, -638.7460750194555, -928.7766613080988, -1056.6876097384647, -603.7611860467337, -854.4858670850543, -138.3751208361771, -556.6391900525501, -991.9952592042565, -1269.986677118929, -1146.7625898207746, -263.7541795134074, -418.7538961426022, -836.4974939617655, -425.7744619689143, -850.674491109638, -697.8645440729717, -575.6847368023391, -511.86619275332515, -940.5900392749595, -52.19419863481674, -1028.0455238508619, -397.101972495696, -730.1018053015533, -515.0735341735917, -574.5542951829932, -309.03790018012836, -337.48252713733865, -166.73846187366507, -474.4564398620594, -391.8741591258888, -174.0428964274632, -328.58448844551936, -1234.3984745306566, -396.6853846363374, -1330.0072849554697, -692.5428089247284, -177.2120295612576, -546.3846751203814, -663.7974346291552, -914.9139423574773, -676.1017570206623, -1123.757636524684, -159.1618372944267, -513.6253316841038, -422.54699817004183, -139.30657299178122, -846.4829052501638, -930.1161915192815, -736.4971687989399, -1068.1071584491278, -1383.342295990314, -742.3569777466455, -22.946855078830016, -527.0014405985866, -623.2126187314956, -580.4345556016978, -182.05992390428298, -846.0464363220589, -358.9686909206308, -2.0115741555099884], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 121, 54, 150, 150, 150, 150, 43, 150, 55, 150, 91, 150, 150, 81, 150, 150, 150, 86, 145, 150, 149, 119, 150, 150, 150, 150, 60, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 106, 112, 150, 107, 150, 150, 150, 118, 150, 72, 150, 150, 150, 150, 150, 150, 91, 101, 150, 114, 71, 138, 150, 132, 150, 150, 74, 124, 150, 150, 150, 150, 97, 150, 150, 63, 150, 150, 150, 150, 150, 150, 51, 140, 150, 120, 65, 150, 150, 40], "policy_policy_0_reward": [-627.307347608391, -585.0195280714947, -478.64460337745686, -888.8454309180961, -1297.548979386931, -764.5415621077163, -504.34048768274045, -439.7416365365632, -58.64486551831406, -800.0454108010532, -620.8641585886836, -1071.4338660272151, -994.8154088498502, -20.611499671043465, -1308.6781294168682, -34.61969914512551, -608.1350509206189, -245.20369082161858, -842.2403296478923, -1126.6208282734167, -83.37111221711125, -1058.1235806604127, -816.2722100198456, -896.3031872644316, -256.6881213149866, -680.2707947332294, -429.8943059000719, -520.6914673780228, -181.06484086679336, -1551.1656088705813, -645.5059015264698, -1096.2213747256765, -1234.8913210845492, -106.11100441850691, -724.2412483485697, -733.6612468782233, -762.6681160997539, -769.8115492432141, -100.5561406397022, -773.1021926514381, -638.7460750194555, -928.7766613080988, -1056.6876097384647, -603.7611860467337, -854.4858670850543, -138.3751208361771, -556.6391900525501, -991.9952592042565, -1269.986677118929, -1146.7625898207746, -263.7541795134074, -418.7538961426022, -836.4974939617655, -425.7744619689143, -850.674491109638, -697.8645440729717, -575.6847368023391, -511.86619275332515, -940.5900392749595, -52.19419863481674, -1028.0455238508619, -397.101972495696, -730.1018053015533, -515.0735341735917, -574.5542951829932, -309.03790018012836, -337.48252713733865, -166.73846187366507, -474.4564398620594, -391.8741591258888, -174.0428964274632, -328.58448844551936, -1234.3984745306566, -396.6853846363374, -1330.0072849554697, -692.5428089247284, -177.2120295612576, -546.3846751203814, -663.7974346291552, -914.9139423574773, -676.1017570206623, -1123.757636524684, -159.1618372944267, -513.6253316841038, -422.54699817004183, -139.30657299178122, -846.4829052501638, -930.1161915192815, -736.4971687989399, -1068.1071584491278, -1383.342295990314, -742.3569777466455, -22.946855078830016, -527.0014405985866, -623.2126187314956, -580.4345556016978, -182.05992390428298, -846.0464363220589, -358.9686909206308, -2.0115741555099884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27831821834284826, "mean_inference_ms": 0.9020232529647615, "mean_action_processing_ms": 0.15737181649944953, "mean_env_wait_ms": 1.5603722604797485, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056383609771728516, "StateBufferConnector_ms": 0.003940582275390625, "ViewRequirementAgentConnector_ms": 0.09976506233215332}, "num_episodes": 31, "episode_return_max": -2.0115741555099884, "episode_return_min": -1551.1656088705813, "episode_return_mean": -637.6550927420341, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.9968364581464, "num_env_steps_trained_throughput_per_sec": 288.9968364581464, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13980.754, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13980.679, "sample_time_ms": 2416.706, "learn_time_ms": 11547.814, "learn_throughput": 346.386, "synch_weights_time_ms": 15.322}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00006", "date": "2024-08-03_05-22-50", "timestamp": 1722642770, "time_this_iter_s": 13.850691556930542, "time_total_s": 260.2440092563629, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0e170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 260.2440092563629, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.263157894736842, "ram_util_percent": 19.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.65221832195918, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.238318929324548, "policy_loss": -0.00760434386805476, "vf_loss": 5.240882749855518, "vf_explained_var": 0.9477481482550502, "kl": 0.016846822071784142, "entropy": 1.3527308161060014, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -2.0115741555099884, "episode_reward_min": -1410.8846319429176, "episode_reward_mean": -637.3182173600854, "episode_len_mean": 130.36, "episode_media": {}, "episodes_timesteps_total": 13036, "policy_reward_min": {"policy_0": -1410.8846319429176}, "policy_reward_max": {"policy_0": -2.0115741555099884}, "policy_reward_mean": {"policy_0": -637.3182173600854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1234.8913210845492, -106.11100441850691, -724.2412483485697, -733.6612468782233, -762.6681160997539, -769.8115492432141, -100.5561406397022, -773.1021926514381, -638.7460750194555, -928.7766613080988, -1056.6876097384647, -603.7611860467337, -854.4858670850543, -138.3751208361771, -556.6391900525501, -991.9952592042565, -1269.986677118929, -1146.7625898207746, -263.7541795134074, -418.7538961426022, -836.4974939617655, -425.7744619689143, -850.674491109638, -697.8645440729717, -575.6847368023391, -511.86619275332515, -940.5900392749595, -52.19419863481674, -1028.0455238508619, -397.101972495696, -730.1018053015533, -515.0735341735917, -574.5542951829932, -309.03790018012836, -337.48252713733865, -166.73846187366507, -474.4564398620594, -391.8741591258888, -174.0428964274632, -328.58448844551936, -1234.3984745306566, -396.6853846363374, -1330.0072849554697, -692.5428089247284, -177.2120295612576, -546.3846751203814, -663.7974346291552, -914.9139423574773, -676.1017570206623, -1123.757636524684, -159.1618372944267, -513.6253316841038, -422.54699817004183, -139.30657299178122, -846.4829052501638, -930.1161915192815, -736.4971687989399, -1068.1071584491278, -1383.342295990314, -742.3569777466455, -22.946855078830016, -527.0014405985866, -623.2126187314956, -580.4345556016978, -182.05992390428298, -846.0464363220589, -358.9686909206308, -2.0115741555099884, -1410.8846319429176, -766.5623396723905, -144.47956095391697, -1013.2462747001123, -1160.4555682337761, -868.6001034527064, -680.4009314236501, -1067.1081525529485, -239.0956232347998, -146.16874440630133, -1145.5604120279102, -521.1795526887162, -873.5691875662739, -24.321934631116296, -616.0969469377713, -1084.2697170697484, -1149.5861798540634, -102.26599766399383, -133.94421322202544, -463.6609272950892, -590.0811049469204, -651.138390124339, -600.3433674176131, -207.33068721113622, -1193.5831480870013, -1014.8813787036428, -843.4584166294931, -711.2644187215661, -244.96720310765224, -43.82667466483287, -963.7921357914793, -823.6635557179533], "episode_lengths": [150, 60, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 106, 112, 150, 107, 150, 150, 150, 118, 150, 72, 150, 150, 150, 150, 150, 150, 91, 101, 150, 114, 71, 138, 150, 132, 150, 150, 74, 124, 150, 150, 150, 150, 97, 150, 150, 63, 150, 150, 150, 150, 150, 150, 51, 140, 150, 120, 65, 150, 150, 40, 150, 150, 84, 150, 150, 150, 150, 150, 108, 89, 150, 150, 150, 49, 150, 150, 150, 86, 60, 106, 150, 150, 150, 91, 150, 150, 150, 150, 86, 55, 150, 150], "policy_policy_0_reward": [-1234.8913210845492, -106.11100441850691, -724.2412483485697, -733.6612468782233, -762.6681160997539, -769.8115492432141, -100.5561406397022, -773.1021926514381, -638.7460750194555, -928.7766613080988, -1056.6876097384647, -603.7611860467337, -854.4858670850543, -138.3751208361771, -556.6391900525501, -991.9952592042565, -1269.986677118929, -1146.7625898207746, -263.7541795134074, -418.7538961426022, -836.4974939617655, -425.7744619689143, -850.674491109638, -697.8645440729717, -575.6847368023391, -511.86619275332515, -940.5900392749595, -52.19419863481674, -1028.0455238508619, -397.101972495696, -730.1018053015533, -515.0735341735917, -574.5542951829932, -309.03790018012836, -337.48252713733865, -166.73846187366507, -474.4564398620594, -391.8741591258888, -174.0428964274632, -328.58448844551936, -1234.3984745306566, -396.6853846363374, -1330.0072849554697, -692.5428089247284, -177.2120295612576, -546.3846751203814, -663.7974346291552, -914.9139423574773, -676.1017570206623, -1123.757636524684, -159.1618372944267, -513.6253316841038, -422.54699817004183, -139.30657299178122, -846.4829052501638, -930.1161915192815, -736.4971687989399, -1068.1071584491278, -1383.342295990314, -742.3569777466455, -22.946855078830016, -527.0014405985866, -623.2126187314956, -580.4345556016978, -182.05992390428298, -846.0464363220589, -358.9686909206308, -2.0115741555099884, -1410.8846319429176, -766.5623396723905, -144.47956095391697, -1013.2462747001123, -1160.4555682337761, -868.6001034527064, -680.4009314236501, -1067.1081525529485, -239.0956232347998, -146.16874440630133, -1145.5604120279102, -521.1795526887162, -873.5691875662739, -24.321934631116296, -616.0969469377713, -1084.2697170697484, -1149.5861798540634, -102.26599766399383, -133.94421322202544, -463.6609272950892, -590.0811049469204, -651.138390124339, -600.3433674176131, -207.33068721113622, -1193.5831480870013, -1014.8813787036428, -843.4584166294931, -711.2644187215661, -244.96720310765224, -43.82667466483287, -963.7921357914793, -823.6635557179533]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2784049241330041, "mean_inference_ms": 0.9007188953048256, "mean_action_processing_ms": 0.15741501587264467, "mean_env_wait_ms": 1.561819804845116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005677700042724609, "StateBufferConnector_ms": 0.003930330276489258, "ViewRequirementAgentConnector_ms": 0.09938406944274902}, "num_episodes": 32, "episode_return_max": -2.0115741555099884, "episode_return_min": -1410.8846319429176, "episode_return_mean": -637.3182173600854, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.9630723003205, "num_env_steps_trained_throughput_per_sec": 259.9630723003205, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 14037.347, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14037.271, "sample_time_ms": 2424.437, "learn_time_ms": 11596.85, "learn_throughput": 344.921, "synch_weights_time_ms": 15.152}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00006", "date": "2024-08-03_05-23-06", "timestamp": 1722642786, "time_this_iter_s": 15.394488096237183, "time_total_s": 275.6384973526001, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b83eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 275.6384973526001, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 12.822727272727274, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 127.93871164520581, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.971792431424062, "policy_loss": -0.006259145077395564, "vf_loss": 4.973033534735441, "vf_explained_var": 0.9673046035692096, "kl": 0.016771727354004447, "entropy": 1.3476945241292317, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -2.0115741555099884, "episode_reward_min": -1410.8846319429176, "episode_reward_mean": -628.4957991103896, "episode_len_mean": 128.74, "episode_media": {}, "episodes_timesteps_total": 12874, "policy_reward_min": {"policy_0": -1410.8846319429176}, "policy_reward_max": {"policy_0": -2.0115741555099884}, "policy_reward_mean": {"policy_0": -628.4957991103896}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-730.1018053015533, -515.0735341735917, -574.5542951829932, -309.03790018012836, -337.48252713733865, -166.73846187366507, -474.4564398620594, -391.8741591258888, -174.0428964274632, -328.58448844551936, -1234.3984745306566, -396.6853846363374, -1330.0072849554697, -692.5428089247284, -177.2120295612576, -546.3846751203814, -663.7974346291552, -914.9139423574773, -676.1017570206623, -1123.757636524684, -159.1618372944267, -513.6253316841038, -422.54699817004183, -139.30657299178122, -846.4829052501638, -930.1161915192815, -736.4971687989399, -1068.1071584491278, -1383.342295990314, -742.3569777466455, -22.946855078830016, -527.0014405985866, -623.2126187314956, -580.4345556016978, -182.05992390428298, -846.0464363220589, -358.9686909206308, -2.0115741555099884, -1410.8846319429176, -766.5623396723905, -144.47956095391697, -1013.2462747001123, -1160.4555682337761, -868.6001034527064, -680.4009314236501, -1067.1081525529485, -239.0956232347998, -146.16874440630133, -1145.5604120279102, -521.1795526887162, -873.5691875662739, -24.321934631116296, -616.0969469377713, -1084.2697170697484, -1149.5861798540634, -102.26599766399383, -133.94421322202544, -463.6609272950892, -590.0811049469204, -651.138390124339, -600.3433674176131, -207.33068721113622, -1193.5831480870013, -1014.8813787036428, -843.4584166294931, -711.2644187215661, -244.96720310765224, -43.82667466483287, -963.7921357914793, -823.6635557179533, -704.9045366935336, -140.98618053634985, -667.7617798175902, -6.130990093531581, -1224.3894007582028, -974.5731679992987, -145.67665093699696, -1171.9934553943224, -1007.7098051902311, -985.0059870515117, -743.1753124227836, -656.1728314865655, -953.8649273132567, -881.3539388661698, -597.5344323582751, -1069.4792368316496, -1129.843798749613, -204.59812907079265, -389.66415066988714, -151.47152369402957, -749.1263392726279, -139.6907043472717, -140.91109950049088, -590.5924839629066, -238.17325356051558, -785.5658402963578, -1044.4744992623998, -498.07989832338893, -824.9943594602641, -689.9202472853559], "episode_lengths": [150, 150, 150, 150, 91, 101, 150, 114, 71, 138, 150, 132, 150, 150, 74, 124, 150, 150, 150, 150, 97, 150, 150, 63, 150, 150, 150, 150, 150, 150, 51, 140, 150, 120, 65, 150, 150, 40, 150, 150, 84, 150, 150, 150, 150, 150, 108, 89, 150, 150, 150, 49, 150, 150, 150, 86, 60, 106, 150, 150, 150, 91, 150, 150, 150, 150, 86, 55, 150, 150, 150, 93, 150, 37, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 100, 68, 150, 84, 80, 150, 100, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-730.1018053015533, -515.0735341735917, -574.5542951829932, -309.03790018012836, -337.48252713733865, -166.73846187366507, -474.4564398620594, -391.8741591258888, -174.0428964274632, -328.58448844551936, -1234.3984745306566, -396.6853846363374, -1330.0072849554697, -692.5428089247284, -177.2120295612576, -546.3846751203814, -663.7974346291552, -914.9139423574773, -676.1017570206623, -1123.757636524684, -159.1618372944267, -513.6253316841038, -422.54699817004183, -139.30657299178122, -846.4829052501638, -930.1161915192815, -736.4971687989399, -1068.1071584491278, -1383.342295990314, -742.3569777466455, -22.946855078830016, -527.0014405985866, -623.2126187314956, -580.4345556016978, -182.05992390428298, -846.0464363220589, -358.9686909206308, -2.0115741555099884, -1410.8846319429176, -766.5623396723905, -144.47956095391697, -1013.2462747001123, -1160.4555682337761, -868.6001034527064, -680.4009314236501, -1067.1081525529485, -239.0956232347998, -146.16874440630133, -1145.5604120279102, -521.1795526887162, -873.5691875662739, -24.321934631116296, -616.0969469377713, -1084.2697170697484, -1149.5861798540634, -102.26599766399383, -133.94421322202544, -463.6609272950892, -590.0811049469204, -651.138390124339, -600.3433674176131, -207.33068721113622, -1193.5831480870013, -1014.8813787036428, -843.4584166294931, -711.2644187215661, -244.96720310765224, -43.82667466483287, -963.7921357914793, -823.6635557179533, -704.9045366935336, -140.98618053634985, -667.7617798175902, -6.130990093531581, -1224.3894007582028, -974.5731679992987, -145.67665093699696, -1171.9934553943224, -1007.7098051902311, -985.0059870515117, -743.1753124227836, -656.1728314865655, -953.8649273132567, -881.3539388661698, -597.5344323582751, -1069.4792368316496, -1129.843798749613, -204.59812907079265, -389.66415066988714, -151.47152369402957, -749.1263392726279, -139.6907043472717, -140.91109950049088, -590.5924839629066, -238.17325356051558, -785.5658402963578, -1044.4744992623998, -498.07989832338893, -824.9943594602641, -689.9202472853559]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2785249283342287, "mean_inference_ms": 0.8999222603074745, "mean_action_processing_ms": 0.15751635001322822, "mean_env_wait_ms": 1.5631390471467534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005593538284301758, "StateBufferConnector_ms": 0.003871917724609375, "ViewRequirementAgentConnector_ms": 0.09860444068908691}, "num_episodes": 30, "episode_return_max": -2.0115741555099884, "episode_return_min": -1410.8846319429176, "episode_return_mean": -628.4957991103896, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.11590104357225, "num_env_steps_trained_throughput_per_sec": 270.11590104357225, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 14017.336, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14017.261, "sample_time_ms": 2425.232, "learn_time_ms": 11575.926, "learn_throughput": 345.545, "synch_weights_time_ms": 15.26}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00006", "date": "2024-08-03_05-23-21", "timestamp": 1722642801, "time_this_iter_s": 14.816708326339722, "time_total_s": 290.4552056789398, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b83e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 290.4552056789398, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.05238095238095, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 105.33887392481168, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.19077564800779, "policy_loss": -0.003484356094850227, "vf_loss": 5.190131105979284, "vf_explained_var": 0.9019567913686236, "kl": 0.013815602786780824, "entropy": 1.5785231065005063, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -2.0115741555099884, "episode_reward_min": -1437.2227852123979, "episode_reward_mean": -683.6214540638972, "episode_len_mean": 130.26, "episode_media": {}, "episodes_timesteps_total": 13026, "policy_reward_min": {"policy_0": -1437.2227852123979}, "policy_reward_max": {"policy_0": -2.0115741555099884}, "policy_reward_mean": {"policy_0": -683.6214540638972}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-742.3569777466455, -22.946855078830016, -527.0014405985866, -623.2126187314956, -580.4345556016978, -182.05992390428298, -846.0464363220589, -358.9686909206308, -2.0115741555099884, -1410.8846319429176, -766.5623396723905, -144.47956095391697, -1013.2462747001123, -1160.4555682337761, -868.6001034527064, -680.4009314236501, -1067.1081525529485, -239.0956232347998, -146.16874440630133, -1145.5604120279102, -521.1795526887162, -873.5691875662739, -24.321934631116296, -616.0969469377713, -1084.2697170697484, -1149.5861798540634, -102.26599766399383, -133.94421322202544, -463.6609272950892, -590.0811049469204, -651.138390124339, -600.3433674176131, -207.33068721113622, -1193.5831480870013, -1014.8813787036428, -843.4584166294931, -711.2644187215661, -244.96720310765224, -43.82667466483287, -963.7921357914793, -823.6635557179533, -704.9045366935336, -140.98618053634985, -667.7617798175902, -6.130990093531581, -1224.3894007582028, -974.5731679992987, -145.67665093699696, -1171.9934553943224, -1007.7098051902311, -985.0059870515117, -743.1753124227836, -656.1728314865655, -953.8649273132567, -881.3539388661698, -597.5344323582751, -1069.4792368316496, -1129.843798749613, -204.59812907079265, -389.66415066988714, -151.47152369402957, -749.1263392726279, -139.6907043472717, -140.91109950049088, -590.5924839629066, -238.17325356051558, -785.5658402963578, -1044.4744992623998, -498.07989832338893, -824.9943594602641, -689.9202472853559, -1328.6670363031114, -1437.2227852123979, -635.9236667291847, -220.031914302262, -83.97391228226073, -483.2685798119534, -1206.6268146217622, -710.4902464842183, -698.9727811838949, -1276.6888481486048, -1241.4566483431383, -704.6758751464961, -668.0189524824533, -370.37970294212414, -746.1307416397758, -1253.2301908988018, -206.29081800759434, -1007.9137120035607, -955.4285318227476, -1036.7643097698374, -1386.1838881907806, -839.5194743364269, -708.0011125218272, -342.0380692407007, -427.212112736224, -554.1580651246603, -788.5215433257517, -987.2766780754675, -1164.432879781951], "episode_lengths": [150, 51, 140, 150, 120, 65, 150, 150, 40, 150, 150, 84, 150, 150, 150, 150, 150, 108, 89, 150, 150, 150, 49, 150, 150, 150, 86, 60, 106, 150, 150, 150, 91, 150, 150, 150, 150, 86, 55, 150, 150, 150, 93, 150, 37, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 100, 68, 150, 84, 80, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 102, 56, 150, 150, 150, 150, 150, 150, 150, 147, 129, 150, 150, 104, 150, 150, 150, 150, 150, 150, 86, 111, 122, 150, 150, 150], "policy_policy_0_reward": [-742.3569777466455, -22.946855078830016, -527.0014405985866, -623.2126187314956, -580.4345556016978, -182.05992390428298, -846.0464363220589, -358.9686909206308, -2.0115741555099884, -1410.8846319429176, -766.5623396723905, -144.47956095391697, -1013.2462747001123, -1160.4555682337761, -868.6001034527064, -680.4009314236501, -1067.1081525529485, -239.0956232347998, -146.16874440630133, -1145.5604120279102, -521.1795526887162, -873.5691875662739, -24.321934631116296, -616.0969469377713, -1084.2697170697484, -1149.5861798540634, -102.26599766399383, -133.94421322202544, -463.6609272950892, -590.0811049469204, -651.138390124339, -600.3433674176131, -207.33068721113622, -1193.5831480870013, -1014.8813787036428, -843.4584166294931, -711.2644187215661, -244.96720310765224, -43.82667466483287, -963.7921357914793, -823.6635557179533, -704.9045366935336, -140.98618053634985, -667.7617798175902, -6.130990093531581, -1224.3894007582028, -974.5731679992987, -145.67665093699696, -1171.9934553943224, -1007.7098051902311, -985.0059870515117, -743.1753124227836, -656.1728314865655, -953.8649273132567, -881.3539388661698, -597.5344323582751, -1069.4792368316496, -1129.843798749613, -204.59812907079265, -389.66415066988714, -151.47152369402957, -749.1263392726279, -139.6907043472717, -140.91109950049088, -590.5924839629066, -238.17325356051558, -785.5658402963578, -1044.4744992623998, -498.07989832338893, -824.9943594602641, -689.9202472853559, -1328.6670363031114, -1437.2227852123979, -635.9236667291847, -220.031914302262, -83.97391228226073, -483.2685798119534, -1206.6268146217622, -710.4902464842183, -698.9727811838949, -1276.6888481486048, -1241.4566483431383, -704.6758751464961, -668.0189524824533, -370.37970294212414, -746.1307416397758, -1253.2301908988018, -206.29081800759434, -1007.9137120035607, -955.4285318227476, -1036.7643097698374, -1386.1838881907806, -839.5194743364269, -708.0011125218272, -342.0380692407007, -427.212112736224, -554.1580651246603, -788.5215433257517, -987.2766780754675, -1164.432879781951]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27858165701868015, "mean_inference_ms": 0.8989117223576512, "mean_action_processing_ms": 0.15750190001320646, "mean_env_wait_ms": 1.564610890984853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005536317825317383, "StateBufferConnector_ms": 0.003944873809814453, "ViewRequirementAgentConnector_ms": 0.09995269775390625}, "num_episodes": 29, "episode_return_max": -2.0115741555099884, "episode_return_min": -1437.2227852123979, "episode_return_mean": -683.6214540638972, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.18472699253977, "num_env_steps_trained_throughput_per_sec": 263.18472699253977, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 14063.125, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14063.049, "sample_time_ms": 2428.835, "learn_time_ms": 11618.449, "learn_throughput": 344.28, "synch_weights_time_ms": 14.917}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00006", "date": "2024-08-03_05-23-36", "timestamp": 1722642816, "time_this_iter_s": 15.209113121032715, "time_total_s": 305.66431879997253, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8e4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 305.66431879997253, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 12.886363636363638, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.66106714804968, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.724125143388907, "policy_loss": -0.007973894056825278, "vf_loss": 4.727206902454297, "vf_explained_var": 0.9649882086863121, "kl": 0.01635598572817497, "entropy": 1.4661430155237516, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -4.4586439338877355, "episode_reward_min": -1437.2227852123979, "episode_reward_mean": -706.4762576767715, "episode_len_mean": 131.87, "episode_media": {}, "episodes_timesteps_total": 13187, "policy_reward_min": {"policy_0": -1437.2227852123979}, "policy_reward_max": {"policy_0": -4.4586439338877355}, "policy_reward_mean": {"policy_0": -706.4762576767715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-600.3433674176131, -207.33068721113622, -1193.5831480870013, -1014.8813787036428, -843.4584166294931, -711.2644187215661, -244.96720310765224, -43.82667466483287, -963.7921357914793, -823.6635557179533, -704.9045366935336, -140.98618053634985, -667.7617798175902, -6.130990093531581, -1224.3894007582028, -974.5731679992987, -145.67665093699696, -1171.9934553943224, -1007.7098051902311, -985.0059870515117, -743.1753124227836, -656.1728314865655, -953.8649273132567, -881.3539388661698, -597.5344323582751, -1069.4792368316496, -1129.843798749613, -204.59812907079265, -389.66415066988714, -151.47152369402957, -749.1263392726279, -139.6907043472717, -140.91109950049088, -590.5924839629066, -238.17325356051558, -785.5658402963578, -1044.4744992623998, -498.07989832338893, -824.9943594602641, -689.9202472853559, -1328.6670363031114, -1437.2227852123979, -635.9236667291847, -220.031914302262, -83.97391228226073, -483.2685798119534, -1206.6268146217622, -710.4902464842183, -698.9727811838949, -1276.6888481486048, -1241.4566483431383, -704.6758751464961, -668.0189524824533, -370.37970294212414, -746.1307416397758, -1253.2301908988018, -206.29081800759434, -1007.9137120035607, -955.4285318227476, -1036.7643097698374, -1386.1838881907806, -839.5194743364269, -708.0011125218272, -342.0380692407007, -427.212112736224, -554.1580651246603, -788.5215433257517, -987.2766780754675, -1164.432879781951, -987.163975070436, -891.8353435685056, -770.4130994909011, -4.4586439338877355, -315.93818105810567, -955.3533073766399, -202.31384479635847, -280.57453289771865, -315.33092817643177, -484.9084179729897, -196.39975553672915, -232.07082239011726, -770.346519075423, -1014.1621809007028, -1048.141322463761, -638.8736277371687, -1073.0556756489211, -620.2149815496937, -553.5637794103834, -241.80600039198117, -1127.4879510087137, -1114.6114188118029, -85.46839973735099, -1021.9448676420948, -850.2879836821241, -1322.9868114831374, -862.6681957157285, -118.35968034805745, -1163.3645146338733, -722.1453957475044, -1036.9457706913945], "episode_lengths": [150, 91, 150, 150, 150, 150, 86, 55, 150, 150, 150, 93, 150, 37, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 100, 68, 150, 84, 80, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 102, 56, 150, 150, 150, 150, 150, 150, 150, 147, 129, 150, 150, 104, 150, 150, 150, 150, 150, 150, 86, 111, 122, 150, 150, 150, 150, 150, 150, 38, 92, 150, 71, 99, 150, 150, 75, 75, 150, 150, 150, 150, 150, 149, 150, 124, 150, 150, 74, 150, 150, 150, 150, 62, 150, 150, 150], "policy_policy_0_reward": [-600.3433674176131, -207.33068721113622, -1193.5831480870013, -1014.8813787036428, -843.4584166294931, -711.2644187215661, -244.96720310765224, -43.82667466483287, -963.7921357914793, -823.6635557179533, -704.9045366935336, -140.98618053634985, -667.7617798175902, -6.130990093531581, -1224.3894007582028, -974.5731679992987, -145.67665093699696, -1171.9934553943224, -1007.7098051902311, -985.0059870515117, -743.1753124227836, -656.1728314865655, -953.8649273132567, -881.3539388661698, -597.5344323582751, -1069.4792368316496, -1129.843798749613, -204.59812907079265, -389.66415066988714, -151.47152369402957, -749.1263392726279, -139.6907043472717, -140.91109950049088, -590.5924839629066, -238.17325356051558, -785.5658402963578, -1044.4744992623998, -498.07989832338893, -824.9943594602641, -689.9202472853559, -1328.6670363031114, -1437.2227852123979, -635.9236667291847, -220.031914302262, -83.97391228226073, -483.2685798119534, -1206.6268146217622, -710.4902464842183, -698.9727811838949, -1276.6888481486048, -1241.4566483431383, -704.6758751464961, -668.0189524824533, -370.37970294212414, -746.1307416397758, -1253.2301908988018, -206.29081800759434, -1007.9137120035607, -955.4285318227476, -1036.7643097698374, -1386.1838881907806, -839.5194743364269, -708.0011125218272, -342.0380692407007, -427.212112736224, -554.1580651246603, -788.5215433257517, -987.2766780754675, -1164.432879781951, -987.163975070436, -891.8353435685056, -770.4130994909011, -4.4586439338877355, -315.93818105810567, -955.3533073766399, -202.31384479635847, -280.57453289771865, -315.33092817643177, -484.9084179729897, -196.39975553672915, -232.07082239011726, -770.346519075423, -1014.1621809007028, -1048.141322463761, -638.8736277371687, -1073.0556756489211, -620.2149815496937, -553.5637794103834, -241.80600039198117, -1127.4879510087137, -1114.6114188118029, -85.46839973735099, -1021.9448676420948, -850.2879836821241, -1322.9868114831374, -862.6681957157285, -118.35968034805745, -1163.3645146338733, -722.1453957475044, -1036.9457706913945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27850874484731375, "mean_inference_ms": 0.8979086672843863, "mean_action_processing_ms": 0.15751432513626468, "mean_env_wait_ms": 1.5659452020681772, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005300998687744141, "StateBufferConnector_ms": 0.003920793533325195, "ViewRequirementAgentConnector_ms": 0.09928154945373535}, "num_episodes": 31, "episode_return_max": -4.4586439338877355, "episode_return_min": -1437.2227852123979, "episode_return_mean": -706.4762576767715, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.8196013609015, "num_env_steps_trained_throughput_per_sec": 268.8196013609015, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 14083.783, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14083.706, "sample_time_ms": 2438.427, "learn_time_ms": 11629.824, "learn_throughput": 343.943, "synch_weights_time_ms": 14.616}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00006", "date": "2024-08-03_05-23-51", "timestamp": 1722642831, "time_this_iter_s": 14.886860132217407, "time_total_s": 320.55117893218994, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8e200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 320.55117893218994, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 12.923809523809522, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 135.77055346568426, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.243798695504665, "policy_loss": -0.014279050436258937, "vf_loss": 5.252674811333418, "vf_explained_var": 0.9735223220040401, "kl": 0.01807017011572801, "entropy": 1.8116628060738245, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -4.4586439338877355, "episode_reward_min": -1437.2227852123979, "episode_reward_mean": -735.4995609449595, "episode_len_mean": 133.52, "episode_media": {}, "episodes_timesteps_total": 13352, "policy_reward_min": {"policy_0": -1437.2227852123979}, "policy_reward_max": {"policy_0": -4.4586439338877355}, "policy_reward_mean": {"policy_0": -735.4995609449595}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-151.47152369402957, -749.1263392726279, -139.6907043472717, -140.91109950049088, -590.5924839629066, -238.17325356051558, -785.5658402963578, -1044.4744992623998, -498.07989832338893, -824.9943594602641, -689.9202472853559, -1328.6670363031114, -1437.2227852123979, -635.9236667291847, -220.031914302262, -83.97391228226073, -483.2685798119534, -1206.6268146217622, -710.4902464842183, -698.9727811838949, -1276.6888481486048, -1241.4566483431383, -704.6758751464961, -668.0189524824533, -370.37970294212414, -746.1307416397758, -1253.2301908988018, -206.29081800759434, -1007.9137120035607, -955.4285318227476, -1036.7643097698374, -1386.1838881907806, -839.5194743364269, -708.0011125218272, -342.0380692407007, -427.212112736224, -554.1580651246603, -788.5215433257517, -987.2766780754675, -1164.432879781951, -987.163975070436, -891.8353435685056, -770.4130994909011, -4.4586439338877355, -315.93818105810567, -955.3533073766399, -202.31384479635847, -280.57453289771865, -315.33092817643177, -484.9084179729897, -196.39975553672915, -232.07082239011726, -770.346519075423, -1014.1621809007028, -1048.141322463761, -638.8736277371687, -1073.0556756489211, -620.2149815496937, -553.5637794103834, -241.80600039198117, -1127.4879510087137, -1114.6114188118029, -85.46839973735099, -1021.9448676420948, -850.2879836821241, -1322.9868114831374, -862.6681957157285, -118.35968034805745, -1163.3645146338733, -722.1453957475044, -1036.9457706913945, -897.8226609905423, -506.6051959916958, -28.7797150613558, -1055.685304651117, -905.2123730961797, -771.161987360311, -1296.5468444066832, -27.931515425832593, -917.7384521876577, -1113.4590424171975, -1065.5689710822842, -1028.474927614711, -893.5637793201302, -1008.8631266703372, -1074.9463409237028, -1242.5523237382913, -493.41509680477094, -635.9720790911638, -1026.7308575356576, -328.9551205014721, -923.2415058039815, -341.5616847667605, -1182.5119968155773, -1047.704776146565, -1041.3373572034764, -986.3746414349764, -1142.3157501340088, -49.88089640805159, -169.34570152724694], "episode_lengths": [68, 150, 84, 80, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 102, 56, 150, 150, 150, 150, 150, 150, 150, 147, 129, 150, 150, 104, 150, 150, 150, 150, 150, 150, 86, 111, 122, 150, 150, 150, 150, 150, 150, 38, 92, 150, 71, 99, 150, 150, 75, 75, 150, 150, 150, 150, 150, 149, 150, 124, 150, 150, 74, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 38, 102], "policy_policy_0_reward": [-151.47152369402957, -749.1263392726279, -139.6907043472717, -140.91109950049088, -590.5924839629066, -238.17325356051558, -785.5658402963578, -1044.4744992623998, -498.07989832338893, -824.9943594602641, -689.9202472853559, -1328.6670363031114, -1437.2227852123979, -635.9236667291847, -220.031914302262, -83.97391228226073, -483.2685798119534, -1206.6268146217622, -710.4902464842183, -698.9727811838949, -1276.6888481486048, -1241.4566483431383, -704.6758751464961, -668.0189524824533, -370.37970294212414, -746.1307416397758, -1253.2301908988018, -206.29081800759434, -1007.9137120035607, -955.4285318227476, -1036.7643097698374, -1386.1838881907806, -839.5194743364269, -708.0011125218272, -342.0380692407007, -427.212112736224, -554.1580651246603, -788.5215433257517, -987.2766780754675, -1164.432879781951, -987.163975070436, -891.8353435685056, -770.4130994909011, -4.4586439338877355, -315.93818105810567, -955.3533073766399, -202.31384479635847, -280.57453289771865, -315.33092817643177, -484.9084179729897, -196.39975553672915, -232.07082239011726, -770.346519075423, -1014.1621809007028, -1048.141322463761, -638.8736277371687, -1073.0556756489211, -620.2149815496937, -553.5637794103834, -241.80600039198117, -1127.4879510087137, -1114.6114188118029, -85.46839973735099, -1021.9448676420948, -850.2879836821241, -1322.9868114831374, -862.6681957157285, -118.35968034805745, -1163.3645146338733, -722.1453957475044, -1036.9457706913945, -897.8226609905423, -506.6051959916958, -28.7797150613558, -1055.685304651117, -905.2123730961797, -771.161987360311, -1296.5468444066832, -27.931515425832593, -917.7384521876577, -1113.4590424171975, -1065.5689710822842, -1028.474927614711, -893.5637793201302, -1008.8631266703372, -1074.9463409237028, -1242.5523237382913, -493.41509680477094, -635.9720790911638, -1026.7308575356576, -328.9551205014721, -923.2415058039815, -341.5616847667605, -1182.5119968155773, -1047.704776146565, -1041.3373572034764, -986.3746414349764, -1142.3157501340088, -49.88089640805159, -169.34570152724694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27840872093352304, "mean_inference_ms": 0.8967501119572847, "mean_action_processing_ms": 0.1574171421888599, "mean_env_wait_ms": 1.5672841780552398, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005251407623291016, "StateBufferConnector_ms": 0.00392460823059082, "ViewRequirementAgentConnector_ms": 0.09905457496643066}, "num_episodes": 29, "episode_return_max": -4.4586439338877355, "episode_return_min": -1437.2227852123979, "episode_return_mean": -735.4995609449595, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.8835777411734, "num_env_steps_trained_throughput_per_sec": 265.8835777411734, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 14071.879, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14071.799, "sample_time_ms": 2412.076, "learn_time_ms": 11644.271, "learn_throughput": 343.517, "synch_weights_time_ms": 14.607}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00006", "date": "2024-08-03_05-24-06", "timestamp": 1722642846, "time_this_iter_s": 15.051892280578613, "time_total_s": 335.60307121276855, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fd8dc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 335.60307121276855, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 12.754545454545452, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 160.08934050997098, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.448570884019136, "policy_loss": -0.018796016452445958, "vf_loss": 4.461038921276728, "vf_explained_var": 0.9798689352348446, "kl": 0.021144900901405615, "entropy": 1.5486447717994452, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -4.4586439338877355, "episode_reward_min": -1322.9868114831374, "episode_reward_mean": -728.604561736185, "episode_len_mean": 131.59, "episode_media": {}, "episodes_timesteps_total": 13159, "policy_reward_min": {"policy_0": -1322.9868114831374}, "policy_reward_max": {"policy_0": -4.4586439338877355}, "policy_reward_mean": {"policy_0": -728.604561736185}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-708.0011125218272, -342.0380692407007, -427.212112736224, -554.1580651246603, -788.5215433257517, -987.2766780754675, -1164.432879781951, -987.163975070436, -891.8353435685056, -770.4130994909011, -4.4586439338877355, -315.93818105810567, -955.3533073766399, -202.31384479635847, -280.57453289771865, -315.33092817643177, -484.9084179729897, -196.39975553672915, -232.07082239011726, -770.346519075423, -1014.1621809007028, -1048.141322463761, -638.8736277371687, -1073.0556756489211, -620.2149815496937, -553.5637794103834, -241.80600039198117, -1127.4879510087137, -1114.6114188118029, -85.46839973735099, -1021.9448676420948, -850.2879836821241, -1322.9868114831374, -862.6681957157285, -118.35968034805745, -1163.3645146338733, -722.1453957475044, -1036.9457706913945, -897.8226609905423, -506.6051959916958, -28.7797150613558, -1055.685304651117, -905.2123730961797, -771.161987360311, -1296.5468444066832, -27.931515425832593, -917.7384521876577, -1113.4590424171975, -1065.5689710822842, -1028.474927614711, -893.5637793201302, -1008.8631266703372, -1074.9463409237028, -1242.5523237382913, -493.41509680477094, -635.9720790911638, -1026.7308575356576, -328.9551205014721, -923.2415058039815, -341.5616847667605, -1182.5119968155773, -1047.704776146565, -1041.3373572034764, -986.3746414349764, -1142.3157501340088, -49.88089640805159, -169.34570152724694, -1146.2611541031945, -619.212706844798, -306.3408584895436, -901.1631200082926, -181.94981865411557, -159.57733754980688, -339.2297735794659, -695.3492983974681, -1201.2112346616914, -776.0395953865035, -257.4726164019833, -1236.0166472584774, -1053.7302636695733, -68.85677455444535, -1285.5887512592303, -760.2933031164993, -40.29162071428149, -1052.186148072484, -916.2314295513095, -1162.6478175711065, -101.24380372004303, -1285.1945525645197, -958.1738790573598, -615.6374969538087, -792.5877464628596, -1198.7758679930578, -592.0251113424082, -863.255349403523, -810.792158982384, -332.11362548035373, -144.23351102808047, -1257.0283041128425, -550.6480818060267], "episode_lengths": [150, 86, 111, 122, 150, 150, 150, 150, 150, 150, 38, 92, 150, 71, 99, 150, 150, 75, 75, 150, 150, 150, 150, 150, 149, 150, 124, 150, 150, 74, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 38, 102, 150, 150, 150, 150, 63, 103, 101, 150, 150, 150, 78, 150, 150, 51, 150, 150, 58, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 95, 58, 150, 150], "policy_policy_0_reward": [-708.0011125218272, -342.0380692407007, -427.212112736224, -554.1580651246603, -788.5215433257517, -987.2766780754675, -1164.432879781951, -987.163975070436, -891.8353435685056, -770.4130994909011, -4.4586439338877355, -315.93818105810567, -955.3533073766399, -202.31384479635847, -280.57453289771865, -315.33092817643177, -484.9084179729897, -196.39975553672915, -232.07082239011726, -770.346519075423, -1014.1621809007028, -1048.141322463761, -638.8736277371687, -1073.0556756489211, -620.2149815496937, -553.5637794103834, -241.80600039198117, -1127.4879510087137, -1114.6114188118029, -85.46839973735099, -1021.9448676420948, -850.2879836821241, -1322.9868114831374, -862.6681957157285, -118.35968034805745, -1163.3645146338733, -722.1453957475044, -1036.9457706913945, -897.8226609905423, -506.6051959916958, -28.7797150613558, -1055.685304651117, -905.2123730961797, -771.161987360311, -1296.5468444066832, -27.931515425832593, -917.7384521876577, -1113.4590424171975, -1065.5689710822842, -1028.474927614711, -893.5637793201302, -1008.8631266703372, -1074.9463409237028, -1242.5523237382913, -493.41509680477094, -635.9720790911638, -1026.7308575356576, -328.9551205014721, -923.2415058039815, -341.5616847667605, -1182.5119968155773, -1047.704776146565, -1041.3373572034764, -986.3746414349764, -1142.3157501340088, -49.88089640805159, -169.34570152724694, -1146.2611541031945, -619.212706844798, -306.3408584895436, -901.1631200082926, -181.94981865411557, -159.57733754980688, -339.2297735794659, -695.3492983974681, -1201.2112346616914, -776.0395953865035, -257.4726164019833, -1236.0166472584774, -1053.7302636695733, -68.85677455444535, -1285.5887512592303, -760.2933031164993, -40.29162071428149, -1052.186148072484, -916.2314295513095, -1162.6478175711065, -101.24380372004303, -1285.1945525645197, -958.1738790573598, -615.6374969538087, -792.5877464628596, -1198.7758679930578, -592.0251113424082, -863.255349403523, -810.792158982384, -332.11362548035373, -144.23351102808047, -1257.0283041128425, -550.6480818060267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2783405994091117, "mean_inference_ms": 0.8956588517871432, "mean_action_processing_ms": 0.15754036745305786, "mean_env_wait_ms": 1.5690128507521033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005495786666870117, "StateBufferConnector_ms": 0.003976583480834961, "ViewRequirementAgentConnector_ms": 0.1002817153930664}, "num_episodes": 33, "episode_return_max": -4.4586439338877355, "episode_return_min": -1322.9868114831374, "episode_return_mean": -728.604561736185, "episodes_this_iter": 33}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.37581519225984, "num_env_steps_trained_throughput_per_sec": 264.37581519225984, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 14327.698, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14327.616, "sample_time_ms": 2407.793, "learn_time_ms": 11903.838, "learn_throughput": 336.026, "synch_weights_time_ms": 15.118}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00006", "date": "2024-08-03_05-24-21", "timestamp": 1722642861, "time_this_iter_s": 15.137971639633179, "time_total_s": 350.74104285240173, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8e4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 350.74104285240173, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 12.942857142857143, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 131.83990016976992, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.927021230508884, "policy_loss": -0.009418422038531086, "vf_loss": 4.930505826075872, "vf_explained_var": 0.965346165622274, "kl": 0.013209498142502255, "entropy": 1.0440433885902167, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -25.68127581813337, "episode_reward_min": -1322.9868114831374, "episode_reward_mean": -688.3382953886685, "episode_len_mean": 128.49, "episode_media": {}, "episodes_timesteps_total": 12849, "policy_reward_min": {"policy_0": -1322.9868114831374}, "policy_reward_max": {"policy_0": -25.68127581813337}, "policy_reward_mean": {"policy_0": -688.3382953886685}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1322.9868114831374, -862.6681957157285, -118.35968034805745, -1163.3645146338733, -722.1453957475044, -1036.9457706913945, -897.8226609905423, -506.6051959916958, -28.7797150613558, -1055.685304651117, -905.2123730961797, -771.161987360311, -1296.5468444066832, -27.931515425832593, -917.7384521876577, -1113.4590424171975, -1065.5689710822842, -1028.474927614711, -893.5637793201302, -1008.8631266703372, -1074.9463409237028, -1242.5523237382913, -493.41509680477094, -635.9720790911638, -1026.7308575356576, -328.9551205014721, -923.2415058039815, -341.5616847667605, -1182.5119968155773, -1047.704776146565, -1041.3373572034764, -986.3746414349764, -1142.3157501340088, -49.88089640805159, -169.34570152724694, -1146.2611541031945, -619.212706844798, -306.3408584895436, -901.1631200082926, -181.94981865411557, -159.57733754980688, -339.2297735794659, -695.3492983974681, -1201.2112346616914, -776.0395953865035, -257.4726164019833, -1236.0166472584774, -1053.7302636695733, -68.85677455444535, -1285.5887512592303, -760.2933031164993, -40.29162071428149, -1052.186148072484, -916.2314295513095, -1162.6478175711065, -101.24380372004303, -1285.1945525645197, -958.1738790573598, -615.6374969538087, -792.5877464628596, -1198.7758679930578, -592.0251113424082, -863.255349403523, -810.792158982384, -332.11362548035373, -144.23351102808047, -1257.0283041128425, -550.6480818060267, -566.2830469236818, -691.5018605572515, -997.0827930463956, -310.7476527354209, -321.0626275909491, -120.31430957947002, -117.59925984157209, -770.1160901743154, -281.04107429840786, -232.31220790081116, -820.1750370587379, -732.7276082608312, -267.4228358386264, -678.9345523058058, -819.3724963243629, -1183.9241096016615, -435.75922210912637, -197.4582243349255, -667.3123712793783, -305.1946705095806, -887.7618998255855, -25.68127581813337, -1171.3443965270023, -838.9533473510556, -1201.3232147776257, -26.345677303649513, -362.7214473061553, -487.29069507310504, -70.356004167682, -121.71922918901197, -774.8501211317713, -257.0500276417905], "episode_lengths": [150, 150, 62, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 38, 102, 150, 150, 150, 150, 63, 103, 101, 150, 150, 150, 78, 150, 150, 51, 150, 150, 58, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 95, 58, 150, 150, 150, 150, 150, 145, 120, 71, 70, 150, 92, 99, 150, 150, 150, 150, 150, 150, 111, 73, 150, 96, 150, 40, 150, 150, 150, 55, 97, 130, 54, 75, 150, 78], "policy_policy_0_reward": [-1322.9868114831374, -862.6681957157285, -118.35968034805745, -1163.3645146338733, -722.1453957475044, -1036.9457706913945, -897.8226609905423, -506.6051959916958, -28.7797150613558, -1055.685304651117, -905.2123730961797, -771.161987360311, -1296.5468444066832, -27.931515425832593, -917.7384521876577, -1113.4590424171975, -1065.5689710822842, -1028.474927614711, -893.5637793201302, -1008.8631266703372, -1074.9463409237028, -1242.5523237382913, -493.41509680477094, -635.9720790911638, -1026.7308575356576, -328.9551205014721, -923.2415058039815, -341.5616847667605, -1182.5119968155773, -1047.704776146565, -1041.3373572034764, -986.3746414349764, -1142.3157501340088, -49.88089640805159, -169.34570152724694, -1146.2611541031945, -619.212706844798, -306.3408584895436, -901.1631200082926, -181.94981865411557, -159.57733754980688, -339.2297735794659, -695.3492983974681, -1201.2112346616914, -776.0395953865035, -257.4726164019833, -1236.0166472584774, -1053.7302636695733, -68.85677455444535, -1285.5887512592303, -760.2933031164993, -40.29162071428149, -1052.186148072484, -916.2314295513095, -1162.6478175711065, -101.24380372004303, -1285.1945525645197, -958.1738790573598, -615.6374969538087, -792.5877464628596, -1198.7758679930578, -592.0251113424082, -863.255349403523, -810.792158982384, -332.11362548035373, -144.23351102808047, -1257.0283041128425, -550.6480818060267, -566.2830469236818, -691.5018605572515, -997.0827930463956, -310.7476527354209, -321.0626275909491, -120.31430957947002, -117.59925984157209, -770.1160901743154, -281.04107429840786, -232.31220790081116, -820.1750370587379, -732.7276082608312, -267.4228358386264, -678.9345523058058, -819.3724963243629, -1183.9241096016615, -435.75922210912637, -197.4582243349255, -667.3123712793783, -305.1946705095806, -887.7618998255855, -25.68127581813337, -1171.3443965270023, -838.9533473510556, -1201.3232147776257, -26.345677303649513, -362.7214473061553, -487.29069507310504, -70.356004167682, -121.71922918901197, -774.8501211317713, -257.0500276417905]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2783572749210718, "mean_inference_ms": 0.8946207457536343, "mean_action_processing_ms": 0.15748171227337082, "mean_env_wait_ms": 1.5700960106900368, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053822994232177734, "StateBufferConnector_ms": 0.0038819313049316406, "ViewRequirementAgentConnector_ms": 0.09719133377075195}, "num_episodes": 32, "episode_return_max": -25.68127581813337, "episode_return_min": -1322.9868114831374, "episode_return_mean": -688.3382953886685, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.3659670379261, "num_env_steps_trained_throughput_per_sec": 264.3659670379261, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 14556.29, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14556.206, "sample_time_ms": 2405.74, "learn_time_ms": 12134.439, "learn_throughput": 329.64, "synch_weights_time_ms": 15.169}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00006", "date": "2024-08-03_05-24-36", "timestamp": 1722642876, "time_this_iter_s": 15.140316724777222, "time_total_s": 365.88135957717896, "pid": 488513, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fdbe20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 365.88135957717896, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 12.713636363636361, "ram_util_percent": 19.199999999999996}}
