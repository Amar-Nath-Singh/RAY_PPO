{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.193296185694635, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.45518442094326, "policy_loss": -0.010670449526514858, "vf_loss": 9.463356217741966, "vf_explained_var": 0.003562159463763237, "kl": 0.013215011181508392, "entropy": 1.443233756100138, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -130.50197665896133, "episode_reward_min": -1187.3679041028622, "episode_reward_mean": -628.7858773710392, "episode_len_mean": 136.08695652173913, "episode_media": {}, "episodes_timesteps_total": 3130, "policy_reward_min": {"policy_0": -1187.3679041028622}, "policy_reward_max": {"policy_0": -130.50197665896133}, "policy_reward_mean": {"policy_0": -628.7858773710392}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-786.8544733039972, -387.7673998496647, -638.7876725660195, -820.2218086069632, -379.1486630342675, -1030.488214372119, -863.6383388933002, -163.59561213428688, -671.0553162294746, -938.3240888899343, -680.6147517728735, -341.36585474784977, -784.6784189601692, -786.7368430113033, -669.1754944071189, -180.74386793115386, -914.1172184590118, -750.9133785357251, -130.50197665896133, -1187.3679041028622, -521.8285568221283, -553.1352541589722, -281.01407208574506], "episode_lengths": [150, 98, 136, 150, 133, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 68, 150, 150, 150, 126], "policy_policy_0_reward": [-786.8544733039972, -387.7673998496647, -638.7876725660195, -820.2218086069632, -379.1486630342675, -1030.488214372119, -863.6383388933002, -163.59561213428688, -671.0553162294746, -938.3240888899343, -680.6147517728735, -341.36585474784977, -784.6784189601692, -786.7368430113033, -669.1754944071189, -180.74386793115386, -914.1172184590118, -750.9133785357251, -130.50197665896133, -1187.3679041028622, -521.8285568221283, -553.1352541589722, -281.01407208574506]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5757344318013243, "mean_inference_ms": 1.6849318692453874, "mean_action_processing_ms": 0.28843023489857245, "mean_env_wait_ms": 2.9935708845624274, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011301040649414062, "StateBufferConnector_ms": 0.008004644642705503, "ViewRequirementAgentConnector_ms": 0.18133598825205927}, "num_episodes": 23, "episode_return_max": -130.50197665896133, "episode_return_min": -1187.3679041028622, "episode_return_mean": -628.7858773710392, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 336.9294775135957, "num_env_steps_trained_throughput_per_sec": 336.9294775135957, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 11871.931, "restore_workers_time_ms": 0.024, "training_step_time_ms": 11871.869, "sample_time_ms": 1045.477, "learn_time_ms": 10754.45, "learn_throughput": 371.939, "synch_weights_time_ms": 71.162}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00010", "date": "2024-08-03_04-03-03", "timestamp": 1722637983, "time_this_iter_s": 11.883079528808594, "time_total_s": 11.883079528808594, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b1ba30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11.883079528808594, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.323529411764707, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8142672612021367, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.225073186556498, "policy_loss": -0.009811203420395032, "vf_loss": 9.2318771392107, "vf_explained_var": 0.0883504289512833, "kl": 0.015768007494716588, "entropy": 1.463468594228228, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -40.808239947922154, "episode_reward_min": -1230.4251267973489, "episode_reward_mean": -665.4047232379245, "episode_len_mean": 136.0, "episode_media": {}, "episodes_timesteps_total": 6664, "policy_reward_min": {"policy_0": -1230.4251267973489}, "policy_reward_max": {"policy_0": -40.808239947922154}, "policy_reward_mean": {"policy_0": -665.4047232379245}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-786.8544733039972, -387.7673998496647, -638.7876725660195, -820.2218086069632, -379.1486630342675, -1030.488214372119, -863.6383388933002, -163.59561213428688, -671.0553162294746, -938.3240888899343, -680.6147517728735, -341.36585474784977, -784.6784189601692, -786.7368430113033, -669.1754944071189, -180.74386793115386, -914.1172184590118, -750.9133785357251, -130.50197665896133, -1187.3679041028622, -521.8285568221283, -553.1352541589722, -281.01407208574506, -1020.2469786144835, -783.7584223461469, -919.40986120856, -946.8989547576721, -141.03021513186013, -1230.4251267973489, -1150.7297659671342, -505.3673705601017, -384.2649119529205, -1052.1816585694462, -877.0774857907633, -237.9685450391641, -748.1472784027633, -40.808239947922154, -1169.238758208486, -541.0231535055653, -1125.434300415949, -984.3723124808683, -429.7222534158838, -752.3537989382586, -205.88952017841066, -990.2091574188591, -1027.5685877202693, -215.41967529908203, -182.37122248886195, -480.83870396762006], "episode_lengths": [150, 98, 136, 150, 133, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 68, 150, 150, 150, 126, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 127, 150, 150, 150, 150, 90, 150, 150, 75, 119, 150], "policy_policy_0_reward": [-786.8544733039972, -387.7673998496647, -638.7876725660195, -820.2218086069632, -379.1486630342675, -1030.488214372119, -863.6383388933002, -163.59561213428688, -671.0553162294746, -938.3240888899343, -680.6147517728735, -341.36585474784977, -784.6784189601692, -786.7368430113033, -669.1754944071189, -180.74386793115386, -914.1172184590118, -750.9133785357251, -130.50197665896133, -1187.3679041028622, -521.8285568221283, -553.1352541589722, -281.01407208574506, -1020.2469786144835, -783.7584223461469, -919.40986120856, -946.8989547576721, -141.03021513186013, -1230.4251267973489, -1150.7297659671342, -505.3673705601017, -384.2649119529205, -1052.1816585694462, -877.0774857907633, -237.9685450391641, -748.1472784027633, -40.808239947922154, -1169.238758208486, -541.0231535055653, -1125.434300415949, -984.3723124808683, -429.7222534158838, -752.3537989382586, -205.88952017841066, -990.2091574188591, -1027.5685877202693, -215.41967529908203, -182.37122248886195, -480.83870396762006]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5695973101284597, "mean_inference_ms": 1.6793432764844805, "mean_action_processing_ms": 0.28537284414673714, "mean_env_wait_ms": 2.9871321378231634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013368956896723534, "StateBufferConnector_ms": 0.008225927547532685, "ViewRequirementAgentConnector_ms": 0.18259359865772481}, "num_episodes": 26, "episode_return_max": -40.808239947922154, "episode_return_min": -1230.4251267973489, "episode_return_mean": -665.4047232379245, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.3630558760228, "num_env_steps_trained_throughput_per_sec": 307.3630558760228, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12442.934, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12442.868, "sample_time_ms": 1037.484, "learn_time_ms": 11340.521, "learn_throughput": 352.717, "synch_weights_time_ms": 64.109}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00010", "date": "2024-08-03_04-03-16", "timestamp": 1722637996, "time_this_iter_s": 13.024646282196045, "time_total_s": 24.90772581100464, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8c37eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24.90772581100464, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 16.94736842105263, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.4600435055792333, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.021888816853364, "policy_loss": -0.010489705747750122, "vf_loss": 9.02959522853295, "vf_explained_var": 0.2230620240792632, "kl": 0.014668933057297792, "entropy": 1.5049695735176405, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -32.855558086490966, "episode_reward_min": -1230.4251267973489, "episode_reward_mean": -701.8354258737398, "episode_len_mean": 137.8684210526316, "episode_media": {}, "episodes_timesteps_total": 10478, "policy_reward_min": {"policy_0": -1230.4251267973489}, "policy_reward_max": {"policy_0": -32.855558086490966}, "policy_reward_mean": {"policy_0": -701.8354258737398}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-786.8544733039972, -387.7673998496647, -638.7876725660195, -820.2218086069632, -379.1486630342675, -1030.488214372119, -863.6383388933002, -163.59561213428688, -671.0553162294746, -938.3240888899343, -680.6147517728735, -341.36585474784977, -784.6784189601692, -786.7368430113033, -669.1754944071189, -180.74386793115386, -914.1172184590118, -750.9133785357251, -130.50197665896133, -1187.3679041028622, -521.8285568221283, -553.1352541589722, -281.01407208574506, -1020.2469786144835, -783.7584223461469, -919.40986120856, -946.8989547576721, -141.03021513186013, -1230.4251267973489, -1150.7297659671342, -505.3673705601017, -384.2649119529205, -1052.1816585694462, -877.0774857907633, -237.9685450391641, -748.1472784027633, -40.808239947922154, -1169.238758208486, -541.0231535055653, -1125.434300415949, -984.3723124808683, -429.7222534158838, -752.3537989382586, -205.88952017841066, -990.2091574188591, -1027.5685877202693, -215.41967529908203, -182.37122248886195, -480.83870396762006, -737.9222295361354, -1080.7416806523802, -833.9699324847084, -1137.1294311662166, -893.3147898324569, -893.9468757399649, -851.7634940601963, -986.657430128482, -1113.2398553884273, -138.0989190362155, -1179.967371616979, -160.57085595646328, -566.1466076367198, -821.1350395270051, -1050.9830169141005, -491.86020729910774, -1015.9511849449855, -659.7831722016442, -622.7734614072912, -988.7863201439656, -32.855558086490966, -376.2954234779427, -921.1669078274639, -1096.8498057856762, -866.3013322301683, -401.8603905793537, -814.5896340853764], "episode_lengths": [150, 98, 136, 150, 133, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 68, 150, 150, 150, 126, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 127, 150, 150, 150, 150, 90, 150, 150, 75, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-786.8544733039972, -387.7673998496647, -638.7876725660195, -820.2218086069632, -379.1486630342675, -1030.488214372119, -863.6383388933002, -163.59561213428688, -671.0553162294746, -938.3240888899343, -680.6147517728735, -341.36585474784977, -784.6784189601692, -786.7368430113033, -669.1754944071189, -180.74386793115386, -914.1172184590118, -750.9133785357251, -130.50197665896133, -1187.3679041028622, -521.8285568221283, -553.1352541589722, -281.01407208574506, -1020.2469786144835, -783.7584223461469, -919.40986120856, -946.8989547576721, -141.03021513186013, -1230.4251267973489, -1150.7297659671342, -505.3673705601017, -384.2649119529205, -1052.1816585694462, -877.0774857907633, -237.9685450391641, -748.1472784027633, -40.808239947922154, -1169.238758208486, -541.0231535055653, -1125.434300415949, -984.3723124808683, -429.7222534158838, -752.3537989382586, -205.88952017841066, -990.2091574188591, -1027.5685877202693, -215.41967529908203, -182.37122248886195, -480.83870396762006, -737.9222295361354, -1080.7416806523802, -833.9699324847084, -1137.1294311662166, -893.3147898324569, -893.9468757399649, -851.7634940601963, -986.657430128482, -1113.2398553884273, -138.0989190362155, -1179.967371616979, -160.57085595646328, -566.1466076367198, -821.1350395270051, -1050.9830169141005, -491.86020729910774, -1015.9511849449855, -659.7831722016442, -622.7734614072912, -988.7863201439656, -32.855558086490966, -376.2954234779427, -921.1669078274639, -1096.8498057856762, -866.3013322301683, -401.8603905793537, -814.5896340853764]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5677820907304377, "mean_inference_ms": 1.6819521793493053, "mean_action_processing_ms": 0.28488298042000615, "mean_env_wait_ms": 2.994231873777534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012946756262528268, "StateBufferConnector_ms": 0.008388255771837737, "ViewRequirementAgentConnector_ms": 0.1874311974174098}, "num_episodes": 27, "episode_return_max": -32.855558086490966, "episode_return_min": -1230.4251267973489, "episode_return_mean": -701.8354258737398, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.09027024245245, "num_env_steps_trained_throughput_per_sec": 305.09027024245245, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12665.584, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12665.519, "sample_time_ms": 1039.475, "learn_time_ms": 11558.418, "learn_throughput": 346.068, "synch_weights_time_ms": 66.872}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00010", "date": "2024-08-03_04-03-29", "timestamp": 1722638009, "time_this_iter_s": 13.1228506565094, "time_total_s": 38.03057646751404, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b19fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.03057646751404, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.257894736842104, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.180962228029966, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.681592532992363, "policy_loss": -0.010292049310131309, "vf_loss": 7.688905123869578, "vf_explained_var": 0.5318681592742602, "kl": 0.015613001686809487, "entropy": 1.4315787306676309, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -32.855558086490966, "episode_reward_min": -1230.4251267973489, "episode_reward_mean": -692.0835861150517, "episode_len_mean": 137.63, "episode_media": {}, "episodes_timesteps_total": 13763, "policy_reward_min": {"policy_0": -1230.4251267973489}, "policy_reward_max": {"policy_0": -32.855558086490966}, "policy_reward_mean": {"policy_0": -692.0835861150517}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1030.488214372119, -863.6383388933002, -163.59561213428688, -671.0553162294746, -938.3240888899343, -680.6147517728735, -341.36585474784977, -784.6784189601692, -786.7368430113033, -669.1754944071189, -180.74386793115386, -914.1172184590118, -750.9133785357251, -130.50197665896133, -1187.3679041028622, -521.8285568221283, -553.1352541589722, -281.01407208574506, -1020.2469786144835, -783.7584223461469, -919.40986120856, -946.8989547576721, -141.03021513186013, -1230.4251267973489, -1150.7297659671342, -505.3673705601017, -384.2649119529205, -1052.1816585694462, -877.0774857907633, -237.9685450391641, -748.1472784027633, -40.808239947922154, -1169.238758208486, -541.0231535055653, -1125.434300415949, -984.3723124808683, -429.7222534158838, -752.3537989382586, -205.88952017841066, -990.2091574188591, -1027.5685877202693, -215.41967529908203, -182.37122248886195, -480.83870396762006, -737.9222295361354, -1080.7416806523802, -833.9699324847084, -1137.1294311662166, -893.3147898324569, -893.9468757399649, -851.7634940601963, -986.657430128482, -1113.2398553884273, -138.0989190362155, -1179.967371616979, -160.57085595646328, -566.1466076367198, -821.1350395270051, -1050.9830169141005, -491.86020729910774, -1015.9511849449855, -659.7831722016442, -622.7734614072912, -988.7863201439656, -32.855558086490966, -376.2954234779427, -921.1669078274639, -1096.8498057856762, -866.3013322301683, -401.8603905793537, -814.5896340853764, -892.0225351765159, -936.1480991749178, -476.1926623426417, -794.5271335000907, -408.8640031302985, -851.7762319988545, -238.8644967013809, -403.7845115970032, -1087.0470427227094, -1063.2949394816217, -92.91538979942379, -1041.9737372296568, -857.802473580003, -239.66016609629608, -1063.473919718925, -906.185347234993, -735.1698641396999, -138.4043302378232, -817.0132402373457, -499.85838856516887, -529.6537098857019, -795.8387509653892, -541.233600557335, -49.08859485895271, -881.7221400773063, -535.036077065095, -1043.2586585170873, -758.8392717402977, -201.99694612930224], "episode_lengths": [150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 68, 150, 150, 150, 126, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 127, 150, 150, 150, 150, 90, 150, 150, 75, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 73, 150, 150, 90, 150, 150, 150, 89, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 105], "policy_policy_0_reward": [-1030.488214372119, -863.6383388933002, -163.59561213428688, -671.0553162294746, -938.3240888899343, -680.6147517728735, -341.36585474784977, -784.6784189601692, -786.7368430113033, -669.1754944071189, -180.74386793115386, -914.1172184590118, -750.9133785357251, -130.50197665896133, -1187.3679041028622, -521.8285568221283, -553.1352541589722, -281.01407208574506, -1020.2469786144835, -783.7584223461469, -919.40986120856, -946.8989547576721, -141.03021513186013, -1230.4251267973489, -1150.7297659671342, -505.3673705601017, -384.2649119529205, -1052.1816585694462, -877.0774857907633, -237.9685450391641, -748.1472784027633, -40.808239947922154, -1169.238758208486, -541.0231535055653, -1125.434300415949, -984.3723124808683, -429.7222534158838, -752.3537989382586, -205.88952017841066, -990.2091574188591, -1027.5685877202693, -215.41967529908203, -182.37122248886195, -480.83870396762006, -737.9222295361354, -1080.7416806523802, -833.9699324847084, -1137.1294311662166, -893.3147898324569, -893.9468757399649, -851.7634940601963, -986.657430128482, -1113.2398553884273, -138.0989190362155, -1179.967371616979, -160.57085595646328, -566.1466076367198, -821.1350395270051, -1050.9830169141005, -491.86020729910774, -1015.9511849449855, -659.7831722016442, -622.7734614072912, -988.7863201439656, -32.855558086490966, -376.2954234779427, -921.1669078274639, -1096.8498057856762, -866.3013322301683, -401.8603905793537, -814.5896340853764, -892.0225351765159, -936.1480991749178, -476.1926623426417, -794.5271335000907, -408.8640031302985, -851.7762319988545, -238.8644967013809, -403.7845115970032, -1087.0470427227094, -1063.2949394816217, -92.91538979942379, -1041.9737372296568, -857.802473580003, -239.66016609629608, -1063.473919718925, -906.185347234993, -735.1698641396999, -138.4043302378232, -817.0132402373457, -499.85838856516887, -529.6537098857019, -795.8387509653892, -541.233600557335, -49.08859485895271, -881.7221400773063, -535.036077065095, -1043.2586585170873, -758.8392717402977, -201.99694612930224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5648655839007297, "mean_inference_ms": 1.6794426349755613, "mean_action_processing_ms": 0.283700350013284, "mean_env_wait_ms": 2.987666720786775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013513803482055664, "StateBufferConnector_ms": 0.008458375930786133, "ViewRequirementAgentConnector_ms": 0.1874985694885254}, "num_episodes": 29, "episode_return_max": -32.855558086490966, "episode_return_min": -1230.4251267973489, "episode_return_mean": -692.0835861150517, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.16362363025314, "num_env_steps_trained_throughput_per_sec": 319.16362363025314, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12632.38, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12632.311, "sample_time_ms": 1033.863, "learn_time_ms": 11533.391, "learn_throughput": 346.819, "synch_weights_time_ms": 64.277}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00010", "date": "2024-08-03_04-03-42", "timestamp": 1722638022, "time_this_iter_s": 12.545014142990112, "time_total_s": 50.57559061050415, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b18430>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.57559061050415, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.36111111111111, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.258881119887034, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.638346895575523, "policy_loss": -0.016325364068810206, "vf_loss": 8.650936950743198, "vf_explained_var": 0.6960688527052601, "kl": 0.019413861327908913, "entropy": 1.474444783354799, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -10.153547123529007, "episode_reward_min": -1179.967371616979, "episode_reward_mean": -705.5357227524062, "episode_len_mean": 138.35, "episode_media": {}, "episodes_timesteps_total": 13835, "policy_reward_min": {"policy_0": -1179.967371616979}, "policy_reward_max": {"policy_0": -10.153547123529007}, "policy_reward_mean": {"policy_0": -705.5357227524062}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-505.3673705601017, -384.2649119529205, -1052.1816585694462, -877.0774857907633, -237.9685450391641, -748.1472784027633, -40.808239947922154, -1169.238758208486, -541.0231535055653, -1125.434300415949, -984.3723124808683, -429.7222534158838, -752.3537989382586, -205.88952017841066, -990.2091574188591, -1027.5685877202693, -215.41967529908203, -182.37122248886195, -480.83870396762006, -737.9222295361354, -1080.7416806523802, -833.9699324847084, -1137.1294311662166, -893.3147898324569, -893.9468757399649, -851.7634940601963, -986.657430128482, -1113.2398553884273, -138.0989190362155, -1179.967371616979, -160.57085595646328, -566.1466076367198, -821.1350395270051, -1050.9830169141005, -491.86020729910774, -1015.9511849449855, -659.7831722016442, -622.7734614072912, -988.7863201439656, -32.855558086490966, -376.2954234779427, -921.1669078274639, -1096.8498057856762, -866.3013322301683, -401.8603905793537, -814.5896340853764, -892.0225351765159, -936.1480991749178, -476.1926623426417, -794.5271335000907, -408.8640031302985, -851.7762319988545, -238.8644967013809, -403.7845115970032, -1087.0470427227094, -1063.2949394816217, -92.91538979942379, -1041.9737372296568, -857.802473580003, -239.66016609629608, -1063.473919718925, -906.185347234993, -735.1698641396999, -138.4043302378232, -817.0132402373457, -499.85838856516887, -529.6537098857019, -795.8387509653892, -541.233600557335, -49.08859485895271, -881.7221400773063, -535.036077065095, -1043.2586585170873, -758.8392717402977, -201.99694612930224, -959.6502570732735, -197.11789586691586, -931.2101229902221, -762.8422520304601, -607.6982921401534, -861.4325636199047, -697.4272979705372, -421.9372864264011, -883.9154300444499, -984.1257263238953, -1032.243198631167, -822.4690614730537, -830.3123228583166, -749.4877827844844, -1128.932595988095, -783.4351667313882, -1018.7566333958857, -919.187951109875, -993.2268363402155, -1172.6263534443535, -10.153547123529007, -461.1715300850062, -957.6413168551591, -136.5426884935526, -663.4640409313523], "episode_lengths": [150, 150, 150, 150, 150, 150, 43, 150, 127, 150, 150, 150, 150, 90, 150, 150, 75, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 73, 150, 150, 90, 150, 150, 150, 89, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 105, 150, 106, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 124, 150, 95, 150], "policy_policy_0_reward": [-505.3673705601017, -384.2649119529205, -1052.1816585694462, -877.0774857907633, -237.9685450391641, -748.1472784027633, -40.808239947922154, -1169.238758208486, -541.0231535055653, -1125.434300415949, -984.3723124808683, -429.7222534158838, -752.3537989382586, -205.88952017841066, -990.2091574188591, -1027.5685877202693, -215.41967529908203, -182.37122248886195, -480.83870396762006, -737.9222295361354, -1080.7416806523802, -833.9699324847084, -1137.1294311662166, -893.3147898324569, -893.9468757399649, -851.7634940601963, -986.657430128482, -1113.2398553884273, -138.0989190362155, -1179.967371616979, -160.57085595646328, -566.1466076367198, -821.1350395270051, -1050.9830169141005, -491.86020729910774, -1015.9511849449855, -659.7831722016442, -622.7734614072912, -988.7863201439656, -32.855558086490966, -376.2954234779427, -921.1669078274639, -1096.8498057856762, -866.3013322301683, -401.8603905793537, -814.5896340853764, -892.0225351765159, -936.1480991749178, -476.1926623426417, -794.5271335000907, -408.8640031302985, -851.7762319988545, -238.8644967013809, -403.7845115970032, -1087.0470427227094, -1063.2949394816217, -92.91538979942379, -1041.9737372296568, -857.802473580003, -239.66016609629608, -1063.473919718925, -906.185347234993, -735.1698641396999, -138.4043302378232, -817.0132402373457, -499.85838856516887, -529.6537098857019, -795.8387509653892, -541.233600557335, -49.08859485895271, -881.7221400773063, -535.036077065095, -1043.2586585170873, -758.8392717402977, -201.99694612930224, -959.6502570732735, -197.11789586691586, -931.2101229902221, -762.8422520304601, -607.6982921401534, -861.4325636199047, -697.4272979705372, -421.9372864264011, -883.9154300444499, -984.1257263238953, -1032.243198631167, -822.4690614730537, -830.3123228583166, -749.4877827844844, -1128.932595988095, -783.4351667313882, -1018.7566333958857, -919.187951109875, -993.2268363402155, -1172.6263534443535, -10.153547123529007, -461.1715300850062, -957.6413168551591, -136.5426884935526, -663.4640409313523]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5612203535427767, "mean_inference_ms": 1.6804472573827312, "mean_action_processing_ms": 0.28325655057026444, "mean_env_wait_ms": 2.9898310150711738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013340234756469727, "StateBufferConnector_ms": 0.008545160293579102, "ViewRequirementAgentConnector_ms": 0.18871283531188965}, "num_episodes": 25, "episode_return_max": -10.153547123529007, "episode_return_min": -1179.967371616979, "episode_return_mean": -705.5357227524062, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.89465348561, "num_env_steps_trained_throughput_per_sec": 307.89465348561, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12704.198, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12704.13, "sample_time_ms": 1033.622, "learn_time_ms": 11606.985, "learn_throughput": 344.62, "synch_weights_time_ms": 62.752}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00010", "date": "2024-08-03_04-03-55", "timestamp": 1722638035, "time_this_iter_s": 13.004058361053467, "time_total_s": 63.57964897155762, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c721a20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 63.57964897155762, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.4, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.59467198277513, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.174886708209912, "policy_loss": -0.0125081992004804, "vf_loss": 6.183381072928508, "vf_explained_var": 0.7641368374849359, "kl": 0.020840585901927017, "entropy": 1.5428887408226728, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -10.153547123529007, "episode_reward_min": -1446.2858078112163, "episode_reward_mean": -720.3809094748482, "episode_len_mean": 139.72, "episode_media": {}, "episodes_timesteps_total": 13972, "policy_reward_min": {"policy_0": -1446.2858078112163}, "policy_reward_max": {"policy_0": -10.153547123529007}, "policy_reward_mean": {"policy_0": -720.3809094748482}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1179.967371616979, -160.57085595646328, -566.1466076367198, -821.1350395270051, -1050.9830169141005, -491.86020729910774, -1015.9511849449855, -659.7831722016442, -622.7734614072912, -988.7863201439656, -32.855558086490966, -376.2954234779427, -921.1669078274639, -1096.8498057856762, -866.3013322301683, -401.8603905793537, -814.5896340853764, -892.0225351765159, -936.1480991749178, -476.1926623426417, -794.5271335000907, -408.8640031302985, -851.7762319988545, -238.8644967013809, -403.7845115970032, -1087.0470427227094, -1063.2949394816217, -92.91538979942379, -1041.9737372296568, -857.802473580003, -239.66016609629608, -1063.473919718925, -906.185347234993, -735.1698641396999, -138.4043302378232, -817.0132402373457, -499.85838856516887, -529.6537098857019, -795.8387509653892, -541.233600557335, -49.08859485895271, -881.7221400773063, -535.036077065095, -1043.2586585170873, -758.8392717402977, -201.99694612930224, -959.6502570732735, -197.11789586691586, -931.2101229902221, -762.8422520304601, -607.6982921401534, -861.4325636199047, -697.4272979705372, -421.9372864264011, -883.9154300444499, -984.1257263238953, -1032.243198631167, -822.4690614730537, -830.3123228583166, -749.4877827844844, -1128.932595988095, -783.4351667313882, -1018.7566333958857, -919.187951109875, -993.2268363402155, -1172.6263534443535, -10.153547123529007, -461.1715300850062, -957.6413168551591, -136.5426884935526, -663.4640409313523, -451.7607202380434, -596.1747509548882, -259.6461650565741, -657.3805377441851, -1285.1688453871175, -539.8516977209475, -433.5132996498601, -1032.0335295788896, -840.7724392540332, -65.86710841624911, -1086.8274411215511, -1291.1645889607385, -837.5851275786953, -971.0271831086135, -866.8376284924626, -1016.9731949546822, -793.4096702542909, -1101.8758784703489, -966.7392911263535, -1446.2858078112163, -767.3540392494302, -547.6726265305365, -810.0815481073641, -99.24662865158245, -771.9119666410315, -305.83548229313664, -840.6175058774295, -754.2347424717684, -663.7107988685539], "episode_lengths": [150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 73, 150, 150, 90, 150, 150, 150, 89, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 105, 150, 106, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 124, 150, 95, 150, 150, 150, 150, 150, 150, 135, 113, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1179.967371616979, -160.57085595646328, -566.1466076367198, -821.1350395270051, -1050.9830169141005, -491.86020729910774, -1015.9511849449855, -659.7831722016442, -622.7734614072912, -988.7863201439656, -32.855558086490966, -376.2954234779427, -921.1669078274639, -1096.8498057856762, -866.3013322301683, -401.8603905793537, -814.5896340853764, -892.0225351765159, -936.1480991749178, -476.1926623426417, -794.5271335000907, -408.8640031302985, -851.7762319988545, -238.8644967013809, -403.7845115970032, -1087.0470427227094, -1063.2949394816217, -92.91538979942379, -1041.9737372296568, -857.802473580003, -239.66016609629608, -1063.473919718925, -906.185347234993, -735.1698641396999, -138.4043302378232, -817.0132402373457, -499.85838856516887, -529.6537098857019, -795.8387509653892, -541.233600557335, -49.08859485895271, -881.7221400773063, -535.036077065095, -1043.2586585170873, -758.8392717402977, -201.99694612930224, -959.6502570732735, -197.11789586691586, -931.2101229902221, -762.8422520304601, -607.6982921401534, -861.4325636199047, -697.4272979705372, -421.9372864264011, -883.9154300444499, -984.1257263238953, -1032.243198631167, -822.4690614730537, -830.3123228583166, -749.4877827844844, -1128.932595988095, -783.4351667313882, -1018.7566333958857, -919.187951109875, -993.2268363402155, -1172.6263534443535, -10.153547123529007, -461.1715300850062, -957.6413168551591, -136.5426884935526, -663.4640409313523, -451.7607202380434, -596.1747509548882, -259.6461650565741, -657.3805377441851, -1285.1688453871175, -539.8516977209475, -433.5132996498601, -1032.0335295788896, -840.7724392540332, -65.86710841624911, -1086.8274411215511, -1291.1645889607385, -837.5851275786953, -971.0271831086135, -866.8376284924626, -1016.9731949546822, -793.4096702542909, -1101.8758784703489, -966.7392911263535, -1446.2858078112163, -767.3540392494302, -547.6726265305365, -810.0815481073641, -99.24662865158245, -771.9119666410315, -305.83548229313664, -840.6175058774295, -754.2347424717684, -663.7107988685539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5592849151528485, "mean_inference_ms": 1.683223139189555, "mean_action_processing_ms": 0.2832784179121211, "mean_env_wait_ms": 2.991820701329059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013245820999145508, "StateBufferConnector_ms": 0.008616209030151367, "ViewRequirementAgentConnector_ms": 0.18921995162963867}, "num_episodes": 29, "episode_return_max": -10.153547123529007, "episode_return_min": -1446.2858078112163, "episode_return_mean": -720.3809094748482, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.5482506360106, "num_env_steps_trained_throughput_per_sec": 298.5482506360106, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12819.862, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12819.791, "sample_time_ms": 1044.843, "learn_time_ms": 11711.158, "learn_throughput": 341.555, "synch_weights_time_ms": 63.022}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00010", "date": "2024-08-03_04-04-08", "timestamp": 1722638048, "time_this_iter_s": 13.411500215530396, "time_total_s": 76.99114918708801, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b19fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76.99114918708801, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.352631578947364, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 45.53724682927132, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.699307452390591, "policy_loss": -0.009582715206003437, "vf_loss": 5.704247489571571, "vf_explained_var": 0.8085831953833501, "kl": 0.015943511396729573, "entropy": 1.4036985797186692, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -10.153547123529007, "episode_reward_min": -1446.2858078112163, "episode_reward_mean": -731.6607729629827, "episode_len_mean": 140.91, "episode_media": {}, "episodes_timesteps_total": 14091, "policy_reward_min": {"policy_0": -1446.2858078112163}, "policy_reward_max": {"policy_0": -10.153547123529007}, "policy_reward_mean": {"policy_0": -731.6607729629827}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-239.66016609629608, -1063.473919718925, -906.185347234993, -735.1698641396999, -138.4043302378232, -817.0132402373457, -499.85838856516887, -529.6537098857019, -795.8387509653892, -541.233600557335, -49.08859485895271, -881.7221400773063, -535.036077065095, -1043.2586585170873, -758.8392717402977, -201.99694612930224, -959.6502570732735, -197.11789586691586, -931.2101229902221, -762.8422520304601, -607.6982921401534, -861.4325636199047, -697.4272979705372, -421.9372864264011, -883.9154300444499, -984.1257263238953, -1032.243198631167, -822.4690614730537, -830.3123228583166, -749.4877827844844, -1128.932595988095, -783.4351667313882, -1018.7566333958857, -919.187951109875, -993.2268363402155, -1172.6263534443535, -10.153547123529007, -461.1715300850062, -957.6413168551591, -136.5426884935526, -663.4640409313523, -451.7607202380434, -596.1747509548882, -259.6461650565741, -657.3805377441851, -1285.1688453871175, -539.8516977209475, -433.5132996498601, -1032.0335295788896, -840.7724392540332, -65.86710841624911, -1086.8274411215511, -1291.1645889607385, -837.5851275786953, -971.0271831086135, -866.8376284924626, -1016.9731949546822, -793.4096702542909, -1101.8758784703489, -966.7392911263535, -1446.2858078112163, -767.3540392494302, -547.6726265305365, -810.0815481073641, -99.24662865158245, -771.9119666410315, -305.83548229313664, -840.6175058774295, -754.2347424717684, -663.7107988685539, -786.8370762405601, -302.51077685149573, -1004.4010558982611, -697.1880696946304, -467.6256040570456, -713.7736481823115, -1152.28055800278, -1201.630743635068, -552.6752136534777, -603.0021022147625, -275.8119472086419, -486.8354395428292, -1165.4111352652185, -409.92055597386695, -474.74105893113386, -788.4052474556594, -1128.204803971405, -857.2244318776187, -696.9002329824261, -487.53467613376625, -969.5790961413795, -421.08427106587436, -669.2397079428467, -1302.494998352055, -979.6937316853359, -765.9611439320927, -781.2860684075646, -627.7127839469343, -865.8151068329557, -705.2946088893265], "episode_lengths": [90, 150, 150, 150, 89, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 105, 150, 106, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 44, 124, 150, 95, 150, 150, 150, 150, 150, 150, 135, 113, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 88, 150, 150, 139, 150, 150, 150, 150, 150, 94, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-239.66016609629608, -1063.473919718925, -906.185347234993, -735.1698641396999, -138.4043302378232, -817.0132402373457, -499.85838856516887, -529.6537098857019, -795.8387509653892, -541.233600557335, -49.08859485895271, -881.7221400773063, -535.036077065095, -1043.2586585170873, -758.8392717402977, -201.99694612930224, -959.6502570732735, -197.11789586691586, -931.2101229902221, -762.8422520304601, -607.6982921401534, -861.4325636199047, -697.4272979705372, -421.9372864264011, -883.9154300444499, -984.1257263238953, -1032.243198631167, -822.4690614730537, -830.3123228583166, -749.4877827844844, -1128.932595988095, -783.4351667313882, -1018.7566333958857, -919.187951109875, -993.2268363402155, -1172.6263534443535, -10.153547123529007, -461.1715300850062, -957.6413168551591, -136.5426884935526, -663.4640409313523, -451.7607202380434, -596.1747509548882, -259.6461650565741, -657.3805377441851, -1285.1688453871175, -539.8516977209475, -433.5132996498601, -1032.0335295788896, -840.7724392540332, -65.86710841624911, -1086.8274411215511, -1291.1645889607385, -837.5851275786953, -971.0271831086135, -866.8376284924626, -1016.9731949546822, -793.4096702542909, -1101.8758784703489, -966.7392911263535, -1446.2858078112163, -767.3540392494302, -547.6726265305365, -810.0815481073641, -99.24662865158245, -771.9119666410315, -305.83548229313664, -840.6175058774295, -754.2347424717684, -663.7107988685539, -786.8370762405601, -302.51077685149573, -1004.4010558982611, -697.1880696946304, -467.6256040570456, -713.7736481823115, -1152.28055800278, -1201.630743635068, -552.6752136534777, -603.0021022147625, -275.8119472086419, -486.8354395428292, -1165.4111352652185, -409.92055597386695, -474.74105893113386, -788.4052474556594, -1128.204803971405, -857.2244318776187, -696.9002329824261, -487.53467613376625, -969.5790961413795, -421.08427106587436, -669.2397079428467, -1302.494998352055, -979.6937316853359, -765.9611439320927, -781.2860684075646, -627.7127839469343, -865.8151068329557, -705.2946088893265]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5570899620275908, "mean_inference_ms": 1.6811162308000467, "mean_action_processing_ms": 0.2826598141767969, "mean_env_wait_ms": 2.9926974657117507, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01282501220703125, "StateBufferConnector_ms": 0.008567094802856445, "ViewRequirementAgentConnector_ms": 0.1922013759613037}, "num_episodes": 30, "episode_return_max": -10.153547123529007, "episode_return_min": -1446.2858078112163, "episode_return_mean": -731.6607729629827, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.4331902411121, "num_env_steps_trained_throughput_per_sec": 304.4331902411121, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12865.48, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12865.408, "sample_time_ms": 1042.117, "learn_time_ms": 11759.248, "learn_throughput": 340.158, "synch_weights_time_ms": 63.279}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00010", "date": "2024-08-03_04-04-22", "timestamp": 1722638062, "time_this_iter_s": 13.153501749038696, "time_total_s": 90.14465093612671, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b1b7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 90.14465093612671, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.068421052631578, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.72856202125549, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.92950049166878, "policy_loss": -0.012427601233260551, "vf_loss": 5.937621362258991, "vf_explained_var": 0.8775637132426103, "kl": 0.014838664101936653, "entropy": 1.4485141129543384, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -10.153547123529007, "episode_reward_min": -1446.2858078112163, "episode_reward_mean": -743.5892670672116, "episode_len_mean": 141.37, "episode_media": {}, "episodes_timesteps_total": 14137, "policy_reward_min": {"policy_0": -1446.2858078112163}, "policy_reward_max": {"policy_0": -10.153547123529007}, "policy_reward_mean": {"policy_0": -743.5892670672116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-749.4877827844844, -1128.932595988095, -783.4351667313882, -1018.7566333958857, -919.187951109875, -993.2268363402155, -1172.6263534443535, -10.153547123529007, -461.1715300850062, -957.6413168551591, -136.5426884935526, -663.4640409313523, -451.7607202380434, -596.1747509548882, -259.6461650565741, -657.3805377441851, -1285.1688453871175, -539.8516977209475, -433.5132996498601, -1032.0335295788896, -840.7724392540332, -65.86710841624911, -1086.8274411215511, -1291.1645889607385, -837.5851275786953, -971.0271831086135, -866.8376284924626, -1016.9731949546822, -793.4096702542909, -1101.8758784703489, -966.7392911263535, -1446.2858078112163, -767.3540392494302, -547.6726265305365, -810.0815481073641, -99.24662865158245, -771.9119666410315, -305.83548229313664, -840.6175058774295, -754.2347424717684, -663.7107988685539, -786.8370762405601, -302.51077685149573, -1004.4010558982611, -697.1880696946304, -467.6256040570456, -713.7736481823115, -1152.28055800278, -1201.630743635068, -552.6752136534777, -603.0021022147625, -275.8119472086419, -486.8354395428292, -1165.4111352652185, -409.92055597386695, -474.74105893113386, -788.4052474556594, -1128.204803971405, -857.2244318776187, -696.9002329824261, -487.53467613376625, -969.5790961413795, -421.08427106587436, -669.2397079428467, -1302.494998352055, -979.6937316853359, -765.9611439320927, -781.2860684075646, -627.7127839469343, -865.8151068329557, -705.2946088893265, -377.81300024823867, -536.9234965200067, -925.3666088920678, -972.7406283050492, -920.6172870293982, -576.2163979666819, -822.2128101369376, -831.7578573351772, -1020.090357695485, -1056.2566517965104, -589.7595170731096, -1126.6466146985867, -1180.8973125843215, -1002.0247120373851, -786.8853548495589, -1108.1796360067035, -304.97534914846, -310.9249188207943, -624.1382051542951, -48.60298789887449, -1261.1671675781467, -533.065241790798, -268.5926718908757, -1106.6192491029863, -599.1768716139571, -542.4094872934899, -682.1165908114085, -163.62576627821892, -641.8613733408475], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 44, 124, 150, 95, 150, 150, 150, 150, 150, 150, 135, 113, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 88, 150, 150, 139, 150, 150, 150, 150, 150, 94, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 60, 150, 150, 102, 150, 150, 150, 150, 67, 150], "policy_policy_0_reward": [-749.4877827844844, -1128.932595988095, -783.4351667313882, -1018.7566333958857, -919.187951109875, -993.2268363402155, -1172.6263534443535, -10.153547123529007, -461.1715300850062, -957.6413168551591, -136.5426884935526, -663.4640409313523, -451.7607202380434, -596.1747509548882, -259.6461650565741, -657.3805377441851, -1285.1688453871175, -539.8516977209475, -433.5132996498601, -1032.0335295788896, -840.7724392540332, -65.86710841624911, -1086.8274411215511, -1291.1645889607385, -837.5851275786953, -971.0271831086135, -866.8376284924626, -1016.9731949546822, -793.4096702542909, -1101.8758784703489, -966.7392911263535, -1446.2858078112163, -767.3540392494302, -547.6726265305365, -810.0815481073641, -99.24662865158245, -771.9119666410315, -305.83548229313664, -840.6175058774295, -754.2347424717684, -663.7107988685539, -786.8370762405601, -302.51077685149573, -1004.4010558982611, -697.1880696946304, -467.6256040570456, -713.7736481823115, -1152.28055800278, -1201.630743635068, -552.6752136534777, -603.0021022147625, -275.8119472086419, -486.8354395428292, -1165.4111352652185, -409.92055597386695, -474.74105893113386, -788.4052474556594, -1128.204803971405, -857.2244318776187, -696.9002329824261, -487.53467613376625, -969.5790961413795, -421.08427106587436, -669.2397079428467, -1302.494998352055, -979.6937316853359, -765.9611439320927, -781.2860684075646, -627.7127839469343, -865.8151068329557, -705.2946088893265, -377.81300024823867, -536.9234965200067, -925.3666088920678, -972.7406283050492, -920.6172870293982, -576.2163979666819, -822.2128101369376, -831.7578573351772, -1020.090357695485, -1056.2566517965104, -589.7595170731096, -1126.6466146985867, -1180.8973125843215, -1002.0247120373851, -786.8853548495589, -1108.1796360067035, -304.97534914846, -310.9249188207943, -624.1382051542951, -48.60298789887449, -1261.1671675781467, -533.065241790798, -268.5926718908757, -1106.6192491029863, -599.1768716139571, -542.4094872934899, -682.1165908114085, -163.62576627821892, -641.8613733408475]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559709377514348, "mean_inference_ms": 1.6819618339462827, "mean_action_processing_ms": 0.28225172503620116, "mean_env_wait_ms": 3.001325030038663, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012465476989746094, "StateBufferConnector_ms": 0.008348226547241211, "ViewRequirementAgentConnector_ms": 0.19277620315551758}, "num_episodes": 29, "episode_return_max": -10.153547123529007, "episode_return_min": -1446.2858078112163, "episode_return_mean": -743.5892670672116, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.5434604309803, "num_env_steps_trained_throughput_per_sec": 311.5434604309803, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12862.209, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12862.137, "sample_time_ms": 1040.667, "learn_time_ms": 11757.213, "learn_throughput": 340.217, "synch_weights_time_ms": 63.495}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00010", "date": "2024-08-03_04-04-35", "timestamp": 1722638075, "time_this_iter_s": 12.851967573165894, "time_total_s": 102.9966185092926, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b1a560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.9966185092926, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.516666666666666, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.21057509382566, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.053433093925317, "policy_loss": -0.02038768934677743, "vf_loss": 6.067007146279017, "vf_explained_var": 0.8800308444847663, "kl": 0.023212005123711316, "entropy": 1.4995024209221204, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -48.60298789887449, "episode_reward_min": -1446.2858078112163, "episode_reward_mean": -732.0253352212634, "episode_len_mean": 141.54, "episode_media": {}, "episodes_timesteps_total": 14154, "policy_reward_min": {"policy_0": -1446.2858078112163}, "policy_reward_max": {"policy_0": -48.60298789887449}, "policy_reward_mean": {"policy_0": -732.0253352212634}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.4096702542909, -1101.8758784703489, -966.7392911263535, -1446.2858078112163, -767.3540392494302, -547.6726265305365, -810.0815481073641, -99.24662865158245, -771.9119666410315, -305.83548229313664, -840.6175058774295, -754.2347424717684, -663.7107988685539, -786.8370762405601, -302.51077685149573, -1004.4010558982611, -697.1880696946304, -467.6256040570456, -713.7736481823115, -1152.28055800278, -1201.630743635068, -552.6752136534777, -603.0021022147625, -275.8119472086419, -486.8354395428292, -1165.4111352652185, -409.92055597386695, -474.74105893113386, -788.4052474556594, -1128.204803971405, -857.2244318776187, -696.9002329824261, -487.53467613376625, -969.5790961413795, -421.08427106587436, -669.2397079428467, -1302.494998352055, -979.6937316853359, -765.9611439320927, -781.2860684075646, -627.7127839469343, -865.8151068329557, -705.2946088893265, -377.81300024823867, -536.9234965200067, -925.3666088920678, -972.7406283050492, -920.6172870293982, -576.2163979666819, -822.2128101369376, -831.7578573351772, -1020.090357695485, -1056.2566517965104, -589.7595170731096, -1126.6466146985867, -1180.8973125843215, -1002.0247120373851, -786.8853548495589, -1108.1796360067035, -304.97534914846, -310.9249188207943, -624.1382051542951, -48.60298789887449, -1261.1671675781467, -533.065241790798, -268.5926718908757, -1106.6192491029863, -599.1768716139571, -542.4094872934899, -682.1165908114085, -163.62576627821892, -641.8613733408475, -367.18856202310604, -168.6561308962378, -848.0147306032133, -940.6823424603339, -825.0227074986934, -1273.32789199773, -844.7162618935132, -559.7969726778568, -625.9592440029978, -986.586000180001, -831.0706677971802, -1124.076493195991, -651.9249957509653, -214.7580461420229, -758.7635250611447, -1106.4764168242104, -1201.031469512682, -576.4149401415488, -179.8626150907347, -1131.2742694706076, -1024.9017442228258, -215.77329346469725, -356.7922609404728, -611.2356233726523, -1176.3924507659924, -459.7924816454504, -735.5240988037575, -274.80128046898375], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 88, 150, 150, 139, 150, 150, 150, 150, 150, 94, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 60, 150, 150, 102, 150, 150, 150, 150, 67, 150, 141, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 86, 150, 150, 76, 103, 150, 150, 150, 150, 129], "policy_policy_0_reward": [-793.4096702542909, -1101.8758784703489, -966.7392911263535, -1446.2858078112163, -767.3540392494302, -547.6726265305365, -810.0815481073641, -99.24662865158245, -771.9119666410315, -305.83548229313664, -840.6175058774295, -754.2347424717684, -663.7107988685539, -786.8370762405601, -302.51077685149573, -1004.4010558982611, -697.1880696946304, -467.6256040570456, -713.7736481823115, -1152.28055800278, -1201.630743635068, -552.6752136534777, -603.0021022147625, -275.8119472086419, -486.8354395428292, -1165.4111352652185, -409.92055597386695, -474.74105893113386, -788.4052474556594, -1128.204803971405, -857.2244318776187, -696.9002329824261, -487.53467613376625, -969.5790961413795, -421.08427106587436, -669.2397079428467, -1302.494998352055, -979.6937316853359, -765.9611439320927, -781.2860684075646, -627.7127839469343, -865.8151068329557, -705.2946088893265, -377.81300024823867, -536.9234965200067, -925.3666088920678, -972.7406283050492, -920.6172870293982, -576.2163979666819, -822.2128101369376, -831.7578573351772, -1020.090357695485, -1056.2566517965104, -589.7595170731096, -1126.6466146985867, -1180.8973125843215, -1002.0247120373851, -786.8853548495589, -1108.1796360067035, -304.97534914846, -310.9249188207943, -624.1382051542951, -48.60298789887449, -1261.1671675781467, -533.065241790798, -268.5926718908757, -1106.6192491029863, -599.1768716139571, -542.4094872934899, -682.1165908114085, -163.62576627821892, -641.8613733408475, -367.18856202310604, -168.6561308962378, -848.0147306032133, -940.6823424603339, -825.0227074986934, -1273.32789199773, -844.7162618935132, -559.7969726778568, -625.9592440029978, -986.586000180001, -831.0706677971802, -1124.076493195991, -651.9249957509653, -214.7580461420229, -758.7635250611447, -1106.4764168242104, -1201.031469512682, -576.4149401415488, -179.8626150907347, -1131.2742694706076, -1024.9017442228258, -215.77329346469725, -356.7922609404728, -611.2356233726523, -1176.3924507659924, -459.7924816454504, -735.5240988037575, -274.80128046898375]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547394006570154, "mean_inference_ms": 1.6787049514574295, "mean_action_processing_ms": 0.2814342976381761, "mean_env_wait_ms": 3.002321474971355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011929512023925781, "StateBufferConnector_ms": 0.00814199447631836, "ViewRequirementAgentConnector_ms": 0.191420316696167}, "num_episodes": 28, "episode_return_max": -48.60298789887449, "episode_return_min": -1446.2858078112163, "episode_return_mean": -732.0253352212634, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.71117845245476, "num_env_steps_trained_throughput_per_sec": 316.71117845245476, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12836.388, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12836.314, "sample_time_ms": 1038.417, "learn_time_ms": 11734.233, "learn_throughput": 340.883, "synch_weights_time_ms": 62.906}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00010", "date": "2024-08-03_04-04-47", "timestamp": 1722638087, "time_this_iter_s": 12.642319917678833, "time_total_s": 115.63893842697144, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad2b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.63893842697144, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.655555555555555, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 71.74689074556032, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.5553693676988285, "policy_loss": -0.01395778676281528, "vf_loss": 4.562474376211564, "vf_explained_var": 0.9417693847169478, "kl": 0.0155451693770677, "entropy": 1.4255156977723042, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -43.06324215670943, "episode_reward_min": -1302.494998352055, "episode_reward_mean": -714.2961701423613, "episode_len_mean": 141.22, "episode_media": {}, "episodes_timesteps_total": 14122, "policy_reward_min": {"policy_0": -1302.494998352055}, "policy_reward_max": {"policy_0": -43.06324215670943}, "policy_reward_mean": {"policy_0": -714.2961701423613}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-788.4052474556594, -1128.204803971405, -857.2244318776187, -696.9002329824261, -487.53467613376625, -969.5790961413795, -421.08427106587436, -669.2397079428467, -1302.494998352055, -979.6937316853359, -765.9611439320927, -781.2860684075646, -627.7127839469343, -865.8151068329557, -705.2946088893265, -377.81300024823867, -536.9234965200067, -925.3666088920678, -972.7406283050492, -920.6172870293982, -576.2163979666819, -822.2128101369376, -831.7578573351772, -1020.090357695485, -1056.2566517965104, -589.7595170731096, -1126.6466146985867, -1180.8973125843215, -1002.0247120373851, -786.8853548495589, -1108.1796360067035, -304.97534914846, -310.9249188207943, -624.1382051542951, -48.60298789887449, -1261.1671675781467, -533.065241790798, -268.5926718908757, -1106.6192491029863, -599.1768716139571, -542.4094872934899, -682.1165908114085, -163.62576627821892, -641.8613733408475, -367.18856202310604, -168.6561308962378, -848.0147306032133, -940.6823424603339, -825.0227074986934, -1273.32789199773, -844.7162618935132, -559.7969726778568, -625.9592440029978, -986.586000180001, -831.0706677971802, -1124.076493195991, -651.9249957509653, -214.7580461420229, -758.7635250611447, -1106.4764168242104, -1201.031469512682, -576.4149401415488, -179.8626150907347, -1131.2742694706076, -1024.9017442228258, -215.77329346469725, -356.7922609404728, -611.2356233726523, -1176.3924507659924, -459.7924816454504, -735.5240988037575, -274.80128046898375, -1284.8120016884006, -352.9106840573135, -780.3786341326324, -459.5020083039782, -517.5531632848063, -1134.993073193027, -109.04565690357347, -790.623176754439, -1142.4267475229267, -1168.2805385131032, -677.9854621594661, -391.6798598987553, -325.36938244990324, -858.2875573246241, -836.681279764683, -821.6594809090319, -467.89321410382604, -565.9510943916415, -722.7778115814538, -832.4791031725804, -701.3313341333289, -278.5160198050724, -568.9527588112201, -43.06324215670943, -454.4327161106894, -684.5747078450722, -1107.1743440031132, -311.36941083956214], "episode_lengths": [150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 60, 150, 150, 102, 150, 150, 150, 150, 67, 150, 141, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 86, 150, 150, 76, 103, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 57, 150, 150, 150, 94], "policy_policy_0_reward": [-788.4052474556594, -1128.204803971405, -857.2244318776187, -696.9002329824261, -487.53467613376625, -969.5790961413795, -421.08427106587436, -669.2397079428467, -1302.494998352055, -979.6937316853359, -765.9611439320927, -781.2860684075646, -627.7127839469343, -865.8151068329557, -705.2946088893265, -377.81300024823867, -536.9234965200067, -925.3666088920678, -972.7406283050492, -920.6172870293982, -576.2163979666819, -822.2128101369376, -831.7578573351772, -1020.090357695485, -1056.2566517965104, -589.7595170731096, -1126.6466146985867, -1180.8973125843215, -1002.0247120373851, -786.8853548495589, -1108.1796360067035, -304.97534914846, -310.9249188207943, -624.1382051542951, -48.60298789887449, -1261.1671675781467, -533.065241790798, -268.5926718908757, -1106.6192491029863, -599.1768716139571, -542.4094872934899, -682.1165908114085, -163.62576627821892, -641.8613733408475, -367.18856202310604, -168.6561308962378, -848.0147306032133, -940.6823424603339, -825.0227074986934, -1273.32789199773, -844.7162618935132, -559.7969726778568, -625.9592440029978, -986.586000180001, -831.0706677971802, -1124.076493195991, -651.9249957509653, -214.7580461420229, -758.7635250611447, -1106.4764168242104, -1201.031469512682, -576.4149401415488, -179.8626150907347, -1131.2742694706076, -1024.9017442228258, -215.77329346469725, -356.7922609404728, -611.2356233726523, -1176.3924507659924, -459.7924816454504, -735.5240988037575, -274.80128046898375, -1284.8120016884006, -352.9106840573135, -780.3786341326324, -459.5020083039782, -517.5531632848063, -1134.993073193027, -109.04565690357347, -790.623176754439, -1142.4267475229267, -1168.2805385131032, -677.9854621594661, -391.6798598987553, -325.36938244990324, -858.2875573246241, -836.681279764683, -821.6594809090319, -467.89321410382604, -565.9510943916415, -722.7778115814538, -832.4791031725804, -701.3313341333289, -278.5160198050724, -568.9527588112201, -43.06324215670943, -454.4327161106894, -684.5747078450722, -1107.1743440031132, -311.36941083956214]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541363177159123, "mean_inference_ms": 1.6772743723802859, "mean_action_processing_ms": 0.28071911745894196, "mean_env_wait_ms": 3.0054681085931505, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011924982070922852, "StateBufferConnector_ms": 0.008048295974731445, "ViewRequirementAgentConnector_ms": 0.19066905975341797}, "num_episodes": 28, "episode_return_max": -43.06324215670943, "episode_return_min": -1302.494998352055, "episode_return_mean": -714.2961701423613, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.0931182512592, "num_env_steps_trained_throughput_per_sec": 304.0931182512592, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12868.137, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12868.063, "sample_time_ms": 1039.301, "learn_time_ms": 11764.824, "learn_throughput": 339.997, "synch_weights_time_ms": 63.169}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00010", "date": "2024-08-03_04-05-00", "timestamp": 1722638100, "time_this_iter_s": 13.168381452560425, "time_total_s": 128.80731987953186, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c722ef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 128.80731987953186, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.18421052631579, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 73.11549096008142, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.340816612293323, "policy_loss": -0.011599642630608286, "vf_loss": 5.345895191778739, "vf_explained_var": 0.9490878856430451, "kl": 0.0148377139332297, "entropy": 1.5591600666443506, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -0.6973028943592889, "episode_reward_min": -1284.8120016884006, "episode_reward_mean": -698.5509432176899, "episode_len_mean": 138.0, "episode_media": {}, "episodes_timesteps_total": 13800, "policy_reward_min": {"policy_0": -1284.8120016884006}, "policy_reward_max": {"policy_0": -0.6973028943592889}, "policy_reward_mean": {"policy_0": -698.5509432176899}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1180.8973125843215, -1002.0247120373851, -786.8853548495589, -1108.1796360067035, -304.97534914846, -310.9249188207943, -624.1382051542951, -48.60298789887449, -1261.1671675781467, -533.065241790798, -268.5926718908757, -1106.6192491029863, -599.1768716139571, -542.4094872934899, -682.1165908114085, -163.62576627821892, -641.8613733408475, -367.18856202310604, -168.6561308962378, -848.0147306032133, -940.6823424603339, -825.0227074986934, -1273.32789199773, -844.7162618935132, -559.7969726778568, -625.9592440029978, -986.586000180001, -831.0706677971802, -1124.076493195991, -651.9249957509653, -214.7580461420229, -758.7635250611447, -1106.4764168242104, -1201.031469512682, -576.4149401415488, -179.8626150907347, -1131.2742694706076, -1024.9017442228258, -215.77329346469725, -356.7922609404728, -611.2356233726523, -1176.3924507659924, -459.7924816454504, -735.5240988037575, -274.80128046898375, -1284.8120016884006, -352.9106840573135, -780.3786341326324, -459.5020083039782, -517.5531632848063, -1134.993073193027, -109.04565690357347, -790.623176754439, -1142.4267475229267, -1168.2805385131032, -677.9854621594661, -391.6798598987553, -325.36938244990324, -858.2875573246241, -836.681279764683, -821.6594809090319, -467.89321410382604, -565.9510943916415, -722.7778115814538, -832.4791031725804, -701.3313341333289, -278.5160198050724, -568.9527588112201, -43.06324215670943, -454.4327161106894, -684.5747078450722, -1107.1743440031132, -311.36941083956214, -825.0154031160598, -1243.3459756791729, -890.3802492209918, -1252.563098314561, -1167.7830733321823, -1129.0968809522144, -0.6973028943592889, -596.6455958829954, -1017.1230944596892, -809.8029071966342, -795.528570321537, -1246.9161195299725, -843.8524778225396, -300.2904116788245, -1051.9823201430381, -940.6305933072347, -702.3488705953521, -113.6146754088399, -682.969848183212, -628.0765837238262, -864.5207603263543, -90.91070580014792, -497.71998066074264, -836.8961322348893, -217.08641287350042, -998.9606244393334, -483.55077674911945], "episode_lengths": [150, 150, 150, 150, 126, 150, 150, 60, 150, 150, 102, 150, 150, 150, 150, 67, 150, 141, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 86, 150, 150, 76, 103, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 57, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 83, 150, 150, 150, 69, 135, 150, 117, 150, 150], "policy_policy_0_reward": [-1180.8973125843215, -1002.0247120373851, -786.8853548495589, -1108.1796360067035, -304.97534914846, -310.9249188207943, -624.1382051542951, -48.60298789887449, -1261.1671675781467, -533.065241790798, -268.5926718908757, -1106.6192491029863, -599.1768716139571, -542.4094872934899, -682.1165908114085, -163.62576627821892, -641.8613733408475, -367.18856202310604, -168.6561308962378, -848.0147306032133, -940.6823424603339, -825.0227074986934, -1273.32789199773, -844.7162618935132, -559.7969726778568, -625.9592440029978, -986.586000180001, -831.0706677971802, -1124.076493195991, -651.9249957509653, -214.7580461420229, -758.7635250611447, -1106.4764168242104, -1201.031469512682, -576.4149401415488, -179.8626150907347, -1131.2742694706076, -1024.9017442228258, -215.77329346469725, -356.7922609404728, -611.2356233726523, -1176.3924507659924, -459.7924816454504, -735.5240988037575, -274.80128046898375, -1284.8120016884006, -352.9106840573135, -780.3786341326324, -459.5020083039782, -517.5531632848063, -1134.993073193027, -109.04565690357347, -790.623176754439, -1142.4267475229267, -1168.2805385131032, -677.9854621594661, -391.6798598987553, -325.36938244990324, -858.2875573246241, -836.681279764683, -821.6594809090319, -467.89321410382604, -565.9510943916415, -722.7778115814538, -832.4791031725804, -701.3313341333289, -278.5160198050724, -568.9527588112201, -43.06324215670943, -454.4327161106894, -684.5747078450722, -1107.1743440031132, -311.36941083956214, -825.0154031160598, -1243.3459756791729, -890.3802492209918, -1252.563098314561, -1167.7830733321823, -1129.0968809522144, -0.6973028943592889, -596.6455958829954, -1017.1230944596892, -809.8029071966342, -795.528570321537, -1246.9161195299725, -843.8524778225396, -300.2904116788245, -1051.9823201430381, -940.6305933072347, -702.3488705953521, -113.6146754088399, -682.969848183212, -628.0765837238262, -864.5207603263543, -90.91070580014792, -497.71998066074264, -836.8961322348893, -217.08641287350042, -998.9606244393334, -483.55077674911945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537162553436462, "mean_inference_ms": 1.6778376619934272, "mean_action_processing_ms": 0.28034618572721715, "mean_env_wait_ms": 3.009557859152471, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011818647384643555, "StateBufferConnector_ms": 0.008047103881835938, "ViewRequirementAgentConnector_ms": 0.1905992031097412}, "num_episodes": 27, "episode_return_max": -0.6973028943592889, "episode_return_min": -1284.8120016884006, "episode_return_mean": -698.5509432176899, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.7402080701437, "num_env_steps_trained_throughput_per_sec": 305.7402080701437, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12989.245, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12989.17, "sample_time_ms": 1038.402, "learn_time_ms": 11886.328, "learn_throughput": 336.521, "synch_weights_time_ms": 63.653}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00010", "date": "2024-08-03_04-05-14", "timestamp": 1722638114, "time_this_iter_s": 13.09399700164795, "time_total_s": 141.9013168811798, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b1a560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 141.9013168811798, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.242105263157896, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 106.01530127922693, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.197071686262886, "policy_loss": -0.01112209547184951, "vf_loss": 4.203046386192242, "vf_explained_var": 0.9642636604607105, "kl": 0.011773770518796805, "entropy": 1.5078809338311354, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -0.6973028943592889, "episode_reward_min": -1284.8120016884006, "episode_reward_mean": -715.6615690081571, "episode_len_mean": 139.03, "episode_media": {}, "episodes_timesteps_total": 13903, "policy_reward_min": {"policy_0": -1284.8120016884006}, "policy_reward_max": {"policy_0": -0.6973028943592889}, "policy_reward_mean": {"policy_0": -715.6615690081571}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-214.7580461420229, -758.7635250611447, -1106.4764168242104, -1201.031469512682, -576.4149401415488, -179.8626150907347, -1131.2742694706076, -1024.9017442228258, -215.77329346469725, -356.7922609404728, -611.2356233726523, -1176.3924507659924, -459.7924816454504, -735.5240988037575, -274.80128046898375, -1284.8120016884006, -352.9106840573135, -780.3786341326324, -459.5020083039782, -517.5531632848063, -1134.993073193027, -109.04565690357347, -790.623176754439, -1142.4267475229267, -1168.2805385131032, -677.9854621594661, -391.6798598987553, -325.36938244990324, -858.2875573246241, -836.681279764683, -821.6594809090319, -467.89321410382604, -565.9510943916415, -722.7778115814538, -832.4791031725804, -701.3313341333289, -278.5160198050724, -568.9527588112201, -43.06324215670943, -454.4327161106894, -684.5747078450722, -1107.1743440031132, -311.36941083956214, -825.0154031160598, -1243.3459756791729, -890.3802492209918, -1252.563098314561, -1167.7830733321823, -1129.0968809522144, -0.6973028943592889, -596.6455958829954, -1017.1230944596892, -809.8029071966342, -795.528570321537, -1246.9161195299725, -843.8524778225396, -300.2904116788245, -1051.9823201430381, -940.6305933072347, -702.3488705953521, -113.6146754088399, -682.969848183212, -628.0765837238262, -864.5207603263543, -90.91070580014792, -497.71998066074264, -836.8961322348893, -217.08641287350042, -998.9606244393334, -483.55077674911945, -762.6958136934558, -1088.215028570793, -1081.181105458235, -971.5222682487404, -747.4787807496558, -970.2116231994698, -1015.337194540751, -899.5209294430398, -1181.198036623955, -638.990857338042, -821.6560417287362, -920.3203166835328, -483.26253048685027, -516.0130728850088, -942.5720149890142, -86.2118040088635, -744.2629194425144, -848.7215957411166, -977.8408102726703, -282.33254564332674, -826.3671469157154, -730.4853202213649, -430.868072014043, -698.6883338099161, -1050.0389155085934, -1178.8536039574162, -471.95961771154674, -45.888665303948486, -712.9832956949247, -797.670215340423], "episode_lengths": [126, 150, 150, 150, 150, 86, 150, 150, 76, 103, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 57, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 83, 150, 150, 150, 69, 135, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 114, 54, 150, 150], "policy_policy_0_reward": [-214.7580461420229, -758.7635250611447, -1106.4764168242104, -1201.031469512682, -576.4149401415488, -179.8626150907347, -1131.2742694706076, -1024.9017442228258, -215.77329346469725, -356.7922609404728, -611.2356233726523, -1176.3924507659924, -459.7924816454504, -735.5240988037575, -274.80128046898375, -1284.8120016884006, -352.9106840573135, -780.3786341326324, -459.5020083039782, -517.5531632848063, -1134.993073193027, -109.04565690357347, -790.623176754439, -1142.4267475229267, -1168.2805385131032, -677.9854621594661, -391.6798598987553, -325.36938244990324, -858.2875573246241, -836.681279764683, -821.6594809090319, -467.89321410382604, -565.9510943916415, -722.7778115814538, -832.4791031725804, -701.3313341333289, -278.5160198050724, -568.9527588112201, -43.06324215670943, -454.4327161106894, -684.5747078450722, -1107.1743440031132, -311.36941083956214, -825.0154031160598, -1243.3459756791729, -890.3802492209918, -1252.563098314561, -1167.7830733321823, -1129.0968809522144, -0.6973028943592889, -596.6455958829954, -1017.1230944596892, -809.8029071966342, -795.528570321537, -1246.9161195299725, -843.8524778225396, -300.2904116788245, -1051.9823201430381, -940.6305933072347, -702.3488705953521, -113.6146754088399, -682.969848183212, -628.0765837238262, -864.5207603263543, -90.91070580014792, -497.71998066074264, -836.8961322348893, -217.08641287350042, -998.9606244393334, -483.55077674911945, -762.6958136934558, -1088.215028570793, -1081.181105458235, -971.5222682487404, -747.4787807496558, -970.2116231994698, -1015.337194540751, -899.5209294430398, -1181.198036623955, -638.990857338042, -821.6560417287362, -920.3203166835328, -483.26253048685027, -516.0130728850088, -942.5720149890142, -86.2118040088635, -744.2629194425144, -848.7215957411166, -977.8408102726703, -282.33254564332674, -826.3671469157154, -730.4853202213649, -430.868072014043, -698.6883338099161, -1050.0389155085934, -1178.8536039574162, -471.95961771154674, -45.888665303948486, -712.9832956949247, -797.670215340423]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5522241606264537, "mean_inference_ms": 1.6747522483595092, "mean_action_processing_ms": 0.2796004984443061, "mean_env_wait_ms": 3.0102654158345454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011859893798828125, "StateBufferConnector_ms": 0.008089542388916016, "ViewRequirementAgentConnector_ms": 0.18967986106872559}, "num_episodes": 30, "episode_return_max": -0.6973028943592889, "episode_return_min": -1284.8120016884006, "episode_return_mean": -715.6615690081571, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.33498358060746, "num_env_steps_trained_throughput_per_sec": 305.33498358060746, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12997.89, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12997.814, "sample_time_ms": 1036.337, "learn_time_ms": 11896.298, "learn_throughput": 336.239, "synch_weights_time_ms": 64.381}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00010", "date": "2024-08-03_04-05-27", "timestamp": 1722638127, "time_this_iter_s": 13.114609241485596, "time_total_s": 155.0159261226654, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c723130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 155.0159261226654, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 16.926315789473684, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 121.45013316671053, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.514454606672128, "policy_loss": -0.014698002928829132, "vf_loss": 4.522406353801489, "vf_explained_var": 0.9598753297080597, "kl": 0.01529981701626942, "entropy": 1.3865832769622406, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -0.6973028943592889, "episode_reward_min": -1414.75010835822, "episode_reward_mean": -750.3177113452008, "episode_len_mean": 139.43, "episode_media": {}, "episodes_timesteps_total": 13943, "policy_reward_min": {"policy_0": -1414.75010835822}, "policy_reward_max": {"policy_0": -0.6973028943592889}, "policy_reward_mean": {"policy_0": -750.3177113452008}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-858.2875573246241, -836.681279764683, -821.6594809090319, -467.89321410382604, -565.9510943916415, -722.7778115814538, -832.4791031725804, -701.3313341333289, -278.5160198050724, -568.9527588112201, -43.06324215670943, -454.4327161106894, -684.5747078450722, -1107.1743440031132, -311.36941083956214, -825.0154031160598, -1243.3459756791729, -890.3802492209918, -1252.563098314561, -1167.7830733321823, -1129.0968809522144, -0.6973028943592889, -596.6455958829954, -1017.1230944596892, -809.8029071966342, -795.528570321537, -1246.9161195299725, -843.8524778225396, -300.2904116788245, -1051.9823201430381, -940.6305933072347, -702.3488705953521, -113.6146754088399, -682.969848183212, -628.0765837238262, -864.5207603263543, -90.91070580014792, -497.71998066074264, -836.8961322348893, -217.08641287350042, -998.9606244393334, -483.55077674911945, -762.6958136934558, -1088.215028570793, -1081.181105458235, -971.5222682487404, -747.4787807496558, -970.2116231994698, -1015.337194540751, -899.5209294430398, -1181.198036623955, -638.990857338042, -821.6560417287362, -920.3203166835328, -483.26253048685027, -516.0130728850088, -942.5720149890142, -86.2118040088635, -744.2629194425144, -848.7215957411166, -977.8408102726703, -282.33254564332674, -826.3671469157154, -730.4853202213649, -430.868072014043, -698.6883338099161, -1050.0389155085934, -1178.8536039574162, -471.95961771154674, -45.888665303948486, -712.9832956949247, -797.670215340423, -581.5155698508077, -1089.8014762094206, -206.0347851811864, -957.6978801218845, -1414.75010835822, -491.7319672383678, -1093.0327645356845, -984.8678943083492, -1254.6028500920672, -918.7554628305988, -753.7105682674596, -1175.867700936491, -247.40205909811743, -743.8738015931156, -728.186926844345, -881.3140248341309, -405.2299126226406, -996.3600067450494, -744.3584175824816, -1063.9333049007712, -300.5779006623998, -1037.721284754616, -1148.3486939060685, -1132.9695415080243, -1003.3149772007075, -27.993142788718952, -629.9430686871654, -611.073046835608], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 57, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 83, 150, 150, 150, 69, 135, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 114, 54, 150, 150, 150, 150, 89, 150, 150, 115, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150], "policy_policy_0_reward": [-858.2875573246241, -836.681279764683, -821.6594809090319, -467.89321410382604, -565.9510943916415, -722.7778115814538, -832.4791031725804, -701.3313341333289, -278.5160198050724, -568.9527588112201, -43.06324215670943, -454.4327161106894, -684.5747078450722, -1107.1743440031132, -311.36941083956214, -825.0154031160598, -1243.3459756791729, -890.3802492209918, -1252.563098314561, -1167.7830733321823, -1129.0968809522144, -0.6973028943592889, -596.6455958829954, -1017.1230944596892, -809.8029071966342, -795.528570321537, -1246.9161195299725, -843.8524778225396, -300.2904116788245, -1051.9823201430381, -940.6305933072347, -702.3488705953521, -113.6146754088399, -682.969848183212, -628.0765837238262, -864.5207603263543, -90.91070580014792, -497.71998066074264, -836.8961322348893, -217.08641287350042, -998.9606244393334, -483.55077674911945, -762.6958136934558, -1088.215028570793, -1081.181105458235, -971.5222682487404, -747.4787807496558, -970.2116231994698, -1015.337194540751, -899.5209294430398, -1181.198036623955, -638.990857338042, -821.6560417287362, -920.3203166835328, -483.26253048685027, -516.0130728850088, -942.5720149890142, -86.2118040088635, -744.2629194425144, -848.7215957411166, -977.8408102726703, -282.33254564332674, -826.3671469157154, -730.4853202213649, -430.868072014043, -698.6883338099161, -1050.0389155085934, -1178.8536039574162, -471.95961771154674, -45.888665303948486, -712.9832956949247, -797.670215340423, -581.5155698508077, -1089.8014762094206, -206.0347851811864, -957.6978801218845, -1414.75010835822, -491.7319672383678, -1093.0327645356845, -984.8678943083492, -1254.6028500920672, -918.7554628305988, -753.7105682674596, -1175.867700936491, -247.40205909811743, -743.8738015931156, -728.186926844345, -881.3140248341309, -405.2299126226406, -996.3600067450494, -744.3584175824816, -1063.9333049007712, -300.5779006623998, -1037.721284754616, -1148.3486939060685, -1132.9695415080243, -1003.3149772007075, -27.993142788718952, -629.9430686871654, -611.073046835608]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5521412921265211, "mean_inference_ms": 1.6734693549486668, "mean_action_processing_ms": 0.27913693055590927, "mean_env_wait_ms": 3.01429189864046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011937618255615234, "StateBufferConnector_ms": 0.008105278015136719, "ViewRequirementAgentConnector_ms": 0.19407224655151367}, "num_episodes": 28, "episode_return_max": -0.6973028943592889, "episode_return_min": -1414.75010835822, "episode_return_mean": -750.3177113452008, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.83337501011044, "num_env_steps_trained_throughput_per_sec": 298.83337501011044, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13025.342, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13025.265, "sample_time_ms": 1037.95, "learn_time_ms": 11923.355, "learn_throughput": 335.476, "synch_weights_time_ms": 63.159}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00010", "date": "2024-08-03_04-05-40", "timestamp": 1722638140, "time_this_iter_s": 13.397634983062744, "time_total_s": 168.41356110572815, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c722b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 168.41356110572815, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.19473684210526, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 109.18911394278209, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.108005991081397, "policy_loss": -0.010888029106718022, "vf_loss": 4.113143039743106, "vf_explained_var": 0.969801081220309, "kl": 0.013073283059414582, "entropy": 1.3200202624003092, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -15.046120427145015, "episode_reward_min": -1414.75010835822, "episode_reward_mean": -726.4145962625039, "episode_len_mean": 138.54, "episode_media": {}, "episodes_timesteps_total": 13854, "policy_reward_min": {"policy_0": -1414.75010835822}, "policy_reward_max": {"policy_0": -15.046120427145015}, "policy_reward_mean": {"policy_0": -726.4145962625039}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-940.6305933072347, -702.3488705953521, -113.6146754088399, -682.969848183212, -628.0765837238262, -864.5207603263543, -90.91070580014792, -497.71998066074264, -836.8961322348893, -217.08641287350042, -998.9606244393334, -483.55077674911945, -762.6958136934558, -1088.215028570793, -1081.181105458235, -971.5222682487404, -747.4787807496558, -970.2116231994698, -1015.337194540751, -899.5209294430398, -1181.198036623955, -638.990857338042, -821.6560417287362, -920.3203166835328, -483.26253048685027, -516.0130728850088, -942.5720149890142, -86.2118040088635, -744.2629194425144, -848.7215957411166, -977.8408102726703, -282.33254564332674, -826.3671469157154, -730.4853202213649, -430.868072014043, -698.6883338099161, -1050.0389155085934, -1178.8536039574162, -471.95961771154674, -45.888665303948486, -712.9832956949247, -797.670215340423, -581.5155698508077, -1089.8014762094206, -206.0347851811864, -957.6978801218845, -1414.75010835822, -491.7319672383678, -1093.0327645356845, -984.8678943083492, -1254.6028500920672, -918.7554628305988, -753.7105682674596, -1175.867700936491, -247.40205909811743, -743.8738015931156, -728.186926844345, -881.3140248341309, -405.2299126226406, -996.3600067450494, -744.3584175824816, -1063.9333049007712, -300.5779006623998, -1037.721284754616, -1148.3486939060685, -1132.9695415080243, -1003.3149772007075, -27.993142788718952, -629.9430686871654, -611.073046835608, -1275.0137816669392, -797.3229194035407, -153.15702757848595, -300.25748505080225, -692.5462819679803, -284.03305697784697, -38.28761336305344, -1160.1773156309837, -937.0860342359824, -15.046120427145015, -666.7119765733203, -199.78150754239434, -249.86339369681954, -550.9036884574834, -721.0544807932555, -474.53235675230326, -1096.1964817944086, -813.2934335356948, -588.2175279760256, -264.79840740819213, -1294.323125427379, -949.1708902097737, -991.1995207273648, -830.9347637536254, -907.5505463193653, -593.1197218304956, -1117.2722537996303, -531.4175533661579, -788.8810828958624, -753.7056980653513], "episode_lengths": [150, 150, 83, 150, 150, 150, 69, 135, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 114, 54, 150, 150, 150, 150, 89, 150, 150, 115, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 102, 150, 150, 89, 53, 150, 150, 40, 150, 77, 121, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-940.6305933072347, -702.3488705953521, -113.6146754088399, -682.969848183212, -628.0765837238262, -864.5207603263543, -90.91070580014792, -497.71998066074264, -836.8961322348893, -217.08641287350042, -998.9606244393334, -483.55077674911945, -762.6958136934558, -1088.215028570793, -1081.181105458235, -971.5222682487404, -747.4787807496558, -970.2116231994698, -1015.337194540751, -899.5209294430398, -1181.198036623955, -638.990857338042, -821.6560417287362, -920.3203166835328, -483.26253048685027, -516.0130728850088, -942.5720149890142, -86.2118040088635, -744.2629194425144, -848.7215957411166, -977.8408102726703, -282.33254564332674, -826.3671469157154, -730.4853202213649, -430.868072014043, -698.6883338099161, -1050.0389155085934, -1178.8536039574162, -471.95961771154674, -45.888665303948486, -712.9832956949247, -797.670215340423, -581.5155698508077, -1089.8014762094206, -206.0347851811864, -957.6978801218845, -1414.75010835822, -491.7319672383678, -1093.0327645356845, -984.8678943083492, -1254.6028500920672, -918.7554628305988, -753.7105682674596, -1175.867700936491, -247.40205909811743, -743.8738015931156, -728.186926844345, -881.3140248341309, -405.2299126226406, -996.3600067450494, -744.3584175824816, -1063.9333049007712, -300.5779006623998, -1037.721284754616, -1148.3486939060685, -1132.9695415080243, -1003.3149772007075, -27.993142788718952, -629.9430686871654, -611.073046835608, -1275.0137816669392, -797.3229194035407, -153.15702757848595, -300.25748505080225, -692.5462819679803, -284.03305697784697, -38.28761336305344, -1160.1773156309837, -937.0860342359824, -15.046120427145015, -666.7119765733203, -199.78150754239434, -249.86339369681954, -550.9036884574834, -721.0544807932555, -474.53235675230326, -1096.1964817944086, -813.2934335356948, -588.2175279760256, -264.79840740819213, -1294.323125427379, -949.1708902097737, -991.1995207273648, -830.9347637536254, -907.5505463193653, -593.1197218304956, -1117.2722537996303, -531.4175533661579, -788.8810828958624, -753.7056980653513]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5514992180538194, "mean_inference_ms": 1.6705127807201068, "mean_action_processing_ms": 0.27850176563827317, "mean_env_wait_ms": 3.0119843092394034, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012003898620605469, "StateBufferConnector_ms": 0.007916927337646484, "ViewRequirementAgentConnector_ms": 0.19274497032165527}, "num_episodes": 30, "episode_return_max": -15.046120427145015, "episode_return_min": -1414.75010835822, "episode_return_mean": -726.4145962625039, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.39506357194085, "num_env_steps_trained_throughput_per_sec": 300.39506357194085, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13103.646, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13103.57, "sample_time_ms": 1039.611, "learn_time_ms": 11999.222, "learn_throughput": 333.355, "synch_weights_time_ms": 63.942}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00010", "date": "2024-08-03_04-05-54", "timestamp": 1722638154, "time_this_iter_s": 13.327938795089722, "time_total_s": 181.74149990081787, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8c360e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 181.74149990081787, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.41052631578948, "ram_util_percent": 27.72631578947368}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 152.54809881647427, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.6852334772547084, "policy_loss": -0.00968787222809624, "vf_loss": 3.689048754175504, "vf_explained_var": 0.977001931456228, "kl": 0.01339162536363195, "entropy": 1.5363481036076942, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -15.046120427145015, "episode_reward_min": -1414.75010835822, "episode_reward_mean": -711.1554655718722, "episode_len_mean": 137.1, "episode_media": {}, "episodes_timesteps_total": 13710, "policy_reward_min": {"policy_0": -1414.75010835822}, "policy_reward_max": {"policy_0": -15.046120427145015}, "policy_reward_mean": {"policy_0": -711.1554655718722}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-977.8408102726703, -282.33254564332674, -826.3671469157154, -730.4853202213649, -430.868072014043, -698.6883338099161, -1050.0389155085934, -1178.8536039574162, -471.95961771154674, -45.888665303948486, -712.9832956949247, -797.670215340423, -581.5155698508077, -1089.8014762094206, -206.0347851811864, -957.6978801218845, -1414.75010835822, -491.7319672383678, -1093.0327645356845, -984.8678943083492, -1254.6028500920672, -918.7554628305988, -753.7105682674596, -1175.867700936491, -247.40205909811743, -743.8738015931156, -728.186926844345, -881.3140248341309, -405.2299126226406, -996.3600067450494, -744.3584175824816, -1063.9333049007712, -300.5779006623998, -1037.721284754616, -1148.3486939060685, -1132.9695415080243, -1003.3149772007075, -27.993142788718952, -629.9430686871654, -611.073046835608, -1275.0137816669392, -797.3229194035407, -153.15702757848595, -300.25748505080225, -692.5462819679803, -284.03305697784697, -38.28761336305344, -1160.1773156309837, -937.0860342359824, -15.046120427145015, -666.7119765733203, -199.78150754239434, -249.86339369681954, -550.9036884574834, -721.0544807932555, -474.53235675230326, -1096.1964817944086, -813.2934335356948, -588.2175279760256, -264.79840740819213, -1294.323125427379, -949.1708902097737, -991.1995207273648, -830.9347637536254, -907.5505463193653, -593.1197218304956, -1117.2722537996303, -531.4175533661579, -788.8810828958624, -753.7056980653513, -919.603844918656, -1012.9146541336231, -785.898938511915, -834.5039651956168, -360.4392319574254, -877.0195975364155, -501.64504833420904, -529.6112688487549, -1017.5787669623519, -1003.1349698726688, -771.9092948418347, -638.911806022906, -1062.290444271962, -236.58340594797417, -102.94894142893138, -574.1750784945519, -762.841624405086, -170.43372908133944, -108.56776424236439, -550.6538200050778, -986.4575525361671, -405.8016580163666, -386.79959981772845, -838.5311587705056, -543.9706542337665, -935.1224888329963, -1079.9107375207147, -611.8476077805932, -680.8007868755443, -959.836389673127], "episode_lengths": [150, 134, 150, 150, 150, 150, 150, 150, 114, 54, 150, 150, 150, 150, 89, 150, 150, 115, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 102, 150, 150, 89, 53, 150, 150, 40, 150, 77, 121, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 143, 150, 150, 150, 150, 150, 81, 50, 150, 150, 83, 75, 150, 150, 116, 150, 150, 150, 150, 150, 131, 150, 150], "policy_policy_0_reward": [-977.8408102726703, -282.33254564332674, -826.3671469157154, -730.4853202213649, -430.868072014043, -698.6883338099161, -1050.0389155085934, -1178.8536039574162, -471.95961771154674, -45.888665303948486, -712.9832956949247, -797.670215340423, -581.5155698508077, -1089.8014762094206, -206.0347851811864, -957.6978801218845, -1414.75010835822, -491.7319672383678, -1093.0327645356845, -984.8678943083492, -1254.6028500920672, -918.7554628305988, -753.7105682674596, -1175.867700936491, -247.40205909811743, -743.8738015931156, -728.186926844345, -881.3140248341309, -405.2299126226406, -996.3600067450494, -744.3584175824816, -1063.9333049007712, -300.5779006623998, -1037.721284754616, -1148.3486939060685, -1132.9695415080243, -1003.3149772007075, -27.993142788718952, -629.9430686871654, -611.073046835608, -1275.0137816669392, -797.3229194035407, -153.15702757848595, -300.25748505080225, -692.5462819679803, -284.03305697784697, -38.28761336305344, -1160.1773156309837, -937.0860342359824, -15.046120427145015, -666.7119765733203, -199.78150754239434, -249.86339369681954, -550.9036884574834, -721.0544807932555, -474.53235675230326, -1096.1964817944086, -813.2934335356948, -588.2175279760256, -264.79840740819213, -1294.323125427379, -949.1708902097737, -991.1995207273648, -830.9347637536254, -907.5505463193653, -593.1197218304956, -1117.2722537996303, -531.4175533661579, -788.8810828958624, -753.7056980653513, -919.603844918656, -1012.9146541336231, -785.898938511915, -834.5039651956168, -360.4392319574254, -877.0195975364155, -501.64504833420904, -529.6112688487549, -1017.5787669623519, -1003.1349698726688, -771.9092948418347, -638.911806022906, -1062.290444271962, -236.58340594797417, -102.94894142893138, -574.1750784945519, -762.841624405086, -170.43372908133944, -108.56776424236439, -550.6538200050778, -986.4575525361671, -405.8016580163666, -386.79959981772845, -838.5311587705056, -543.9706542337665, -935.1224888329963, -1079.9107375207147, -611.8476077805932, -680.8007868755443, -959.836389673127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5516041765732548, "mean_inference_ms": 1.6688245519278078, "mean_action_processing_ms": 0.27797481720235095, "mean_env_wait_ms": 3.0093496007762117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012141227722167969, "StateBufferConnector_ms": 0.007790327072143555, "ViewRequirementAgentConnector_ms": 0.19307494163513184}, "num_episodes": 30, "episode_return_max": -15.046120427145015, "episode_return_min": -1414.75010835822, "episode_return_mean": -711.1554655718722, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.11616714547927, "num_env_steps_trained_throughput_per_sec": 358.11616714547927, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12921.457, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12921.379, "sample_time_ms": 1042.157, "learn_time_ms": 11814.176, "learn_throughput": 338.576, "synch_weights_time_ms": 64.249}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00010", "date": "2024-08-03_04-06-05", "timestamp": 1722638165, "time_this_iter_s": 11.182788848876953, "time_total_s": 192.92428874969482, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c7229e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.92428874969482, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.7875, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 150.55201830267907, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.8210661105811594, "policy_loss": -0.006108295957286221, "vf_loss": 3.82173809359471, "vf_explained_var": 0.9750780685494344, "kl": 0.012407595836081505, "entropy": 1.471046830713749, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -15.046120427145015, "episode_reward_min": -1294.323125427379, "episode_reward_mean": -719.8478433880279, "episode_len_mean": 138.72, "episode_media": {}, "episodes_timesteps_total": 13872, "policy_reward_min": {"policy_0": -1294.323125427379}, "policy_reward_max": {"policy_0": -15.046120427145015}, "policy_reward_mean": {"policy_0": -719.8478433880279}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-881.3140248341309, -405.2299126226406, -996.3600067450494, -744.3584175824816, -1063.9333049007712, -300.5779006623998, -1037.721284754616, -1148.3486939060685, -1132.9695415080243, -1003.3149772007075, -27.993142788718952, -629.9430686871654, -611.073046835608, -1275.0137816669392, -797.3229194035407, -153.15702757848595, -300.25748505080225, -692.5462819679803, -284.03305697784697, -38.28761336305344, -1160.1773156309837, -937.0860342359824, -15.046120427145015, -666.7119765733203, -199.78150754239434, -249.86339369681954, -550.9036884574834, -721.0544807932555, -474.53235675230326, -1096.1964817944086, -813.2934335356948, -588.2175279760256, -264.79840740819213, -1294.323125427379, -949.1708902097737, -991.1995207273648, -830.9347637536254, -907.5505463193653, -593.1197218304956, -1117.2722537996303, -531.4175533661579, -788.8810828958624, -753.7056980653513, -919.603844918656, -1012.9146541336231, -785.898938511915, -834.5039651956168, -360.4392319574254, -877.0195975364155, -501.64504833420904, -529.6112688487549, -1017.5787669623519, -1003.1349698726688, -771.9092948418347, -638.911806022906, -1062.290444271962, -236.58340594797417, -102.94894142893138, -574.1750784945519, -762.841624405086, -170.43372908133944, -108.56776424236439, -550.6538200050778, -986.4575525361671, -405.8016580163666, -386.79959981772845, -838.5311587705056, -543.9706542337665, -935.1224888329963, -1079.9107375207147, -611.8476077805932, -680.8007868755443, -959.836389673127, -866.1054714821012, -722.2234574360801, -1046.662823189462, -514.7082998786376, -829.0276010024457, -1191.2422502412026, -929.3490295405879, -745.2305738589818, -1197.6674332179734, -1086.827156108976, -147.8890751172692, -748.5531745255287, -706.7423709971873, -1190.674489472564, -583.2370152557544, -791.9218952291995, -885.2565614935243, -541.8483061077411, -781.5726520842574, -1192.16482198349, -1164.1718804156387, -953.5936910501902, -654.0626430205241, -423.1004693335578, -908.41569683815, -431.45789619000055, -481.3394044045616], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 150, 102, 150, 150, 89, 53, 150, 150, 40, 150, 77, 121, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 143, 150, 150, 150, 150, 150, 81, 50, 150, 150, 83, 75, 150, 150, 116, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 127], "policy_policy_0_reward": [-881.3140248341309, -405.2299126226406, -996.3600067450494, -744.3584175824816, -1063.9333049007712, -300.5779006623998, -1037.721284754616, -1148.3486939060685, -1132.9695415080243, -1003.3149772007075, -27.993142788718952, -629.9430686871654, -611.073046835608, -1275.0137816669392, -797.3229194035407, -153.15702757848595, -300.25748505080225, -692.5462819679803, -284.03305697784697, -38.28761336305344, -1160.1773156309837, -937.0860342359824, -15.046120427145015, -666.7119765733203, -199.78150754239434, -249.86339369681954, -550.9036884574834, -721.0544807932555, -474.53235675230326, -1096.1964817944086, -813.2934335356948, -588.2175279760256, -264.79840740819213, -1294.323125427379, -949.1708902097737, -991.1995207273648, -830.9347637536254, -907.5505463193653, -593.1197218304956, -1117.2722537996303, -531.4175533661579, -788.8810828958624, -753.7056980653513, -919.603844918656, -1012.9146541336231, -785.898938511915, -834.5039651956168, -360.4392319574254, -877.0195975364155, -501.64504833420904, -529.6112688487549, -1017.5787669623519, -1003.1349698726688, -771.9092948418347, -638.911806022906, -1062.290444271962, -236.58340594797417, -102.94894142893138, -574.1750784945519, -762.841624405086, -170.43372908133944, -108.56776424236439, -550.6538200050778, -986.4575525361671, -405.8016580163666, -386.79959981772845, -838.5311587705056, -543.9706542337665, -935.1224888329963, -1079.9107375207147, -611.8476077805932, -680.8007868755443, -959.836389673127, -866.1054714821012, -722.2234574360801, -1046.662823189462, -514.7082998786376, -829.0276010024457, -1191.2422502412026, -929.3490295405879, -745.2305738589818, -1197.6674332179734, -1086.827156108976, -147.8890751172692, -748.5531745255287, -706.7423709971873, -1190.674489472564, -583.2370152557544, -791.9218952291995, -885.2565614935243, -541.8483061077411, -781.5726520842574, -1192.16482198349, -1164.1718804156387, -953.5936910501902, -654.0626430205241, -423.1004693335578, -908.41569683815, -431.45789619000055, -481.3394044045616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5516930774404699, "mean_inference_ms": 1.6681162590405514, "mean_action_processing_ms": 0.277385726445313, "mean_env_wait_ms": 3.0097428234509516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012259483337402344, "StateBufferConnector_ms": 0.007834911346435547, "ViewRequirementAgentConnector_ms": 0.19284272193908691}, "num_episodes": 27, "episode_return_max": -15.046120427145015, "episode_return_min": -1294.323125427379, "episode_return_mean": -719.8478433880279, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.7330679639295, "num_env_steps_trained_throughput_per_sec": 303.7330679639295, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12898.585, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12898.51, "sample_time_ms": 1035.947, "learn_time_ms": 11797.283, "learn_throughput": 339.061, "synch_weights_time_ms": 64.48}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00010", "date": "2024-08-03_04-06-18", "timestamp": 1722638178, "time_this_iter_s": 13.184075593948364, "time_total_s": 206.1083643436432, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c722b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 206.1083643436432, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.249999999999996, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 157.48056257764497, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.607256392141183, "policy_loss": -0.010955017224478069, "vf_loss": 3.6124761797487737, "vf_explained_var": 0.9770070720463991, "kl": 0.013080690100408321, "entropy": 1.5108432239542404, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -64.22600690606303, "episode_reward_min": -1356.068778800703, "episode_reward_mean": -721.5588919142664, "episode_len_mean": 139.62, "episode_media": {}, "episodes_timesteps_total": 13962, "policy_reward_min": {"policy_0": -1356.068778800703}, "policy_reward_max": {"policy_0": -64.22600690606303}, "policy_reward_mean": {"policy_0": -721.5588919142664}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-474.53235675230326, -1096.1964817944086, -813.2934335356948, -588.2175279760256, -264.79840740819213, -1294.323125427379, -949.1708902097737, -991.1995207273648, -830.9347637536254, -907.5505463193653, -593.1197218304956, -1117.2722537996303, -531.4175533661579, -788.8810828958624, -753.7056980653513, -919.603844918656, -1012.9146541336231, -785.898938511915, -834.5039651956168, -360.4392319574254, -877.0195975364155, -501.64504833420904, -529.6112688487549, -1017.5787669623519, -1003.1349698726688, -771.9092948418347, -638.911806022906, -1062.290444271962, -236.58340594797417, -102.94894142893138, -574.1750784945519, -762.841624405086, -170.43372908133944, -108.56776424236439, -550.6538200050778, -986.4575525361671, -405.8016580163666, -386.79959981772845, -838.5311587705056, -543.9706542337665, -935.1224888329963, -1079.9107375207147, -611.8476077805932, -680.8007868755443, -959.836389673127, -866.1054714821012, -722.2234574360801, -1046.662823189462, -514.7082998786376, -829.0276010024457, -1191.2422502412026, -929.3490295405879, -745.2305738589818, -1197.6674332179734, -1086.827156108976, -147.8890751172692, -748.5531745255287, -706.7423709971873, -1190.674489472564, -583.2370152557544, -791.9218952291995, -885.2565614935243, -541.8483061077411, -781.5726520842574, -1192.16482198349, -1164.1718804156387, -953.5936910501902, -654.0626430205241, -423.1004693335578, -908.41569683815, -431.45789619000055, -481.3394044045616, -919.8132327187218, -1356.068778800703, -540.7854473818396, -619.2880283792549, -862.1449651034718, -547.7693789702319, -218.35241165594456, -965.4897987896462, -640.3272197448628, -669.4402069126742, -726.4752877132646, -64.22600690606303, -859.6822214458117, -859.2379402459054, -1172.584914201672, -971.3390069203197, -688.2585742626256, -214.7927943834517, -104.29189595241665, -338.0265656537413, -357.394112135123, -396.0946891393639, -1108.1203492067455, -874.0726297315142, -908.5393889245627, -802.4570142491605, -132.55987694366493, -277.85212254550083], "episode_lengths": [150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 143, 150, 150, 150, 150, 150, 81, 50, 150, 150, 83, 75, 150, 150, 116, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 127, 150, 150, 150, 150, 150, 129, 74, 150, 150, 150, 150, 64, 150, 150, 150, 150, 126, 136, 51, 134, 150, 150, 150, 150, 150, 150, 90, 117], "policy_policy_0_reward": [-474.53235675230326, -1096.1964817944086, -813.2934335356948, -588.2175279760256, -264.79840740819213, -1294.323125427379, -949.1708902097737, -991.1995207273648, -830.9347637536254, -907.5505463193653, -593.1197218304956, -1117.2722537996303, -531.4175533661579, -788.8810828958624, -753.7056980653513, -919.603844918656, -1012.9146541336231, -785.898938511915, -834.5039651956168, -360.4392319574254, -877.0195975364155, -501.64504833420904, -529.6112688487549, -1017.5787669623519, -1003.1349698726688, -771.9092948418347, -638.911806022906, -1062.290444271962, -236.58340594797417, -102.94894142893138, -574.1750784945519, -762.841624405086, -170.43372908133944, -108.56776424236439, -550.6538200050778, -986.4575525361671, -405.8016580163666, -386.79959981772845, -838.5311587705056, -543.9706542337665, -935.1224888329963, -1079.9107375207147, -611.8476077805932, -680.8007868755443, -959.836389673127, -866.1054714821012, -722.2234574360801, -1046.662823189462, -514.7082998786376, -829.0276010024457, -1191.2422502412026, -929.3490295405879, -745.2305738589818, -1197.6674332179734, -1086.827156108976, -147.8890751172692, -748.5531745255287, -706.7423709971873, -1190.674489472564, -583.2370152557544, -791.9218952291995, -885.2565614935243, -541.8483061077411, -781.5726520842574, -1192.16482198349, -1164.1718804156387, -953.5936910501902, -654.0626430205241, -423.1004693335578, -908.41569683815, -431.45789619000055, -481.3394044045616, -919.8132327187218, -1356.068778800703, -540.7854473818396, -619.2880283792549, -862.1449651034718, -547.7693789702319, -218.35241165594456, -965.4897987896462, -640.3272197448628, -669.4402069126742, -726.4752877132646, -64.22600690606303, -859.6822214458117, -859.2379402459054, -1172.584914201672, -971.3390069203197, -688.2585742626256, -214.7927943834517, -104.29189595241665, -338.0265656537413, -357.394112135123, -396.0946891393639, -1108.1203492067455, -874.0726297315142, -908.5393889245627, -802.4570142491605, -132.55987694366493, -277.85212254550083]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5520284321355655, "mean_inference_ms": 1.6692198466692088, "mean_action_processing_ms": 0.27731406912548123, "mean_env_wait_ms": 3.012628218903825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012210607528686523, "StateBufferConnector_ms": 0.00786447525024414, "ViewRequirementAgentConnector_ms": 0.19959139823913574}, "num_episodes": 28, "episode_return_max": -64.22600690606303, "episode_return_min": -1356.068778800703, "episode_return_mean": -721.5588919142664, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.55129126244935, "num_env_steps_trained_throughput_per_sec": 299.55129126244935, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12919.999, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12919.924, "sample_time_ms": 1054.33, "learn_time_ms": 11801.152, "learn_throughput": 338.95, "synch_weights_time_ms": 63.638}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00010", "date": "2024-08-03_04-06-31", "timestamp": 1722638191, "time_this_iter_s": 13.364652633666992, "time_total_s": 219.47301697731018, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78c8b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 219.47301697731018, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.22105263157895, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 163.45622583230337, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.839496179545919, "policy_loss": -0.012661391503934282, "vf_loss": 3.8466460222999257, "vf_explained_var": 0.9816538945461313, "kl": 0.01260759021258006, "entropy": 1.6186745800077915, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -64.22600690606303, "episode_reward_min": -1356.068778800703, "episode_reward_mean": -723.687191181523, "episode_len_mean": 140.61, "episode_media": {}, "episodes_timesteps_total": 14061, "policy_reward_min": {"policy_0": -1356.068778800703}, "policy_reward_max": {"policy_0": -64.22600690606303}, "policy_reward_mean": {"policy_0": -723.687191181523}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-550.6538200050778, -986.4575525361671, -405.8016580163666, -386.79959981772845, -838.5311587705056, -543.9706542337665, -935.1224888329963, -1079.9107375207147, -611.8476077805932, -680.8007868755443, -959.836389673127, -866.1054714821012, -722.2234574360801, -1046.662823189462, -514.7082998786376, -829.0276010024457, -1191.2422502412026, -929.3490295405879, -745.2305738589818, -1197.6674332179734, -1086.827156108976, -147.8890751172692, -748.5531745255287, -706.7423709971873, -1190.674489472564, -583.2370152557544, -791.9218952291995, -885.2565614935243, -541.8483061077411, -781.5726520842574, -1192.16482198349, -1164.1718804156387, -953.5936910501902, -654.0626430205241, -423.1004693335578, -908.41569683815, -431.45789619000055, -481.3394044045616, -919.8132327187218, -1356.068778800703, -540.7854473818396, -619.2880283792549, -862.1449651034718, -547.7693789702319, -218.35241165594456, -965.4897987896462, -640.3272197448628, -669.4402069126742, -726.4752877132646, -64.22600690606303, -859.6822214458117, -859.2379402459054, -1172.584914201672, -971.3390069203197, -688.2585742626256, -214.7927943834517, -104.29189595241665, -338.0265656537413, -357.394112135123, -396.0946891393639, -1108.1203492067455, -874.0726297315142, -908.5393889245627, -802.4570142491605, -132.55987694366493, -277.85212254550083, -1048.889420238514, -657.131466296481, -461.08656407462064, -805.1208868215235, -837.7034945111841, -233.00843071601437, -334.8105571220921, -583.1372283860287, -1024.3185518497498, -1110.773839304122, -730.44038583411, -680.7934118905941, -524.0932296923035, -798.8942631693601, -919.4952069247357, -235.42259229912844, -775.9156688373134, -318.3214557751565, -856.3813203287209, -1015.4932295399973, -495.91248605893315, -465.54678999769726, -926.8020244166254, -930.6363632916277, -225.6994872724379, -914.1756870937133, -1312.9472752115296, -219.1479702218606, -809.5029941334235, -767.2612172359966, -895.2795942085464, -1131.7303761364233, -911.4907221073646, -521.0914745979412], "episode_lengths": [150, 150, 116, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 127, 150, 150, 150, 150, 150, 129, 74, 150, 150, 150, 150, 64, 150, 150, 150, 150, 126, 136, 51, 134, 150, 150, 150, 150, 150, 150, 90, 117, 150, 150, 150, 150, 150, 74, 89, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 112, 150, 150, 136, 150, 150, 150, 118, 150, 150, 119, 150, 150, 150, 150, 150, 148], "policy_policy_0_reward": [-550.6538200050778, -986.4575525361671, -405.8016580163666, -386.79959981772845, -838.5311587705056, -543.9706542337665, -935.1224888329963, -1079.9107375207147, -611.8476077805932, -680.8007868755443, -959.836389673127, -866.1054714821012, -722.2234574360801, -1046.662823189462, -514.7082998786376, -829.0276010024457, -1191.2422502412026, -929.3490295405879, -745.2305738589818, -1197.6674332179734, -1086.827156108976, -147.8890751172692, -748.5531745255287, -706.7423709971873, -1190.674489472564, -583.2370152557544, -791.9218952291995, -885.2565614935243, -541.8483061077411, -781.5726520842574, -1192.16482198349, -1164.1718804156387, -953.5936910501902, -654.0626430205241, -423.1004693335578, -908.41569683815, -431.45789619000055, -481.3394044045616, -919.8132327187218, -1356.068778800703, -540.7854473818396, -619.2880283792549, -862.1449651034718, -547.7693789702319, -218.35241165594456, -965.4897987896462, -640.3272197448628, -669.4402069126742, -726.4752877132646, -64.22600690606303, -859.6822214458117, -859.2379402459054, -1172.584914201672, -971.3390069203197, -688.2585742626256, -214.7927943834517, -104.29189595241665, -338.0265656537413, -357.394112135123, -396.0946891393639, -1108.1203492067455, -874.0726297315142, -908.5393889245627, -802.4570142491605, -132.55987694366493, -277.85212254550083, -1048.889420238514, -657.131466296481, -461.08656407462064, -805.1208868215235, -837.7034945111841, -233.00843071601437, -334.8105571220921, -583.1372283860287, -1024.3185518497498, -1110.773839304122, -730.44038583411, -680.7934118905941, -524.0932296923035, -798.8942631693601, -919.4952069247357, -235.42259229912844, -775.9156688373134, -318.3214557751565, -856.3813203287209, -1015.4932295399973, -495.91248605893315, -465.54678999769726, -926.8020244166254, -930.6363632916277, -225.6994872724379, -914.1756870937133, -1312.9472752115296, -219.1479702218606, -809.5029941334235, -767.2612172359966, -895.2795942085464, -1131.7303761364233, -911.4907221073646, -521.0914745979412]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5524825220360832, "mean_inference_ms": 1.6701933045419568, "mean_action_processing_ms": 0.27716148629935655, "mean_env_wait_ms": 3.0177472142910187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012217998504638672, "StateBufferConnector_ms": 0.007807254791259766, "ViewRequirementAgentConnector_ms": 0.19903063774108887}, "num_episodes": 34, "episode_return_max": -64.22600690606303, "episode_return_min": -1356.068778800703, "episode_return_mean": -723.687191181523, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.98794271274056, "num_env_steps_trained_throughput_per_sec": 307.98794271274056, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12934.82, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12934.748, "sample_time_ms": 1057.998, "learn_time_ms": 11812.104, "learn_throughput": 338.636, "synch_weights_time_ms": 63.84}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00010", "date": "2024-08-03_04-06-44", "timestamp": 1722638204, "time_this_iter_s": 13.001037359237671, "time_total_s": 232.47405433654785, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c7229e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 232.47405433654785, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.173684210526318, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.17552603085835, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.765538726374507, "policy_loss": -0.010426765534793958, "vf_loss": 3.7699191329379875, "vf_explained_var": 0.9863488292942445, "kl": 0.01378188709617616, "entropy": 1.5550213339428107, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -17.07567922276007, "episode_reward_min": -1356.068778800703, "episode_reward_mean": -713.7653082308269, "episode_len_mean": 138.21, "episode_media": {}, "episodes_timesteps_total": 13821, "policy_reward_min": {"policy_0": -1356.068778800703}, "policy_reward_max": {"policy_0": -17.07567922276007}, "policy_reward_mean": {"policy_0": -713.7653082308269}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-541.8483061077411, -781.5726520842574, -1192.16482198349, -1164.1718804156387, -953.5936910501902, -654.0626430205241, -423.1004693335578, -908.41569683815, -431.45789619000055, -481.3394044045616, -919.8132327187218, -1356.068778800703, -540.7854473818396, -619.2880283792549, -862.1449651034718, -547.7693789702319, -218.35241165594456, -965.4897987896462, -640.3272197448628, -669.4402069126742, -726.4752877132646, -64.22600690606303, -859.6822214458117, -859.2379402459054, -1172.584914201672, -971.3390069203197, -688.2585742626256, -214.7927943834517, -104.29189595241665, -338.0265656537413, -357.394112135123, -396.0946891393639, -1108.1203492067455, -874.0726297315142, -908.5393889245627, -802.4570142491605, -132.55987694366493, -277.85212254550083, -1048.889420238514, -657.131466296481, -461.08656407462064, -805.1208868215235, -837.7034945111841, -233.00843071601437, -334.8105571220921, -583.1372283860287, -1024.3185518497498, -1110.773839304122, -730.44038583411, -680.7934118905941, -524.0932296923035, -798.8942631693601, -919.4952069247357, -235.42259229912844, -775.9156688373134, -318.3214557751565, -856.3813203287209, -1015.4932295399973, -495.91248605893315, -465.54678999769726, -926.8020244166254, -930.6363632916277, -225.6994872724379, -914.1756870937133, -1312.9472752115296, -219.1479702218606, -809.5029941334235, -767.2612172359966, -895.2795942085464, -1131.7303761364233, -911.4907221073646, -521.0914745979412, -891.6031990694464, -1151.756245070884, -1009.726178230644, -466.3886335455324, -838.3526483975278, -746.896785736153, -1235.5701535806859, -159.3121126180601, -1293.6428260990574, -702.9873931316299, -944.6217307401597, -1059.5360548464766, -805.5037078416755, -690.9247506183425, -844.7603552463274, -1001.3793818574669, -676.0715637166215, -128.28876597911508, -746.5439196293298, -650.963100027887, -1045.1547291058362, -1039.6840196077783, -17.07567922276007, -137.29422589781805, -1027.7834427955574, -387.2246662527124, -1188.5297722086093, -283.2867959663584], "episode_lengths": [150, 150, 150, 150, 150, 150, 107, 150, 150, 127, 150, 150, 150, 150, 150, 129, 74, 150, 150, 150, 150, 64, 150, 150, 150, 150, 126, 136, 51, 134, 150, 150, 150, 150, 150, 150, 90, 117, 150, 150, 150, 150, 150, 74, 89, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 112, 150, 150, 136, 150, 150, 150, 118, 150, 150, 119, 150, 150, 150, 150, 150, 148, 150, 150, 150, 115, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 42, 109, 150, 150, 150, 150], "policy_policy_0_reward": [-541.8483061077411, -781.5726520842574, -1192.16482198349, -1164.1718804156387, -953.5936910501902, -654.0626430205241, -423.1004693335578, -908.41569683815, -431.45789619000055, -481.3394044045616, -919.8132327187218, -1356.068778800703, -540.7854473818396, -619.2880283792549, -862.1449651034718, -547.7693789702319, -218.35241165594456, -965.4897987896462, -640.3272197448628, -669.4402069126742, -726.4752877132646, -64.22600690606303, -859.6822214458117, -859.2379402459054, -1172.584914201672, -971.3390069203197, -688.2585742626256, -214.7927943834517, -104.29189595241665, -338.0265656537413, -357.394112135123, -396.0946891393639, -1108.1203492067455, -874.0726297315142, -908.5393889245627, -802.4570142491605, -132.55987694366493, -277.85212254550083, -1048.889420238514, -657.131466296481, -461.08656407462064, -805.1208868215235, -837.7034945111841, -233.00843071601437, -334.8105571220921, -583.1372283860287, -1024.3185518497498, -1110.773839304122, -730.44038583411, -680.7934118905941, -524.0932296923035, -798.8942631693601, -919.4952069247357, -235.42259229912844, -775.9156688373134, -318.3214557751565, -856.3813203287209, -1015.4932295399973, -495.91248605893315, -465.54678999769726, -926.8020244166254, -930.6363632916277, -225.6994872724379, -914.1756870937133, -1312.9472752115296, -219.1479702218606, -809.5029941334235, -767.2612172359966, -895.2795942085464, -1131.7303761364233, -911.4907221073646, -521.0914745979412, -891.6031990694464, -1151.756245070884, -1009.726178230644, -466.3886335455324, -838.3526483975278, -746.896785736153, -1235.5701535806859, -159.3121126180601, -1293.6428260990574, -702.9873931316299, -944.6217307401597, -1059.5360548464766, -805.5037078416755, -690.9247506183425, -844.7603552463274, -1001.3793818574669, -676.0715637166215, -128.28876597911508, -746.5439196293298, -650.963100027887, -1045.1547291058362, -1039.6840196077783, -17.07567922276007, -137.29422589781805, -1027.7834427955574, -387.2246662527124, -1188.5297722086093, -283.2867959663584]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526130081694665, "mean_inference_ms": 1.6712790502129444, "mean_action_processing_ms": 0.27714079689713156, "mean_env_wait_ms": 3.021241312540829, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012192964553833008, "StateBufferConnector_ms": 0.007890462875366211, "ViewRequirementAgentConnector_ms": 0.20131635665893555}, "num_episodes": 28, "episode_return_max": -17.07567922276007, "episode_return_min": -1356.068778800703, "episode_return_mean": -713.7653082308269, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.499338551053, "num_env_steps_trained_throughput_per_sec": 331.499338551053, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12878.479, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12878.407, "sample_time_ms": 1060.245, "learn_time_ms": 11753.704, "learn_throughput": 340.318, "synch_weights_time_ms": 63.634}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00010", "date": "2024-08-03_04-06-57", "timestamp": 1722638217, "time_this_iter_s": 12.07833456993103, "time_total_s": 244.55238890647888, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b19d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 244.55238890647888, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.88235294117647, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 186.94249300758045, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.400844208771984, "policy_loss": -0.017421253876333746, "vf_loss": 3.4115401905030014, "vf_explained_var": 0.9900314292560021, "kl": 0.015322506824622906, "entropy": 1.698556055004398, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -17.07567922276007, "episode_reward_min": -1359.8690935045604, "episode_reward_mean": -716.0325632758392, "episode_len_mean": 138.56, "episode_media": {}, "episodes_timesteps_total": 13856, "policy_reward_min": {"policy_0": -1359.8690935045604}, "policy_reward_max": {"policy_0": -17.07567922276007}, "policy_reward_mean": {"policy_0": -716.0325632758392}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-338.0265656537413, -357.394112135123, -396.0946891393639, -1108.1203492067455, -874.0726297315142, -908.5393889245627, -802.4570142491605, -132.55987694366493, -277.85212254550083, -1048.889420238514, -657.131466296481, -461.08656407462064, -805.1208868215235, -837.7034945111841, -233.00843071601437, -334.8105571220921, -583.1372283860287, -1024.3185518497498, -1110.773839304122, -730.44038583411, -680.7934118905941, -524.0932296923035, -798.8942631693601, -919.4952069247357, -235.42259229912844, -775.9156688373134, -318.3214557751565, -856.3813203287209, -1015.4932295399973, -495.91248605893315, -465.54678999769726, -926.8020244166254, -930.6363632916277, -225.6994872724379, -914.1756870937133, -1312.9472752115296, -219.1479702218606, -809.5029941334235, -767.2612172359966, -895.2795942085464, -1131.7303761364233, -911.4907221073646, -521.0914745979412, -891.6031990694464, -1151.756245070884, -1009.726178230644, -466.3886335455324, -838.3526483975278, -746.896785736153, -1235.5701535806859, -159.3121126180601, -1293.6428260990574, -702.9873931316299, -944.6217307401597, -1059.5360548464766, -805.5037078416755, -690.9247506183425, -844.7603552463274, -1001.3793818574669, -676.0715637166215, -128.28876597911508, -746.5439196293298, -650.963100027887, -1045.1547291058362, -1039.6840196077783, -17.07567922276007, -137.29422589781805, -1027.7834427955574, -387.2246662527124, -1188.5297722086093, -283.2867959663584, -575.2606983766826, -1261.1325007951054, -581.2299855988919, -112.90219787141494, -762.1292770100264, -392.0631517245552, -1020.0575268655116, -1335.937518364819, -387.90126308534656, -979.9196872157273, -582.0965567324849, -239.37233291154476, -768.622174225442, -278.90036438730965, -1113.2850241513422, -946.1502171566665, -1251.954818349254, -575.0685016981773, -1359.8690935045604, -188.3213831885553, -928.4650450827071, -601.5394287424375, -828.5441180919878, -455.1904004339306, -952.8384290464878, -760.4564149230615, -321.17165595812287, -57.37253285266121, -1141.068778073409], "episode_lengths": [134, 150, 150, 150, 150, 150, 150, 90, 117, 150, 150, 150, 150, 150, 74, 89, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 112, 150, 150, 136, 150, 150, 150, 118, 150, 150, 119, 150, 150, 150, 150, 150, 148, 150, 150, 150, 115, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 42, 109, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 141, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 98, 51, 150], "policy_policy_0_reward": [-338.0265656537413, -357.394112135123, -396.0946891393639, -1108.1203492067455, -874.0726297315142, -908.5393889245627, -802.4570142491605, -132.55987694366493, -277.85212254550083, -1048.889420238514, -657.131466296481, -461.08656407462064, -805.1208868215235, -837.7034945111841, -233.00843071601437, -334.8105571220921, -583.1372283860287, -1024.3185518497498, -1110.773839304122, -730.44038583411, -680.7934118905941, -524.0932296923035, -798.8942631693601, -919.4952069247357, -235.42259229912844, -775.9156688373134, -318.3214557751565, -856.3813203287209, -1015.4932295399973, -495.91248605893315, -465.54678999769726, -926.8020244166254, -930.6363632916277, -225.6994872724379, -914.1756870937133, -1312.9472752115296, -219.1479702218606, -809.5029941334235, -767.2612172359966, -895.2795942085464, -1131.7303761364233, -911.4907221073646, -521.0914745979412, -891.6031990694464, -1151.756245070884, -1009.726178230644, -466.3886335455324, -838.3526483975278, -746.896785736153, -1235.5701535806859, -159.3121126180601, -1293.6428260990574, -702.9873931316299, -944.6217307401597, -1059.5360548464766, -805.5037078416755, -690.9247506183425, -844.7603552463274, -1001.3793818574669, -676.0715637166215, -128.28876597911508, -746.5439196293298, -650.963100027887, -1045.1547291058362, -1039.6840196077783, -17.07567922276007, -137.29422589781805, -1027.7834427955574, -387.2246662527124, -1188.5297722086093, -283.2867959663584, -575.2606983766826, -1261.1325007951054, -581.2299855988919, -112.90219787141494, -762.1292770100264, -392.0631517245552, -1020.0575268655116, -1335.937518364819, -387.90126308534656, -979.9196872157273, -582.0965567324849, -239.37233291154476, -768.622174225442, -278.90036438730965, -1113.2850241513422, -946.1502171566665, -1251.954818349254, -575.0685016981773, -1359.8690935045604, -188.3213831885553, -928.4650450827071, -601.5394287424375, -828.5441180919878, -455.1904004339306, -952.8384290464878, -760.4564149230615, -321.17165595812287, -57.37253285266121, -1141.068778073409]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526796066384385, "mean_inference_ms": 1.6710728452093997, "mean_action_processing_ms": 0.27690643487929195, "mean_env_wait_ms": 3.023756128051454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011924505233764648, "StateBufferConnector_ms": 0.007848024368286133, "ViewRequirementAgentConnector_ms": 0.19356417655944824}, "num_episodes": 29, "episode_return_max": -17.07567922276007, "episode_return_min": -1359.8690935045604, "episode_return_mean": -716.0325632758392, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.48759464533816, "num_env_steps_trained_throughput_per_sec": 293.48759464533816, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12926.012, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12925.94, "sample_time_ms": 1076.711, "learn_time_ms": 11784.376, "learn_throughput": 339.432, "synch_weights_time_ms": 64.041}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00010", "date": "2024-08-03_04-07-10", "timestamp": 1722638230, "time_this_iter_s": 13.643665075302124, "time_total_s": 258.196053981781, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b1bd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 258.196053981781, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 16.875, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 177.4420174340407, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.6941702415545783, "policy_loss": -0.01185621266583136, "vf_loss": 3.7004188251992067, "vf_explained_var": 0.9841658963511387, "kl": 0.012802400737443046, "entropy": 1.5343979064375162, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -17.07567922276007, "episode_reward_min": -1359.8690935045604, "episode_reward_mean": -724.2500287474289, "episode_len_mean": 138.71, "episode_media": {}, "episodes_timesteps_total": 13871, "policy_reward_min": {"policy_0": -1359.8690935045604}, "policy_reward_max": {"policy_0": -17.07567922276007}, "policy_reward_mean": {"policy_0": -724.2500287474289}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-856.3813203287209, -1015.4932295399973, -495.91248605893315, -465.54678999769726, -926.8020244166254, -930.6363632916277, -225.6994872724379, -914.1756870937133, -1312.9472752115296, -219.1479702218606, -809.5029941334235, -767.2612172359966, -895.2795942085464, -1131.7303761364233, -911.4907221073646, -521.0914745979412, -891.6031990694464, -1151.756245070884, -1009.726178230644, -466.3886335455324, -838.3526483975278, -746.896785736153, -1235.5701535806859, -159.3121126180601, -1293.6428260990574, -702.9873931316299, -944.6217307401597, -1059.5360548464766, -805.5037078416755, -690.9247506183425, -844.7603552463274, -1001.3793818574669, -676.0715637166215, -128.28876597911508, -746.5439196293298, -650.963100027887, -1045.1547291058362, -1039.6840196077783, -17.07567922276007, -137.29422589781805, -1027.7834427955574, -387.2246662527124, -1188.5297722086093, -283.2867959663584, -575.2606983766826, -1261.1325007951054, -581.2299855988919, -112.90219787141494, -762.1292770100264, -392.0631517245552, -1020.0575268655116, -1335.937518364819, -387.90126308534656, -979.9196872157273, -582.0965567324849, -239.37233291154476, -768.622174225442, -278.90036438730965, -1113.2850241513422, -946.1502171566665, -1251.954818349254, -575.0685016981773, -1359.8690935045604, -188.3213831885553, -928.4650450827071, -601.5394287424375, -828.5441180919878, -455.1904004339306, -952.8384290464878, -760.4564149230615, -321.17165595812287, -57.37253285266121, -1141.068778073409, -1160.5545891554264, -69.28417766263601, -427.1220370313674, -1022.3415675895724, -186.68042113077803, -1143.6374702355495, -158.58020305923267, -1025.9390006023725, -731.863647755859, -790.8353791423566, -373.49198053836335, -817.8678881239773, -999.442038196043, -434.55690286993627, -914.3837490227875, -699.9318948888025, -591.2078713875634, -654.996685858322, -536.0258106111814, -1154.8103283881069, -1144.7540019137539, -1035.9966950226342, -541.2570145397293, -415.48856699305554, -268.4618974797046, -535.8155899977509, -260.89254023450104], "episode_lengths": [150, 150, 136, 150, 150, 150, 118, 150, 150, 119, 150, 150, 150, 150, 150, 148, 150, 150, 150, 115, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 42, 109, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 141, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 98, 51, 150, 150, 77, 142, 150, 68, 150, 78, 150, 150, 150, 104, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150], "policy_policy_0_reward": [-856.3813203287209, -1015.4932295399973, -495.91248605893315, -465.54678999769726, -926.8020244166254, -930.6363632916277, -225.6994872724379, -914.1756870937133, -1312.9472752115296, -219.1479702218606, -809.5029941334235, -767.2612172359966, -895.2795942085464, -1131.7303761364233, -911.4907221073646, -521.0914745979412, -891.6031990694464, -1151.756245070884, -1009.726178230644, -466.3886335455324, -838.3526483975278, -746.896785736153, -1235.5701535806859, -159.3121126180601, -1293.6428260990574, -702.9873931316299, -944.6217307401597, -1059.5360548464766, -805.5037078416755, -690.9247506183425, -844.7603552463274, -1001.3793818574669, -676.0715637166215, -128.28876597911508, -746.5439196293298, -650.963100027887, -1045.1547291058362, -1039.6840196077783, -17.07567922276007, -137.29422589781805, -1027.7834427955574, -387.2246662527124, -1188.5297722086093, -283.2867959663584, -575.2606983766826, -1261.1325007951054, -581.2299855988919, -112.90219787141494, -762.1292770100264, -392.0631517245552, -1020.0575268655116, -1335.937518364819, -387.90126308534656, -979.9196872157273, -582.0965567324849, -239.37233291154476, -768.622174225442, -278.90036438730965, -1113.2850241513422, -946.1502171566665, -1251.954818349254, -575.0685016981773, -1359.8690935045604, -188.3213831885553, -928.4650450827071, -601.5394287424375, -828.5441180919878, -455.1904004339306, -952.8384290464878, -760.4564149230615, -321.17165595812287, -57.37253285266121, -1141.068778073409, -1160.5545891554264, -69.28417766263601, -427.1220370313674, -1022.3415675895724, -186.68042113077803, -1143.6374702355495, -158.58020305923267, -1025.9390006023725, -731.863647755859, -790.8353791423566, -373.49198053836335, -817.8678881239773, -999.442038196043, -434.55690286993627, -914.3837490227875, -699.9318948888025, -591.2078713875634, -654.996685858322, -536.0258106111814, -1154.8103283881069, -1144.7540019137539, -1035.9966950226342, -541.2570145397293, -415.48856699305554, -268.4618974797046, -535.8155899977509, -260.89254023450104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5524414772597221, "mean_inference_ms": 1.6701270666802739, "mean_action_processing_ms": 0.2766792603557352, "mean_env_wait_ms": 3.0266554717212744, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011916160583496094, "StateBufferConnector_ms": 0.007920980453491211, "ViewRequirementAgentConnector_ms": 0.19370031356811523}, "num_episodes": 27, "episode_return_max": -17.07567922276007, "episode_return_min": -1359.8690935045604, "episode_return_mean": -724.2500287474289, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.84004979420064, "num_env_steps_trained_throughput_per_sec": 304.84004979420064, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12929.875, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12929.805, "sample_time_ms": 1078.016, "learn_time_ms": 11787.132, "learn_throughput": 339.353, "synch_weights_time_ms": 63.848}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00010", "date": "2024-08-03_04-07-23", "timestamp": 1722638243, "time_this_iter_s": 13.135380506515503, "time_total_s": 271.3314344882965, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c722ef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 271.3314344882965, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.455555555555552, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 190.9852685292562, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.6831256536146006, "policy_loss": -0.012235668081363353, "vf_loss": 3.688031959285339, "vf_explained_var": 0.9847820784896613, "kl": 0.016623399689099976, "entropy": 1.5118539709597827, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -17.07567922276007, "episode_reward_min": -1359.8690935045604, "episode_reward_mean": -684.8388441599851, "episode_len_mean": 135.88, "episode_media": {}, "episodes_timesteps_total": 13588, "policy_reward_min": {"policy_0": -1359.8690935045604}, "policy_reward_max": {"policy_0": -17.07567922276007}, "policy_reward_mean": {"policy_0": -684.8388441599851}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-690.9247506183425, -844.7603552463274, -1001.3793818574669, -676.0715637166215, -128.28876597911508, -746.5439196293298, -650.963100027887, -1045.1547291058362, -1039.6840196077783, -17.07567922276007, -137.29422589781805, -1027.7834427955574, -387.2246662527124, -1188.5297722086093, -283.2867959663584, -575.2606983766826, -1261.1325007951054, -581.2299855988919, -112.90219787141494, -762.1292770100264, -392.0631517245552, -1020.0575268655116, -1335.937518364819, -387.90126308534656, -979.9196872157273, -582.0965567324849, -239.37233291154476, -768.622174225442, -278.90036438730965, -1113.2850241513422, -946.1502171566665, -1251.954818349254, -575.0685016981773, -1359.8690935045604, -188.3213831885553, -928.4650450827071, -601.5394287424375, -828.5441180919878, -455.1904004339306, -952.8384290464878, -760.4564149230615, -321.17165595812287, -57.37253285266121, -1141.068778073409, -1160.5545891554264, -69.28417766263601, -427.1220370313674, -1022.3415675895724, -186.68042113077803, -1143.6374702355495, -158.58020305923267, -1025.9390006023725, -731.863647755859, -790.8353791423566, -373.49198053836335, -817.8678881239773, -999.442038196043, -434.55690286993627, -914.3837490227875, -699.9318948888025, -591.2078713875634, -654.996685858322, -536.0258106111814, -1154.8103283881069, -1144.7540019137539, -1035.9966950226342, -541.2570145397293, -415.48856699305554, -268.4618974797046, -535.8155899977509, -260.89254023450104, -1000.495530101407, -812.1393365446047, -1135.9752371519996, -952.9583674281981, -675.4295334942176, -236.84594444093526, -21.029101414572644, -689.9461037552575, -1034.9090355526682, -749.3533977785363, -18.397768061443724, -434.6230101607055, -920.1578014981637, -876.1861477823915, -599.0894527489612, -539.9013185777995, -1215.3503625468938, -734.9689415084641, -195.01146068778868, -976.2616060609109, -952.4537530258317, -684.3876754205202, -1168.95025154623, -46.91251476050953, -836.430021907649, -538.7400644252178, -962.1835143825831, -158.30535603044325, -596.4856132215019], "episode_lengths": [150, 150, 150, 150, 52, 150, 150, 150, 150, 42, 109, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 141, 150, 150, 150, 150, 114, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 98, 51, 150, 150, 77, 142, 150, 68, 150, 78, 150, 150, 150, 104, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 148, 150, 150, 150, 110, 45, 150, 150, 150, 46, 150, 150, 150, 134, 150, 150, 150, 95, 150, 150, 150, 150, 73, 150, 150, 150, 63, 150], "policy_policy_0_reward": [-690.9247506183425, -844.7603552463274, -1001.3793818574669, -676.0715637166215, -128.28876597911508, -746.5439196293298, -650.963100027887, -1045.1547291058362, -1039.6840196077783, -17.07567922276007, -137.29422589781805, -1027.7834427955574, -387.2246662527124, -1188.5297722086093, -283.2867959663584, -575.2606983766826, -1261.1325007951054, -581.2299855988919, -112.90219787141494, -762.1292770100264, -392.0631517245552, -1020.0575268655116, -1335.937518364819, -387.90126308534656, -979.9196872157273, -582.0965567324849, -239.37233291154476, -768.622174225442, -278.90036438730965, -1113.2850241513422, -946.1502171566665, -1251.954818349254, -575.0685016981773, -1359.8690935045604, -188.3213831885553, -928.4650450827071, -601.5394287424375, -828.5441180919878, -455.1904004339306, -952.8384290464878, -760.4564149230615, -321.17165595812287, -57.37253285266121, -1141.068778073409, -1160.5545891554264, -69.28417766263601, -427.1220370313674, -1022.3415675895724, -186.68042113077803, -1143.6374702355495, -158.58020305923267, -1025.9390006023725, -731.863647755859, -790.8353791423566, -373.49198053836335, -817.8678881239773, -999.442038196043, -434.55690286993627, -914.3837490227875, -699.9318948888025, -591.2078713875634, -654.996685858322, -536.0258106111814, -1154.8103283881069, -1144.7540019137539, -1035.9966950226342, -541.2570145397293, -415.48856699305554, -268.4618974797046, -535.8155899977509, -260.89254023450104, -1000.495530101407, -812.1393365446047, -1135.9752371519996, -952.9583674281981, -675.4295334942176, -236.84594444093526, -21.029101414572644, -689.9461037552575, -1034.9090355526682, -749.3533977785363, -18.397768061443724, -434.6230101607055, -920.1578014981637, -876.1861477823915, -599.0894527489612, -539.9013185777995, -1215.3503625468938, -734.9689415084641, -195.01146068778868, -976.2616060609109, -952.4537530258317, -684.3876754205202, -1168.95025154623, -46.91251476050953, -836.430021907649, -538.7400644252178, -962.1835143825831, -158.30535603044325, -596.4856132215019]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526669061666498, "mean_inference_ms": 1.6706181895599779, "mean_action_processing_ms": 0.2764971094595982, "mean_env_wait_ms": 3.0312402257291757, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011846303939819336, "StateBufferConnector_ms": 0.00789022445678711, "ViewRequirementAgentConnector_ms": 0.19381213188171387}, "num_episodes": 29, "episode_return_max": -17.07567922276007, "episode_return_min": -1359.8690935045604, "episode_return_mean": -684.8388441599851, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.86038996538656, "num_env_steps_trained_throughput_per_sec": 303.86038996538656, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12936.233, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12936.159, "sample_time_ms": 1081.837, "learn_time_ms": 11788.665, "learn_throughput": 339.309, "synch_weights_time_ms": 64.848}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00010", "date": "2024-08-03_04-07-37", "timestamp": 1722638257, "time_this_iter_s": 13.175171375274658, "time_total_s": 284.50660586357117, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c722f80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 284.50660586357117, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.23684210526316, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 252.82748215794564, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.1322049772987763, "policy_loss": -0.009262685683400681, "vf_loss": 3.1354716839889685, "vf_explained_var": 0.9815456980839372, "kl": 0.013775917149541812, "entropy": 2.0319034441063804, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -4.011326261059858, "episode_reward_min": -1359.8690935045604, "episode_reward_mean": -715.8037693310938, "episode_len_mean": 137.53, "episode_media": {}, "episodes_timesteps_total": 13753, "policy_reward_min": {"policy_0": -1359.8690935045604}, "policy_reward_max": {"policy_0": -4.011326261059858}, "policy_reward_mean": {"policy_0": -715.8037693310938}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-278.90036438730965, -1113.2850241513422, -946.1502171566665, -1251.954818349254, -575.0685016981773, -1359.8690935045604, -188.3213831885553, -928.4650450827071, -601.5394287424375, -828.5441180919878, -455.1904004339306, -952.8384290464878, -760.4564149230615, -321.17165595812287, -57.37253285266121, -1141.068778073409, -1160.5545891554264, -69.28417766263601, -427.1220370313674, -1022.3415675895724, -186.68042113077803, -1143.6374702355495, -158.58020305923267, -1025.9390006023725, -731.863647755859, -790.8353791423566, -373.49198053836335, -817.8678881239773, -999.442038196043, -434.55690286993627, -914.3837490227875, -699.9318948888025, -591.2078713875634, -654.996685858322, -536.0258106111814, -1154.8103283881069, -1144.7540019137539, -1035.9966950226342, -541.2570145397293, -415.48856699305554, -268.4618974797046, -535.8155899977509, -260.89254023450104, -1000.495530101407, -812.1393365446047, -1135.9752371519996, -952.9583674281981, -675.4295334942176, -236.84594444093526, -21.029101414572644, -689.9461037552575, -1034.9090355526682, -749.3533977785363, -18.397768061443724, -434.6230101607055, -920.1578014981637, -876.1861477823915, -599.0894527489612, -539.9013185777995, -1215.3503625468938, -734.9689415084641, -195.01146068778868, -976.2616060609109, -952.4537530258317, -684.3876754205202, -1168.95025154623, -46.91251476050953, -836.430021907649, -538.7400644252178, -962.1835143825831, -158.30535603044325, -596.4856132215019, -768.8254193627088, -449.62524077766517, -755.1095000470383, -1139.5607593876982, -443.6822809980729, -710.7792736114893, -1034.4977447076376, -213.0479855477249, -763.0610543232381, -616.3339308390749, -880.1918514761603, -788.5984305853005, -1192.4132622230486, -1061.9964704093977, -308.20414402347177, -925.6040882459204, -815.1620574367097, -405.9402602852969, -992.203554048382, -760.275237351357, -991.7786138569911, -1353.2729486698597, -4.011326261059858, -1155.5759083036544, -791.8774932552891, -1106.448295946736, -583.6936766122051, -948.3117474277418], "episode_lengths": [114, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 98, 51, 150, 150, 77, 142, 150, 68, 150, 78, 150, 150, 150, 104, 150, 150, 150, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 148, 150, 150, 150, 110, 45, 150, 150, 150, 46, 150, 150, 150, 134, 150, 150, 150, 95, 150, 150, 150, 150, 73, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 39, 150, 150, 150, 123, 150], "policy_policy_0_reward": [-278.90036438730965, -1113.2850241513422, -946.1502171566665, -1251.954818349254, -575.0685016981773, -1359.8690935045604, -188.3213831885553, -928.4650450827071, -601.5394287424375, -828.5441180919878, -455.1904004339306, -952.8384290464878, -760.4564149230615, -321.17165595812287, -57.37253285266121, -1141.068778073409, -1160.5545891554264, -69.28417766263601, -427.1220370313674, -1022.3415675895724, -186.68042113077803, -1143.6374702355495, -158.58020305923267, -1025.9390006023725, -731.863647755859, -790.8353791423566, -373.49198053836335, -817.8678881239773, -999.442038196043, -434.55690286993627, -914.3837490227875, -699.9318948888025, -591.2078713875634, -654.996685858322, -536.0258106111814, -1154.8103283881069, -1144.7540019137539, -1035.9966950226342, -541.2570145397293, -415.48856699305554, -268.4618974797046, -535.8155899977509, -260.89254023450104, -1000.495530101407, -812.1393365446047, -1135.9752371519996, -952.9583674281981, -675.4295334942176, -236.84594444093526, -21.029101414572644, -689.9461037552575, -1034.9090355526682, -749.3533977785363, -18.397768061443724, -434.6230101607055, -920.1578014981637, -876.1861477823915, -599.0894527489612, -539.9013185777995, -1215.3503625468938, -734.9689415084641, -195.01146068778868, -976.2616060609109, -952.4537530258317, -684.3876754205202, -1168.95025154623, -46.91251476050953, -836.430021907649, -538.7400644252178, -962.1835143825831, -158.30535603044325, -596.4856132215019, -768.8254193627088, -449.62524077766517, -755.1095000470383, -1139.5607593876982, -443.6822809980729, -710.7792736114893, -1034.4977447076376, -213.0479855477249, -763.0610543232381, -616.3339308390749, -880.1918514761603, -788.5984305853005, -1192.4132622230486, -1061.9964704093977, -308.20414402347177, -925.6040882459204, -815.1620574367097, -405.9402602852969, -992.203554048382, -760.275237351357, -991.7786138569911, -1353.2729486698597, -4.011326261059858, -1155.5759083036544, -791.8774932552891, -1106.448295946736, -583.6936766122051, -948.3117474277418]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526404241957245, "mean_inference_ms": 1.6707495308819165, "mean_action_processing_ms": 0.27647314999460376, "mean_env_wait_ms": 3.036800011769518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01232600212097168, "StateBufferConnector_ms": 0.007864952087402344, "ViewRequirementAgentConnector_ms": 0.19426345825195312}, "num_episodes": 28, "episode_return_max": -4.011326261059858, "episode_return_min": -1359.8690935045604, "episode_return_mean": -715.8037693310938, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.0438185278858, "num_env_steps_trained_throughput_per_sec": 302.0438185278858, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12922.004, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12921.931, "sample_time_ms": 1081.77, "learn_time_ms": 11774.465, "learn_throughput": 339.718, "synch_weights_time_ms": 64.888}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00010", "date": "2024-08-03_04-07-50", "timestamp": 1722638270, "time_this_iter_s": 13.254747152328491, "time_total_s": 297.76135301589966, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c7201f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 297.76135301589966, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.16315789473684, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.36613039175668, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.6943035036325456, "policy_loss": -0.011290816620263893, "vf_loss": 3.700320109228293, "vf_explained_var": 0.9784686484063665, "kl": 0.012091534369286212, "entropy": 1.669770522788167, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -4.011326261059858, "episode_reward_min": -1399.6609016893494, "episode_reward_mean": -742.7711094488316, "episode_len_mean": 139.58, "episode_media": {}, "episodes_timesteps_total": 13958, "policy_reward_min": {"policy_0": -1399.6609016893494}, "policy_reward_max": {"policy_0": -4.011326261059858}, "policy_reward_mean": {"policy_0": -742.7711094488316}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-914.3837490227875, -699.9318948888025, -591.2078713875634, -654.996685858322, -536.0258106111814, -1154.8103283881069, -1144.7540019137539, -1035.9966950226342, -541.2570145397293, -415.48856699305554, -268.4618974797046, -535.8155899977509, -260.89254023450104, -1000.495530101407, -812.1393365446047, -1135.9752371519996, -952.9583674281981, -675.4295334942176, -236.84594444093526, -21.029101414572644, -689.9461037552575, -1034.9090355526682, -749.3533977785363, -18.397768061443724, -434.6230101607055, -920.1578014981637, -876.1861477823915, -599.0894527489612, -539.9013185777995, -1215.3503625468938, -734.9689415084641, -195.01146068778868, -976.2616060609109, -952.4537530258317, -684.3876754205202, -1168.95025154623, -46.91251476050953, -836.430021907649, -538.7400644252178, -962.1835143825831, -158.30535603044325, -596.4856132215019, -768.8254193627088, -449.62524077766517, -755.1095000470383, -1139.5607593876982, -443.6822809980729, -710.7792736114893, -1034.4977447076376, -213.0479855477249, -763.0610543232381, -616.3339308390749, -880.1918514761603, -788.5984305853005, -1192.4132622230486, -1061.9964704093977, -308.20414402347177, -925.6040882459204, -815.1620574367097, -405.9402602852969, -992.203554048382, -760.275237351357, -991.7786138569911, -1353.2729486698597, -4.011326261059858, -1155.5759083036544, -791.8774932552891, -1106.448295946736, -583.6936766122051, -948.3117474277418, -884.8435076190302, -611.616565204766, -1234.0898196964947, -1145.4051354954045, -1072.5336499651096, -789.8678804968188, -1011.9895538631561, -265.18737619009926, -1032.7715766495912, -473.4691993842647, -439.90191219839784, -962.455173446588, -954.1179926877704, -794.2941353375044, -68.23179383452013, -1094.7025229828248, -752.0630038374478, -822.6807928791878, -105.80392061164257, -756.604148039806, -813.4701287742812, -532.2692253340308, -1399.6609016893494, -853.7556861114377, -370.1506423922774, -902.0284172902626, -1313.0855266070516, -1128.7367719602553, -333.7249576065473, -879.6156023219918], "episode_lengths": [150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 148, 150, 150, 150, 110, 45, 150, 150, 150, 46, 150, 150, 150, 134, 150, 150, 150, 95, 150, 150, 150, 150, 73, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 39, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 139, 150, 150, 150, 150, 59, 150, 150, 150, 79, 147, 150, 150, 150, 150, 118, 150, 150, 150, 97, 150], "policy_policy_0_reward": [-914.3837490227875, -699.9318948888025, -591.2078713875634, -654.996685858322, -536.0258106111814, -1154.8103283881069, -1144.7540019137539, -1035.9966950226342, -541.2570145397293, -415.48856699305554, -268.4618974797046, -535.8155899977509, -260.89254023450104, -1000.495530101407, -812.1393365446047, -1135.9752371519996, -952.9583674281981, -675.4295334942176, -236.84594444093526, -21.029101414572644, -689.9461037552575, -1034.9090355526682, -749.3533977785363, -18.397768061443724, -434.6230101607055, -920.1578014981637, -876.1861477823915, -599.0894527489612, -539.9013185777995, -1215.3503625468938, -734.9689415084641, -195.01146068778868, -976.2616060609109, -952.4537530258317, -684.3876754205202, -1168.95025154623, -46.91251476050953, -836.430021907649, -538.7400644252178, -962.1835143825831, -158.30535603044325, -596.4856132215019, -768.8254193627088, -449.62524077766517, -755.1095000470383, -1139.5607593876982, -443.6822809980729, -710.7792736114893, -1034.4977447076376, -213.0479855477249, -763.0610543232381, -616.3339308390749, -880.1918514761603, -788.5984305853005, -1192.4132622230486, -1061.9964704093977, -308.20414402347177, -925.6040882459204, -815.1620574367097, -405.9402602852969, -992.203554048382, -760.275237351357, -991.7786138569911, -1353.2729486698597, -4.011326261059858, -1155.5759083036544, -791.8774932552891, -1106.448295946736, -583.6936766122051, -948.3117474277418, -884.8435076190302, -611.616565204766, -1234.0898196964947, -1145.4051354954045, -1072.5336499651096, -789.8678804968188, -1011.9895538631561, -265.18737619009926, -1032.7715766495912, -473.4691993842647, -439.90191219839784, -962.455173446588, -954.1179926877704, -794.2941353375044, -68.23179383452013, -1094.7025229828248, -752.0630038374478, -822.6807928791878, -105.80392061164257, -756.604148039806, -813.4701287742812, -532.2692253340308, -1399.6609016893494, -853.7556861114377, -370.1506423922774, -902.0284172902626, -1313.0855266070516, -1128.7367719602553, -333.7249576065473, -879.6156023219918]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525585834440236, "mean_inference_ms": 1.6711553602669182, "mean_action_processing_ms": 0.27643359648847843, "mean_env_wait_ms": 3.040468079841931, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012181282043457031, "StateBufferConnector_ms": 0.007829666137695312, "ViewRequirementAgentConnector_ms": 0.19470977783203125}, "num_episodes": 30, "episode_return_max": -4.011326261059858, "episode_return_min": -1399.6609016893494, "episode_return_mean": -742.7711094488316, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.0245732067284, "num_env_steps_trained_throughput_per_sec": 330.0245732067284, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12802.455, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12802.382, "sample_time_ms": 1083.391, "learn_time_ms": 11654.507, "learn_throughput": 343.215, "synch_weights_time_ms": 63.678}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00010", "date": "2024-08-03_04-08-02", "timestamp": 1722638282, "time_this_iter_s": 12.132300615310669, "time_total_s": 309.8936536312103, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c722ef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 309.8936536312103, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.752941176470586, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 189.6426341275374, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.6274413406848907, "policy_loss": -0.013055625136378998, "vf_loss": 3.6340007123847804, "vf_explained_var": 0.9887357736006379, "kl": 0.014826125694101723, "entropy": 1.7549235420922438, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -4.011326261059858, "episode_reward_min": -1399.6609016893494, "episode_reward_mean": -742.7224304527647, "episode_len_mean": 138.75, "episode_media": {}, "episodes_timesteps_total": 13875, "policy_reward_min": {"policy_0": -1399.6609016893494}, "policy_reward_max": {"policy_0": -4.011326261059858}, "policy_reward_mean": {"policy_0": -742.7224304527647}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1215.3503625468938, -734.9689415084641, -195.01146068778868, -976.2616060609109, -952.4537530258317, -684.3876754205202, -1168.95025154623, -46.91251476050953, -836.430021907649, -538.7400644252178, -962.1835143825831, -158.30535603044325, -596.4856132215019, -768.8254193627088, -449.62524077766517, -755.1095000470383, -1139.5607593876982, -443.6822809980729, -710.7792736114893, -1034.4977447076376, -213.0479855477249, -763.0610543232381, -616.3339308390749, -880.1918514761603, -788.5984305853005, -1192.4132622230486, -1061.9964704093977, -308.20414402347177, -925.6040882459204, -815.1620574367097, -405.9402602852969, -992.203554048382, -760.275237351357, -991.7786138569911, -1353.2729486698597, -4.011326261059858, -1155.5759083036544, -791.8774932552891, -1106.448295946736, -583.6936766122051, -948.3117474277418, -884.8435076190302, -611.616565204766, -1234.0898196964947, -1145.4051354954045, -1072.5336499651096, -789.8678804968188, -1011.9895538631561, -265.18737619009926, -1032.7715766495912, -473.4691993842647, -439.90191219839784, -962.455173446588, -954.1179926877704, -794.2941353375044, -68.23179383452013, -1094.7025229828248, -752.0630038374478, -822.6807928791878, -105.80392061164257, -756.604148039806, -813.4701287742812, -532.2692253340308, -1399.6609016893494, -853.7556861114377, -370.1506423922774, -902.0284172902626, -1313.0855266070516, -1128.7367719602553, -333.7249576065473, -879.6156023219918, -325.99115035820114, -400.22747344975824, -1231.621913316214, -858.5468789723083, -718.1602883351292, -423.51858850999565, -692.032987123983, -745.3979496980646, -393.6236530560951, -498.6444959354431, -1062.241053070269, -1202.4573412835955, -298.6792090919123, -685.1635582378699, -1275.4247105058369, -244.08451528158665, -500.7623875157746, -128.23357477620993, -977.9944690921177, -1238.7708713752006, -1332.008251911858, -961.3150414627804, -264.96198879860754, -314.44349321518337, -636.7408626497713, -71.50280844974934, -187.3792877625996, -1010.421975709847, -766.2410542771198], "episode_lengths": [150, 150, 95, 150, 150, 150, 150, 73, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 39, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 139, 150, 150, 150, 150, 59, 150, 150, 150, 79, 147, 150, 150, 150, 150, 118, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 96, 150, 150, 80, 150, 72, 150, 150, 150, 150, 90, 150, 150, 66, 104, 150, 150], "policy_policy_0_reward": [-1215.3503625468938, -734.9689415084641, -195.01146068778868, -976.2616060609109, -952.4537530258317, -684.3876754205202, -1168.95025154623, -46.91251476050953, -836.430021907649, -538.7400644252178, -962.1835143825831, -158.30535603044325, -596.4856132215019, -768.8254193627088, -449.62524077766517, -755.1095000470383, -1139.5607593876982, -443.6822809980729, -710.7792736114893, -1034.4977447076376, -213.0479855477249, -763.0610543232381, -616.3339308390749, -880.1918514761603, -788.5984305853005, -1192.4132622230486, -1061.9964704093977, -308.20414402347177, -925.6040882459204, -815.1620574367097, -405.9402602852969, -992.203554048382, -760.275237351357, -991.7786138569911, -1353.2729486698597, -4.011326261059858, -1155.5759083036544, -791.8774932552891, -1106.448295946736, -583.6936766122051, -948.3117474277418, -884.8435076190302, -611.616565204766, -1234.0898196964947, -1145.4051354954045, -1072.5336499651096, -789.8678804968188, -1011.9895538631561, -265.18737619009926, -1032.7715766495912, -473.4691993842647, -439.90191219839784, -962.455173446588, -954.1179926877704, -794.2941353375044, -68.23179383452013, -1094.7025229828248, -752.0630038374478, -822.6807928791878, -105.80392061164257, -756.604148039806, -813.4701287742812, -532.2692253340308, -1399.6609016893494, -853.7556861114377, -370.1506423922774, -902.0284172902626, -1313.0855266070516, -1128.7367719602553, -333.7249576065473, -879.6156023219918, -325.99115035820114, -400.22747344975824, -1231.621913316214, -858.5468789723083, -718.1602883351292, -423.51858850999565, -692.032987123983, -745.3979496980646, -393.6236530560951, -498.6444959354431, -1062.241053070269, -1202.4573412835955, -298.6792090919123, -685.1635582378699, -1275.4247105058369, -244.08451528158665, -500.7623875157746, -128.23357477620993, -977.9944690921177, -1238.7708713752006, -1332.008251911858, -961.3150414627804, -264.96198879860754, -314.44349321518337, -636.7408626497713, -71.50280844974934, -187.3792877625996, -1010.421975709847, -766.2410542771198]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5525792133176504, "mean_inference_ms": 1.6710683889696147, "mean_action_processing_ms": 0.2764580498454983, "mean_env_wait_ms": 3.0444348204603546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01224660873413086, "StateBufferConnector_ms": 0.008002758026123047, "ViewRequirementAgentConnector_ms": 0.19400620460510254}, "num_episodes": 29, "episode_return_max": -4.011326261059858, "episode_return_min": -1399.6609016893494, "episode_return_mean": -742.7224304527647, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.29527342702005, "num_env_steps_trained_throughput_per_sec": 320.29527342702005, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12934.347, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12934.276, "sample_time_ms": 1090.321, "learn_time_ms": 11779.939, "learn_throughput": 339.56, "synch_weights_time_ms": 63.212}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00010", "date": "2024-08-03_04-08-15", "timestamp": 1722638295, "time_this_iter_s": 12.50026559829712, "time_total_s": 322.39391922950745, "pid": 469182, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c721240>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 322.39391922950745, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.816666666666663, "ram_util_percent": 27.8}}
