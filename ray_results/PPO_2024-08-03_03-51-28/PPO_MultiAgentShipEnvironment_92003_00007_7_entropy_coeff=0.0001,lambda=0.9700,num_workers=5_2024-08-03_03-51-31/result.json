{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8084914452085893, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.747360526522, "policy_loss": -0.004941946930678872, "vf_loss": 9.750777594248454, "vf_explained_var": 0.04447444416582584, "kl": 0.008334372137566486, "entropy": 1.4199444706241289, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -126.66489691323997, "episode_reward_min": -1010.7156041549289, "episode_reward_mean": -699.1546707335715, "episode_len_mean": 141.26923076923077, "episode_media": {}, "episodes_timesteps_total": 3673, "policy_reward_min": {"policy_0": -1010.7156041549289}, "policy_reward_max": {"policy_0": -126.66489691323997}, "policy_reward_mean": {"policy_0": -699.1546707335715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-892.2614335002078, -628.0468330592855, -1010.7156041549289, -211.2636325314806, -968.7896383742271, -722.0572896912006, -907.886908273668, -713.1779334522328, -840.9566032122331, -590.0981293519776, -507.0980183422528, -142.76026817289411, -435.0637189757265, -701.818196676833, -126.66489691323997, -841.51798127507, -734.6919227925288, -954.6361912909268, -741.3898289094602, -864.3507939243698, -832.4579975923117, -657.094693178193, -943.4378745509478, -569.6203883201047, -879.3961155440451, -760.7685470125111], "episode_lengths": [150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 117, 102, 144, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-892.2614335002078, -628.0468330592855, -1010.7156041549289, -211.2636325314806, -968.7896383742271, -722.0572896912006, -907.886908273668, -713.1779334522328, -840.9566032122331, -590.0981293519776, -507.0980183422528, -142.76026817289411, -435.0637189757265, -701.818196676833, -126.66489691323997, -841.51798127507, -734.6919227925288, -954.6361912909268, -741.3898289094602, -864.3507939243698, -832.4579975923117, -657.094693178193, -943.4378745509478, -569.6203883201047, -879.3961155440451, -760.7685470125111]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28479558343355216, "mean_inference_ms": 0.8634785393249926, "mean_action_processing_ms": 0.15828931845655175, "mean_env_wait_ms": 1.4963507205805977, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006669301253098708, "StateBufferConnector_ms": 0.004335550161508413, "ViewRequirementAgentConnector_ms": 0.09677318426278922}, "num_episodes": 26, "episode_return_max": -126.66489691323997, "episode_return_min": -1010.7156041549289, "episode_return_mean": -699.1546707335715, "episodes_this_iter": 26}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.65873935291114, "num_env_steps_trained_throughput_per_sec": 268.65873935291114, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 14888.787, "restore_workers_time_ms": 0.018, "training_step_time_ms": 14888.73, "sample_time_ms": 2361.388, "learn_time_ms": 12510.446, "learn_throughput": 319.733, "synch_weights_time_ms": 16.088}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00007", "date": "2024-08-03_05-25-05", "timestamp": 1722642905, "time_this_iter_s": 14.894172430038452, "time_total_s": 14.894172430038452, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fdb520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14.894172430038452, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.409090909090908, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.18790771253407, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.54937453965346, "policy_loss": -0.013515184048446826, "vf_loss": 9.559793282548586, "vf_explained_var": 0.10563830522199472, "kl": 0.016202341319603877, "entropy": 1.4402827964474758, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -16.025911397537616, "episode_reward_min": -1145.6880361636406, "episode_reward_mean": -661.8222286573288, "episode_len_mean": 134.64912280701753, "episode_media": {}, "episodes_timesteps_total": 7675, "policy_reward_min": {"policy_0": -1145.6880361636406}, "policy_reward_max": {"policy_0": -16.025911397537616}, "policy_reward_mean": {"policy_0": -661.8222286573288}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-892.2614335002078, -628.0468330592855, -1010.7156041549289, -211.2636325314806, -968.7896383742271, -722.0572896912006, -907.886908273668, -713.1779334522328, -840.9566032122331, -590.0981293519776, -507.0980183422528, -142.76026817289411, -435.0637189757265, -701.818196676833, -126.66489691323997, -841.51798127507, -734.6919227925288, -954.6361912909268, -741.3898289094602, -864.3507939243698, -832.4579975923117, -657.094693178193, -943.4378745509478, -569.6203883201047, -879.3961155440451, -760.7685470125111, -1007.681635347541, -1022.78938397223, -286.32122686164934, -33.828624183214245, -833.2737628449017, -899.5506545222788, -16.025911397537616, -617.6987126772929, -1145.6880361636406, -164.89320624658063, -1067.027614639442, -827.8770151814555, -907.916743077502, -956.105958899992, -262.45334706068076, -686.945453645098, -393.2621843817591, -175.27539463917603, -431.0073941885583, -752.6184082428099, -107.00248669840235, -773.3248099895634, -515.4176672035969, -1079.8621929648205, -674.0622190043317, -592.4751714977673, -738.5997158344036, -789.376685890017, -958.2100572943758, -96.75801670115197, -732.5159031431136], "episode_lengths": [150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 117, 102, 144, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 45, 150, 150, 43, 150, 150, 81, 150, 150, 150, 150, 102, 150, 112, 89, 150, 150, 81, 150, 131, 150, 150, 150, 150, 150, 150, 81, 150], "policy_policy_0_reward": [-892.2614335002078, -628.0468330592855, -1010.7156041549289, -211.2636325314806, -968.7896383742271, -722.0572896912006, -907.886908273668, -713.1779334522328, -840.9566032122331, -590.0981293519776, -507.0980183422528, -142.76026817289411, -435.0637189757265, -701.818196676833, -126.66489691323997, -841.51798127507, -734.6919227925288, -954.6361912909268, -741.3898289094602, -864.3507939243698, -832.4579975923117, -657.094693178193, -943.4378745509478, -569.6203883201047, -879.3961155440451, -760.7685470125111, -1007.681635347541, -1022.78938397223, -286.32122686164934, -33.828624183214245, -833.2737628449017, -899.5506545222788, -16.025911397537616, -617.6987126772929, -1145.6880361636406, -164.89320624658063, -1067.027614639442, -827.8770151814555, -907.916743077502, -956.105958899992, -262.45334706068076, -686.945453645098, -393.2621843817591, -175.27539463917603, -431.0073941885583, -752.6184082428099, -107.00248669840235, -773.3248099895634, -515.4176672035969, -1079.8621929648205, -674.0622190043317, -592.4751714977673, -738.5997158344036, -789.376685890017, -958.2100572943758, -96.75801670115197, -732.5159031431136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2825734964275393, "mean_inference_ms": 0.8658611826075511, "mean_action_processing_ms": 0.15805009522480698, "mean_env_wait_ms": 1.5007788332749046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006297596713952851, "StateBufferConnector_ms": 0.0041396994339792355, "ViewRequirementAgentConnector_ms": 0.09626380184240509}, "num_episodes": 31, "episode_return_max": -16.025911397537616, "episode_return_min": -1145.6880361636406, "episode_return_mean": -661.8222286573288, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.65121379970685, "num_env_steps_trained_throughput_per_sec": 266.65121379970685, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 14944.833, "restore_workers_time_ms": 0.019, "training_step_time_ms": 14944.776, "sample_time_ms": 2356.252, "learn_time_ms": 12571.58, "learn_throughput": 318.178, "synch_weights_time_ms": 16.093}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00007", "date": "2024-08-03_05-25-20", "timestamp": 1722642920, "time_this_iter_s": 15.008228540420532, "time_total_s": 29.902400970458984, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fdb760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 29.902400970458984, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 13.061904761904762, "ram_util_percent": 19.271428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7897795501475533, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.496998129288356, "policy_loss": -0.009720513273593193, "vf_loss": 9.50428328514099, "vf_explained_var": 0.16138574704527855, "kl": 0.012906177927349443, "entropy": 1.4587302458782991, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -13.692082313328104, "episode_reward_min": -1400.7311027433893, "episode_reward_mean": -669.4567703134338, "episode_len_mean": 135.27906976744185, "episode_media": {}, "episodes_timesteps_total": 11634, "policy_reward_min": {"policy_0": -1400.7311027433893}, "policy_reward_max": {"policy_0": -13.692082313328104}, "policy_reward_mean": {"policy_0": -669.4567703134338}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-892.2614335002078, -628.0468330592855, -1010.7156041549289, -211.2636325314806, -968.7896383742271, -722.0572896912006, -907.886908273668, -713.1779334522328, -840.9566032122331, -590.0981293519776, -507.0980183422528, -142.76026817289411, -435.0637189757265, -701.818196676833, -126.66489691323997, -841.51798127507, -734.6919227925288, -954.6361912909268, -741.3898289094602, -864.3507939243698, -832.4579975923117, -657.094693178193, -943.4378745509478, -569.6203883201047, -879.3961155440451, -760.7685470125111, -1007.681635347541, -1022.78938397223, -286.32122686164934, -33.828624183214245, -833.2737628449017, -899.5506545222788, -16.025911397537616, -617.6987126772929, -1145.6880361636406, -164.89320624658063, -1067.027614639442, -827.8770151814555, -907.916743077502, -956.105958899992, -262.45334706068076, -686.945453645098, -393.2621843817591, -175.27539463917603, -431.0073941885583, -752.6184082428099, -107.00248669840235, -773.3248099895634, -515.4176672035969, -1079.8621929648205, -674.0622190043317, -592.4751714977673, -738.5997158344036, -789.376685890017, -958.2100572943758, -96.75801670115197, -732.5159031431136, -770.3254110583673, -885.6921722057019, -912.1413211435629, -13.692082313328104, -885.9164950582974, -618.2474009073989, -872.9481913212733, -697.4977261935583, -908.2612375192527, -882.7851338308174, -792.780278145153, -288.14862044670076, -800.9116924069116, -321.3350423929473, -816.5311678689544, -163.0454838893245, -351.37910131433176, -928.7560186391488, -460.6028670598818, -687.4973531617516, -968.5582503598708, -950.8186294405847, -812.5013605276052, -208.84627012649054, -501.40816524042435, -670.1734356171502, -718.3402188755307, -559.5429836798585, -1400.7311027433893], "episode_lengths": [150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 117, 102, 144, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 45, 150, 150, 43, 150, 150, 81, 150, 150, 150, 150, 102, 150, 112, 89, 150, 150, 81, 150, 131, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 43, 150, 118, 150, 150, 150, 150, 150, 150, 150, 108, 150, 75, 150, 150, 116, 150, 150, 150, 150, 89, 115, 150, 150, 145, 150], "policy_policy_0_reward": [-892.2614335002078, -628.0468330592855, -1010.7156041549289, -211.2636325314806, -968.7896383742271, -722.0572896912006, -907.886908273668, -713.1779334522328, -840.9566032122331, -590.0981293519776, -507.0980183422528, -142.76026817289411, -435.0637189757265, -701.818196676833, -126.66489691323997, -841.51798127507, -734.6919227925288, -954.6361912909268, -741.3898289094602, -864.3507939243698, -832.4579975923117, -657.094693178193, -943.4378745509478, -569.6203883201047, -879.3961155440451, -760.7685470125111, -1007.681635347541, -1022.78938397223, -286.32122686164934, -33.828624183214245, -833.2737628449017, -899.5506545222788, -16.025911397537616, -617.6987126772929, -1145.6880361636406, -164.89320624658063, -1067.027614639442, -827.8770151814555, -907.916743077502, -956.105958899992, -262.45334706068076, -686.945453645098, -393.2621843817591, -175.27539463917603, -431.0073941885583, -752.6184082428099, -107.00248669840235, -773.3248099895634, -515.4176672035969, -1079.8621929648205, -674.0622190043317, -592.4751714977673, -738.5997158344036, -789.376685890017, -958.2100572943758, -96.75801670115197, -732.5159031431136, -770.3254110583673, -885.6921722057019, -912.1413211435629, -13.692082313328104, -885.9164950582974, -618.2474009073989, -872.9481913212733, -697.4977261935583, -908.2612375192527, -882.7851338308174, -792.780278145153, -288.14862044670076, -800.9116924069116, -321.3350423929473, -816.5311678689544, -163.0454838893245, -351.37910131433176, -928.7560186391488, -460.6028670598818, -687.4973531617516, -968.5582503598708, -950.8186294405847, -812.5013605276052, -208.84627012649054, -501.40816524042435, -670.1734356171502, -718.3402188755307, -559.5429836798585, -1400.7311027433893]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2812957675149569, "mean_inference_ms": 0.866885037133562, "mean_action_processing_ms": 0.15789296892484436, "mean_env_wait_ms": 1.5053343509413672, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006019514660502589, "StateBufferConnector_ms": 0.00406226446462232, "ViewRequirementAgentConnector_ms": 0.0962176988291186}, "num_episodes": 29, "episode_return_max": -13.692082313328104, "episode_return_min": -1400.7311027433893, "episode_return_mean": -669.4567703134338, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.95453001663867, "num_env_steps_trained_throughput_per_sec": 264.95453001663867, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 14995.537, "restore_workers_time_ms": 0.02, "training_step_time_ms": 14995.477, "sample_time_ms": 2370.7, "learn_time_ms": 12607.723, "learn_throughput": 317.266, "synch_weights_time_ms": 16.214}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00007", "date": "2024-08-03_05-25-35", "timestamp": 1722642935, "time_this_iter_s": 15.103445053100586, "time_total_s": 45.00584602355957, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fda200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 45.00584602355957, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.754545454545456, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9496293441702923, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.580384446680545, "policy_loss": -0.008739995267630245, "vf_loss": 9.586075821518898, "vf_explained_var": 0.041353189883132774, "kl": 0.015957470593548354, "entropy": 1.428473728771011, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -13.692082313328104, "episode_reward_min": -1400.7311027433893, "episode_reward_mean": -705.5092202070168, "episode_len_mean": 136.35, "episode_media": {}, "episodes_timesteps_total": 13635, "policy_reward_min": {"policy_0": -1400.7311027433893}, "policy_reward_max": {"policy_0": -13.692082313328104}, "policy_reward_mean": {"policy_0": -705.5092202070168}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-841.51798127507, -734.6919227925288, -954.6361912909268, -741.3898289094602, -864.3507939243698, -832.4579975923117, -657.094693178193, -943.4378745509478, -569.6203883201047, -879.3961155440451, -760.7685470125111, -1007.681635347541, -1022.78938397223, -286.32122686164934, -33.828624183214245, -833.2737628449017, -899.5506545222788, -16.025911397537616, -617.6987126772929, -1145.6880361636406, -164.89320624658063, -1067.027614639442, -827.8770151814555, -907.916743077502, -956.105958899992, -262.45334706068076, -686.945453645098, -393.2621843817591, -175.27539463917603, -431.0073941885583, -752.6184082428099, -107.00248669840235, -773.3248099895634, -515.4176672035969, -1079.8621929648205, -674.0622190043317, -592.4751714977673, -738.5997158344036, -789.376685890017, -958.2100572943758, -96.75801670115197, -732.5159031431136, -770.3254110583673, -885.6921722057019, -912.1413211435629, -13.692082313328104, -885.9164950582974, -618.2474009073989, -872.9481913212733, -697.4977261935583, -908.2612375192527, -882.7851338308174, -792.780278145153, -288.14862044670076, -800.9116924069116, -321.3350423929473, -816.5311678689544, -163.0454838893245, -351.37910131433176, -928.7560186391488, -460.6028670598818, -687.4973531617516, -968.5582503598708, -950.8186294405847, -812.5013605276052, -208.84627012649054, -501.40816524042435, -670.1734356171502, -718.3402188755307, -559.5429836798585, -1400.7311027433893, -707.8419567359202, -809.939709775727, -967.9524644176355, -454.71618657925177, -939.7917363774943, -1130.012265906087, -692.1202878321324, -469.24899788818186, -1120.5293878928596, -411.02032136156384, -1185.5364621897154, -926.0899641906249, -872.6635559398297, -1091.6708945420341, -943.8387920396985, -668.9191977165168, -758.4896616777379, -902.8825138451627, -200.2207579333778, -878.5192765673003, -590.118981925142, -356.93773632368914, -55.99467556681065, -796.7125336632361, -1168.9079848825195, -721.7810225965918, -250.28092766602094, -1139.5269732224042, -1164.0336511734781], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 45, 150, 150, 43, 150, 150, 81, 150, 150, 150, 150, 102, 150, 112, 89, 150, 150, 81, 150, 131, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 43, 150, 118, 150, 150, 150, 150, 150, 150, 150, 108, 150, 75, 150, 150, 116, 150, 150, 150, 150, 89, 115, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 130, 90, 51, 150, 150, 150, 107, 150, 150], "policy_policy_0_reward": [-841.51798127507, -734.6919227925288, -954.6361912909268, -741.3898289094602, -864.3507939243698, -832.4579975923117, -657.094693178193, -943.4378745509478, -569.6203883201047, -879.3961155440451, -760.7685470125111, -1007.681635347541, -1022.78938397223, -286.32122686164934, -33.828624183214245, -833.2737628449017, -899.5506545222788, -16.025911397537616, -617.6987126772929, -1145.6880361636406, -164.89320624658063, -1067.027614639442, -827.8770151814555, -907.916743077502, -956.105958899992, -262.45334706068076, -686.945453645098, -393.2621843817591, -175.27539463917603, -431.0073941885583, -752.6184082428099, -107.00248669840235, -773.3248099895634, -515.4176672035969, -1079.8621929648205, -674.0622190043317, -592.4751714977673, -738.5997158344036, -789.376685890017, -958.2100572943758, -96.75801670115197, -732.5159031431136, -770.3254110583673, -885.6921722057019, -912.1413211435629, -13.692082313328104, -885.9164950582974, -618.2474009073989, -872.9481913212733, -697.4977261935583, -908.2612375192527, -882.7851338308174, -792.780278145153, -288.14862044670076, -800.9116924069116, -321.3350423929473, -816.5311678689544, -163.0454838893245, -351.37910131433176, -928.7560186391488, -460.6028670598818, -687.4973531617516, -968.5582503598708, -950.8186294405847, -812.5013605276052, -208.84627012649054, -501.40816524042435, -670.1734356171502, -718.3402188755307, -559.5429836798585, -1400.7311027433893, -707.8419567359202, -809.939709775727, -967.9524644176355, -454.71618657925177, -939.7917363774943, -1130.012265906087, -692.1202878321324, -469.24899788818186, -1120.5293878928596, -411.02032136156384, -1185.5364621897154, -926.0899641906249, -872.6635559398297, -1091.6708945420341, -943.8387920396985, -668.9191977165168, -758.4896616777379, -902.8825138451627, -200.2207579333778, -878.5192765673003, -590.118981925142, -356.93773632368914, -55.99467556681065, -796.7125336632361, -1168.9079848825195, -721.7810225965918, -250.28092766602094, -1139.5269732224042, -1164.0336511734781]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28153214436984814, "mean_inference_ms": 0.8696208209407552, "mean_action_processing_ms": 0.15805197317974204, "mean_env_wait_ms": 1.5117456611861286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005997657775878906, "StateBufferConnector_ms": 0.004004240036010742, "ViewRequirementAgentConnector_ms": 0.09746050834655762}, "num_episodes": 29, "episode_return_max": -13.692082313328104, "episode_return_min": -1400.7311027433893, "episode_return_mean": -705.5092202070168, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.31216174951646, "num_env_steps_trained_throughput_per_sec": 274.31216174951646, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 14892.138, "restore_workers_time_ms": 0.022, "training_step_time_ms": 14892.073, "sample_time_ms": 2364.722, "learn_time_ms": 12509.929, "learn_throughput": 319.746, "synch_weights_time_ms": 16.56}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00007", "date": "2024-08-03_05-25-50", "timestamp": 1722642950, "time_this_iter_s": 14.589445114135742, "time_total_s": 59.59529113769531, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fda3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 59.59529113769531, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.15, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.657652801523606, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.42925202647845, "policy_loss": -0.006340046633461801, "vf_loss": 9.433154400189718, "vf_explained_var": 0.07920470082511505, "kl": 0.012921098539497208, "entropy": 1.46571444918712, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -13.692082313328104, "episode_reward_min": -1400.7311027433893, "episode_reward_mean": -740.8179604476994, "episode_len_mean": 139.32, "episode_media": {}, "episodes_timesteps_total": 13932, "policy_reward_min": {"policy_0": -1400.7311027433893}, "policy_reward_max": {"policy_0": -13.692082313328104}, "policy_reward_mean": {"policy_0": -740.8179604476994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-175.27539463917603, -431.0073941885583, -752.6184082428099, -107.00248669840235, -773.3248099895634, -515.4176672035969, -1079.8621929648205, -674.0622190043317, -592.4751714977673, -738.5997158344036, -789.376685890017, -958.2100572943758, -96.75801670115197, -732.5159031431136, -770.3254110583673, -885.6921722057019, -912.1413211435629, -13.692082313328104, -885.9164950582974, -618.2474009073989, -872.9481913212733, -697.4977261935583, -908.2612375192527, -882.7851338308174, -792.780278145153, -288.14862044670076, -800.9116924069116, -321.3350423929473, -816.5311678689544, -163.0454838893245, -351.37910131433176, -928.7560186391488, -460.6028670598818, -687.4973531617516, -968.5582503598708, -950.8186294405847, -812.5013605276052, -208.84627012649054, -501.40816524042435, -670.1734356171502, -718.3402188755307, -559.5429836798585, -1400.7311027433893, -707.8419567359202, -809.939709775727, -967.9524644176355, -454.71618657925177, -939.7917363774943, -1130.012265906087, -692.1202878321324, -469.24899788818186, -1120.5293878928596, -411.02032136156384, -1185.5364621897154, -926.0899641906249, -872.6635559398297, -1091.6708945420341, -943.8387920396985, -668.9191977165168, -758.4896616777379, -902.8825138451627, -200.2207579333778, -878.5192765673003, -590.118981925142, -356.93773632368914, -55.99467556681065, -796.7125336632361, -1168.9079848825195, -721.7810225965918, -250.28092766602094, -1139.5269732224042, -1164.0336511734781, -1130.5946103050503, -1303.7315462213044, -781.9338209222062, -433.9726066431725, -978.011541437378, -261.3360958553041, -809.8316814137705, -1113.6342458451336, -766.6481281699851, -1214.633944094039, -584.6151209030396, -900.1776722344979, -1077.5172489072986, -625.7248813116718, -953.2535055029953, -954.9844571789583, -765.8815167195664, -861.0058333445787, -863.226619806632, -1088.992155205056, -186.5556685714037, -912.9087868548891, -690.7085123390455, -694.2819853278243, -590.3748930907484, -990.8291930487966, -959.4895494269626, -944.7200088802507], "episode_lengths": [89, 150, 150, 81, 150, 131, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 43, 150, 118, 150, 150, 150, 150, 150, 150, 150, 108, 150, 75, 150, 150, 116, 150, 150, 150, 150, 89, 115, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 130, 90, 51, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-175.27539463917603, -431.0073941885583, -752.6184082428099, -107.00248669840235, -773.3248099895634, -515.4176672035969, -1079.8621929648205, -674.0622190043317, -592.4751714977673, -738.5997158344036, -789.376685890017, -958.2100572943758, -96.75801670115197, -732.5159031431136, -770.3254110583673, -885.6921722057019, -912.1413211435629, -13.692082313328104, -885.9164950582974, -618.2474009073989, -872.9481913212733, -697.4977261935583, -908.2612375192527, -882.7851338308174, -792.780278145153, -288.14862044670076, -800.9116924069116, -321.3350423929473, -816.5311678689544, -163.0454838893245, -351.37910131433176, -928.7560186391488, -460.6028670598818, -687.4973531617516, -968.5582503598708, -950.8186294405847, -812.5013605276052, -208.84627012649054, -501.40816524042435, -670.1734356171502, -718.3402188755307, -559.5429836798585, -1400.7311027433893, -707.8419567359202, -809.939709775727, -967.9524644176355, -454.71618657925177, -939.7917363774943, -1130.012265906087, -692.1202878321324, -469.24899788818186, -1120.5293878928596, -411.02032136156384, -1185.5364621897154, -926.0899641906249, -872.6635559398297, -1091.6708945420341, -943.8387920396985, -668.9191977165168, -758.4896616777379, -902.8825138451627, -200.2207579333778, -878.5192765673003, -590.118981925142, -356.93773632368914, -55.99467556681065, -796.7125336632361, -1168.9079848825195, -721.7810225965918, -250.28092766602094, -1139.5269732224042, -1164.0336511734781, -1130.5946103050503, -1303.7315462213044, -781.9338209222062, -433.9726066431725, -978.011541437378, -261.3360958553041, -809.8316814137705, -1113.6342458451336, -766.6481281699851, -1214.633944094039, -584.6151209030396, -900.1776722344979, -1077.5172489072986, -625.7248813116718, -953.2535055029953, -954.9844571789583, -765.8815167195664, -861.0058333445787, -863.226619806632, -1088.992155205056, -186.5556685714037, -912.9087868548891, -690.7085123390455, -694.2819853278243, -590.3748930907484, -990.8291930487966, -959.4895494269626, -944.7200088802507]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27980341887158233, "mean_inference_ms": 0.8705902237080891, "mean_action_processing_ms": 0.1578389493985714, "mean_env_wait_ms": 1.5158484230394251, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00585174560546875, "StateBufferConnector_ms": 0.003912925720214844, "ViewRequirementAgentConnector_ms": 0.0976104736328125}, "num_episodes": 28, "episode_return_max": -13.692082313328104, "episode_return_min": -1400.7311027433893, "episode_return_mean": -740.8179604476994, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 359.468155103209, "num_env_steps_trained_throughput_per_sec": 359.468155103209, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 14139.224, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14139.156, "sample_time_ms": 2364.058, "learn_time_ms": 11757.493, "learn_throughput": 340.209, "synch_weights_time_ms": 16.742}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00007", "date": "2024-08-03_05-26-01", "timestamp": 1722642961, "time_this_iter_s": 11.135898351669312, "time_total_s": 70.73118948936462, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fdb760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 70.73118948936462, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 13.712499999999999, "ram_util_percent": 19.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.688356254746517, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.23823246161143, "policy_loss": -0.013487621404541036, "vf_loss": 9.248184975981712, "vf_explained_var": 0.31843018587678673, "kl": 0.01839608716354633, "entropy": 1.4410573281347752, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -37.50636438684748, "episode_reward_min": -1400.7311027433893, "episode_reward_mean": -751.7079595065942, "episode_len_mean": 139.37, "episode_media": {}, "episodes_timesteps_total": 13937, "policy_reward_min": {"policy_0": -1400.7311027433893}, "policy_reward_max": {"policy_0": -37.50636438684748}, "policy_reward_mean": {"policy_0": -751.7079595065942}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-351.37910131433176, -928.7560186391488, -460.6028670598818, -687.4973531617516, -968.5582503598708, -950.8186294405847, -812.5013605276052, -208.84627012649054, -501.40816524042435, -670.1734356171502, -718.3402188755307, -559.5429836798585, -1400.7311027433893, -707.8419567359202, -809.939709775727, -967.9524644176355, -454.71618657925177, -939.7917363774943, -1130.012265906087, -692.1202878321324, -469.24899788818186, -1120.5293878928596, -411.02032136156384, -1185.5364621897154, -926.0899641906249, -872.6635559398297, -1091.6708945420341, -943.8387920396985, -668.9191977165168, -758.4896616777379, -902.8825138451627, -200.2207579333778, -878.5192765673003, -590.118981925142, -356.93773632368914, -55.99467556681065, -796.7125336632361, -1168.9079848825195, -721.7810225965918, -250.28092766602094, -1139.5269732224042, -1164.0336511734781, -1130.5946103050503, -1303.7315462213044, -781.9338209222062, -433.9726066431725, -978.011541437378, -261.3360958553041, -809.8316814137705, -1113.6342458451336, -766.6481281699851, -1214.633944094039, -584.6151209030396, -900.1776722344979, -1077.5172489072986, -625.7248813116718, -953.2535055029953, -954.9844571789583, -765.8815167195664, -861.0058333445787, -863.226619806632, -1088.992155205056, -186.5556685714037, -912.9087868548891, -690.7085123390455, -694.2819853278243, -590.3748930907484, -990.8291930487966, -959.4895494269626, -944.7200088802507, -159.18455758613126, -833.0283083992978, -915.0123148633897, -1143.0699753284716, -437.65439354333756, -753.4857735297427, -300.7349367744857, -510.15054778039155, -37.50636438684748, -961.2504569767598, -317.31394231982296, -527.7654051609642, -702.997698145439, -259.5413171388005, -749.190613600354, -806.2642088233999, -910.3384213084759, -1199.4186168104575, -894.5873906539906, -1036.8531308559216, -817.39067977113, -445.97995726049277, -725.7897714242893, -50.660579855391035, -995.7262340932875, -1009.72834822855, -1021.1525788919329, -91.80218779634586, -627.7003231697564, -894.4864514054301], "episode_lengths": [150, 150, 116, 150, 150, 150, 150, 89, 115, 150, 150, 145, 150, 150, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 130, 90, 51, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 116, 50, 150, 109, 117, 150, 137, 150, 150, 150, 150, 150, 150, 150, 134, 150, 50, 150, 150, 150, 63, 150, 150], "policy_policy_0_reward": [-351.37910131433176, -928.7560186391488, -460.6028670598818, -687.4973531617516, -968.5582503598708, -950.8186294405847, -812.5013605276052, -208.84627012649054, -501.40816524042435, -670.1734356171502, -718.3402188755307, -559.5429836798585, -1400.7311027433893, -707.8419567359202, -809.939709775727, -967.9524644176355, -454.71618657925177, -939.7917363774943, -1130.012265906087, -692.1202878321324, -469.24899788818186, -1120.5293878928596, -411.02032136156384, -1185.5364621897154, -926.0899641906249, -872.6635559398297, -1091.6708945420341, -943.8387920396985, -668.9191977165168, -758.4896616777379, -902.8825138451627, -200.2207579333778, -878.5192765673003, -590.118981925142, -356.93773632368914, -55.99467556681065, -796.7125336632361, -1168.9079848825195, -721.7810225965918, -250.28092766602094, -1139.5269732224042, -1164.0336511734781, -1130.5946103050503, -1303.7315462213044, -781.9338209222062, -433.9726066431725, -978.011541437378, -261.3360958553041, -809.8316814137705, -1113.6342458451336, -766.6481281699851, -1214.633944094039, -584.6151209030396, -900.1776722344979, -1077.5172489072986, -625.7248813116718, -953.2535055029953, -954.9844571789583, -765.8815167195664, -861.0058333445787, -863.226619806632, -1088.992155205056, -186.5556685714037, -912.9087868548891, -690.7085123390455, -694.2819853278243, -590.3748930907484, -990.8291930487966, -959.4895494269626, -944.7200088802507, -159.18455758613126, -833.0283083992978, -915.0123148633897, -1143.0699753284716, -437.65439354333756, -753.4857735297427, -300.7349367744857, -510.15054778039155, -37.50636438684748, -961.2504569767598, -317.31394231982296, -527.7654051609642, -702.997698145439, -259.5413171388005, -749.190613600354, -806.2642088233999, -910.3384213084759, -1199.4186168104575, -894.5873906539906, -1036.8531308559216, -817.39067977113, -445.97995726049277, -725.7897714242893, -50.660579855391035, -995.7262340932875, -1009.72834822855, -1021.1525788919329, -91.80218779634586, -627.7003231697564, -894.4864514054301]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2790698084041125, "mean_inference_ms": 0.8707725957585467, "mean_action_processing_ms": 0.1575347998212473, "mean_env_wait_ms": 1.5199665822595836, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055162906646728516, "StateBufferConnector_ms": 0.003894329071044922, "ViewRequirementAgentConnector_ms": 0.09745645523071289}, "num_episodes": 30, "episode_return_max": -37.50636438684748, "episode_return_min": -1400.7311027433893, "episode_return_mean": -751.7079595065942, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.79524113057204, "num_env_steps_trained_throughput_per_sec": 267.79524113057204, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 14272.153, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14272.085, "sample_time_ms": 2365.59, "learn_time_ms": 11888.931, "learn_throughput": 336.447, "synch_weights_time_ms": 16.706}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00007", "date": "2024-08-03_05-26-16", "timestamp": 1722642976, "time_this_iter_s": 14.943037033081055, "time_total_s": 85.67422652244568, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fda200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 85.67422652244568, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.77272727272727, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.887405054519574, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.897911945482095, "policy_loss": -0.009219470849105467, "vf_loss": 8.904284124573072, "vf_explained_var": 0.3725343857581417, "kl": 0.014980670253013773, "entropy": 1.4885906560967366, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -18.91602236886937, "episode_reward_min": -1303.7315462213044, "episode_reward_mean": -715.2475145092835, "episode_len_mean": 135.81, "episode_media": {}, "episodes_timesteps_total": 13581, "policy_reward_min": {"policy_0": -1303.7315462213044}, "policy_reward_max": {"policy_0": -18.91602236886937}, "policy_reward_mean": {"policy_0": -715.2475145092835}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-668.9191977165168, -758.4896616777379, -902.8825138451627, -200.2207579333778, -878.5192765673003, -590.118981925142, -356.93773632368914, -55.99467556681065, -796.7125336632361, -1168.9079848825195, -721.7810225965918, -250.28092766602094, -1139.5269732224042, -1164.0336511734781, -1130.5946103050503, -1303.7315462213044, -781.9338209222062, -433.9726066431725, -978.011541437378, -261.3360958553041, -809.8316814137705, -1113.6342458451336, -766.6481281699851, -1214.633944094039, -584.6151209030396, -900.1776722344979, -1077.5172489072986, -625.7248813116718, -953.2535055029953, -954.9844571789583, -765.8815167195664, -861.0058333445787, -863.226619806632, -1088.992155205056, -186.5556685714037, -912.9087868548891, -690.7085123390455, -694.2819853278243, -590.3748930907484, -990.8291930487966, -959.4895494269626, -944.7200088802507, -159.18455758613126, -833.0283083992978, -915.0123148633897, -1143.0699753284716, -437.65439354333756, -753.4857735297427, -300.7349367744857, -510.15054778039155, -37.50636438684748, -961.2504569767598, -317.31394231982296, -527.7654051609642, -702.997698145439, -259.5413171388005, -749.190613600354, -806.2642088233999, -910.3384213084759, -1199.4186168104575, -894.5873906539906, -1036.8531308559216, -817.39067977113, -445.97995726049277, -725.7897714242893, -50.660579855391035, -995.7262340932875, -1009.72834822855, -1021.1525788919329, -91.80218779634586, -627.7003231697564, -894.4864514054301, -751.3531231957147, -844.5533876613199, -954.5987626092283, -1274.008416149286, -902.4430972897425, -18.91602236886937, -410.4510978301229, -793.992256132026, -306.18337572897383, -690.1079745972174, -210.68799691324787, -29.947831615933644, -154.06263332234187, -724.8404574133294, -1091.4094879930929, -806.3469887077977, -888.8110844157387, -945.9743451710383, -210.68875347600851, -612.3135469017116, -958.9673762261114, -652.5860216702295, -1295.2495658456523, -128.0501794888376, -727.5622799198266, -670.7767038895904, -471.62232994315946, -769.5791442475571], "episode_lengths": [150, 150, 150, 85, 150, 130, 90, 51, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 116, 50, 150, 109, 117, 150, 137, 150, 150, 150, 150, 150, 150, 150, 134, 150, 50, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 88, 150, 74, 56, 90, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 94, 150, 150, 150, 150], "policy_policy_0_reward": [-668.9191977165168, -758.4896616777379, -902.8825138451627, -200.2207579333778, -878.5192765673003, -590.118981925142, -356.93773632368914, -55.99467556681065, -796.7125336632361, -1168.9079848825195, -721.7810225965918, -250.28092766602094, -1139.5269732224042, -1164.0336511734781, -1130.5946103050503, -1303.7315462213044, -781.9338209222062, -433.9726066431725, -978.011541437378, -261.3360958553041, -809.8316814137705, -1113.6342458451336, -766.6481281699851, -1214.633944094039, -584.6151209030396, -900.1776722344979, -1077.5172489072986, -625.7248813116718, -953.2535055029953, -954.9844571789583, -765.8815167195664, -861.0058333445787, -863.226619806632, -1088.992155205056, -186.5556685714037, -912.9087868548891, -690.7085123390455, -694.2819853278243, -590.3748930907484, -990.8291930487966, -959.4895494269626, -944.7200088802507, -159.18455758613126, -833.0283083992978, -915.0123148633897, -1143.0699753284716, -437.65439354333756, -753.4857735297427, -300.7349367744857, -510.15054778039155, -37.50636438684748, -961.2504569767598, -317.31394231982296, -527.7654051609642, -702.997698145439, -259.5413171388005, -749.190613600354, -806.2642088233999, -910.3384213084759, -1199.4186168104575, -894.5873906539906, -1036.8531308559216, -817.39067977113, -445.97995726049277, -725.7897714242893, -50.660579855391035, -995.7262340932875, -1009.72834822855, -1021.1525788919329, -91.80218779634586, -627.7003231697564, -894.4864514054301, -751.3531231957147, -844.5533876613199, -954.5987626092283, -1274.008416149286, -902.4430972897425, -18.91602236886937, -410.4510978301229, -793.992256132026, -306.18337572897383, -690.1079745972174, -210.68799691324787, -29.947831615933644, -154.06263332234187, -724.8404574133294, -1091.4094879930929, -806.3469887077977, -888.8110844157387, -945.9743451710383, -210.68875347600851, -612.3135469017116, -958.9673762261114, -652.5860216702295, -1295.2495658456523, -128.0501794888376, -727.5622799198266, -670.7767038895904, -471.62232994315946, -769.5791442475571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27879522702613, "mean_inference_ms": 0.8730862210369412, "mean_action_processing_ms": 0.1574556676418582, "mean_env_wait_ms": 1.5244089085123624, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005424976348876953, "StateBufferConnector_ms": 0.0038509368896484375, "ViewRequirementAgentConnector_ms": 0.09614682197570801}, "num_episodes": 28, "episode_return_max": -18.91602236886937, "episode_return_min": -1303.7315462213044, "episode_return_mean": -715.2475145092835, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 252.02870581568317, "num_env_steps_trained_throughput_per_sec": 252.02870581568317, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 14500.591, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14500.524, "sample_time_ms": 2397.949, "learn_time_ms": 12085.239, "learn_throughput": 330.982, "synch_weights_time_ms": 16.479}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00007", "date": "2024-08-03_05-26-32", "timestamp": 1722642992, "time_this_iter_s": 15.878217220306396, "time_total_s": 101.55244374275208, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fdb2e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 101.55244374275208, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.759090909090906, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.731138188888629, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.427331396440666, "policy_loss": -0.013018060936398493, "vf_loss": 8.436663142343361, "vf_explained_var": 0.4651339367652933, "kl": 0.019193977637739112, "entropy": 1.5247853647917509, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -18.91602236886937, "episode_reward_min": -1295.2495658456523, "episode_reward_mean": -695.6973907176867, "episode_len_mean": 135.89, "episode_media": {}, "episodes_timesteps_total": 13589, "policy_reward_min": {"policy_0": -1295.2495658456523}, "policy_reward_max": {"policy_0": -18.91602236886937}, "policy_reward_mean": {"policy_0": -695.6973907176867}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-863.226619806632, -1088.992155205056, -186.5556685714037, -912.9087868548891, -690.7085123390455, -694.2819853278243, -590.3748930907484, -990.8291930487966, -959.4895494269626, -944.7200088802507, -159.18455758613126, -833.0283083992978, -915.0123148633897, -1143.0699753284716, -437.65439354333756, -753.4857735297427, -300.7349367744857, -510.15054778039155, -37.50636438684748, -961.2504569767598, -317.31394231982296, -527.7654051609642, -702.997698145439, -259.5413171388005, -749.190613600354, -806.2642088233999, -910.3384213084759, -1199.4186168104575, -894.5873906539906, -1036.8531308559216, -817.39067977113, -445.97995726049277, -725.7897714242893, -50.660579855391035, -995.7262340932875, -1009.72834822855, -1021.1525788919329, -91.80218779634586, -627.7003231697564, -894.4864514054301, -751.3531231957147, -844.5533876613199, -954.5987626092283, -1274.008416149286, -902.4430972897425, -18.91602236886937, -410.4510978301229, -793.992256132026, -306.18337572897383, -690.1079745972174, -210.68799691324787, -29.947831615933644, -154.06263332234187, -724.8404574133294, -1091.4094879930929, -806.3469887077977, -888.8110844157387, -945.9743451710383, -210.68875347600851, -612.3135469017116, -958.9673762261114, -652.5860216702295, -1295.2495658456523, -128.0501794888376, -727.5622799198266, -670.7767038895904, -471.62232994315946, -769.5791442475571, -800.3800270585047, -869.7245396582218, -692.0587122403884, -1126.3200828448544, -1002.9932287900118, -961.7027704992648, -725.5784658247344, -716.5338737110058, -982.0501932741122, -316.12034141395014, -323.89987073216884, -289.20656682850324, -1107.54316803027, -725.1107091346017, -1115.6730813851764, -804.4091321078105, -609.2216966095093, -589.0767885580138, -1029.7810648801237, -712.7993830625314, -1009.9345905256351, -158.4605671435673, -551.9316659229288, -350.7772455146746, -268.88108080934313, -167.04031782984168, -687.388600430409, -733.1843238081298, -881.1269429853692, -1081.5734800206535, -868.0727899917756, -957.2466709842047], "episode_lengths": [150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 116, 50, 150, 109, 117, 150, 137, 150, 150, 150, 150, 150, 150, 150, 134, 150, 50, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 88, 150, 74, 56, 90, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 124, 97, 101, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-863.226619806632, -1088.992155205056, -186.5556685714037, -912.9087868548891, -690.7085123390455, -694.2819853278243, -590.3748930907484, -990.8291930487966, -959.4895494269626, -944.7200088802507, -159.18455758613126, -833.0283083992978, -915.0123148633897, -1143.0699753284716, -437.65439354333756, -753.4857735297427, -300.7349367744857, -510.15054778039155, -37.50636438684748, -961.2504569767598, -317.31394231982296, -527.7654051609642, -702.997698145439, -259.5413171388005, -749.190613600354, -806.2642088233999, -910.3384213084759, -1199.4186168104575, -894.5873906539906, -1036.8531308559216, -817.39067977113, -445.97995726049277, -725.7897714242893, -50.660579855391035, -995.7262340932875, -1009.72834822855, -1021.1525788919329, -91.80218779634586, -627.7003231697564, -894.4864514054301, -751.3531231957147, -844.5533876613199, -954.5987626092283, -1274.008416149286, -902.4430972897425, -18.91602236886937, -410.4510978301229, -793.992256132026, -306.18337572897383, -690.1079745972174, -210.68799691324787, -29.947831615933644, -154.06263332234187, -724.8404574133294, -1091.4094879930929, -806.3469887077977, -888.8110844157387, -945.9743451710383, -210.68875347600851, -612.3135469017116, -958.9673762261114, -652.5860216702295, -1295.2495658456523, -128.0501794888376, -727.5622799198266, -670.7767038895904, -471.62232994315946, -769.5791442475571, -800.3800270585047, -869.7245396582218, -692.0587122403884, -1126.3200828448544, -1002.9932287900118, -961.7027704992648, -725.5784658247344, -716.5338737110058, -982.0501932741122, -316.12034141395014, -323.89987073216884, -289.20656682850324, -1107.54316803027, -725.1107091346017, -1115.6730813851764, -804.4091321078105, -609.2216966095093, -589.0767885580138, -1029.7810648801237, -712.7993830625314, -1009.9345905256351, -158.4605671435673, -551.9316659229288, -350.7772455146746, -268.88108080934313, -167.04031782984168, -687.388600430409, -733.1843238081298, -881.1269429853692, -1081.5734800206535, -868.0727899917756, -957.2466709842047]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.278431331649474, "mean_inference_ms": 0.883728317169731, "mean_action_processing_ms": 0.15751281551750654, "mean_env_wait_ms": 1.529101398808318, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005166769027709961, "StateBufferConnector_ms": 0.003840208053588867, "ViewRequirementAgentConnector_ms": 0.09611034393310547}, "num_episodes": 32, "episode_return_max": -18.91602236886937, "episode_return_min": -1295.2495658456523, "episode_return_mean": -695.6973907176867, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.9393795331319, "num_env_steps_trained_throughput_per_sec": 264.9393795331319, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 14575.243, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14575.176, "sample_time_ms": 2411.059, "learn_time_ms": 12146.294, "learn_throughput": 329.319, "synch_weights_time_ms": 16.959}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00007", "date": "2024-08-03_05-26-47", "timestamp": 1722643007, "time_this_iter_s": 15.106670141220093, "time_total_s": 116.65911388397217, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fd9510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 116.65911388397217, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 12.986363636363638, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.819773411999147, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.516235760351022, "policy_loss": -0.014063947526544022, "vf_loss": 7.526590420802434, "vf_explained_var": 0.5753302011017998, "kl": 0.019248670167902073, "entropy": 1.4046726636588573, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -18.91602236886937, "episode_reward_min": -1295.2495658456523, "episode_reward_mean": -690.3539064589476, "episode_len_mean": 135.66, "episode_media": {}, "episodes_timesteps_total": 13566, "policy_reward_min": {"policy_0": -1295.2495658456523}, "policy_reward_max": {"policy_0": -18.91602236886937}, "policy_reward_mean": {"policy_0": -690.3539064589476}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1199.4186168104575, -894.5873906539906, -1036.8531308559216, -817.39067977113, -445.97995726049277, -725.7897714242893, -50.660579855391035, -995.7262340932875, -1009.72834822855, -1021.1525788919329, -91.80218779634586, -627.7003231697564, -894.4864514054301, -751.3531231957147, -844.5533876613199, -954.5987626092283, -1274.008416149286, -902.4430972897425, -18.91602236886937, -410.4510978301229, -793.992256132026, -306.18337572897383, -690.1079745972174, -210.68799691324787, -29.947831615933644, -154.06263332234187, -724.8404574133294, -1091.4094879930929, -806.3469887077977, -888.8110844157387, -945.9743451710383, -210.68875347600851, -612.3135469017116, -958.9673762261114, -652.5860216702295, -1295.2495658456523, -128.0501794888376, -727.5622799198266, -670.7767038895904, -471.62232994315946, -769.5791442475571, -800.3800270585047, -869.7245396582218, -692.0587122403884, -1126.3200828448544, -1002.9932287900118, -961.7027704992648, -725.5784658247344, -716.5338737110058, -982.0501932741122, -316.12034141395014, -323.89987073216884, -289.20656682850324, -1107.54316803027, -725.1107091346017, -1115.6730813851764, -804.4091321078105, -609.2216966095093, -589.0767885580138, -1029.7810648801237, -712.7993830625314, -1009.9345905256351, -158.4605671435673, -551.9316659229288, -350.7772455146746, -268.88108080934313, -167.04031782984168, -687.388600430409, -733.1843238081298, -881.1269429853692, -1081.5734800206535, -868.0727899917756, -957.2466709842047, -827.4099697906141, -637.6315718569059, -1135.1691753174587, -423.1834166924422, -614.1438732587156, -29.815251106388185, -961.862077158678, -290.93647633327924, -948.232448823933, -76.65630391881902, -350.92557721008416, -275.1984182198723, -93.79151342552295, -490.6295928575801, -1130.5078505932308, -683.34082088399, -1176.0327504093991, -297.96980704501067, -770.3124351451457, -683.5393684148013, -736.6940099153052, -651.0636903093114, -986.0260443707595, -838.9481933097865, -1140.7440062249655, -580.2871504931308, -881.1763892586793], "episode_lengths": [150, 150, 150, 150, 134, 150, 50, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 88, 150, 74, 56, 90, 150, 150, 150, 150, 150, 78, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 124, 97, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 49, 104, 150, 61, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1199.4186168104575, -894.5873906539906, -1036.8531308559216, -817.39067977113, -445.97995726049277, -725.7897714242893, -50.660579855391035, -995.7262340932875, -1009.72834822855, -1021.1525788919329, -91.80218779634586, -627.7003231697564, -894.4864514054301, -751.3531231957147, -844.5533876613199, -954.5987626092283, -1274.008416149286, -902.4430972897425, -18.91602236886937, -410.4510978301229, -793.992256132026, -306.18337572897383, -690.1079745972174, -210.68799691324787, -29.947831615933644, -154.06263332234187, -724.8404574133294, -1091.4094879930929, -806.3469887077977, -888.8110844157387, -945.9743451710383, -210.68875347600851, -612.3135469017116, -958.9673762261114, -652.5860216702295, -1295.2495658456523, -128.0501794888376, -727.5622799198266, -670.7767038895904, -471.62232994315946, -769.5791442475571, -800.3800270585047, -869.7245396582218, -692.0587122403884, -1126.3200828448544, -1002.9932287900118, -961.7027704992648, -725.5784658247344, -716.5338737110058, -982.0501932741122, -316.12034141395014, -323.89987073216884, -289.20656682850324, -1107.54316803027, -725.1107091346017, -1115.6730813851764, -804.4091321078105, -609.2216966095093, -589.0767885580138, -1029.7810648801237, -712.7993830625314, -1009.9345905256351, -158.4605671435673, -551.9316659229288, -350.7772455146746, -268.88108080934313, -167.04031782984168, -687.388600430409, -733.1843238081298, -881.1269429853692, -1081.5734800206535, -868.0727899917756, -957.2466709842047, -827.4099697906141, -637.6315718569059, -1135.1691753174587, -423.1834166924422, -614.1438732587156, -29.815251106388185, -961.862077158678, -290.93647633327924, -948.232448823933, -76.65630391881902, -350.92557721008416, -275.1984182198723, -93.79151342552295, -490.6295928575801, -1130.5078505932308, -683.34082088399, -1176.0327504093991, -297.96980704501067, -770.3124351451457, -683.5393684148013, -736.6940099153052, -651.0636903093114, -986.0260443707595, -838.9481933097865, -1140.7440062249655, -580.2871504931308, -881.1763892586793]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27862456974363115, "mean_inference_ms": 0.8919431815882348, "mean_action_processing_ms": 0.1576445542094487, "mean_env_wait_ms": 1.5329314182015588, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005442142486572266, "StateBufferConnector_ms": 0.003894329071044922, "ViewRequirementAgentConnector_ms": 0.09740138053894043}, "num_episodes": 27, "episode_return_max": -18.91602236886937, "episode_return_min": -1295.2495658456523, "episode_return_mean": -690.3539064589476, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 257.6407813216601, "num_env_steps_trained_throughput_per_sec": 257.6407813216601, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 14680.829, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14680.76, "sample_time_ms": 2408.532, "learn_time_ms": 12254.706, "learn_throughput": 326.405, "synch_weights_time_ms": 16.668}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00007", "date": "2024-08-03_05-27-03", "timestamp": 1722643023, "time_this_iter_s": 15.534209251403809, "time_total_s": 132.19332313537598, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12e805e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 132.19332313537598, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 12.872727272727275, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.664247854302328, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.978434822460016, "policy_loss": -0.01921242010964003, "vf_loss": 7.992493464052677, "vf_explained_var": 0.6171589919055501, "kl": 0.02652032294655935, "entropy": 1.502540739128987, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -17.81735082505808, "episode_reward_min": -1313.6843257850899, "episode_reward_mean": -695.9597605136175, "episode_len_mean": 136.83, "episode_media": {}, "episodes_timesteps_total": 13683, "policy_reward_min": {"policy_0": -1313.6843257850899}, "policy_reward_max": {"policy_0": -17.81735082505808}, "policy_reward_mean": {"policy_0": -695.9597605136175}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-612.3135469017116, -958.9673762261114, -652.5860216702295, -1295.2495658456523, -128.0501794888376, -727.5622799198266, -670.7767038895904, -471.62232994315946, -769.5791442475571, -800.3800270585047, -869.7245396582218, -692.0587122403884, -1126.3200828448544, -1002.9932287900118, -961.7027704992648, -725.5784658247344, -716.5338737110058, -982.0501932741122, -316.12034141395014, -323.89987073216884, -289.20656682850324, -1107.54316803027, -725.1107091346017, -1115.6730813851764, -804.4091321078105, -609.2216966095093, -589.0767885580138, -1029.7810648801237, -712.7993830625314, -1009.9345905256351, -158.4605671435673, -551.9316659229288, -350.7772455146746, -268.88108080934313, -167.04031782984168, -687.388600430409, -733.1843238081298, -881.1269429853692, -1081.5734800206535, -868.0727899917756, -957.2466709842047, -827.4099697906141, -637.6315718569059, -1135.1691753174587, -423.1834166924422, -614.1438732587156, -29.815251106388185, -961.862077158678, -290.93647633327924, -948.232448823933, -76.65630391881902, -350.92557721008416, -275.1984182198723, -93.79151342552295, -490.6295928575801, -1130.5078505932308, -683.34082088399, -1176.0327504093991, -297.96980704501067, -770.3124351451457, -683.5393684148013, -736.6940099153052, -651.0636903093114, -986.0260443707595, -838.9481933097865, -1140.7440062249655, -580.2871504931308, -881.1763892586793, -835.8773541261429, -1313.6843257850899, -439.7459637365257, -1227.2955699853917, -237.11301887599316, -307.65573640148733, -72.38334206278716, -1006.6704926280133, -119.24303093103667, -1000.6569674920453, -497.6534601070053, -530.335691066906, -759.0814726647113, -17.81735082505808, -34.48768121359901, -335.5265573265497, -841.3723680263488, -180.13285314709677, -938.2260138340931, -1200.3274192865854, -965.7011975038972, -1065.8822025144368, -1223.2353288872048, -1211.2019697365233, -873.6883971867985, -607.8798823485178, -340.842424537181, -944.4534585273287, -756.8225289029355, -1264.54793862717, -335.48971706715196, -896.2070329133619], "episode_lengths": [150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 124, 97, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 49, 104, 150, 61, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 135, 79, 150, 91, 150, 150, 150, 150, 43, 62, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 114, 150], "policy_policy_0_reward": [-612.3135469017116, -958.9673762261114, -652.5860216702295, -1295.2495658456523, -128.0501794888376, -727.5622799198266, -670.7767038895904, -471.62232994315946, -769.5791442475571, -800.3800270585047, -869.7245396582218, -692.0587122403884, -1126.3200828448544, -1002.9932287900118, -961.7027704992648, -725.5784658247344, -716.5338737110058, -982.0501932741122, -316.12034141395014, -323.89987073216884, -289.20656682850324, -1107.54316803027, -725.1107091346017, -1115.6730813851764, -804.4091321078105, -609.2216966095093, -589.0767885580138, -1029.7810648801237, -712.7993830625314, -1009.9345905256351, -158.4605671435673, -551.9316659229288, -350.7772455146746, -268.88108080934313, -167.04031782984168, -687.388600430409, -733.1843238081298, -881.1269429853692, -1081.5734800206535, -868.0727899917756, -957.2466709842047, -827.4099697906141, -637.6315718569059, -1135.1691753174587, -423.1834166924422, -614.1438732587156, -29.815251106388185, -961.862077158678, -290.93647633327924, -948.232448823933, -76.65630391881902, -350.92557721008416, -275.1984182198723, -93.79151342552295, -490.6295928575801, -1130.5078505932308, -683.34082088399, -1176.0327504093991, -297.96980704501067, -770.3124351451457, -683.5393684148013, -736.6940099153052, -651.0636903093114, -986.0260443707595, -838.9481933097865, -1140.7440062249655, -580.2871504931308, -881.1763892586793, -835.8773541261429, -1313.6843257850899, -439.7459637365257, -1227.2955699853917, -237.11301887599316, -307.65573640148733, -72.38334206278716, -1006.6704926280133, -119.24303093103667, -1000.6569674920453, -497.6534601070053, -530.335691066906, -759.0814726647113, -17.81735082505808, -34.48768121359901, -335.5265573265497, -841.3723680263488, -180.13285314709677, -938.2260138340931, -1200.3274192865854, -965.7011975038972, -1065.8822025144368, -1223.2353288872048, -1211.2019697365233, -873.6883971867985, -607.8798823485178, -340.842424537181, -944.4534585273287, -756.8225289029355, -1264.54793862717, -335.48971706715196, -896.2070329133619]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2785773676411755, "mean_inference_ms": 0.8974076218967797, "mean_action_processing_ms": 0.15754801872969731, "mean_env_wait_ms": 1.5342489700001005, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00551295280456543, "StateBufferConnector_ms": 0.003914594650268555, "ViewRequirementAgentConnector_ms": 0.09787321090698242}, "num_episodes": 32, "episode_return_max": -17.81735082505808, "episode_return_min": -1313.6843257850899, "episode_return_mean": -695.9597605136175, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.22130221230566, "num_env_steps_trained_throughput_per_sec": 269.22130221230566, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 14698.514, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14698.445, "sample_time_ms": 2397.712, "learn_time_ms": 12283.263, "learn_throughput": 325.646, "synch_weights_time_ms": 16.615}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00007", "date": "2024-08-03_05-27-17", "timestamp": 1722643037, "time_this_iter_s": 14.865803003311157, "time_total_s": 147.05912613868713, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12e81120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 147.05912613868713, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 12.928571428571429, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 26.57511018117269, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.237451726694902, "policy_loss": -0.01882214316477378, "vf_loss": 7.249896325170994, "vf_explained_var": 0.7562094838048021, "kl": 0.02170439391175023, "entropy": 1.3377723578363656, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -17.81735082505808, "episode_reward_min": -1313.6843257850899, "episode_reward_mean": -682.7198435235076, "episode_len_mean": 137.14, "episode_media": {}, "episodes_timesteps_total": 13714, "policy_reward_min": {"policy_0": -1313.6843257850899}, "policy_reward_max": {"policy_0": -17.81735082505808}, "policy_reward_mean": {"policy_0": -682.7198435235076}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-589.0767885580138, -1029.7810648801237, -712.7993830625314, -1009.9345905256351, -158.4605671435673, -551.9316659229288, -350.7772455146746, -268.88108080934313, -167.04031782984168, -687.388600430409, -733.1843238081298, -881.1269429853692, -1081.5734800206535, -868.0727899917756, -957.2466709842047, -827.4099697906141, -637.6315718569059, -1135.1691753174587, -423.1834166924422, -614.1438732587156, -29.815251106388185, -961.862077158678, -290.93647633327924, -948.232448823933, -76.65630391881902, -350.92557721008416, -275.1984182198723, -93.79151342552295, -490.6295928575801, -1130.5078505932308, -683.34082088399, -1176.0327504093991, -297.96980704501067, -770.3124351451457, -683.5393684148013, -736.6940099153052, -651.0636903093114, -986.0260443707595, -838.9481933097865, -1140.7440062249655, -580.2871504931308, -881.1763892586793, -835.8773541261429, -1313.6843257850899, -439.7459637365257, -1227.2955699853917, -237.11301887599316, -307.65573640148733, -72.38334206278716, -1006.6704926280133, -119.24303093103667, -1000.6569674920453, -497.6534601070053, -530.335691066906, -759.0814726647113, -17.81735082505808, -34.48768121359901, -335.5265573265497, -841.3723680263488, -180.13285314709677, -938.2260138340931, -1200.3274192865854, -965.7011975038972, -1065.8822025144368, -1223.2353288872048, -1211.2019697365233, -873.6883971867985, -607.8798823485178, -340.842424537181, -944.4534585273287, -756.8225289029355, -1264.54793862717, -335.48971706715196, -896.2070329133619, -431.27030935438813, -621.480287522246, -198.52487979357673, -247.76594126526894, -1008.1733749499159, -369.8061233213974, -837.1562973254937, -1112.0679492933903, -696.273836649839, -619.1895911107263, -1095.5422153108927, -870.5630192950699, -776.7895172858916, -1145.6194290316243, -373.08403561167245, -1153.6765220915377, -601.3081577389083, -631.0018697828758, -1192.7429369030306, -118.56531324068578, -316.3429971802117, -704.5429039442881, -1243.2939565408783, -618.9102542436182, -258.12883330188646, -889.4213571754597], "episode_lengths": [150, 150, 150, 150, 61, 150, 124, 97, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 49, 104, 150, 61, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 135, 79, 150, 91, 150, 150, 150, 150, 43, 62, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 114, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 138, 148, 150, 150, 123, 150], "policy_policy_0_reward": [-589.0767885580138, -1029.7810648801237, -712.7993830625314, -1009.9345905256351, -158.4605671435673, -551.9316659229288, -350.7772455146746, -268.88108080934313, -167.04031782984168, -687.388600430409, -733.1843238081298, -881.1269429853692, -1081.5734800206535, -868.0727899917756, -957.2466709842047, -827.4099697906141, -637.6315718569059, -1135.1691753174587, -423.1834166924422, -614.1438732587156, -29.815251106388185, -961.862077158678, -290.93647633327924, -948.232448823933, -76.65630391881902, -350.92557721008416, -275.1984182198723, -93.79151342552295, -490.6295928575801, -1130.5078505932308, -683.34082088399, -1176.0327504093991, -297.96980704501067, -770.3124351451457, -683.5393684148013, -736.6940099153052, -651.0636903093114, -986.0260443707595, -838.9481933097865, -1140.7440062249655, -580.2871504931308, -881.1763892586793, -835.8773541261429, -1313.6843257850899, -439.7459637365257, -1227.2955699853917, -237.11301887599316, -307.65573640148733, -72.38334206278716, -1006.6704926280133, -119.24303093103667, -1000.6569674920453, -497.6534601070053, -530.335691066906, -759.0814726647113, -17.81735082505808, -34.48768121359901, -335.5265573265497, -841.3723680263488, -180.13285314709677, -938.2260138340931, -1200.3274192865854, -965.7011975038972, -1065.8822025144368, -1223.2353288872048, -1211.2019697365233, -873.6883971867985, -607.8798823485178, -340.842424537181, -944.4534585273287, -756.8225289029355, -1264.54793862717, -335.48971706715196, -896.2070329133619, -431.27030935438813, -621.480287522246, -198.52487979357673, -247.76594126526894, -1008.1733749499159, -369.8061233213974, -837.1562973254937, -1112.0679492933903, -696.273836649839, -619.1895911107263, -1095.5422153108927, -870.5630192950699, -776.7895172858916, -1145.6194290316243, -373.08403561167245, -1153.6765220915377, -601.3081577389083, -631.0018697828758, -1192.7429369030306, -118.56531324068578, -316.3429971802117, -704.5429039442881, -1243.2939565408783, -618.9102542436182, -258.12883330188646, -889.4213571754597]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2785888849197644, "mean_inference_ms": 0.8980050676265051, "mean_action_processing_ms": 0.15752479647963788, "mean_env_wait_ms": 1.5342446052982874, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054934024810791016, "StateBufferConnector_ms": 0.0038862228393554688, "ViewRequirementAgentConnector_ms": 0.0972747802734375}, "num_episodes": 26, "episode_return_max": -17.81735082505808, "episode_return_min": -1313.6843257850899, "episode_return_mean": -682.7198435235076, "episodes_this_iter": 26}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.3952201404772, "num_env_steps_trained_throughput_per_sec": 267.3952201404772, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 14705.55, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14705.479, "sample_time_ms": 2393.159, "learn_time_ms": 12295.022, "learn_throughput": 325.335, "synch_weights_time_ms": 16.44}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00007", "date": "2024-08-03_05-27-32", "timestamp": 1722643052, "time_this_iter_s": 14.966568946838379, "time_total_s": 162.0256950855255, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12e82dd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 162.0256950855255, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 12.99047619047619, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.836088720460733, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.742675492664178, "policy_loss": -0.01723872882624467, "vf_loss": 7.752156766752402, "vf_explained_var": 0.6879634307076533, "kl": 0.01760098117138115, "entropy": 1.630048426364859, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -17.81735082505808, "episode_reward_min": -1313.6843257850899, "episode_reward_mean": -733.723310037367, "episode_len_mean": 140.3, "episode_media": {}, "episodes_timesteps_total": 14030, "policy_reward_min": {"policy_0": -1313.6843257850899}, "policy_reward_max": {"policy_0": -17.81735082505808}, "policy_reward_mean": {"policy_0": -733.723310037367}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-93.79151342552295, -490.6295928575801, -1130.5078505932308, -683.34082088399, -1176.0327504093991, -297.96980704501067, -770.3124351451457, -683.5393684148013, -736.6940099153052, -651.0636903093114, -986.0260443707595, -838.9481933097865, -1140.7440062249655, -580.2871504931308, -881.1763892586793, -835.8773541261429, -1313.6843257850899, -439.7459637365257, -1227.2955699853917, -237.11301887599316, -307.65573640148733, -72.38334206278716, -1006.6704926280133, -119.24303093103667, -1000.6569674920453, -497.6534601070053, -530.335691066906, -759.0814726647113, -17.81735082505808, -34.48768121359901, -335.5265573265497, -841.3723680263488, -180.13285314709677, -938.2260138340931, -1200.3274192865854, -965.7011975038972, -1065.8822025144368, -1223.2353288872048, -1211.2019697365233, -873.6883971867985, -607.8798823485178, -340.842424537181, -944.4534585273287, -756.8225289029355, -1264.54793862717, -335.48971706715196, -896.2070329133619, -431.27030935438813, -621.480287522246, -198.52487979357673, -247.76594126526894, -1008.1733749499159, -369.8061233213974, -837.1562973254937, -1112.0679492933903, -696.273836649839, -619.1895911107263, -1095.5422153108927, -870.5630192950699, -776.7895172858916, -1145.6194290316243, -373.08403561167245, -1153.6765220915377, -601.3081577389083, -631.0018697828758, -1192.7429369030306, -118.56531324068578, -316.3429971802117, -704.5429039442881, -1243.2939565408783, -618.9102542436182, -258.12883330188646, -889.4213571754597, -974.6784825962745, -970.4482972816382, -1007.1935972593762, -1012.7011840273707, -1274.9677233185178, -939.1462566495421, -467.4984861549238, -1017.3890312781904, -532.22916515123, -1044.718809319401, -470.36885698667294, -200.547974807958, -1181.8674753420441, -552.148197042233, -1120.982395004289, -695.6510552440072, -1046.9835135884696, -589.4662788224406, -468.98127459918794, -1219.6810606646775, -980.8319148351485, -585.5671943978041, -74.59095173842351, -747.9044071503113, -828.5355401790465, -725.4737942783472, -988.2338058228045], "episode_lengths": [61, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 135, 79, 150, 91, 150, 150, 150, 150, 43, 62, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 114, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 138, 148, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150], "policy_policy_0_reward": [-93.79151342552295, -490.6295928575801, -1130.5078505932308, -683.34082088399, -1176.0327504093991, -297.96980704501067, -770.3124351451457, -683.5393684148013, -736.6940099153052, -651.0636903093114, -986.0260443707595, -838.9481933097865, -1140.7440062249655, -580.2871504931308, -881.1763892586793, -835.8773541261429, -1313.6843257850899, -439.7459637365257, -1227.2955699853917, -237.11301887599316, -307.65573640148733, -72.38334206278716, -1006.6704926280133, -119.24303093103667, -1000.6569674920453, -497.6534601070053, -530.335691066906, -759.0814726647113, -17.81735082505808, -34.48768121359901, -335.5265573265497, -841.3723680263488, -180.13285314709677, -938.2260138340931, -1200.3274192865854, -965.7011975038972, -1065.8822025144368, -1223.2353288872048, -1211.2019697365233, -873.6883971867985, -607.8798823485178, -340.842424537181, -944.4534585273287, -756.8225289029355, -1264.54793862717, -335.48971706715196, -896.2070329133619, -431.27030935438813, -621.480287522246, -198.52487979357673, -247.76594126526894, -1008.1733749499159, -369.8061233213974, -837.1562973254937, -1112.0679492933903, -696.273836649839, -619.1895911107263, -1095.5422153108927, -870.5630192950699, -776.7895172858916, -1145.6194290316243, -373.08403561167245, -1153.6765220915377, -601.3081577389083, -631.0018697828758, -1192.7429369030306, -118.56531324068578, -316.3429971802117, -704.5429039442881, -1243.2939565408783, -618.9102542436182, -258.12883330188646, -889.4213571754597, -974.6784825962745, -970.4482972816382, -1007.1935972593762, -1012.7011840273707, -1274.9677233185178, -939.1462566495421, -467.4984861549238, -1017.3890312781904, -532.22916515123, -1044.718809319401, -470.36885698667294, -200.547974807958, -1181.8674753420441, -552.148197042233, -1120.982395004289, -695.6510552440072, -1046.9835135884696, -589.4662788224406, -468.98127459918794, -1219.6810606646775, -980.8319148351485, -585.5671943978041, -74.59095173842351, -747.9044071503113, -828.5355401790465, -725.4737942783472, -988.2338058228045]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2784021201541537, "mean_inference_ms": 0.8953013630432137, "mean_action_processing_ms": 0.15739701099281744, "mean_env_wait_ms": 1.534934026352741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005547761917114258, "StateBufferConnector_ms": 0.003966331481933594, "ViewRequirementAgentConnector_ms": 0.09882783889770508}, "num_episodes": 27, "episode_return_max": -17.81735082505808, "episode_return_min": -1313.6843257850899, "episode_return_mean": -733.723310037367, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.7731736806284, "num_env_steps_trained_throughput_per_sec": 267.7731736806284, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 14699.265, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14699.192, "sample_time_ms": 2401.139, "learn_time_ms": 12280.888, "learn_throughput": 325.709, "synch_weights_time_ms": 16.314}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00007", "date": "2024-08-03_05-27-47", "timestamp": 1722643067, "time_this_iter_s": 14.947542428970337, "time_total_s": 176.97323751449585, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fd8af0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 176.97323751449585, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 12.913636363636362, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.47822532057762, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.1400215114156405, "policy_loss": -0.01842067406541901, "vf_loss": 7.151071434716384, "vf_explained_var": 0.7853595301508903, "kl": 0.016721357136369384, "entropy": 1.5384173907339573, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -18.816439452021978, "episode_reward_min": -1306.3244026373911, "episode_reward_mean": -753.7836342024856, "episode_len_mean": 139.76, "episode_media": {}, "episodes_timesteps_total": 13976, "policy_reward_min": {"policy_0": -1306.3244026373911}, "policy_reward_max": {"policy_0": -18.816439452021978}, "policy_reward_mean": {"policy_0": -753.7836342024856}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-841.3723680263488, -180.13285314709677, -938.2260138340931, -1200.3274192865854, -965.7011975038972, -1065.8822025144368, -1223.2353288872048, -1211.2019697365233, -873.6883971867985, -607.8798823485178, -340.842424537181, -944.4534585273287, -756.8225289029355, -1264.54793862717, -335.48971706715196, -896.2070329133619, -431.27030935438813, -621.480287522246, -198.52487979357673, -247.76594126526894, -1008.1733749499159, -369.8061233213974, -837.1562973254937, -1112.0679492933903, -696.273836649839, -619.1895911107263, -1095.5422153108927, -870.5630192950699, -776.7895172858916, -1145.6194290316243, -373.08403561167245, -1153.6765220915377, -601.3081577389083, -631.0018697828758, -1192.7429369030306, -118.56531324068578, -316.3429971802117, -704.5429039442881, -1243.2939565408783, -618.9102542436182, -258.12883330188646, -889.4213571754597, -974.6784825962745, -970.4482972816382, -1007.1935972593762, -1012.7011840273707, -1274.9677233185178, -939.1462566495421, -467.4984861549238, -1017.3890312781904, -532.22916515123, -1044.718809319401, -470.36885698667294, -200.547974807958, -1181.8674753420441, -552.148197042233, -1120.982395004289, -695.6510552440072, -1046.9835135884696, -589.4662788224406, -468.98127459918794, -1219.6810606646775, -980.8319148351485, -585.5671943978041, -74.59095173842351, -747.9044071503113, -828.5355401790465, -725.4737942783472, -988.2338058228045, -857.0540712920367, -346.41014217867473, -137.6027464411487, -562.4412708343914, -380.78501048839445, -1039.031305762375, -1206.5367069092072, -1219.8396921803198, -942.4899470503182, -18.816439452021978, -851.685731011632, -118.91155122948543, -686.5942372397417, -700.375628457674, -118.38779928453262, -1022.5170390807446, -1005.5989921915278, -860.462147221294, -775.8962948869711, -869.2599813894261, -37.937189090875954, -720.5114455681767, -1169.796190659204, -928.797042542294, -1060.3609108344788, -1306.3244026373911, -1131.8448072702818, -479.84519348022826, -252.90207429249077, -1000.6369610279436, -72.67110241152159], "episode_lengths": [150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 114, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 138, 148, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 124, 88, 150, 102, 150, 150, 150, 150, 51, 150, 90, 150, 150, 55, 150, 150, 150, 150, 150, 39, 150, 150, 150, 150, 150, 150, 150, 128, 150, 78], "policy_policy_0_reward": [-841.3723680263488, -180.13285314709677, -938.2260138340931, -1200.3274192865854, -965.7011975038972, -1065.8822025144368, -1223.2353288872048, -1211.2019697365233, -873.6883971867985, -607.8798823485178, -340.842424537181, -944.4534585273287, -756.8225289029355, -1264.54793862717, -335.48971706715196, -896.2070329133619, -431.27030935438813, -621.480287522246, -198.52487979357673, -247.76594126526894, -1008.1733749499159, -369.8061233213974, -837.1562973254937, -1112.0679492933903, -696.273836649839, -619.1895911107263, -1095.5422153108927, -870.5630192950699, -776.7895172858916, -1145.6194290316243, -373.08403561167245, -1153.6765220915377, -601.3081577389083, -631.0018697828758, -1192.7429369030306, -118.56531324068578, -316.3429971802117, -704.5429039442881, -1243.2939565408783, -618.9102542436182, -258.12883330188646, -889.4213571754597, -974.6784825962745, -970.4482972816382, -1007.1935972593762, -1012.7011840273707, -1274.9677233185178, -939.1462566495421, -467.4984861549238, -1017.3890312781904, -532.22916515123, -1044.718809319401, -470.36885698667294, -200.547974807958, -1181.8674753420441, -552.148197042233, -1120.982395004289, -695.6510552440072, -1046.9835135884696, -589.4662788224406, -468.98127459918794, -1219.6810606646775, -980.8319148351485, -585.5671943978041, -74.59095173842351, -747.9044071503113, -828.5355401790465, -725.4737942783472, -988.2338058228045, -857.0540712920367, -346.41014217867473, -137.6027464411487, -562.4412708343914, -380.78501048839445, -1039.031305762375, -1206.5367069092072, -1219.8396921803198, -942.4899470503182, -18.816439452021978, -851.685731011632, -118.91155122948543, -686.5942372397417, -700.375628457674, -118.38779928453262, -1022.5170390807446, -1005.5989921915278, -860.462147221294, -775.8962948869711, -869.2599813894261, -37.937189090875954, -720.5114455681767, -1169.796190659204, -928.797042542294, -1060.3609108344788, -1306.3244026373911, -1131.8448072702818, -479.84519348022826, -252.90207429249077, -1000.6369610279436, -72.67110241152159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27850858410247686, "mean_inference_ms": 0.8936943288603209, "mean_action_processing_ms": 0.15748851430291244, "mean_env_wait_ms": 1.5388601528531773, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005466938018798828, "StateBufferConnector_ms": 0.003999233245849609, "ViewRequirementAgentConnector_ms": 0.10014748573303223}, "num_episodes": 31, "episode_return_max": -18.816439452021978, "episode_return_min": -1306.3244026373911, "episode_return_mean": -753.7836342024856, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.65341697941824, "num_env_steps_trained_throughput_per_sec": 276.65341697941824, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 14635.425, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14635.349, "sample_time_ms": 2401.717, "learn_time_ms": 12216.622, "learn_throughput": 327.423, "synch_weights_time_ms": 16.151}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00007", "date": "2024-08-03_05-28-02", "timestamp": 1722643082, "time_this_iter_s": 14.466127872467041, "time_total_s": 191.4393653869629, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fd8c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 191.4393653869629, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.220000000000002, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.741007652878764, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.528183452785015, "policy_loss": -0.007682552716384332, "vf_loss": 6.529700773954391, "vf_explained_var": 0.7999995088204741, "kl": 0.014001457447132774, "entropy": 1.35432440067331, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -18.816439452021978, "episode_reward_min": -1472.3768990146548, "episode_reward_mean": -715.7391437870693, "episode_len_mean": 136.88, "episode_media": {}, "episodes_timesteps_total": 13688, "policy_reward_min": {"policy_0": -1472.3768990146548}, "policy_reward_max": {"policy_0": -18.816439452021978}, "policy_reward_mean": {"policy_0": -715.7391437870693}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-373.08403561167245, -1153.6765220915377, -601.3081577389083, -631.0018697828758, -1192.7429369030306, -118.56531324068578, -316.3429971802117, -704.5429039442881, -1243.2939565408783, -618.9102542436182, -258.12883330188646, -889.4213571754597, -974.6784825962745, -970.4482972816382, -1007.1935972593762, -1012.7011840273707, -1274.9677233185178, -939.1462566495421, -467.4984861549238, -1017.3890312781904, -532.22916515123, -1044.718809319401, -470.36885698667294, -200.547974807958, -1181.8674753420441, -552.148197042233, -1120.982395004289, -695.6510552440072, -1046.9835135884696, -589.4662788224406, -468.98127459918794, -1219.6810606646775, -980.8319148351485, -585.5671943978041, -74.59095173842351, -747.9044071503113, -828.5355401790465, -725.4737942783472, -988.2338058228045, -857.0540712920367, -346.41014217867473, -137.6027464411487, -562.4412708343914, -380.78501048839445, -1039.031305762375, -1206.5367069092072, -1219.8396921803198, -942.4899470503182, -18.816439452021978, -851.685731011632, -118.91155122948543, -686.5942372397417, -700.375628457674, -118.38779928453262, -1022.5170390807446, -1005.5989921915278, -860.462147221294, -775.8962948869711, -869.2599813894261, -37.937189090875954, -720.5114455681767, -1169.796190659204, -928.797042542294, -1060.3609108344788, -1306.3244026373911, -1131.8448072702818, -479.84519348022826, -252.90207429249077, -1000.6369610279436, -72.67110241152159, -1472.3768990146548, -898.5963826019245, -1275.1611192508783, -1082.797968464002, -412.43694161135477, -1071.4425126082472, -344.328397754999, -726.9430160140522, -870.8631749800369, -858.1645270938496, -1104.495408650647, -1170.791268238953, -690.9565295639322, -1205.0079282681538, -21.13326526023027, -705.9591694224154, -916.9983597580866, -310.1937941578714, -173.53795199227153, -626.3562304195588, -69.32094398640432, -350.4921917845105, -357.5614781809531, -409.6685211488008, -449.8490304544603, -756.6073707737045, -74.99341484458724, -571.9226416323014, -699.3900649283411, -193.43796015454714], "episode_lengths": [150, 150, 150, 150, 150, 80, 138, 148, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 124, 88, 150, 102, 150, 150, 150, 150, 51, 150, 90, 150, 150, 55, 150, 150, 150, 150, 150, 39, 150, 150, 150, 150, 150, 150, 150, 128, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 90, 88, 150, 67, 136, 147, 150, 150, 150, 64, 150, 150, 91], "policy_policy_0_reward": [-373.08403561167245, -1153.6765220915377, -601.3081577389083, -631.0018697828758, -1192.7429369030306, -118.56531324068578, -316.3429971802117, -704.5429039442881, -1243.2939565408783, -618.9102542436182, -258.12883330188646, -889.4213571754597, -974.6784825962745, -970.4482972816382, -1007.1935972593762, -1012.7011840273707, -1274.9677233185178, -939.1462566495421, -467.4984861549238, -1017.3890312781904, -532.22916515123, -1044.718809319401, -470.36885698667294, -200.547974807958, -1181.8674753420441, -552.148197042233, -1120.982395004289, -695.6510552440072, -1046.9835135884696, -589.4662788224406, -468.98127459918794, -1219.6810606646775, -980.8319148351485, -585.5671943978041, -74.59095173842351, -747.9044071503113, -828.5355401790465, -725.4737942783472, -988.2338058228045, -857.0540712920367, -346.41014217867473, -137.6027464411487, -562.4412708343914, -380.78501048839445, -1039.031305762375, -1206.5367069092072, -1219.8396921803198, -942.4899470503182, -18.816439452021978, -851.685731011632, -118.91155122948543, -686.5942372397417, -700.375628457674, -118.38779928453262, -1022.5170390807446, -1005.5989921915278, -860.462147221294, -775.8962948869711, -869.2599813894261, -37.937189090875954, -720.5114455681767, -1169.796190659204, -928.797042542294, -1060.3609108344788, -1306.3244026373911, -1131.8448072702818, -479.84519348022826, -252.90207429249077, -1000.6369610279436, -72.67110241152159, -1472.3768990146548, -898.5963826019245, -1275.1611192508783, -1082.797968464002, -412.43694161135477, -1071.4425126082472, -344.328397754999, -726.9430160140522, -870.8631749800369, -858.1645270938496, -1104.495408650647, -1170.791268238953, -690.9565295639322, -1205.0079282681538, -21.13326526023027, -705.9591694224154, -916.9983597580866, -310.1937941578714, -173.53795199227153, -626.3562304195588, -69.32094398640432, -350.4921917845105, -357.5614781809531, -409.6685211488008, -449.8490304544603, -756.6073707737045, -74.99341484458724, -571.9226416323014, -699.3900649283411, -193.43796015454714]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27871787396998143, "mean_inference_ms": 0.8922695438719923, "mean_action_processing_ms": 0.15749532086813736, "mean_env_wait_ms": 1.5419530223263935, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005614519119262695, "StateBufferConnector_ms": 0.004070281982421875, "ViewRequirementAgentConnector_ms": 0.1016998291015625}, "num_episodes": 30, "episode_return_max": -18.816439452021978, "episode_return_min": -1472.3768990146548, "episode_return_mean": -715.7391437870693, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.2902335634308, "num_env_steps_trained_throughput_per_sec": 282.2902335634308, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 14594.213, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14594.14, "sample_time_ms": 2416.0, "learn_time_ms": 12161.362, "learn_throughput": 328.911, "synch_weights_time_ms": 15.928}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00007", "date": "2024-08-03_05-28-16", "timestamp": 1722643096, "time_this_iter_s": 14.177129030227661, "time_total_s": 205.61649441719055, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fda3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 205.61649441719055, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 12.99047619047619, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 61.28798433939616, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.6696107884248095, "policy_loss": -0.012097292943023301, "vf_loss": 6.675609594086806, "vf_explained_var": 0.8156000344082713, "kl": 0.013860202889615435, "entropy": 1.386261958008011, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -18.816439452021978, "episode_reward_min": -1472.3768990146548, "episode_reward_mean": -703.8705279202098, "episode_len_mean": 136.22, "episode_media": {}, "episodes_timesteps_total": 13622, "policy_reward_min": {"policy_0": -1472.3768990146548}, "policy_reward_max": {"policy_0": -18.816439452021978}, "policy_reward_mean": {"policy_0": -703.8705279202098}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-589.4662788224406, -468.98127459918794, -1219.6810606646775, -980.8319148351485, -585.5671943978041, -74.59095173842351, -747.9044071503113, -828.5355401790465, -725.4737942783472, -988.2338058228045, -857.0540712920367, -346.41014217867473, -137.6027464411487, -562.4412708343914, -380.78501048839445, -1039.031305762375, -1206.5367069092072, -1219.8396921803198, -942.4899470503182, -18.816439452021978, -851.685731011632, -118.91155122948543, -686.5942372397417, -700.375628457674, -118.38779928453262, -1022.5170390807446, -1005.5989921915278, -860.462147221294, -775.8962948869711, -869.2599813894261, -37.937189090875954, -720.5114455681767, -1169.796190659204, -928.797042542294, -1060.3609108344788, -1306.3244026373911, -1131.8448072702818, -479.84519348022826, -252.90207429249077, -1000.6369610279436, -72.67110241152159, -1472.3768990146548, -898.5963826019245, -1275.1611192508783, -1082.797968464002, -412.43694161135477, -1071.4425126082472, -344.328397754999, -726.9430160140522, -870.8631749800369, -858.1645270938496, -1104.495408650647, -1170.791268238953, -690.9565295639322, -1205.0079282681538, -21.13326526023027, -705.9591694224154, -916.9983597580866, -310.1937941578714, -173.53795199227153, -626.3562304195588, -69.32094398640432, -350.4921917845105, -357.5614781809531, -409.6685211488008, -449.8490304544603, -756.6073707737045, -74.99341484458724, -571.9226416323014, -699.3900649283411, -193.43796015454714, -642.6440153943231, -844.7292819210755, -1128.666015099312, -1216.9107029954123, -1040.0094709409004, -804.6059587218878, -361.88615911235536, -639.1128449464773, -708.1772271349485, -562.8203109237019, -1325.728925068094, -1408.347942694699, -1178.2403976666928, -466.96596031647374, -385.1627174399189, -222.4408757957035, -1002.9315660758683, -543.8132007186033, -565.1789857625827, -1133.6946336758663, -840.5360762810878, -1213.119561822101, -354.0788861827703, -456.0954965320351, -134.8956248293523, -243.12552305804715, -336.5287927063911, -776.4817903131395, -886.7491079914493], "episode_lengths": [150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 124, 88, 150, 102, 150, 150, 150, 150, 51, 150, 90, 150, 150, 55, 150, 150, 150, 150, 150, 39, 150, 150, 150, 150, 150, 150, 150, 128, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 90, 88, 150, 67, 136, 147, 150, 150, 150, 64, 150, 150, 91, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 110, 110, 150, 150, 150, 150, 150, 150, 150, 150, 79, 98, 150, 150, 150], "policy_policy_0_reward": [-589.4662788224406, -468.98127459918794, -1219.6810606646775, -980.8319148351485, -585.5671943978041, -74.59095173842351, -747.9044071503113, -828.5355401790465, -725.4737942783472, -988.2338058228045, -857.0540712920367, -346.41014217867473, -137.6027464411487, -562.4412708343914, -380.78501048839445, -1039.031305762375, -1206.5367069092072, -1219.8396921803198, -942.4899470503182, -18.816439452021978, -851.685731011632, -118.91155122948543, -686.5942372397417, -700.375628457674, -118.38779928453262, -1022.5170390807446, -1005.5989921915278, -860.462147221294, -775.8962948869711, -869.2599813894261, -37.937189090875954, -720.5114455681767, -1169.796190659204, -928.797042542294, -1060.3609108344788, -1306.3244026373911, -1131.8448072702818, -479.84519348022826, -252.90207429249077, -1000.6369610279436, -72.67110241152159, -1472.3768990146548, -898.5963826019245, -1275.1611192508783, -1082.797968464002, -412.43694161135477, -1071.4425126082472, -344.328397754999, -726.9430160140522, -870.8631749800369, -858.1645270938496, -1104.495408650647, -1170.791268238953, -690.9565295639322, -1205.0079282681538, -21.13326526023027, -705.9591694224154, -916.9983597580866, -310.1937941578714, -173.53795199227153, -626.3562304195588, -69.32094398640432, -350.4921917845105, -357.5614781809531, -409.6685211488008, -449.8490304544603, -756.6073707737045, -74.99341484458724, -571.9226416323014, -699.3900649283411, -193.43796015454714, -642.6440153943231, -844.7292819210755, -1128.666015099312, -1216.9107029954123, -1040.0094709409004, -804.6059587218878, -361.88615911235536, -639.1128449464773, -708.1772271349485, -562.8203109237019, -1325.728925068094, -1408.347942694699, -1178.2403976666928, -466.96596031647374, -385.1627174399189, -222.4408757957035, -1002.9315660758683, -543.8132007186033, -565.1789857625827, -1133.6946336758663, -840.5360762810878, -1213.119561822101, -354.0788861827703, -456.0954965320351, -134.8956248293523, -243.12552305804715, -336.5287927063911, -776.4817903131395, -886.7491079914493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2788699809039395, "mean_inference_ms": 0.8912936117417181, "mean_action_processing_ms": 0.15758106095958282, "mean_env_wait_ms": 1.5450292248550135, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056416988372802734, "StateBufferConnector_ms": 0.004046440124511719, "ViewRequirementAgentConnector_ms": 0.10114526748657227}, "num_episodes": 29, "episode_return_max": -18.816439452021978, "episode_return_min": -1472.3768990146548, "episode_return_mean": -703.8705279202098, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.9230870050559, "num_env_steps_trained_throughput_per_sec": 265.9230870050559, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 14985.653, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14985.579, "sample_time_ms": 2436.731, "learn_time_ms": 12532.268, "learn_throughput": 319.176, "synch_weights_time_ms": 15.729}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00007", "date": "2024-08-03_05-28-31", "timestamp": 1722643111, "time_this_iter_s": 15.049652814865112, "time_total_s": 220.66614723205566, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12e80a60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 220.66614723205566, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 12.88571428571429, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65.93247755467891, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.964238176246484, "policy_loss": -0.013812135556751553, "vf_loss": 5.970994681616625, "vf_explained_var": 0.877560117530326, "kl": 0.01595821189215106, "entropy": 1.2556721345831952, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -21.13326526023027, "episode_reward_min": -1472.3768990146548, "episode_reward_mean": -695.5660289570534, "episode_len_mean": 136.22, "episode_media": {}, "episodes_timesteps_total": 13622, "policy_reward_min": {"policy_0": -1472.3768990146548}, "policy_reward_max": {"policy_0": -21.13326526023027}, "policy_reward_mean": {"policy_0": -695.5660289570534}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-37.937189090875954, -720.5114455681767, -1169.796190659204, -928.797042542294, -1060.3609108344788, -1306.3244026373911, -1131.8448072702818, -479.84519348022826, -252.90207429249077, -1000.6369610279436, -72.67110241152159, -1472.3768990146548, -898.5963826019245, -1275.1611192508783, -1082.797968464002, -412.43694161135477, -1071.4425126082472, -344.328397754999, -726.9430160140522, -870.8631749800369, -858.1645270938496, -1104.495408650647, -1170.791268238953, -690.9565295639322, -1205.0079282681538, -21.13326526023027, -705.9591694224154, -916.9983597580866, -310.1937941578714, -173.53795199227153, -626.3562304195588, -69.32094398640432, -350.4921917845105, -357.5614781809531, -409.6685211488008, -449.8490304544603, -756.6073707737045, -74.99341484458724, -571.9226416323014, -699.3900649283411, -193.43796015454714, -642.6440153943231, -844.7292819210755, -1128.666015099312, -1216.9107029954123, -1040.0094709409004, -804.6059587218878, -361.88615911235536, -639.1128449464773, -708.1772271349485, -562.8203109237019, -1325.728925068094, -1408.347942694699, -1178.2403976666928, -466.96596031647374, -385.1627174399189, -222.4408757957035, -1002.9315660758683, -543.8132007186033, -565.1789857625827, -1133.6946336758663, -840.5360762810878, -1213.119561822101, -354.0788861827703, -456.0954965320351, -134.8956248293523, -243.12552305804715, -336.5287927063911, -776.4817903131395, -886.7491079914493, -490.06901976572937, -936.2452075579001, -286.6564956835343, -217.5915261226918, -1144.7860636360335, -892.3932087679618, -69.25912637912283, -1129.7537450777215, -719.9448962829235, -746.9318612250298, -69.64865771693664, -900.4693206572584, -843.4583567378003, -98.96655386656424, -253.3117186767603, -774.6378833830936, -995.9236109137564, -137.36939433670395, -846.3620486948041, -762.1054862070887, -559.5279166364675, -956.4508636486141, -665.7425385754053, -1051.0208475666961, -1011.6069945354354, -841.6647287525034, -841.1420579308434, -632.5672036678363, -730.0353159079897, -493.8704118432317], "episode_lengths": [39, 150, 150, 150, 150, 150, 150, 150, 128, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 90, 88, 150, 67, 136, 147, 150, 150, 150, 64, 150, 150, 91, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 110, 110, 150, 150, 150, 150, 150, 150, 150, 150, 79, 98, 150, 150, 150, 150, 150, 150, 111, 150, 150, 57, 150, 150, 150, 68, 150, 150, 56, 83, 150, 150, 76, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-37.937189090875954, -720.5114455681767, -1169.796190659204, -928.797042542294, -1060.3609108344788, -1306.3244026373911, -1131.8448072702818, -479.84519348022826, -252.90207429249077, -1000.6369610279436, -72.67110241152159, -1472.3768990146548, -898.5963826019245, -1275.1611192508783, -1082.797968464002, -412.43694161135477, -1071.4425126082472, -344.328397754999, -726.9430160140522, -870.8631749800369, -858.1645270938496, -1104.495408650647, -1170.791268238953, -690.9565295639322, -1205.0079282681538, -21.13326526023027, -705.9591694224154, -916.9983597580866, -310.1937941578714, -173.53795199227153, -626.3562304195588, -69.32094398640432, -350.4921917845105, -357.5614781809531, -409.6685211488008, -449.8490304544603, -756.6073707737045, -74.99341484458724, -571.9226416323014, -699.3900649283411, -193.43796015454714, -642.6440153943231, -844.7292819210755, -1128.666015099312, -1216.9107029954123, -1040.0094709409004, -804.6059587218878, -361.88615911235536, -639.1128449464773, -708.1772271349485, -562.8203109237019, -1325.728925068094, -1408.347942694699, -1178.2403976666928, -466.96596031647374, -385.1627174399189, -222.4408757957035, -1002.9315660758683, -543.8132007186033, -565.1789857625827, -1133.6946336758663, -840.5360762810878, -1213.119561822101, -354.0788861827703, -456.0954965320351, -134.8956248293523, -243.12552305804715, -336.5287927063911, -776.4817903131395, -886.7491079914493, -490.06901976572937, -936.2452075579001, -286.6564956835343, -217.5915261226918, -1144.7860636360335, -892.3932087679618, -69.25912637912283, -1129.7537450777215, -719.9448962829235, -746.9318612250298, -69.64865771693664, -900.4693206572584, -843.4583567378003, -98.96655386656424, -253.3117186767603, -774.6378833830936, -995.9236109137564, -137.36939433670395, -846.3620486948041, -762.1054862070887, -559.5279166364675, -956.4508636486141, -665.7425385754053, -1051.0208475666961, -1011.6069945354354, -841.6647287525034, -841.1420579308434, -632.5672036678363, -730.0353159079897, -493.8704118432317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2791234701044446, "mean_inference_ms": 0.8902376100085381, "mean_action_processing_ms": 0.15754008670180894, "mean_env_wait_ms": 1.5471700628925598, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005583763122558594, "StateBufferConnector_ms": 0.004011631011962891, "ViewRequirementAgentConnector_ms": 0.10050654411315918}, "num_episodes": 30, "episode_return_max": -21.13326526023027, "episode_return_min": -1472.3768990146548, "episode_return_mean": -695.5660289570534, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.99809672307555, "num_env_steps_trained_throughput_per_sec": 268.99809672307555, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 14978.974, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14978.898, "sample_time_ms": 2434.185, "learn_time_ms": 12528.298, "learn_throughput": 319.277, "synch_weights_time_ms": 15.564}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00007", "date": "2024-08-03_05-28-46", "timestamp": 1722643126, "time_this_iter_s": 14.879791498184204, "time_total_s": 235.54593873023987, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12e82560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 235.54593873023987, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.890476190476193, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 68.40862776835759, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.839554263403018, "policy_loss": -0.016804450949227126, "vf_loss": 5.848497499525547, "vf_explained_var": 0.9066209840277831, "kl": 0.01771904789903452, "entropy": 1.1234044038380187, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -44.82019553694979, "episode_reward_min": -1408.347942694699, "episode_reward_mean": -641.0511148515017, "episode_len_mean": 134.37, "episode_media": {}, "episodes_timesteps_total": 13437, "policy_reward_min": {"policy_0": -1408.347942694699}, "policy_reward_max": {"policy_0": -44.82019553694979}, "policy_reward_mean": {"policy_0": -641.0511148515017}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-626.3562304195588, -69.32094398640432, -350.4921917845105, -357.5614781809531, -409.6685211488008, -449.8490304544603, -756.6073707737045, -74.99341484458724, -571.9226416323014, -699.3900649283411, -193.43796015454714, -642.6440153943231, -844.7292819210755, -1128.666015099312, -1216.9107029954123, -1040.0094709409004, -804.6059587218878, -361.88615911235536, -639.1128449464773, -708.1772271349485, -562.8203109237019, -1325.728925068094, -1408.347942694699, -1178.2403976666928, -466.96596031647374, -385.1627174399189, -222.4408757957035, -1002.9315660758683, -543.8132007186033, -565.1789857625827, -1133.6946336758663, -840.5360762810878, -1213.119561822101, -354.0788861827703, -456.0954965320351, -134.8956248293523, -243.12552305804715, -336.5287927063911, -776.4817903131395, -886.7491079914493, -490.06901976572937, -936.2452075579001, -286.6564956835343, -217.5915261226918, -1144.7860636360335, -892.3932087679618, -69.25912637912283, -1129.7537450777215, -719.9448962829235, -746.9318612250298, -69.64865771693664, -900.4693206572584, -843.4583567378003, -98.96655386656424, -253.3117186767603, -774.6378833830936, -995.9236109137564, -137.36939433670395, -846.3620486948041, -762.1054862070887, -559.5279166364675, -956.4508636486141, -665.7425385754053, -1051.0208475666961, -1011.6069945354354, -841.6647287525034, -841.1420579308434, -632.5672036678363, -730.0353159079897, -493.8704118432317, -915.8012601257834, -375.01776364722184, -328.5966468714129, -975.6849886411956, -777.9477286699159, -931.813602078663, -922.6985012006913, -106.7772278260031, -791.172541087425, -658.6899424700127, -235.4373897903252, -277.6104312817082, -898.9123849431878, -630.689781930743, -44.82019553694979, -812.5178964945745, -443.2057871218601, -1277.7188690578691, -609.9374929512596, -717.0968141522028, -145.5926070944711, -970.7608157530284, -380.44591330600394, -461.2754469354182, -635.1872231090522, -131.2592906171353, -720.4516805732745, -1163.8475113220238, -280.5870705009093, -400.7657188759587], "episode_lengths": [150, 67, 136, 147, 150, 150, 150, 64, 150, 150, 91, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 110, 110, 150, 150, 150, 150, 150, 150, 150, 150, 79, 98, 150, 150, 150, 150, 150, 150, 111, 150, 150, 57, 150, 150, 150, 68, 150, 150, 56, 83, 150, 150, 76, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 62, 150, 150, 89, 93, 150, 150, 61, 150, 150, 150, 150, 150, 62, 150, 150, 117, 143, 98, 150, 150, 116, 105], "policy_policy_0_reward": [-626.3562304195588, -69.32094398640432, -350.4921917845105, -357.5614781809531, -409.6685211488008, -449.8490304544603, -756.6073707737045, -74.99341484458724, -571.9226416323014, -699.3900649283411, -193.43796015454714, -642.6440153943231, -844.7292819210755, -1128.666015099312, -1216.9107029954123, -1040.0094709409004, -804.6059587218878, -361.88615911235536, -639.1128449464773, -708.1772271349485, -562.8203109237019, -1325.728925068094, -1408.347942694699, -1178.2403976666928, -466.96596031647374, -385.1627174399189, -222.4408757957035, -1002.9315660758683, -543.8132007186033, -565.1789857625827, -1133.6946336758663, -840.5360762810878, -1213.119561822101, -354.0788861827703, -456.0954965320351, -134.8956248293523, -243.12552305804715, -336.5287927063911, -776.4817903131395, -886.7491079914493, -490.06901976572937, -936.2452075579001, -286.6564956835343, -217.5915261226918, -1144.7860636360335, -892.3932087679618, -69.25912637912283, -1129.7537450777215, -719.9448962829235, -746.9318612250298, -69.64865771693664, -900.4693206572584, -843.4583567378003, -98.96655386656424, -253.3117186767603, -774.6378833830936, -995.9236109137564, -137.36939433670395, -846.3620486948041, -762.1054862070887, -559.5279166364675, -956.4508636486141, -665.7425385754053, -1051.0208475666961, -1011.6069945354354, -841.6647287525034, -841.1420579308434, -632.5672036678363, -730.0353159079897, -493.8704118432317, -915.8012601257834, -375.01776364722184, -328.5966468714129, -975.6849886411956, -777.9477286699159, -931.813602078663, -922.6985012006913, -106.7772278260031, -791.172541087425, -658.6899424700127, -235.4373897903252, -277.6104312817082, -898.9123849431878, -630.689781930743, -44.82019553694979, -812.5178964945745, -443.2057871218601, -1277.7188690578691, -609.9374929512596, -717.0968141522028, -145.5926070944711, -970.7608157530284, -380.44591330600394, -461.2754469354182, -635.1872231090522, -131.2592906171353, -720.4516805732745, -1163.8475113220238, -280.5870705009093, -400.7657188759587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.279093061901738, "mean_inference_ms": 0.8892552225936012, "mean_action_processing_ms": 0.1575235400023101, "mean_env_wait_ms": 1.547875544183389, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054857730865478516, "StateBufferConnector_ms": 0.00396275520324707, "ViewRequirementAgentConnector_ms": 0.09814596176147461}, "num_episodes": 30, "episode_return_max": -44.82019553694979, "episode_return_min": -1408.347942694699, "episode_return_mean": -641.0511148515017, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.9027900755237, "num_env_steps_trained_throughput_per_sec": 269.9027900755237, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 14873.869, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14873.789, "sample_time_ms": 2420.549, "learn_time_ms": 12436.831, "learn_throughput": 321.625, "synch_weights_time_ms": 15.561}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00007", "date": "2024-08-03_05-29-01", "timestamp": 1722643141, "time_this_iter_s": 14.82823657989502, "time_total_s": 250.3741753101349, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12e83d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 250.3741753101349, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 12.961904761904762, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 75.60987324118614, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.614159372448921, "policy_loss": -0.016362343084377548, "vf_loss": 5.62262893791, "vf_explained_var": 0.9007054920618732, "kl": 0.01783428830998069, "entropy": 1.3265083129207293, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -44.82019553694979, "episode_reward_min": -1303.0946289789526, "episode_reward_mean": -644.3779250391991, "episode_len_mean": 133.7, "episode_media": {}, "episodes_timesteps_total": 13370, "policy_reward_min": {"policy_0": -1303.0946289789526}, "policy_reward_max": {"policy_0": -44.82019553694979}, "policy_reward_mean": {"policy_0": -644.3779250391991}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-840.5360762810878, -1213.119561822101, -354.0788861827703, -456.0954965320351, -134.8956248293523, -243.12552305804715, -336.5287927063911, -776.4817903131395, -886.7491079914493, -490.06901976572937, -936.2452075579001, -286.6564956835343, -217.5915261226918, -1144.7860636360335, -892.3932087679618, -69.25912637912283, -1129.7537450777215, -719.9448962829235, -746.9318612250298, -69.64865771693664, -900.4693206572584, -843.4583567378003, -98.96655386656424, -253.3117186767603, -774.6378833830936, -995.9236109137564, -137.36939433670395, -846.3620486948041, -762.1054862070887, -559.5279166364675, -956.4508636486141, -665.7425385754053, -1051.0208475666961, -1011.6069945354354, -841.6647287525034, -841.1420579308434, -632.5672036678363, -730.0353159079897, -493.8704118432317, -915.8012601257834, -375.01776364722184, -328.5966468714129, -975.6849886411956, -777.9477286699159, -931.813602078663, -922.6985012006913, -106.7772278260031, -791.172541087425, -658.6899424700127, -235.4373897903252, -277.6104312817082, -898.9123849431878, -630.689781930743, -44.82019553694979, -812.5178964945745, -443.2057871218601, -1277.7188690578691, -609.9374929512596, -717.0968141522028, -145.5926070944711, -970.7608157530284, -380.44591330600394, -461.2754469354182, -635.1872231090522, -131.2592906171353, -720.4516805732745, -1163.8475113220238, -280.5870705009093, -400.7657188759587, -952.7377443903462, -804.700435515004, -1020.3926110645481, -613.3629776309197, -433.90962828402814, -636.1597604577012, -289.8924001261825, -118.5099992090997, -650.1910038650477, -982.0102774312757, -969.2635142684537, -1223.8380960062907, -682.4261174920506, -634.2208416888491, -1303.0946289789526, -212.7251980037221, -88.09592313330091, -904.082258932138, -794.5357707359651, -474.8377245899521, -664.6373300475824, -800.8177119829952, -964.1898665689366, -768.4737732635009, -294.59991970448914, -624.2613975540595, -748.189563291883, -700.1655239509494, -62.272927928235994, -911.2911346811372, -746.461998705218], "episode_lengths": [150, 150, 150, 150, 79, 98, 150, 150, 150, 150, 150, 150, 111, 150, 150, 57, 150, 150, 150, 68, 150, 150, 56, 83, 150, 150, 76, 150, 150, 136, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 62, 150, 150, 89, 93, 150, 150, 61, 150, 150, 150, 150, 150, 62, 150, 150, 117, 143, 98, 150, 150, 116, 105, 150, 150, 150, 150, 150, 150, 84, 70, 148, 150, 150, 150, 150, 150, 150, 100, 70, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 47, 150, 150], "policy_policy_0_reward": [-840.5360762810878, -1213.119561822101, -354.0788861827703, -456.0954965320351, -134.8956248293523, -243.12552305804715, -336.5287927063911, -776.4817903131395, -886.7491079914493, -490.06901976572937, -936.2452075579001, -286.6564956835343, -217.5915261226918, -1144.7860636360335, -892.3932087679618, -69.25912637912283, -1129.7537450777215, -719.9448962829235, -746.9318612250298, -69.64865771693664, -900.4693206572584, -843.4583567378003, -98.96655386656424, -253.3117186767603, -774.6378833830936, -995.9236109137564, -137.36939433670395, -846.3620486948041, -762.1054862070887, -559.5279166364675, -956.4508636486141, -665.7425385754053, -1051.0208475666961, -1011.6069945354354, -841.6647287525034, -841.1420579308434, -632.5672036678363, -730.0353159079897, -493.8704118432317, -915.8012601257834, -375.01776364722184, -328.5966468714129, -975.6849886411956, -777.9477286699159, -931.813602078663, -922.6985012006913, -106.7772278260031, -791.172541087425, -658.6899424700127, -235.4373897903252, -277.6104312817082, -898.9123849431878, -630.689781930743, -44.82019553694979, -812.5178964945745, -443.2057871218601, -1277.7188690578691, -609.9374929512596, -717.0968141522028, -145.5926070944711, -970.7608157530284, -380.44591330600394, -461.2754469354182, -635.1872231090522, -131.2592906171353, -720.4516805732745, -1163.8475113220238, -280.5870705009093, -400.7657188759587, -952.7377443903462, -804.700435515004, -1020.3926110645481, -613.3629776309197, -433.90962828402814, -636.1597604577012, -289.8924001261825, -118.5099992090997, -650.1910038650477, -982.0102774312757, -969.2635142684537, -1223.8380960062907, -682.4261174920506, -634.2208416888491, -1303.0946289789526, -212.7251980037221, -88.09592313330091, -904.082258932138, -794.5357707359651, -474.8377245899521, -664.6373300475824, -800.8177119829952, -964.1898665689366, -768.4737732635009, -294.59991970448914, -624.2613975540595, -748.189563291883, -700.1655239509494, -62.272927928235994, -911.2911346811372, -746.461998705218]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27919193037989964, "mean_inference_ms": 0.8878432284277015, "mean_action_processing_ms": 0.1574633036032794, "mean_env_wait_ms": 1.5489491339363264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058286190032958984, "StateBufferConnector_ms": 0.0039708614349365234, "ViewRequirementAgentConnector_ms": 0.09905266761779785}, "num_episodes": 31, "episode_return_max": -44.82019553694979, "episode_return_min": -1303.0946289789526, "episode_return_mean": -644.3779250391991, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.3354584386701, "num_env_steps_trained_throughput_per_sec": 266.3354584386701, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 14865.955, "restore_workers_time_ms": 0.029, "training_step_time_ms": 14865.874, "sample_time_ms": 2408.592, "learn_time_ms": 12441.427, "learn_throughput": 321.507, "synch_weights_time_ms": 15.011}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00007", "date": "2024-08-03_05-29-16", "timestamp": 1722643156, "time_this_iter_s": 15.027710676193237, "time_total_s": 265.4018859863281, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fda5f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 265.4018859863281, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 12.82727272727273, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 72.64245838026206, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.5892284033199156, "policy_loss": -0.008899597454971323, "vf_loss": 5.59114036137859, "vf_explained_var": 0.9088911569987734, "kl": 0.015828061168516212, "entropy": 1.3498946391046047, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -14.051266665046207, "episode_reward_min": -1303.0946289789526, "episode_reward_mean": -672.6240524859296, "episode_len_mean": 134.5, "episode_media": {}, "episodes_timesteps_total": 13450, "policy_reward_min": {"policy_0": -1303.0946289789526}, "policy_reward_max": {"policy_0": -14.051266665046207}, "policy_reward_mean": {"policy_0": -672.6240524859296}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559.5279166364675, -956.4508636486141, -665.7425385754053, -1051.0208475666961, -1011.6069945354354, -841.6647287525034, -841.1420579308434, -632.5672036678363, -730.0353159079897, -493.8704118432317, -915.8012601257834, -375.01776364722184, -328.5966468714129, -975.6849886411956, -777.9477286699159, -931.813602078663, -922.6985012006913, -106.7772278260031, -791.172541087425, -658.6899424700127, -235.4373897903252, -277.6104312817082, -898.9123849431878, -630.689781930743, -44.82019553694979, -812.5178964945745, -443.2057871218601, -1277.7188690578691, -609.9374929512596, -717.0968141522028, -145.5926070944711, -970.7608157530284, -380.44591330600394, -461.2754469354182, -635.1872231090522, -131.2592906171353, -720.4516805732745, -1163.8475113220238, -280.5870705009093, -400.7657188759587, -952.7377443903462, -804.700435515004, -1020.3926110645481, -613.3629776309197, -433.90962828402814, -636.1597604577012, -289.8924001261825, -118.5099992090997, -650.1910038650477, -982.0102774312757, -969.2635142684537, -1223.8380960062907, -682.4261174920506, -634.2208416888491, -1303.0946289789526, -212.7251980037221, -88.09592313330091, -904.082258932138, -794.5357707359651, -474.8377245899521, -664.6373300475824, -800.8177119829952, -964.1898665689366, -768.4737732635009, -294.59991970448914, -624.2613975540595, -748.189563291883, -700.1655239509494, -62.272927928235994, -911.2911346811372, -746.461998705218, -279.20320359824547, -1152.587418619385, -151.24301444613093, -186.9871394471799, -792.6847419735001, -910.8619540328013, -735.1509861708762, -975.1564953779949, -953.5740347087843, -571.7628505039189, -1160.3076124815736, -1018.111374936766, -146.69791512433665, -340.9586507159954, -1193.5562594759974, -552.3149548230562, -904.7936902497289, -108.98730475906139, -574.7439451278929, -940.2036691922444, -712.7515575546213, -370.6805966582034, -910.3774597533156, -1055.1083092778576, -663.5296497636109, -923.186501923719, -844.0122387309289, -1238.5229899860772, -14.051266665046207], "episode_lengths": [136, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 62, 150, 150, 89, 93, 150, 150, 61, 150, 150, 150, 150, 150, 62, 150, 150, 117, 143, 98, 150, 150, 116, 105, 150, 150, 150, 150, 150, 150, 84, 70, 148, 150, 150, 150, 150, 150, 150, 100, 70, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 47, 150, 150, 116, 150, 79, 112, 150, 150, 150, 150, 150, 150, 150, 150, 66, 134, 150, 150, 150, 66, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 38], "policy_policy_0_reward": [-559.5279166364675, -956.4508636486141, -665.7425385754053, -1051.0208475666961, -1011.6069945354354, -841.6647287525034, -841.1420579308434, -632.5672036678363, -730.0353159079897, -493.8704118432317, -915.8012601257834, -375.01776364722184, -328.5966468714129, -975.6849886411956, -777.9477286699159, -931.813602078663, -922.6985012006913, -106.7772278260031, -791.172541087425, -658.6899424700127, -235.4373897903252, -277.6104312817082, -898.9123849431878, -630.689781930743, -44.82019553694979, -812.5178964945745, -443.2057871218601, -1277.7188690578691, -609.9374929512596, -717.0968141522028, -145.5926070944711, -970.7608157530284, -380.44591330600394, -461.2754469354182, -635.1872231090522, -131.2592906171353, -720.4516805732745, -1163.8475113220238, -280.5870705009093, -400.7657188759587, -952.7377443903462, -804.700435515004, -1020.3926110645481, -613.3629776309197, -433.90962828402814, -636.1597604577012, -289.8924001261825, -118.5099992090997, -650.1910038650477, -982.0102774312757, -969.2635142684537, -1223.8380960062907, -682.4261174920506, -634.2208416888491, -1303.0946289789526, -212.7251980037221, -88.09592313330091, -904.082258932138, -794.5357707359651, -474.8377245899521, -664.6373300475824, -800.8177119829952, -964.1898665689366, -768.4737732635009, -294.59991970448914, -624.2613975540595, -748.189563291883, -700.1655239509494, -62.272927928235994, -911.2911346811372, -746.461998705218, -279.20320359824547, -1152.587418619385, -151.24301444613093, -186.9871394471799, -792.6847419735001, -910.8619540328013, -735.1509861708762, -975.1564953779949, -953.5740347087843, -571.7628505039189, -1160.3076124815736, -1018.111374936766, -146.69791512433665, -340.9586507159954, -1193.5562594759974, -552.3149548230562, -904.7936902497289, -108.98730475906139, -574.7439451278929, -940.2036691922444, -712.7515575546213, -370.6805966582034, -910.3774597533156, -1055.1083092778576, -663.5296497636109, -923.186501923719, -844.0122387309289, -1238.5229899860772, -14.051266665046207]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27938725506880646, "mean_inference_ms": 0.8876375382386241, "mean_action_processing_ms": 0.15751746422804033, "mean_env_wait_ms": 1.5499288389326762, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005767107009887695, "StateBufferConnector_ms": 0.0038852691650390625, "ViewRequirementAgentConnector_ms": 0.09741830825805664}, "num_episodes": 29, "episode_return_max": -14.051266665046207, "episode_return_min": -1303.0946289789526, "episode_return_mean": -672.6240524859296, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.8270184634699, "num_env_steps_trained_throughput_per_sec": 266.8270184634699, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 14812.504, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14812.424, "sample_time_ms": 2407.093, "learn_time_ms": 12389.424, "learn_throughput": 322.856, "synch_weights_time_ms": 15.052}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00007", "date": "2024-08-03_05-29-31", "timestamp": 1722643171, "time_this_iter_s": 14.998329639434814, "time_total_s": 280.40021562576294, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fd95a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 280.40021562576294, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.02857142857143, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 67.15734482308228, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.731149903684854, "policy_loss": -0.006534264371536361, "vf_loss": 5.731338115533193, "vf_explained_var": 0.9301498447234432, "kl": 0.014342939611106005, "entropy": 1.0827304368838668, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -14.051266665046207, "episode_reward_min": -1303.0946289789526, "episode_reward_mean": -640.1415135470645, "episode_len_mean": 132.26, "episode_media": {}, "episodes_timesteps_total": 13226, "policy_reward_min": {"policy_0": -1303.0946289789526}, "policy_reward_max": {"policy_0": -14.051266665046207}, "policy_reward_mean": {"policy_0": -640.1415135470645}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-145.5926070944711, -970.7608157530284, -380.44591330600394, -461.2754469354182, -635.1872231090522, -131.2592906171353, -720.4516805732745, -1163.8475113220238, -280.5870705009093, -400.7657188759587, -952.7377443903462, -804.700435515004, -1020.3926110645481, -613.3629776309197, -433.90962828402814, -636.1597604577012, -289.8924001261825, -118.5099992090997, -650.1910038650477, -982.0102774312757, -969.2635142684537, -1223.8380960062907, -682.4261174920506, -634.2208416888491, -1303.0946289789526, -212.7251980037221, -88.09592313330091, -904.082258932138, -794.5357707359651, -474.8377245899521, -664.6373300475824, -800.8177119829952, -964.1898665689366, -768.4737732635009, -294.59991970448914, -624.2613975540595, -748.189563291883, -700.1655239509494, -62.272927928235994, -911.2911346811372, -746.461998705218, -279.20320359824547, -1152.587418619385, -151.24301444613093, -186.9871394471799, -792.6847419735001, -910.8619540328013, -735.1509861708762, -975.1564953779949, -953.5740347087843, -571.7628505039189, -1160.3076124815736, -1018.111374936766, -146.69791512433665, -340.9586507159954, -1193.5562594759974, -552.3149548230562, -904.7936902497289, -108.98730475906139, -574.7439451278929, -940.2036691922444, -712.7515575546213, -370.6805966582034, -910.3774597533156, -1055.1083092778576, -663.5296497636109, -923.186501923719, -844.0122387309289, -1238.5229899860772, -14.051266665046207, -37.26250044528007, -450.18887725862623, -1227.035294431666, -314.5771043385032, -872.3390837558705, -506.28360692820434, -539.7224193767373, -217.81494388140752, -849.690522288965, -423.4194230065331, -809.0691509174228, -588.7308330592917, -291.5163166021224, -191.9371771947833, -394.6232118993577, -1129.312302643267, -90.12402366096471, -129.9365214396454, -447.978300402096, -744.0887298865878, -256.6148746790891, -556.8624874785359, -694.9315579630336, -801.0364451348358, -734.3796774299692, -892.7467734126235, -1065.3987900184418, -1140.724693960421, -449.5391115451141, -419.6374760181077], "episode_lengths": [62, 150, 150, 117, 143, 98, 150, 150, 116, 105, 150, 150, 150, 150, 150, 150, 84, 70, 148, 150, 150, 150, 150, 150, 150, 100, 70, 150, 150, 150, 150, 150, 150, 150, 90, 150, 150, 150, 47, 150, 150, 116, 150, 79, 112, 150, 150, 150, 150, 150, 150, 150, 150, 66, 134, 150, 150, 150, 66, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 38, 56, 150, 150, 126, 150, 150, 150, 99, 150, 150, 150, 150, 100, 90, 111, 150, 59, 86, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 112, 150], "policy_policy_0_reward": [-145.5926070944711, -970.7608157530284, -380.44591330600394, -461.2754469354182, -635.1872231090522, -131.2592906171353, -720.4516805732745, -1163.8475113220238, -280.5870705009093, -400.7657188759587, -952.7377443903462, -804.700435515004, -1020.3926110645481, -613.3629776309197, -433.90962828402814, -636.1597604577012, -289.8924001261825, -118.5099992090997, -650.1910038650477, -982.0102774312757, -969.2635142684537, -1223.8380960062907, -682.4261174920506, -634.2208416888491, -1303.0946289789526, -212.7251980037221, -88.09592313330091, -904.082258932138, -794.5357707359651, -474.8377245899521, -664.6373300475824, -800.8177119829952, -964.1898665689366, -768.4737732635009, -294.59991970448914, -624.2613975540595, -748.189563291883, -700.1655239509494, -62.272927928235994, -911.2911346811372, -746.461998705218, -279.20320359824547, -1152.587418619385, -151.24301444613093, -186.9871394471799, -792.6847419735001, -910.8619540328013, -735.1509861708762, -975.1564953779949, -953.5740347087843, -571.7628505039189, -1160.3076124815736, -1018.111374936766, -146.69791512433665, -340.9586507159954, -1193.5562594759974, -552.3149548230562, -904.7936902497289, -108.98730475906139, -574.7439451278929, -940.2036691922444, -712.7515575546213, -370.6805966582034, -910.3774597533156, -1055.1083092778576, -663.5296497636109, -923.186501923719, -844.0122387309289, -1238.5229899860772, -14.051266665046207, -37.26250044528007, -450.18887725862623, -1227.035294431666, -314.5771043385032, -872.3390837558705, -506.28360692820434, -539.7224193767373, -217.81494388140752, -849.690522288965, -423.4194230065331, -809.0691509174228, -588.7308330592917, -291.5163166021224, -191.9371771947833, -394.6232118993577, -1129.312302643267, -90.12402366096471, -129.9365214396454, -447.978300402096, -744.0887298865878, -256.6148746790891, -556.8624874785359, -694.9315579630336, -801.0364451348358, -734.3796774299692, -892.7467734126235, -1065.3987900184418, -1140.724693960421, -449.5391115451141, -419.6374760181077]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27941520485280863, "mean_inference_ms": 0.8866775843287173, "mean_action_processing_ms": 0.15750013210302377, "mean_env_wait_ms": 1.5514714507880658, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006097078323364258, "StateBufferConnector_ms": 0.003971576690673828, "ViewRequirementAgentConnector_ms": 0.09983992576599121}, "num_episodes": 30, "episode_return_max": -14.051266665046207, "episode_return_min": -1303.0946289789526, "episode_return_mean": -640.1415135470645, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.18689825730166, "num_env_steps_trained_throughput_per_sec": 270.18689825730166, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 14807.194, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14807.114, "sample_time_ms": 2412.354, "learn_time_ms": 12378.86, "learn_throughput": 323.132, "synch_weights_time_ms": 15.045}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00007", "date": "2024-08-03_05-29-46", "timestamp": 1722643186, "time_this_iter_s": 14.814574241638184, "time_total_s": 295.2147898674011, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fdb2e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.2147898674011, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 12.97142857142857, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.42199695110321, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.2251230999827385, "policy_loss": -0.01551000533121017, "vf_loss": 5.2335787244141105, "vf_explained_var": 0.9347643867135048, "kl": 0.016000584584981, "entropy": 1.45868490015467, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -14.051266665046207, "episode_reward_min": -1287.6144792847413, "episode_reward_mean": -668.1919597669222, "episode_len_mean": 134.41, "episode_media": {}, "episodes_timesteps_total": 13441, "policy_reward_min": {"policy_0": -1287.6144792847413}, "policy_reward_max": {"policy_0": -14.051266665046207}, "policy_reward_mean": {"policy_0": -668.1919597669222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-474.8377245899521, -664.6373300475824, -800.8177119829952, -964.1898665689366, -768.4737732635009, -294.59991970448914, -624.2613975540595, -748.189563291883, -700.1655239509494, -62.272927928235994, -911.2911346811372, -746.461998705218, -279.20320359824547, -1152.587418619385, -151.24301444613093, -186.9871394471799, -792.6847419735001, -910.8619540328013, -735.1509861708762, -975.1564953779949, -953.5740347087843, -571.7628505039189, -1160.3076124815736, -1018.111374936766, -146.69791512433665, -340.9586507159954, -1193.5562594759974, -552.3149548230562, -904.7936902497289, -108.98730475906139, -574.7439451278929, -940.2036691922444, -712.7515575546213, -370.6805966582034, -910.3774597533156, -1055.1083092778576, -663.5296497636109, -923.186501923719, -844.0122387309289, -1238.5229899860772, -14.051266665046207, -37.26250044528007, -450.18887725862623, -1227.035294431666, -314.5771043385032, -872.3390837558705, -506.28360692820434, -539.7224193767373, -217.81494388140752, -849.690522288965, -423.4194230065331, -809.0691509174228, -588.7308330592917, -291.5163166021224, -191.9371771947833, -394.6232118993577, -1129.312302643267, -90.12402366096471, -129.9365214396454, -447.978300402096, -744.0887298865878, -256.6148746790891, -556.8624874785359, -694.9315579630336, -801.0364451348358, -734.3796774299692, -892.7467734126235, -1065.3987900184418, -1140.724693960421, -449.5391115451141, -419.6374760181077, -836.2054013187118, -892.8896335200029, -357.6420712654933, -503.699678799282, -1227.4854399015671, -857.9511080382208, -172.3271243392136, -1092.5029047736182, -483.0014608458834, -1287.6144792847413, -438.8852755403967, -644.6553708113726, -851.9543206188256, -969.147550912199, -793.9030865306537, -980.124223982008, -948.0805192049766, -235.31943554776743, -132.42210223949002, -422.1072842863138, -699.7541073663648, -739.6318172390896, -1198.0124689509769, -1229.6722325842736, -930.1047674480994, -170.47433348679067, -926.3421470101644, -918.3872204209165, -469.06952101951003], "episode_lengths": [150, 150, 150, 150, 150, 90, 150, 150, 150, 47, 150, 150, 116, 150, 79, 112, 150, 150, 150, 150, 150, 150, 150, 150, 66, 134, 150, 150, 150, 66, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 38, 56, 150, 150, 126, 150, 150, 150, 99, 150, 150, 150, 150, 100, 90, 111, 150, 59, 86, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 143, 150, 150, 150, 87, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 75, 68, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150], "policy_policy_0_reward": [-474.8377245899521, -664.6373300475824, -800.8177119829952, -964.1898665689366, -768.4737732635009, -294.59991970448914, -624.2613975540595, -748.189563291883, -700.1655239509494, -62.272927928235994, -911.2911346811372, -746.461998705218, -279.20320359824547, -1152.587418619385, -151.24301444613093, -186.9871394471799, -792.6847419735001, -910.8619540328013, -735.1509861708762, -975.1564953779949, -953.5740347087843, -571.7628505039189, -1160.3076124815736, -1018.111374936766, -146.69791512433665, -340.9586507159954, -1193.5562594759974, -552.3149548230562, -904.7936902497289, -108.98730475906139, -574.7439451278929, -940.2036691922444, -712.7515575546213, -370.6805966582034, -910.3774597533156, -1055.1083092778576, -663.5296497636109, -923.186501923719, -844.0122387309289, -1238.5229899860772, -14.051266665046207, -37.26250044528007, -450.18887725862623, -1227.035294431666, -314.5771043385032, -872.3390837558705, -506.28360692820434, -539.7224193767373, -217.81494388140752, -849.690522288965, -423.4194230065331, -809.0691509174228, -588.7308330592917, -291.5163166021224, -191.9371771947833, -394.6232118993577, -1129.312302643267, -90.12402366096471, -129.9365214396454, -447.978300402096, -744.0887298865878, -256.6148746790891, -556.8624874785359, -694.9315579630336, -801.0364451348358, -734.3796774299692, -892.7467734126235, -1065.3987900184418, -1140.724693960421, -449.5391115451141, -419.6374760181077, -836.2054013187118, -892.8896335200029, -357.6420712654933, -503.699678799282, -1227.4854399015671, -857.9511080382208, -172.3271243392136, -1092.5029047736182, -483.0014608458834, -1287.6144792847413, -438.8852755403967, -644.6553708113726, -851.9543206188256, -969.147550912199, -793.9030865306537, -980.124223982008, -948.0805192049766, -235.31943554776743, -132.42210223949002, -422.1072842863138, -699.7541073663648, -739.6318172390896, -1198.0124689509769, -1229.6722325842736, -930.1047674480994, -170.47433348679067, -926.3421470101644, -918.3872204209165, -469.06952101951003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27942434228481194, "mean_inference_ms": 0.8860861235729424, "mean_action_processing_ms": 0.15747846591574274, "mean_env_wait_ms": 1.55144895562334, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006091117858886719, "StateBufferConnector_ms": 0.003957986831665039, "ViewRequirementAgentConnector_ms": 0.09979128837585449}, "num_episodes": 29, "episode_return_max": -14.051266665046207, "episode_return_min": -1287.6144792847413, "episode_return_mean": -668.1919597669222, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.3275645796927, "num_env_steps_trained_throughput_per_sec": 264.3275645796927, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 14824.554, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14824.476, "sample_time_ms": 2423.542, "learn_time_ms": 12384.818, "learn_throughput": 322.976, "synch_weights_time_ms": 15.259}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00007", "date": "2024-08-03_05-30-01", "timestamp": 1722643201, "time_this_iter_s": 15.140750885009766, "time_total_s": 310.3555407524109, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12e82e60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 310.3555407524109, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 12.72272727272727, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 111.27661265134812, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.180434212833643, "policy_loss": -0.01422481154537915, "vf_loss": 5.18906782194972, "vf_explained_var": 0.9301452999313672, "kl": 0.012778683823792887, "entropy": 1.5923372822503248, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -14.051266665046207, "episode_reward_min": -1357.5336850731826, "episode_reward_mean": -703.6947663610221, "episode_len_mean": 135.74, "episode_media": {}, "episodes_timesteps_total": 13574, "policy_reward_min": {"policy_0": -1357.5336850731826}, "policy_reward_max": {"policy_0": -14.051266665046207}, "policy_reward_mean": {"policy_0": -703.6947663610221}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-108.98730475906139, -574.7439451278929, -940.2036691922444, -712.7515575546213, -370.6805966582034, -910.3774597533156, -1055.1083092778576, -663.5296497636109, -923.186501923719, -844.0122387309289, -1238.5229899860772, -14.051266665046207, -37.26250044528007, -450.18887725862623, -1227.035294431666, -314.5771043385032, -872.3390837558705, -506.28360692820434, -539.7224193767373, -217.81494388140752, -849.690522288965, -423.4194230065331, -809.0691509174228, -588.7308330592917, -291.5163166021224, -191.9371771947833, -394.6232118993577, -1129.312302643267, -90.12402366096471, -129.9365214396454, -447.978300402096, -744.0887298865878, -256.6148746790891, -556.8624874785359, -694.9315579630336, -801.0364451348358, -734.3796774299692, -892.7467734126235, -1065.3987900184418, -1140.724693960421, -449.5391115451141, -419.6374760181077, -836.2054013187118, -892.8896335200029, -357.6420712654933, -503.699678799282, -1227.4854399015671, -857.9511080382208, -172.3271243392136, -1092.5029047736182, -483.0014608458834, -1287.6144792847413, -438.8852755403967, -644.6553708113726, -851.9543206188256, -969.147550912199, -793.9030865306537, -980.124223982008, -948.0805192049766, -235.31943554776743, -132.42210223949002, -422.1072842863138, -699.7541073663648, -739.6318172390896, -1198.0124689509769, -1229.6722325842736, -930.1047674480994, -170.47433348679067, -926.3421470101644, -918.3872204209165, -469.06952101951003, -1272.2648385516861, -206.6775187549696, -1099.7353784398056, -435.5489707074104, -753.2551173127273, -760.4195572213815, -178.84374223162808, -782.0659029469562, -686.6851502273237, -965.146836201339, -707.0360456731703, -464.72965833132616, -1263.4673157328825, -896.77822870496, -960.662293137666, -1357.5336850731826, -1276.737006682717, -757.4317520371569, -973.0864468536947, -727.8339169442797, -519.223300095906, -479.31380438780167, -20.54309943572156, -1206.924304023255, -919.184394235715, -1245.9910779658633, -789.2995118527105, -766.7971093569813, -863.2158652449815], "episode_lengths": [66, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 38, 56, 150, 150, 126, 150, 150, 150, 99, 150, 150, 150, 150, 100, 90, 111, 150, 59, 86, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 143, 150, 150, 150, 87, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 75, 68, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 80, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 41, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-108.98730475906139, -574.7439451278929, -940.2036691922444, -712.7515575546213, -370.6805966582034, -910.3774597533156, -1055.1083092778576, -663.5296497636109, -923.186501923719, -844.0122387309289, -1238.5229899860772, -14.051266665046207, -37.26250044528007, -450.18887725862623, -1227.035294431666, -314.5771043385032, -872.3390837558705, -506.28360692820434, -539.7224193767373, -217.81494388140752, -849.690522288965, -423.4194230065331, -809.0691509174228, -588.7308330592917, -291.5163166021224, -191.9371771947833, -394.6232118993577, -1129.312302643267, -90.12402366096471, -129.9365214396454, -447.978300402096, -744.0887298865878, -256.6148746790891, -556.8624874785359, -694.9315579630336, -801.0364451348358, -734.3796774299692, -892.7467734126235, -1065.3987900184418, -1140.724693960421, -449.5391115451141, -419.6374760181077, -836.2054013187118, -892.8896335200029, -357.6420712654933, -503.699678799282, -1227.4854399015671, -857.9511080382208, -172.3271243392136, -1092.5029047736182, -483.0014608458834, -1287.6144792847413, -438.8852755403967, -644.6553708113726, -851.9543206188256, -969.147550912199, -793.9030865306537, -980.124223982008, -948.0805192049766, -235.31943554776743, -132.42210223949002, -422.1072842863138, -699.7541073663648, -739.6318172390896, -1198.0124689509769, -1229.6722325842736, -930.1047674480994, -170.47433348679067, -926.3421470101644, -918.3872204209165, -469.06952101951003, -1272.2648385516861, -206.6775187549696, -1099.7353784398056, -435.5489707074104, -753.2551173127273, -760.4195572213815, -178.84374223162808, -782.0659029469562, -686.6851502273237, -965.146836201339, -707.0360456731703, -464.72965833132616, -1263.4673157328825, -896.77822870496, -960.662293137666, -1357.5336850731826, -1276.737006682717, -757.4317520371569, -973.0864468536947, -727.8339169442797, -519.223300095906, -479.31380438780167, -20.54309943572156, -1206.924304023255, -919.184394235715, -1245.9910779658633, -789.2995118527105, -766.7971093569813, -863.2158652449815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27927775837094343, "mean_inference_ms": 0.8851995561157184, "mean_action_processing_ms": 0.1573755494879212, "mean_env_wait_ms": 1.5518499543485889, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006112337112426758, "StateBufferConnector_ms": 0.003936052322387695, "ViewRequirementAgentConnector_ms": 0.09882974624633789}, "num_episodes": 29, "episode_return_max": -14.051266665046207, "episode_return_min": -1357.5336850731826, "episode_return_mean": -703.6947663610221, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.2804285446829, "num_env_steps_trained_throughput_per_sec": 268.2804285446829, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 14821.73, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14821.652, "sample_time_ms": 2416.787, "learn_time_ms": 12388.589, "learn_throughput": 322.878, "synch_weights_time_ms": 15.41}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00007", "date": "2024-08-03_05-30-16", "timestamp": 1722643216, "time_this_iter_s": 14.916688680648804, "time_total_s": 325.2722294330597, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fd95a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 325.2722294330597, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 13.014285714285714, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.44478172063828, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.835607546816269, "policy_loss": -0.004193814546063853, "vf_loss": 4.833702621857325, "vf_explained_var": 0.9547625898073117, "kl": 0.01387666371641295, "entropy": 1.4576124911506971, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -20.54309943572156, "episode_reward_min": -1357.5336850731826, "episode_reward_mean": -736.0366145740455, "episode_len_mean": 139.04, "episode_media": {}, "episodes_timesteps_total": 13904, "policy_reward_min": {"policy_0": -1357.5336850731826}, "policy_reward_max": {"policy_0": -20.54309943572156}, "policy_reward_mean": {"policy_0": -736.0366145740455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-90.12402366096471, -129.9365214396454, -447.978300402096, -744.0887298865878, -256.6148746790891, -556.8624874785359, -694.9315579630336, -801.0364451348358, -734.3796774299692, -892.7467734126235, -1065.3987900184418, -1140.724693960421, -449.5391115451141, -419.6374760181077, -836.2054013187118, -892.8896335200029, -357.6420712654933, -503.699678799282, -1227.4854399015671, -857.9511080382208, -172.3271243392136, -1092.5029047736182, -483.0014608458834, -1287.6144792847413, -438.8852755403967, -644.6553708113726, -851.9543206188256, -969.147550912199, -793.9030865306537, -980.124223982008, -948.0805192049766, -235.31943554776743, -132.42210223949002, -422.1072842863138, -699.7541073663648, -739.6318172390896, -1198.0124689509769, -1229.6722325842736, -930.1047674480994, -170.47433348679067, -926.3421470101644, -918.3872204209165, -469.06952101951003, -1272.2648385516861, -206.6775187549696, -1099.7353784398056, -435.5489707074104, -753.2551173127273, -760.4195572213815, -178.84374223162808, -782.0659029469562, -686.6851502273237, -965.146836201339, -707.0360456731703, -464.72965833132616, -1263.4673157328825, -896.77822870496, -960.662293137666, -1357.5336850731826, -1276.737006682717, -757.4317520371569, -973.0864468536947, -727.8339169442797, -519.223300095906, -479.31380438780167, -20.54309943572156, -1206.924304023255, -919.184394235715, -1245.9910779658633, -789.2995118527105, -766.7971093569813, -863.2158652449815, -1014.8601580207991, -1077.8045819001618, -552.3879106041437, -699.8523516533627, -1080.8620376905008, -429.63232176485496, -1235.1550284822658, -775.4707380593854, -862.055450097383, -96.70896087365503, -493.8738462529606, -896.1206346901976, -836.5957287452682, -1045.9920190444134, -697.4629859881883, -438.2943927643825, -561.1070620196504, -917.867339189197, -989.1007727096402, -1122.8979698603086, -379.7654969137964, -980.154131886395, -222.8812413844304, -782.8970701152897, -453.3528189229174, -972.0519815737335, -305.7922866963524, -512.8657608193354], "episode_lengths": [59, 86, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 143, 150, 150, 150, 87, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 75, 68, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 80, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 41, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 131, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 85, 150], "policy_policy_0_reward": [-90.12402366096471, -129.9365214396454, -447.978300402096, -744.0887298865878, -256.6148746790891, -556.8624874785359, -694.9315579630336, -801.0364451348358, -734.3796774299692, -892.7467734126235, -1065.3987900184418, -1140.724693960421, -449.5391115451141, -419.6374760181077, -836.2054013187118, -892.8896335200029, -357.6420712654933, -503.699678799282, -1227.4854399015671, -857.9511080382208, -172.3271243392136, -1092.5029047736182, -483.0014608458834, -1287.6144792847413, -438.8852755403967, -644.6553708113726, -851.9543206188256, -969.147550912199, -793.9030865306537, -980.124223982008, -948.0805192049766, -235.31943554776743, -132.42210223949002, -422.1072842863138, -699.7541073663648, -739.6318172390896, -1198.0124689509769, -1229.6722325842736, -930.1047674480994, -170.47433348679067, -926.3421470101644, -918.3872204209165, -469.06952101951003, -1272.2648385516861, -206.6775187549696, -1099.7353784398056, -435.5489707074104, -753.2551173127273, -760.4195572213815, -178.84374223162808, -782.0659029469562, -686.6851502273237, -965.146836201339, -707.0360456731703, -464.72965833132616, -1263.4673157328825, -896.77822870496, -960.662293137666, -1357.5336850731826, -1276.737006682717, -757.4317520371569, -973.0864468536947, -727.8339169442797, -519.223300095906, -479.31380438780167, -20.54309943572156, -1206.924304023255, -919.184394235715, -1245.9910779658633, -789.2995118527105, -766.7971093569813, -863.2158652449815, -1014.8601580207991, -1077.8045819001618, -552.3879106041437, -699.8523516533627, -1080.8620376905008, -429.63232176485496, -1235.1550284822658, -775.4707380593854, -862.055450097383, -96.70896087365503, -493.8738462529606, -896.1206346901976, -836.5957287452682, -1045.9920190444134, -697.4629859881883, -438.2943927643825, -561.1070620196504, -917.867339189197, -989.1007727096402, -1122.8979698603086, -379.7654969137964, -980.154131886395, -222.8812413844304, -782.8970701152897, -453.3528189229174, -972.0519815737335, -305.7922866963524, -512.8657608193354]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27927965790329795, "mean_inference_ms": 0.884663815509472, "mean_action_processing_ms": 0.15739700510388807, "mean_env_wait_ms": 1.5529947349976845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005824089050292969, "StateBufferConnector_ms": 0.0038874149322509766, "ViewRequirementAgentConnector_ms": 0.09763169288635254}, "num_episodes": 28, "episode_return_max": -20.54309943572156, "episode_return_min": -1357.5336850731826, "episode_return_mean": -736.0366145740455, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.0845749055341, "num_env_steps_trained_throughput_per_sec": 265.0845749055341, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 14884.83, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14884.752, "sample_time_ms": 2421.472, "learn_time_ms": 12446.903, "learn_throughput": 321.365, "synch_weights_time_ms": 15.519}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00007", "date": "2024-08-03_05-30-31", "timestamp": 1722643231, "time_this_iter_s": 15.098750352859497, "time_total_s": 340.3709797859192, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12eb1000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 340.3709797859192, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 12.91904761904762, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 118.23271066149076, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.247130408386389, "policy_loss": -0.013326435990165919, "vf_loss": 4.25402819737792, "vf_explained_var": 0.9588969374696413, "kl": 0.014591287871735404, "entropy": 1.3743063321957985, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -20.54309943572156, "episode_reward_min": -1408.4398589155949, "episode_reward_mean": -731.4854458639567, "episode_len_mean": 138.25, "episode_media": {}, "episodes_timesteps_total": 13825, "policy_reward_min": {"policy_0": -1408.4398589155949}, "policy_reward_max": {"policy_0": -20.54309943572156}, "policy_reward_mean": {"policy_0": -731.4854458639567}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-948.0805192049766, -235.31943554776743, -132.42210223949002, -422.1072842863138, -699.7541073663648, -739.6318172390896, -1198.0124689509769, -1229.6722325842736, -930.1047674480994, -170.47433348679067, -926.3421470101644, -918.3872204209165, -469.06952101951003, -1272.2648385516861, -206.6775187549696, -1099.7353784398056, -435.5489707074104, -753.2551173127273, -760.4195572213815, -178.84374223162808, -782.0659029469562, -686.6851502273237, -965.146836201339, -707.0360456731703, -464.72965833132616, -1263.4673157328825, -896.77822870496, -960.662293137666, -1357.5336850731826, -1276.737006682717, -757.4317520371569, -973.0864468536947, -727.8339169442797, -519.223300095906, -479.31380438780167, -20.54309943572156, -1206.924304023255, -919.184394235715, -1245.9910779658633, -789.2995118527105, -766.7971093569813, -863.2158652449815, -1014.8601580207991, -1077.8045819001618, -552.3879106041437, -699.8523516533627, -1080.8620376905008, -429.63232176485496, -1235.1550284822658, -775.4707380593854, -862.055450097383, -96.70896087365503, -493.8738462529606, -896.1206346901976, -836.5957287452682, -1045.9920190444134, -697.4629859881883, -438.2943927643825, -561.1070620196504, -917.867339189197, -989.1007727096402, -1122.8979698603086, -379.7654969137964, -980.154131886395, -222.8812413844304, -782.8970701152897, -453.3528189229174, -972.0519815737335, -305.7922866963524, -512.8657608193354, -903.2232211102242, -789.5758996064968, -912.7449153281381, -340.8047924509167, -1015.6510075202312, -1329.8338374694767, -429.8666527661752, -815.5390525697476, -320.8227884963093, -45.45699167615038, -416.778453325204, -29.977742374034626, -772.9791476756642, -1408.4398589155949, -366.1095530736878, -285.4033166228724, -261.3857403423899, -985.7322277791452, -898.4723930498907, -929.1500266299666, -754.0976702010013, -745.8711742174102, -757.3499855198539, -964.7424277117584, -724.3518040233735, -1230.2276089837305, -687.9241599249907, -67.28765554925751, -347.9389436940419, -821.1326738950237], "episode_lengths": [150, 75, 68, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 80, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 41, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 131, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 85, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 55, 130, 42, 150, 150, 92, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 150], "policy_policy_0_reward": [-948.0805192049766, -235.31943554776743, -132.42210223949002, -422.1072842863138, -699.7541073663648, -739.6318172390896, -1198.0124689509769, -1229.6722325842736, -930.1047674480994, -170.47433348679067, -926.3421470101644, -918.3872204209165, -469.06952101951003, -1272.2648385516861, -206.6775187549696, -1099.7353784398056, -435.5489707074104, -753.2551173127273, -760.4195572213815, -178.84374223162808, -782.0659029469562, -686.6851502273237, -965.146836201339, -707.0360456731703, -464.72965833132616, -1263.4673157328825, -896.77822870496, -960.662293137666, -1357.5336850731826, -1276.737006682717, -757.4317520371569, -973.0864468536947, -727.8339169442797, -519.223300095906, -479.31380438780167, -20.54309943572156, -1206.924304023255, -919.184394235715, -1245.9910779658633, -789.2995118527105, -766.7971093569813, -863.2158652449815, -1014.8601580207991, -1077.8045819001618, -552.3879106041437, -699.8523516533627, -1080.8620376905008, -429.63232176485496, -1235.1550284822658, -775.4707380593854, -862.055450097383, -96.70896087365503, -493.8738462529606, -896.1206346901976, -836.5957287452682, -1045.9920190444134, -697.4629859881883, -438.2943927643825, -561.1070620196504, -917.867339189197, -989.1007727096402, -1122.8979698603086, -379.7654969137964, -980.154131886395, -222.8812413844304, -782.8970701152897, -453.3528189229174, -972.0519815737335, -305.7922866963524, -512.8657608193354, -903.2232211102242, -789.5758996064968, -912.7449153281381, -340.8047924509167, -1015.6510075202312, -1329.8338374694767, -429.8666527661752, -815.5390525697476, -320.8227884963093, -45.45699167615038, -416.778453325204, -29.977742374034626, -772.9791476756642, -1408.4398589155949, -366.1095530736878, -285.4033166228724, -261.3857403423899, -985.7322277791452, -898.4723930498907, -929.1500266299666, -754.0976702010013, -745.8711742174102, -757.3499855198539, -964.7424277117584, -724.3518040233735, -1230.2276089837305, -687.9241599249907, -67.28765554925751, -347.9389436940419, -821.1326738950237]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2792823125034054, "mean_inference_ms": 0.884095965556345, "mean_action_processing_ms": 0.15738380567223334, "mean_env_wait_ms": 1.5538625133961306, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005536079406738281, "StateBufferConnector_ms": 0.0038259029388427734, "ViewRequirementAgentConnector_ms": 0.09650778770446777}, "num_episodes": 30, "episode_return_max": -20.54309943572156, "episode_return_min": -1408.4398589155949, "episode_return_mean": -731.4854458639567, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.05242622812233, "num_env_steps_trained_throughput_per_sec": 270.05242622812233, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 14949.043, "restore_workers_time_ms": 0.029, "training_step_time_ms": 14948.962, "sample_time_ms": 2411.751, "learn_time_ms": 12520.829, "learn_throughput": 319.468, "synch_weights_time_ms": 15.521}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00007", "date": "2024-08-03_05-30-46", "timestamp": 1722643246, "time_this_iter_s": 14.819308996200562, "time_total_s": 355.19028878211975, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12e82c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 355.19028878211975, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.157142857142855, "ram_util_percent": 19.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 117.85174621244272, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.379652127747734, "policy_loss": -0.009957475355380059, "vf_loss": 4.383003146698077, "vf_explained_var": 0.9783225283647577, "kl": 0.014983248355141199, "entropy": 1.3600307777523994, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -14.836581994038767, "episode_reward_min": -1408.4398589155949, "episode_reward_mean": -698.9756155745754, "episode_len_mean": 136.2, "episode_media": {}, "episodes_timesteps_total": 13620, "policy_reward_min": {"policy_0": -1408.4398589155949}, "policy_reward_max": {"policy_0": -14.836581994038767}, "policy_reward_mean": {"policy_0": -698.9756155745754}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-757.4317520371569, -973.0864468536947, -727.8339169442797, -519.223300095906, -479.31380438780167, -20.54309943572156, -1206.924304023255, -919.184394235715, -1245.9910779658633, -789.2995118527105, -766.7971093569813, -863.2158652449815, -1014.8601580207991, -1077.8045819001618, -552.3879106041437, -699.8523516533627, -1080.8620376905008, -429.63232176485496, -1235.1550284822658, -775.4707380593854, -862.055450097383, -96.70896087365503, -493.8738462529606, -896.1206346901976, -836.5957287452682, -1045.9920190444134, -697.4629859881883, -438.2943927643825, -561.1070620196504, -917.867339189197, -989.1007727096402, -1122.8979698603086, -379.7654969137964, -980.154131886395, -222.8812413844304, -782.8970701152897, -453.3528189229174, -972.0519815737335, -305.7922866963524, -512.8657608193354, -903.2232211102242, -789.5758996064968, -912.7449153281381, -340.8047924509167, -1015.6510075202312, -1329.8338374694767, -429.8666527661752, -815.5390525697476, -320.8227884963093, -45.45699167615038, -416.778453325204, -29.977742374034626, -772.9791476756642, -1408.4398589155949, -366.1095530736878, -285.4033166228724, -261.3857403423899, -985.7322277791452, -898.4723930498907, -929.1500266299666, -754.0976702010013, -745.8711742174102, -757.3499855198539, -964.7424277117584, -724.3518040233735, -1230.2276089837305, -687.9241599249907, -67.28765554925751, -347.9389436940419, -821.1326738950237, -839.5500160158298, -1091.6957881245567, -682.5007583800785, -77.57992834946376, -1051.3572667812005, -315.57538565759774, -892.8338234243148, -503.43392492130937, -598.9851576388477, -392.92986193313743, -210.83686316939526, -503.6050561509725, -626.0055334317439, -865.8281232460928, -144.36887689849803, -308.5704522650294, -773.1107868710912, -721.0095227217219, -979.6974464040424, -904.1502257581313, -1142.699473066697, -1076.1504236512408, -1054.3427444885983, -836.3829617512735, -14.836581994038767, -1121.0343809361198, -128.04985887715375, -729.2961763136963, -1009.1397203345207, -240.42505424133103], "episode_lengths": [150, 150, 150, 150, 109, 41, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 131, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 85, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 55, 130, 42, 150, 150, 92, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 150, 150, 89, 150, 98, 150, 141, 150, 132, 125, 150, 150, 150, 74, 83, 150, 150, 150, 150, 150, 150, 150, 150, 44, 150, 54, 150, 150, 107], "policy_policy_0_reward": [-757.4317520371569, -973.0864468536947, -727.8339169442797, -519.223300095906, -479.31380438780167, -20.54309943572156, -1206.924304023255, -919.184394235715, -1245.9910779658633, -789.2995118527105, -766.7971093569813, -863.2158652449815, -1014.8601580207991, -1077.8045819001618, -552.3879106041437, -699.8523516533627, -1080.8620376905008, -429.63232176485496, -1235.1550284822658, -775.4707380593854, -862.055450097383, -96.70896087365503, -493.8738462529606, -896.1206346901976, -836.5957287452682, -1045.9920190444134, -697.4629859881883, -438.2943927643825, -561.1070620196504, -917.867339189197, -989.1007727096402, -1122.8979698603086, -379.7654969137964, -980.154131886395, -222.8812413844304, -782.8970701152897, -453.3528189229174, -972.0519815737335, -305.7922866963524, -512.8657608193354, -903.2232211102242, -789.5758996064968, -912.7449153281381, -340.8047924509167, -1015.6510075202312, -1329.8338374694767, -429.8666527661752, -815.5390525697476, -320.8227884963093, -45.45699167615038, -416.778453325204, -29.977742374034626, -772.9791476756642, -1408.4398589155949, -366.1095530736878, -285.4033166228724, -261.3857403423899, -985.7322277791452, -898.4723930498907, -929.1500266299666, -754.0976702010013, -745.8711742174102, -757.3499855198539, -964.7424277117584, -724.3518040233735, -1230.2276089837305, -687.9241599249907, -67.28765554925751, -347.9389436940419, -821.1326738950237, -839.5500160158298, -1091.6957881245567, -682.5007583800785, -77.57992834946376, -1051.3572667812005, -315.57538565759774, -892.8338234243148, -503.43392492130937, -598.9851576388477, -392.92986193313743, -210.83686316939526, -503.6050561509725, -626.0055334317439, -865.8281232460928, -144.36887689849803, -308.5704522650294, -773.1107868710912, -721.0095227217219, -979.6974464040424, -904.1502257581313, -1142.699473066697, -1076.1504236512408, -1054.3427444885983, -836.3829617512735, -14.836581994038767, -1121.0343809361198, -128.04985887715375, -729.2961763136963, -1009.1397203345207, -240.42505424133103]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2793099465338701, "mean_inference_ms": 0.8838124858520752, "mean_action_processing_ms": 0.1574288742169231, "mean_env_wait_ms": 1.5552794060277264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054247379302978516, "StateBufferConnector_ms": 0.0038208961486816406, "ViewRequirementAgentConnector_ms": 0.09621024131774902}, "num_episodes": 30, "episode_return_max": -14.836581994038767, "episode_return_min": -1408.4398589155949, "episode_return_mean": -698.9756155745754, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.99274236916574, "num_env_steps_trained_throughput_per_sec": 264.99274236916574, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 14954.324, "restore_workers_time_ms": 0.029, "training_step_time_ms": 14954.242, "sample_time_ms": 2398.462, "learn_time_ms": 12539.327, "learn_throughput": 318.996, "synch_weights_time_ms": 15.593}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00007", "date": "2024-08-03_05-31-01", "timestamp": 1722643261, "time_this_iter_s": 15.10281777381897, "time_total_s": 370.2931065559387, "pid": 488945, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12e83eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 370.2931065559387, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 12.872727272727273, "ram_util_percent": 19.300000000000004}}
