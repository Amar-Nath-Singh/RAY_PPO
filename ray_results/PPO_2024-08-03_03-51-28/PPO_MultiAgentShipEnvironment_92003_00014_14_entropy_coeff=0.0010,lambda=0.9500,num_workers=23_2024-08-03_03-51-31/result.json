{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2564163440838456, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.443238650759062, "policy_loss": -0.012133223568283332, "vf_loss": 9.453504114349682, "vf_explained_var": 0.017137894593179225, "kl": 0.016483558242316575, "entropy": 1.4289329117784897, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -90.11063441495816, "episode_reward_min": -1189.6750035865648, "episode_reward_mean": -618.1404638193113, "episode_len_mean": 133.04166666666666, "episode_media": {}, "episodes_timesteps_total": 3193, "policy_reward_min": {"policy_0": -1189.6750035865648}, "policy_reward_max": {"policy_0": -90.11063441495816}, "policy_reward_mean": {"policy_0": -618.1404638193113}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-340.3121871384043, -90.11063441495816, -289.6796932244115, -801.1384446827465, -741.6427914506664, -568.8604469533474, -108.8009056199617, -564.2537517055251, -1063.8285594533738, -867.2747456051025, -702.9786698549186, -371.7661595949628, -382.87164193869, -818.9095664121447, -1039.081095636657, -1001.1117646808736, -141.7922495808567, -472.22732742917697, -1040.3367836132154, -381.9529467999166, -150.8089039036281, -681.4167888158361, -1189.6750035865648, -1024.540069567533], "episode_lengths": [113, 80, 89, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 149, 150, 150, 80, 150, 150, 150, 74, 150, 150, 150], "policy_policy_0_reward": [-340.3121871384043, -90.11063441495816, -289.6796932244115, -801.1384446827465, -741.6427914506664, -568.8604469533474, -108.8009056199617, -564.2537517055251, -1063.8285594533738, -867.2747456051025, -702.9786698549186, -371.7661595949628, -382.87164193869, -818.9095664121447, -1039.081095636657, -1001.1117646808736, -141.7922495808567, -472.22732742917697, -1040.3367836132154, -381.9529467999166, -150.8089039036281, -681.4167888158361, -1189.6750035865648, -1024.540069567533]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5690158121430554, "mean_inference_ms": 1.6938425660068113, "mean_action_processing_ms": 0.2836291171451312, "mean_env_wait_ms": 2.9973873442225467, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011137127876281738, "StateBufferConnector_ms": 0.008179744084676107, "ViewRequirementAgentConnector_ms": 0.17622709274291992}, "num_episodes": 24, "episode_return_max": -90.11063441495816, "episode_return_min": -1189.6750035865648, "episode_return_mean": -618.1404638193113, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.69997476173245, "num_env_steps_trained_throughput_per_sec": 316.69997476173245, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12630.262, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12630.192, "sample_time_ms": 1046.703, "learn_time_ms": 11492.087, "learn_throughput": 348.066, "synch_weights_time_ms": 90.43}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00014", "date": "2024-08-03_04-50-06", "timestamp": 1722640806, "time_this_iter_s": 12.642879247665405, "time_total_s": 12.642879247665405, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f7520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.642879247665405, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.294736842105266, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.7960799609931806, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.28021412541469, "policy_loss": -0.007540343139165392, "vf_loss": 9.287058235208194, "vf_explained_var": 0.08632685641447703, "kl": 0.010682595716965202, "entropy": 1.44029478939871, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -27.156244734370716, "episode_reward_min": -1426.7221588673717, "episode_reward_mean": -642.6753505241878, "episode_len_mean": 129.84313725490196, "episode_media": {}, "episodes_timesteps_total": 6622, "policy_reward_min": {"policy_0": -1426.7221588673717}, "policy_reward_max": {"policy_0": -27.156244734370716}, "policy_reward_mean": {"policy_0": -642.6753505241878}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-340.3121871384043, -90.11063441495816, -289.6796932244115, -801.1384446827465, -741.6427914506664, -568.8604469533474, -108.8009056199617, -564.2537517055251, -1063.8285594533738, -867.2747456051025, -702.9786698549186, -371.7661595949628, -382.87164193869, -818.9095664121447, -1039.081095636657, -1001.1117646808736, -141.7922495808567, -472.22732742917697, -1040.3367836132154, -381.9529467999166, -150.8089039036281, -681.4167888158361, -1189.6750035865648, -1024.540069567533, -900.4580370323927, -446.29360897168004, -1035.4816471868305, -39.55713446902978, -38.86374337300613, -1011.8472681160322, -509.95798609382405, -40.03096222894236, -1093.0362780505618, -852.2575828317558, -1426.7221588673717, -69.7947400356401, -577.8339388635643, -723.9181867136604, -948.0892379106783, -557.5599440254724, -1006.1006310888748, -385.19989981057245, -1033.469935288956, -673.7957676147469, -866.7090576742196, -111.8691602229566, -643.4958978937653, -27.156244734370716, -889.874357540167, -1137.2911868404576, -894.4071515905729], "episode_lengths": [113, 80, 89, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 149, 150, 150, 80, 150, 150, 150, 74, 150, 150, 150, 150, 145, 150, 47, 62, 150, 150, 54, 150, 150, 150, 45, 150, 150, 150, 115, 150, 150, 150, 150, 150, 67, 150, 44, 150, 150, 150], "policy_policy_0_reward": [-340.3121871384043, -90.11063441495816, -289.6796932244115, -801.1384446827465, -741.6427914506664, -568.8604469533474, -108.8009056199617, -564.2537517055251, -1063.8285594533738, -867.2747456051025, -702.9786698549186, -371.7661595949628, -382.87164193869, -818.9095664121447, -1039.081095636657, -1001.1117646808736, -141.7922495808567, -472.22732742917697, -1040.3367836132154, -381.9529467999166, -150.8089039036281, -681.4167888158361, -1189.6750035865648, -1024.540069567533, -900.4580370323927, -446.29360897168004, -1035.4816471868305, -39.55713446902978, -38.86374337300613, -1011.8472681160322, -509.95798609382405, -40.03096222894236, -1093.0362780505618, -852.2575828317558, -1426.7221588673717, -69.7947400356401, -577.8339388635643, -723.9181867136604, -948.0892379106783, -557.5599440254724, -1006.1006310888748, -385.19989981057245, -1033.469935288956, -673.7957676147469, -866.7090576742196, -111.8691602229566, -643.4958978937653, -27.156244734370716, -889.874357540167, -1137.2911868404576, -894.4071515905729]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.565535690569614, "mean_inference_ms": 1.6905221387733822, "mean_action_processing_ms": 0.28352530746405713, "mean_env_wait_ms": 2.992326625926081, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013647827447629442, "StateBufferConnector_ms": 0.008281071980794271, "ViewRequirementAgentConnector_ms": 0.18090126561183556}, "num_episodes": 27, "episode_return_max": -27.156244734370716, "episode_return_min": -1426.7221588673717, "episode_return_mean": -642.6753505241878, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.02170122286367, "num_env_steps_trained_throughput_per_sec": 305.02170122286367, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12872.047, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12871.981, "sample_time_ms": 1050.064, "learn_time_ms": 11740.334, "learn_throughput": 340.706, "synch_weights_time_ms": 80.739}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00014", "date": "2024-08-03_04-50-19", "timestamp": 1722640819, "time_this_iter_s": 13.125906229019165, "time_total_s": 25.76878547668457, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580eb5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.76878547668457, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.97222222222222, "ram_util_percent": 27.77777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7981565366188685, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.052067530651888, "policy_loss": -0.013315055643518765, "vf_loss": 9.06335330704848, "vf_explained_var": 0.17243781927973031, "kl": 0.017507950925300976, "entropy": 1.472337078054746, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -19.54296862556873, "episode_reward_min": -1426.7221588673717, "episode_reward_mean": -635.4136949241879, "episode_len_mean": 130.15384615384616, "episode_media": {}, "episodes_timesteps_total": 10152, "policy_reward_min": {"policy_0": -1426.7221588673717}, "policy_reward_max": {"policy_0": -19.54296862556873}, "policy_reward_mean": {"policy_0": -635.4136949241879}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-340.3121871384043, -90.11063441495816, -289.6796932244115, -801.1384446827465, -741.6427914506664, -568.8604469533474, -108.8009056199617, -564.2537517055251, -1063.8285594533738, -867.2747456051025, -702.9786698549186, -371.7661595949628, -382.87164193869, -818.9095664121447, -1039.081095636657, -1001.1117646808736, -141.7922495808567, -472.22732742917697, -1040.3367836132154, -381.9529467999166, -150.8089039036281, -681.4167888158361, -1189.6750035865648, -1024.540069567533, -900.4580370323927, -446.29360897168004, -1035.4816471868305, -39.55713446902978, -38.86374337300613, -1011.8472681160322, -509.95798609382405, -40.03096222894236, -1093.0362780505618, -852.2575828317558, -1426.7221588673717, -69.7947400356401, -577.8339388635643, -723.9181867136604, -948.0892379106783, -557.5599440254724, -1006.1006310888748, -385.19989981057245, -1033.469935288956, -673.7957676147469, -866.7090576742196, -111.8691602229566, -643.4958978937653, -27.156244734370716, -889.874357540167, -1137.2911868404576, -894.4071515905729, -825.6629392560648, -823.2686488663629, -556.0736967812416, -505.7126819990482, -307.2284267046259, -951.8060626270188, -217.54091161686028, -859.0794073305577, -153.94655254581073, -895.0753691386482, -1114.8018267178786, -676.7847703393777, -931.3058464847545, -265.7700967287823, -1071.120784676304, -297.25996422480125, -938.7979504942477, -32.53094640351297, -766.2333750984191, -918.8064677297867, -761.5535599280306, -780.4529310734594, -288.74115120487807, -19.54296862556873, -969.523854189523, -618.3148422646292, -238.8892943028889], "episode_lengths": [113, 80, 89, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 149, 150, 150, 80, 150, 150, 150, 74, 150, 150, 150, 150, 145, 150, 47, 62, 150, 150, 54, 150, 150, 150, 45, 150, 150, 150, 115, 150, 150, 150, 150, 150, 67, 150, 44, 150, 150, 150, 150, 150, 150, 150, 90, 150, 70, 150, 95, 150, 150, 150, 150, 110, 150, 150, 150, 58, 150, 150, 150, 150, 120, 41, 150, 150, 96], "policy_policy_0_reward": [-340.3121871384043, -90.11063441495816, -289.6796932244115, -801.1384446827465, -741.6427914506664, -568.8604469533474, -108.8009056199617, -564.2537517055251, -1063.8285594533738, -867.2747456051025, -702.9786698549186, -371.7661595949628, -382.87164193869, -818.9095664121447, -1039.081095636657, -1001.1117646808736, -141.7922495808567, -472.22732742917697, -1040.3367836132154, -381.9529467999166, -150.8089039036281, -681.4167888158361, -1189.6750035865648, -1024.540069567533, -900.4580370323927, -446.29360897168004, -1035.4816471868305, -39.55713446902978, -38.86374337300613, -1011.8472681160322, -509.95798609382405, -40.03096222894236, -1093.0362780505618, -852.2575828317558, -1426.7221588673717, -69.7947400356401, -577.8339388635643, -723.9181867136604, -948.0892379106783, -557.5599440254724, -1006.1006310888748, -385.19989981057245, -1033.469935288956, -673.7957676147469, -866.7090576742196, -111.8691602229566, -643.4958978937653, -27.156244734370716, -889.874357540167, -1137.2911868404576, -894.4071515905729, -825.6629392560648, -823.2686488663629, -556.0736967812416, -505.7126819990482, -307.2284267046259, -951.8060626270188, -217.54091161686028, -859.0794073305577, -153.94655254581073, -895.0753691386482, -1114.8018267178786, -676.7847703393777, -931.3058464847545, -265.7700967287823, -1071.120784676304, -297.25996422480125, -938.7979504942477, -32.53094640351297, -766.2333750984191, -918.8064677297867, -761.5535599280306, -780.4529310734594, -288.74115120487807, -19.54296862556873, -969.523854189523, -618.3148422646292, -238.8892943028889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5640117770815237, "mean_inference_ms": 1.6906587594073297, "mean_action_processing_ms": 0.2840725475253137, "mean_env_wait_ms": 3.001317887304561, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0130616701566256, "StateBufferConnector_ms": 0.008340065295879658, "ViewRequirementAgentConnector_ms": 0.18428166707356772}, "num_episodes": 27, "episode_return_max": -19.54296862556873, "episode_return_min": -1426.7221588673717, "episode_return_mean": -635.4136949241879, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.213060256477, "num_env_steps_trained_throughput_per_sec": 302.213060256477, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12993.268, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12993.196, "sample_time_ms": 1061.11, "learn_time_ms": 11848.411, "learn_throughput": 337.598, "synch_weights_time_ms": 82.813}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00014", "date": "2024-08-03_04-50-32", "timestamp": 1722640832, "time_this_iter_s": 13.246995449066162, "time_total_s": 39.01578092575073, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f5bd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.01578092575073, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.689473684210526, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.441850239783525, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.405882650613785, "policy_loss": -0.01662689407724732, "vf_loss": 8.420093240837256, "vf_explained_var": 0.42088980923096336, "kl": 0.01945319297974493, "entropy": 1.4743427770833175, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -19.54296862556873, "episode_reward_min": -1426.7221588673717, "episode_reward_mean": -630.4845489067505, "episode_len_mean": 130.57, "episode_media": {}, "episodes_timesteps_total": 13057, "policy_reward_min": {"policy_0": -1426.7221588673717}, "policy_reward_max": {"policy_0": -19.54296862556873}, "policy_reward_mean": {"policy_0": -630.4845489067505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-702.9786698549186, -371.7661595949628, -382.87164193869, -818.9095664121447, -1039.081095636657, -1001.1117646808736, -141.7922495808567, -472.22732742917697, -1040.3367836132154, -381.9529467999166, -150.8089039036281, -681.4167888158361, -1189.6750035865648, -1024.540069567533, -900.4580370323927, -446.29360897168004, -1035.4816471868305, -39.55713446902978, -38.86374337300613, -1011.8472681160322, -509.95798609382405, -40.03096222894236, -1093.0362780505618, -852.2575828317558, -1426.7221588673717, -69.7947400356401, -577.8339388635643, -723.9181867136604, -948.0892379106783, -557.5599440254724, -1006.1006310888748, -385.19989981057245, -1033.469935288956, -673.7957676147469, -866.7090576742196, -111.8691602229566, -643.4958978937653, -27.156244734370716, -889.874357540167, -1137.2911868404576, -894.4071515905729, -825.6629392560648, -823.2686488663629, -556.0736967812416, -505.7126819990482, -307.2284267046259, -951.8060626270188, -217.54091161686028, -859.0794073305577, -153.94655254581073, -895.0753691386482, -1114.8018267178786, -676.7847703393777, -931.3058464847545, -265.7700967287823, -1071.120784676304, -297.25996422480125, -938.7979504942477, -32.53094640351297, -766.2333750984191, -918.8064677297867, -761.5535599280306, -780.4529310734594, -288.74115120487807, -19.54296862556873, -969.523854189523, -618.3148422646292, -238.8892943028889, -688.5938494432567, -430.3450123434512, -463.19494082331465, -897.2696664509108, -99.9095221465675, -1069.724785749781, -588.6037216332893, -818.9163879033687, -1003.529861004522, -824.1391254985165, -303.62801421904004, -64.90113136208177, -810.8467778181449, -1205.3461894715304, -172.62661499227008, -901.2474360989402, -635.8999721849099, -313.99909049571255, -774.8527480224041, -290.2706600386855, -592.9134580063322, -284.4043165376521, -1030.661382300531, -127.53365459037717, -625.1078956398992, -853.7515697465889, -670.5076006989217, -83.1675996964253, -805.1295858273644, -87.42291948494335, -685.3421428564719, -718.3012137506793], "episode_lengths": [150, 150, 150, 149, 150, 150, 80, 150, 150, 150, 74, 150, 150, 150, 150, 145, 150, 47, 62, 150, 150, 54, 150, 150, 150, 45, 150, 150, 150, 115, 150, 150, 150, 150, 150, 67, 150, 44, 150, 150, 150, 150, 150, 150, 150, 90, 150, 70, 150, 95, 150, 150, 150, 150, 110, 150, 150, 150, 58, 150, 150, 150, 150, 120, 41, 150, 150, 96, 150, 150, 110, 150, 77, 150, 129, 150, 150, 150, 101, 41, 150, 150, 150, 150, 150, 99, 150, 85, 150, 150, 150, 75, 150, 150, 150, 65, 150, 63, 150, 150], "policy_policy_0_reward": [-702.9786698549186, -371.7661595949628, -382.87164193869, -818.9095664121447, -1039.081095636657, -1001.1117646808736, -141.7922495808567, -472.22732742917697, -1040.3367836132154, -381.9529467999166, -150.8089039036281, -681.4167888158361, -1189.6750035865648, -1024.540069567533, -900.4580370323927, -446.29360897168004, -1035.4816471868305, -39.55713446902978, -38.86374337300613, -1011.8472681160322, -509.95798609382405, -40.03096222894236, -1093.0362780505618, -852.2575828317558, -1426.7221588673717, -69.7947400356401, -577.8339388635643, -723.9181867136604, -948.0892379106783, -557.5599440254724, -1006.1006310888748, -385.19989981057245, -1033.469935288956, -673.7957676147469, -866.7090576742196, -111.8691602229566, -643.4958978937653, -27.156244734370716, -889.874357540167, -1137.2911868404576, -894.4071515905729, -825.6629392560648, -823.2686488663629, -556.0736967812416, -505.7126819990482, -307.2284267046259, -951.8060626270188, -217.54091161686028, -859.0794073305577, -153.94655254581073, -895.0753691386482, -1114.8018267178786, -676.7847703393777, -931.3058464847545, -265.7700967287823, -1071.120784676304, -297.25996422480125, -938.7979504942477, -32.53094640351297, -766.2333750984191, -918.8064677297867, -761.5535599280306, -780.4529310734594, -288.74115120487807, -19.54296862556873, -969.523854189523, -618.3148422646292, -238.8892943028889, -688.5938494432567, -430.3450123434512, -463.19494082331465, -897.2696664509108, -99.9095221465675, -1069.724785749781, -588.6037216332893, -818.9163879033687, -1003.529861004522, -824.1391254985165, -303.62801421904004, -64.90113136208177, -810.8467778181449, -1205.3461894715304, -172.62661499227008, -901.2474360989402, -635.8999721849099, -313.99909049571255, -774.8527480224041, -290.2706600386855, -592.9134580063322, -284.4043165376521, -1030.661382300531, -127.53365459037717, -625.1078956398992, -853.7515697465889, -670.5076006989217, -83.1675996964253, -805.1295858273644, -87.42291948494335, -685.3421428564719, -718.3012137506793]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5632746167243591, "mean_inference_ms": 1.6907730775633794, "mean_action_processing_ms": 0.2848816727610265, "mean_env_wait_ms": 3.003176474151307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013640403747558594, "StateBufferConnector_ms": 0.008533239364624023, "ViewRequirementAgentConnector_ms": 0.18873834609985352}, "num_episodes": 32, "episode_return_max": -19.54296862556873, "episode_return_min": -1426.7221588673717, "episode_return_mean": -630.4845489067505, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.0140097928653, "num_env_steps_trained_throughput_per_sec": 305.0140097928653, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13023.492, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13023.419, "sample_time_ms": 1062.424, "learn_time_ms": 11877.174, "learn_throughput": 336.78, "synch_weights_time_ms": 82.955}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00014", "date": "2024-08-03_04-50-45", "timestamp": 1722640845, "time_this_iter_s": 13.127767086029053, "time_total_s": 52.143548011779785, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b32765360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.143548011779785, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.626315789473683, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.873797901223103, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.117040764788786, "policy_loss": -0.0013838038008543662, "vf_loss": 9.116025290886562, "vf_explained_var": 0.4213376820087433, "kl": 0.019759057208951467, "entropy": 1.5525312492003043, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -19.54296862556873, "episode_reward_min": -1264.309275697964, "episode_reward_mean": -642.5414059009495, "episode_len_mean": 132.8, "episode_media": {}, "episodes_timesteps_total": 13280, "policy_reward_min": {"policy_0": -1264.309275697964}, "policy_reward_max": {"policy_0": -19.54296862556873}, "policy_reward_mean": {"policy_0": -642.5414059009495}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-557.5599440254724, -1006.1006310888748, -385.19989981057245, -1033.469935288956, -673.7957676147469, -866.7090576742196, -111.8691602229566, -643.4958978937653, -27.156244734370716, -889.874357540167, -1137.2911868404576, -894.4071515905729, -825.6629392560648, -823.2686488663629, -556.0736967812416, -505.7126819990482, -307.2284267046259, -951.8060626270188, -217.54091161686028, -859.0794073305577, -153.94655254581073, -895.0753691386482, -1114.8018267178786, -676.7847703393777, -931.3058464847545, -265.7700967287823, -1071.120784676304, -297.25996422480125, -938.7979504942477, -32.53094640351297, -766.2333750984191, -918.8064677297867, -761.5535599280306, -780.4529310734594, -288.74115120487807, -19.54296862556873, -969.523854189523, -618.3148422646292, -238.8892943028889, -688.5938494432567, -430.3450123434512, -463.19494082331465, -897.2696664509108, -99.9095221465675, -1069.724785749781, -588.6037216332893, -818.9163879033687, -1003.529861004522, -824.1391254985165, -303.62801421904004, -64.90113136208177, -810.8467778181449, -1205.3461894715304, -172.62661499227008, -901.2474360989402, -635.8999721849099, -313.99909049571255, -774.8527480224041, -290.2706600386855, -592.9134580063322, -284.4043165376521, -1030.661382300531, -127.53365459037717, -625.1078956398992, -853.7515697465889, -670.5076006989217, -83.1675996964253, -805.1295858273644, -87.42291948494335, -685.3421428564719, -718.3012137506793, -445.9722453609605, -912.105310924323, -906.0710170191264, -479.21433281250467, -1088.4340972669588, -867.292029346119, -956.5719791686086, -166.927081328109, -842.7455268209123, -677.4193212368451, -139.9283980999998, -217.0626569984565, -364.72025869275484, -760.4564729384335, -1179.9332392484923, -855.986428998807, -406.003910395736, -566.8052534772067, -692.6683300447455, -663.0614453871378, -804.2178265587887, -935.9313923079513, -975.9366688366641, -985.4786777494152, -717.7129106738279, -197.2577357240098, -894.1093002509292, -354.9640582140687, -1264.309275697964], "episode_lengths": [115, 150, 150, 150, 150, 150, 67, 150, 44, 150, 150, 150, 150, 150, 150, 150, 90, 150, 70, 150, 95, 150, 150, 150, 150, 110, 150, 150, 150, 58, 150, 150, 150, 150, 120, 41, 150, 150, 96, 150, 150, 110, 150, 77, 150, 129, 150, 150, 150, 101, 41, 150, 150, 150, 150, 150, 99, 150, 85, 150, 150, 150, 75, 150, 150, 150, 65, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 72, 89, 96, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 89, 150, 150, 150], "policy_policy_0_reward": [-557.5599440254724, -1006.1006310888748, -385.19989981057245, -1033.469935288956, -673.7957676147469, -866.7090576742196, -111.8691602229566, -643.4958978937653, -27.156244734370716, -889.874357540167, -1137.2911868404576, -894.4071515905729, -825.6629392560648, -823.2686488663629, -556.0736967812416, -505.7126819990482, -307.2284267046259, -951.8060626270188, -217.54091161686028, -859.0794073305577, -153.94655254581073, -895.0753691386482, -1114.8018267178786, -676.7847703393777, -931.3058464847545, -265.7700967287823, -1071.120784676304, -297.25996422480125, -938.7979504942477, -32.53094640351297, -766.2333750984191, -918.8064677297867, -761.5535599280306, -780.4529310734594, -288.74115120487807, -19.54296862556873, -969.523854189523, -618.3148422646292, -238.8892943028889, -688.5938494432567, -430.3450123434512, -463.19494082331465, -897.2696664509108, -99.9095221465675, -1069.724785749781, -588.6037216332893, -818.9163879033687, -1003.529861004522, -824.1391254985165, -303.62801421904004, -64.90113136208177, -810.8467778181449, -1205.3461894715304, -172.62661499227008, -901.2474360989402, -635.8999721849099, -313.99909049571255, -774.8527480224041, -290.2706600386855, -592.9134580063322, -284.4043165376521, -1030.661382300531, -127.53365459037717, -625.1078956398992, -853.7515697465889, -670.5076006989217, -83.1675996964253, -805.1295858273644, -87.42291948494335, -685.3421428564719, -718.3012137506793, -445.9722453609605, -912.105310924323, -906.0710170191264, -479.21433281250467, -1088.4340972669588, -867.292029346119, -956.5719791686086, -166.927081328109, -842.7455268209123, -677.4193212368451, -139.9283980999998, -217.0626569984565, -364.72025869275484, -760.4564729384335, -1179.9332392484923, -855.986428998807, -406.003910395736, -566.8052534772067, -692.6683300447455, -663.0614453871378, -804.2178265587887, -935.9313923079513, -975.9366688366641, -985.4786777494152, -717.7129106738279, -197.2577357240098, -894.1093002509292, -354.9640582140687, -1264.309275697964]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5631573146759368, "mean_inference_ms": 1.692399895136441, "mean_action_processing_ms": 0.2865890136640717, "mean_env_wait_ms": 3.01514293500375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013191938400268555, "StateBufferConnector_ms": 0.008536338806152344, "ViewRequirementAgentConnector_ms": 0.18979382514953613}, "num_episodes": 29, "episode_return_max": -19.54296862556873, "episode_return_min": -1264.309275697964, "episode_return_mean": -642.5414059009495, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.0290075131003, "num_env_steps_trained_throughput_per_sec": 304.0290075131003, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13050.124, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13050.048, "sample_time_ms": 1064.912, "learn_time_ms": 11905.695, "learn_throughput": 335.974, "synch_weights_time_ms": 78.575}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00014", "date": "2024-08-03_04-50-59", "timestamp": 1722640859, "time_this_iter_s": 13.169220447540283, "time_total_s": 65.31276845932007, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f57e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 65.31276845932007, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.55263157894737, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.06487070967754, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.327270917594433, "policy_loss": -0.010538741271496595, "vf_loss": 8.335868831972281, "vf_explained_var": 0.5258211374282837, "kl": 0.01760389857196666, "entropy": 1.5799773577600718, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -19.54296862556873, "episode_reward_min": -1264.309275697964, "episode_reward_mean": -657.1809481300983, "episode_len_mean": 132.86, "episode_media": {}, "episodes_timesteps_total": 13286, "policy_reward_min": {"policy_0": -1264.309275697964}, "policy_reward_max": {"policy_0": -19.54296862556873}, "policy_reward_mean": {"policy_0": -657.1809481300983}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-766.2333750984191, -918.8064677297867, -761.5535599280306, -780.4529310734594, -288.74115120487807, -19.54296862556873, -969.523854189523, -618.3148422646292, -238.8892943028889, -688.5938494432567, -430.3450123434512, -463.19494082331465, -897.2696664509108, -99.9095221465675, -1069.724785749781, -588.6037216332893, -818.9163879033687, -1003.529861004522, -824.1391254985165, -303.62801421904004, -64.90113136208177, -810.8467778181449, -1205.3461894715304, -172.62661499227008, -901.2474360989402, -635.8999721849099, -313.99909049571255, -774.8527480224041, -290.2706600386855, -592.9134580063322, -284.4043165376521, -1030.661382300531, -127.53365459037717, -625.1078956398992, -853.7515697465889, -670.5076006989217, -83.1675996964253, -805.1295858273644, -87.42291948494335, -685.3421428564719, -718.3012137506793, -445.9722453609605, -912.105310924323, -906.0710170191264, -479.21433281250467, -1088.4340972669588, -867.292029346119, -956.5719791686086, -166.927081328109, -842.7455268209123, -677.4193212368451, -139.9283980999998, -217.0626569984565, -364.72025869275484, -760.4564729384335, -1179.9332392484923, -855.986428998807, -406.003910395736, -566.8052534772067, -692.6683300447455, -663.0614453871378, -804.2178265587887, -935.9313923079513, -975.9366688366641, -985.4786777494152, -717.7129106738279, -197.2577357240098, -894.1093002509292, -354.9640582140687, -1264.309275697964, -346.35375770949054, -318.6654698903293, -365.4533844047813, -748.4555353126872, -951.9250216440457, -42.08411489579019, -713.4940025048077, -910.6027488105905, -1016.4092959668365, -875.2983386605039, -1109.2653415585687, -819.4601038913052, -1011.4950442538571, -494.3931596081277, -138.48654614504693, -852.2155341623308, -759.7557360432352, -1249.6268424171842, -103.57222242286362, -983.6277647122378, -140.67649898493906, -1052.0694396473402, -874.6305005451214, -1163.1694293661624, -191.99859221435509, -954.888053500337, -854.6067724558488, -1152.5512395918859, -40.604117497601884, -878.8157313576812], "episode_lengths": [150, 150, 150, 150, 120, 41, 150, 150, 96, 150, 150, 110, 150, 77, 150, 129, 150, 150, 150, 101, 41, 150, 150, 150, 150, 150, 99, 150, 85, 150, 150, 150, 75, 150, 150, 150, 65, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 72, 89, 96, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 106, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 140, 150, 64, 150, 70, 150, 150, 150, 93, 150, 150, 150, 55, 150], "policy_policy_0_reward": [-766.2333750984191, -918.8064677297867, -761.5535599280306, -780.4529310734594, -288.74115120487807, -19.54296862556873, -969.523854189523, -618.3148422646292, -238.8892943028889, -688.5938494432567, -430.3450123434512, -463.19494082331465, -897.2696664509108, -99.9095221465675, -1069.724785749781, -588.6037216332893, -818.9163879033687, -1003.529861004522, -824.1391254985165, -303.62801421904004, -64.90113136208177, -810.8467778181449, -1205.3461894715304, -172.62661499227008, -901.2474360989402, -635.8999721849099, -313.99909049571255, -774.8527480224041, -290.2706600386855, -592.9134580063322, -284.4043165376521, -1030.661382300531, -127.53365459037717, -625.1078956398992, -853.7515697465889, -670.5076006989217, -83.1675996964253, -805.1295858273644, -87.42291948494335, -685.3421428564719, -718.3012137506793, -445.9722453609605, -912.105310924323, -906.0710170191264, -479.21433281250467, -1088.4340972669588, -867.292029346119, -956.5719791686086, -166.927081328109, -842.7455268209123, -677.4193212368451, -139.9283980999998, -217.0626569984565, -364.72025869275484, -760.4564729384335, -1179.9332392484923, -855.986428998807, -406.003910395736, -566.8052534772067, -692.6683300447455, -663.0614453871378, -804.2178265587887, -935.9313923079513, -975.9366688366641, -985.4786777494152, -717.7129106738279, -197.2577357240098, -894.1093002509292, -354.9640582140687, -1264.309275697964, -346.35375770949054, -318.6654698903293, -365.4533844047813, -748.4555353126872, -951.9250216440457, -42.08411489579019, -713.4940025048077, -910.6027488105905, -1016.4092959668365, -875.2983386605039, -1109.2653415585687, -819.4601038913052, -1011.4950442538571, -494.3931596081277, -138.48654614504693, -852.2155341623308, -759.7557360432352, -1249.6268424171842, -103.57222242286362, -983.6277647122378, -140.67649898493906, -1052.0694396473402, -874.6305005451214, -1163.1694293661624, -191.99859221435509, -954.888053500337, -854.6067724558488, -1152.5512395918859, -40.604117497601884, -878.8157313576812]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5625151271019369, "mean_inference_ms": 1.6907973649965897, "mean_action_processing_ms": 0.28688279829301916, "mean_env_wait_ms": 3.0257286511618595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013257026672363281, "StateBufferConnector_ms": 0.008557319641113281, "ViewRequirementAgentConnector_ms": 0.18974733352661133}, "num_episodes": 30, "episode_return_max": -19.54296862556873, "episode_return_min": -1264.309275697964, "episode_return_mean": -657.1809481300983, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 394.6831915962851, "num_env_steps_trained_throughput_per_sec": 394.6831915962851, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12564.225, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12564.145, "sample_time_ms": 1063.006, "learn_time_ms": 11425.681, "learn_throughput": 350.089, "synch_weights_time_ms": 74.613}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00014", "date": "2024-08-03_04-51-09", "timestamp": 1722640869, "time_this_iter_s": 10.146214246749878, "time_total_s": 75.45898270606995, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f7d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 75.45898270606995, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 19.914285714285715, "ram_util_percent": 27.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.088147219022115, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.358154949049155, "policy_loss": -0.010497069829822674, "vf_loss": 7.36615235855182, "vf_explained_var": 0.6536663039897879, "kl": 0.019247697058502437, "entropy": 1.349886005371809, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -40.604117497601884, "episode_reward_min": -1264.309275697964, "episode_reward_mean": -676.7422373774332, "episode_len_mean": 136.15, "episode_media": {}, "episodes_timesteps_total": 13615, "policy_reward_min": {"policy_0": -1264.309275697964}, "policy_reward_max": {"policy_0": -40.604117497601884}, "policy_reward_mean": {"policy_0": -676.7422373774332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-290.2706600386855, -592.9134580063322, -284.4043165376521, -1030.661382300531, -127.53365459037717, -625.1078956398992, -853.7515697465889, -670.5076006989217, -83.1675996964253, -805.1295858273644, -87.42291948494335, -685.3421428564719, -718.3012137506793, -445.9722453609605, -912.105310924323, -906.0710170191264, -479.21433281250467, -1088.4340972669588, -867.292029346119, -956.5719791686086, -166.927081328109, -842.7455268209123, -677.4193212368451, -139.9283980999998, -217.0626569984565, -364.72025869275484, -760.4564729384335, -1179.9332392484923, -855.986428998807, -406.003910395736, -566.8052534772067, -692.6683300447455, -663.0614453871378, -804.2178265587887, -935.9313923079513, -975.9366688366641, -985.4786777494152, -717.7129106738279, -197.2577357240098, -894.1093002509292, -354.9640582140687, -1264.309275697964, -346.35375770949054, -318.6654698903293, -365.4533844047813, -748.4555353126872, -951.9250216440457, -42.08411489579019, -713.4940025048077, -910.6027488105905, -1016.4092959668365, -875.2983386605039, -1109.2653415585687, -819.4601038913052, -1011.4950442538571, -494.3931596081277, -138.48654614504693, -852.2155341623308, -759.7557360432352, -1249.6268424171842, -103.57222242286362, -983.6277647122378, -140.67649898493906, -1052.0694396473402, -874.6305005451214, -1163.1694293661624, -191.99859221435509, -954.888053500337, -854.6067724558488, -1152.5512395918859, -40.604117497601884, -878.8157313576812, -696.9154287710696, -403.53472592564185, -889.411903067175, -853.177095332383, -546.8081009022042, -886.3923029632664, -860.2447142535224, -376.31052682710197, -288.9084039575419, -742.3686661852629, -900.102102381831, -1137.5254543499682, -149.49563281184564, -926.7208618889525, -420.90668782399393, -267.56377428025843, -515.5501315346046, -339.69268695987523, -1236.8427822988624, -824.4096914773049, -1211.7598614201686, -678.1094465915825, -1219.340588042767, -606.4903944387505, -784.7181409826296, -189.89715620252616, -896.8715749528812, -535.693380188717], "episode_lengths": [85, 150, 150, 150, 75, 150, 150, 150, 65, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 72, 89, 96, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 106, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 140, 150, 64, 150, 70, 150, 150, 150, 93, 150, 150, 150, 55, 150, 150, 150, 150, 150, 121, 150, 150, 128, 119, 150, 150, 150, 113, 150, 150, 124, 150, 150, 150, 150, 150, 130, 150, 150, 150, 110, 148, 150], "policy_policy_0_reward": [-290.2706600386855, -592.9134580063322, -284.4043165376521, -1030.661382300531, -127.53365459037717, -625.1078956398992, -853.7515697465889, -670.5076006989217, -83.1675996964253, -805.1295858273644, -87.42291948494335, -685.3421428564719, -718.3012137506793, -445.9722453609605, -912.105310924323, -906.0710170191264, -479.21433281250467, -1088.4340972669588, -867.292029346119, -956.5719791686086, -166.927081328109, -842.7455268209123, -677.4193212368451, -139.9283980999998, -217.0626569984565, -364.72025869275484, -760.4564729384335, -1179.9332392484923, -855.986428998807, -406.003910395736, -566.8052534772067, -692.6683300447455, -663.0614453871378, -804.2178265587887, -935.9313923079513, -975.9366688366641, -985.4786777494152, -717.7129106738279, -197.2577357240098, -894.1093002509292, -354.9640582140687, -1264.309275697964, -346.35375770949054, -318.6654698903293, -365.4533844047813, -748.4555353126872, -951.9250216440457, -42.08411489579019, -713.4940025048077, -910.6027488105905, -1016.4092959668365, -875.2983386605039, -1109.2653415585687, -819.4601038913052, -1011.4950442538571, -494.3931596081277, -138.48654614504693, -852.2155341623308, -759.7557360432352, -1249.6268424171842, -103.57222242286362, -983.6277647122378, -140.67649898493906, -1052.0694396473402, -874.6305005451214, -1163.1694293661624, -191.99859221435509, -954.888053500337, -854.6067724558488, -1152.5512395918859, -40.604117497601884, -878.8157313576812, -696.9154287710696, -403.53472592564185, -889.411903067175, -853.177095332383, -546.8081009022042, -886.3923029632664, -860.2447142535224, -376.31052682710197, -288.9084039575419, -742.3686661852629, -900.102102381831, -1137.5254543499682, -149.49563281184564, -926.7208618889525, -420.90668782399393, -267.56377428025843, -515.5501315346046, -339.69268695987523, -1236.8427822988624, -824.4096914773049, -1211.7598614201686, -678.1094465915825, -1219.340588042767, -606.4903944387505, -784.7181409826296, -189.89715620252616, -896.8715749528812, -535.693380188717]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5616829804109114, "mean_inference_ms": 1.6922374675952296, "mean_action_processing_ms": 0.28536980190445244, "mean_env_wait_ms": 3.0310724974891237, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01303243637084961, "StateBufferConnector_ms": 0.008466243743896484, "ViewRequirementAgentConnector_ms": 0.1905686855316162}, "num_episodes": 28, "episode_return_max": -40.604117497601884, "episode_return_min": -1264.309275697964, "episode_return_mean": -676.7422373774332, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.4845690050011, "num_env_steps_trained_throughput_per_sec": 299.4845690050011, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12677.378, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12677.298, "sample_time_ms": 1062.289, "learn_time_ms": 11541.591, "learn_throughput": 346.573, "synch_weights_time_ms": 72.564}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00014", "date": "2024-08-03_04-51-22", "timestamp": 1722640882, "time_this_iter_s": 13.368674993515015, "time_total_s": 88.82765769958496, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f76d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 88.82765769958496, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.43684210526316, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 31.741871749361355, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.02536651690801, "policy_loss": -0.016064653226931114, "vf_loss": 7.038383504996697, "vf_explained_var": 0.7228389267499248, "kl": 0.022938006936722863, "entropy": 1.5399336519340674, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -19.691738143945642, "episode_reward_min": -1306.1772326539754, "episode_reward_mean": -699.1061952536703, "episode_len_mean": 136.81, "episode_media": {}, "episodes_timesteps_total": 13681, "policy_reward_min": {"policy_0": -1306.1772326539754}, "policy_reward_max": {"policy_0": -19.691738143945642}, "policy_reward_mean": {"policy_0": -699.1061952536703}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-406.003910395736, -566.8052534772067, -692.6683300447455, -663.0614453871378, -804.2178265587887, -935.9313923079513, -975.9366688366641, -985.4786777494152, -717.7129106738279, -197.2577357240098, -894.1093002509292, -354.9640582140687, -1264.309275697964, -346.35375770949054, -318.6654698903293, -365.4533844047813, -748.4555353126872, -951.9250216440457, -42.08411489579019, -713.4940025048077, -910.6027488105905, -1016.4092959668365, -875.2983386605039, -1109.2653415585687, -819.4601038913052, -1011.4950442538571, -494.3931596081277, -138.48654614504693, -852.2155341623308, -759.7557360432352, -1249.6268424171842, -103.57222242286362, -983.6277647122378, -140.67649898493906, -1052.0694396473402, -874.6305005451214, -1163.1694293661624, -191.99859221435509, -954.888053500337, -854.6067724558488, -1152.5512395918859, -40.604117497601884, -878.8157313576812, -696.9154287710696, -403.53472592564185, -889.411903067175, -853.177095332383, -546.8081009022042, -886.3923029632664, -860.2447142535224, -376.31052682710197, -288.9084039575419, -742.3686661852629, -900.102102381831, -1137.5254543499682, -149.49563281184564, -926.7208618889525, -420.90668782399393, -267.56377428025843, -515.5501315346046, -339.69268695987523, -1236.8427822988624, -824.4096914773049, -1211.7598614201686, -678.1094465915825, -1219.340588042767, -606.4903944387505, -784.7181409826296, -189.89715620252616, -896.8715749528812, -535.693380188717, -299.67175835832376, -114.25242557647054, -612.6927267057438, -869.1871014284438, -1209.7933714816843, -1135.5946469991218, -889.4934995178453, -628.0556536060105, -802.4120990773222, -501.24060209025583, -135.14088292093112, -1099.93679119695, -765.6237059187325, -86.66188968950098, -1122.7195290989514, -542.7609215814949, -917.6472631388722, -793.421995760497, -775.7024237802959, -614.2286380223833, -19.691738143945642, -1306.1772326539754, -891.5126972150105, -1126.1165562750093, -84.32348603026675, -510.2447973434861, -184.50635722835165, -747.5254760586378, -1165.413916161489], "episode_lengths": [150, 150, 150, 150, 146, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 106, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 140, 150, 64, 150, 70, 150, 150, 150, 93, 150, 150, 150, 55, 150, 150, 150, 150, 150, 121, 150, 150, 128, 119, 150, 150, 150, 113, 150, 150, 124, 150, 150, 150, 150, 150, 130, 150, 150, 150, 110, 148, 150, 113, 70, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 87, 150, 150, 150, 150, 150, 143, 51, 150, 150, 150, 64, 150, 85, 150, 150], "policy_policy_0_reward": [-406.003910395736, -566.8052534772067, -692.6683300447455, -663.0614453871378, -804.2178265587887, -935.9313923079513, -975.9366688366641, -985.4786777494152, -717.7129106738279, -197.2577357240098, -894.1093002509292, -354.9640582140687, -1264.309275697964, -346.35375770949054, -318.6654698903293, -365.4533844047813, -748.4555353126872, -951.9250216440457, -42.08411489579019, -713.4940025048077, -910.6027488105905, -1016.4092959668365, -875.2983386605039, -1109.2653415585687, -819.4601038913052, -1011.4950442538571, -494.3931596081277, -138.48654614504693, -852.2155341623308, -759.7557360432352, -1249.6268424171842, -103.57222242286362, -983.6277647122378, -140.67649898493906, -1052.0694396473402, -874.6305005451214, -1163.1694293661624, -191.99859221435509, -954.888053500337, -854.6067724558488, -1152.5512395918859, -40.604117497601884, -878.8157313576812, -696.9154287710696, -403.53472592564185, -889.411903067175, -853.177095332383, -546.8081009022042, -886.3923029632664, -860.2447142535224, -376.31052682710197, -288.9084039575419, -742.3686661852629, -900.102102381831, -1137.5254543499682, -149.49563281184564, -926.7208618889525, -420.90668782399393, -267.56377428025843, -515.5501315346046, -339.69268695987523, -1236.8427822988624, -824.4096914773049, -1211.7598614201686, -678.1094465915825, -1219.340588042767, -606.4903944387505, -784.7181409826296, -189.89715620252616, -896.8715749528812, -535.693380188717, -299.67175835832376, -114.25242557647054, -612.6927267057438, -869.1871014284438, -1209.7933714816843, -1135.5946469991218, -889.4934995178453, -628.0556536060105, -802.4120990773222, -501.24060209025583, -135.14088292093112, -1099.93679119695, -765.6237059187325, -86.66188968950098, -1122.7195290989514, -542.7609215814949, -917.6472631388722, -793.421995760497, -775.7024237802959, -614.2286380223833, -19.691738143945642, -1306.1772326539754, -891.5126972150105, -1126.1165562750093, -84.32348603026675, -510.2447973434861, -184.50635722835165, -747.5254760586378, -1165.413916161489]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5584786249530737, "mean_inference_ms": 1.689693274421635, "mean_action_processing_ms": 0.28436895651438726, "mean_env_wait_ms": 3.0342142604925164, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012783527374267578, "StateBufferConnector_ms": 0.008318662643432617, "ViewRequirementAgentConnector_ms": 0.19175434112548828}, "num_episodes": 29, "episode_return_max": -19.691738143945642, "episode_return_min": -1306.1772326539754, "episode_return_mean": -699.1061952536703, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.69472848037867, "num_env_steps_trained_throughput_per_sec": 370.69472848037867, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12441.526, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12441.448, "sample_time_ms": 1062.373, "learn_time_ms": 11307.506, "learn_throughput": 353.747, "synch_weights_time_ms": 70.729}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00014", "date": "2024-08-03_04-51-33", "timestamp": 1722640893, "time_this_iter_s": 10.80289912223816, "time_total_s": 99.63055682182312, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f5fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 99.63055682182312, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.60625, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.5871657277147, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.9991676385204, "policy_loss": -0.01912679943779949, "vf_loss": 7.013535405198733, "vf_explained_var": 0.8051420204341412, "kl": 0.020748519159982007, "entropy": 1.4655093021690846, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -19.691738143945642, "episode_reward_min": -1306.1772326539754, "episode_reward_mean": -695.4858526813035, "episode_len_mean": 136.41, "episode_media": {}, "episodes_timesteps_total": 13641, "policy_reward_min": {"policy_0": -1306.1772326539754}, "policy_reward_max": {"policy_0": -19.691738143945642}, "policy_reward_mean": {"policy_0": -695.4858526813035}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-759.7557360432352, -1249.6268424171842, -103.57222242286362, -983.6277647122378, -140.67649898493906, -1052.0694396473402, -874.6305005451214, -1163.1694293661624, -191.99859221435509, -954.888053500337, -854.6067724558488, -1152.5512395918859, -40.604117497601884, -878.8157313576812, -696.9154287710696, -403.53472592564185, -889.411903067175, -853.177095332383, -546.8081009022042, -886.3923029632664, -860.2447142535224, -376.31052682710197, -288.9084039575419, -742.3686661852629, -900.102102381831, -1137.5254543499682, -149.49563281184564, -926.7208618889525, -420.90668782399393, -267.56377428025843, -515.5501315346046, -339.69268695987523, -1236.8427822988624, -824.4096914773049, -1211.7598614201686, -678.1094465915825, -1219.340588042767, -606.4903944387505, -784.7181409826296, -189.89715620252616, -896.8715749528812, -535.693380188717, -299.67175835832376, -114.25242557647054, -612.6927267057438, -869.1871014284438, -1209.7933714816843, -1135.5946469991218, -889.4934995178453, -628.0556536060105, -802.4120990773222, -501.24060209025583, -135.14088292093112, -1099.93679119695, -765.6237059187325, -86.66188968950098, -1122.7195290989514, -542.7609215814949, -917.6472631388722, -793.421995760497, -775.7024237802959, -614.2286380223833, -19.691738143945642, -1306.1772326539754, -891.5126972150105, -1126.1165562750093, -84.32348603026675, -510.2447973434861, -184.50635722835165, -747.5254760586378, -1165.413916161489, -159.99855510446574, -939.5895446414077, -1129.6423338197833, -629.4422099398523, -1024.6418411703528, -293.5604377232618, -186.48654429262152, -568.1317091239615, -513.2213117084093, -701.5728136741598, -855.0914727327145, -229.99601064862708, -511.83982402504745, -1053.5604803296626, -823.8288403286103, -261.42050496119856, -864.8749704065776, -836.9166980902954, -1168.7534250274516, -527.3986850355492, -916.1688312333501, -118.76071831433966, -907.172506717196, -402.5305723386051, -1175.0346131718902, -720.605031540897, -943.1079406764876, -1059.8089835726717, -287.32251715141746], "episode_lengths": [140, 150, 64, 150, 70, 150, 150, 150, 93, 150, 150, 150, 55, 150, 150, 150, 150, 150, 121, 150, 150, 128, 119, 150, 150, 150, 113, 150, 150, 124, 150, 150, 150, 150, 150, 130, 150, 150, 150, 110, 148, 150, 113, 70, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 87, 150, 150, 150, 150, 150, 143, 51, 150, 150, 150, 64, 150, 85, 150, 150, 58, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 82, 150, 150, 150, 105, 150, 150, 150, 150, 150, 105, 150, 127, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-759.7557360432352, -1249.6268424171842, -103.57222242286362, -983.6277647122378, -140.67649898493906, -1052.0694396473402, -874.6305005451214, -1163.1694293661624, -191.99859221435509, -954.888053500337, -854.6067724558488, -1152.5512395918859, -40.604117497601884, -878.8157313576812, -696.9154287710696, -403.53472592564185, -889.411903067175, -853.177095332383, -546.8081009022042, -886.3923029632664, -860.2447142535224, -376.31052682710197, -288.9084039575419, -742.3686661852629, -900.102102381831, -1137.5254543499682, -149.49563281184564, -926.7208618889525, -420.90668782399393, -267.56377428025843, -515.5501315346046, -339.69268695987523, -1236.8427822988624, -824.4096914773049, -1211.7598614201686, -678.1094465915825, -1219.340588042767, -606.4903944387505, -784.7181409826296, -189.89715620252616, -896.8715749528812, -535.693380188717, -299.67175835832376, -114.25242557647054, -612.6927267057438, -869.1871014284438, -1209.7933714816843, -1135.5946469991218, -889.4934995178453, -628.0556536060105, -802.4120990773222, -501.24060209025583, -135.14088292093112, -1099.93679119695, -765.6237059187325, -86.66188968950098, -1122.7195290989514, -542.7609215814949, -917.6472631388722, -793.421995760497, -775.7024237802959, -614.2286380223833, -19.691738143945642, -1306.1772326539754, -891.5126972150105, -1126.1165562750093, -84.32348603026675, -510.2447973434861, -184.50635722835165, -747.5254760586378, -1165.413916161489, -159.99855510446574, -939.5895446414077, -1129.6423338197833, -629.4422099398523, -1024.6418411703528, -293.5604377232618, -186.48654429262152, -568.1317091239615, -513.2213117084093, -701.5728136741598, -855.0914727327145, -229.99601064862708, -511.83982402504745, -1053.5604803296626, -823.8288403286103, -261.42050496119856, -864.8749704065776, -836.9166980902954, -1168.7534250274516, -527.3986850355492, -916.1688312333501, -118.76071831433966, -907.172506717196, -402.5305723386051, -1175.0346131718902, -720.605031540897, -943.1079406764876, -1059.8089835726717, -287.32251715141746]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5575055084250659, "mean_inference_ms": 1.6881495623363514, "mean_action_processing_ms": 0.28357345061323086, "mean_env_wait_ms": 3.035605014726453, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012654304504394531, "StateBufferConnector_ms": 0.008889913558959961, "ViewRequirementAgentConnector_ms": 0.19408893585205078}, "num_episodes": 29, "episode_return_max": -19.691738143945642, "episode_return_min": -1306.1772326539754, "episode_return_mean": -695.4858526813035, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.0849006338277, "num_env_steps_trained_throughput_per_sec": 318.0849006338277, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12456.386, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12456.31, "sample_time_ms": 1062.428, "learn_time_ms": 11323.047, "learn_throughput": 353.262, "synch_weights_time_ms": 70.003}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00014", "date": "2024-08-03_04-51-46", "timestamp": 1722640906, "time_this_iter_s": 12.5884850025177, "time_total_s": 112.21904182434082, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30f40e50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 112.21904182434082, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.188888888888886, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.63221759696801, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.795063681900501, "policy_loss": -0.013369137528934516, "vf_loss": 6.8032173203925295, "vf_explained_var": 0.7378066892425219, "kl": 0.015060833429621804, "entropy": 1.5618882428854703, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -19.691738143945642, "episode_reward_min": -1306.1772326539754, "episode_reward_mean": -692.0574276996634, "episode_len_mean": 137.88, "episode_media": {}, "episodes_timesteps_total": 13788, "policy_reward_min": {"policy_0": -1306.1772326539754}, "policy_reward_max": {"policy_0": -19.691738143945642}, "policy_reward_mean": {"policy_0": -692.0574276996634}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-420.90668782399393, -267.56377428025843, -515.5501315346046, -339.69268695987523, -1236.8427822988624, -824.4096914773049, -1211.7598614201686, -678.1094465915825, -1219.340588042767, -606.4903944387505, -784.7181409826296, -189.89715620252616, -896.8715749528812, -535.693380188717, -299.67175835832376, -114.25242557647054, -612.6927267057438, -869.1871014284438, -1209.7933714816843, -1135.5946469991218, -889.4934995178453, -628.0556536060105, -802.4120990773222, -501.24060209025583, -135.14088292093112, -1099.93679119695, -765.6237059187325, -86.66188968950098, -1122.7195290989514, -542.7609215814949, -917.6472631388722, -793.421995760497, -775.7024237802959, -614.2286380223833, -19.691738143945642, -1306.1772326539754, -891.5126972150105, -1126.1165562750093, -84.32348603026675, -510.2447973434861, -184.50635722835165, -747.5254760586378, -1165.413916161489, -159.99855510446574, -939.5895446414077, -1129.6423338197833, -629.4422099398523, -1024.6418411703528, -293.5604377232618, -186.48654429262152, -568.1317091239615, -513.2213117084093, -701.5728136741598, -855.0914727327145, -229.99601064862708, -511.83982402504745, -1053.5604803296626, -823.8288403286103, -261.42050496119856, -864.8749704065776, -836.9166980902954, -1168.7534250274516, -527.3986850355492, -916.1688312333501, -118.76071831433966, -907.172506717196, -402.5305723386051, -1175.0346131718902, -720.605031540897, -943.1079406764876, -1059.8089835726717, -287.32251715141746, -702.5409097274752, -882.0180804625712, -406.98515700850265, -797.7334045813805, -1142.0702529842665, -327.89176126448393, -286.4342686824011, -868.6351307790246, -357.39013418564207, -221.89366256520478, -104.11821001622896, -1294.5753070106468, -1140.49660286217, -788.2465329545977, -861.4781702055577, -447.43348408014447, -406.2662530371775, -1219.2992894985705, -684.8808419044361, -133.86658249584778, -789.7409205398619, -550.4796919162508, -973.2355770864343, -1220.8240622941187, -833.6998114468303, -746.6848585460046, -1023.8259742230906, -502.9214298516184], "episode_lengths": [150, 124, 150, 150, 150, 150, 150, 130, 150, 150, 150, 110, 148, 150, 113, 70, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 87, 150, 150, 150, 150, 150, 143, 51, 150, 150, 150, 64, 150, 85, 150, 150, 58, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 82, 150, 150, 150, 105, 150, 150, 150, 150, 150, 105, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 122, 104, 62, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-420.90668782399393, -267.56377428025843, -515.5501315346046, -339.69268695987523, -1236.8427822988624, -824.4096914773049, -1211.7598614201686, -678.1094465915825, -1219.340588042767, -606.4903944387505, -784.7181409826296, -189.89715620252616, -896.8715749528812, -535.693380188717, -299.67175835832376, -114.25242557647054, -612.6927267057438, -869.1871014284438, -1209.7933714816843, -1135.5946469991218, -889.4934995178453, -628.0556536060105, -802.4120990773222, -501.24060209025583, -135.14088292093112, -1099.93679119695, -765.6237059187325, -86.66188968950098, -1122.7195290989514, -542.7609215814949, -917.6472631388722, -793.421995760497, -775.7024237802959, -614.2286380223833, -19.691738143945642, -1306.1772326539754, -891.5126972150105, -1126.1165562750093, -84.32348603026675, -510.2447973434861, -184.50635722835165, -747.5254760586378, -1165.413916161489, -159.99855510446574, -939.5895446414077, -1129.6423338197833, -629.4422099398523, -1024.6418411703528, -293.5604377232618, -186.48654429262152, -568.1317091239615, -513.2213117084093, -701.5728136741598, -855.0914727327145, -229.99601064862708, -511.83982402504745, -1053.5604803296626, -823.8288403286103, -261.42050496119856, -864.8749704065776, -836.9166980902954, -1168.7534250274516, -527.3986850355492, -916.1688312333501, -118.76071831433966, -907.172506717196, -402.5305723386051, -1175.0346131718902, -720.605031540897, -943.1079406764876, -1059.8089835726717, -287.32251715141746, -702.5409097274752, -882.0180804625712, -406.98515700850265, -797.7334045813805, -1142.0702529842665, -327.89176126448393, -286.4342686824011, -868.6351307790246, -357.39013418564207, -221.89366256520478, -104.11821001622896, -1294.5753070106468, -1140.49660286217, -788.2465329545977, -861.4781702055577, -447.43348408014447, -406.2662530371775, -1219.2992894985705, -684.8808419044361, -133.86658249584778, -789.7409205398619, -550.4796919162508, -973.2355770864343, -1220.8240622941187, -833.6998114468303, -746.6848585460046, -1023.8259742230906, -502.9214298516184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5571775984664127, "mean_inference_ms": 1.6876201963011621, "mean_action_processing_ms": 0.2827768173076073, "mean_env_wait_ms": 3.035959014618885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012423515319824219, "StateBufferConnector_ms": 0.008789539337158203, "ViewRequirementAgentConnector_ms": 0.1952972412109375}, "num_episodes": 28, "episode_return_max": -19.691738143945642, "episode_return_min": -1306.1772326539754, "episode_return_mean": -692.0574276996634, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.82464416519827, "num_env_steps_trained_throughput_per_sec": 297.82464416519827, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12553.821, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12553.744, "sample_time_ms": 1057.743, "learn_time_ms": 11425.601, "learn_throughput": 350.091, "synch_weights_time_ms": 69.578}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00014", "date": "2024-08-03_04-51-59", "timestamp": 1722640919, "time_this_iter_s": 13.442429542541504, "time_total_s": 125.66147136688232, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f76d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 125.66147136688232, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.326315789473682, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 60.29012751281262, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.424996630847454, "policy_loss": -0.011821863098884933, "vf_loss": 6.433083905031284, "vf_explained_var": 0.7951977647220095, "kl": 0.011614581624507991, "entropy": 1.4919674882044396, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -19.691738143945642, "episode_reward_min": -1306.1772326539754, "episode_reward_mean": -703.8383159016028, "episode_len_mean": 138.35, "episode_media": {}, "episodes_timesteps_total": 13835, "policy_reward_min": {"policy_0": -1306.1772326539754}, "policy_reward_max": {"policy_0": -19.691738143945642}, "policy_reward_mean": {"policy_0": -703.8383159016028}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-775.7024237802959, -614.2286380223833, -19.691738143945642, -1306.1772326539754, -891.5126972150105, -1126.1165562750093, -84.32348603026675, -510.2447973434861, -184.50635722835165, -747.5254760586378, -1165.413916161489, -159.99855510446574, -939.5895446414077, -1129.6423338197833, -629.4422099398523, -1024.6418411703528, -293.5604377232618, -186.48654429262152, -568.1317091239615, -513.2213117084093, -701.5728136741598, -855.0914727327145, -229.99601064862708, -511.83982402504745, -1053.5604803296626, -823.8288403286103, -261.42050496119856, -864.8749704065776, -836.9166980902954, -1168.7534250274516, -527.3986850355492, -916.1688312333501, -118.76071831433966, -907.172506717196, -402.5305723386051, -1175.0346131718902, -720.605031540897, -943.1079406764876, -1059.8089835726717, -287.32251715141746, -702.5409097274752, -882.0180804625712, -406.98515700850265, -797.7334045813805, -1142.0702529842665, -327.89176126448393, -286.4342686824011, -868.6351307790246, -357.39013418564207, -221.89366256520478, -104.11821001622896, -1294.5753070106468, -1140.49660286217, -788.2465329545977, -861.4781702055577, -447.43348408014447, -406.2662530371775, -1219.2992894985705, -684.8808419044361, -133.86658249584778, -789.7409205398619, -550.4796919162508, -973.2355770864343, -1220.8240622941187, -833.6998114468303, -746.6848585460046, -1023.8259742230906, -502.9214298516184, -340.67508422492256, -818.8828424015069, -996.9850801249344, -722.6552445335712, -334.9154634204856, -1199.9543202288794, -709.1641502399174, -1165.8247097449187, -677.6081942099576, -955.579613709988, -1043.3291974293586, -753.677527804563, -474.80680374804854, -608.9656955784407, -813.0341732341475, -497.0696066209769, -461.7659541676846, -741.7841544078838, -802.9686130289945, -186.5694399101507, -89.48038235378814, -728.9139929789776, -556.0819683028635, -829.1668029864095, -774.0634998058068, -737.423126039614, -800.5151848063839, -1149.5036950720637, -836.9237201334779, -926.5126752299215, -1029.3345373722284, -668.1065276851555], "episode_lengths": [150, 143, 51, 150, 150, 150, 64, 150, 85, 150, 150, 58, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 82, 150, 150, 150, 105, 150, 150, 150, 150, 150, 105, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 122, 104, 62, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 71, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141], "policy_policy_0_reward": [-775.7024237802959, -614.2286380223833, -19.691738143945642, -1306.1772326539754, -891.5126972150105, -1126.1165562750093, -84.32348603026675, -510.2447973434861, -184.50635722835165, -747.5254760586378, -1165.413916161489, -159.99855510446574, -939.5895446414077, -1129.6423338197833, -629.4422099398523, -1024.6418411703528, -293.5604377232618, -186.48654429262152, -568.1317091239615, -513.2213117084093, -701.5728136741598, -855.0914727327145, -229.99601064862708, -511.83982402504745, -1053.5604803296626, -823.8288403286103, -261.42050496119856, -864.8749704065776, -836.9166980902954, -1168.7534250274516, -527.3986850355492, -916.1688312333501, -118.76071831433966, -907.172506717196, -402.5305723386051, -1175.0346131718902, -720.605031540897, -943.1079406764876, -1059.8089835726717, -287.32251715141746, -702.5409097274752, -882.0180804625712, -406.98515700850265, -797.7334045813805, -1142.0702529842665, -327.89176126448393, -286.4342686824011, -868.6351307790246, -357.39013418564207, -221.89366256520478, -104.11821001622896, -1294.5753070106468, -1140.49660286217, -788.2465329545977, -861.4781702055577, -447.43348408014447, -406.2662530371775, -1219.2992894985705, -684.8808419044361, -133.86658249584778, -789.7409205398619, -550.4796919162508, -973.2355770864343, -1220.8240622941187, -833.6998114468303, -746.6848585460046, -1023.8259742230906, -502.9214298516184, -340.67508422492256, -818.8828424015069, -996.9850801249344, -722.6552445335712, -334.9154634204856, -1199.9543202288794, -709.1641502399174, -1165.8247097449187, -677.6081942099576, -955.579613709988, -1043.3291974293586, -753.677527804563, -474.80680374804854, -608.9656955784407, -813.0341732341475, -497.0696066209769, -461.7659541676846, -741.7841544078838, -802.9686130289945, -186.5694399101507, -89.48038235378814, -728.9139929789776, -556.0819683028635, -829.1668029864095, -774.0634998058068, -737.423126039614, -800.5151848063839, -1149.5036950720637, -836.9237201334779, -926.5126752299215, -1029.3345373722284, -668.1065276851555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555882890493575, "mean_inference_ms": 1.6857189601636324, "mean_action_processing_ms": 0.28164883607598556, "mean_env_wait_ms": 3.037494265759273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012014627456665039, "StateBufferConnector_ms": 0.008833169937133789, "ViewRequirementAgentConnector_ms": 0.19489264488220215}, "num_episodes": 32, "episode_return_max": -19.691738143945642, "episode_return_min": -1306.1772326539754, "episode_return_mean": -703.8383159016028, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.56669342974135, "num_env_steps_trained_throughput_per_sec": 305.56669342974135, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12599.839, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12599.763, "sample_time_ms": 1058.448, "learn_time_ms": 11472.328, "learn_throughput": 348.665, "synch_weights_time_ms": 68.187}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00014", "date": "2024-08-03_04-52-12", "timestamp": 1722640932, "time_this_iter_s": 13.103707790374756, "time_total_s": 138.76517915725708, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f7be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 138.76517915725708, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.822222222222223, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 75.00046216845513, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.7626983076334, "policy_loss": -0.014765032045155143, "vf_loss": 5.771972483893236, "vf_explained_var": 0.8966793684909741, "kl": 0.0154329285040755, "entropy": 1.4539697305609782, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -89.48038235378814, "episode_reward_min": -1403.3344377523388, "episode_reward_mean": -729.9177263691038, "episode_len_mean": 140.64, "episode_media": {}, "episodes_timesteps_total": 14064, "policy_reward_min": {"policy_0": -1403.3344377523388}, "policy_reward_max": {"policy_0": -89.48038235378814}, "policy_reward_mean": {"policy_0": -729.9177263691038}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-527.3986850355492, -916.1688312333501, -118.76071831433966, -907.172506717196, -402.5305723386051, -1175.0346131718902, -720.605031540897, -943.1079406764876, -1059.8089835726717, -287.32251715141746, -702.5409097274752, -882.0180804625712, -406.98515700850265, -797.7334045813805, -1142.0702529842665, -327.89176126448393, -286.4342686824011, -868.6351307790246, -357.39013418564207, -221.89366256520478, -104.11821001622896, -1294.5753070106468, -1140.49660286217, -788.2465329545977, -861.4781702055577, -447.43348408014447, -406.2662530371775, -1219.2992894985705, -684.8808419044361, -133.86658249584778, -789.7409205398619, -550.4796919162508, -973.2355770864343, -1220.8240622941187, -833.6998114468303, -746.6848585460046, -1023.8259742230906, -502.9214298516184, -340.67508422492256, -818.8828424015069, -996.9850801249344, -722.6552445335712, -334.9154634204856, -1199.9543202288794, -709.1641502399174, -1165.8247097449187, -677.6081942099576, -955.579613709988, -1043.3291974293586, -753.677527804563, -474.80680374804854, -608.9656955784407, -813.0341732341475, -497.0696066209769, -461.7659541676846, -741.7841544078838, -802.9686130289945, -186.5694399101507, -89.48038235378814, -728.9139929789776, -556.0819683028635, -829.1668029864095, -774.0634998058068, -737.423126039614, -800.5151848063839, -1149.5036950720637, -836.9237201334779, -926.5126752299215, -1029.3345373722284, -668.1065276851555, -1107.4616746991157, -750.1331129043684, -781.7912430455241, -618.9560929542841, -1403.3344377523388, -808.8083251154578, -1058.092865944677, -901.6258469542131, -145.11362267218414, -741.0173461109174, -448.22030166426913, -845.4711325480613, -817.9992854997577, -767.150835638531, -892.8567607487583, -1105.4530869893983, -282.3550977023787, -1096.7888136258416, -479.05972624159955, -931.9228684908087, -378.4973922653698, -155.83879691416507, -300.0712201850771, -1024.2619208605113, -777.185006345088, -960.5469193599624, -1084.4905342689128, -96.23310878399023, -1261.8759015582782, -763.3406155675804], "episode_lengths": [150, 150, 105, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 122, 104, 62, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 71, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 150, 123, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 139, 150, 150, 150, 150, 71, 150, 150], "policy_policy_0_reward": [-527.3986850355492, -916.1688312333501, -118.76071831433966, -907.172506717196, -402.5305723386051, -1175.0346131718902, -720.605031540897, -943.1079406764876, -1059.8089835726717, -287.32251715141746, -702.5409097274752, -882.0180804625712, -406.98515700850265, -797.7334045813805, -1142.0702529842665, -327.89176126448393, -286.4342686824011, -868.6351307790246, -357.39013418564207, -221.89366256520478, -104.11821001622896, -1294.5753070106468, -1140.49660286217, -788.2465329545977, -861.4781702055577, -447.43348408014447, -406.2662530371775, -1219.2992894985705, -684.8808419044361, -133.86658249584778, -789.7409205398619, -550.4796919162508, -973.2355770864343, -1220.8240622941187, -833.6998114468303, -746.6848585460046, -1023.8259742230906, -502.9214298516184, -340.67508422492256, -818.8828424015069, -996.9850801249344, -722.6552445335712, -334.9154634204856, -1199.9543202288794, -709.1641502399174, -1165.8247097449187, -677.6081942099576, -955.579613709988, -1043.3291974293586, -753.677527804563, -474.80680374804854, -608.9656955784407, -813.0341732341475, -497.0696066209769, -461.7659541676846, -741.7841544078838, -802.9686130289945, -186.5694399101507, -89.48038235378814, -728.9139929789776, -556.0819683028635, -829.1668029864095, -774.0634998058068, -737.423126039614, -800.5151848063839, -1149.5036950720637, -836.9237201334779, -926.5126752299215, -1029.3345373722284, -668.1065276851555, -1107.4616746991157, -750.1331129043684, -781.7912430455241, -618.9560929542841, -1403.3344377523388, -808.8083251154578, -1058.092865944677, -901.6258469542131, -145.11362267218414, -741.0173461109174, -448.22030166426913, -845.4711325480613, -817.9992854997577, -767.150835638531, -892.8567607487583, -1105.4530869893983, -282.3550977023787, -1096.7888136258416, -479.05972624159955, -931.9228684908087, -378.4973922653698, -155.83879691416507, -300.0712201850771, -1024.2619208605113, -777.185006345088, -960.5469193599624, -1084.4905342689128, -96.23310878399023, -1261.8759015582782, -763.3406155675804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552704159249094, "mean_inference_ms": 1.684959002898438, "mean_action_processing_ms": 0.2812866976151599, "mean_env_wait_ms": 3.0375902129788313, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011832714080810547, "StateBufferConnector_ms": 0.008112907409667969, "ViewRequirementAgentConnector_ms": 0.19365954399108887}, "num_episodes": 30, "episode_return_max": -89.48038235378814, "episode_return_min": -1403.3344377523388, "episode_return_mean": -729.9177263691038, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.9353205041401, "num_env_steps_trained_throughput_per_sec": 334.9353205041401, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12482.718, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12482.641, "sample_time_ms": 1063.254, "learn_time_ms": 11349.918, "learn_throughput": 352.425, "synch_weights_time_ms": 68.667}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00014", "date": "2024-08-03_04-52-24", "timestamp": 1722640944, "time_this_iter_s": 11.95590591430664, "time_total_s": 150.72108507156372, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30f42f80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 150.72108507156372, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.21764705882353, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 90.15037769774595, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.236078831801811, "policy_loss": -0.01010097384181184, "vf_loss": 5.241034267594417, "vf_explained_var": 0.9490998234599829, "kl": 0.014311040596536876, "entropy": 1.2944126384332777, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -36.046025073119, "episode_reward_min": -1403.3344377523388, "episode_reward_mean": -700.8950610429621, "episode_len_mean": 136.9, "episode_media": {}, "episodes_timesteps_total": 13690, "policy_reward_min": {"policy_0": -1403.3344377523388}, "policy_reward_max": {"policy_0": -36.046025073119}, "policy_reward_mean": {"policy_0": -700.8950610429621}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-133.86658249584778, -789.7409205398619, -550.4796919162508, -973.2355770864343, -1220.8240622941187, -833.6998114468303, -746.6848585460046, -1023.8259742230906, -502.9214298516184, -340.67508422492256, -818.8828424015069, -996.9850801249344, -722.6552445335712, -334.9154634204856, -1199.9543202288794, -709.1641502399174, -1165.8247097449187, -677.6081942099576, -955.579613709988, -1043.3291974293586, -753.677527804563, -474.80680374804854, -608.9656955784407, -813.0341732341475, -497.0696066209769, -461.7659541676846, -741.7841544078838, -802.9686130289945, -186.5694399101507, -89.48038235378814, -728.9139929789776, -556.0819683028635, -829.1668029864095, -774.0634998058068, -737.423126039614, -800.5151848063839, -1149.5036950720637, -836.9237201334779, -926.5126752299215, -1029.3345373722284, -668.1065276851555, -1107.4616746991157, -750.1331129043684, -781.7912430455241, -618.9560929542841, -1403.3344377523388, -808.8083251154578, -1058.092865944677, -901.6258469542131, -145.11362267218414, -741.0173461109174, -448.22030166426913, -845.4711325480613, -817.9992854997577, -767.150835638531, -892.8567607487583, -1105.4530869893983, -282.3550977023787, -1096.7888136258416, -479.05972624159955, -931.9228684908087, -378.4973922653698, -155.83879691416507, -300.0712201850771, -1024.2619208605113, -777.185006345088, -960.5469193599624, -1084.4905342689128, -96.23310878399023, -1261.8759015582782, -763.3406155675804, -600.2139555515142, -715.8488706576794, -466.8088121604192, -735.9770851076528, -477.53271322814817, -742.840366839906, -46.59827580217393, -861.9958322973714, -63.72883930345394, -622.5888516624597, -449.04319909059166, -591.5567967832206, -1019.8607180198, -136.78717508663235, -798.7515280295498, -94.20396631517269, -959.5032288721326, -112.02811929810679, -36.046025073119, -624.2495848930953, -390.6470971804908, -822.3882422366491, -640.0535006540581, -997.9124284878598, -103.13231862027101, -1080.0805245852848, -915.5577759277912, -937.5247236860828, -1052.5707654980017], "episode_lengths": [65, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 71, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 150, 123, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 139, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 60, 150, 150, 150, 150, 61, 150, 69, 150, 56, 47, 150, 140, 150, 150, 150, 65, 150, 150, 150, 150], "policy_policy_0_reward": [-133.86658249584778, -789.7409205398619, -550.4796919162508, -973.2355770864343, -1220.8240622941187, -833.6998114468303, -746.6848585460046, -1023.8259742230906, -502.9214298516184, -340.67508422492256, -818.8828424015069, -996.9850801249344, -722.6552445335712, -334.9154634204856, -1199.9543202288794, -709.1641502399174, -1165.8247097449187, -677.6081942099576, -955.579613709988, -1043.3291974293586, -753.677527804563, -474.80680374804854, -608.9656955784407, -813.0341732341475, -497.0696066209769, -461.7659541676846, -741.7841544078838, -802.9686130289945, -186.5694399101507, -89.48038235378814, -728.9139929789776, -556.0819683028635, -829.1668029864095, -774.0634998058068, -737.423126039614, -800.5151848063839, -1149.5036950720637, -836.9237201334779, -926.5126752299215, -1029.3345373722284, -668.1065276851555, -1107.4616746991157, -750.1331129043684, -781.7912430455241, -618.9560929542841, -1403.3344377523388, -808.8083251154578, -1058.092865944677, -901.6258469542131, -145.11362267218414, -741.0173461109174, -448.22030166426913, -845.4711325480613, -817.9992854997577, -767.150835638531, -892.8567607487583, -1105.4530869893983, -282.3550977023787, -1096.7888136258416, -479.05972624159955, -931.9228684908087, -378.4973922653698, -155.83879691416507, -300.0712201850771, -1024.2619208605113, -777.185006345088, -960.5469193599624, -1084.4905342689128, -96.23310878399023, -1261.8759015582782, -763.3406155675804, -600.2139555515142, -715.8488706576794, -466.8088121604192, -735.9770851076528, -477.53271322814817, -742.840366839906, -46.59827580217393, -861.9958322973714, -63.72883930345394, -622.5888516624597, -449.04319909059166, -591.5567967832206, -1019.8607180198, -136.78717508663235, -798.7515280295498, -94.20396631517269, -959.5032288721326, -112.02811929810679, -36.046025073119, -624.2495848930953, -390.6470971804908, -822.3882422366491, -640.0535006540581, -997.9124284878598, -103.13231862027101, -1080.0805245852848, -915.5577759277912, -937.5247236860828, -1052.5707654980017]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543744252907946, "mean_inference_ms": 1.6858065534649842, "mean_action_processing_ms": 0.28086338368297153, "mean_env_wait_ms": 3.039759167561741, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011517524719238281, "StateBufferConnector_ms": 0.00802922248840332, "ViewRequirementAgentConnector_ms": 0.1918339729309082}, "num_episodes": 29, "episode_return_max": -36.046025073119, "episode_return_min": -1403.3344377523388, "episode_return_mean": -700.8950610429621, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.14701138427375, "num_env_steps_trained_throughput_per_sec": 295.14701138427375, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12514.405, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12514.326, "sample_time_ms": 1060.111, "learn_time_ms": 11385.553, "learn_throughput": 351.322, "synch_weights_time_ms": 67.867}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00014", "date": "2024-08-03_04-52-38", "timestamp": 1722640958, "time_this_iter_s": 13.564303874969482, "time_total_s": 164.2853889465332, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f7910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.2853889465332, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.16, "ram_util_percent": 27.81499999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 109.15730326672396, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.3777791984379295, "policy_loss": -0.015463275247990774, "vf_loss": 5.387836434940497, "vf_explained_var": 0.9011766472210486, "kl": 0.015355411339684603, "entropy": 1.5038897724201281, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -29.543928803057618, "episode_reward_min": -1403.3344377523388, "episode_reward_mean": -684.0171558140668, "episode_len_mean": 134.79, "episode_media": {}, "episodes_timesteps_total": 13479, "policy_reward_min": {"policy_0": -1403.3344377523388}, "policy_reward_max": {"policy_0": -29.543928803057618}, "policy_reward_mean": {"policy_0": -684.0171558140668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-802.9686130289945, -186.5694399101507, -89.48038235378814, -728.9139929789776, -556.0819683028635, -829.1668029864095, -774.0634998058068, -737.423126039614, -800.5151848063839, -1149.5036950720637, -836.9237201334779, -926.5126752299215, -1029.3345373722284, -668.1065276851555, -1107.4616746991157, -750.1331129043684, -781.7912430455241, -618.9560929542841, -1403.3344377523388, -808.8083251154578, -1058.092865944677, -901.6258469542131, -145.11362267218414, -741.0173461109174, -448.22030166426913, -845.4711325480613, -817.9992854997577, -767.150835638531, -892.8567607487583, -1105.4530869893983, -282.3550977023787, -1096.7888136258416, -479.05972624159955, -931.9228684908087, -378.4973922653698, -155.83879691416507, -300.0712201850771, -1024.2619208605113, -777.185006345088, -960.5469193599624, -1084.4905342689128, -96.23310878399023, -1261.8759015582782, -763.3406155675804, -600.2139555515142, -715.8488706576794, -466.8088121604192, -735.9770851076528, -477.53271322814817, -742.840366839906, -46.59827580217393, -861.9958322973714, -63.72883930345394, -622.5888516624597, -449.04319909059166, -591.5567967832206, -1019.8607180198, -136.78717508663235, -798.7515280295498, -94.20396631517269, -959.5032288721326, -112.02811929810679, -36.046025073119, -624.2495848930953, -390.6470971804908, -822.3882422366491, -640.0535006540581, -997.9124284878598, -103.13231862027101, -1080.0805245852848, -915.5577759277912, -937.5247236860828, -1052.5707654980017, -791.6343335846456, -83.24713261496129, -730.889720247216, -1086.0438307930197, -1351.4770286131552, -959.5809583822786, -582.2742055198665, -826.7335520776518, -750.0894420722278, -801.970909519965, -738.3473668836216, -307.2869206966316, -789.3864424202786, -861.796330180545, -815.841416440022, -378.4519748640342, -752.9383017696251, -1152.3160986373014, -272.41911528730384, -342.1234537577584, -397.6983215439413, -586.965133735508, -1047.2458749793695, -70.1041708494558, -1155.46988689183, -742.2903501754433, -29.543928803057618], "episode_lengths": [150, 71, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 150, 150, 123, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 139, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 60, 150, 150, 150, 150, 61, 150, 69, 150, 56, 47, 150, 140, 150, 150, 150, 65, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 150, 150, 150, 124, 108, 150, 150, 150, 61, 150, 150, 39], "policy_policy_0_reward": [-802.9686130289945, -186.5694399101507, -89.48038235378814, -728.9139929789776, -556.0819683028635, -829.1668029864095, -774.0634998058068, -737.423126039614, -800.5151848063839, -1149.5036950720637, -836.9237201334779, -926.5126752299215, -1029.3345373722284, -668.1065276851555, -1107.4616746991157, -750.1331129043684, -781.7912430455241, -618.9560929542841, -1403.3344377523388, -808.8083251154578, -1058.092865944677, -901.6258469542131, -145.11362267218414, -741.0173461109174, -448.22030166426913, -845.4711325480613, -817.9992854997577, -767.150835638531, -892.8567607487583, -1105.4530869893983, -282.3550977023787, -1096.7888136258416, -479.05972624159955, -931.9228684908087, -378.4973922653698, -155.83879691416507, -300.0712201850771, -1024.2619208605113, -777.185006345088, -960.5469193599624, -1084.4905342689128, -96.23310878399023, -1261.8759015582782, -763.3406155675804, -600.2139555515142, -715.8488706576794, -466.8088121604192, -735.9770851076528, -477.53271322814817, -742.840366839906, -46.59827580217393, -861.9958322973714, -63.72883930345394, -622.5888516624597, -449.04319909059166, -591.5567967832206, -1019.8607180198, -136.78717508663235, -798.7515280295498, -94.20396631517269, -959.5032288721326, -112.02811929810679, -36.046025073119, -624.2495848930953, -390.6470971804908, -822.3882422366491, -640.0535006540581, -997.9124284878598, -103.13231862027101, -1080.0805245852848, -915.5577759277912, -937.5247236860828, -1052.5707654980017, -791.6343335846456, -83.24713261496129, -730.889720247216, -1086.0438307930197, -1351.4770286131552, -959.5809583822786, -582.2742055198665, -826.7335520776518, -750.0894420722278, -801.970909519965, -738.3473668836216, -307.2869206966316, -789.3864424202786, -861.796330180545, -815.841416440022, -378.4519748640342, -752.9383017696251, -1152.3160986373014, -272.41911528730384, -342.1234537577584, -397.6983215439413, -586.965133735508, -1047.2458749793695, -70.1041708494558, -1155.46988689183, -742.2903501754433, -29.543928803057618]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539219220830076, "mean_inference_ms": 1.6868619961814735, "mean_action_processing_ms": 0.28023807349332625, "mean_env_wait_ms": 3.0392303902417965, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011588335037231445, "StateBufferConnector_ms": 0.00783395767211914, "ViewRequirementAgentConnector_ms": 0.1895427703857422}, "num_episodes": 27, "episode_return_max": -29.543928803057618, "episode_return_min": -1403.3344377523388, "episode_return_mean": -684.0171558140668, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.6906862848689, "num_env_steps_trained_throughput_per_sec": 298.6906862848689, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12542.167, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12542.09, "sample_time_ms": 1061.799, "learn_time_ms": 11414.455, "learn_throughput": 350.433, "synch_weights_time_ms": 65.055}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00014", "date": "2024-08-03_04-52-51", "timestamp": 1722640971, "time_this_iter_s": 13.404137372970581, "time_total_s": 177.68952631950378, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f4a60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 177.68952631950378, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.21578947368421, "ram_util_percent": 27.857894736842102}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 95.6933394263188, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.37920789544781, "policy_loss": -0.010650395478781624, "vf_loss": 5.384486721456051, "vf_explained_var": 0.9544567733382185, "kl": 0.015205610622206222, "entropy": 1.4709339597572884, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -29.543928803057618, "episode_reward_min": -1351.4770286131552, "episode_reward_mean": -687.1150613419361, "episode_len_mean": 134.95, "episode_media": {}, "episodes_timesteps_total": 13495, "policy_reward_min": {"policy_0": -1351.4770286131552}, "policy_reward_max": {"policy_0": -29.543928803057618}, "policy_reward_mean": {"policy_0": -687.1150613419361}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1105.4530869893983, -282.3550977023787, -1096.7888136258416, -479.05972624159955, -931.9228684908087, -378.4973922653698, -155.83879691416507, -300.0712201850771, -1024.2619208605113, -777.185006345088, -960.5469193599624, -1084.4905342689128, -96.23310878399023, -1261.8759015582782, -763.3406155675804, -600.2139555515142, -715.8488706576794, -466.8088121604192, -735.9770851076528, -477.53271322814817, -742.840366839906, -46.59827580217393, -861.9958322973714, -63.72883930345394, -622.5888516624597, -449.04319909059166, -591.5567967832206, -1019.8607180198, -136.78717508663235, -798.7515280295498, -94.20396631517269, -959.5032288721326, -112.02811929810679, -36.046025073119, -624.2495848930953, -390.6470971804908, -822.3882422366491, -640.0535006540581, -997.9124284878598, -103.13231862027101, -1080.0805245852848, -915.5577759277912, -937.5247236860828, -1052.5707654980017, -791.6343335846456, -83.24713261496129, -730.889720247216, -1086.0438307930197, -1351.4770286131552, -959.5809583822786, -582.2742055198665, -826.7335520776518, -750.0894420722278, -801.970909519965, -738.3473668836216, -307.2869206966316, -789.3864424202786, -861.796330180545, -815.841416440022, -378.4519748640342, -752.9383017696251, -1152.3160986373014, -272.41911528730384, -342.1234537577584, -397.6983215439413, -586.965133735508, -1047.2458749793695, -70.1041708494558, -1155.46988689183, -742.2903501754433, -29.543928803057618, -842.9507058457965, -1187.0289504657992, -468.2775080084331, -992.3678057895053, -710.5373476253129, -274.51876044098697, -616.4415149202614, -1113.936121637073, -1174.6002041000636, -221.49155528629026, -996.1141830414684, -766.4764651282865, -81.02905360810428, -972.2007076983399, -1109.758789903934, -587.3050406159772, -875.5434537412302, -784.1735345426063, -817.0136529472785, -1059.2942357011161, -1078.8580388112111, -450.2904204283278, -455.36732048985283, -1174.961393660203, -1103.109028473833, -701.8274246485372, -278.695521100355, -1016.7009622453189, -602.5179018397522], "episode_lengths": [150, 150, 150, 150, 150, 150, 57, 139, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 150, 45, 150, 60, 150, 150, 150, 150, 61, 150, 69, 150, 56, 47, 150, 140, 150, 150, 150, 65, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 150, 150, 150, 124, 108, 150, 150, 150, 61, 150, 150, 39, 150, 150, 113, 150, 150, 105, 150, 150, 150, 92, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 104, 150, 150], "policy_policy_0_reward": [-1105.4530869893983, -282.3550977023787, -1096.7888136258416, -479.05972624159955, -931.9228684908087, -378.4973922653698, -155.83879691416507, -300.0712201850771, -1024.2619208605113, -777.185006345088, -960.5469193599624, -1084.4905342689128, -96.23310878399023, -1261.8759015582782, -763.3406155675804, -600.2139555515142, -715.8488706576794, -466.8088121604192, -735.9770851076528, -477.53271322814817, -742.840366839906, -46.59827580217393, -861.9958322973714, -63.72883930345394, -622.5888516624597, -449.04319909059166, -591.5567967832206, -1019.8607180198, -136.78717508663235, -798.7515280295498, -94.20396631517269, -959.5032288721326, -112.02811929810679, -36.046025073119, -624.2495848930953, -390.6470971804908, -822.3882422366491, -640.0535006540581, -997.9124284878598, -103.13231862027101, -1080.0805245852848, -915.5577759277912, -937.5247236860828, -1052.5707654980017, -791.6343335846456, -83.24713261496129, -730.889720247216, -1086.0438307930197, -1351.4770286131552, -959.5809583822786, -582.2742055198665, -826.7335520776518, -750.0894420722278, -801.970909519965, -738.3473668836216, -307.2869206966316, -789.3864424202786, -861.796330180545, -815.841416440022, -378.4519748640342, -752.9383017696251, -1152.3160986373014, -272.41911528730384, -342.1234537577584, -397.6983215439413, -586.965133735508, -1047.2458749793695, -70.1041708494558, -1155.46988689183, -742.2903501754433, -29.543928803057618, -842.9507058457965, -1187.0289504657992, -468.2775080084331, -992.3678057895053, -710.5373476253129, -274.51876044098697, -616.4415149202614, -1113.936121637073, -1174.6002041000636, -221.49155528629026, -996.1141830414684, -766.4764651282865, -81.02905360810428, -972.2007076983399, -1109.758789903934, -587.3050406159772, -875.5434537412302, -784.1735345426063, -817.0136529472785, -1059.2942357011161, -1078.8580388112111, -450.2904204283278, -455.36732048985283, -1174.961393660203, -1103.109028473833, -701.8274246485372, -278.695521100355, -1016.7009622453189, -602.5179018397522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539241495745105, "mean_inference_ms": 1.6857455451907122, "mean_action_processing_ms": 0.27967709065624274, "mean_env_wait_ms": 3.040493512198596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011909961700439453, "StateBufferConnector_ms": 0.008111238479614258, "ViewRequirementAgentConnector_ms": 0.19213008880615234}, "num_episodes": 29, "episode_return_max": -29.543928803057618, "episode_return_min": -1351.4770286131552, "episode_return_mean": -687.1150613419361, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.79849075220153, "num_env_steps_trained_throughput_per_sec": 300.79849075220153, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12556.298, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12556.219, "sample_time_ms": 1069.115, "learn_time_ms": 11421.629, "learn_throughput": 350.213, "synch_weights_time_ms": 64.705}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00014", "date": "2024-08-03_04-53-05", "timestamp": 1722640985, "time_this_iter_s": 13.310196161270142, "time_total_s": 190.99972248077393, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30f42680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 190.99972248077393, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.63157894736842, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.82595517734687, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.5048881530761715, "policy_loss": -0.007675332213693764, "vf_loss": 5.508229334404072, "vf_explained_var": 0.9520576669524113, "kl": 0.013111875651338778, "entropy": 1.5661913881699243, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -29.543928803057618, "episode_reward_min": -1351.4770286131552, "episode_reward_mean": -718.0464490517448, "episode_len_mean": 137.99, "episode_media": {}, "episodes_timesteps_total": 13799, "policy_reward_min": {"policy_0": -1351.4770286131552}, "policy_reward_max": {"policy_0": -29.543928803057618}, "policy_reward_mean": {"policy_0": -718.0464490517448}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-136.78717508663235, -798.7515280295498, -94.20396631517269, -959.5032288721326, -112.02811929810679, -36.046025073119, -624.2495848930953, -390.6470971804908, -822.3882422366491, -640.0535006540581, -997.9124284878598, -103.13231862027101, -1080.0805245852848, -915.5577759277912, -937.5247236860828, -1052.5707654980017, -791.6343335846456, -83.24713261496129, -730.889720247216, -1086.0438307930197, -1351.4770286131552, -959.5809583822786, -582.2742055198665, -826.7335520776518, -750.0894420722278, -801.970909519965, -738.3473668836216, -307.2869206966316, -789.3864424202786, -861.796330180545, -815.841416440022, -378.4519748640342, -752.9383017696251, -1152.3160986373014, -272.41911528730384, -342.1234537577584, -397.6983215439413, -586.965133735508, -1047.2458749793695, -70.1041708494558, -1155.46988689183, -742.2903501754433, -29.543928803057618, -842.9507058457965, -1187.0289504657992, -468.2775080084331, -992.3678057895053, -710.5373476253129, -274.51876044098697, -616.4415149202614, -1113.936121637073, -1174.6002041000636, -221.49155528629026, -996.1141830414684, -766.4764651282865, -81.02905360810428, -972.2007076983399, -1109.758789903934, -587.3050406159772, -875.5434537412302, -784.1735345426063, -817.0136529472785, -1059.2942357011161, -1078.8580388112111, -450.2904204283278, -455.36732048985283, -1174.961393660203, -1103.109028473833, -701.8274246485372, -278.695521100355, -1016.7009622453189, -602.5179018397522, -121.18163359913943, -983.2260224858071, -946.5735615088631, -484.93902421871525, -1009.282992655603, -1057.4876574608377, -384.7090905425904, -667.1487294025274, -628.144288854942, -611.9231254594632, -535.8338525479869, -595.6600437118815, -396.32168025740106, -919.5530369043896, -1054.311039842219, -1158.115460298565, -858.3106814547339, -703.1328533641055, -1323.9623576972197, -1011.8541094919418, -446.6910225661399, -1192.3162083692196, -587.3980594611969, -1117.7537276391865, -606.0795718483239, -594.6247720977922, -595.1856855352839, -593.9338073681297], "episode_lengths": [61, 150, 69, 150, 56, 47, 150, 140, 150, 150, 150, 65, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 150, 150, 150, 124, 108, 150, 150, 150, 61, 150, 150, 39, 150, 150, 113, 150, 150, 105, 150, 150, 150, 92, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 104, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-136.78717508663235, -798.7515280295498, -94.20396631517269, -959.5032288721326, -112.02811929810679, -36.046025073119, -624.2495848930953, -390.6470971804908, -822.3882422366491, -640.0535006540581, -997.9124284878598, -103.13231862027101, -1080.0805245852848, -915.5577759277912, -937.5247236860828, -1052.5707654980017, -791.6343335846456, -83.24713261496129, -730.889720247216, -1086.0438307930197, -1351.4770286131552, -959.5809583822786, -582.2742055198665, -826.7335520776518, -750.0894420722278, -801.970909519965, -738.3473668836216, -307.2869206966316, -789.3864424202786, -861.796330180545, -815.841416440022, -378.4519748640342, -752.9383017696251, -1152.3160986373014, -272.41911528730384, -342.1234537577584, -397.6983215439413, -586.965133735508, -1047.2458749793695, -70.1041708494558, -1155.46988689183, -742.2903501754433, -29.543928803057618, -842.9507058457965, -1187.0289504657992, -468.2775080084331, -992.3678057895053, -710.5373476253129, -274.51876044098697, -616.4415149202614, -1113.936121637073, -1174.6002041000636, -221.49155528629026, -996.1141830414684, -766.4764651282865, -81.02905360810428, -972.2007076983399, -1109.758789903934, -587.3050406159772, -875.5434537412302, -784.1735345426063, -817.0136529472785, -1059.2942357011161, -1078.8580388112111, -450.2904204283278, -455.36732048985283, -1174.961393660203, -1103.109028473833, -701.8274246485372, -278.695521100355, -1016.7009622453189, -602.5179018397522, -121.18163359913943, -983.2260224858071, -946.5735615088631, -484.93902421871525, -1009.282992655603, -1057.4876574608377, -384.7090905425904, -667.1487294025274, -628.144288854942, -611.9231254594632, -535.8338525479869, -595.6600437118815, -396.32168025740106, -919.5530369043896, -1054.311039842219, -1158.115460298565, -858.3106814547339, -703.1328533641055, -1323.9623576972197, -1011.8541094919418, -446.6910225661399, -1192.3162083692196, -587.3980594611969, -1117.7537276391865, -606.0795718483239, -594.6247720977922, -595.1856855352839, -593.9338073681297]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537565403739626, "mean_inference_ms": 1.6858535820959362, "mean_action_processing_ms": 0.2793793288999698, "mean_env_wait_ms": 3.0438420653574614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012403726577758789, "StateBufferConnector_ms": 0.008140325546264648, "ViewRequirementAgentConnector_ms": 0.1948387622833252}, "num_episodes": 28, "episode_return_max": -29.543928803057618, "episode_return_min": -1351.4770286131552, "episode_return_mean": -718.0464490517448, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.2390358786251, "num_env_steps_trained_throughput_per_sec": 361.2390358786251, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12650.126, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12650.05, "sample_time_ms": 1071.991, "learn_time_ms": 11512.602, "learn_throughput": 347.445, "synch_weights_time_ms": 64.684}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00014", "date": "2024-08-03_04-53-16", "timestamp": 1722640996, "time_this_iter_s": 11.08602523803711, "time_total_s": 202.08574771881104, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30f41cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 202.08574771881104, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.450000000000003, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 155.45452257891495, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.32105180422465, "policy_loss": -0.012351320058223791, "vf_loss": 4.328042304515838, "vf_explained_var": 0.9695123858749867, "kl": 0.015235648831033661, "entropy": 1.4952127327521643, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -29.543928803057618, "episode_reward_min": -1323.9623576972197, "episode_reward_mean": -728.6413613105558, "episode_len_mean": 141.59, "episode_media": {}, "episodes_timesteps_total": 14159, "policy_reward_min": {"policy_0": -1323.9623576972197}, "policy_reward_max": {"policy_0": -29.543928803057618}, "policy_reward_mean": {"policy_0": -728.6413613105558}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-307.2869206966316, -789.3864424202786, -861.796330180545, -815.841416440022, -378.4519748640342, -752.9383017696251, -1152.3160986373014, -272.41911528730384, -342.1234537577584, -397.6983215439413, -586.965133735508, -1047.2458749793695, -70.1041708494558, -1155.46988689183, -742.2903501754433, -29.543928803057618, -842.9507058457965, -1187.0289504657992, -468.2775080084331, -992.3678057895053, -710.5373476253129, -274.51876044098697, -616.4415149202614, -1113.936121637073, -1174.6002041000636, -221.49155528629026, -996.1141830414684, -766.4764651282865, -81.02905360810428, -972.2007076983399, -1109.758789903934, -587.3050406159772, -875.5434537412302, -784.1735345426063, -817.0136529472785, -1059.2942357011161, -1078.8580388112111, -450.2904204283278, -455.36732048985283, -1174.961393660203, -1103.109028473833, -701.8274246485372, -278.695521100355, -1016.7009622453189, -602.5179018397522, -121.18163359913943, -983.2260224858071, -946.5735615088631, -484.93902421871525, -1009.282992655603, -1057.4876574608377, -384.7090905425904, -667.1487294025274, -628.144288854942, -611.9231254594632, -535.8338525479869, -595.6600437118815, -396.32168025740106, -919.5530369043896, -1054.311039842219, -1158.115460298565, -858.3106814547339, -703.1328533641055, -1323.9623576972197, -1011.8541094919418, -446.6910225661399, -1192.3162083692196, -587.3980594611969, -1117.7537276391865, -606.0795718483239, -594.6247720977922, -595.1856855352839, -593.9338073681297, -406.3821239580165, -252.73340114140467, -1089.9829815379899, -1224.1872320570667, -180.95804402905884, -1285.680127452078, -222.9148121638213, -975.7882419107253, -311.6054709774441, -273.51515021587346, -897.7613929871129, -804.29553274029, -744.2985841345239, -421.3853162678013, -973.4530655814651, -677.3641447920137, -1144.1442844326316, -374.37032126290984, -713.8897663833136, -615.3795470612404, -876.2290718245749, -1129.7803062151945, -1223.6395836359134, -515.3963103234272, -333.02314490496934, -1106.7981880182406, -688.2605646249109], "episode_lengths": [109, 150, 150, 150, 150, 150, 150, 124, 108, 150, 150, 150, 61, 150, 150, 39, 150, 150, 113, 150, 150, 105, 150, 150, 150, 92, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 104, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 95, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 138, 150, 150], "policy_policy_0_reward": [-307.2869206966316, -789.3864424202786, -861.796330180545, -815.841416440022, -378.4519748640342, -752.9383017696251, -1152.3160986373014, -272.41911528730384, -342.1234537577584, -397.6983215439413, -586.965133735508, -1047.2458749793695, -70.1041708494558, -1155.46988689183, -742.2903501754433, -29.543928803057618, -842.9507058457965, -1187.0289504657992, -468.2775080084331, -992.3678057895053, -710.5373476253129, -274.51876044098697, -616.4415149202614, -1113.936121637073, -1174.6002041000636, -221.49155528629026, -996.1141830414684, -766.4764651282865, -81.02905360810428, -972.2007076983399, -1109.758789903934, -587.3050406159772, -875.5434537412302, -784.1735345426063, -817.0136529472785, -1059.2942357011161, -1078.8580388112111, -450.2904204283278, -455.36732048985283, -1174.961393660203, -1103.109028473833, -701.8274246485372, -278.695521100355, -1016.7009622453189, -602.5179018397522, -121.18163359913943, -983.2260224858071, -946.5735615088631, -484.93902421871525, -1009.282992655603, -1057.4876574608377, -384.7090905425904, -667.1487294025274, -628.144288854942, -611.9231254594632, -535.8338525479869, -595.6600437118815, -396.32168025740106, -919.5530369043896, -1054.311039842219, -1158.115460298565, -858.3106814547339, -703.1328533641055, -1323.9623576972197, -1011.8541094919418, -446.6910225661399, -1192.3162083692196, -587.3980594611969, -1117.7537276391865, -606.0795718483239, -594.6247720977922, -595.1856855352839, -593.9338073681297, -406.3821239580165, -252.73340114140467, -1089.9829815379899, -1224.1872320570667, -180.95804402905884, -1285.680127452078, -222.9148121638213, -975.7882419107253, -311.6054709774441, -273.51515021587346, -897.7613929871129, -804.29553274029, -744.2985841345239, -421.3853162678013, -973.4530655814651, -677.3641447920137, -1144.1442844326316, -374.37032126290984, -713.8897663833136, -615.3795470612404, -876.2290718245749, -1129.7803062151945, -1223.6395836359134, -515.3963103234272, -333.02314490496934, -1106.7981880182406, -688.2605646249109]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539129536328986, "mean_inference_ms": 1.6861902885804252, "mean_action_processing_ms": 0.2792526964003094, "mean_env_wait_ms": 3.0488701834409033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012131929397583008, "StateBufferConnector_ms": 0.008189916610717773, "ViewRequirementAgentConnector_ms": 0.1953296661376953}, "num_episodes": 27, "episode_return_max": -29.543928803057618, "episode_return_min": -1323.9623576972197, "episode_return_mean": -728.6413613105558, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 390.4107129721894, "num_env_steps_trained_throughput_per_sec": 390.4107129721894, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12339.06, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12338.985, "sample_time_ms": 1073.082, "learn_time_ms": 11200.343, "learn_throughput": 357.132, "synch_weights_time_ms": 64.805}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00014", "date": "2024-08-03_04-53-26", "timestamp": 1722641006, "time_this_iter_s": 10.257434129714966, "time_total_s": 212.343181848526, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30f401f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 212.343181848526, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.821428571428573, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 142.3506764004628, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.783285741508007, "policy_loss": -0.013926276780451493, "vf_loss": 4.7924558855593204, "vf_explained_var": 0.9612572019919753, "kl": 0.014116850137118813, "entropy": 1.5964624129235745, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -51.29367701351153, "episode_reward_min": -1366.3490736251092, "episode_reward_mean": -754.19707206069, "episode_len_mean": 144.63, "episode_media": {}, "episodes_timesteps_total": 14463, "policy_reward_min": {"policy_0": -1366.3490736251092}, "policy_reward_max": {"policy_0": -51.29367701351153}, "policy_reward_mean": {"policy_0": -754.19707206069}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-972.2007076983399, -1109.758789903934, -587.3050406159772, -875.5434537412302, -784.1735345426063, -817.0136529472785, -1059.2942357011161, -1078.8580388112111, -450.2904204283278, -455.36732048985283, -1174.961393660203, -1103.109028473833, -701.8274246485372, -278.695521100355, -1016.7009622453189, -602.5179018397522, -121.18163359913943, -983.2260224858071, -946.5735615088631, -484.93902421871525, -1009.282992655603, -1057.4876574608377, -384.7090905425904, -667.1487294025274, -628.144288854942, -611.9231254594632, -535.8338525479869, -595.6600437118815, -396.32168025740106, -919.5530369043896, -1054.311039842219, -1158.115460298565, -858.3106814547339, -703.1328533641055, -1323.9623576972197, -1011.8541094919418, -446.6910225661399, -1192.3162083692196, -587.3980594611969, -1117.7537276391865, -606.0795718483239, -594.6247720977922, -595.1856855352839, -593.9338073681297, -406.3821239580165, -252.73340114140467, -1089.9829815379899, -1224.1872320570667, -180.95804402905884, -1285.680127452078, -222.9148121638213, -975.7882419107253, -311.6054709774441, -273.51515021587346, -897.7613929871129, -804.29553274029, -744.2985841345239, -421.3853162678013, -973.4530655814651, -677.3641447920137, -1144.1442844326316, -374.37032126290984, -713.8897663833136, -615.3795470612404, -876.2290718245749, -1129.7803062151945, -1223.6395836359134, -515.3963103234272, -333.02314490496934, -1106.7981880182406, -688.2605646249109, -648.563943655058, -1238.838413576562, -672.5356813847998, -1103.0389739480743, -443.6446801229003, -437.2828155070228, -808.8805761708892, -94.10574134952338, -1366.3490736251092, -1006.8938570225473, -556.0573607910543, -516.8732833324067, -1274.2438930466367, -51.29367701351153, -840.8503823830669, -674.3396834791478, -841.7306492220969, -717.9474566972938, -1024.3960678619476, -847.3727083366105, -988.3051382821525, -940.8186301574082, -399.85707185695884, -340.29794123204465, -809.9571767619219, -509.58343405527324, -425.4627952417116, -1185.8913488553083, -937.8065169738793], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 104, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 95, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150], "policy_policy_0_reward": [-972.2007076983399, -1109.758789903934, -587.3050406159772, -875.5434537412302, -784.1735345426063, -817.0136529472785, -1059.2942357011161, -1078.8580388112111, -450.2904204283278, -455.36732048985283, -1174.961393660203, -1103.109028473833, -701.8274246485372, -278.695521100355, -1016.7009622453189, -602.5179018397522, -121.18163359913943, -983.2260224858071, -946.5735615088631, -484.93902421871525, -1009.282992655603, -1057.4876574608377, -384.7090905425904, -667.1487294025274, -628.144288854942, -611.9231254594632, -535.8338525479869, -595.6600437118815, -396.32168025740106, -919.5530369043896, -1054.311039842219, -1158.115460298565, -858.3106814547339, -703.1328533641055, -1323.9623576972197, -1011.8541094919418, -446.6910225661399, -1192.3162083692196, -587.3980594611969, -1117.7537276391865, -606.0795718483239, -594.6247720977922, -595.1856855352839, -593.9338073681297, -406.3821239580165, -252.73340114140467, -1089.9829815379899, -1224.1872320570667, -180.95804402905884, -1285.680127452078, -222.9148121638213, -975.7882419107253, -311.6054709774441, -273.51515021587346, -897.7613929871129, -804.29553274029, -744.2985841345239, -421.3853162678013, -973.4530655814651, -677.3641447920137, -1144.1442844326316, -374.37032126290984, -713.8897663833136, -615.3795470612404, -876.2290718245749, -1129.7803062151945, -1223.6395836359134, -515.3963103234272, -333.02314490496934, -1106.7981880182406, -688.2605646249109, -648.563943655058, -1238.838413576562, -672.5356813847998, -1103.0389739480743, -443.6446801229003, -437.2828155070228, -808.8805761708892, -94.10574134952338, -1366.3490736251092, -1006.8938570225473, -556.0573607910543, -516.8732833324067, -1274.2438930466367, -51.29367701351153, -840.8503823830669, -674.3396834791478, -841.7306492220969, -717.9474566972938, -1024.3960678619476, -847.3727083366105, -988.3051382821525, -940.8186301574082, -399.85707185695884, -340.29794123204465, -809.9571767619219, -509.58343405527324, -425.4627952417116, -1185.8913488553083, -937.8065169738793]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541181411514303, "mean_inference_ms": 1.6861316888375293, "mean_action_processing_ms": 0.2795184581620945, "mean_env_wait_ms": 3.0553043078842292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012421846389770508, "StateBufferConnector_ms": 0.008175849914550781, "ViewRequirementAgentConnector_ms": 0.19684648513793945}, "num_episodes": 29, "episode_return_max": -51.29367701351153, "episode_return_min": -1366.3490736251092, "episode_return_mean": -754.19707206069, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 446.7116619185248, "num_env_steps_trained_throughput_per_sec": 446.7116619185248, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12155.437, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12155.361, "sample_time_ms": 1074.264, "learn_time_ms": 11016.797, "learn_throughput": 363.082, "synch_weights_time_ms": 63.547}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00014", "date": "2024-08-03_04-53-35", "timestamp": 1722641015, "time_this_iter_s": 8.966196537017822, "time_total_s": 221.30937838554382, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30f43760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 221.30937838554382, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 20.6, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 154.6994497537613, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.221963830292225, "policy_loss": -0.009745767623341332, "vf_loss": 4.227014909436305, "vf_explained_var": 0.9794779604300856, "kl": 0.013974362383563251, "entropy": 1.5937871972719828, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -51.29367701351153, "episode_reward_min": -1366.3490736251092, "episode_reward_mean": -734.4419567744887, "episode_len_mean": 141.78, "episode_media": {}, "episodes_timesteps_total": 14178, "policy_reward_min": {"policy_0": -1366.3490736251092}, "policy_reward_max": {"policy_0": -51.29367701351153}, "policy_reward_mean": {"policy_0": -734.4419567744887}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1158.115460298565, -858.3106814547339, -703.1328533641055, -1323.9623576972197, -1011.8541094919418, -446.6910225661399, -1192.3162083692196, -587.3980594611969, -1117.7537276391865, -606.0795718483239, -594.6247720977922, -595.1856855352839, -593.9338073681297, -406.3821239580165, -252.73340114140467, -1089.9829815379899, -1224.1872320570667, -180.95804402905884, -1285.680127452078, -222.9148121638213, -975.7882419107253, -311.6054709774441, -273.51515021587346, -897.7613929871129, -804.29553274029, -744.2985841345239, -421.3853162678013, -973.4530655814651, -677.3641447920137, -1144.1442844326316, -374.37032126290984, -713.8897663833136, -615.3795470612404, -876.2290718245749, -1129.7803062151945, -1223.6395836359134, -515.3963103234272, -333.02314490496934, -1106.7981880182406, -688.2605646249109, -648.563943655058, -1238.838413576562, -672.5356813847998, -1103.0389739480743, -443.6446801229003, -437.2828155070228, -808.8805761708892, -94.10574134952338, -1366.3490736251092, -1006.8938570225473, -556.0573607910543, -516.8732833324067, -1274.2438930466367, -51.29367701351153, -840.8503823830669, -674.3396834791478, -841.7306492220969, -717.9474566972938, -1024.3960678619476, -847.3727083366105, -988.3051382821525, -940.8186301574082, -399.85707185695884, -340.29794123204465, -809.9571767619219, -509.58343405527324, -425.4627952417116, -1185.8913488553083, -937.8065169738793, -527.0016169104397, -629.5290067699947, -662.1932425386882, -135.93372317045956, -154.65458606477242, -722.5623148657046, -908.9804050991437, -810.6591305654397, -163.18622151920138, -59.88933835780498, -672.3927228903964, -561.0249425585375, -913.4142665039166, -788.4866200524344, -492.95073185061403, -328.5998212190152, -708.725911611093, -702.1144728246142, -1108.3700791525239, -1141.488442591178, -775.5151983037175, -585.958903074127, -1077.342405213607, -1006.4658198364623, -865.9399483594634, -146.86568431998495, -1102.3360752483904, -821.4300281965579, -949.1307652359292, -1048.2252028056691, -917.0340499702362], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 95, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 91, 60, 150, 150, 150, 82, 57, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1158.115460298565, -858.3106814547339, -703.1328533641055, -1323.9623576972197, -1011.8541094919418, -446.6910225661399, -1192.3162083692196, -587.3980594611969, -1117.7537276391865, -606.0795718483239, -594.6247720977922, -595.1856855352839, -593.9338073681297, -406.3821239580165, -252.73340114140467, -1089.9829815379899, -1224.1872320570667, -180.95804402905884, -1285.680127452078, -222.9148121638213, -975.7882419107253, -311.6054709774441, -273.51515021587346, -897.7613929871129, -804.29553274029, -744.2985841345239, -421.3853162678013, -973.4530655814651, -677.3641447920137, -1144.1442844326316, -374.37032126290984, -713.8897663833136, -615.3795470612404, -876.2290718245749, -1129.7803062151945, -1223.6395836359134, -515.3963103234272, -333.02314490496934, -1106.7981880182406, -688.2605646249109, -648.563943655058, -1238.838413576562, -672.5356813847998, -1103.0389739480743, -443.6446801229003, -437.2828155070228, -808.8805761708892, -94.10574134952338, -1366.3490736251092, -1006.8938570225473, -556.0573607910543, -516.8732833324067, -1274.2438930466367, -51.29367701351153, -840.8503823830669, -674.3396834791478, -841.7306492220969, -717.9474566972938, -1024.3960678619476, -847.3727083366105, -988.3051382821525, -940.8186301574082, -399.85707185695884, -340.29794123204465, -809.9571767619219, -509.58343405527324, -425.4627952417116, -1185.8913488553083, -937.8065169738793, -527.0016169104397, -629.5290067699947, -662.1932425386882, -135.93372317045956, -154.65458606477242, -722.5623148657046, -908.9804050991437, -810.6591305654397, -163.18622151920138, -59.88933835780498, -672.3927228903964, -561.0249425585375, -913.4142665039166, -788.4866200524344, -492.95073185061403, -328.5998212190152, -708.725911611093, -702.1144728246142, -1108.3700791525239, -1141.488442591178, -775.5151983037175, -585.958903074127, -1077.342405213607, -1006.4658198364623, -865.9399483594634, -146.86568431998495, -1102.3360752483904, -821.4300281965579, -949.1307652359292, -1048.2252028056691, -917.0340499702362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541266149135216, "mean_inference_ms": 1.6865371009004997, "mean_action_processing_ms": 0.2796823054374154, "mean_env_wait_ms": 3.0569136818351352, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012141227722167969, "StateBufferConnector_ms": 0.008022785186767578, "ViewRequirementAgentConnector_ms": 0.1937882900238037}, "num_episodes": 31, "episode_return_max": -51.29367701351153, "episode_return_min": -1366.3490736251092, "episode_return_mean": -734.4419567744887, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.48103189614835, "num_env_steps_trained_throughput_per_sec": 302.48103189614835, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12220.308, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12220.231, "sample_time_ms": 1082.76, "learn_time_ms": 11071.71, "learn_throughput": 361.281, "synch_weights_time_ms": 64.972}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00014", "date": "2024-08-03_04-53-49", "timestamp": 1722641029, "time_this_iter_s": 13.236884355545044, "time_total_s": 234.54626274108887, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30f436d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 234.54626274108887, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.710526315789473, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 196.58345315655072, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.702865097671747, "policy_loss": -0.01415688230432958, "vf_loss": 4.712538151194652, "vf_explained_var": 0.9791387308388948, "kl": 0.013824853183238419, "entropy": 1.7373522691428662, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -51.29367701351153, "episode_reward_min": -1366.3490736251092, "episode_reward_mean": -748.4415831441642, "episode_len_mean": 139.19, "episode_media": {}, "episodes_timesteps_total": 13919, "policy_reward_min": {"policy_0": -1366.3490736251092}, "policy_reward_max": {"policy_0": -51.29367701351153}, "policy_reward_mean": {"policy_0": -748.4415831441642}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-973.4530655814651, -677.3641447920137, -1144.1442844326316, -374.37032126290984, -713.8897663833136, -615.3795470612404, -876.2290718245749, -1129.7803062151945, -1223.6395836359134, -515.3963103234272, -333.02314490496934, -1106.7981880182406, -688.2605646249109, -648.563943655058, -1238.838413576562, -672.5356813847998, -1103.0389739480743, -443.6446801229003, -437.2828155070228, -808.8805761708892, -94.10574134952338, -1366.3490736251092, -1006.8938570225473, -556.0573607910543, -516.8732833324067, -1274.2438930466367, -51.29367701351153, -840.8503823830669, -674.3396834791478, -841.7306492220969, -717.9474566972938, -1024.3960678619476, -847.3727083366105, -988.3051382821525, -940.8186301574082, -399.85707185695884, -340.29794123204465, -809.9571767619219, -509.58343405527324, -425.4627952417116, -1185.8913488553083, -937.8065169738793, -527.0016169104397, -629.5290067699947, -662.1932425386882, -135.93372317045956, -154.65458606477242, -722.5623148657046, -908.9804050991437, -810.6591305654397, -163.18622151920138, -59.88933835780498, -672.3927228903964, -561.0249425585375, -913.4142665039166, -788.4866200524344, -492.95073185061403, -328.5998212190152, -708.725911611093, -702.1144728246142, -1108.3700791525239, -1141.488442591178, -775.5151983037175, -585.958903074127, -1077.342405213607, -1006.4658198364623, -865.9399483594634, -146.86568431998495, -1102.3360752483904, -821.4300281965579, -949.1307652359292, -1048.2252028056691, -917.0340499702362, -787.2989588407654, -84.34759872473606, -732.1324657332392, -1165.9315158310783, -716.099071844699, -1194.2814510388716, -931.5880508486348, -1019.8292441033424, -882.3658504187808, -957.3562922569573, -110.492088461301, -100.52975180501986, -1082.5983812990783, -1202.3020648984188, -253.33947029734713, -740.1374288316606, -174.121393903893, -1080.222027247472, -927.7312320095529, -830.376805110744, -1210.2115837400427, -1120.340990920149, -905.85310021507, -955.649756380684, -94.13618240876033, -1013.057611229177, -1008.4789973331144], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 91, 60, 150, 150, 150, 82, 57, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 51, 86, 150, 150, 91, 150, 110, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150], "policy_policy_0_reward": [-973.4530655814651, -677.3641447920137, -1144.1442844326316, -374.37032126290984, -713.8897663833136, -615.3795470612404, -876.2290718245749, -1129.7803062151945, -1223.6395836359134, -515.3963103234272, -333.02314490496934, -1106.7981880182406, -688.2605646249109, -648.563943655058, -1238.838413576562, -672.5356813847998, -1103.0389739480743, -443.6446801229003, -437.2828155070228, -808.8805761708892, -94.10574134952338, -1366.3490736251092, -1006.8938570225473, -556.0573607910543, -516.8732833324067, -1274.2438930466367, -51.29367701351153, -840.8503823830669, -674.3396834791478, -841.7306492220969, -717.9474566972938, -1024.3960678619476, -847.3727083366105, -988.3051382821525, -940.8186301574082, -399.85707185695884, -340.29794123204465, -809.9571767619219, -509.58343405527324, -425.4627952417116, -1185.8913488553083, -937.8065169738793, -527.0016169104397, -629.5290067699947, -662.1932425386882, -135.93372317045956, -154.65458606477242, -722.5623148657046, -908.9804050991437, -810.6591305654397, -163.18622151920138, -59.88933835780498, -672.3927228903964, -561.0249425585375, -913.4142665039166, -788.4866200524344, -492.95073185061403, -328.5998212190152, -708.725911611093, -702.1144728246142, -1108.3700791525239, -1141.488442591178, -775.5151983037175, -585.958903074127, -1077.342405213607, -1006.4658198364623, -865.9399483594634, -146.86568431998495, -1102.3360752483904, -821.4300281965579, -949.1307652359292, -1048.2252028056691, -917.0340499702362, -787.2989588407654, -84.34759872473606, -732.1324657332392, -1165.9315158310783, -716.099071844699, -1194.2814510388716, -931.5880508486348, -1019.8292441033424, -882.3658504187808, -957.3562922569573, -110.492088461301, -100.52975180501986, -1082.5983812990783, -1202.3020648984188, -253.33947029734713, -740.1374288316606, -174.121393903893, -1080.222027247472, -927.7312320095529, -830.376805110744, -1210.2115837400427, -1120.340990920149, -905.85310021507, -955.649756380684, -94.13618240876033, -1013.057611229177, -1008.4789973331144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537869495123412, "mean_inference_ms": 1.6861500179055766, "mean_action_processing_ms": 0.27957347419235457, "mean_env_wait_ms": 3.059176214153047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012158393859863281, "StateBufferConnector_ms": 0.008007049560546875, "ViewRequirementAgentConnector_ms": 0.19263005256652832}, "num_episodes": 27, "episode_return_max": -51.29367701351153, "episode_return_min": -1366.3490736251092, "episode_return_mean": -748.4415831441642, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.85349428309854, "num_env_steps_trained_throughput_per_sec": 310.85349428309854, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12164.015, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12163.94, "sample_time_ms": 1093.015, "learn_time_ms": 11005.673, "learn_throughput": 363.449, "synch_weights_time_ms": 64.464}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00014", "date": "2024-08-03_04-54-02", "timestamp": 1722641042, "time_this_iter_s": 12.879664659500122, "time_total_s": 247.425927400589, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b32766200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 247.425927400589, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.866666666666667, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 173.98800287445385, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.8798474101970593, "policy_loss": -0.012963544709782582, "vf_loss": 3.887561924010515, "vf_explained_var": 0.9826936893785994, "kl": 0.014811980904899732, "entropy": 1.416364423930645, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -13.178139003548226, "episode_reward_min": -1269.369357056724, "episode_reward_mean": -714.1109607570651, "episode_len_mean": 137.87, "episode_media": {}, "episodes_timesteps_total": 13787, "policy_reward_min": {"policy_0": -1269.369357056724}, "policy_reward_max": {"policy_0": -13.178139003548226}, "policy_reward_mean": {"policy_0": -714.1109607570651}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-847.3727083366105, -988.3051382821525, -940.8186301574082, -399.85707185695884, -340.29794123204465, -809.9571767619219, -509.58343405527324, -425.4627952417116, -1185.8913488553083, -937.8065169738793, -527.0016169104397, -629.5290067699947, -662.1932425386882, -135.93372317045956, -154.65458606477242, -722.5623148657046, -908.9804050991437, -810.6591305654397, -163.18622151920138, -59.88933835780498, -672.3927228903964, -561.0249425585375, -913.4142665039166, -788.4866200524344, -492.95073185061403, -328.5998212190152, -708.725911611093, -702.1144728246142, -1108.3700791525239, -1141.488442591178, -775.5151983037175, -585.958903074127, -1077.342405213607, -1006.4658198364623, -865.9399483594634, -146.86568431998495, -1102.3360752483904, -821.4300281965579, -949.1307652359292, -1048.2252028056691, -917.0340499702362, -787.2989588407654, -84.34759872473606, -732.1324657332392, -1165.9315158310783, -716.099071844699, -1194.2814510388716, -931.5880508486348, -1019.8292441033424, -882.3658504187808, -957.3562922569573, -110.492088461301, -100.52975180501986, -1082.5983812990783, -1202.3020648984188, -253.33947029734713, -740.1374288316606, -174.121393903893, -1080.222027247472, -927.7312320095529, -830.376805110744, -1210.2115837400427, -1120.340990920149, -905.85310021507, -955.649756380684, -94.13618240876033, -1013.057611229177, -1008.4789973331144, -935.1549297121724, -13.178139003548226, -1049.1750234408698, -593.6026985951102, -1169.2201539741711, -437.97633116011633, -259.6008804061462, -141.07096068305538, -828.0602702253358, -41.87062455466625, -318.5787058491814, -748.4944373776772, -496.059792345475, -932.6452637515407, -831.274757152976, -910.2957491024783, -768.424603548785, -1002.4835981896089, -507.2193462762883, -303.2596947779371, -495.44189468795634, -196.17349606947454, -871.5332767403987, -1269.369357056724, -736.2874431217336, -892.5401134106473, -694.0967925467694, -558.0885283032603, -545.9781798949061, -609.252449514488, -1036.3733127590278, -1063.7514663080055], "episode_lengths": [150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 91, 60, 150, 150, 150, 82, 57, 150, 150, 150, 150, 134, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 51, 86, 150, 150, 91, 150, 110, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 45, 150, 150, 150, 150, 111, 82, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-847.3727083366105, -988.3051382821525, -940.8186301574082, -399.85707185695884, -340.29794123204465, -809.9571767619219, -509.58343405527324, -425.4627952417116, -1185.8913488553083, -937.8065169738793, -527.0016169104397, -629.5290067699947, -662.1932425386882, -135.93372317045956, -154.65458606477242, -722.5623148657046, -908.9804050991437, -810.6591305654397, -163.18622151920138, -59.88933835780498, -672.3927228903964, -561.0249425585375, -913.4142665039166, -788.4866200524344, -492.95073185061403, -328.5998212190152, -708.725911611093, -702.1144728246142, -1108.3700791525239, -1141.488442591178, -775.5151983037175, -585.958903074127, -1077.342405213607, -1006.4658198364623, -865.9399483594634, -146.86568431998495, -1102.3360752483904, -821.4300281965579, -949.1307652359292, -1048.2252028056691, -917.0340499702362, -787.2989588407654, -84.34759872473606, -732.1324657332392, -1165.9315158310783, -716.099071844699, -1194.2814510388716, -931.5880508486348, -1019.8292441033424, -882.3658504187808, -957.3562922569573, -110.492088461301, -100.52975180501986, -1082.5983812990783, -1202.3020648984188, -253.33947029734713, -740.1374288316606, -174.121393903893, -1080.222027247472, -927.7312320095529, -830.376805110744, -1210.2115837400427, -1120.340990920149, -905.85310021507, -955.649756380684, -94.13618240876033, -1013.057611229177, -1008.4789973331144, -935.1549297121724, -13.178139003548226, -1049.1750234408698, -593.6026985951102, -1169.2201539741711, -437.97633116011633, -259.6008804061462, -141.07096068305538, -828.0602702253358, -41.87062455466625, -318.5787058491814, -748.4944373776772, -496.059792345475, -932.6452637515407, -831.274757152976, -910.2957491024783, -768.424603548785, -1002.4835981896089, -507.2193462762883, -303.2596947779371, -495.44189468795634, -196.17349606947454, -871.5332767403987, -1269.369357056724, -736.2874431217336, -892.5401134106473, -694.0967925467694, -558.0885283032603, -545.9781798949061, -609.252449514488, -1036.3733127590278, -1063.7514663080055]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5535410074550378, "mean_inference_ms": 1.6863341820306192, "mean_action_processing_ms": 0.2793906055406214, "mean_env_wait_ms": 3.0620321354166826, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012021303176879883, "StateBufferConnector_ms": 0.008022546768188477, "ViewRequirementAgentConnector_ms": 0.1930983066558838}, "num_episodes": 32, "episode_return_max": -13.178139003548226, "episode_return_min": -1269.369357056724, "episode_return_mean": -714.1109607570651, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.0077665351383, "num_env_steps_trained_throughput_per_sec": 308.0077665351383, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12153.641, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12153.565, "sample_time_ms": 1095.756, "learn_time_ms": 10993.419, "learn_throughput": 363.854, "synch_weights_time_ms": 63.602}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00014", "date": "2024-08-03_04-54-15", "timestamp": 1722641055, "time_this_iter_s": 13.000144481658936, "time_total_s": 260.4260718822479, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30f42950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 260.4260718822479, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.521052631578947, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 226.53499419291813, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.9773391861468554, "policy_loss": -0.011551948445655096, "vf_loss": 3.9838637920717397, "vf_explained_var": 0.9723416869839032, "kl": 0.014969306001512467, "entropy": 1.7088686647514502, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -13.178139003548226, "episode_reward_min": -1285.9271461894375, "episode_reward_mean": -771.0098893617948, "episode_len_mean": 140.11, "episode_media": {}, "episodes_timesteps_total": 14011, "policy_reward_min": {"policy_0": -1285.9271461894375}, "policy_reward_max": {"policy_0": -13.178139003548226}, "policy_reward_mean": {"policy_0": -771.0098893617948}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-702.1144728246142, -1108.3700791525239, -1141.488442591178, -775.5151983037175, -585.958903074127, -1077.342405213607, -1006.4658198364623, -865.9399483594634, -146.86568431998495, -1102.3360752483904, -821.4300281965579, -949.1307652359292, -1048.2252028056691, -917.0340499702362, -787.2989588407654, -84.34759872473606, -732.1324657332392, -1165.9315158310783, -716.099071844699, -1194.2814510388716, -931.5880508486348, -1019.8292441033424, -882.3658504187808, -957.3562922569573, -110.492088461301, -100.52975180501986, -1082.5983812990783, -1202.3020648984188, -253.33947029734713, -740.1374288316606, -174.121393903893, -1080.222027247472, -927.7312320095529, -830.376805110744, -1210.2115837400427, -1120.340990920149, -905.85310021507, -955.649756380684, -94.13618240876033, -1013.057611229177, -1008.4789973331144, -935.1549297121724, -13.178139003548226, -1049.1750234408698, -593.6026985951102, -1169.2201539741711, -437.97633116011633, -259.6008804061462, -141.07096068305538, -828.0602702253358, -41.87062455466625, -318.5787058491814, -748.4944373776772, -496.059792345475, -932.6452637515407, -831.274757152976, -910.2957491024783, -768.424603548785, -1002.4835981896089, -507.2193462762883, -303.2596947779371, -495.44189468795634, -196.17349606947454, -871.5332767403987, -1269.369357056724, -736.2874431217336, -892.5401134106473, -694.0967925467694, -558.0885283032603, -545.9781798949061, -609.252449514488, -1036.3733127590278, -1063.7514663080055, -1220.3083711377215, -847.6001773526451, -701.1127225881235, -910.7504215995286, -1075.8627951166372, -773.3264056562559, -1097.661358136786, -1285.9271461894375, -711.9321711476041, -899.0545679722273, -437.887507553113, -630.9351903186547, -401.56390879100763, -401.3350842605576, -1052.8945059150535, -1004.3802810678203, -1067.5063923410632, -921.549445177706, -647.0431850272951, -200.89551797130204, -1081.0182419723471, -834.0690541799785, -995.386075841489, -349.4598607043607, -865.9408677449719, -883.1966585324706, -1016.8323104777452], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 51, 86, 150, 150, 91, 150, 110, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 45, 150, 150, 150, 150, 111, 82, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 128, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-702.1144728246142, -1108.3700791525239, -1141.488442591178, -775.5151983037175, -585.958903074127, -1077.342405213607, -1006.4658198364623, -865.9399483594634, -146.86568431998495, -1102.3360752483904, -821.4300281965579, -949.1307652359292, -1048.2252028056691, -917.0340499702362, -787.2989588407654, -84.34759872473606, -732.1324657332392, -1165.9315158310783, -716.099071844699, -1194.2814510388716, -931.5880508486348, -1019.8292441033424, -882.3658504187808, -957.3562922569573, -110.492088461301, -100.52975180501986, -1082.5983812990783, -1202.3020648984188, -253.33947029734713, -740.1374288316606, -174.121393903893, -1080.222027247472, -927.7312320095529, -830.376805110744, -1210.2115837400427, -1120.340990920149, -905.85310021507, -955.649756380684, -94.13618240876033, -1013.057611229177, -1008.4789973331144, -935.1549297121724, -13.178139003548226, -1049.1750234408698, -593.6026985951102, -1169.2201539741711, -437.97633116011633, -259.6008804061462, -141.07096068305538, -828.0602702253358, -41.87062455466625, -318.5787058491814, -748.4944373776772, -496.059792345475, -932.6452637515407, -831.274757152976, -910.2957491024783, -768.424603548785, -1002.4835981896089, -507.2193462762883, -303.2596947779371, -495.44189468795634, -196.17349606947454, -871.5332767403987, -1269.369357056724, -736.2874431217336, -892.5401134106473, -694.0967925467694, -558.0885283032603, -545.9781798949061, -609.252449514488, -1036.3733127590278, -1063.7514663080055, -1220.3083711377215, -847.6001773526451, -701.1127225881235, -910.7504215995286, -1075.8627951166372, -773.3264056562559, -1097.661358136786, -1285.9271461894375, -711.9321711476041, -899.0545679722273, -437.887507553113, -630.9351903186547, -401.56390879100763, -401.3350842605576, -1052.8945059150535, -1004.3802810678203, -1067.5063923410632, -921.549445177706, -647.0431850272951, -200.89551797130204, -1081.0182419723471, -834.0690541799785, -995.386075841489, -349.4598607043607, -865.9408677449719, -883.1966585324706, -1016.8323104777452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553029584494778, "mean_inference_ms": 1.6849121255720991, "mean_action_processing_ms": 0.2789927575961046, "mean_env_wait_ms": 3.0638043912777047, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011860370635986328, "StateBufferConnector_ms": 0.00786280632019043, "ViewRequirementAgentConnector_ms": 0.18970155715942383}, "num_episodes": 27, "episode_return_max": -13.178139003548226, "episode_return_min": -1285.9271461894375, "episode_return_mean": -771.0098893617948, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.52460340886734, "num_env_steps_trained_throughput_per_sec": 304.52460340886734, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12272.903, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12272.827, "sample_time_ms": 1095.96, "learn_time_ms": 11114.52, "learn_throughput": 359.89, "synch_weights_time_ms": 61.558}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00014", "date": "2024-08-03_04-54-28", "timestamp": 1722641068, "time_this_iter_s": 13.14649486541748, "time_total_s": 273.5725667476654, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f5cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 273.5725667476654, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.742105263157896, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 180.20780142943065, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.111366236458222, "policy_loss": -0.014281630073674023, "vf_loss": 4.120880850901206, "vf_explained_var": 0.9834182479108373, "kl": 0.01407684104948809, "entropy": 1.567560281790793, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -6.3388570647596385, "episode_reward_min": -1331.0004521070762, "episode_reward_mean": -761.1455537504069, "episode_len_mean": 139.45, "episode_media": {}, "episodes_timesteps_total": 13945, "policy_reward_min": {"policy_0": -1331.0004521070762}, "policy_reward_max": {"policy_0": -6.3388570647596385}, "policy_reward_mean": {"policy_0": -761.1455537504069}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1082.5983812990783, -1202.3020648984188, -253.33947029734713, -740.1374288316606, -174.121393903893, -1080.222027247472, -927.7312320095529, -830.376805110744, -1210.2115837400427, -1120.340990920149, -905.85310021507, -955.649756380684, -94.13618240876033, -1013.057611229177, -1008.4789973331144, -935.1549297121724, -13.178139003548226, -1049.1750234408698, -593.6026985951102, -1169.2201539741711, -437.97633116011633, -259.6008804061462, -141.07096068305538, -828.0602702253358, -41.87062455466625, -318.5787058491814, -748.4944373776772, -496.059792345475, -932.6452637515407, -831.274757152976, -910.2957491024783, -768.424603548785, -1002.4835981896089, -507.2193462762883, -303.2596947779371, -495.44189468795634, -196.17349606947454, -871.5332767403987, -1269.369357056724, -736.2874431217336, -892.5401134106473, -694.0967925467694, -558.0885283032603, -545.9781798949061, -609.252449514488, -1036.3733127590278, -1063.7514663080055, -1220.3083711377215, -847.6001773526451, -701.1127225881235, -910.7504215995286, -1075.8627951166372, -773.3264056562559, -1097.661358136786, -1285.9271461894375, -711.9321711476041, -899.0545679722273, -437.887507553113, -630.9351903186547, -401.56390879100763, -401.3350842605576, -1052.8945059150535, -1004.3802810678203, -1067.5063923410632, -921.549445177706, -647.0431850272951, -200.89551797130204, -1081.0182419723471, -834.0690541799785, -995.386075841489, -349.4598607043607, -865.9408677449719, -883.1966585324706, -1016.8323104777452, -1138.9197509821238, -496.8057476986066, -1182.127788697582, -1331.0004521070762, -6.3388570647596385, -979.6762783695169, -183.68190906616172, -1070.5121256067223, -282.99636755669803, -970.5825636119005, -573.776479844687, -180.67002943144828, -1237.4563306277769, -581.5001481289023, -825.335172635052, -1177.2231617485693, -824.950106064174, -803.1550881501739, -520.304128367687, -155.98886085441643, -938.7959205267142, -702.7923087803684, -1220.9404710191088, -966.4963808240885, -589.8511016002185, -1002.1583245365448], "episode_lengths": [150, 150, 91, 150, 110, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 45, 150, 150, 150, 150, 111, 82, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 128, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 39, 150, 66, 150, 117, 150, 150, 67, 150, 138, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1082.5983812990783, -1202.3020648984188, -253.33947029734713, -740.1374288316606, -174.121393903893, -1080.222027247472, -927.7312320095529, -830.376805110744, -1210.2115837400427, -1120.340990920149, -905.85310021507, -955.649756380684, -94.13618240876033, -1013.057611229177, -1008.4789973331144, -935.1549297121724, -13.178139003548226, -1049.1750234408698, -593.6026985951102, -1169.2201539741711, -437.97633116011633, -259.6008804061462, -141.07096068305538, -828.0602702253358, -41.87062455466625, -318.5787058491814, -748.4944373776772, -496.059792345475, -932.6452637515407, -831.274757152976, -910.2957491024783, -768.424603548785, -1002.4835981896089, -507.2193462762883, -303.2596947779371, -495.44189468795634, -196.17349606947454, -871.5332767403987, -1269.369357056724, -736.2874431217336, -892.5401134106473, -694.0967925467694, -558.0885283032603, -545.9781798949061, -609.252449514488, -1036.3733127590278, -1063.7514663080055, -1220.3083711377215, -847.6001773526451, -701.1127225881235, -910.7504215995286, -1075.8627951166372, -773.3264056562559, -1097.661358136786, -1285.9271461894375, -711.9321711476041, -899.0545679722273, -437.887507553113, -630.9351903186547, -401.56390879100763, -401.3350842605576, -1052.8945059150535, -1004.3802810678203, -1067.5063923410632, -921.549445177706, -647.0431850272951, -200.89551797130204, -1081.0182419723471, -834.0690541799785, -995.386075841489, -349.4598607043607, -865.9408677449719, -883.1966585324706, -1016.8323104777452, -1138.9197509821238, -496.8057476986066, -1182.127788697582, -1331.0004521070762, -6.3388570647596385, -979.6762783695169, -183.68190906616172, -1070.5121256067223, -282.99636755669803, -970.5825636119005, -573.776479844687, -180.67002943144828, -1237.4563306277769, -581.5001481289023, -825.335172635052, -1177.2231617485693, -824.950106064174, -803.1550881501739, -520.304128367687, -155.98886085441643, -938.7959205267142, -702.7923087803684, -1220.9404710191088, -966.4963808240885, -589.8511016002185, -1002.1583245365448]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5529214500828664, "mean_inference_ms": 1.6854996780502336, "mean_action_processing_ms": 0.2786349698843512, "mean_env_wait_ms": 3.0656727887172877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012098073959350586, "StateBufferConnector_ms": 0.007866382598876953, "ViewRequirementAgentConnector_ms": 0.19126343727111816}, "num_episodes": 26, "episode_return_max": -6.3388570647596385, "episode_return_min": -1331.0004521070762, "episode_return_mean": -761.1455537504069, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.47719289616515, "num_env_steps_trained_throughput_per_sec": 297.47719289616515, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12262.289, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12262.215, "sample_time_ms": 1099.869, "learn_time_ms": 11102.151, "learn_throughput": 360.291, "synch_weights_time_ms": 59.373}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00014", "date": "2024-08-03_04-54-41", "timestamp": 1722641081, "time_this_iter_s": 13.458342552185059, "time_total_s": 287.03090929985046, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30f42e60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 287.03090929985046, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.50526315789474, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 213.6791645069917, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.9279580344756444, "policy_loss": -0.01691092403974229, "vf_loss": 3.938994414359331, "vf_explained_var": 0.9874350730950634, "kl": 0.01651541654261261, "entropy": 1.5574109051376581, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -6.3388570647596385, "episode_reward_min": -1331.0004521070762, "episode_reward_mean": -744.6990006720106, "episode_len_mean": 140.57, "episode_media": {}, "episodes_timesteps_total": 14057, "policy_reward_min": {"policy_0": -1331.0004521070762}, "policy_reward_max": {"policy_0": -6.3388570647596385}, "policy_reward_mean": {"policy_0": -744.6990006720106}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-910.2957491024783, -768.424603548785, -1002.4835981896089, -507.2193462762883, -303.2596947779371, -495.44189468795634, -196.17349606947454, -871.5332767403987, -1269.369357056724, -736.2874431217336, -892.5401134106473, -694.0967925467694, -558.0885283032603, -545.9781798949061, -609.252449514488, -1036.3733127590278, -1063.7514663080055, -1220.3083711377215, -847.6001773526451, -701.1127225881235, -910.7504215995286, -1075.8627951166372, -773.3264056562559, -1097.661358136786, -1285.9271461894375, -711.9321711476041, -899.0545679722273, -437.887507553113, -630.9351903186547, -401.56390879100763, -401.3350842605576, -1052.8945059150535, -1004.3802810678203, -1067.5063923410632, -921.549445177706, -647.0431850272951, -200.89551797130204, -1081.0182419723471, -834.0690541799785, -995.386075841489, -349.4598607043607, -865.9408677449719, -883.1966585324706, -1016.8323104777452, -1138.9197509821238, -496.8057476986066, -1182.127788697582, -1331.0004521070762, -6.3388570647596385, -979.6762783695169, -183.68190906616172, -1070.5121256067223, -282.99636755669803, -970.5825636119005, -573.776479844687, -180.67002943144828, -1237.4563306277769, -581.5001481289023, -825.335172635052, -1177.2231617485693, -824.950106064174, -803.1550881501739, -520.304128367687, -155.98886085441643, -938.7959205267142, -702.7923087803684, -1220.9404710191088, -966.4963808240885, -589.8511016002185, -1002.1583245365448, -1082.4776486515789, -869.4220850230021, -832.6095550103371, -73.53007187948673, -442.0428716042783, -928.1576353221097, -233.92526332095434, -1117.863050655613, -627.5487178345581, -333.4697669250471, -670.154171574325, -851.0707756526389, -1049.484732410551, -533.0076849634413, -724.3884396563933, -725.878442833387, -324.9257721196894, -336.95669750075837, -1036.7269723162956, -221.96329114205835, -965.3000992224308, -215.6184681400229, -292.78891433444187, -857.1131445530879, -782.6679910324752, -955.1106675138997, -859.0288780487679, -86.42138220420057, -702.583485993219, -1017.6280087785199], "episode_lengths": [150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 128, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 39, 150, 66, 150, 117, 150, 150, 67, 150, 138, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 132, 150, 150, 136, 150, 150, 150, 150, 150, 150, 129, 150, 150, 106, 150, 74, 150, 150, 150, 150, 150, 50, 140, 150], "policy_policy_0_reward": [-910.2957491024783, -768.424603548785, -1002.4835981896089, -507.2193462762883, -303.2596947779371, -495.44189468795634, -196.17349606947454, -871.5332767403987, -1269.369357056724, -736.2874431217336, -892.5401134106473, -694.0967925467694, -558.0885283032603, -545.9781798949061, -609.252449514488, -1036.3733127590278, -1063.7514663080055, -1220.3083711377215, -847.6001773526451, -701.1127225881235, -910.7504215995286, -1075.8627951166372, -773.3264056562559, -1097.661358136786, -1285.9271461894375, -711.9321711476041, -899.0545679722273, -437.887507553113, -630.9351903186547, -401.56390879100763, -401.3350842605576, -1052.8945059150535, -1004.3802810678203, -1067.5063923410632, -921.549445177706, -647.0431850272951, -200.89551797130204, -1081.0182419723471, -834.0690541799785, -995.386075841489, -349.4598607043607, -865.9408677449719, -883.1966585324706, -1016.8323104777452, -1138.9197509821238, -496.8057476986066, -1182.127788697582, -1331.0004521070762, -6.3388570647596385, -979.6762783695169, -183.68190906616172, -1070.5121256067223, -282.99636755669803, -970.5825636119005, -573.776479844687, -180.67002943144828, -1237.4563306277769, -581.5001481289023, -825.335172635052, -1177.2231617485693, -824.950106064174, -803.1550881501739, -520.304128367687, -155.98886085441643, -938.7959205267142, -702.7923087803684, -1220.9404710191088, -966.4963808240885, -589.8511016002185, -1002.1583245365448, -1082.4776486515789, -869.4220850230021, -832.6095550103371, -73.53007187948673, -442.0428716042783, -928.1576353221097, -233.92526332095434, -1117.863050655613, -627.5487178345581, -333.4697669250471, -670.154171574325, -851.0707756526389, -1049.484732410551, -533.0076849634413, -724.3884396563933, -725.878442833387, -324.9257721196894, -336.95669750075837, -1036.7269723162956, -221.96329114205835, -965.3000992224308, -215.6184681400229, -292.78891433444187, -857.1131445530879, -782.6679910324752, -955.1106675138997, -859.0288780487679, -86.42138220420057, -702.583485993219, -1017.6280087785199]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531517902949854, "mean_inference_ms": 1.6848673357989383, "mean_action_processing_ms": 0.2785865024108013, "mean_env_wait_ms": 3.066768900575201, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012054204940795898, "StateBufferConnector_ms": 0.007937908172607422, "ViewRequirementAgentConnector_ms": 0.19439458847045898}, "num_episodes": 30, "episode_return_max": -6.3388570647596385, "episode_return_min": -1331.0004521070762, "episode_return_mean": -744.6990006720106, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.8078748863334, "num_env_steps_trained_throughput_per_sec": 300.8078748863334, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12252.864, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12252.788, "sample_time_ms": 1103.624, "learn_time_ms": 11087.742, "learn_throughput": 360.759, "synch_weights_time_ms": 60.602}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00014", "date": "2024-08-03_04-54-55", "timestamp": 1722641095, "time_this_iter_s": 13.309823751449585, "time_total_s": 300.34073305130005, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa0550>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 300.34073305130005, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.65263157894737, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 224.8977120200793, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.7891827382147314, "policy_loss": -0.013345813092504008, "vf_loss": 3.798155332605044, "vf_explained_var": 0.9862504357472062, "kl": 0.013276526819618084, "entropy": 1.6012256141752004, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -6.3388570647596385, "episode_reward_min": -1331.0004521070762, "episode_reward_mean": -720.1921256375158, "episode_len_mean": 138.21, "episode_media": {}, "episodes_timesteps_total": 13821, "policy_reward_min": {"policy_0": -1331.0004521070762}, "policy_reward_max": {"policy_0": -6.3388570647596385}, "policy_reward_mean": {"policy_0": -720.1921256375158}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-401.3350842605576, -1052.8945059150535, -1004.3802810678203, -1067.5063923410632, -921.549445177706, -647.0431850272951, -200.89551797130204, -1081.0182419723471, -834.0690541799785, -995.386075841489, -349.4598607043607, -865.9408677449719, -883.1966585324706, -1016.8323104777452, -1138.9197509821238, -496.8057476986066, -1182.127788697582, -1331.0004521070762, -6.3388570647596385, -979.6762783695169, -183.68190906616172, -1070.5121256067223, -282.99636755669803, -970.5825636119005, -573.776479844687, -180.67002943144828, -1237.4563306277769, -581.5001481289023, -825.335172635052, -1177.2231617485693, -824.950106064174, -803.1550881501739, -520.304128367687, -155.98886085441643, -938.7959205267142, -702.7923087803684, -1220.9404710191088, -966.4963808240885, -589.8511016002185, -1002.1583245365448, -1082.4776486515789, -869.4220850230021, -832.6095550103371, -73.53007187948673, -442.0428716042783, -928.1576353221097, -233.92526332095434, -1117.863050655613, -627.5487178345581, -333.4697669250471, -670.154171574325, -851.0707756526389, -1049.484732410551, -533.0076849634413, -724.3884396563933, -725.878442833387, -324.9257721196894, -336.95669750075837, -1036.7269723162956, -221.96329114205835, -965.3000992224308, -215.6184681400229, -292.78891433444187, -857.1131445530879, -782.6679910324752, -955.1106675138997, -859.0288780487679, -86.42138220420057, -702.583485993219, -1017.6280087785199, -1214.5431454951563, -903.6071985832906, -615.8557253604264, -255.58791636078894, -913.3542867475037, -381.18085544252375, -981.4610580900495, -205.43501154152062, -538.9219464194414, -74.92154418239254, -605.3310623253117, -1129.2863060185557, -893.0189811729703, -951.6026096471235, -717.0050666328377, -666.6278087162202, -812.0427157209526, -981.6250085087318, -699.9929291840698, -1321.7641601450164, -474.13687126348333, -1092.7517409669417, -378.9511049992949, -267.16853835286014, -42.092885951560234, -893.0751439000338, -202.34313248567966, -854.8297292532956, -1253.6540269422983, -681.6360320084451], "episode_lengths": [128, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 39, 150, 66, 150, 117, 150, 150, 67, 150, 138, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 132, 150, 150, 136, 150, 150, 150, 150, 150, 150, 129, 150, 150, 106, 150, 74, 150, 150, 150, 150, 150, 50, 140, 150, 150, 150, 150, 150, 150, 148, 150, 104, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 56, 150, 98, 150, 150, 150], "policy_policy_0_reward": [-401.3350842605576, -1052.8945059150535, -1004.3802810678203, -1067.5063923410632, -921.549445177706, -647.0431850272951, -200.89551797130204, -1081.0182419723471, -834.0690541799785, -995.386075841489, -349.4598607043607, -865.9408677449719, -883.1966585324706, -1016.8323104777452, -1138.9197509821238, -496.8057476986066, -1182.127788697582, -1331.0004521070762, -6.3388570647596385, -979.6762783695169, -183.68190906616172, -1070.5121256067223, -282.99636755669803, -970.5825636119005, -573.776479844687, -180.67002943144828, -1237.4563306277769, -581.5001481289023, -825.335172635052, -1177.2231617485693, -824.950106064174, -803.1550881501739, -520.304128367687, -155.98886085441643, -938.7959205267142, -702.7923087803684, -1220.9404710191088, -966.4963808240885, -589.8511016002185, -1002.1583245365448, -1082.4776486515789, -869.4220850230021, -832.6095550103371, -73.53007187948673, -442.0428716042783, -928.1576353221097, -233.92526332095434, -1117.863050655613, -627.5487178345581, -333.4697669250471, -670.154171574325, -851.0707756526389, -1049.484732410551, -533.0076849634413, -724.3884396563933, -725.878442833387, -324.9257721196894, -336.95669750075837, -1036.7269723162956, -221.96329114205835, -965.3000992224308, -215.6184681400229, -292.78891433444187, -857.1131445530879, -782.6679910324752, -955.1106675138997, -859.0288780487679, -86.42138220420057, -702.583485993219, -1017.6280087785199, -1214.5431454951563, -903.6071985832906, -615.8557253604264, -255.58791636078894, -913.3542867475037, -381.18085544252375, -981.4610580900495, -205.43501154152062, -538.9219464194414, -74.92154418239254, -605.3310623253117, -1129.2863060185557, -893.0189811729703, -951.6026096471235, -717.0050666328377, -666.6278087162202, -812.0427157209526, -981.6250085087318, -699.9929291840698, -1321.7641601450164, -474.13687126348333, -1092.7517409669417, -378.9511049992949, -267.16853835286014, -42.092885951560234, -893.0751439000338, -202.34313248567966, -854.8297292532956, -1253.6540269422983, -681.6360320084451]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534979232628637, "mean_inference_ms": 1.6859529834617748, "mean_action_processing_ms": 0.27893947336256064, "mean_env_wait_ms": 3.0703194242771947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011852502822875977, "StateBufferConnector_ms": 0.007993459701538086, "ViewRequirementAgentConnector_ms": 0.1960742473602295}, "num_episodes": 30, "episode_return_max": -6.3388570647596385, "episode_return_min": -1331.0004521070762, "episode_return_mean": -720.1921256375158, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.0187382472905, "num_env_steps_trained_throughput_per_sec": 297.0187382472905, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12269.786, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12269.713, "sample_time_ms": 1096.431, "learn_time_ms": 11111.446, "learn_throughput": 359.989, "synch_weights_time_ms": 61.017}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00014", "date": "2024-08-03_04-55-08", "timestamp": 1722641108, "time_this_iter_s": 13.479805707931519, "time_total_s": 313.82053875923157, "pid": 481292, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30f420e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 313.82053875923157, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.621052631578948, "ram_util_percent": 27.899999999999995}}
