{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0142193941399456, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.53502079943816, "policy_loss": -0.008969277436942017, "vf_loss": 9.541698016722997, "vf_explained_var": 0.003960067840913932, "kl": 0.01153165990256942, "entropy": 1.421284500633677, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -55.513053758024526, "episode_reward_min": -1117.5742261431312, "episode_reward_mean": -608.6089986448225, "episode_len_mean": 132.66666666666666, "episode_media": {}, "episodes_timesteps_total": 3184, "policy_reward_min": {"policy_0": -1117.5742261431312}, "policy_reward_max": {"policy_0": -55.513053758024526}, "policy_reward_mean": {"policy_0": -608.6089986448225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-345.01856359890706, -1117.5742261431312, -998.0879335497019, -169.99599869410324, -519.5468602040742, -110.57695446754192, -342.40681372042053, -281.64163082039556, -931.5682192215725, -787.880562276675, -451.6766933373187, -797.5377214219635, -55.513053758024526, -357.84220314835625, -758.7364011670649, -829.151216136518, -845.9861270307342, -568.3232931756357, -540.8727803173606, -1007.3869605954444, -704.9017186632796, -512.4003550325956, -765.5450158730773, -806.4446651218439], "episode_lengths": [136, 150, 150, 109, 150, 60, 89, 114, 150, 150, 119, 150, 54, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-345.01856359890706, -1117.5742261431312, -998.0879335497019, -169.99599869410324, -519.5468602040742, -110.57695446754192, -342.40681372042053, -281.64163082039556, -931.5682192215725, -787.880562276675, -451.6766933373187, -797.5377214219635, -55.513053758024526, -357.84220314835625, -758.7364011670649, -829.151216136518, -845.9861270307342, -568.3232931756357, -540.8727803173606, -1007.3869605954444, -704.9017186632796, -512.4003550325956, -765.5450158730773, -806.4446651218439]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5829100045729806, "mean_inference_ms": 1.748141427475961, "mean_action_processing_ms": 0.2897163016847006, "mean_env_wait_ms": 3.0296609769705287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011931856473286947, "StateBufferConnector_ms": 0.008066495259602865, "ViewRequirementAgentConnector_ms": 0.1784255107243856}, "num_episodes": 24, "episode_return_max": -55.513053758024526, "episode_return_min": -1117.5742261431312, "episode_return_mean": -608.6089986448225, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 358.5885314660324, "num_env_steps_trained_throughput_per_sec": 358.5885314660324, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 11154.856, "restore_workers_time_ms": 0.025, "training_step_time_ms": 11154.793, "sample_time_ms": 1211.985, "learn_time_ms": 9879.951, "learn_throughput": 404.86, "synch_weights_time_ms": 62.12}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00012", "date": "2024-08-03_04-14-26", "timestamp": 1722638666, "time_this_iter_s": 11.167357683181763, "time_total_s": 11.167357683181763, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad3400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 11.167357683181763, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 39.5375, "ram_util_percent": 47.23125}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2045147382964692, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.37552869419257, "policy_loss": -0.008307085220197526, "vf_loss": 9.381792256236077, "vf_explained_var": 0.008870027959346771, "kl": 0.010287323906019689, "entropy": 1.3944544591009618, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -55.513053758024526, "episode_reward_min": -1230.761193906524, "episode_reward_mean": -655.9416189609307, "episode_len_mean": 134.41666666666666, "episode_media": {}, "episodes_timesteps_total": 6452, "policy_reward_min": {"policy_0": -1230.761193906524}, "policy_reward_max": {"policy_0": -55.513053758024526}, "policy_reward_mean": {"policy_0": -655.9416189609307}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-345.01856359890706, -1117.5742261431312, -998.0879335497019, -169.99599869410324, -519.5468602040742, -110.57695446754192, -342.40681372042053, -281.64163082039556, -931.5682192215725, -787.880562276675, -451.6766933373187, -797.5377214219635, -55.513053758024526, -357.84220314835625, -758.7364011670649, -829.151216136518, -845.9861270307342, -568.3232931756357, -540.8727803173606, -1007.3869605954444, -704.9017186632796, -512.4003550325956, -765.5450158730773, -806.4446651218439, -756.5621820561638, -452.1273911180301, -794.7269680405694, -1122.841322301895, -634.3234539205657, -1230.761193906524, -795.8013076860851, -604.0058293295664, -115.74818948126453, -932.0902835413095, -882.3665277315796, -949.114411162276, -879.0611880360844, -511.5176328504201, -779.6243214183207, -371.0687099311337, -805.7037858617898, -972.6347982008208, -749.616356510958, -365.60114866582757, -732.2254131738266, -910.1145919197984, -173.3364688533172, -357.60826695080476], "episode_lengths": [136, 150, 150, 109, 150, 60, 89, 114, 150, 150, 119, 150, 54, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 133, 150, 105, 150, 150, 150, 96, 150, 150, 75, 102], "policy_policy_0_reward": [-345.01856359890706, -1117.5742261431312, -998.0879335497019, -169.99599869410324, -519.5468602040742, -110.57695446754192, -342.40681372042053, -281.64163082039556, -931.5682192215725, -787.880562276675, -451.6766933373187, -797.5377214219635, -55.513053758024526, -357.84220314835625, -758.7364011670649, -829.151216136518, -845.9861270307342, -568.3232931756357, -540.8727803173606, -1007.3869605954444, -704.9017186632796, -512.4003550325956, -765.5450158730773, -806.4446651218439, -756.5621820561638, -452.1273911180301, -794.7269680405694, -1122.841322301895, -634.3234539205657, -1230.761193906524, -795.8013076860851, -604.0058293295664, -115.74818948126453, -932.0902835413095, -882.3665277315796, -949.114411162276, -879.0611880360844, -511.5176328504201, -779.6243214183207, -371.0687099311337, -805.7037858617898, -972.6347982008208, -749.616356510958, -365.60114866582757, -732.2254131738266, -910.1145919197984, -173.3364688533172, -357.60826695080476]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5841619328522211, "mean_inference_ms": 1.7600097105972807, "mean_action_processing_ms": 0.2903011241032189, "mean_env_wait_ms": 3.0558373791244464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014263391494750977, "StateBufferConnector_ms": 0.008444984753926596, "ViewRequirementAgentConnector_ms": 0.18475105365117392}, "num_episodes": 24, "episode_return_max": -55.513053758024526, "episode_return_min": -1230.761193906524, "episode_return_mean": -655.9416189609307, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.9854728786122, "num_env_steps_trained_throughput_per_sec": 292.9854728786122, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12403.715, "restore_workers_time_ms": 0.039, "training_step_time_ms": 12403.627, "sample_time_ms": 1220.999, "learn_time_ms": 11118.834, "learn_throughput": 359.75, "synch_weights_time_ms": 63.033}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00012", "date": "2024-08-03_04-14-39", "timestamp": 1722638679, "time_this_iter_s": 13.664348363876343, "time_total_s": 24.831706047058105, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad2170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24.831706047058105, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 22.589999999999996, "ram_util_percent": 47.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8202083985010782, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.355472991863886, "policy_loss": -0.008416308758508724, "vf_loss": 9.36139491001765, "vf_explained_var": 0.07440812264879544, "kl": 0.012539303657831628, "entropy": 1.3475694742053748, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -55.513053758024526, "episode_reward_min": -1230.761193906524, "episode_reward_mean": -607.2650326516762, "episode_len_mean": 132.10256410256412, "episode_media": {}, "episodes_timesteps_total": 10304, "policy_reward_min": {"policy_0": -1230.761193906524}, "policy_reward_max": {"policy_0": -55.513053758024526}, "policy_reward_mean": {"policy_0": -607.2650326516762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-345.01856359890706, -1117.5742261431312, -998.0879335497019, -169.99599869410324, -519.5468602040742, -110.57695446754192, -342.40681372042053, -281.64163082039556, -931.5682192215725, -787.880562276675, -451.6766933373187, -797.5377214219635, -55.513053758024526, -357.84220314835625, -758.7364011670649, -829.151216136518, -845.9861270307342, -568.3232931756357, -540.8727803173606, -1007.3869605954444, -704.9017186632796, -512.4003550325956, -765.5450158730773, -806.4446651218439, -756.5621820561638, -452.1273911180301, -794.7269680405694, -1122.841322301895, -634.3234539205657, -1230.761193906524, -795.8013076860851, -604.0058293295664, -115.74818948126453, -932.0902835413095, -882.3665277315796, -949.114411162276, -879.0611880360844, -511.5176328504201, -779.6243214183207, -371.0687099311337, -805.7037858617898, -972.6347982008208, -749.616356510958, -365.60114866582757, -732.2254131738266, -910.1145919197984, -173.3364688533172, -357.60826695080476, -365.73507797728695, -130.74796689751219, -524.2468963790368, -322.87423414490024, -668.0521055836431, -546.6989379414015, -76.53837220459538, -603.1229328615617, -117.7809106209755, -359.8460325367731, -650.8209628573446, -1158.3939294312793, -835.7089858515219, -897.0095679265548, -403.986326821066, -545.863637652754, -826.1605277227776, -998.8288467425261, -366.76516169712613, -536.044372417414, -494.869585054349, -170.67387853006582, -994.310200634017, -788.8793245628893, -728.7843055277025, -131.29270136981668, -417.2390869292268, -935.4805195220612, -181.72388124069258, -102.9955670671962], "episode_lengths": [136, 150, 150, 109, 150, 60, 89, 114, 150, 150, 119, 150, 54, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 133, 150, 105, 150, 150, 150, 96, 150, 150, 75, 102, 150, 87, 136, 150, 150, 150, 92, 150, 60, 100, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 146, 64, 150, 150, 150, 66, 150, 150, 68, 87], "policy_policy_0_reward": [-345.01856359890706, -1117.5742261431312, -998.0879335497019, -169.99599869410324, -519.5468602040742, -110.57695446754192, -342.40681372042053, -281.64163082039556, -931.5682192215725, -787.880562276675, -451.6766933373187, -797.5377214219635, -55.513053758024526, -357.84220314835625, -758.7364011670649, -829.151216136518, -845.9861270307342, -568.3232931756357, -540.8727803173606, -1007.3869605954444, -704.9017186632796, -512.4003550325956, -765.5450158730773, -806.4446651218439, -756.5621820561638, -452.1273911180301, -794.7269680405694, -1122.841322301895, -634.3234539205657, -1230.761193906524, -795.8013076860851, -604.0058293295664, -115.74818948126453, -932.0902835413095, -882.3665277315796, -949.114411162276, -879.0611880360844, -511.5176328504201, -779.6243214183207, -371.0687099311337, -805.7037858617898, -972.6347982008208, -749.616356510958, -365.60114866582757, -732.2254131738266, -910.1145919197984, -173.3364688533172, -357.60826695080476, -365.73507797728695, -130.74796689751219, -524.2468963790368, -322.87423414490024, -668.0521055836431, -546.6989379414015, -76.53837220459538, -603.1229328615617, -117.7809106209755, -359.8460325367731, -650.8209628573446, -1158.3939294312793, -835.7089858515219, -897.0095679265548, -403.986326821066, -545.863637652754, -826.1605277227776, -998.8288467425261, -366.76516169712613, -536.044372417414, -494.869585054349, -170.67387853006582, -994.310200634017, -788.8793245628893, -728.7843055277025, -131.29270136981668, -417.2390869292268, -935.4805195220612, -181.72388124069258, -102.9955670671962]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5824151368185618, "mean_inference_ms": 1.764559034421638, "mean_action_processing_ms": 0.2911310910665299, "mean_env_wait_ms": 3.0611054275948884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013835613544170674, "StateBufferConnector_ms": 0.008527437845865885, "ViewRequirementAgentConnector_ms": 0.18897331677950346}, "num_episodes": 30, "episode_return_max": -55.513053758024526, "episode_return_min": -1230.761193906524, "episode_return_mean": -607.2650326516762, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.4661204704807, "num_env_steps_trained_throughput_per_sec": 319.4661204704807, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12442.778, "restore_workers_time_ms": 0.038, "training_step_time_ms": 12442.692, "sample_time_ms": 1218.025, "learn_time_ms": 11158.314, "learn_throughput": 358.477, "synch_weights_time_ms": 65.571}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00012", "date": "2024-08-03_04-14-52", "timestamp": 1722638692, "time_this_iter_s": 12.533531427383423, "time_total_s": 37.36523747444153, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c7236d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 37.36523747444153, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 38.388888888888886, "ram_util_percent": 47.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.481826741062105, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.41532645324866, "policy_loss": -0.007797648627699042, "vf_loss": 9.420587053894996, "vf_explained_var": 0.24363323338329793, "kl": 0.012754455967812344, "entropy": 1.3845506759981314, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -17.65541701283673, "episode_reward_min": -1262.348422867022, "episode_reward_mean": -653.9483216309734, "episode_len_mean": 135.25, "episode_media": {}, "episodes_timesteps_total": 13525, "policy_reward_min": {"policy_0": -1262.348422867022}, "policy_reward_max": {"policy_0": -17.65541701283673}, "policy_reward_mean": {"policy_0": -653.9483216309734}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-931.5682192215725, -787.880562276675, -451.6766933373187, -797.5377214219635, -55.513053758024526, -357.84220314835625, -758.7364011670649, -829.151216136518, -845.9861270307342, -568.3232931756357, -540.8727803173606, -1007.3869605954444, -704.9017186632796, -512.4003550325956, -765.5450158730773, -806.4446651218439, -756.5621820561638, -452.1273911180301, -794.7269680405694, -1122.841322301895, -634.3234539205657, -1230.761193906524, -795.8013076860851, -604.0058293295664, -115.74818948126453, -932.0902835413095, -882.3665277315796, -949.114411162276, -879.0611880360844, -511.5176328504201, -779.6243214183207, -371.0687099311337, -805.7037858617898, -972.6347982008208, -749.616356510958, -365.60114866582757, -732.2254131738266, -910.1145919197984, -173.3364688533172, -357.60826695080476, -365.73507797728695, -130.74796689751219, -524.2468963790368, -322.87423414490024, -668.0521055836431, -546.6989379414015, -76.53837220459538, -603.1229328615617, -117.7809106209755, -359.8460325367731, -650.8209628573446, -1158.3939294312793, -835.7089858515219, -897.0095679265548, -403.986326821066, -545.863637652754, -826.1605277227776, -998.8288467425261, -366.76516169712613, -536.044372417414, -494.869585054349, -170.67387853006582, -994.310200634017, -788.8793245628893, -728.7843055277025, -131.29270136981668, -417.2390869292268, -935.4805195220612, -181.72388124069258, -102.9955670671962, -1097.519322835302, -775.8944932358347, -619.9491910056347, -783.1817770704854, -654.3007881871948, -994.0720303291882, -288.8874302756347, -967.7494421864704, -1048.410983114403, -781.4764580335673, -87.78761153075565, -1034.1553605761949, -1250.6179663248015, -345.4182787453651, -1137.6158920149048, -653.7678542618238, -825.1787240831471, -649.0980618185598, -1262.348422867022, -726.5151519381042, -906.887290672655, -632.9471554498671, -320.007777614981, -339.09089190685563, -540.835715212075, -996.2715225854384, -673.6721335713207, -979.3889117844022, -522.3065412200516, -17.65541701283673], "episode_lengths": [150, 150, 119, 150, 54, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 133, 150, 105, 150, 150, 150, 96, 150, 150, 75, 102, 150, 87, 136, 150, 150, 150, 92, 150, 60, 100, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 146, 64, 150, 150, 150, 66, 150, 150, 68, 87, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 36], "policy_policy_0_reward": [-931.5682192215725, -787.880562276675, -451.6766933373187, -797.5377214219635, -55.513053758024526, -357.84220314835625, -758.7364011670649, -829.151216136518, -845.9861270307342, -568.3232931756357, -540.8727803173606, -1007.3869605954444, -704.9017186632796, -512.4003550325956, -765.5450158730773, -806.4446651218439, -756.5621820561638, -452.1273911180301, -794.7269680405694, -1122.841322301895, -634.3234539205657, -1230.761193906524, -795.8013076860851, -604.0058293295664, -115.74818948126453, -932.0902835413095, -882.3665277315796, -949.114411162276, -879.0611880360844, -511.5176328504201, -779.6243214183207, -371.0687099311337, -805.7037858617898, -972.6347982008208, -749.616356510958, -365.60114866582757, -732.2254131738266, -910.1145919197984, -173.3364688533172, -357.60826695080476, -365.73507797728695, -130.74796689751219, -524.2468963790368, -322.87423414490024, -668.0521055836431, -546.6989379414015, -76.53837220459538, -603.1229328615617, -117.7809106209755, -359.8460325367731, -650.8209628573446, -1158.3939294312793, -835.7089858515219, -897.0095679265548, -403.986326821066, -545.863637652754, -826.1605277227776, -998.8288467425261, -366.76516169712613, -536.044372417414, -494.869585054349, -170.67387853006582, -994.310200634017, -788.8793245628893, -728.7843055277025, -131.29270136981668, -417.2390869292268, -935.4805195220612, -181.72388124069258, -102.9955670671962, -1097.519322835302, -775.8944932358347, -619.9491910056347, -783.1817770704854, -654.3007881871948, -994.0720303291882, -288.8874302756347, -967.7494421864704, -1048.410983114403, -781.4764580335673, -87.78761153075565, -1034.1553605761949, -1250.6179663248015, -345.4182787453651, -1137.6158920149048, -653.7678542618238, -825.1787240831471, -649.0980618185598, -1262.348422867022, -726.5151519381042, -906.887290672655, -632.9471554498671, -320.007777614981, -339.09089190685563, -540.835715212075, -996.2715225854384, -673.6721335713207, -979.3889117844022, -522.3065412200516, -17.65541701283673]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5823660952309335, "mean_inference_ms": 1.7661340760999316, "mean_action_processing_ms": 0.291541129661796, "mean_env_wait_ms": 3.0631012972193137, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013736486434936523, "StateBufferConnector_ms": 0.008550882339477539, "ViewRequirementAgentConnector_ms": 0.1907358169555664}, "num_episodes": 30, "episode_return_max": -17.65541701283673, "episode_return_min": -1262.348422867022, "episode_return_mean": -653.9483216309734, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.23372279656394, "num_env_steps_trained_throughput_per_sec": 297.23372279656394, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12696.443, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12696.36, "sample_time_ms": 1200.469, "learn_time_ms": 11424.024, "learn_throughput": 350.139, "synch_weights_time_ms": 71.096}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00012", "date": "2024-08-03_04-15-05", "timestamp": 1722638705, "time_this_iter_s": 13.471004724502563, "time_total_s": 50.83624219894409, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70ac20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.83624219894409, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 22.568421052631578, "ram_util_percent": 47.41052631578947}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.806352966154614, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.186834822098414, "policy_loss": -0.009398198936348004, "vf_loss": 8.193327384690443, "vf_explained_var": 0.3148998704428474, "kl": 0.01459343044036056, "entropy": 1.3057170933733384, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -17.65541701283673, "episode_reward_min": -1262.348422867022, "episode_reward_mean": -656.3349042890231, "episode_len_mean": 134.89, "episode_media": {}, "episodes_timesteps_total": 13489, "policy_reward_min": {"policy_0": -1262.348422867022}, "policy_reward_max": {"policy_0": -17.65541701283673}, "policy_reward_mean": {"policy_0": -656.3349042890231}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-879.0611880360844, -511.5176328504201, -779.6243214183207, -371.0687099311337, -805.7037858617898, -972.6347982008208, -749.616356510958, -365.60114866582757, -732.2254131738266, -910.1145919197984, -173.3364688533172, -357.60826695080476, -365.73507797728695, -130.74796689751219, -524.2468963790368, -322.87423414490024, -668.0521055836431, -546.6989379414015, -76.53837220459538, -603.1229328615617, -117.7809106209755, -359.8460325367731, -650.8209628573446, -1158.3939294312793, -835.7089858515219, -897.0095679265548, -403.986326821066, -545.863637652754, -826.1605277227776, -998.8288467425261, -366.76516169712613, -536.044372417414, -494.869585054349, -170.67387853006582, -994.310200634017, -788.8793245628893, -728.7843055277025, -131.29270136981668, -417.2390869292268, -935.4805195220612, -181.72388124069258, -102.9955670671962, -1097.519322835302, -775.8944932358347, -619.9491910056347, -783.1817770704854, -654.3007881871948, -994.0720303291882, -288.8874302756347, -967.7494421864704, -1048.410983114403, -781.4764580335673, -87.78761153075565, -1034.1553605761949, -1250.6179663248015, -345.4182787453651, -1137.6158920149048, -653.7678542618238, -825.1787240831471, -649.0980618185598, -1262.348422867022, -726.5151519381042, -906.887290672655, -632.9471554498671, -320.007777614981, -339.09089190685563, -540.835715212075, -996.2715225854384, -673.6721335713207, -979.3889117844022, -522.3065412200516, -17.65541701283673, -832.7980336268414, -838.5245890679436, -619.2858506862788, -694.5671036967286, -868.780196006171, -1133.887100861147, -495.4005931185933, -338.9772726531359, -415.10550465540314, -405.39134888311395, -811.6535432319215, -1009.2597420561385, -762.4681593714373, -611.725434306162, -774.0226277030108, -306.4796696398817, -696.5327286519165, -40.57694228075714, -942.9143316562279, -985.3219803594588, -840.7267602167154, -1130.3435988369863, -94.94693820102636, -652.7530408785249, -973.9666102229015, -1048.6094656048201, -1210.1930728197103, -695.6820730653117], "episode_lengths": [150, 133, 150, 105, 150, 150, 150, 96, 150, 150, 75, 102, 150, 87, 136, 150, 150, 150, 92, 150, 60, 100, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 146, 64, 150, 150, 150, 66, 150, 150, 68, 87, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 36, 150, 150, 150, 150, 150, 150, 150, 102, 150, 99, 150, 150, 150, 150, 150, 97, 150, 57, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-879.0611880360844, -511.5176328504201, -779.6243214183207, -371.0687099311337, -805.7037858617898, -972.6347982008208, -749.616356510958, -365.60114866582757, -732.2254131738266, -910.1145919197984, -173.3364688533172, -357.60826695080476, -365.73507797728695, -130.74796689751219, -524.2468963790368, -322.87423414490024, -668.0521055836431, -546.6989379414015, -76.53837220459538, -603.1229328615617, -117.7809106209755, -359.8460325367731, -650.8209628573446, -1158.3939294312793, -835.7089858515219, -897.0095679265548, -403.986326821066, -545.863637652754, -826.1605277227776, -998.8288467425261, -366.76516169712613, -536.044372417414, -494.869585054349, -170.67387853006582, -994.310200634017, -788.8793245628893, -728.7843055277025, -131.29270136981668, -417.2390869292268, -935.4805195220612, -181.72388124069258, -102.9955670671962, -1097.519322835302, -775.8944932358347, -619.9491910056347, -783.1817770704854, -654.3007881871948, -994.0720303291882, -288.8874302756347, -967.7494421864704, -1048.410983114403, -781.4764580335673, -87.78761153075565, -1034.1553605761949, -1250.6179663248015, -345.4182787453651, -1137.6158920149048, -653.7678542618238, -825.1787240831471, -649.0980618185598, -1262.348422867022, -726.5151519381042, -906.887290672655, -632.9471554498671, -320.007777614981, -339.09089190685563, -540.835715212075, -996.2715225854384, -673.6721335713207, -979.3889117844022, -522.3065412200516, -17.65541701283673, -832.7980336268414, -838.5245890679436, -619.2858506862788, -694.5671036967286, -868.780196006171, -1133.887100861147, -495.4005931185933, -338.9772726531359, -415.10550465540314, -405.39134888311395, -811.6535432319215, -1009.2597420561385, -762.4681593714373, -611.725434306162, -774.0226277030108, -306.4796696398817, -696.5327286519165, -40.57694228075714, -942.9143316562279, -985.3219803594588, -840.7267602167154, -1130.3435988369863, -94.94693820102636, -652.7530408785249, -973.9666102229015, -1048.6094656048201, -1210.1930728197103, -695.6820730653117]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5810286572395679, "mean_inference_ms": 1.7637261640976845, "mean_action_processing_ms": 0.2917026231806232, "mean_env_wait_ms": 3.063004170651753, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013637065887451172, "StateBufferConnector_ms": 0.008839607238769531, "ViewRequirementAgentConnector_ms": 0.19886469841003418}, "num_episodes": 28, "episode_return_max": -17.65541701283673, "episode_return_min": -1262.348422867022, "episode_return_mean": -656.3349042890231, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.6147811558059, "num_env_steps_trained_throughput_per_sec": 291.6147811558059, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12900.502, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12900.42, "sample_time_ms": 1200.826, "learn_time_ms": 11630.687, "learn_throughput": 343.918, "synch_weights_time_ms": 68.135}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00012", "date": "2024-08-03_04-15-19", "timestamp": 1722638719, "time_this_iter_s": 13.727290391921997, "time_total_s": 64.56353259086609, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70a7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 64.56353259086609, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 42.4, "ram_util_percent": 47.505}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.329011785238981, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.343595506250859, "policy_loss": -0.011054944045220812, "vf_loss": 8.35122792373101, "vf_explained_var": 0.46406383824845154, "kl": 0.01717550544729723, "entropy": 1.259249316404263, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -17.65541701283673, "episode_reward_min": -1262.348422867022, "episode_reward_mean": -689.2600795974015, "episode_len_mean": 137.4, "episode_media": {}, "episodes_timesteps_total": 13740, "policy_reward_min": {"policy_0": -1262.348422867022}, "policy_reward_max": {"policy_0": -17.65541701283673}, "policy_reward_mean": {"policy_0": -689.2600795974015}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-826.1605277227776, -998.8288467425261, -366.76516169712613, -536.044372417414, -494.869585054349, -170.67387853006582, -994.310200634017, -788.8793245628893, -728.7843055277025, -131.29270136981668, -417.2390869292268, -935.4805195220612, -181.72388124069258, -102.9955670671962, -1097.519322835302, -775.8944932358347, -619.9491910056347, -783.1817770704854, -654.3007881871948, -994.0720303291882, -288.8874302756347, -967.7494421864704, -1048.410983114403, -781.4764580335673, -87.78761153075565, -1034.1553605761949, -1250.6179663248015, -345.4182787453651, -1137.6158920149048, -653.7678542618238, -825.1787240831471, -649.0980618185598, -1262.348422867022, -726.5151519381042, -906.887290672655, -632.9471554498671, -320.007777614981, -339.09089190685563, -540.835715212075, -996.2715225854384, -673.6721335713207, -979.3889117844022, -522.3065412200516, -17.65541701283673, -832.7980336268414, -838.5245890679436, -619.2858506862788, -694.5671036967286, -868.780196006171, -1133.887100861147, -495.4005931185933, -338.9772726531359, -415.10550465540314, -405.39134888311395, -811.6535432319215, -1009.2597420561385, -762.4681593714373, -611.725434306162, -774.0226277030108, -306.4796696398817, -696.5327286519165, -40.57694228075714, -942.9143316562279, -985.3219803594588, -840.7267602167154, -1130.3435988369863, -94.94693820102636, -652.7530408785249, -973.9666102229015, -1048.6094656048201, -1210.1930728197103, -695.6820730653117, -598.108123034562, -769.5751867501518, -862.7531873254219, -454.78833562558145, -1079.5832785459802, -534.6526779599249, -833.3281223765903, -315.8563181973232, -1123.8118097733309, -911.4755827085223, -925.8288250772976, -156.7324149139822, -990.6275814771254, -657.0132682799572, -879.202145273581, -586.802958245771, -220.6637262302514, -516.3269528325603, -471.13160180200816, -810.9612890950946, -998.2633407620614, -971.4532867479255, -892.7408388936052, -441.22585520266097, -729.3953189063786, -329.11562959943853, -507.92320336769217, -538.7162318943638], "episode_lengths": [150, 150, 96, 150, 146, 64, 150, 150, 150, 66, 150, 150, 68, 87, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 36, 150, 150, 150, 150, 150, 150, 150, 102, 150, 99, 150, 150, 150, 150, 150, 97, 150, 57, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 74, 150, 150, 144, 150, 150, 150, 150, 150, 89, 150, 113], "policy_policy_0_reward": [-826.1605277227776, -998.8288467425261, -366.76516169712613, -536.044372417414, -494.869585054349, -170.67387853006582, -994.310200634017, -788.8793245628893, -728.7843055277025, -131.29270136981668, -417.2390869292268, -935.4805195220612, -181.72388124069258, -102.9955670671962, -1097.519322835302, -775.8944932358347, -619.9491910056347, -783.1817770704854, -654.3007881871948, -994.0720303291882, -288.8874302756347, -967.7494421864704, -1048.410983114403, -781.4764580335673, -87.78761153075565, -1034.1553605761949, -1250.6179663248015, -345.4182787453651, -1137.6158920149048, -653.7678542618238, -825.1787240831471, -649.0980618185598, -1262.348422867022, -726.5151519381042, -906.887290672655, -632.9471554498671, -320.007777614981, -339.09089190685563, -540.835715212075, -996.2715225854384, -673.6721335713207, -979.3889117844022, -522.3065412200516, -17.65541701283673, -832.7980336268414, -838.5245890679436, -619.2858506862788, -694.5671036967286, -868.780196006171, -1133.887100861147, -495.4005931185933, -338.9772726531359, -415.10550465540314, -405.39134888311395, -811.6535432319215, -1009.2597420561385, -762.4681593714373, -611.725434306162, -774.0226277030108, -306.4796696398817, -696.5327286519165, -40.57694228075714, -942.9143316562279, -985.3219803594588, -840.7267602167154, -1130.3435988369863, -94.94693820102636, -652.7530408785249, -973.9666102229015, -1048.6094656048201, -1210.1930728197103, -695.6820730653117, -598.108123034562, -769.5751867501518, -862.7531873254219, -454.78833562558145, -1079.5832785459802, -534.6526779599249, -833.3281223765903, -315.8563181973232, -1123.8118097733309, -911.4755827085223, -925.8288250772976, -156.7324149139822, -990.6275814771254, -657.0132682799572, -879.202145273581, -586.802958245771, -220.6637262302514, -516.3269528325603, -471.13160180200816, -810.9612890950946, -998.2633407620614, -971.4532867479255, -892.7408388936052, -441.22585520266097, -729.3953189063786, -329.11562959943853, -507.92320336769217, -538.7162318943638]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.579814754169937, "mean_inference_ms": 1.7615525147995654, "mean_action_processing_ms": 0.2916706974172346, "mean_env_wait_ms": 3.0547007878211536, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013480186462402344, "StateBufferConnector_ms": 0.008710384368896484, "ViewRequirementAgentConnector_ms": 0.19502830505371094}, "num_episodes": 28, "episode_return_max": -17.65541701283673, "episode_return_min": -1262.348422867022, "episode_return_mean": -689.2600795974015, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.66813454251314, "num_env_steps_trained_throughput_per_sec": 310.66813454251314, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12896.333, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12896.251, "sample_time_ms": 1195.897, "learn_time_ms": 11630.257, "learn_throughput": 343.93, "synch_weights_time_ms": 69.329}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00012", "date": "2024-08-03_04-15-32", "timestamp": 1722638732, "time_this_iter_s": 12.888570308685303, "time_total_s": 77.45210289955139, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70b400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.45210289955139, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.683333333333337, "ram_util_percent": 47.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.12837110112111, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.719049611687661, "policy_loss": -0.011702866694152665, "vf_loss": 6.727093929052353, "vf_explained_var": 0.5689497562746207, "kl": 0.018353681303142366, "entropy": 1.2185448609292506, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -17.65541701283673, "episode_reward_min": -1262.348422867022, "episode_reward_mean": -694.679847599076, "episode_len_mean": 138.71, "episode_media": {}, "episodes_timesteps_total": 13871, "policy_reward_min": {"policy_0": -1262.348422867022}, "policy_reward_max": {"policy_0": -17.65541701283673}, "policy_reward_mean": {"policy_0": -694.679847599076}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1262.348422867022, -726.5151519381042, -906.887290672655, -632.9471554498671, -320.007777614981, -339.09089190685563, -540.835715212075, -996.2715225854384, -673.6721335713207, -979.3889117844022, -522.3065412200516, -17.65541701283673, -832.7980336268414, -838.5245890679436, -619.2858506862788, -694.5671036967286, -868.780196006171, -1133.887100861147, -495.4005931185933, -338.9772726531359, -415.10550465540314, -405.39134888311395, -811.6535432319215, -1009.2597420561385, -762.4681593714373, -611.725434306162, -774.0226277030108, -306.4796696398817, -696.5327286519165, -40.57694228075714, -942.9143316562279, -985.3219803594588, -840.7267602167154, -1130.3435988369863, -94.94693820102636, -652.7530408785249, -973.9666102229015, -1048.6094656048201, -1210.1930728197103, -695.6820730653117, -598.108123034562, -769.5751867501518, -862.7531873254219, -454.78833562558145, -1079.5832785459802, -534.6526779599249, -833.3281223765903, -315.8563181973232, -1123.8118097733309, -911.4755827085223, -925.8288250772976, -156.7324149139822, -990.6275814771254, -657.0132682799572, -879.202145273581, -586.802958245771, -220.6637262302514, -516.3269528325603, -471.13160180200816, -810.9612890950946, -998.2633407620614, -971.4532867479255, -892.7408388936052, -441.22585520266097, -729.3953189063786, -329.11562959943853, -507.92320336769217, -538.7162318943638, -649.5377573491326, -672.3241529217854, -674.4555199587749, -63.9547111604989, -890.1123718781934, -847.3259201954644, -314.71337083160785, -50.60498209460657, -441.634603817926, -1005.7576555487116, -442.51524020024397, -352.0611068136814, -913.5784410571347, -551.896403000283, -1142.9107055425777, -1019.0908565387015, -757.7002781668829, -783.3225749380294, -1009.6202408465767, -748.8150401205277, -479.1446909870672, -718.4268824454524, -972.590978585005, -881.6997871414936, -879.288639019781, -735.121356653316, -63.00884994245004, -829.8650455261678, -906.503892514586, -1001.1544035304737, -509.5280690540495, -902.8418964333913], "episode_lengths": [150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 36, 150, 150, 150, 150, 150, 150, 150, 102, 150, 99, 150, 150, 150, 150, 150, 97, 150, 57, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 74, 150, 150, 144, 150, 150, 150, 150, 150, 89, 150, 113, 150, 150, 150, 43, 150, 150, 87, 70, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 72, 150, 150, 150, 121, 150], "policy_policy_0_reward": [-1262.348422867022, -726.5151519381042, -906.887290672655, -632.9471554498671, -320.007777614981, -339.09089190685563, -540.835715212075, -996.2715225854384, -673.6721335713207, -979.3889117844022, -522.3065412200516, -17.65541701283673, -832.7980336268414, -838.5245890679436, -619.2858506862788, -694.5671036967286, -868.780196006171, -1133.887100861147, -495.4005931185933, -338.9772726531359, -415.10550465540314, -405.39134888311395, -811.6535432319215, -1009.2597420561385, -762.4681593714373, -611.725434306162, -774.0226277030108, -306.4796696398817, -696.5327286519165, -40.57694228075714, -942.9143316562279, -985.3219803594588, -840.7267602167154, -1130.3435988369863, -94.94693820102636, -652.7530408785249, -973.9666102229015, -1048.6094656048201, -1210.1930728197103, -695.6820730653117, -598.108123034562, -769.5751867501518, -862.7531873254219, -454.78833562558145, -1079.5832785459802, -534.6526779599249, -833.3281223765903, -315.8563181973232, -1123.8118097733309, -911.4755827085223, -925.8288250772976, -156.7324149139822, -990.6275814771254, -657.0132682799572, -879.202145273581, -586.802958245771, -220.6637262302514, -516.3269528325603, -471.13160180200816, -810.9612890950946, -998.2633407620614, -971.4532867479255, -892.7408388936052, -441.22585520266097, -729.3953189063786, -329.11562959943853, -507.92320336769217, -538.7162318943638, -649.5377573491326, -672.3241529217854, -674.4555199587749, -63.9547111604989, -890.1123718781934, -847.3259201954644, -314.71337083160785, -50.60498209460657, -441.634603817926, -1005.7576555487116, -442.51524020024397, -352.0611068136814, -913.5784410571347, -551.896403000283, -1142.9107055425777, -1019.0908565387015, -757.7002781668829, -783.3225749380294, -1009.6202408465767, -748.8150401205277, -479.1446909870672, -718.4268824454524, -972.590978585005, -881.6997871414936, -879.288639019781, -735.121356653316, -63.00884994245004, -829.8650455261678, -906.503892514586, -1001.1544035304737, -509.5280690540495, -902.8418964333913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.578075553167422, "mean_inference_ms": 1.7587968959745033, "mean_action_processing_ms": 0.2905815107473444, "mean_env_wait_ms": 3.0485166014916962, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013401031494140625, "StateBufferConnector_ms": 0.008585453033447266, "ViewRequirementAgentConnector_ms": 0.2088327407836914}, "num_episodes": 32, "episode_return_max": -17.65541701283673, "episode_return_min": -1262.348422867022, "episode_return_mean": -694.679847599076, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.80231072935476, "num_env_steps_trained_throughput_per_sec": 296.80231072935476, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12979.285, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12979.202, "sample_time_ms": 1190.569, "learn_time_ms": 11711.187, "learn_throughput": 341.554, "synch_weights_time_ms": 76.59}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00012", "date": "2024-08-03_04-15-46", "timestamp": 1722638746, "time_this_iter_s": 13.499418258666992, "time_total_s": 90.95152115821838, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad3400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 90.95152115821838, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 34.689473684210526, "ram_util_percent": 47.61052631578948}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.88722285330296, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.737798239042362, "policy_loss": -0.008518381773319561, "vf_loss": 6.742705062031746, "vf_explained_var": 0.7402924983451764, "kl": 0.018122702605978702, "entropy": 1.2969039482374987, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -40.57694228075714, "episode_reward_min": -1210.1930728197103, "episode_reward_mean": -697.1022957131482, "episode_len_mean": 137.85, "episode_media": {}, "episodes_timesteps_total": 13785, "policy_reward_min": {"policy_0": -1210.1930728197103}, "policy_reward_max": {"policy_0": -40.57694228075714}, "policy_reward_mean": {"policy_0": -697.1022957131482}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-696.5327286519165, -40.57694228075714, -942.9143316562279, -985.3219803594588, -840.7267602167154, -1130.3435988369863, -94.94693820102636, -652.7530408785249, -973.9666102229015, -1048.6094656048201, -1210.1930728197103, -695.6820730653117, -598.108123034562, -769.5751867501518, -862.7531873254219, -454.78833562558145, -1079.5832785459802, -534.6526779599249, -833.3281223765903, -315.8563181973232, -1123.8118097733309, -911.4755827085223, -925.8288250772976, -156.7324149139822, -990.6275814771254, -657.0132682799572, -879.202145273581, -586.802958245771, -220.6637262302514, -516.3269528325603, -471.13160180200816, -810.9612890950946, -998.2633407620614, -971.4532867479255, -892.7408388936052, -441.22585520266097, -729.3953189063786, -329.11562959943853, -507.92320336769217, -538.7162318943638, -649.5377573491326, -672.3241529217854, -674.4555199587749, -63.9547111604989, -890.1123718781934, -847.3259201954644, -314.71337083160785, -50.60498209460657, -441.634603817926, -1005.7576555487116, -442.51524020024397, -352.0611068136814, -913.5784410571347, -551.896403000283, -1142.9107055425777, -1019.0908565387015, -757.7002781668829, -783.3225749380294, -1009.6202408465767, -748.8150401205277, -479.1446909870672, -718.4268824454524, -972.590978585005, -881.6997871414936, -879.288639019781, -735.121356653316, -63.00884994245004, -829.8650455261678, -906.503892514586, -1001.1544035304737, -509.5280690540495, -902.8418964333913, -1114.0284844011749, -1048.8515400778683, -46.297782833758326, -823.5634247304322, -979.3032364374172, -643.7321234072393, -734.8393540446708, -636.2284895426084, -845.8118883700637, -689.9685874973446, -780.4065773732365, -58.254445426338116, -480.0431466131393, -659.1478285041596, -290.9324563888017, -975.2725978537138, -813.4182296649061, -1033.1093601707712, -244.59194720959613, -366.6272802504306, -1160.8753341319348, -447.76217955671814, -135.07435372313805, -1012.1333548358126, -413.41119656772884, -1022.4367075828619, -795.4044875276535, -826.9721180832125], "episode_lengths": [150, 57, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 150, 74, 150, 150, 144, 150, 150, 150, 150, 150, 89, 150, 113, 150, 150, 150, 43, 150, 150, 87, 70, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 72, 150, 150, 150, 121, 150, 150, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 66, 120, 150, 114, 150, 150, 150, 78, 103, 150, 150, 98, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-696.5327286519165, -40.57694228075714, -942.9143316562279, -985.3219803594588, -840.7267602167154, -1130.3435988369863, -94.94693820102636, -652.7530408785249, -973.9666102229015, -1048.6094656048201, -1210.1930728197103, -695.6820730653117, -598.108123034562, -769.5751867501518, -862.7531873254219, -454.78833562558145, -1079.5832785459802, -534.6526779599249, -833.3281223765903, -315.8563181973232, -1123.8118097733309, -911.4755827085223, -925.8288250772976, -156.7324149139822, -990.6275814771254, -657.0132682799572, -879.202145273581, -586.802958245771, -220.6637262302514, -516.3269528325603, -471.13160180200816, -810.9612890950946, -998.2633407620614, -971.4532867479255, -892.7408388936052, -441.22585520266097, -729.3953189063786, -329.11562959943853, -507.92320336769217, -538.7162318943638, -649.5377573491326, -672.3241529217854, -674.4555199587749, -63.9547111604989, -890.1123718781934, -847.3259201954644, -314.71337083160785, -50.60498209460657, -441.634603817926, -1005.7576555487116, -442.51524020024397, -352.0611068136814, -913.5784410571347, -551.896403000283, -1142.9107055425777, -1019.0908565387015, -757.7002781668829, -783.3225749380294, -1009.6202408465767, -748.8150401205277, -479.1446909870672, -718.4268824454524, -972.590978585005, -881.6997871414936, -879.288639019781, -735.121356653316, -63.00884994245004, -829.8650455261678, -906.503892514586, -1001.1544035304737, -509.5280690540495, -902.8418964333913, -1114.0284844011749, -1048.8515400778683, -46.297782833758326, -823.5634247304322, -979.3032364374172, -643.7321234072393, -734.8393540446708, -636.2284895426084, -845.8118883700637, -689.9685874973446, -780.4065773732365, -58.254445426338116, -480.0431466131393, -659.1478285041596, -290.9324563888017, -975.2725978537138, -813.4182296649061, -1033.1093601707712, -244.59194720959613, -366.6272802504306, -1160.8753341319348, -447.76217955671814, -135.07435372313805, -1012.1333548358126, -413.41119656772884, -1022.4367075828619, -795.4044875276535, -826.9721180832125]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5773083041496101, "mean_inference_ms": 1.7631792394250199, "mean_action_processing_ms": 0.2910881990975118, "mean_env_wait_ms": 3.0557870684596207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012469291687011719, "StateBufferConnector_ms": 0.008100509643554688, "ViewRequirementAgentConnector_ms": 0.20381903648376465}, "num_episodes": 28, "episode_return_max": -40.57694228075714, "episode_return_min": -1210.1930728197103, "episode_return_mean": -697.1022957131482, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.3862769183829, "num_env_steps_trained_throughput_per_sec": 310.3862769183829, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12967.772, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12967.688, "sample_time_ms": 1200.805, "learn_time_ms": 11689.03, "learn_throughput": 342.201, "synch_weights_time_ms": 76.998}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00012", "date": "2024-08-03_04-15-59", "timestamp": 1722638759, "time_this_iter_s": 12.901163101196289, "time_total_s": 103.85268425941467, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78c1f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 103.85268425941467, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 25.08888888888889, "ram_util_percent": 47.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 54.48621851454178, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.687536497910817, "policy_loss": -0.010547213548367533, "vf_loss": 6.694956105947495, "vf_explained_var": 0.760708998516202, "kl": 0.015705808634796387, "entropy": 1.3548762712627649, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -46.297782833758326, "episode_reward_min": -1297.5466075397067, "episode_reward_mean": -694.7733991666223, "episode_len_mean": 138.64, "episode_media": {}, "episodes_timesteps_total": 13864, "policy_reward_min": {"policy_0": -1297.5466075397067}, "policy_reward_max": {"policy_0": -46.297782833758326}, "policy_reward_mean": {"policy_0": -694.7733991666223}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-586.802958245771, -220.6637262302514, -516.3269528325603, -471.13160180200816, -810.9612890950946, -998.2633407620614, -971.4532867479255, -892.7408388936052, -441.22585520266097, -729.3953189063786, -329.11562959943853, -507.92320336769217, -538.7162318943638, -649.5377573491326, -672.3241529217854, -674.4555199587749, -63.9547111604989, -890.1123718781934, -847.3259201954644, -314.71337083160785, -50.60498209460657, -441.634603817926, -1005.7576555487116, -442.51524020024397, -352.0611068136814, -913.5784410571347, -551.896403000283, -1142.9107055425777, -1019.0908565387015, -757.7002781668829, -783.3225749380294, -1009.6202408465767, -748.8150401205277, -479.1446909870672, -718.4268824454524, -972.590978585005, -881.6997871414936, -879.288639019781, -735.121356653316, -63.00884994245004, -829.8650455261678, -906.503892514586, -1001.1544035304737, -509.5280690540495, -902.8418964333913, -1114.0284844011749, -1048.8515400778683, -46.297782833758326, -823.5634247304322, -979.3032364374172, -643.7321234072393, -734.8393540446708, -636.2284895426084, -845.8118883700637, -689.9685874973446, -780.4065773732365, -58.254445426338116, -480.0431466131393, -659.1478285041596, -290.9324563888017, -975.2725978537138, -813.4182296649061, -1033.1093601707712, -244.59194720959613, -366.6272802504306, -1160.8753341319348, -447.76217955671814, -135.07435372313805, -1012.1333548358126, -413.41119656772884, -1022.4367075828619, -795.4044875276535, -826.9721180832125, -751.3099837971802, -864.3758995171702, -362.147326542036, -749.9780804000693, -564.4406515270289, -1275.754888390966, -720.7631265408894, -1046.421568134251, -900.1698559850025, -630.2361256738124, -1297.5466075397067, -259.2962601417982, -1029.4657756711745, -805.9703423643874, -945.454638597907, -873.4965478793121, -745.5025884139594, -463.3309219716747, -721.1008636009061, -886.9500832379686, -802.2290247044787, -980.54959099109, -600.7355621408338, -626.2166287387566, -698.4249311060896, -300.87946795683104, -270.26740389581414], "episode_lengths": [150, 74, 150, 150, 144, 150, 150, 150, 150, 150, 89, 150, 113, 150, 150, 150, 43, 150, 150, 87, 70, 150, 150, 148, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 72, 150, 150, 150, 121, 150, 150, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 66, 120, 150, 114, 150, 150, 150, 78, 103, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 109, 150, 130, 150, 150, 150, 150, 132, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141], "policy_policy_0_reward": [-586.802958245771, -220.6637262302514, -516.3269528325603, -471.13160180200816, -810.9612890950946, -998.2633407620614, -971.4532867479255, -892.7408388936052, -441.22585520266097, -729.3953189063786, -329.11562959943853, -507.92320336769217, -538.7162318943638, -649.5377573491326, -672.3241529217854, -674.4555199587749, -63.9547111604989, -890.1123718781934, -847.3259201954644, -314.71337083160785, -50.60498209460657, -441.634603817926, -1005.7576555487116, -442.51524020024397, -352.0611068136814, -913.5784410571347, -551.896403000283, -1142.9107055425777, -1019.0908565387015, -757.7002781668829, -783.3225749380294, -1009.6202408465767, -748.8150401205277, -479.1446909870672, -718.4268824454524, -972.590978585005, -881.6997871414936, -879.288639019781, -735.121356653316, -63.00884994245004, -829.8650455261678, -906.503892514586, -1001.1544035304737, -509.5280690540495, -902.8418964333913, -1114.0284844011749, -1048.8515400778683, -46.297782833758326, -823.5634247304322, -979.3032364374172, -643.7321234072393, -734.8393540446708, -636.2284895426084, -845.8118883700637, -689.9685874973446, -780.4065773732365, -58.254445426338116, -480.0431466131393, -659.1478285041596, -290.9324563888017, -975.2725978537138, -813.4182296649061, -1033.1093601707712, -244.59194720959613, -366.6272802504306, -1160.8753341319348, -447.76217955671814, -135.07435372313805, -1012.1333548358126, -413.41119656772884, -1022.4367075828619, -795.4044875276535, -826.9721180832125, -751.3099837971802, -864.3758995171702, -362.147326542036, -749.9780804000693, -564.4406515270289, -1275.754888390966, -720.7631265408894, -1046.421568134251, -900.1698559850025, -630.2361256738124, -1297.5466075397067, -259.2962601417982, -1029.4657756711745, -805.9703423643874, -945.454638597907, -873.4965478793121, -745.5025884139594, -463.3309219716747, -721.1008636009061, -886.9500832379686, -802.2290247044787, -980.54959099109, -600.7355621408338, -626.2166287387566, -698.4249311060896, -300.87946795683104, -270.26740389581414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5755761644155541, "mean_inference_ms": 1.7635830182631498, "mean_action_processing_ms": 0.29009987021249833, "mean_env_wait_ms": 3.0567188462524575, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012153148651123047, "StateBufferConnector_ms": 0.00794076919555664, "ViewRequirementAgentConnector_ms": 0.20050048828125}, "num_episodes": 27, "episode_return_max": -46.297782833758326, "episode_return_min": -1297.5466075397067, "episode_return_mean": -694.7733991666223, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.372892607767, "num_env_steps_trained_throughput_per_sec": 296.372892607767, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 13026.522, "restore_workers_time_ms": 0.036, "training_step_time_ms": 13026.439, "sample_time_ms": 1203.182, "learn_time_ms": 11746.835, "learn_throughput": 340.517, "synch_weights_time_ms": 75.571}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00012", "date": "2024-08-03_04-16-12", "timestamp": 1722638772, "time_this_iter_s": 13.507060050964355, "time_total_s": 117.35974431037903, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70a830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 117.35974431037903, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 35.95, "ram_util_percent": 47.62500000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.022366553545, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.004767407973607, "policy_loss": -0.007733799388127712, "vf_loss": 7.009289893507957, "vf_explained_var": 0.7908192188789447, "kl": 0.016120098906174017, "entropy": 1.2698793896784386, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -8.058905030438988, "episode_reward_min": -1378.4644604627558, "episode_reward_mean": -716.5764297975788, "episode_len_mean": 139.84, "episode_media": {}, "episodes_timesteps_total": 13984, "policy_reward_min": {"policy_0": -1378.4644604627558}, "policy_reward_max": {"policy_0": -8.058905030438988}, "policy_reward_mean": {"policy_0": -716.5764297975788}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1009.6202408465767, -748.8150401205277, -479.1446909870672, -718.4268824454524, -972.590978585005, -881.6997871414936, -879.288639019781, -735.121356653316, -63.00884994245004, -829.8650455261678, -906.503892514586, -1001.1544035304737, -509.5280690540495, -902.8418964333913, -1114.0284844011749, -1048.8515400778683, -46.297782833758326, -823.5634247304322, -979.3032364374172, -643.7321234072393, -734.8393540446708, -636.2284895426084, -845.8118883700637, -689.9685874973446, -780.4065773732365, -58.254445426338116, -480.0431466131393, -659.1478285041596, -290.9324563888017, -975.2725978537138, -813.4182296649061, -1033.1093601707712, -244.59194720959613, -366.6272802504306, -1160.8753341319348, -447.76217955671814, -135.07435372313805, -1012.1333548358126, -413.41119656772884, -1022.4367075828619, -795.4044875276535, -826.9721180832125, -751.3099837971802, -864.3758995171702, -362.147326542036, -749.9780804000693, -564.4406515270289, -1275.754888390966, -720.7631265408894, -1046.421568134251, -900.1698559850025, -630.2361256738124, -1297.5466075397067, -259.2962601417982, -1029.4657756711745, -805.9703423643874, -945.454638597907, -873.4965478793121, -745.5025884139594, -463.3309219716747, -721.1008636009061, -886.9500832379686, -802.2290247044787, -980.54959099109, -600.7355621408338, -626.2166287387566, -698.4249311060896, -300.87946795683104, -270.26740389581414, -1378.4644604627558, -492.1335357754692, -282.95237689046854, -1318.753621377103, -74.77830068049326, -298.65684899509176, -600.5825577666668, -623.05232755259, -1184.5113410630233, -930.7523152740072, -699.7769907403986, -965.4349811264193, -250.47284032775522, -367.44351810954765, -737.7452286755027, -589.5450385694332, -717.7570463734169, -816.5723808375486, -1002.5261935362571, -930.3029749476075, -519.903544446684, -393.153677950604, -947.563608830378, -1171.1559442956925, -707.018111598704, -1029.5760320096397, -8.058905030438988, -1173.679203456255, -486.76419027554846, -232.30931978032214, -837.1225319339104], "episode_lengths": [150, 150, 125, 150, 150, 150, 150, 150, 72, 150, 150, 150, 121, 150, 150, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 66, 120, 150, 114, 150, 150, 150, 78, 103, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 109, 150, 130, 150, 150, 150, 150, 132, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 129, 123, 150, 84, 150, 150, 150, 150, 150, 150, 150, 122, 141, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 40, 150, 150, 126, 150], "policy_policy_0_reward": [-1009.6202408465767, -748.8150401205277, -479.1446909870672, -718.4268824454524, -972.590978585005, -881.6997871414936, -879.288639019781, -735.121356653316, -63.00884994245004, -829.8650455261678, -906.503892514586, -1001.1544035304737, -509.5280690540495, -902.8418964333913, -1114.0284844011749, -1048.8515400778683, -46.297782833758326, -823.5634247304322, -979.3032364374172, -643.7321234072393, -734.8393540446708, -636.2284895426084, -845.8118883700637, -689.9685874973446, -780.4065773732365, -58.254445426338116, -480.0431466131393, -659.1478285041596, -290.9324563888017, -975.2725978537138, -813.4182296649061, -1033.1093601707712, -244.59194720959613, -366.6272802504306, -1160.8753341319348, -447.76217955671814, -135.07435372313805, -1012.1333548358126, -413.41119656772884, -1022.4367075828619, -795.4044875276535, -826.9721180832125, -751.3099837971802, -864.3758995171702, -362.147326542036, -749.9780804000693, -564.4406515270289, -1275.754888390966, -720.7631265408894, -1046.421568134251, -900.1698559850025, -630.2361256738124, -1297.5466075397067, -259.2962601417982, -1029.4657756711745, -805.9703423643874, -945.454638597907, -873.4965478793121, -745.5025884139594, -463.3309219716747, -721.1008636009061, -886.9500832379686, -802.2290247044787, -980.54959099109, -600.7355621408338, -626.2166287387566, -698.4249311060896, -300.87946795683104, -270.26740389581414, -1378.4644604627558, -492.1335357754692, -282.95237689046854, -1318.753621377103, -74.77830068049326, -298.65684899509176, -600.5825577666668, -623.05232755259, -1184.5113410630233, -930.7523152740072, -699.7769907403986, -965.4349811264193, -250.47284032775522, -367.44351810954765, -737.7452286755027, -589.5450385694332, -717.7570463734169, -816.5723808375486, -1002.5261935362571, -930.3029749476075, -519.903544446684, -393.153677950604, -947.563608830378, -1171.1559442956925, -707.018111598704, -1029.5760320096397, -8.058905030438988, -1173.679203456255, -486.76419027554846, -232.30931978032214, -837.1225319339104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5750875945843097, "mean_inference_ms": 1.764373328699535, "mean_action_processing_ms": 0.2895856458310287, "mean_env_wait_ms": 3.060472403450085, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011487722396850586, "StateBufferConnector_ms": 0.007945060729980469, "ViewRequirementAgentConnector_ms": 0.19779586791992188}, "num_episodes": 31, "episode_return_max": -8.058905030438988, "episode_return_min": -1378.4644604627558, "episode_return_mean": -716.5764297975788, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.3067437167489, "num_env_steps_trained_throughput_per_sec": 299.3067437167489, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13060.293, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13060.212, "sample_time_ms": 1193.584, "learn_time_ms": 11790.588, "learn_throughput": 339.254, "synch_weights_time_ms": 75.196}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00012", "date": "2024-08-03_04-16-25", "timestamp": 1722638785, "time_this_iter_s": 13.377124786376953, "time_total_s": 130.73686909675598, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70ab00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 130.73686909675598, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.489473684210527, "ram_util_percent": 47.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 57.857929255565004, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.41104895422856, "policy_loss": -0.015428132104959028, "vf_loss": 6.422180931270122, "vf_explained_var": 0.8327825626358389, "kl": 0.02154728925264256, "entropy": 1.3320637366424004, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -8.058905030438988, "episode_reward_min": -1378.4644604627558, "episode_reward_mean": -710.2199712843524, "episode_len_mean": 140.51, "episode_media": {}, "episodes_timesteps_total": 14051, "policy_reward_min": {"policy_0": -1378.4644604627558}, "policy_reward_max": {"policy_0": -8.058905030438988}, "policy_reward_mean": {"policy_0": -710.2199712843524}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-659.1478285041596, -290.9324563888017, -975.2725978537138, -813.4182296649061, -1033.1093601707712, -244.59194720959613, -366.6272802504306, -1160.8753341319348, -447.76217955671814, -135.07435372313805, -1012.1333548358126, -413.41119656772884, -1022.4367075828619, -795.4044875276535, -826.9721180832125, -751.3099837971802, -864.3758995171702, -362.147326542036, -749.9780804000693, -564.4406515270289, -1275.754888390966, -720.7631265408894, -1046.421568134251, -900.1698559850025, -630.2361256738124, -1297.5466075397067, -259.2962601417982, -1029.4657756711745, -805.9703423643874, -945.454638597907, -873.4965478793121, -745.5025884139594, -463.3309219716747, -721.1008636009061, -886.9500832379686, -802.2290247044787, -980.54959099109, -600.7355621408338, -626.2166287387566, -698.4249311060896, -300.87946795683104, -270.26740389581414, -1378.4644604627558, -492.1335357754692, -282.95237689046854, -1318.753621377103, -74.77830068049326, -298.65684899509176, -600.5825577666668, -623.05232755259, -1184.5113410630233, -930.7523152740072, -699.7769907403986, -965.4349811264193, -250.47284032775522, -367.44351810954765, -737.7452286755027, -589.5450385694332, -717.7570463734169, -816.5723808375486, -1002.5261935362571, -930.3029749476075, -519.903544446684, -393.153677950604, -947.563608830378, -1171.1559442956925, -707.018111598704, -1029.5760320096397, -8.058905030438988, -1173.679203456255, -486.76419027554846, -232.30931978032214, -837.1225319339104, -733.3333006235117, -706.196395609529, -521.9534955189438, -662.9807799723799, -722.5031874101064, -1267.4879147602476, -631.486938890587, -1190.843394988572, -828.7056884254883, -777.8385620091423, -1014.17451214753, -1046.6103434735003, -370.2202749356972, -409.40786819328684, -442.2618754887449, -280.49046525167137, -256.2731001472223, -807.1994847092457, -279.03409220602236, -336.66789789964645, -978.7096252605317, -904.8072948338161, -1012.5671994812269, -47.7911152887903, -978.4939349290543, -874.0405419125719, -801.2137178658973], "episode_lengths": [150, 114, 150, 150, 150, 78, 103, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 109, 150, 130, 150, 150, 150, 150, 132, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 129, 123, 150, 84, 150, 150, 150, 150, 150, 150, 150, 122, 141, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 40, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 122, 80, 150, 85, 150, 150, 150, 150, 56, 150, 150, 150], "policy_policy_0_reward": [-659.1478285041596, -290.9324563888017, -975.2725978537138, -813.4182296649061, -1033.1093601707712, -244.59194720959613, -366.6272802504306, -1160.8753341319348, -447.76217955671814, -135.07435372313805, -1012.1333548358126, -413.41119656772884, -1022.4367075828619, -795.4044875276535, -826.9721180832125, -751.3099837971802, -864.3758995171702, -362.147326542036, -749.9780804000693, -564.4406515270289, -1275.754888390966, -720.7631265408894, -1046.421568134251, -900.1698559850025, -630.2361256738124, -1297.5466075397067, -259.2962601417982, -1029.4657756711745, -805.9703423643874, -945.454638597907, -873.4965478793121, -745.5025884139594, -463.3309219716747, -721.1008636009061, -886.9500832379686, -802.2290247044787, -980.54959099109, -600.7355621408338, -626.2166287387566, -698.4249311060896, -300.87946795683104, -270.26740389581414, -1378.4644604627558, -492.1335357754692, -282.95237689046854, -1318.753621377103, -74.77830068049326, -298.65684899509176, -600.5825577666668, -623.05232755259, -1184.5113410630233, -930.7523152740072, -699.7769907403986, -965.4349811264193, -250.47284032775522, -367.44351810954765, -737.7452286755027, -589.5450385694332, -717.7570463734169, -816.5723808375486, -1002.5261935362571, -930.3029749476075, -519.903544446684, -393.153677950604, -947.563608830378, -1171.1559442956925, -707.018111598704, -1029.5760320096397, -8.058905030438988, -1173.679203456255, -486.76419027554846, -232.30931978032214, -837.1225319339104, -733.3333006235117, -706.196395609529, -521.9534955189438, -662.9807799723799, -722.5031874101064, -1267.4879147602476, -631.486938890587, -1190.843394988572, -828.7056884254883, -777.8385620091423, -1014.17451214753, -1046.6103434735003, -370.2202749356972, -409.40786819328684, -442.2618754887449, -280.49046525167137, -256.2731001472223, -807.1994847092457, -279.03409220602236, -336.66789789964645, -978.7096252605317, -904.8072948338161, -1012.5671994812269, -47.7911152887903, -978.4939349290543, -874.0405419125719, -801.2137178658973]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.573603858304633, "mean_inference_ms": 1.7573245721994764, "mean_action_processing_ms": 0.28877882330140264, "mean_env_wait_ms": 3.059030774122996, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011499404907226562, "StateBufferConnector_ms": 0.008053064346313477, "ViewRequirementAgentConnector_ms": 0.18736505508422852}, "num_episodes": 27, "episode_return_max": -8.058905030438988, "episode_return_min": -1378.4644604627558, "episode_return_mean": -710.2199712843524, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.20639200799775, "num_env_steps_trained_throughput_per_sec": 307.20639200799775, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13246.865, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13246.783, "sample_time_ms": 1189.843, "learn_time_ms": 11982.271, "learn_throughput": 333.827, "synch_weights_time_ms": 73.826}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00012", "date": "2024-08-03_04-16-39", "timestamp": 1722638799, "time_this_iter_s": 13.031384229660034, "time_total_s": 143.76825332641602, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c708c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 143.76825332641602, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 44.538888888888884, "ram_util_percent": 47.72777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 75.53825405538082, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.838633622974157, "policy_loss": -0.010500455599200601, "vf_loss": 5.8439737059175965, "vf_explained_var": 0.8929958757633965, "kl": 0.01724844751867448, "entropy": 1.4189009519914786, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -8.058905030438988, "episode_reward_min": -1378.4644604627558, "episode_reward_mean": -715.1217636290718, "episode_len_mean": 140.36, "episode_media": {}, "episodes_timesteps_total": 14036, "policy_reward_min": {"policy_0": -1378.4644604627558}, "policy_reward_max": {"policy_0": -8.058905030438988}, "policy_reward_mean": {"policy_0": -715.1217636290718}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-805.9703423643874, -945.454638597907, -873.4965478793121, -745.5025884139594, -463.3309219716747, -721.1008636009061, -886.9500832379686, -802.2290247044787, -980.54959099109, -600.7355621408338, -626.2166287387566, -698.4249311060896, -300.87946795683104, -270.26740389581414, -1378.4644604627558, -492.1335357754692, -282.95237689046854, -1318.753621377103, -74.77830068049326, -298.65684899509176, -600.5825577666668, -623.05232755259, -1184.5113410630233, -930.7523152740072, -699.7769907403986, -965.4349811264193, -250.47284032775522, -367.44351810954765, -737.7452286755027, -589.5450385694332, -717.7570463734169, -816.5723808375486, -1002.5261935362571, -930.3029749476075, -519.903544446684, -393.153677950604, -947.563608830378, -1171.1559442956925, -707.018111598704, -1029.5760320096397, -8.058905030438988, -1173.679203456255, -486.76419027554846, -232.30931978032214, -837.1225319339104, -733.3333006235117, -706.196395609529, -521.9534955189438, -662.9807799723799, -722.5031874101064, -1267.4879147602476, -631.486938890587, -1190.843394988572, -828.7056884254883, -777.8385620091423, -1014.17451214753, -1046.6103434735003, -370.2202749356972, -409.40786819328684, -442.2618754887449, -280.49046525167137, -256.2731001472223, -807.1994847092457, -279.03409220602236, -336.66789789964645, -978.7096252605317, -904.8072948338161, -1012.5671994812269, -47.7911152887903, -978.4939349290543, -874.0405419125719, -801.2137178658973, -1154.4429607639956, -904.3634895344152, -902.7006146410866, -1325.8700237211103, -809.0249907232513, -394.8311125418345, -803.4896324402134, -677.7848402913758, -121.53409044409216, -812.366048911003, -333.2675664273566, -75.24496746875137, -21.23967541527816, -805.408641763013, -1232.1157907147915, -950.1369354374465, -897.947696879932, -931.887390495572, -792.6139041452797, -335.33602671115256, -120.44573143079329, -900.519055074734, -902.4754780222222, -707.0417325682639, -770.651927401254, -1218.160738872929, -1306.830120786415, -931.5236327569032], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 129, 123, 150, 84, 150, 150, 150, 150, 150, 150, 150, 122, 141, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 40, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 122, 80, 150, 85, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 109, 74, 43, 150, 150, 150, 150, 150, 150, 146, 61, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-805.9703423643874, -945.454638597907, -873.4965478793121, -745.5025884139594, -463.3309219716747, -721.1008636009061, -886.9500832379686, -802.2290247044787, -980.54959099109, -600.7355621408338, -626.2166287387566, -698.4249311060896, -300.87946795683104, -270.26740389581414, -1378.4644604627558, -492.1335357754692, -282.95237689046854, -1318.753621377103, -74.77830068049326, -298.65684899509176, -600.5825577666668, -623.05232755259, -1184.5113410630233, -930.7523152740072, -699.7769907403986, -965.4349811264193, -250.47284032775522, -367.44351810954765, -737.7452286755027, -589.5450385694332, -717.7570463734169, -816.5723808375486, -1002.5261935362571, -930.3029749476075, -519.903544446684, -393.153677950604, -947.563608830378, -1171.1559442956925, -707.018111598704, -1029.5760320096397, -8.058905030438988, -1173.679203456255, -486.76419027554846, -232.30931978032214, -837.1225319339104, -733.3333006235117, -706.196395609529, -521.9534955189438, -662.9807799723799, -722.5031874101064, -1267.4879147602476, -631.486938890587, -1190.843394988572, -828.7056884254883, -777.8385620091423, -1014.17451214753, -1046.6103434735003, -370.2202749356972, -409.40786819328684, -442.2618754887449, -280.49046525167137, -256.2731001472223, -807.1994847092457, -279.03409220602236, -336.66789789964645, -978.7096252605317, -904.8072948338161, -1012.5671994812269, -47.7911152887903, -978.4939349290543, -874.0405419125719, -801.2137178658973, -1154.4429607639956, -904.3634895344152, -902.7006146410866, -1325.8700237211103, -809.0249907232513, -394.8311125418345, -803.4896324402134, -677.7848402913758, -121.53409044409216, -812.366048911003, -333.2675664273566, -75.24496746875137, -21.23967541527816, -805.408641763013, -1232.1157907147915, -950.1369354374465, -897.947696879932, -931.887390495572, -792.6139041452797, -335.33602671115256, -120.44573143079329, -900.519055074734, -902.4754780222222, -707.0417325682639, -770.651927401254, -1218.160738872929, -1306.830120786415, -931.5236327569032]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.57176526813902, "mean_inference_ms": 1.7521644057622439, "mean_action_processing_ms": 0.28769781415472506, "mean_env_wait_ms": 3.0541048995996225, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011719942092895508, "StateBufferConnector_ms": 0.00806570053100586, "ViewRequirementAgentConnector_ms": 0.1891329288482666}, "num_episodes": 28, "episode_return_max": -8.058905030438988, "episode_return_min": -1378.4644604627558, "episode_return_mean": -715.1217636290718, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.96001344875805, "num_env_steps_trained_throughput_per_sec": 370.96001344875805, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12959.892, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12959.815, "sample_time_ms": 1175.339, "learn_time_ms": 11709.183, "learn_throughput": 341.612, "synch_weights_time_ms": 74.418}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00012", "date": "2024-08-03_04-16-49", "timestamp": 1722638809, "time_this_iter_s": 10.796520233154297, "time_total_s": 154.5647735595703, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c785870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 154.5647735595703, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 23.65625, "ram_util_percent": 47.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 85.65999130805334, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.659848304341237, "policy_loss": -0.014141897321678698, "vf_loss": 5.668533133467038, "vf_explained_var": 0.917059852493306, "kl": 0.0182303753478512, "entropy": 1.2054783613110582, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -8.058905030438988, "episode_reward_min": -1325.8700237211103, "episode_reward_mean": -734.1587752787362, "episode_len_mean": 139.73, "episode_media": {}, "episodes_timesteps_total": 13973, "policy_reward_min": {"policy_0": -1325.8700237211103}, "policy_reward_max": {"policy_0": -8.058905030438988}, "policy_reward_mean": {"policy_0": -734.1587752787362}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-737.7452286755027, -589.5450385694332, -717.7570463734169, -816.5723808375486, -1002.5261935362571, -930.3029749476075, -519.903544446684, -393.153677950604, -947.563608830378, -1171.1559442956925, -707.018111598704, -1029.5760320096397, -8.058905030438988, -1173.679203456255, -486.76419027554846, -232.30931978032214, -837.1225319339104, -733.3333006235117, -706.196395609529, -521.9534955189438, -662.9807799723799, -722.5031874101064, -1267.4879147602476, -631.486938890587, -1190.843394988572, -828.7056884254883, -777.8385620091423, -1014.17451214753, -1046.6103434735003, -370.2202749356972, -409.40786819328684, -442.2618754887449, -280.49046525167137, -256.2731001472223, -807.1994847092457, -279.03409220602236, -336.66789789964645, -978.7096252605317, -904.8072948338161, -1012.5671994812269, -47.7911152887903, -978.4939349290543, -874.0405419125719, -801.2137178658973, -1154.4429607639956, -904.3634895344152, -902.7006146410866, -1325.8700237211103, -809.0249907232513, -394.8311125418345, -803.4896324402134, -677.7848402913758, -121.53409044409216, -812.366048911003, -333.2675664273566, -75.24496746875137, -21.23967541527816, -805.408641763013, -1232.1157907147915, -950.1369354374465, -897.947696879932, -931.887390495572, -792.6139041452797, -335.33602671115256, -120.44573143079329, -900.519055074734, -902.4754780222222, -707.0417325682639, -770.651927401254, -1218.160738872929, -1306.830120786415, -931.5236327569032, -1136.1808092440745, -816.3353646790772, -1221.1339255721653, -709.2281331203976, -1191.2378130037316, -800.6713915051215, -447.233699189845, -383.77394507923566, -750.2600082561523, -743.1920511910799, -991.3508221262682, -569.5884950893413, -1075.2806796705058, -1142.9073293502852, -901.1686120862552, -1159.5453247553057, -1001.8305511401816, -715.5294014025172, -499.6112316434649, -460.60359838947585, -706.823720885677, -45.77427230112284, -485.28876745079396, -839.321040481189, -386.1948866433336, -986.6851139967604, -891.1966463797801, -34.6281420751084], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 40, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 122, 80, 150, 85, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 109, 74, 43, 150, 150, 150, 150, 150, 150, 146, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 56], "policy_policy_0_reward": [-737.7452286755027, -589.5450385694332, -717.7570463734169, -816.5723808375486, -1002.5261935362571, -930.3029749476075, -519.903544446684, -393.153677950604, -947.563608830378, -1171.1559442956925, -707.018111598704, -1029.5760320096397, -8.058905030438988, -1173.679203456255, -486.76419027554846, -232.30931978032214, -837.1225319339104, -733.3333006235117, -706.196395609529, -521.9534955189438, -662.9807799723799, -722.5031874101064, -1267.4879147602476, -631.486938890587, -1190.843394988572, -828.7056884254883, -777.8385620091423, -1014.17451214753, -1046.6103434735003, -370.2202749356972, -409.40786819328684, -442.2618754887449, -280.49046525167137, -256.2731001472223, -807.1994847092457, -279.03409220602236, -336.66789789964645, -978.7096252605317, -904.8072948338161, -1012.5671994812269, -47.7911152887903, -978.4939349290543, -874.0405419125719, -801.2137178658973, -1154.4429607639956, -904.3634895344152, -902.7006146410866, -1325.8700237211103, -809.0249907232513, -394.8311125418345, -803.4896324402134, -677.7848402913758, -121.53409044409216, -812.366048911003, -333.2675664273566, -75.24496746875137, -21.23967541527816, -805.408641763013, -1232.1157907147915, -950.1369354374465, -897.947696879932, -931.887390495572, -792.6139041452797, -335.33602671115256, -120.44573143079329, -900.519055074734, -902.4754780222222, -707.0417325682639, -770.651927401254, -1218.160738872929, -1306.830120786415, -931.5236327569032, -1136.1808092440745, -816.3353646790772, -1221.1339255721653, -709.2281331203976, -1191.2378130037316, -800.6713915051215, -447.233699189845, -383.77394507923566, -750.2600082561523, -743.1920511910799, -991.3508221262682, -569.5884950893413, -1075.2806796705058, -1142.9073293502852, -901.1686120862552, -1159.5453247553057, -1001.8305511401816, -715.5294014025172, -499.6112316434649, -460.60359838947585, -706.823720885677, -45.77427230112284, -485.28876745079396, -839.321040481189, -386.1948866433336, -986.6851139967604, -891.1966463797801, -34.6281420751084]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5710893948127191, "mean_inference_ms": 1.7505288659211964, "mean_action_processing_ms": 0.28732491565859697, "mean_env_wait_ms": 3.055615621873207, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011785268783569336, "StateBufferConnector_ms": 0.008087635040283203, "ViewRequirementAgentConnector_ms": 0.19448614120483398}, "num_episodes": 28, "episode_return_max": -8.058905030438988, "episode_return_min": -1325.8700237211103, "episode_return_mean": -734.1587752787362, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.89776392001835, "num_env_steps_trained_throughput_per_sec": 291.89776392001835, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13078.146, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13078.066, "sample_time_ms": 1177.507, "learn_time_ms": 11824.394, "learn_throughput": 338.284, "synch_weights_time_ms": 75.261}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00012", "date": "2024-08-03_04-17-03", "timestamp": 1722638823, "time_this_iter_s": 13.716821670532227, "time_total_s": 168.28159523010254, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c786170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 168.28159523010254, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 22.53684210526316, "ram_util_percent": 47.79999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 121.45560701886812, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.7457449105878675, "policy_loss": -0.006487621217578028, "vf_loss": 4.74704326937596, "vf_explained_var": 0.9265192923446496, "kl": 0.0173312274117052, "entropy": 1.0121662586927413, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -21.23967541527816, "episode_reward_min": -1325.8700237211103, "episode_reward_mean": -682.9552489905795, "episode_len_mean": 135.78, "episode_media": {}, "episodes_timesteps_total": 13578, "policy_reward_min": {"policy_0": -1325.8700237211103}, "policy_reward_max": {"policy_0": -21.23967541527816}, "policy_reward_mean": {"policy_0": -682.9552489905795}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-370.2202749356972, -409.40786819328684, -442.2618754887449, -280.49046525167137, -256.2731001472223, -807.1994847092457, -279.03409220602236, -336.66789789964645, -978.7096252605317, -904.8072948338161, -1012.5671994812269, -47.7911152887903, -978.4939349290543, -874.0405419125719, -801.2137178658973, -1154.4429607639956, -904.3634895344152, -902.7006146410866, -1325.8700237211103, -809.0249907232513, -394.8311125418345, -803.4896324402134, -677.7848402913758, -121.53409044409216, -812.366048911003, -333.2675664273566, -75.24496746875137, -21.23967541527816, -805.408641763013, -1232.1157907147915, -950.1369354374465, -897.947696879932, -931.887390495572, -792.6139041452797, -335.33602671115256, -120.44573143079329, -900.519055074734, -902.4754780222222, -707.0417325682639, -770.651927401254, -1218.160738872929, -1306.830120786415, -931.5236327569032, -1136.1808092440745, -816.3353646790772, -1221.1339255721653, -709.2281331203976, -1191.2378130037316, -800.6713915051215, -447.233699189845, -383.77394507923566, -750.2600082561523, -743.1920511910799, -991.3508221262682, -569.5884950893413, -1075.2806796705058, -1142.9073293502852, -901.1686120862552, -1159.5453247553057, -1001.8305511401816, -715.5294014025172, -499.6112316434649, -460.60359838947585, -706.823720885677, -45.77427230112284, -485.28876745079396, -839.321040481189, -386.1948866433336, -986.6851139967604, -891.1966463797801, -34.6281420751084, -380.3654472261199, -483.85819580073644, -116.13752378290579, -1018.6009314970439, -769.8416273689469, -705.6541745602487, -49.92014424785405, -1118.0319333030693, -622.1356784167355, -126.87128324718871, -740.6998157567075, -635.7294964788814, -265.06468528031417, -384.44795354349304, -1159.0590365191927, -750.8041141317743, -812.2813661558987, -811.8316379396886, -818.8480014733515, -959.307663249194, -146.48669013343783, -506.3396602749855, -562.1948650826348, -752.2361139427562, -514.4840078921911, -543.249238121198, -506.32981207143894, -396.948736402531, -626.7559836613132], "episode_lengths": [132, 150, 150, 122, 80, 150, 85, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 109, 74, 43, 150, 150, 150, 150, 150, 150, 146, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 56, 110, 150, 86, 150, 150, 150, 45, 150, 150, 85, 150, 150, 86, 101, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 128, 150, 150, 101, 150], "policy_policy_0_reward": [-370.2202749356972, -409.40786819328684, -442.2618754887449, -280.49046525167137, -256.2731001472223, -807.1994847092457, -279.03409220602236, -336.66789789964645, -978.7096252605317, -904.8072948338161, -1012.5671994812269, -47.7911152887903, -978.4939349290543, -874.0405419125719, -801.2137178658973, -1154.4429607639956, -904.3634895344152, -902.7006146410866, -1325.8700237211103, -809.0249907232513, -394.8311125418345, -803.4896324402134, -677.7848402913758, -121.53409044409216, -812.366048911003, -333.2675664273566, -75.24496746875137, -21.23967541527816, -805.408641763013, -1232.1157907147915, -950.1369354374465, -897.947696879932, -931.887390495572, -792.6139041452797, -335.33602671115256, -120.44573143079329, -900.519055074734, -902.4754780222222, -707.0417325682639, -770.651927401254, -1218.160738872929, -1306.830120786415, -931.5236327569032, -1136.1808092440745, -816.3353646790772, -1221.1339255721653, -709.2281331203976, -1191.2378130037316, -800.6713915051215, -447.233699189845, -383.77394507923566, -750.2600082561523, -743.1920511910799, -991.3508221262682, -569.5884950893413, -1075.2806796705058, -1142.9073293502852, -901.1686120862552, -1159.5453247553057, -1001.8305511401816, -715.5294014025172, -499.6112316434649, -460.60359838947585, -706.823720885677, -45.77427230112284, -485.28876745079396, -839.321040481189, -386.1948866433336, -986.6851139967604, -891.1966463797801, -34.6281420751084, -380.3654472261199, -483.85819580073644, -116.13752378290579, -1018.6009314970439, -769.8416273689469, -705.6541745602487, -49.92014424785405, -1118.0319333030693, -622.1356784167355, -126.87128324718871, -740.6998157567075, -635.7294964788814, -265.06468528031417, -384.44795354349304, -1159.0590365191927, -750.8041141317743, -812.2813661558987, -811.8316379396886, -818.8480014733515, -959.307663249194, -146.48669013343783, -506.3396602749855, -562.1948650826348, -752.2361139427562, -514.4840078921911, -543.249238121198, -506.32981207143894, -396.948736402531, -626.7559836613132]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5781933590229911, "mean_inference_ms": 1.7761900697454516, "mean_action_processing_ms": 0.2907627239552276, "mean_env_wait_ms": 3.0945208513615183, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01225137710571289, "StateBufferConnector_ms": 0.008102893829345703, "ViewRequirementAgentConnector_ms": 0.23964762687683105}, "num_episodes": 29, "episode_return_max": -21.23967541527816, "episode_return_min": -1325.8700237211103, "episode_return_mean": -682.9552489905795, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.44784345859466, "num_env_steps_trained_throughput_per_sec": 278.44784345859466, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13168.938, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13168.859, "sample_time_ms": 1310.775, "learn_time_ms": 11783.749, "learn_throughput": 339.451, "synch_weights_time_ms": 73.426}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00012", "date": "2024-08-03_04-17-18", "timestamp": 1722638838, "time_this_iter_s": 14.37961220741272, "time_total_s": 182.66120743751526, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad2170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 182.66120743751526, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 34.6904761904762, "ram_util_percent": 47.88571428571428}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89.33784430722396, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.620216072599093, "policy_loss": -0.011138461939117406, "vf_loss": 4.625320046395063, "vf_explained_var": 0.9496041022861997, "kl": 0.02015764942698297, "entropy": 1.279710971067349, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -34.6281420751084, "episode_reward_min": -1306.830120786415, "episode_reward_mean": -712.2132207344438, "episode_len_mean": 139.11, "episode_media": {}, "episodes_timesteps_total": 13911, "policy_reward_min": {"policy_0": -1306.830120786415}, "policy_reward_max": {"policy_0": -34.6281420751084}, "policy_reward_mean": {"policy_0": -712.2132207344438}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-805.408641763013, -1232.1157907147915, -950.1369354374465, -897.947696879932, -931.887390495572, -792.6139041452797, -335.33602671115256, -120.44573143079329, -900.519055074734, -902.4754780222222, -707.0417325682639, -770.651927401254, -1218.160738872929, -1306.830120786415, -931.5236327569032, -1136.1808092440745, -816.3353646790772, -1221.1339255721653, -709.2281331203976, -1191.2378130037316, -800.6713915051215, -447.233699189845, -383.77394507923566, -750.2600082561523, -743.1920511910799, -991.3508221262682, -569.5884950893413, -1075.2806796705058, -1142.9073293502852, -901.1686120862552, -1159.5453247553057, -1001.8305511401816, -715.5294014025172, -499.6112316434649, -460.60359838947585, -706.823720885677, -45.77427230112284, -485.28876745079396, -839.321040481189, -386.1948866433336, -986.6851139967604, -891.1966463797801, -34.6281420751084, -380.3654472261199, -483.85819580073644, -116.13752378290579, -1018.6009314970439, -769.8416273689469, -705.6541745602487, -49.92014424785405, -1118.0319333030693, -622.1356784167355, -126.87128324718871, -740.6998157567075, -635.7294964788814, -265.06468528031417, -384.44795354349304, -1159.0590365191927, -750.8041141317743, -812.2813661558987, -811.8316379396886, -818.8480014733515, -959.307663249194, -146.48669013343783, -506.3396602749855, -562.1948650826348, -752.2361139427562, -514.4840078921911, -543.249238121198, -506.32981207143894, -396.948736402531, -626.7559836613132, -935.3168712967638, -819.2563235091144, -796.8097457282846, -1014.0283411624766, -240.02552057497425, -1144.7982901432088, -227.04640575766774, -642.6277555365103, -794.7407099276269, -960.3665997509181, -638.0287519975718, -930.5791359627042, -303.9326356220148, -859.4132812451627, -922.4023036512164, -412.2134651040891, -641.5486297073444, -391.0734437658263, -159.0584167764961, -748.6054781137162, -947.6278012061722, -839.9012930527421, -849.5439110755357, -876.974254156451, -1153.5064318105858, -932.4288722742552, -300.7970069411484, -558.4840002630261], "episode_lengths": [150, 150, 150, 150, 150, 150, 146, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 56, 110, 150, 86, 150, 150, 150, 45, 150, 150, 85, 150, 150, 86, 101, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 128, 150, 150, 101, 150, 150, 150, 150, 150, 108, 150, 72, 150, 150, 150, 150, 150, 133, 150, 150, 150, 150, 121, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-805.408641763013, -1232.1157907147915, -950.1369354374465, -897.947696879932, -931.887390495572, -792.6139041452797, -335.33602671115256, -120.44573143079329, -900.519055074734, -902.4754780222222, -707.0417325682639, -770.651927401254, -1218.160738872929, -1306.830120786415, -931.5236327569032, -1136.1808092440745, -816.3353646790772, -1221.1339255721653, -709.2281331203976, -1191.2378130037316, -800.6713915051215, -447.233699189845, -383.77394507923566, -750.2600082561523, -743.1920511910799, -991.3508221262682, -569.5884950893413, -1075.2806796705058, -1142.9073293502852, -901.1686120862552, -1159.5453247553057, -1001.8305511401816, -715.5294014025172, -499.6112316434649, -460.60359838947585, -706.823720885677, -45.77427230112284, -485.28876745079396, -839.321040481189, -386.1948866433336, -986.6851139967604, -891.1966463797801, -34.6281420751084, -380.3654472261199, -483.85819580073644, -116.13752378290579, -1018.6009314970439, -769.8416273689469, -705.6541745602487, -49.92014424785405, -1118.0319333030693, -622.1356784167355, -126.87128324718871, -740.6998157567075, -635.7294964788814, -265.06468528031417, -384.44795354349304, -1159.0590365191927, -750.8041141317743, -812.2813661558987, -811.8316379396886, -818.8480014733515, -959.307663249194, -146.48669013343783, -506.3396602749855, -562.1948650826348, -752.2361139427562, -514.4840078921911, -543.249238121198, -506.32981207143894, -396.948736402531, -626.7559836613132, -935.3168712967638, -819.2563235091144, -796.8097457282846, -1014.0283411624766, -240.02552057497425, -1144.7982901432088, -227.04640575766774, -642.6277555365103, -794.7407099276269, -960.3665997509181, -638.0287519975718, -930.5791359627042, -303.9326356220148, -859.4132812451627, -922.4023036512164, -412.2134651040891, -641.5486297073444, -391.0734437658263, -159.0584167764961, -748.6054781137162, -947.6278012061722, -839.9012930527421, -849.5439110755357, -876.974254156451, -1153.5064318105858, -932.4288722742552, -300.7970069411484, -558.4840002630261]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5851210435871664, "mean_inference_ms": 1.7985396535932026, "mean_action_processing_ms": 0.2934743531318237, "mean_env_wait_ms": 3.128956553766926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012887716293334961, "StateBufferConnector_ms": 0.008347511291503906, "ViewRequirementAgentConnector_ms": 0.25348401069641113}, "num_episodes": 28, "episode_return_max": -34.6281420751084, "episode_return_min": -1306.830120786415, "episode_return_mean": -712.2132207344438, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.4406480132582, "num_env_steps_trained_throughput_per_sec": 328.4406480132582, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13015.142, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13015.062, "sample_time_ms": 1314.676, "learn_time_ms": 11624.524, "learn_throughput": 344.1, "synch_weights_time_ms": 74.944}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00012", "date": "2024-08-03_04-17-30", "timestamp": 1722638850, "time_this_iter_s": 12.193215370178223, "time_total_s": 194.85442280769348, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78eef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 194.85442280769348, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 23.276470588235295, "ram_util_percent": 47.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 135.56232200662296, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.365046861271064, "policy_loss": -0.006476976476066435, "vf_loss": 4.366133473316828, "vf_explained_var": 0.9628890367224813, "kl": 0.01200795004260728, "entropy": 1.3212329062322776, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -34.6281420751084, "episode_reward_min": -1159.5453247553057, "episode_reward_mean": -663.9805454366715, "episode_len_mean": 136.86, "episode_media": {}, "episodes_timesteps_total": 13686, "policy_reward_min": {"policy_0": -1159.5453247553057}, "policy_reward_max": {"policy_0": -34.6281420751084}, "policy_reward_mean": {"policy_0": -663.9805454366715}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1159.5453247553057, -1001.8305511401816, -715.5294014025172, -499.6112316434649, -460.60359838947585, -706.823720885677, -45.77427230112284, -485.28876745079396, -839.321040481189, -386.1948866433336, -986.6851139967604, -891.1966463797801, -34.6281420751084, -380.3654472261199, -483.85819580073644, -116.13752378290579, -1018.6009314970439, -769.8416273689469, -705.6541745602487, -49.92014424785405, -1118.0319333030693, -622.1356784167355, -126.87128324718871, -740.6998157567075, -635.7294964788814, -265.06468528031417, -384.44795354349304, -1159.0590365191927, -750.8041141317743, -812.2813661558987, -811.8316379396886, -818.8480014733515, -959.307663249194, -146.48669013343783, -506.3396602749855, -562.1948650826348, -752.2361139427562, -514.4840078921911, -543.249238121198, -506.32981207143894, -396.948736402531, -626.7559836613132, -935.3168712967638, -819.2563235091144, -796.8097457282846, -1014.0283411624766, -240.02552057497425, -1144.7982901432088, -227.04640575766774, -642.6277555365103, -794.7407099276269, -960.3665997509181, -638.0287519975718, -930.5791359627042, -303.9326356220148, -859.4132812451627, -922.4023036512164, -412.2134651040891, -641.5486297073444, -391.0734437658263, -159.0584167764961, -748.6054781137162, -947.6278012061722, -839.9012930527421, -849.5439110755357, -876.974254156451, -1153.5064318105858, -932.4288722742552, -300.7970069411484, -558.4840002630261, -453.2279933459557, -672.3045137915531, -174.35017848789863, -265.3752291544894, -1023.8173339580399, -520.5828842819448, -668.8995747919755, -147.73090541340602, -801.6648502854075, -767.6512699297393, -853.5487019839524, -949.4473728865911, -896.9625250248819, -744.9218761650206, -952.0718561331312, -444.9520409646521, -1104.5242831185212, -252.57948967893302, -1057.1999698602042, -622.2302759783734, -1027.702558288444, -609.6417152618841, -1079.9924676902779, -1026.148762692576, -974.0357154114231, -860.3106675102201, -917.9051737797637, -440.7850944023787, -111.41633779424464, -437.3887343811284], "episode_lengths": [150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 56, 110, 150, 86, 150, 150, 150, 45, 150, 150, 85, 150, 150, 86, 101, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 128, 150, 150, 101, 150, 150, 150, 150, 150, 108, 150, 72, 150, 150, 150, 150, 150, 133, 150, 150, 150, 150, 121, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 113, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 77, 150], "policy_policy_0_reward": [-1159.5453247553057, -1001.8305511401816, -715.5294014025172, -499.6112316434649, -460.60359838947585, -706.823720885677, -45.77427230112284, -485.28876745079396, -839.321040481189, -386.1948866433336, -986.6851139967604, -891.1966463797801, -34.6281420751084, -380.3654472261199, -483.85819580073644, -116.13752378290579, -1018.6009314970439, -769.8416273689469, -705.6541745602487, -49.92014424785405, -1118.0319333030693, -622.1356784167355, -126.87128324718871, -740.6998157567075, -635.7294964788814, -265.06468528031417, -384.44795354349304, -1159.0590365191927, -750.8041141317743, -812.2813661558987, -811.8316379396886, -818.8480014733515, -959.307663249194, -146.48669013343783, -506.3396602749855, -562.1948650826348, -752.2361139427562, -514.4840078921911, -543.249238121198, -506.32981207143894, -396.948736402531, -626.7559836613132, -935.3168712967638, -819.2563235091144, -796.8097457282846, -1014.0283411624766, -240.02552057497425, -1144.7982901432088, -227.04640575766774, -642.6277555365103, -794.7407099276269, -960.3665997509181, -638.0287519975718, -930.5791359627042, -303.9326356220148, -859.4132812451627, -922.4023036512164, -412.2134651040891, -641.5486297073444, -391.0734437658263, -159.0584167764961, -748.6054781137162, -947.6278012061722, -839.9012930527421, -849.5439110755357, -876.974254156451, -1153.5064318105858, -932.4288722742552, -300.7970069411484, -558.4840002630261, -453.2279933459557, -672.3045137915531, -174.35017848789863, -265.3752291544894, -1023.8173339580399, -520.5828842819448, -668.8995747919755, -147.73090541340602, -801.6648502854075, -767.6512699297393, -853.5487019839524, -949.4473728865911, -896.9625250248819, -744.9218761650206, -952.0718561331312, -444.9520409646521, -1104.5242831185212, -252.57948967893302, -1057.1999698602042, -622.2302759783734, -1027.702558288444, -609.6417152618841, -1079.9924676902779, -1026.148762692576, -974.0357154114231, -860.3106675102201, -917.9051737797637, -440.7850944023787, -111.41633779424464, -437.3887343811284]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.593008373995778, "mean_inference_ms": 1.824076052674981, "mean_action_processing_ms": 0.29700232456662917, "mean_env_wait_ms": 3.1650618607938763, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012899398803710938, "StateBufferConnector_ms": 0.008532047271728516, "ViewRequirementAgentConnector_ms": 0.2534918785095215}, "num_episodes": 30, "episode_return_max": -34.6281420751084, "episode_return_min": -1159.5453247553057, "episode_return_mean": -663.9805454366715, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.8130482783354, "num_env_steps_trained_throughput_per_sec": 295.8130482783354, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13079.8, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13079.721, "sample_time_ms": 1312.619, "learn_time_ms": 11691.639, "learn_throughput": 342.125, "synch_weights_time_ms": 74.545}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00012", "date": "2024-08-03_04-17-43", "timestamp": 1722638863, "time_this_iter_s": 13.53476071357727, "time_total_s": 208.38918352127075, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c721b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 208.38918352127075, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 34.889473684210536, "ram_util_percent": 48.073684210526324}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 132.3558162947496, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.332315557450056, "policy_loss": -0.010673687902938885, "vf_loss": 4.336733327805996, "vf_explained_var": 0.9587239705026149, "kl": 0.013929779551229655, "entropy": 1.2485960804546872, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -14.008508430206788, "episode_reward_min": -1278.4279776953488, "episode_reward_mean": -701.6564007571901, "episode_len_mean": 138.82, "episode_media": {}, "episodes_timesteps_total": 13882, "policy_reward_min": {"policy_0": -1278.4279776953488}, "policy_reward_max": {"policy_0": -14.008508430206788}, "policy_reward_mean": {"policy_0": -701.6564007571901}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-812.2813661558987, -811.8316379396886, -818.8480014733515, -959.307663249194, -146.48669013343783, -506.3396602749855, -562.1948650826348, -752.2361139427562, -514.4840078921911, -543.249238121198, -506.32981207143894, -396.948736402531, -626.7559836613132, -935.3168712967638, -819.2563235091144, -796.8097457282846, -1014.0283411624766, -240.02552057497425, -1144.7982901432088, -227.04640575766774, -642.6277555365103, -794.7407099276269, -960.3665997509181, -638.0287519975718, -930.5791359627042, -303.9326356220148, -859.4132812451627, -922.4023036512164, -412.2134651040891, -641.5486297073444, -391.0734437658263, -159.0584167764961, -748.6054781137162, -947.6278012061722, -839.9012930527421, -849.5439110755357, -876.974254156451, -1153.5064318105858, -932.4288722742552, -300.7970069411484, -558.4840002630261, -453.2279933459557, -672.3045137915531, -174.35017848789863, -265.3752291544894, -1023.8173339580399, -520.5828842819448, -668.8995747919755, -147.73090541340602, -801.6648502854075, -767.6512699297393, -853.5487019839524, -949.4473728865911, -896.9625250248819, -744.9218761650206, -952.0718561331312, -444.9520409646521, -1104.5242831185212, -252.57948967893302, -1057.1999698602042, -622.2302759783734, -1027.702558288444, -609.6417152618841, -1079.9924676902779, -1026.148762692576, -974.0357154114231, -860.3106675102201, -917.9051737797637, -440.7850944023787, -111.41633779424464, -437.3887343811284, -877.1413507684392, -72.7621808154463, -940.2586213684718, -760.7900265275824, -955.5162013192197, -895.6003479903528, -825.5773760479934, -1278.4279776953488, -1084.8386012904123, -154.06421006837095, -57.51641575188152, -790.1686763939831, -842.096645438472, -1050.2868178111153, -667.559460288354, -573.266787420611, -806.9490113787862, -890.7317333377207, -1188.3530131409298, -1007.7056355191551, -785.7331564185843, -735.212289877223, -1025.7909869297953, -681.3064175396844, -559.8112611378793, -909.3573946382742, -515.0913298832257, -361.9178355302625, -14.008508430206788], "episode_lengths": [150, 150, 150, 150, 52, 150, 150, 150, 128, 150, 150, 101, 150, 150, 150, 150, 150, 108, 150, 72, 150, 150, 150, 150, 150, 133, 150, 150, 150, 150, 121, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 113, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 77, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 72, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 41], "policy_policy_0_reward": [-812.2813661558987, -811.8316379396886, -818.8480014733515, -959.307663249194, -146.48669013343783, -506.3396602749855, -562.1948650826348, -752.2361139427562, -514.4840078921911, -543.249238121198, -506.32981207143894, -396.948736402531, -626.7559836613132, -935.3168712967638, -819.2563235091144, -796.8097457282846, -1014.0283411624766, -240.02552057497425, -1144.7982901432088, -227.04640575766774, -642.6277555365103, -794.7407099276269, -960.3665997509181, -638.0287519975718, -930.5791359627042, -303.9326356220148, -859.4132812451627, -922.4023036512164, -412.2134651040891, -641.5486297073444, -391.0734437658263, -159.0584167764961, -748.6054781137162, -947.6278012061722, -839.9012930527421, -849.5439110755357, -876.974254156451, -1153.5064318105858, -932.4288722742552, -300.7970069411484, -558.4840002630261, -453.2279933459557, -672.3045137915531, -174.35017848789863, -265.3752291544894, -1023.8173339580399, -520.5828842819448, -668.8995747919755, -147.73090541340602, -801.6648502854075, -767.6512699297393, -853.5487019839524, -949.4473728865911, -896.9625250248819, -744.9218761650206, -952.0718561331312, -444.9520409646521, -1104.5242831185212, -252.57948967893302, -1057.1999698602042, -622.2302759783734, -1027.702558288444, -609.6417152618841, -1079.9924676902779, -1026.148762692576, -974.0357154114231, -860.3106675102201, -917.9051737797637, -440.7850944023787, -111.41633779424464, -437.3887343811284, -877.1413507684392, -72.7621808154463, -940.2586213684718, -760.7900265275824, -955.5162013192197, -895.6003479903528, -825.5773760479934, -1278.4279776953488, -1084.8386012904123, -154.06421006837095, -57.51641575188152, -790.1686763939831, -842.096645438472, -1050.2868178111153, -667.559460288354, -573.266787420611, -806.9490113787862, -890.7317333377207, -1188.3530131409298, -1007.7056355191551, -785.7331564185843, -735.212289877223, -1025.7909869297953, -681.3064175396844, -559.8112611378793, -909.3573946382742, -515.0913298832257, -361.9178355302625, -14.008508430206788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5947397583876491, "mean_inference_ms": 1.8306375033559377, "mean_action_processing_ms": 0.2977453987032978, "mean_env_wait_ms": 3.1767629037827616, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013006448745727539, "StateBufferConnector_ms": 0.008682966232299805, "ViewRequirementAgentConnector_ms": 0.21907663345336914}, "num_episodes": 29, "episode_return_max": -14.008508430206788, "episode_return_min": -1278.4279776953488, "episode_return_mean": -701.6564007571901, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.1630563789262, "num_env_steps_trained_throughput_per_sec": 296.1630563789262, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13082.709, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13082.63, "sample_time_ms": 1316.481, "learn_time_ms": 11697.156, "learn_throughput": 341.963, "synch_weights_time_ms": 68.14}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00012", "date": "2024-08-03_04-17-57", "timestamp": 1722638877, "time_this_iter_s": 13.51988673210144, "time_total_s": 221.9090702533722, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c785120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 221.9090702533722, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 22.942105263157895, "ram_util_percent": 48.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.10580248236656, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.599486710131169, "policy_loss": -0.0061856327704542, "vf_loss": 4.599338564028343, "vf_explained_var": 0.9537482501938939, "kl": 0.014101257119727983, "entropy": 1.1792727828646699, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -14.008508430206788, "episode_reward_min": -1354.3327868313902, "episode_reward_mean": -701.7010015120752, "episode_len_mean": 137.29, "episode_media": {}, "episodes_timesteps_total": 13729, "policy_reward_min": {"policy_0": -1354.3327868313902}, "policy_reward_max": {"policy_0": -14.008508430206788}, "policy_reward_mean": {"policy_0": -701.7010015120752}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-641.5486297073444, -391.0734437658263, -159.0584167764961, -748.6054781137162, -947.6278012061722, -839.9012930527421, -849.5439110755357, -876.974254156451, -1153.5064318105858, -932.4288722742552, -300.7970069411484, -558.4840002630261, -453.2279933459557, -672.3045137915531, -174.35017848789863, -265.3752291544894, -1023.8173339580399, -520.5828842819448, -668.8995747919755, -147.73090541340602, -801.6648502854075, -767.6512699297393, -853.5487019839524, -949.4473728865911, -896.9625250248819, -744.9218761650206, -952.0718561331312, -444.9520409646521, -1104.5242831185212, -252.57948967893302, -1057.1999698602042, -622.2302759783734, -1027.702558288444, -609.6417152618841, -1079.9924676902779, -1026.148762692576, -974.0357154114231, -860.3106675102201, -917.9051737797637, -440.7850944023787, -111.41633779424464, -437.3887343811284, -877.1413507684392, -72.7621808154463, -940.2586213684718, -760.7900265275824, -955.5162013192197, -895.6003479903528, -825.5773760479934, -1278.4279776953488, -1084.8386012904123, -154.06421006837095, -57.51641575188152, -790.1686763939831, -842.096645438472, -1050.2868178111153, -667.559460288354, -573.266787420611, -806.9490113787862, -890.7317333377207, -1188.3530131409298, -1007.7056355191551, -785.7331564185843, -735.212289877223, -1025.7909869297953, -681.3064175396844, -559.8112611378793, -909.3573946382742, -515.0913298832257, -361.9178355302625, -14.008508430206788, -833.4728730552956, -792.900258423524, -818.7657298227807, -1121.4817326918014, -139.1246618250774, -923.0683323711445, -776.1854377745378, -53.86164031399078, -16.46789287242181, -297.16098274561125, -688.6236463162405, -1354.3327868313902, -228.16529032744896, -882.9555075584641, -614.373631784798, -855.5253576179261, -948.4711508195801, -570.6636775975726, -793.9824355258208, -752.1192085367061, -327.8764797033138, -893.4508955915967, -1055.601565869094, -404.18335577340673, -963.9766561809407, -625.2359883197764, -838.0441066276443, -910.6917263860845, -122.57697959543879], "episode_lengths": [150, 121, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 113, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 77, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 72, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 41, 150, 150, 150, 150, 73, 150, 150, 64, 48, 120, 150, 150, 85, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79], "policy_policy_0_reward": [-641.5486297073444, -391.0734437658263, -159.0584167764961, -748.6054781137162, -947.6278012061722, -839.9012930527421, -849.5439110755357, -876.974254156451, -1153.5064318105858, -932.4288722742552, -300.7970069411484, -558.4840002630261, -453.2279933459557, -672.3045137915531, -174.35017848789863, -265.3752291544894, -1023.8173339580399, -520.5828842819448, -668.8995747919755, -147.73090541340602, -801.6648502854075, -767.6512699297393, -853.5487019839524, -949.4473728865911, -896.9625250248819, -744.9218761650206, -952.0718561331312, -444.9520409646521, -1104.5242831185212, -252.57948967893302, -1057.1999698602042, -622.2302759783734, -1027.702558288444, -609.6417152618841, -1079.9924676902779, -1026.148762692576, -974.0357154114231, -860.3106675102201, -917.9051737797637, -440.7850944023787, -111.41633779424464, -437.3887343811284, -877.1413507684392, -72.7621808154463, -940.2586213684718, -760.7900265275824, -955.5162013192197, -895.6003479903528, -825.5773760479934, -1278.4279776953488, -1084.8386012904123, -154.06421006837095, -57.51641575188152, -790.1686763939831, -842.096645438472, -1050.2868178111153, -667.559460288354, -573.266787420611, -806.9490113787862, -890.7317333377207, -1188.3530131409298, -1007.7056355191551, -785.7331564185843, -735.212289877223, -1025.7909869297953, -681.3064175396844, -559.8112611378793, -909.3573946382742, -515.0913298832257, -361.9178355302625, -14.008508430206788, -833.4728730552956, -792.900258423524, -818.7657298227807, -1121.4817326918014, -139.1246618250774, -923.0683323711445, -776.1854377745378, -53.86164031399078, -16.46789287242181, -297.16098274561125, -688.6236463162405, -1354.3327868313902, -228.16529032744896, -882.9555075584641, -614.373631784798, -855.5253576179261, -948.4711508195801, -570.6636775975726, -793.9824355258208, -752.1192085367061, -327.8764797033138, -893.4508955915967, -1055.601565869094, -404.18335577340673, -963.9766561809407, -625.2359883197764, -838.0441066276443, -910.6917263860845, -122.57697959543879]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5946220170217174, "mean_inference_ms": 1.8272771004552124, "mean_action_processing_ms": 0.2972578394784862, "mean_env_wait_ms": 3.1738078702927766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012560606002807617, "StateBufferConnector_ms": 0.008428573608398438, "ViewRequirementAgentConnector_ms": 0.2001488208770752}, "num_episodes": 29, "episode_return_max": -14.008508430206788, "episode_return_min": -1354.3327868313902, "episode_return_mean": -701.7010015120752, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.6036240595959, "num_env_steps_trained_throughput_per_sec": 338.6036240595959, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12975.314, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12975.237, "sample_time_ms": 1336.374, "learn_time_ms": 11571.468, "learn_throughput": 345.678, "synch_weights_time_ms": 66.539}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00012", "date": "2024-08-03_04-18-09", "timestamp": 1722638889, "time_this_iter_s": 11.824653625488281, "time_total_s": 233.73372387886047, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c784160>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 233.73372387886047, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 49.311764705882354, "ram_util_percent": 48.15882352941178}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 166.32342003385227, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.1203880878786245, "policy_loss": -0.0034531900305106926, "vf_loss": 4.11785088951389, "vf_explained_var": 0.96819283037136, "kl": 0.013338861422077287, "entropy": 1.2107071816300352, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -14.008508430206788, "episode_reward_min": -1354.3327868313902, "episode_reward_mean": -720.3373536127481, "episode_len_mean": 137.28, "episode_media": {}, "episodes_timesteps_total": 13728, "policy_reward_min": {"policy_0": -1354.3327868313902}, "policy_reward_max": {"policy_0": -14.008508430206788}, "policy_reward_mean": {"policy_0": -720.3373536127481}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-622.2302759783734, -1027.702558288444, -609.6417152618841, -1079.9924676902779, -1026.148762692576, -974.0357154114231, -860.3106675102201, -917.9051737797637, -440.7850944023787, -111.41633779424464, -437.3887343811284, -877.1413507684392, -72.7621808154463, -940.2586213684718, -760.7900265275824, -955.5162013192197, -895.6003479903528, -825.5773760479934, -1278.4279776953488, -1084.8386012904123, -154.06421006837095, -57.51641575188152, -790.1686763939831, -842.096645438472, -1050.2868178111153, -667.559460288354, -573.266787420611, -806.9490113787862, -890.7317333377207, -1188.3530131409298, -1007.7056355191551, -785.7331564185843, -735.212289877223, -1025.7909869297953, -681.3064175396844, -559.8112611378793, -909.3573946382742, -515.0913298832257, -361.9178355302625, -14.008508430206788, -833.4728730552956, -792.900258423524, -818.7657298227807, -1121.4817326918014, -139.1246618250774, -923.0683323711445, -776.1854377745378, -53.86164031399078, -16.46789287242181, -297.16098274561125, -688.6236463162405, -1354.3327868313902, -228.16529032744896, -882.9555075584641, -614.373631784798, -855.5253576179261, -948.4711508195801, -570.6636775975726, -793.9824355258208, -752.1192085367061, -327.8764797033138, -893.4508955915967, -1055.601565869094, -404.18335577340673, -963.9766561809407, -625.2359883197764, -838.0441066276443, -910.6917263860845, -122.57697959543879, -468.25605216843223, -881.8972438479238, -1045.8620105230593, -842.1701914799999, -550.8162079085716, -846.114033114128, -792.1510386808138, -696.9941961066187, -612.2233103865785, -867.6921973043247, -164.2756582186375, -747.666348668762, -771.1129346495953, -456.41556583474454, -133.7127737112129, -1136.8016999311628, -968.7199197193695, -887.3998894440844, -1060.2630827293365, -945.934939912351, -690.4901049908382, -1039.0127383323345, -868.9072882976061, -629.3213499977746, -212.84766738960369, -988.1159136550089, -1048.4872643028323, -945.6784056912126, -729.7030013732488, -45.57410919762328, -940.3804608990995], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 121, 77, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 72, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 41, 150, 150, 150, 150, 73, 150, 150, 64, 48, 120, 150, 150, 85, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 136, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 150, 138, 63, 150], "policy_policy_0_reward": [-622.2302759783734, -1027.702558288444, -609.6417152618841, -1079.9924676902779, -1026.148762692576, -974.0357154114231, -860.3106675102201, -917.9051737797637, -440.7850944023787, -111.41633779424464, -437.3887343811284, -877.1413507684392, -72.7621808154463, -940.2586213684718, -760.7900265275824, -955.5162013192197, -895.6003479903528, -825.5773760479934, -1278.4279776953488, -1084.8386012904123, -154.06421006837095, -57.51641575188152, -790.1686763939831, -842.096645438472, -1050.2868178111153, -667.559460288354, -573.266787420611, -806.9490113787862, -890.7317333377207, -1188.3530131409298, -1007.7056355191551, -785.7331564185843, -735.212289877223, -1025.7909869297953, -681.3064175396844, -559.8112611378793, -909.3573946382742, -515.0913298832257, -361.9178355302625, -14.008508430206788, -833.4728730552956, -792.900258423524, -818.7657298227807, -1121.4817326918014, -139.1246618250774, -923.0683323711445, -776.1854377745378, -53.86164031399078, -16.46789287242181, -297.16098274561125, -688.6236463162405, -1354.3327868313902, -228.16529032744896, -882.9555075584641, -614.373631784798, -855.5253576179261, -948.4711508195801, -570.6636775975726, -793.9824355258208, -752.1192085367061, -327.8764797033138, -893.4508955915967, -1055.601565869094, -404.18335577340673, -963.9766561809407, -625.2359883197764, -838.0441066276443, -910.6917263860845, -122.57697959543879, -468.25605216843223, -881.8972438479238, -1045.8620105230593, -842.1701914799999, -550.8162079085716, -846.114033114128, -792.1510386808138, -696.9941961066187, -612.2233103865785, -867.6921973043247, -164.2756582186375, -747.666348668762, -771.1129346495953, -456.41556583474454, -133.7127737112129, -1136.8016999311628, -968.7199197193695, -887.3998894440844, -1060.2630827293365, -945.934939912351, -690.4901049908382, -1039.0127383323345, -868.9072882976061, -629.3213499977746, -212.84766738960369, -988.1159136550089, -1048.4872643028323, -945.6784056912126, -729.7030013732488, -45.57410919762328, -940.3804608990995]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5956621420308784, "mean_inference_ms": 1.8249485451355023, "mean_action_processing_ms": 0.2966906786449462, "mean_env_wait_ms": 3.173955731582895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012615442276000977, "StateBufferConnector_ms": 0.008263826370239258, "ViewRequirementAgentConnector_ms": 0.20011210441589355}, "num_episodes": 31, "episode_return_max": -14.008508430206788, "episode_return_min": -1354.3327868313902, "episode_return_mean": -720.3373536127481, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.63281102532994, "num_env_steps_trained_throughput_per_sec": 293.63281102532994, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12987.909, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12987.831, "sample_time_ms": 1333.912, "learn_time_ms": 11585.95, "learn_throughput": 345.246, "synch_weights_time_ms": 67.1}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00012", "date": "2024-08-03_04-18-23", "timestamp": 1722638903, "time_this_iter_s": 13.636307001113892, "time_total_s": 247.37003087997437, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c787010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 247.37003087997437, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 22.325, "ram_util_percent": 48.20000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 162.66709767977397, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.090790783862273, "policy_loss": -0.007781910921039525, "vf_loss": 4.09295626009504, "vf_explained_var": 0.963333779387176, "kl": 0.012504018580996975, "entropy": 1.037673023280998, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -14.008508430206788, "episode_reward_min": -1354.3327868313902, "episode_reward_mean": -718.2306846933304, "episode_len_mean": 137.49, "episode_media": {}, "episodes_timesteps_total": 13749, "policy_reward_min": {"policy_0": -1354.3327868313902}, "policy_reward_max": {"policy_0": -14.008508430206788}, "policy_reward_mean": {"policy_0": -718.2306846933304}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-890.7317333377207, -1188.3530131409298, -1007.7056355191551, -785.7331564185843, -735.212289877223, -1025.7909869297953, -681.3064175396844, -559.8112611378793, -909.3573946382742, -515.0913298832257, -361.9178355302625, -14.008508430206788, -833.4728730552956, -792.900258423524, -818.7657298227807, -1121.4817326918014, -139.1246618250774, -923.0683323711445, -776.1854377745378, -53.86164031399078, -16.46789287242181, -297.16098274561125, -688.6236463162405, -1354.3327868313902, -228.16529032744896, -882.9555075584641, -614.373631784798, -855.5253576179261, -948.4711508195801, -570.6636775975726, -793.9824355258208, -752.1192085367061, -327.8764797033138, -893.4508955915967, -1055.601565869094, -404.18335577340673, -963.9766561809407, -625.2359883197764, -838.0441066276443, -910.6917263860845, -122.57697959543879, -468.25605216843223, -881.8972438479238, -1045.8620105230593, -842.1701914799999, -550.8162079085716, -846.114033114128, -792.1510386808138, -696.9941961066187, -612.2233103865785, -867.6921973043247, -164.2756582186375, -747.666348668762, -771.1129346495953, -456.41556583474454, -133.7127737112129, -1136.8016999311628, -968.7199197193695, -887.3998894440844, -1060.2630827293365, -945.934939912351, -690.4901049908382, -1039.0127383323345, -868.9072882976061, -629.3213499977746, -212.84766738960369, -988.1159136550089, -1048.4872643028323, -945.6784056912126, -729.7030013732488, -45.57410919762328, -940.3804608990995, -1071.7868015146278, -985.906789180643, -991.8906181831347, -826.5759408149759, -892.7387146955025, -204.08977215160468, -602.8721276479738, -671.50772700107, -721.3534074357314, -1081.2532049511854, -763.1419746920361, -729.0326842369846, -820.0968292806086, -166.78832165262588, -1286.8304146720357, -617.3869093341943, -817.9408050724489, -459.48978117774834, -85.56276716570895, -819.8369202656888, -641.7664267914922, -907.9132144948087, -557.6901394182199, -967.1320794498151, -709.8288701847615, -444.0340644865886, -1056.3357533795854, -628.9282602919791], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 41, 150, 150, 150, 150, 73, 150, 150, 64, 48, 120, 150, 150, 85, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 136, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 150, 138, 63, 150, 150, 150, 150, 150, 150, 65, 129, 150, 150, 150, 150, 141, 150, 80, 150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 111, 150, 150], "policy_policy_0_reward": [-890.7317333377207, -1188.3530131409298, -1007.7056355191551, -785.7331564185843, -735.212289877223, -1025.7909869297953, -681.3064175396844, -559.8112611378793, -909.3573946382742, -515.0913298832257, -361.9178355302625, -14.008508430206788, -833.4728730552956, -792.900258423524, -818.7657298227807, -1121.4817326918014, -139.1246618250774, -923.0683323711445, -776.1854377745378, -53.86164031399078, -16.46789287242181, -297.16098274561125, -688.6236463162405, -1354.3327868313902, -228.16529032744896, -882.9555075584641, -614.373631784798, -855.5253576179261, -948.4711508195801, -570.6636775975726, -793.9824355258208, -752.1192085367061, -327.8764797033138, -893.4508955915967, -1055.601565869094, -404.18335577340673, -963.9766561809407, -625.2359883197764, -838.0441066276443, -910.6917263860845, -122.57697959543879, -468.25605216843223, -881.8972438479238, -1045.8620105230593, -842.1701914799999, -550.8162079085716, -846.114033114128, -792.1510386808138, -696.9941961066187, -612.2233103865785, -867.6921973043247, -164.2756582186375, -747.666348668762, -771.1129346495953, -456.41556583474454, -133.7127737112129, -1136.8016999311628, -968.7199197193695, -887.3998894440844, -1060.2630827293365, -945.934939912351, -690.4901049908382, -1039.0127383323345, -868.9072882976061, -629.3213499977746, -212.84766738960369, -988.1159136550089, -1048.4872643028323, -945.6784056912126, -729.7030013732488, -45.57410919762328, -940.3804608990995, -1071.7868015146278, -985.906789180643, -991.8906181831347, -826.5759408149759, -892.7387146955025, -204.08977215160468, -602.8721276479738, -671.50772700107, -721.3534074357314, -1081.2532049511854, -763.1419746920361, -729.0326842369846, -820.0968292806086, -166.78832165262588, -1286.8304146720357, -617.3869093341943, -817.9408050724489, -459.48978117774834, -85.56276716570895, -819.8369202656888, -641.7664267914922, -907.9132144948087, -557.6901394182199, -967.1320794498151, -709.8288701847615, -444.0340644865886, -1056.3357533795854, -628.9282602919791]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5961148402327571, "mean_inference_ms": 1.8247008298559435, "mean_action_processing_ms": 0.29681212696987, "mean_env_wait_ms": 3.1726344558484065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012013673782348633, "StateBufferConnector_ms": 0.008029699325561523, "ViewRequirementAgentConnector_ms": 0.20094060897827148}, "num_episodes": 28, "episode_return_max": -14.008508430206788, "episode_return_min": -1354.3327868313902, "episode_return_mean": -718.2306846933304, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 324.98159907638774, "num_env_steps_trained_throughput_per_sec": 324.98159907638774, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12882.327, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12882.246, "sample_time_ms": 1339.567, "learn_time_ms": 11473.516, "learn_throughput": 348.629, "synch_weights_time_ms": 68.281}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00012", "date": "2024-08-03_04-18-35", "timestamp": 1722638915, "time_this_iter_s": 12.322174787521362, "time_total_s": 259.6922056674957, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70bc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 259.6922056674957, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 40.2235294117647, "ram_util_percent": 48.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 163.62318888902664, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.341678233941396, "policy_loss": -0.007595656472646321, "vf_loss": 4.344287507484356, "vf_explained_var": 0.9719095117722948, "kl": 0.011104988512230799, "entropy": 1.084945402915279, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -45.57410919762328, "episode_reward_min": -1341.1447414938436, "episode_reward_mean": -714.9698379990649, "episode_len_mean": 137.89, "episode_media": {}, "episodes_timesteps_total": 13789, "policy_reward_min": {"policy_0": -1341.1447414938436}, "policy_reward_max": {"policy_0": -45.57410919762328}, "policy_reward_mean": {"policy_0": -714.9698379990649}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-793.9824355258208, -752.1192085367061, -327.8764797033138, -893.4508955915967, -1055.601565869094, -404.18335577340673, -963.9766561809407, -625.2359883197764, -838.0441066276443, -910.6917263860845, -122.57697959543879, -468.25605216843223, -881.8972438479238, -1045.8620105230593, -842.1701914799999, -550.8162079085716, -846.114033114128, -792.1510386808138, -696.9941961066187, -612.2233103865785, -867.6921973043247, -164.2756582186375, -747.666348668762, -771.1129346495953, -456.41556583474454, -133.7127737112129, -1136.8016999311628, -968.7199197193695, -887.3998894440844, -1060.2630827293365, -945.934939912351, -690.4901049908382, -1039.0127383323345, -868.9072882976061, -629.3213499977746, -212.84766738960369, -988.1159136550089, -1048.4872643028323, -945.6784056912126, -729.7030013732488, -45.57410919762328, -940.3804608990995, -1071.7868015146278, -985.906789180643, -991.8906181831347, -826.5759408149759, -892.7387146955025, -204.08977215160468, -602.8721276479738, -671.50772700107, -721.3534074357314, -1081.2532049511854, -763.1419746920361, -729.0326842369846, -820.0968292806086, -166.78832165262588, -1286.8304146720357, -617.3869093341943, -817.9408050724489, -459.48978117774834, -85.56276716570895, -819.8369202656888, -641.7664267914922, -907.9132144948087, -557.6901394182199, -967.1320794498151, -709.8288701847615, -444.0340644865886, -1056.3357533795854, -628.9282602919791, -215.48404990152767, -208.348982026994, -1341.1447414938436, -730.7016756563296, -959.6007953207929, -625.7588335674004, -843.904254272602, -389.8418516786665, -844.1219678641318, -191.21373996938055, -829.1991910058329, -920.8532649156266, -257.23333781514845, -421.70414767882056, -728.3829899862577, -147.72052590965575, -1118.2045083659466, -241.82576776161142, -519.0403065491106, -940.8022467603391, -717.9076356191506, -1122.1528419648153, -140.99916369557403, -511.42453199733853, -1031.935653794993, -932.2764878630234, -581.8911157665214, -1074.4260567927683, -644.8659911622343, -1031.5688265495442], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 79, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 136, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 150, 138, 63, 150, 150, 150, 150, 150, 150, 65, 129, 150, 150, 150, 150, 141, 150, 80, 150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 111, 150, 150, 111, 77, 150, 138, 150, 150, 150, 132, 150, 72, 150, 150, 107, 143, 150, 59, 150, 107, 150, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-793.9824355258208, -752.1192085367061, -327.8764797033138, -893.4508955915967, -1055.601565869094, -404.18335577340673, -963.9766561809407, -625.2359883197764, -838.0441066276443, -910.6917263860845, -122.57697959543879, -468.25605216843223, -881.8972438479238, -1045.8620105230593, -842.1701914799999, -550.8162079085716, -846.114033114128, -792.1510386808138, -696.9941961066187, -612.2233103865785, -867.6921973043247, -164.2756582186375, -747.666348668762, -771.1129346495953, -456.41556583474454, -133.7127737112129, -1136.8016999311628, -968.7199197193695, -887.3998894440844, -1060.2630827293365, -945.934939912351, -690.4901049908382, -1039.0127383323345, -868.9072882976061, -629.3213499977746, -212.84766738960369, -988.1159136550089, -1048.4872643028323, -945.6784056912126, -729.7030013732488, -45.57410919762328, -940.3804608990995, -1071.7868015146278, -985.906789180643, -991.8906181831347, -826.5759408149759, -892.7387146955025, -204.08977215160468, -602.8721276479738, -671.50772700107, -721.3534074357314, -1081.2532049511854, -763.1419746920361, -729.0326842369846, -820.0968292806086, -166.78832165262588, -1286.8304146720357, -617.3869093341943, -817.9408050724489, -459.48978117774834, -85.56276716570895, -819.8369202656888, -641.7664267914922, -907.9132144948087, -557.6901394182199, -967.1320794498151, -709.8288701847615, -444.0340644865886, -1056.3357533795854, -628.9282602919791, -215.48404990152767, -208.348982026994, -1341.1447414938436, -730.7016756563296, -959.6007953207929, -625.7588335674004, -843.904254272602, -389.8418516786665, -844.1219678641318, -191.21373996938055, -829.1991910058329, -920.8532649156266, -257.23333781514845, -421.70414767882056, -728.3829899862577, -147.72052590965575, -1118.2045083659466, -241.82576776161142, -519.0403065491106, -940.8022467603391, -717.9076356191506, -1122.1528419648153, -140.99916369557403, -511.42453199733853, -1031.935653794993, -932.2764878630234, -581.8911157665214, -1074.4260567927683, -644.8659911622343, -1031.5688265495442]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.595164139810051, "mean_inference_ms": 1.8201698552605023, "mean_action_processing_ms": 0.2959979756882769, "mean_env_wait_ms": 3.1690988393970065, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011906623840332031, "StateBufferConnector_ms": 0.008030176162719727, "ViewRequirementAgentConnector_ms": 0.1997213363647461}, "num_episodes": 30, "episode_return_max": -45.57410919762328, "episode_return_min": -1341.1447414938436, "episode_return_mean": -714.9698379990649, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.58772407356133, "num_env_steps_trained_throughput_per_sec": 356.58772407356133, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12702.014, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12701.932, "sample_time_ms": 1331.602, "learn_time_ms": 11297.538, "learn_throughput": 354.059, "synch_weights_time_ms": 71.898}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00012", "date": "2024-08-03_04-18-46", "timestamp": 1722638926, "time_this_iter_s": 11.227629899978638, "time_total_s": 270.91983556747437, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70bac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 270.91983556747437, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 23.875, "ram_util_percent": 48.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 180.53926535050076, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.2573049161583185, "policy_loss": -0.01119991541102839, "vf_loss": 4.261614129692316, "vf_explained_var": 0.9783561946824193, "kl": 0.015335461256836448, "entropy": 1.0259978658830127, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -31.8689423139001, "episode_reward_min": -1341.1447414938436, "episode_reward_mean": -706.3893595659204, "episode_len_mean": 136.7, "episode_media": {}, "episodes_timesteps_total": 13670, "policy_reward_min": {"policy_0": -1341.1447414938436}, "policy_reward_max": {"policy_0": -31.8689423139001}, "policy_reward_mean": {"policy_0": -706.3893595659204}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-945.934939912351, -690.4901049908382, -1039.0127383323345, -868.9072882976061, -629.3213499977746, -212.84766738960369, -988.1159136550089, -1048.4872643028323, -945.6784056912126, -729.7030013732488, -45.57410919762328, -940.3804608990995, -1071.7868015146278, -985.906789180643, -991.8906181831347, -826.5759408149759, -892.7387146955025, -204.08977215160468, -602.8721276479738, -671.50772700107, -721.3534074357314, -1081.2532049511854, -763.1419746920361, -729.0326842369846, -820.0968292806086, -166.78832165262588, -1286.8304146720357, -617.3869093341943, -817.9408050724489, -459.48978117774834, -85.56276716570895, -819.8369202656888, -641.7664267914922, -907.9132144948087, -557.6901394182199, -967.1320794498151, -709.8288701847615, -444.0340644865886, -1056.3357533795854, -628.9282602919791, -215.48404990152767, -208.348982026994, -1341.1447414938436, -730.7016756563296, -959.6007953207929, -625.7588335674004, -843.904254272602, -389.8418516786665, -844.1219678641318, -191.21373996938055, -829.1991910058329, -920.8532649156266, -257.23333781514845, -421.70414767882056, -728.3829899862577, -147.72052590965575, -1118.2045083659466, -241.82576776161142, -519.0403065491106, -940.8022467603391, -717.9076356191506, -1122.1528419648153, -140.99916369557403, -511.42453199733853, -1031.935653794993, -932.2764878630234, -581.8911157665214, -1074.4260567927683, -644.8659911622343, -1031.5688265495442, -1011.6801161986988, -190.4250788371174, -456.54968287462725, -1090.739778166882, -1091.459123032306, -899.4915909262567, -573.2629946677248, -102.58972334093991, -792.0659628658531, -1012.3817465215728, -909.2750127689629, -31.8689423139001, -945.5148185037087, -595.3182747875627, -750.6431085915324, -530.2742916272771, -764.7740401833701, -1044.6725303124806, -194.54475786599846, -329.1506607515037, -446.0703513169092, -732.9930751857258, -492.31025189741007, -1083.637264436557, -975.5453888948515, -711.16503045573, -987.5705336882734, -754.5513327753415, -766.4092473340389, -493.3011980996293], "episode_lengths": [150, 150, 150, 150, 150, 91, 150, 150, 150, 138, 63, 150, 150, 150, 150, 150, 150, 65, 129, 150, 150, 150, 150, 141, 150, 80, 150, 150, 150, 150, 49, 150, 150, 150, 150, 150, 150, 111, 150, 150, 111, 77, 150, 138, 150, 150, 150, 132, 150, 72, 150, 150, 107, 143, 150, 59, 150, 107, 150, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 66, 150, 150, 150, 44, 150, 122, 150, 150, 150, 150, 105, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147], "policy_policy_0_reward": [-945.934939912351, -690.4901049908382, -1039.0127383323345, -868.9072882976061, -629.3213499977746, -212.84766738960369, -988.1159136550089, -1048.4872643028323, -945.6784056912126, -729.7030013732488, -45.57410919762328, -940.3804608990995, -1071.7868015146278, -985.906789180643, -991.8906181831347, -826.5759408149759, -892.7387146955025, -204.08977215160468, -602.8721276479738, -671.50772700107, -721.3534074357314, -1081.2532049511854, -763.1419746920361, -729.0326842369846, -820.0968292806086, -166.78832165262588, -1286.8304146720357, -617.3869093341943, -817.9408050724489, -459.48978117774834, -85.56276716570895, -819.8369202656888, -641.7664267914922, -907.9132144948087, -557.6901394182199, -967.1320794498151, -709.8288701847615, -444.0340644865886, -1056.3357533795854, -628.9282602919791, -215.48404990152767, -208.348982026994, -1341.1447414938436, -730.7016756563296, -959.6007953207929, -625.7588335674004, -843.904254272602, -389.8418516786665, -844.1219678641318, -191.21373996938055, -829.1991910058329, -920.8532649156266, -257.23333781514845, -421.70414767882056, -728.3829899862577, -147.72052590965575, -1118.2045083659466, -241.82576776161142, -519.0403065491106, -940.8022467603391, -717.9076356191506, -1122.1528419648153, -140.99916369557403, -511.42453199733853, -1031.935653794993, -932.2764878630234, -581.8911157665214, -1074.4260567927683, -644.8659911622343, -1031.5688265495442, -1011.6801161986988, -190.4250788371174, -456.54968287462725, -1090.739778166882, -1091.459123032306, -899.4915909262567, -573.2629946677248, -102.58972334093991, -792.0659628658531, -1012.3817465215728, -909.2750127689629, -31.8689423139001, -945.5148185037087, -595.3182747875627, -750.6431085915324, -530.2742916272771, -764.7740401833701, -1044.6725303124806, -194.54475786599846, -329.1506607515037, -446.0703513169092, -732.9930751857258, -492.31025189741007, -1083.637264436557, -975.5453888948515, -711.16503045573, -987.5705336882734, -754.5513327753415, -766.4092473340389, -493.3011980996293]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5926239938087547, "mean_inference_ms": 1.8142834023056016, "mean_action_processing_ms": 0.2951630408726922, "mean_env_wait_ms": 3.1617352775094405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011895179748535156, "StateBufferConnector_ms": 0.00799560546875, "ViewRequirementAgentConnector_ms": 0.19754457473754883}, "num_episodes": 30, "episode_return_max": -31.8689423139001, "episode_return_min": -1341.1447414938436, "episode_return_mean": -706.3893595659204, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 327.5711401767557, "num_env_steps_trained_throughput_per_sec": 327.5711401767557, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12844.839, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12844.757, "sample_time_ms": 1340.622, "learn_time_ms": 11432.388, "learn_throughput": 349.883, "synch_weights_time_ms": 70.89}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00012", "date": "2024-08-03_04-18-58", "timestamp": 1722638938, "time_this_iter_s": 12.222688913345337, "time_total_s": 283.1425244808197, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7867a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.1425244808197, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 38.90555555555555, "ram_util_percent": 48.266666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 169.99743647575377, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.479787574211756, "policy_loss": -0.01521301135023047, "vf_loss": 4.487676562617223, "vf_explained_var": 0.976809873431921, "kl": 0.016300532666233873, "entropy": 1.1221995865926147, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -23.268884801512613, "episode_reward_min": -1341.1447414938436, "episode_reward_mean": -662.3590163567253, "episode_len_mean": 133.55, "episode_media": {}, "episodes_timesteps_total": 13355, "policy_reward_min": {"policy_0": -1341.1447414938436}, "policy_reward_max": {"policy_0": -23.268884801512613}, "policy_reward_mean": {"policy_0": -662.3590163567253}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-85.56276716570895, -819.8369202656888, -641.7664267914922, -907.9132144948087, -557.6901394182199, -967.1320794498151, -709.8288701847615, -444.0340644865886, -1056.3357533795854, -628.9282602919791, -215.48404990152767, -208.348982026994, -1341.1447414938436, -730.7016756563296, -959.6007953207929, -625.7588335674004, -843.904254272602, -389.8418516786665, -844.1219678641318, -191.21373996938055, -829.1991910058329, -920.8532649156266, -257.23333781514845, -421.70414767882056, -728.3829899862577, -147.72052590965575, -1118.2045083659466, -241.82576776161142, -519.0403065491106, -940.8022467603391, -717.9076356191506, -1122.1528419648153, -140.99916369557403, -511.42453199733853, -1031.935653794993, -932.2764878630234, -581.8911157665214, -1074.4260567927683, -644.8659911622343, -1031.5688265495442, -1011.6801161986988, -190.4250788371174, -456.54968287462725, -1090.739778166882, -1091.459123032306, -899.4915909262567, -573.2629946677248, -102.58972334093991, -792.0659628658531, -1012.3817465215728, -909.2750127689629, -31.8689423139001, -945.5148185037087, -595.3182747875627, -750.6431085915324, -530.2742916272771, -764.7740401833701, -1044.6725303124806, -194.54475786599846, -329.1506607515037, -446.0703513169092, -732.9930751857258, -492.31025189741007, -1083.637264436557, -975.5453888948515, -711.16503045573, -987.5705336882734, -754.5513327753415, -766.4092473340389, -493.3011980996293, -126.00305770782059, -215.41837934350116, -1265.9689630430835, -514.2113012714492, -747.377742877136, -949.1785918056333, -405.18150820365565, -56.18427858868257, -539.3665269353944, -443.1948413120508, -812.074841273978, -748.4503907261138, -523.2855708618647, -710.19976859781, -747.7643602528774, -462.7980418153677, -1154.4697071744913, -23.268884801512613, -753.330807596121, -104.2509212609181, -322.5619233105065, -1019.1974452556346, -136.72393414138833, -83.69959946994888, -492.38058691692106, -953.6198630482551, -812.4774137360417, -1162.7850190745241, -933.788796611885, -1172.8886798005985], "episode_lengths": [49, 150, 150, 150, 150, 150, 150, 111, 150, 150, 111, 77, 150, 138, 150, 150, 150, 132, 150, 72, 150, 150, 107, 143, 150, 59, 150, 107, 150, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 66, 150, 150, 150, 44, 150, 122, 150, 150, 150, 150, 105, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 56, 87, 150, 150, 150, 150, 97, 64, 150, 106, 150, 150, 150, 150, 150, 150, 150, 43, 150, 82, 150, 150, 84, 73, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-85.56276716570895, -819.8369202656888, -641.7664267914922, -907.9132144948087, -557.6901394182199, -967.1320794498151, -709.8288701847615, -444.0340644865886, -1056.3357533795854, -628.9282602919791, -215.48404990152767, -208.348982026994, -1341.1447414938436, -730.7016756563296, -959.6007953207929, -625.7588335674004, -843.904254272602, -389.8418516786665, -844.1219678641318, -191.21373996938055, -829.1991910058329, -920.8532649156266, -257.23333781514845, -421.70414767882056, -728.3829899862577, -147.72052590965575, -1118.2045083659466, -241.82576776161142, -519.0403065491106, -940.8022467603391, -717.9076356191506, -1122.1528419648153, -140.99916369557403, -511.42453199733853, -1031.935653794993, -932.2764878630234, -581.8911157665214, -1074.4260567927683, -644.8659911622343, -1031.5688265495442, -1011.6801161986988, -190.4250788371174, -456.54968287462725, -1090.739778166882, -1091.459123032306, -899.4915909262567, -573.2629946677248, -102.58972334093991, -792.0659628658531, -1012.3817465215728, -909.2750127689629, -31.8689423139001, -945.5148185037087, -595.3182747875627, -750.6431085915324, -530.2742916272771, -764.7740401833701, -1044.6725303124806, -194.54475786599846, -329.1506607515037, -446.0703513169092, -732.9930751857258, -492.31025189741007, -1083.637264436557, -975.5453888948515, -711.16503045573, -987.5705336882734, -754.5513327753415, -766.4092473340389, -493.3011980996293, -126.00305770782059, -215.41837934350116, -1265.9689630430835, -514.2113012714492, -747.377742877136, -949.1785918056333, -405.18150820365565, -56.18427858868257, -539.3665269353944, -443.1948413120508, -812.074841273978, -748.4503907261138, -523.2855708618647, -710.19976859781, -747.7643602528774, -462.7980418153677, -1154.4697071744913, -23.268884801512613, -753.330807596121, -104.2509212609181, -322.5619233105065, -1019.1974452556346, -136.72393414138833, -83.69959946994888, -492.38058691692106, -953.6198630482551, -812.4774137360417, -1162.7850190745241, -933.788796611885, -1172.8886798005985]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5915846268007454, "mean_inference_ms": 1.8125718412771028, "mean_action_processing_ms": 0.294871868751659, "mean_env_wait_ms": 3.1622788701623312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012236595153808594, "StateBufferConnector_ms": 0.008118152618408203, "ViewRequirementAgentConnector_ms": 0.20019054412841797}, "num_episodes": 30, "episode_return_max": -23.268884801512613, "episode_return_min": -1341.1447414938436, "episode_return_mean": -662.3590163567253, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.10983993569266, "num_env_steps_trained_throughput_per_sec": 320.10983993569266, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12724.067, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12723.987, "sample_time_ms": 1337.022, "learn_time_ms": 11314.93, "learn_throughput": 353.515, "synch_weights_time_ms": 71.203}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00012", "date": "2024-08-03_04-19-11", "timestamp": 1722638951, "time_this_iter_s": 12.508728504180908, "time_total_s": 295.6512529850006, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c785990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.6512529850006, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 23.277777777777782, "ram_util_percent": 48.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 173.52188711365065, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.550254742552837, "policy_loss": -0.007134660836891271, "vf_loss": 4.5515300887326395, "vf_explained_var": 0.964476479527851, "kl": 0.013040565708494493, "entropy": 0.894567202962935, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -23.268884801512613, "episode_reward_min": -1278.6315192221737, "episode_reward_mean": -669.0065803332026, "episode_len_mean": 133.89, "episode_media": {}, "episodes_timesteps_total": 13389, "policy_reward_min": {"policy_0": -1278.6315192221737}, "policy_reward_max": {"policy_0": -23.268884801512613}, "policy_reward_mean": {"policy_0": -669.0065803332026}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-140.99916369557403, -511.42453199733853, -1031.935653794993, -932.2764878630234, -581.8911157665214, -1074.4260567927683, -644.8659911622343, -1031.5688265495442, -1011.6801161986988, -190.4250788371174, -456.54968287462725, -1090.739778166882, -1091.459123032306, -899.4915909262567, -573.2629946677248, -102.58972334093991, -792.0659628658531, -1012.3817465215728, -909.2750127689629, -31.8689423139001, -945.5148185037087, -595.3182747875627, -750.6431085915324, -530.2742916272771, -764.7740401833701, -1044.6725303124806, -194.54475786599846, -329.1506607515037, -446.0703513169092, -732.9930751857258, -492.31025189741007, -1083.637264436557, -975.5453888948515, -711.16503045573, -987.5705336882734, -754.5513327753415, -766.4092473340389, -493.3011980996293, -126.00305770782059, -215.41837934350116, -1265.9689630430835, -514.2113012714492, -747.377742877136, -949.1785918056333, -405.18150820365565, -56.18427858868257, -539.3665269353944, -443.1948413120508, -812.074841273978, -748.4503907261138, -523.2855708618647, -710.19976859781, -747.7643602528774, -462.7980418153677, -1154.4697071744913, -23.268884801512613, -753.330807596121, -104.2509212609181, -322.5619233105065, -1019.1974452556346, -136.72393414138833, -83.69959946994888, -492.38058691692106, -953.6198630482551, -812.4774137360417, -1162.7850190745241, -933.788796611885, -1172.8886798005985, -601.5379895648574, -498.9816491860312, -848.272795192271, -1278.6315192221737, -1217.3067134731698, -61.82151617382747, -637.6600246691986, -781.9037088548083, -1233.3813356468042, -112.06796581664385, -192.90951991579695, -185.54014416357674, -625.2735778578569, -357.76946694507734, -635.2931550798505, -739.0502506904968, -1215.7109021344265, -961.1368647027427, -574.296713018081, -841.3668768906756, -677.0832809094594, -756.0675149383983, -891.1639009218134, -812.2813658043729, -755.1429430443857, -739.3850803884656, -543.8906699135507, -732.0211844520773, -366.65961405443613, -1043.3301143862077, -91.15757231205338, -790.8366193367699], "episode_lengths": [57, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 66, 150, 150, 150, 44, 150, 122, 150, 150, 150, 150, 105, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 56, 87, 150, 150, 150, 150, 97, 64, 150, 106, 150, 150, 150, 150, 150, 150, 150, 43, 150, 82, 150, 150, 84, 73, 150, 150, 150, 150, 150, 150, 135, 129, 150, 150, 150, 52, 150, 150, 150, 82, 88, 68, 150, 115, 137, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 134, 150, 71, 150], "policy_policy_0_reward": [-140.99916369557403, -511.42453199733853, -1031.935653794993, -932.2764878630234, -581.8911157665214, -1074.4260567927683, -644.8659911622343, -1031.5688265495442, -1011.6801161986988, -190.4250788371174, -456.54968287462725, -1090.739778166882, -1091.459123032306, -899.4915909262567, -573.2629946677248, -102.58972334093991, -792.0659628658531, -1012.3817465215728, -909.2750127689629, -31.8689423139001, -945.5148185037087, -595.3182747875627, -750.6431085915324, -530.2742916272771, -764.7740401833701, -1044.6725303124806, -194.54475786599846, -329.1506607515037, -446.0703513169092, -732.9930751857258, -492.31025189741007, -1083.637264436557, -975.5453888948515, -711.16503045573, -987.5705336882734, -754.5513327753415, -766.4092473340389, -493.3011980996293, -126.00305770782059, -215.41837934350116, -1265.9689630430835, -514.2113012714492, -747.377742877136, -949.1785918056333, -405.18150820365565, -56.18427858868257, -539.3665269353944, -443.1948413120508, -812.074841273978, -748.4503907261138, -523.2855708618647, -710.19976859781, -747.7643602528774, -462.7980418153677, -1154.4697071744913, -23.268884801512613, -753.330807596121, -104.2509212609181, -322.5619233105065, -1019.1974452556346, -136.72393414138833, -83.69959946994888, -492.38058691692106, -953.6198630482551, -812.4774137360417, -1162.7850190745241, -933.788796611885, -1172.8886798005985, -601.5379895648574, -498.9816491860312, -848.272795192271, -1278.6315192221737, -1217.3067134731698, -61.82151617382747, -637.6600246691986, -781.9037088548083, -1233.3813356468042, -112.06796581664385, -192.90951991579695, -185.54014416357674, -625.2735778578569, -357.76946694507734, -635.2931550798505, -739.0502506904968, -1215.7109021344265, -961.1368647027427, -574.296713018081, -841.3668768906756, -677.0832809094594, -756.0675149383983, -891.1639009218134, -812.2813658043729, -755.1429430443857, -739.3850803884656, -543.8906699135507, -732.0211844520773, -366.65961405443613, -1043.3301143862077, -91.15757231205338, -790.8366193367699]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5915574223597801, "mean_inference_ms": 1.8105648598395039, "mean_action_processing_ms": 0.2950342700914115, "mean_env_wait_ms": 3.159891741328106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012067556381225586, "StateBufferConnector_ms": 0.008063793182373047, "ViewRequirementAgentConnector_ms": 0.20016765594482422}, "num_episodes": 32, "episode_return_max": -23.268884801512613, "episode_return_min": -1278.6315192221737, "episode_return_mean": -669.0065803332026, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.4289077390014, "num_env_steps_trained_throughput_per_sec": 298.4289077390014, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12627.886, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12627.803, "sample_time_ms": 1212.916, "learn_time_ms": 11343.628, "learn_throughput": 352.621, "synch_weights_time_ms": 70.43}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00012", "date": "2024-08-03_04-19-24", "timestamp": 1722638964, "time_this_iter_s": 13.415295124053955, "time_total_s": 309.06654810905457, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70bc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 309.06654810905457, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 44.642105263157895, "ram_util_percent": 48.44736842105263}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 206.4698198914528, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.4153504781425, "policy_loss": -0.0043080805354596425, "vf_loss": 4.413411369919777, "vf_explained_var": 0.9643264602869749, "kl": 0.013906126734552042, "entropy": 1.0583738363658388, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -17.461819237134982, "episode_reward_min": -1352.9799611844264, "episode_reward_mean": -645.2120321366206, "episode_len_mean": 130.81, "episode_media": {}, "episodes_timesteps_total": 13081, "policy_reward_min": {"policy_0": -1352.9799611844264}, "policy_reward_max": {"policy_0": -17.461819237134982}, "policy_reward_mean": {"policy_0": -645.2120321366206}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1083.637264436557, -975.5453888948515, -711.16503045573, -987.5705336882734, -754.5513327753415, -766.4092473340389, -493.3011980996293, -126.00305770782059, -215.41837934350116, -1265.9689630430835, -514.2113012714492, -747.377742877136, -949.1785918056333, -405.18150820365565, -56.18427858868257, -539.3665269353944, -443.1948413120508, -812.074841273978, -748.4503907261138, -523.2855708618647, -710.19976859781, -747.7643602528774, -462.7980418153677, -1154.4697071744913, -23.268884801512613, -753.330807596121, -104.2509212609181, -322.5619233105065, -1019.1974452556346, -136.72393414138833, -83.69959946994888, -492.38058691692106, -953.6198630482551, -812.4774137360417, -1162.7850190745241, -933.788796611885, -1172.8886798005985, -601.5379895648574, -498.9816491860312, -848.272795192271, -1278.6315192221737, -1217.3067134731698, -61.82151617382747, -637.6600246691986, -781.9037088548083, -1233.3813356468042, -112.06796581664385, -192.90951991579695, -185.54014416357674, -625.2735778578569, -357.76946694507734, -635.2931550798505, -739.0502506904968, -1215.7109021344265, -961.1368647027427, -574.296713018081, -841.3668768906756, -677.0832809094594, -756.0675149383983, -891.1639009218134, -812.2813658043729, -755.1429430443857, -739.3850803884656, -543.8906699135507, -732.0211844520773, -366.65961405443613, -1043.3301143862077, -91.15757231205338, -790.8366193367699, -913.4093507223506, -683.6197395452982, -940.9145058961907, -431.51557928338616, -168.65067225142244, -143.4321951537285, -122.47640340533464, -155.6338406536273, -880.692827171234, -821.6412622709807, -864.2096067212485, -22.93915915679742, -768.2262972562086, -880.103709237627, -1252.6515164405394, -185.77189108913484, -538.5314381437389, -826.5398229661915, -704.7012080894756, -17.461819237134982, -643.2336049869144, -407.9560972334097, -19.364873828218176, -1352.9799611844264, -707.1806758705918, -457.301329299644, -767.7343941686398, -778.0571602965359, -469.7157772502483, -995.570967143141, -635.7712355486992], "episode_lengths": [150, 150, 150, 150, 150, 150, 147, 56, 87, 150, 150, 150, 150, 97, 64, 150, 106, 150, 150, 150, 150, 150, 150, 150, 43, 150, 82, 150, 150, 84, 73, 150, 150, 150, 150, 150, 150, 135, 129, 150, 150, 150, 52, 150, 150, 150, 82, 88, 68, 150, 115, 137, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 134, 150, 71, 150, 150, 134, 150, 142, 88, 71, 84, 71, 150, 150, 150, 42, 150, 150, 150, 106, 150, 150, 150, 45, 150, 113, 43, 150, 150, 113, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1083.637264436557, -975.5453888948515, -711.16503045573, -987.5705336882734, -754.5513327753415, -766.4092473340389, -493.3011980996293, -126.00305770782059, -215.41837934350116, -1265.9689630430835, -514.2113012714492, -747.377742877136, -949.1785918056333, -405.18150820365565, -56.18427858868257, -539.3665269353944, -443.1948413120508, -812.074841273978, -748.4503907261138, -523.2855708618647, -710.19976859781, -747.7643602528774, -462.7980418153677, -1154.4697071744913, -23.268884801512613, -753.330807596121, -104.2509212609181, -322.5619233105065, -1019.1974452556346, -136.72393414138833, -83.69959946994888, -492.38058691692106, -953.6198630482551, -812.4774137360417, -1162.7850190745241, -933.788796611885, -1172.8886798005985, -601.5379895648574, -498.9816491860312, -848.272795192271, -1278.6315192221737, -1217.3067134731698, -61.82151617382747, -637.6600246691986, -781.9037088548083, -1233.3813356468042, -112.06796581664385, -192.90951991579695, -185.54014416357674, -625.2735778578569, -357.76946694507734, -635.2931550798505, -739.0502506904968, -1215.7109021344265, -961.1368647027427, -574.296713018081, -841.3668768906756, -677.0832809094594, -756.0675149383983, -891.1639009218134, -812.2813658043729, -755.1429430443857, -739.3850803884656, -543.8906699135507, -732.0211844520773, -366.65961405443613, -1043.3301143862077, -91.15757231205338, -790.8366193367699, -913.4093507223506, -683.6197395452982, -940.9145058961907, -431.51557928338616, -168.65067225142244, -143.4321951537285, -122.47640340533464, -155.6338406536273, -880.692827171234, -821.6412622709807, -864.2096067212485, -22.93915915679742, -768.2262972562086, -880.103709237627, -1252.6515164405394, -185.77189108913484, -538.5314381437389, -826.5398229661915, -704.7012080894756, -17.461819237134982, -643.2336049869144, -407.9560972334097, -19.364873828218176, -1352.9799611844264, -707.1806758705918, -457.301329299644, -767.7343941686398, -778.0571602965359, -469.7157772502483, -995.570967143141, -635.7712355486992]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5916932777125266, "mean_inference_ms": 1.809116227339362, "mean_action_processing_ms": 0.2948134196077635, "mean_env_wait_ms": 3.1622633668077906, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012295007705688477, "StateBufferConnector_ms": 0.008324623107910156, "ViewRequirementAgentConnector_ms": 0.209486722946167}, "num_episodes": 31, "episode_return_max": -17.461819237134982, "episode_return_min": -1352.9799611844264, "episode_return_mean": -645.2120321366206, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.00958288403825, "num_env_steps_trained_throughput_per_sec": 325.00958288403825, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12640.743, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12640.659, "sample_time_ms": 1212.068, "learn_time_ms": 11357.634, "learn_throughput": 352.186, "synch_weights_time_ms": 70.141}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00012", "date": "2024-08-03_04-19-37", "timestamp": 1722638977, "time_this_iter_s": 12.319607973098755, "time_total_s": 321.3861560821533, "pid": 475688, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c787d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.3861560821533, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 23.517647058823528, "ram_util_percent": 48.5}}
