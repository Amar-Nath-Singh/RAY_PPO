{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9849544957280159, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.60112658639749, "policy_loss": -0.010375818088747716, "vf_loss": 9.610506578286488, "vf_explained_var": 0.05064929723739624, "kl": 0.01214890823072589, "entropy": 1.4339293155819177, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -82.03998751516049, "episode_reward_min": -1114.293101882425, "episode_reward_mean": -665.0635089835171, "episode_len_mean": 138.96153846153845, "episode_media": {}, "episodes_timesteps_total": 3613, "policy_reward_min": {"policy_0": -1114.293101882425}, "policy_reward_max": {"policy_0": -82.03998751516049}, "policy_reward_mean": {"policy_0": -665.0635089835171}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-768.8479021373464, -723.4693994760751, -763.9949002847387, -742.6989328156803, -613.5527723051446, -848.8040133542604, -581.89157661511, -1008.1868737904091, -340.57895900569895, -767.4667553758077, -1114.293101882425, -1009.6771137923175, -514.9827950420496, -501.71568641916673, -660.3284356958228, -849.6639788428691, -1005.1259509863337, -82.03998751516049, -1099.3087728559112, -386.8031878523209, -700.2373295749894, -471.5023419820837, -803.8613696756328, -596.0042965151375, -241.10772193475748, -95.5070778441952], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 123, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 121, 57], "policy_policy_0_reward": [-768.8479021373464, -723.4693994760751, -763.9949002847387, -742.6989328156803, -613.5527723051446, -848.8040133542604, -581.89157661511, -1008.1868737904091, -340.57895900569895, -767.4667553758077, -1114.293101882425, -1009.6771137923175, -514.9827950420496, -501.71568641916673, -660.3284356958228, -849.6639788428691, -1005.1259509863337, -82.03998751516049, -1099.3087728559112, -386.8031878523209, -700.2373295749894, -471.5023419820837, -803.8613696756328, -596.0042965151375, -241.10772193475748, -95.5070778441952]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2831914497477331, "mean_inference_ms": 0.8618657966517786, "mean_action_processing_ms": 0.15996713225257436, "mean_env_wait_ms": 1.5086635988726917, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006418961745042067, "StateBufferConnector_ms": 0.004364893986628606, "ViewRequirementAgentConnector_ms": 0.09378745005680965}, "num_episodes": 26, "episode_return_max": -82.03998751516049, "episode_return_min": -1114.293101882425, "episode_return_mean": -665.0635089835171, "episodes_this_iter": 26}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.38074538159236, "num_env_steps_trained_throughput_per_sec": 277.38074538159236, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 14420.623, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14420.561, "sample_time_ms": 2329.592, "learn_time_ms": 12075.008, "learn_throughput": 331.263, "synch_weights_time_ms": 15.226}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00005", "date": "2024-08-03_05-06-37", "timestamp": 1722641797, "time_this_iter_s": 14.427707433700562, "time_total_s": 14.427707433700562, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa3e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14.427707433700562, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.209523809523809, "ram_util_percent": 16.271428571428572}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.10472598473231, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.28313880711794, "policy_loss": -0.004800908099665927, "vf_loss": 9.287291014194489, "vf_explained_var": 0.23994962070137263, "kl": 0.010221625424416441, "entropy": 1.3956166360527278, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -47.49393094904631, "episode_reward_min": -1114.293101882425, "episode_reward_mean": -633.6320948067737, "episode_len_mean": 140.40740740740742, "episode_media": {}, "episodes_timesteps_total": 7582, "policy_reward_min": {"policy_0": -1114.293101882425}, "policy_reward_max": {"policy_0": -47.49393094904631}, "policy_reward_mean": {"policy_0": -633.6320948067737}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-768.8479021373464, -723.4693994760751, -763.9949002847387, -742.6989328156803, -613.5527723051446, -848.8040133542604, -581.89157661511, -1008.1868737904091, -340.57895900569895, -767.4667553758077, -1114.293101882425, -1009.6771137923175, -514.9827950420496, -501.71568641916673, -660.3284356958228, -849.6639788428691, -1005.1259509863337, -82.03998751516049, -1099.3087728559112, -386.8031878523209, -700.2373295749894, -471.5023419820837, -803.8613696756328, -596.0042965151375, -241.10772193475748, -95.5070778441952, -350.10392226438273, -879.7631974679523, -499.49535733274865, -465.3014587497391, -47.49393094904631, -353.30697325860837, -972.3241599346428, -835.1716419773472, -419.5777424303401, -829.8076689483302, -462.0894681597219, -852.5885373271451, -308.55708192843144, -596.0870379994684, -525.8581145939118, -386.29273728222836, -397.71006166599193, -879.3943127899854, -1041.659644525391, -705.3313591464141, -261.1858862343506, -766.3002010055277, -82.44533808992077, -813.6095872727115, -912.3124014032347, -687.2860833720198, -887.9265264248914, -705.5014534598474], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 123, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 121, 57, 150, 150, 135, 150, 59, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 83, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-768.8479021373464, -723.4693994760751, -763.9949002847387, -742.6989328156803, -613.5527723051446, -848.8040133542604, -581.89157661511, -1008.1868737904091, -340.57895900569895, -767.4667553758077, -1114.293101882425, -1009.6771137923175, -514.9827950420496, -501.71568641916673, -660.3284356958228, -849.6639788428691, -1005.1259509863337, -82.03998751516049, -1099.3087728559112, -386.8031878523209, -700.2373295749894, -471.5023419820837, -803.8613696756328, -596.0042965151375, -241.10772193475748, -95.5070778441952, -350.10392226438273, -879.7631974679523, -499.49535733274865, -465.3014587497391, -47.49393094904631, -353.30697325860837, -972.3241599346428, -835.1716419773472, -419.5777424303401, -829.8076689483302, -462.0894681597219, -852.5885373271451, -308.55708192843144, -596.0870379994684, -525.8581145939118, -386.29273728222836, -397.71006166599193, -879.3943127899854, -1041.659644525391, -705.3313591464141, -261.1858862343506, -766.3002010055277, -82.44533808992077, -813.6095872727115, -912.3124014032347, -687.2860833720198, -887.9265264248914, -705.5014534598474]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2809414276660094, "mean_inference_ms": 0.8622123613761791, "mean_action_processing_ms": 0.1590164978439882, "mean_env_wait_ms": 1.5098798496497738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006262902860288267, "StateBufferConnector_ms": 0.0043118441546404805, "ViewRequirementAgentConnector_ms": 0.09465085135565864}, "num_episodes": 28, "episode_return_max": -47.49393094904631, "episode_return_min": -1114.293101882425, "episode_return_mean": -633.6320948067737, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 285.28739618653356, "num_env_steps_trained_throughput_per_sec": 285.28739618653356, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 14220.792, "restore_workers_time_ms": 0.022, "training_step_time_ms": 14220.731, "sample_time_ms": 2311.981, "learn_time_ms": 11893.559, "learn_throughput": 336.316, "synch_weights_time_ms": 14.46}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00005", "date": "2024-08-03_05-06-52", "timestamp": 1722641812, "time_this_iter_s": 14.028035402297974, "time_total_s": 28.455742835998535, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1352bd00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 28.455742835998535, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 12.774999999999999, "ram_util_percent": 16.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.8184758990382153, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.270831947028636, "policy_loss": -0.010037517659172105, "vf_loss": 9.279511911670367, "vf_explained_var": 0.21004543472081422, "kl": 0.013824133568778057, "entropy": 1.407299422721068, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -24.372531348387113, "episode_reward_min": -1114.8940546777205, "episode_reward_mean": -646.4983445129187, "episode_len_mean": 138.86904761904762, "episode_media": {}, "episodes_timesteps_total": 11665, "policy_reward_min": {"policy_0": -1114.8940546777205}, "policy_reward_max": {"policy_0": -24.372531348387113}, "policy_reward_mean": {"policy_0": -646.4983445129187}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-768.8479021373464, -723.4693994760751, -763.9949002847387, -742.6989328156803, -613.5527723051446, -848.8040133542604, -581.89157661511, -1008.1868737904091, -340.57895900569895, -767.4667553758077, -1114.293101882425, -1009.6771137923175, -514.9827950420496, -501.71568641916673, -660.3284356958228, -849.6639788428691, -1005.1259509863337, -82.03998751516049, -1099.3087728559112, -386.8031878523209, -700.2373295749894, -471.5023419820837, -803.8613696756328, -596.0042965151375, -241.10772193475748, -95.5070778441952, -350.10392226438273, -879.7631974679523, -499.49535733274865, -465.3014587497391, -47.49393094904631, -353.30697325860837, -972.3241599346428, -835.1716419773472, -419.5777424303401, -829.8076689483302, -462.0894681597219, -852.5885373271451, -308.55708192843144, -596.0870379994684, -525.8581145939118, -386.29273728222836, -397.71006166599193, -879.3943127899854, -1041.659644525391, -705.3313591464141, -261.1858862343506, -766.3002010055277, -82.44533808992077, -813.6095872727115, -912.3124014032347, -687.2860833720198, -887.9265264248914, -705.5014534598474, -902.1018395562118, -370.8556264026817, -91.13522365882272, -24.372531348387113, -411.9808424709509, -205.51808898964833, -1105.2817681732945, -130.1884644505148, -967.4506799078281, -415.92323036305476, -893.6418024247776, -821.0892806263615, -953.3295544716622, -755.0353147324562, -945.5163094523812, -576.375566625998, -1114.8940546777205, -501.84806141699227, -633.5548276061543, -760.5630244023822, -1106.3668967010979, -619.7775185101041, -228.56737281527072, -922.8092693301622, -787.7566833084212, -774.7143259900283, -1037.3872214639396, -1013.8153759672867, -738.3432269959775, -279.53383667882605], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 123, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 121, 57, 150, 150, 135, 150, 59, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 83, 150, 150, 150, 150, 150, 150, 150, 64, 51, 150, 115, 150, 84, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 128], "policy_policy_0_reward": [-768.8479021373464, -723.4693994760751, -763.9949002847387, -742.6989328156803, -613.5527723051446, -848.8040133542604, -581.89157661511, -1008.1868737904091, -340.57895900569895, -767.4667553758077, -1114.293101882425, -1009.6771137923175, -514.9827950420496, -501.71568641916673, -660.3284356958228, -849.6639788428691, -1005.1259509863337, -82.03998751516049, -1099.3087728559112, -386.8031878523209, -700.2373295749894, -471.5023419820837, -803.8613696756328, -596.0042965151375, -241.10772193475748, -95.5070778441952, -350.10392226438273, -879.7631974679523, -499.49535733274865, -465.3014587497391, -47.49393094904631, -353.30697325860837, -972.3241599346428, -835.1716419773472, -419.5777424303401, -829.8076689483302, -462.0894681597219, -852.5885373271451, -308.55708192843144, -596.0870379994684, -525.8581145939118, -386.29273728222836, -397.71006166599193, -879.3943127899854, -1041.659644525391, -705.3313591464141, -261.1858862343506, -766.3002010055277, -82.44533808992077, -813.6095872727115, -912.3124014032347, -687.2860833720198, -887.9265264248914, -705.5014534598474, -902.1018395562118, -370.8556264026817, -91.13522365882272, -24.372531348387113, -411.9808424709509, -205.51808898964833, -1105.2817681732945, -130.1884644505148, -967.4506799078281, -415.92323036305476, -893.6418024247776, -821.0892806263615, -953.3295544716622, -755.0353147324562, -945.5163094523812, -576.375566625998, -1114.8940546777205, -501.84806141699227, -633.5548276061543, -760.5630244023822, -1106.3668967010979, -619.7775185101041, -228.56737281527072, -922.8092693301622, -787.7566833084212, -774.7143259900283, -1037.3872214639396, -1013.8153759672867, -738.3432269959775, -279.53383667882605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27917246748283153, "mean_inference_ms": 0.8615127644131649, "mean_action_processing_ms": 0.15831430796112061, "mean_env_wait_ms": 1.5096709732727929, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005844093504406157, "StateBufferConnector_ms": 0.004177717935471307, "ViewRequirementAgentConnector_ms": 0.09412566820780437}, "num_episodes": 30, "episode_return_max": -24.372531348387113, "episode_return_min": -1114.8940546777205, "episode_return_mean": -646.4983445129187, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.9913581022779, "num_env_steps_trained_throughput_per_sec": 281.9913581022779, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 14208.811, "restore_workers_time_ms": 0.022, "training_step_time_ms": 14208.747, "sample_time_ms": 2317.76, "learn_time_ms": 11874.543, "learn_throughput": 336.855, "synch_weights_time_ms": 15.67}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00005", "date": "2024-08-03_05-07-06", "timestamp": 1722641826, "time_this_iter_s": 14.193083763122559, "time_total_s": 42.648826599121094, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b13578550>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 42.648826599121094, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.695, "ram_util_percent": 16.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.9488874118154245, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.30238759815693, "policy_loss": -0.005971261515029861, "vf_loss": 9.307176992297173, "vf_explained_var": 0.3455230390653014, "kl": 0.01291960066605498, "entropy": 1.401974585900704, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -24.372531348387113, "episode_reward_min": -1142.336358214853, "episode_reward_mean": -647.168498165239, "episode_len_mean": 137.71, "episode_media": {}, "episodes_timesteps_total": 13771, "policy_reward_min": {"policy_0": -1142.336358214853}, "policy_reward_max": {"policy_0": -24.372531348387113}, "policy_reward_mean": {"policy_0": -647.168498165239}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-501.71568641916673, -660.3284356958228, -849.6639788428691, -1005.1259509863337, -82.03998751516049, -1099.3087728559112, -386.8031878523209, -700.2373295749894, -471.5023419820837, -803.8613696756328, -596.0042965151375, -241.10772193475748, -95.5070778441952, -350.10392226438273, -879.7631974679523, -499.49535733274865, -465.3014587497391, -47.49393094904631, -353.30697325860837, -972.3241599346428, -835.1716419773472, -419.5777424303401, -829.8076689483302, -462.0894681597219, -852.5885373271451, -308.55708192843144, -596.0870379994684, -525.8581145939118, -386.29273728222836, -397.71006166599193, -879.3943127899854, -1041.659644525391, -705.3313591464141, -261.1858862343506, -766.3002010055277, -82.44533808992077, -813.6095872727115, -912.3124014032347, -687.2860833720198, -887.9265264248914, -705.5014534598474, -902.1018395562118, -370.8556264026817, -91.13522365882272, -24.372531348387113, -411.9808424709509, -205.51808898964833, -1105.2817681732945, -130.1884644505148, -967.4506799078281, -415.92323036305476, -893.6418024247776, -821.0892806263615, -953.3295544716622, -755.0353147324562, -945.5163094523812, -576.375566625998, -1114.8940546777205, -501.84806141699227, -633.5548276061543, -760.5630244023822, -1106.3668967010979, -619.7775185101041, -228.56737281527072, -922.8092693301622, -787.7566833084212, -774.7143259900283, -1037.3872214639396, -1013.8153759672867, -738.3432269959775, -279.53383667882605, -1095.336200371539, -1142.336358214853, -1067.1326003176766, -115.05969605430752, -53.94828407596054, -976.5783912801382, -1079.0987321631994, -915.2124232661465, -385.3460468215554, -705.9958392776089, -386.9719295859363, -967.9514510556702, -57.29470728267916, -1001.1966679052823, -886.668952724864, -372.3425575097177, -699.0663695725208, -847.7000669454068, -803.5909039857672, -620.9164170159424, -668.7786317258499, -203.94799217309907, -711.3763346572209, -782.5491607972123, -728.6301549210481, -764.5425456825484, -907.4308646870111, -491.59916894857287, -770.8345242964574], "episode_lengths": [150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 121, 57, 150, 150, 135, 150, 59, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 83, 150, 150, 150, 150, 150, 150, 150, 64, 51, 150, 115, 150, 84, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 99, 76, 150, 150, 150, 150, 137, 95, 150, 49, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-501.71568641916673, -660.3284356958228, -849.6639788428691, -1005.1259509863337, -82.03998751516049, -1099.3087728559112, -386.8031878523209, -700.2373295749894, -471.5023419820837, -803.8613696756328, -596.0042965151375, -241.10772193475748, -95.5070778441952, -350.10392226438273, -879.7631974679523, -499.49535733274865, -465.3014587497391, -47.49393094904631, -353.30697325860837, -972.3241599346428, -835.1716419773472, -419.5777424303401, -829.8076689483302, -462.0894681597219, -852.5885373271451, -308.55708192843144, -596.0870379994684, -525.8581145939118, -386.29273728222836, -397.71006166599193, -879.3943127899854, -1041.659644525391, -705.3313591464141, -261.1858862343506, -766.3002010055277, -82.44533808992077, -813.6095872727115, -912.3124014032347, -687.2860833720198, -887.9265264248914, -705.5014534598474, -902.1018395562118, -370.8556264026817, -91.13522365882272, -24.372531348387113, -411.9808424709509, -205.51808898964833, -1105.2817681732945, -130.1884644505148, -967.4506799078281, -415.92323036305476, -893.6418024247776, -821.0892806263615, -953.3295544716622, -755.0353147324562, -945.5163094523812, -576.375566625998, -1114.8940546777205, -501.84806141699227, -633.5548276061543, -760.5630244023822, -1106.3668967010979, -619.7775185101041, -228.56737281527072, -922.8092693301622, -787.7566833084212, -774.7143259900283, -1037.3872214639396, -1013.8153759672867, -738.3432269959775, -279.53383667882605, -1095.336200371539, -1142.336358214853, -1067.1326003176766, -115.05969605430752, -53.94828407596054, -976.5783912801382, -1079.0987321631994, -915.2124232661465, -385.3460468215554, -705.9958392776089, -386.9719295859363, -967.9514510556702, -57.29470728267916, -1001.1966679052823, -886.668952724864, -372.3425575097177, -699.0663695725208, -847.7000669454068, -803.5909039857672, -620.9164170159424, -668.7786317258499, -203.94799217309907, -711.3763346572209, -782.5491607972123, -728.6301549210481, -764.5425456825484, -907.4308646870111, -491.59916894857287, -770.8345242964574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.276694901662507, "mean_inference_ms": 0.8604811479808617, "mean_action_processing_ms": 0.15756387502026037, "mean_env_wait_ms": 1.5097555166478895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005494832992553711, "StateBufferConnector_ms": 0.004144430160522461, "ViewRequirementAgentConnector_ms": 0.09517884254455566}, "num_episodes": 29, "episode_return_max": -24.372531348387113, "episode_return_min": -1142.336358214853, "episode_return_mean": -647.168498165239, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.46674952803295, "num_env_steps_trained_throughput_per_sec": 281.46674952803295, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 14209.43, "restore_workers_time_ms": 0.022, "training_step_time_ms": 14209.365, "sample_time_ms": 2306.42, "learn_time_ms": 11886.723, "learn_throughput": 336.51, "synch_weights_time_ms": 15.444}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00005", "date": "2024-08-03_05-07-20", "timestamp": 1722641840, "time_this_iter_s": 14.217911958694458, "time_total_s": 56.86673855781555, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f76d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 56.86673855781555, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.609523809523811, "ram_util_percent": 16.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 12.20268658058097, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.660197444756825, "policy_loss": -0.008445076690016625, "vf_loss": 8.667107089360554, "vf_explained_var": 0.46052912169446547, "kl": 0.014853423213495868, "entropy": 1.4352629486471415, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -24.372531348387113, "episode_reward_min": -1167.1851082115454, "episode_reward_mean": -697.7101096636222, "episode_len_mean": 138.36, "episode_media": {}, "episodes_timesteps_total": 13836, "policy_reward_min": {"policy_0": -1167.1851082115454}, "policy_reward_max": {"policy_0": -24.372531348387113}, "policy_reward_mean": {"policy_0": -697.7101096636222}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-397.71006166599193, -879.3943127899854, -1041.659644525391, -705.3313591464141, -261.1858862343506, -766.3002010055277, -82.44533808992077, -813.6095872727115, -912.3124014032347, -687.2860833720198, -887.9265264248914, -705.5014534598474, -902.1018395562118, -370.8556264026817, -91.13522365882272, -24.372531348387113, -411.9808424709509, -205.51808898964833, -1105.2817681732945, -130.1884644505148, -967.4506799078281, -415.92323036305476, -893.6418024247776, -821.0892806263615, -953.3295544716622, -755.0353147324562, -945.5163094523812, -576.375566625998, -1114.8940546777205, -501.84806141699227, -633.5548276061543, -760.5630244023822, -1106.3668967010979, -619.7775185101041, -228.56737281527072, -922.8092693301622, -787.7566833084212, -774.7143259900283, -1037.3872214639396, -1013.8153759672867, -738.3432269959775, -279.53383667882605, -1095.336200371539, -1142.336358214853, -1067.1326003176766, -115.05969605430752, -53.94828407596054, -976.5783912801382, -1079.0987321631994, -915.2124232661465, -385.3460468215554, -705.9958392776089, -386.9719295859363, -967.9514510556702, -57.29470728267916, -1001.1966679052823, -886.668952724864, -372.3425575097177, -699.0663695725208, -847.7000669454068, -803.5909039857672, -620.9164170159424, -668.7786317258499, -203.94799217309907, -711.3763346572209, -782.5491607972123, -728.6301549210481, -764.5425456825484, -907.4308646870111, -491.59916894857287, -770.8345242964574, -955.1695967480327, -602.0412451115939, -451.57279735900215, -987.1211157524729, -929.983938742848, -1081.0995619287066, -734.2449605311245, -920.4388440796804, -579.8594976894806, -1167.1851082115454, -926.4499883199214, -1112.8243300168442, -73.3833256789569, -377.5693847797045, -581.8492322143198, -815.4764995184892, -928.7763228936852, -436.8780231368804, -961.1120191391327, -1068.959141590774, -390.7291975725037, -129.26835368761368, -546.9041636602194, -286.0067853897134, -898.1960862201056, -842.0132534703116, -650.1585097013447, -797.1550386132882, -1098.7599963784455], "episode_lengths": [150, 150, 150, 150, 145, 150, 83, 150, 150, 150, 150, 150, 150, 150, 64, 51, 150, 115, 150, 84, 150, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 99, 76, 150, 150, 150, 150, 137, 95, 150, 49, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 98, 150, 150, 150, 150, 150, 150, 104, 69, 150, 103, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-397.71006166599193, -879.3943127899854, -1041.659644525391, -705.3313591464141, -261.1858862343506, -766.3002010055277, -82.44533808992077, -813.6095872727115, -912.3124014032347, -687.2860833720198, -887.9265264248914, -705.5014534598474, -902.1018395562118, -370.8556264026817, -91.13522365882272, -24.372531348387113, -411.9808424709509, -205.51808898964833, -1105.2817681732945, -130.1884644505148, -967.4506799078281, -415.92323036305476, -893.6418024247776, -821.0892806263615, -953.3295544716622, -755.0353147324562, -945.5163094523812, -576.375566625998, -1114.8940546777205, -501.84806141699227, -633.5548276061543, -760.5630244023822, -1106.3668967010979, -619.7775185101041, -228.56737281527072, -922.8092693301622, -787.7566833084212, -774.7143259900283, -1037.3872214639396, -1013.8153759672867, -738.3432269959775, -279.53383667882605, -1095.336200371539, -1142.336358214853, -1067.1326003176766, -115.05969605430752, -53.94828407596054, -976.5783912801382, -1079.0987321631994, -915.2124232661465, -385.3460468215554, -705.9958392776089, -386.9719295859363, -967.9514510556702, -57.29470728267916, -1001.1966679052823, -886.668952724864, -372.3425575097177, -699.0663695725208, -847.7000669454068, -803.5909039857672, -620.9164170159424, -668.7786317258499, -203.94799217309907, -711.3763346572209, -782.5491607972123, -728.6301549210481, -764.5425456825484, -907.4308646870111, -491.59916894857287, -770.8345242964574, -955.1695967480327, -602.0412451115939, -451.57279735900215, -987.1211157524729, -929.983938742848, -1081.0995619287066, -734.2449605311245, -920.4388440796804, -579.8594976894806, -1167.1851082115454, -926.4499883199214, -1112.8243300168442, -73.3833256789569, -377.5693847797045, -581.8492322143198, -815.4764995184892, -928.7763228936852, -436.8780231368804, -961.1120191391327, -1068.959141590774, -390.7291975725037, -129.26835368761368, -546.9041636602194, -286.0067853897134, -898.1960862201056, -842.0132534703116, -650.1585097013447, -797.1550386132882, -1098.7599963784455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27592993600321813, "mean_inference_ms": 0.8597571883942982, "mean_action_processing_ms": 0.15677853923855362, "mean_env_wait_ms": 1.5084772295758475, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00517725944519043, "StateBufferConnector_ms": 0.004082202911376953, "ViewRequirementAgentConnector_ms": 0.09634184837341309}, "num_episodes": 29, "episode_return_max": -24.372531348387113, "episode_return_min": -1167.1851082115454, "episode_return_mean": -697.7101096636222, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.99839622326056, "num_env_steps_trained_throughput_per_sec": 277.99839622326056, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 14245.261, "restore_workers_time_ms": 0.022, "training_step_time_ms": 14245.196, "sample_time_ms": 2314.275, "learn_time_ms": 11914.995, "learn_throughput": 335.711, "synch_weights_time_ms": 15.141}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00005", "date": "2024-08-03_05-07-34", "timestamp": 1722641854, "time_this_iter_s": 14.397035360336304, "time_total_s": 71.26377391815186, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1357b130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 71.26377391815186, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.695000000000002, "ram_util_percent": 16.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.308800963312386, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.994825853904088, "policy_loss": -0.0072887243426521305, "vf_loss": 7.000385715564092, "vf_explained_var": 0.7553318717206517, "kl": 0.015428781375188312, "entropy": 1.3569059749444325, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -25.31367420268301, "episode_reward_min": -1275.1818146841892, "episode_reward_mean": -684.0863466145674, "episode_len_mean": 137.48, "episode_media": {}, "episodes_timesteps_total": 13748, "policy_reward_min": {"policy_0": -1275.1818146841892}, "policy_reward_max": {"policy_0": -25.31367420268301}, "policy_reward_mean": {"policy_0": -684.0863466145674}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-501.84806141699227, -633.5548276061543, -760.5630244023822, -1106.3668967010979, -619.7775185101041, -228.56737281527072, -922.8092693301622, -787.7566833084212, -774.7143259900283, -1037.3872214639396, -1013.8153759672867, -738.3432269959775, -279.53383667882605, -1095.336200371539, -1142.336358214853, -1067.1326003176766, -115.05969605430752, -53.94828407596054, -976.5783912801382, -1079.0987321631994, -915.2124232661465, -385.3460468215554, -705.9958392776089, -386.9719295859363, -967.9514510556702, -57.29470728267916, -1001.1966679052823, -886.668952724864, -372.3425575097177, -699.0663695725208, -847.7000669454068, -803.5909039857672, -620.9164170159424, -668.7786317258499, -203.94799217309907, -711.3763346572209, -782.5491607972123, -728.6301549210481, -764.5425456825484, -907.4308646870111, -491.59916894857287, -770.8345242964574, -955.1695967480327, -602.0412451115939, -451.57279735900215, -987.1211157524729, -929.983938742848, -1081.0995619287066, -734.2449605311245, -920.4388440796804, -579.8594976894806, -1167.1851082115454, -926.4499883199214, -1112.8243300168442, -73.3833256789569, -377.5693847797045, -581.8492322143198, -815.4764995184892, -928.7763228936852, -436.8780231368804, -961.1120191391327, -1068.959141590774, -390.7291975725037, -129.26835368761368, -546.9041636602194, -286.0067853897134, -898.1960862201056, -842.0132534703116, -650.1585097013447, -797.1550386132882, -1098.7599963784455, -768.5428900213722, -25.31367420268301, -114.59256899593869, -920.4840214526014, -731.0393831139454, -254.51141130354014, -197.74863366597697, -608.4469957515463, -842.1128544099581, -446.02197341919833, -1275.1818146841892, -734.8830308743179, -748.2105404441392, -635.0737668891406, -503.5688150453157, -892.852357423309, -938.8646767996913, -914.1812498220146, -654.002580075397, -872.388255749183, -583.2314771438564, -876.1251036706986, -510.05951114830407, -520.0185971039284, -995.387036927706, -161.73074452093212, -448.11090642952394, -128.42845470807436, -161.8634030210702], "episode_lengths": [150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 99, 76, 150, 150, 150, 150, 137, 95, 150, 49, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 98, 150, 150, 150, 150, 150, 150, 104, 69, 150, 103, 150, 150, 150, 150, 150, 150, 44, 87, 150, 150, 118, 95, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 70, 150, 90, 90], "policy_policy_0_reward": [-501.84806141699227, -633.5548276061543, -760.5630244023822, -1106.3668967010979, -619.7775185101041, -228.56737281527072, -922.8092693301622, -787.7566833084212, -774.7143259900283, -1037.3872214639396, -1013.8153759672867, -738.3432269959775, -279.53383667882605, -1095.336200371539, -1142.336358214853, -1067.1326003176766, -115.05969605430752, -53.94828407596054, -976.5783912801382, -1079.0987321631994, -915.2124232661465, -385.3460468215554, -705.9958392776089, -386.9719295859363, -967.9514510556702, -57.29470728267916, -1001.1966679052823, -886.668952724864, -372.3425575097177, -699.0663695725208, -847.7000669454068, -803.5909039857672, -620.9164170159424, -668.7786317258499, -203.94799217309907, -711.3763346572209, -782.5491607972123, -728.6301549210481, -764.5425456825484, -907.4308646870111, -491.59916894857287, -770.8345242964574, -955.1695967480327, -602.0412451115939, -451.57279735900215, -987.1211157524729, -929.983938742848, -1081.0995619287066, -734.2449605311245, -920.4388440796804, -579.8594976894806, -1167.1851082115454, -926.4499883199214, -1112.8243300168442, -73.3833256789569, -377.5693847797045, -581.8492322143198, -815.4764995184892, -928.7763228936852, -436.8780231368804, -961.1120191391327, -1068.959141590774, -390.7291975725037, -129.26835368761368, -546.9041636602194, -286.0067853897134, -898.1960862201056, -842.0132534703116, -650.1585097013447, -797.1550386132882, -1098.7599963784455, -768.5428900213722, -25.31367420268301, -114.59256899593869, -920.4840214526014, -731.0393831139454, -254.51141130354014, -197.74863366597697, -608.4469957515463, -842.1128544099581, -446.02197341919833, -1275.1818146841892, -734.8830308743179, -748.2105404441392, -635.0737668891406, -503.5688150453157, -892.852357423309, -938.8646767996913, -914.1812498220146, -654.002580075397, -872.388255749183, -583.2314771438564, -876.1251036706986, -510.05951114830407, -520.0185971039284, -995.387036927706, -161.73074452093212, -448.11090642952394, -128.42845470807436, -161.8634030210702]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27590965872429435, "mean_inference_ms": 0.859998551822303, "mean_action_processing_ms": 0.156435180859539, "mean_env_wait_ms": 1.5110805380206884, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052106380462646484, "StateBufferConnector_ms": 0.004050493240356445, "ViewRequirementAgentConnector_ms": 0.0965127944946289}, "num_episodes": 29, "episode_return_max": -25.31367420268301, "episode_return_min": -1275.1818146841892, "episode_return_mean": -684.0863466145674, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.812236848036, "num_env_steps_trained_throughput_per_sec": 277.812236848036, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 14270.756, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14270.691, "sample_time_ms": 2313.917, "learn_time_ms": 11940.978, "learn_throughput": 334.981, "synch_weights_time_ms": 15.012}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00005", "date": "2024-08-03_05-07-49", "timestamp": 1722641869, "time_this_iter_s": 14.405781269073486, "time_total_s": 85.66955518722534, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1357b1c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 85.66955518722534, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.714285714285714, "ram_util_percent": 16.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.09675336529811, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.884803077081839, "policy_loss": -0.012060115599403313, "vf_loss": 6.894230784475804, "vf_explained_var": 0.8140785654385885, "kl": 0.019818012077575994, "entropy": 1.3311880276848873, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -25.31367420268301, "episode_reward_min": -1275.1818146841892, "episode_reward_mean": -659.0541214350586, "episode_len_mean": 136.57, "episode_media": {}, "episodes_timesteps_total": 13657, "policy_reward_min": {"policy_0": -1275.1818146841892}, "policy_reward_max": {"policy_0": -25.31367420268301}, "policy_reward_mean": {"policy_0": -659.0541214350586}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-620.9164170159424, -668.7786317258499, -203.94799217309907, -711.3763346572209, -782.5491607972123, -728.6301549210481, -764.5425456825484, -907.4308646870111, -491.59916894857287, -770.8345242964574, -955.1695967480327, -602.0412451115939, -451.57279735900215, -987.1211157524729, -929.983938742848, -1081.0995619287066, -734.2449605311245, -920.4388440796804, -579.8594976894806, -1167.1851082115454, -926.4499883199214, -1112.8243300168442, -73.3833256789569, -377.5693847797045, -581.8492322143198, -815.4764995184892, -928.7763228936852, -436.8780231368804, -961.1120191391327, -1068.959141590774, -390.7291975725037, -129.26835368761368, -546.9041636602194, -286.0067853897134, -898.1960862201056, -842.0132534703116, -650.1585097013447, -797.1550386132882, -1098.7599963784455, -768.5428900213722, -25.31367420268301, -114.59256899593869, -920.4840214526014, -731.0393831139454, -254.51141130354014, -197.74863366597697, -608.4469957515463, -842.1128544099581, -446.02197341919833, -1275.1818146841892, -734.8830308743179, -748.2105404441392, -635.0737668891406, -503.5688150453157, -892.852357423309, -938.8646767996913, -914.1812498220146, -654.002580075397, -872.388255749183, -583.2314771438564, -876.1251036706986, -510.05951114830407, -520.0185971039284, -995.387036927706, -161.73074452093212, -448.11090642952394, -128.42845470807436, -161.8634030210702, -826.2145032142874, -813.6419525485123, -454.9674370357412, -150.69241466272044, -1142.3234067836763, -1019.2366966834242, -1215.3738777006477, -791.1092658428514, -602.0164730827992, -377.50622675755517, -859.4569013591993, -299.1985242519474, -998.4068888706249, -779.0576114258344, -411.24399313505467, -1265.8852548356292, -164.1324361268431, -303.1967679013823, -529.0563577447275, -637.9765409267559, -1102.4262854118276, -996.6106255026826, -203.1738297671607, -756.7092927738794, -509.17978866304156, -723.7786226499842, -763.0073928301445, -140.84814365028785, -196.9587973053067, -389.5069896100013, -127.69348485617472, -910.0565177359088], "episode_lengths": [150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 98, 150, 150, 150, 150, 150, 150, 104, 69, 150, 103, 150, 150, 150, 150, 150, 150, 44, 87, 150, 150, 118, 95, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 70, 150, 90, 90, 150, 150, 150, 99, 150, 150, 150, 150, 148, 147, 150, 150, 150, 150, 104, 150, 86, 102, 150, 150, 150, 150, 74, 150, 150, 150, 150, 83, 92, 150, 85, 150], "policy_policy_0_reward": [-620.9164170159424, -668.7786317258499, -203.94799217309907, -711.3763346572209, -782.5491607972123, -728.6301549210481, -764.5425456825484, -907.4308646870111, -491.59916894857287, -770.8345242964574, -955.1695967480327, -602.0412451115939, -451.57279735900215, -987.1211157524729, -929.983938742848, -1081.0995619287066, -734.2449605311245, -920.4388440796804, -579.8594976894806, -1167.1851082115454, -926.4499883199214, -1112.8243300168442, -73.3833256789569, -377.5693847797045, -581.8492322143198, -815.4764995184892, -928.7763228936852, -436.8780231368804, -961.1120191391327, -1068.959141590774, -390.7291975725037, -129.26835368761368, -546.9041636602194, -286.0067853897134, -898.1960862201056, -842.0132534703116, -650.1585097013447, -797.1550386132882, -1098.7599963784455, -768.5428900213722, -25.31367420268301, -114.59256899593869, -920.4840214526014, -731.0393831139454, -254.51141130354014, -197.74863366597697, -608.4469957515463, -842.1128544099581, -446.02197341919833, -1275.1818146841892, -734.8830308743179, -748.2105404441392, -635.0737668891406, -503.5688150453157, -892.852357423309, -938.8646767996913, -914.1812498220146, -654.002580075397, -872.388255749183, -583.2314771438564, -876.1251036706986, -510.05951114830407, -520.0185971039284, -995.387036927706, -161.73074452093212, -448.11090642952394, -128.42845470807436, -161.8634030210702, -826.2145032142874, -813.6419525485123, -454.9674370357412, -150.69241466272044, -1142.3234067836763, -1019.2366966834242, -1215.3738777006477, -791.1092658428514, -602.0164730827992, -377.50622675755517, -859.4569013591993, -299.1985242519474, -998.4068888706249, -779.0576114258344, -411.24399313505467, -1265.8852548356292, -164.1324361268431, -303.1967679013823, -529.0563577447275, -637.9765409267559, -1102.4262854118276, -996.6106255026826, -203.1738297671607, -756.7092927738794, -509.17978866304156, -723.7786226499842, -763.0073928301445, -140.84814365028785, -196.9587973053067, -389.5069896100013, -127.69348485617472, -910.0565177359088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27643911258703524, "mean_inference_ms": 0.8623658738307478, "mean_action_processing_ms": 0.15617302953690199, "mean_env_wait_ms": 1.5144910862630903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005349636077880859, "StateBufferConnector_ms": 0.004069089889526367, "ViewRequirementAgentConnector_ms": 0.09683442115783691}, "num_episodes": 32, "episode_return_max": -25.31367420268301, "episode_return_min": -1275.1818146841892, "episode_return_mean": -659.0541214350586, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.9547967527798, "num_env_steps_trained_throughput_per_sec": 278.9547967527798, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 14280.541, "restore_workers_time_ms": 0.021, "training_step_time_ms": 14280.478, "sample_time_ms": 2320.982, "learn_time_ms": 11943.867, "learn_throughput": 334.9, "synch_weights_time_ms": 14.852}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00005", "date": "2024-08-03_05-08-03", "timestamp": 1722641883, "time_this_iter_s": 14.346923828125, "time_total_s": 100.01647901535034, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1357af80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 100.01647901535034, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.694999999999999, "ram_util_percent": 16.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.35931292970975, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.119930341094732, "policy_loss": -0.008768367141601629, "vf_loss": 6.126391597092152, "vf_explained_var": 0.8533792532980442, "kl": 0.01814946421660959, "entropy": 1.3227916496495407, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -23.886084952101815, "episode_reward_min": -1298.7578682500728, "episode_reward_mean": -627.7907891061694, "episode_len_mean": 133.88, "episode_media": {}, "episodes_timesteps_total": 13388, "policy_reward_min": {"policy_0": -1298.7578682500728}, "policy_reward_max": {"policy_0": -23.886084952101815}, "policy_reward_mean": {"policy_0": -627.7907891061694}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-961.1120191391327, -1068.959141590774, -390.7291975725037, -129.26835368761368, -546.9041636602194, -286.0067853897134, -898.1960862201056, -842.0132534703116, -650.1585097013447, -797.1550386132882, -1098.7599963784455, -768.5428900213722, -25.31367420268301, -114.59256899593869, -920.4840214526014, -731.0393831139454, -254.51141130354014, -197.74863366597697, -608.4469957515463, -842.1128544099581, -446.02197341919833, -1275.1818146841892, -734.8830308743179, -748.2105404441392, -635.0737668891406, -503.5688150453157, -892.852357423309, -938.8646767996913, -914.1812498220146, -654.002580075397, -872.388255749183, -583.2314771438564, -876.1251036706986, -510.05951114830407, -520.0185971039284, -995.387036927706, -161.73074452093212, -448.11090642952394, -128.42845470807436, -161.8634030210702, -826.2145032142874, -813.6419525485123, -454.9674370357412, -150.69241466272044, -1142.3234067836763, -1019.2366966834242, -1215.3738777006477, -791.1092658428514, -602.0164730827992, -377.50622675755517, -859.4569013591993, -299.1985242519474, -998.4068888706249, -779.0576114258344, -411.24399313505467, -1265.8852548356292, -164.1324361268431, -303.1967679013823, -529.0563577447275, -637.9765409267559, -1102.4262854118276, -996.6106255026826, -203.1738297671607, -756.7092927738794, -509.17978866304156, -723.7786226499842, -763.0073928301445, -140.84814365028785, -196.9587973053067, -389.5069896100013, -127.69348485617472, -910.0565177359088, -1278.857995516348, -952.1000293121347, -448.4832097337514, -725.4068652449095, -803.2576596642377, -878.4258742215834, -550.7686727396442, -1000.4837877921422, -766.199447323604, -673.3757710770985, -69.8027627595698, -482.4920252147815, -534.5790002034713, -468.6146529582919, -464.16927312533426, -147.83331297528864, -103.7039164322907, -886.7454176360117, -43.73830888999564, -313.1336652292115, -1002.603786835627, -932.1208484964968, -1298.7578682500728, -796.1699239383713, -330.0098112865547, -588.9337048927227, -621.5426580276911, -23.886084952101815], "episode_lengths": [150, 150, 104, 69, 150, 103, 150, 150, 150, 150, 150, 150, 44, 87, 150, 150, 118, 95, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 70, 150, 90, 90, 150, 150, 150, 99, 150, 150, 150, 150, 148, 147, 150, 150, 150, 150, 104, 150, 86, 102, 150, 150, 150, 150, 74, 150, 150, 150, 150, 83, 92, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 67, 150, 150, 150, 120, 91, 85, 150, 48, 150, 150, 150, 150, 150, 150, 150, 133, 51], "policy_policy_0_reward": [-961.1120191391327, -1068.959141590774, -390.7291975725037, -129.26835368761368, -546.9041636602194, -286.0067853897134, -898.1960862201056, -842.0132534703116, -650.1585097013447, -797.1550386132882, -1098.7599963784455, -768.5428900213722, -25.31367420268301, -114.59256899593869, -920.4840214526014, -731.0393831139454, -254.51141130354014, -197.74863366597697, -608.4469957515463, -842.1128544099581, -446.02197341919833, -1275.1818146841892, -734.8830308743179, -748.2105404441392, -635.0737668891406, -503.5688150453157, -892.852357423309, -938.8646767996913, -914.1812498220146, -654.002580075397, -872.388255749183, -583.2314771438564, -876.1251036706986, -510.05951114830407, -520.0185971039284, -995.387036927706, -161.73074452093212, -448.11090642952394, -128.42845470807436, -161.8634030210702, -826.2145032142874, -813.6419525485123, -454.9674370357412, -150.69241466272044, -1142.3234067836763, -1019.2366966834242, -1215.3738777006477, -791.1092658428514, -602.0164730827992, -377.50622675755517, -859.4569013591993, -299.1985242519474, -998.4068888706249, -779.0576114258344, -411.24399313505467, -1265.8852548356292, -164.1324361268431, -303.1967679013823, -529.0563577447275, -637.9765409267559, -1102.4262854118276, -996.6106255026826, -203.1738297671607, -756.7092927738794, -509.17978866304156, -723.7786226499842, -763.0073928301445, -140.84814365028785, -196.9587973053067, -389.5069896100013, -127.69348485617472, -910.0565177359088, -1278.857995516348, -952.1000293121347, -448.4832097337514, -725.4068652449095, -803.2576596642377, -878.4258742215834, -550.7686727396442, -1000.4837877921422, -766.199447323604, -673.3757710770985, -69.8027627595698, -482.4920252147815, -534.5790002034713, -468.6146529582919, -464.16927312533426, -147.83331297528864, -103.7039164322907, -886.7454176360117, -43.73830888999564, -313.1336652292115, -1002.603786835627, -932.1208484964968, -1298.7578682500728, -796.1699239383713, -330.0098112865547, -588.9337048927227, -621.5426580276911, -23.886084952101815]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2764569561349808, "mean_inference_ms": 0.8713372024827849, "mean_action_processing_ms": 0.15616093159803446, "mean_env_wait_ms": 1.5157000454413332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005230426788330078, "StateBufferConnector_ms": 0.004014015197753906, "ViewRequirementAgentConnector_ms": 0.09577560424804688}, "num_episodes": 28, "episode_return_max": -23.886084952101815, "episode_return_min": -1298.7578682500728, "episode_return_mean": -627.7907891061694, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.0504502316753, "num_env_steps_trained_throughput_per_sec": 382.0504502316753, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13804.203, "restore_workers_time_ms": 0.021, "training_step_time_ms": 13804.138, "sample_time_ms": 2341.842, "learn_time_ms": 11447.109, "learn_throughput": 349.433, "synch_weights_time_ms": 14.418}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00005", "date": "2024-08-03_05-08-14", "timestamp": 1722641894, "time_this_iter_s": 10.47721266746521, "time_total_s": 110.49369168281555, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b13578d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 110.49369168281555, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.799999999999999, "ram_util_percent": 16.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 58.65765315095584, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.27399029135704, "policy_loss": -0.01403742102944913, "vf_loss": 6.285356266299884, "vf_explained_var": 0.8960485731561979, "kl": 0.020131241124242184, "entropy": 1.3548091555635133, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -23.886084952101815, "episode_reward_min": -1328.104248147327, "episode_reward_mean": -622.8579495903103, "episode_len_mean": 132.97, "episode_media": {}, "episodes_timesteps_total": 13297, "policy_reward_min": {"policy_0": -1328.104248147327}, "policy_reward_max": {"policy_0": -23.886084952101815}, "policy_reward_mean": {"policy_0": -622.8579495903103}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-583.2314771438564, -876.1251036706986, -510.05951114830407, -520.0185971039284, -995.387036927706, -161.73074452093212, -448.11090642952394, -128.42845470807436, -161.8634030210702, -826.2145032142874, -813.6419525485123, -454.9674370357412, -150.69241466272044, -1142.3234067836763, -1019.2366966834242, -1215.3738777006477, -791.1092658428514, -602.0164730827992, -377.50622675755517, -859.4569013591993, -299.1985242519474, -998.4068888706249, -779.0576114258344, -411.24399313505467, -1265.8852548356292, -164.1324361268431, -303.1967679013823, -529.0563577447275, -637.9765409267559, -1102.4262854118276, -996.6106255026826, -203.1738297671607, -756.7092927738794, -509.17978866304156, -723.7786226499842, -763.0073928301445, -140.84814365028785, -196.9587973053067, -389.5069896100013, -127.69348485617472, -910.0565177359088, -1278.857995516348, -952.1000293121347, -448.4832097337514, -725.4068652449095, -803.2576596642377, -878.4258742215834, -550.7686727396442, -1000.4837877921422, -766.199447323604, -673.3757710770985, -69.8027627595698, -482.4920252147815, -534.5790002034713, -468.6146529582919, -464.16927312533426, -147.83331297528864, -103.7039164322907, -886.7454176360117, -43.73830888999564, -313.1336652292115, -1002.603786835627, -932.1208484964968, -1298.7578682500728, -796.1699239383713, -330.0098112865547, -588.9337048927227, -621.5426580276911, -23.886084952101815, -299.314889071621, -622.4385648353156, -255.0491465089066, -127.23928658838575, -221.0828993969263, -1069.7470890712827, -765.8362309115355, -1141.6075272653588, -797.5126818103759, -685.6408595327684, -1130.8590589286277, -723.2936316984058, -889.9939663877822, -632.5309462066487, -435.0263693169281, -576.7961530996055, -1328.104248147327, -496.78583347535175, -613.0142448166546, -346.6643809764741, -928.1532942225936, -1109.073257796853, -1001.547673154241, -165.01127751703234, -847.5107363892072, -155.36041898254948, -362.3322659935123, -975.6151474965907, -85.95181419828823, -1081.5793967065351, -383.3267974773053], "episode_lengths": [150, 150, 127, 150, 150, 70, 150, 90, 90, 150, 150, 150, 99, 150, 150, 150, 150, 148, 147, 150, 150, 150, 150, 104, 150, 86, 102, 150, 150, 150, 150, 74, 150, 150, 150, 150, 83, 92, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 67, 150, 150, 150, 120, 91, 85, 150, 48, 150, 150, 150, 150, 150, 150, 150, 133, 51, 127, 150, 84, 66, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 82, 107, 150, 43, 150, 131], "policy_policy_0_reward": [-583.2314771438564, -876.1251036706986, -510.05951114830407, -520.0185971039284, -995.387036927706, -161.73074452093212, -448.11090642952394, -128.42845470807436, -161.8634030210702, -826.2145032142874, -813.6419525485123, -454.9674370357412, -150.69241466272044, -1142.3234067836763, -1019.2366966834242, -1215.3738777006477, -791.1092658428514, -602.0164730827992, -377.50622675755517, -859.4569013591993, -299.1985242519474, -998.4068888706249, -779.0576114258344, -411.24399313505467, -1265.8852548356292, -164.1324361268431, -303.1967679013823, -529.0563577447275, -637.9765409267559, -1102.4262854118276, -996.6106255026826, -203.1738297671607, -756.7092927738794, -509.17978866304156, -723.7786226499842, -763.0073928301445, -140.84814365028785, -196.9587973053067, -389.5069896100013, -127.69348485617472, -910.0565177359088, -1278.857995516348, -952.1000293121347, -448.4832097337514, -725.4068652449095, -803.2576596642377, -878.4258742215834, -550.7686727396442, -1000.4837877921422, -766.199447323604, -673.3757710770985, -69.8027627595698, -482.4920252147815, -534.5790002034713, -468.6146529582919, -464.16927312533426, -147.83331297528864, -103.7039164322907, -886.7454176360117, -43.73830888999564, -313.1336652292115, -1002.603786835627, -932.1208484964968, -1298.7578682500728, -796.1699239383713, -330.0098112865547, -588.9337048927227, -621.5426580276911, -23.886084952101815, -299.314889071621, -622.4385648353156, -255.0491465089066, -127.23928658838575, -221.0828993969263, -1069.7470890712827, -765.8362309115355, -1141.6075272653588, -797.5126818103759, -685.6408595327684, -1130.8590589286277, -723.2936316984058, -889.9939663877822, -632.5309462066487, -435.0263693169281, -576.7961530996055, -1328.104248147327, -496.78583347535175, -613.0142448166546, -346.6643809764741, -928.1532942225936, -1109.073257796853, -1001.547673154241, -165.01127751703234, -847.5107363892072, -155.36041898254948, -362.3322659935123, -975.6151474965907, -85.95181419828823, -1081.5793967065351, -383.3267974773053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2761885981698349, "mean_inference_ms": 0.878988708879611, "mean_action_processing_ms": 0.1559072432260865, "mean_env_wait_ms": 1.5178552484173564, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005112409591674805, "StateBufferConnector_ms": 0.0039975643157958984, "ViewRequirementAgentConnector_ms": 0.09502196311950684}, "num_episodes": 31, "episode_return_max": -23.886084952101815, "episode_return_min": -1328.104248147327, "episode_return_mean": -622.8579495903103, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 471.0762433134611, "num_env_steps_trained_throughput_per_sec": 471.0762433134611, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 13213.87, "restore_workers_time_ms": 0.021, "training_step_time_ms": 13213.806, "sample_time_ms": 2337.1, "learn_time_ms": 10861.837, "learn_throughput": 368.262, "synch_weights_time_ms": 14.106}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00005", "date": "2024-08-03_05-08-22", "timestamp": 1722641902, "time_this_iter_s": 8.500494003295898, "time_total_s": 118.99418568611145, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1352bbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 118.99418568611145, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 14.516666666666664, "ram_util_percent": 16.300000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 76.86465948522091, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.8867789852122465, "policy_loss": -0.013521048838447314, "vf_loss": 5.896309728175401, "vf_explained_var": 0.9107730509713292, "kl": 0.01795534678443195, "entropy": 1.396303747718533, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -0.5520726356966865, "episode_reward_min": -1328.104248147327, "episode_reward_mean": -632.8077709309359, "episode_len_mean": 131.38, "episode_media": {}, "episodes_timesteps_total": 13138, "policy_reward_min": {"policy_0": -1328.104248147327}, "policy_reward_max": {"policy_0": -0.5520726356966865}, "policy_reward_mean": {"policy_0": -632.8077709309359}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-203.1738297671607, -756.7092927738794, -509.17978866304156, -723.7786226499842, -763.0073928301445, -140.84814365028785, -196.9587973053067, -389.5069896100013, -127.69348485617472, -910.0565177359088, -1278.857995516348, -952.1000293121347, -448.4832097337514, -725.4068652449095, -803.2576596642377, -878.4258742215834, -550.7686727396442, -1000.4837877921422, -766.199447323604, -673.3757710770985, -69.8027627595698, -482.4920252147815, -534.5790002034713, -468.6146529582919, -464.16927312533426, -147.83331297528864, -103.7039164322907, -886.7454176360117, -43.73830888999564, -313.1336652292115, -1002.603786835627, -932.1208484964968, -1298.7578682500728, -796.1699239383713, -330.0098112865547, -588.9337048927227, -621.5426580276911, -23.886084952101815, -299.314889071621, -622.4385648353156, -255.0491465089066, -127.23928658838575, -221.0828993969263, -1069.7470890712827, -765.8362309115355, -1141.6075272653588, -797.5126818103759, -685.6408595327684, -1130.8590589286277, -723.2936316984058, -889.9939663877822, -632.5309462066487, -435.0263693169281, -576.7961530996055, -1328.104248147327, -496.78583347535175, -613.0142448166546, -346.6643809764741, -928.1532942225936, -1109.073257796853, -1001.547673154241, -165.01127751703234, -847.5107363892072, -155.36041898254948, -362.3322659935123, -975.6151474965907, -85.95181419828823, -1081.5793967065351, -383.3267974773053, -400.6382510710873, -100.67834385545441, -1081.4081602993967, -966.4033219874444, -804.3449308165299, -413.79760917420197, -774.2666153757253, -710.7687338157015, -743.5593446132932, -845.2172204283519, -811.2148420654321, -853.6433171086329, -993.05396530743, -1262.3792530983562, -221.7149343159465, -129.24258669367492, -1042.7714924961133, -855.6622486127794, -21.03579929172754, -21.777872124348022, -410.59101090019965, -570.0079392912038, -904.0214334413785, -1327.4848942062647, -514.7241663078968, -865.1345920021906, -1224.0014063739247, -0.5520726356966865, -553.1791295790454, -873.8742744330955, -822.5180488188319], "episode_lengths": [74, 150, 150, 150, 150, 83, 92, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 67, 150, 150, 150, 120, 91, 85, 150, 48, 150, 150, 150, 150, 150, 150, 150, 133, 51, 127, 150, 84, 66, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 82, 107, 150, 43, 150, 131, 150, 58, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 82, 57, 150, 150, 48, 50, 121, 150, 150, 150, 150, 150, 150, 44, 147, 150, 150], "policy_policy_0_reward": [-203.1738297671607, -756.7092927738794, -509.17978866304156, -723.7786226499842, -763.0073928301445, -140.84814365028785, -196.9587973053067, -389.5069896100013, -127.69348485617472, -910.0565177359088, -1278.857995516348, -952.1000293121347, -448.4832097337514, -725.4068652449095, -803.2576596642377, -878.4258742215834, -550.7686727396442, -1000.4837877921422, -766.199447323604, -673.3757710770985, -69.8027627595698, -482.4920252147815, -534.5790002034713, -468.6146529582919, -464.16927312533426, -147.83331297528864, -103.7039164322907, -886.7454176360117, -43.73830888999564, -313.1336652292115, -1002.603786835627, -932.1208484964968, -1298.7578682500728, -796.1699239383713, -330.0098112865547, -588.9337048927227, -621.5426580276911, -23.886084952101815, -299.314889071621, -622.4385648353156, -255.0491465089066, -127.23928658838575, -221.0828993969263, -1069.7470890712827, -765.8362309115355, -1141.6075272653588, -797.5126818103759, -685.6408595327684, -1130.8590589286277, -723.2936316984058, -889.9939663877822, -632.5309462066487, -435.0263693169281, -576.7961530996055, -1328.104248147327, -496.78583347535175, -613.0142448166546, -346.6643809764741, -928.1532942225936, -1109.073257796853, -1001.547673154241, -165.01127751703234, -847.5107363892072, -155.36041898254948, -362.3322659935123, -975.6151474965907, -85.95181419828823, -1081.5793967065351, -383.3267974773053, -400.6382510710873, -100.67834385545441, -1081.4081602993967, -966.4033219874444, -804.3449308165299, -413.79760917420197, -774.2666153757253, -710.7687338157015, -743.5593446132932, -845.2172204283519, -811.2148420654321, -853.6433171086329, -993.05396530743, -1262.3792530983562, -221.7149343159465, -129.24258669367492, -1042.7714924961133, -855.6622486127794, -21.03579929172754, -21.777872124348022, -410.59101090019965, -570.0079392912038, -904.0214334413785, -1327.4848942062647, -514.7241663078968, -865.1345920021906, -1224.0014063739247, -0.5520726356966865, -553.1791295790454, -873.8742744330955, -822.5180488188319]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27615120336666343, "mean_inference_ms": 0.8848478985292363, "mean_action_processing_ms": 0.1559232866289713, "mean_env_wait_ms": 1.518238210697009, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050013065338134766, "StateBufferConnector_ms": 0.004044055938720703, "ViewRequirementAgentConnector_ms": 0.09629464149475098}, "num_episodes": 31, "episode_return_max": -0.5520726356966865, "episode_return_min": -1328.104248147327, "episode_return_mean": -632.8077709309359, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.58582550360256, "num_env_steps_trained_throughput_per_sec": 271.58582550360256, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13365.316, "restore_workers_time_ms": 0.022, "training_step_time_ms": 13365.251, "sample_time_ms": 2335.707, "learn_time_ms": 11014.608, "learn_throughput": 363.154, "synch_weights_time_ms": 14.164}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00005", "date": "2024-08-03_05-08-37", "timestamp": 1722641917, "time_this_iter_s": 14.734118461608887, "time_total_s": 133.72830414772034, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1352b0a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 133.72830414772034, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 11.3, "ram_util_percent": 18.71904761904762}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 85.1233703305324, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.704757648706436, "policy_loss": -0.009050756891762527, "vf_loss": 5.7106777456899485, "vf_explained_var": 0.9371242973953485, "kl": 0.015066798372746841, "entropy": 1.3893815179665883, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -0.5520726356966865, "episode_reward_min": -1328.104248147327, "episode_reward_mean": -685.0807977409439, "episode_len_mean": 132.71, "episode_media": {}, "episodes_timesteps_total": 13271, "policy_reward_min": {"policy_0": -1328.104248147327}, "policy_reward_max": {"policy_0": -0.5520726356966865}, "policy_reward_mean": {"policy_0": -685.0807977409439}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1002.603786835627, -932.1208484964968, -1298.7578682500728, -796.1699239383713, -330.0098112865547, -588.9337048927227, -621.5426580276911, -23.886084952101815, -299.314889071621, -622.4385648353156, -255.0491465089066, -127.23928658838575, -221.0828993969263, -1069.7470890712827, -765.8362309115355, -1141.6075272653588, -797.5126818103759, -685.6408595327684, -1130.8590589286277, -723.2936316984058, -889.9939663877822, -632.5309462066487, -435.0263693169281, -576.7961530996055, -1328.104248147327, -496.78583347535175, -613.0142448166546, -346.6643809764741, -928.1532942225936, -1109.073257796853, -1001.547673154241, -165.01127751703234, -847.5107363892072, -155.36041898254948, -362.3322659935123, -975.6151474965907, -85.95181419828823, -1081.5793967065351, -383.3267974773053, -400.6382510710873, -100.67834385545441, -1081.4081602993967, -966.4033219874444, -804.3449308165299, -413.79760917420197, -774.2666153757253, -710.7687338157015, -743.5593446132932, -845.2172204283519, -811.2148420654321, -853.6433171086329, -993.05396530743, -1262.3792530983562, -221.7149343159465, -129.24258669367492, -1042.7714924961133, -855.6622486127794, -21.03579929172754, -21.777872124348022, -410.59101090019965, -570.0079392912038, -904.0214334413785, -1327.4848942062647, -514.7241663078968, -865.1345920021906, -1224.0014063739247, -0.5520726356966865, -553.1791295790454, -873.8742744330955, -822.5180488188319, -1012.9476918784849, -1288.5244558955521, -633.4457212448467, -1108.1569397351745, -351.03273089115487, -1091.7782294586195, -1062.9171437394289, -1126.0233924037166, -560.7239518296421, -882.8277063713675, -150.96420899274966, -806.8614926918351, -1274.954090816169, -979.4371439322144, -684.0367737185827, -692.742880730459, -1007.4207764702525, -903.3555896621917, -1060.3053219648586, -25.496638956346686, -740.6073268971704, -512.0655187081659, -1097.0831103104604, -620.3933315068975, -67.11346797386177, -78.30519792787537, -210.40243184810225, -762.9805973310747, -169.76135504890652, -577.7219699562534], "episode_lengths": [150, 150, 150, 150, 150, 150, 133, 51, 127, 150, 84, 66, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 82, 107, 150, 43, 150, 131, 150, 58, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 82, 57, 150, 150, 48, 50, 121, 150, 150, 150, 150, 150, 150, 44, 147, 150, 150, 150, 150, 136, 150, 91, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 127, 150, 150, 79, 74, 91, 150, 110, 150], "policy_policy_0_reward": [-1002.603786835627, -932.1208484964968, -1298.7578682500728, -796.1699239383713, -330.0098112865547, -588.9337048927227, -621.5426580276911, -23.886084952101815, -299.314889071621, -622.4385648353156, -255.0491465089066, -127.23928658838575, -221.0828993969263, -1069.7470890712827, -765.8362309115355, -1141.6075272653588, -797.5126818103759, -685.6408595327684, -1130.8590589286277, -723.2936316984058, -889.9939663877822, -632.5309462066487, -435.0263693169281, -576.7961530996055, -1328.104248147327, -496.78583347535175, -613.0142448166546, -346.6643809764741, -928.1532942225936, -1109.073257796853, -1001.547673154241, -165.01127751703234, -847.5107363892072, -155.36041898254948, -362.3322659935123, -975.6151474965907, -85.95181419828823, -1081.5793967065351, -383.3267974773053, -400.6382510710873, -100.67834385545441, -1081.4081602993967, -966.4033219874444, -804.3449308165299, -413.79760917420197, -774.2666153757253, -710.7687338157015, -743.5593446132932, -845.2172204283519, -811.2148420654321, -853.6433171086329, -993.05396530743, -1262.3792530983562, -221.7149343159465, -129.24258669367492, -1042.7714924961133, -855.6622486127794, -21.03579929172754, -21.777872124348022, -410.59101090019965, -570.0079392912038, -904.0214334413785, -1327.4848942062647, -514.7241663078968, -865.1345920021906, -1224.0014063739247, -0.5520726356966865, -553.1791295790454, -873.8742744330955, -822.5180488188319, -1012.9476918784849, -1288.5244558955521, -633.4457212448467, -1108.1569397351745, -351.03273089115487, -1091.7782294586195, -1062.9171437394289, -1126.0233924037166, -560.7239518296421, -882.8277063713675, -150.96420899274966, -806.8614926918351, -1274.954090816169, -979.4371439322144, -684.0367737185827, -692.742880730459, -1007.4207764702525, -903.3555896621917, -1060.3053219648586, -25.496638956346686, -740.6073268971704, -512.0655187081659, -1097.0831103104604, -620.3933315068975, -67.11346797386177, -78.30519792787537, -210.40243184810225, -762.9805973310747, -169.76135504890652, -577.7219699562534]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2761172275811349, "mean_inference_ms": 0.8859320816581168, "mean_action_processing_ms": 0.15587204824684536, "mean_env_wait_ms": 1.5200689281076711, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004994869232177734, "StateBufferConnector_ms": 0.004016399383544922, "ViewRequirementAgentConnector_ms": 0.09632420539855957}, "num_episodes": 30, "episode_return_max": -0.5520726356966865, "episode_return_min": -1328.104248147327, "episode_return_mean": -685.0807977409439, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.9254183358107, "num_env_steps_trained_throughput_per_sec": 266.9254183358107, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13421.801, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13421.734, "sample_time_ms": 2335.979, "learn_time_ms": 11070.836, "learn_throughput": 361.31, "synch_weights_time_ms": 14.137}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00005", "date": "2024-08-03_05-08-52", "timestamp": 1722641932, "time_this_iter_s": 14.99272632598877, "time_total_s": 148.7210304737091, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b13529e10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 148.7210304737091, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 12.71904761904762, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107.50331670443217, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.401346239944299, "policy_loss": -0.011609606912922269, "vf_loss": 5.40941456357638, "vf_explained_var": 0.9312750605245431, "kl": 0.016337572555979337, "entropy": 1.360010859121879, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -0.5520726356966865, "episode_reward_min": -1421.1079339262799, "episode_reward_mean": -688.2239525481278, "episode_len_mean": 133.45, "episode_media": {}, "episodes_timesteps_total": 13345, "policy_reward_min": {"policy_0": -1421.1079339262799}, "policy_reward_max": {"policy_0": -0.5520726356966865}, "policy_reward_mean": {"policy_0": -688.2239525481278}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-346.6643809764741, -928.1532942225936, -1109.073257796853, -1001.547673154241, -165.01127751703234, -847.5107363892072, -155.36041898254948, -362.3322659935123, -975.6151474965907, -85.95181419828823, -1081.5793967065351, -383.3267974773053, -400.6382510710873, -100.67834385545441, -1081.4081602993967, -966.4033219874444, -804.3449308165299, -413.79760917420197, -774.2666153757253, -710.7687338157015, -743.5593446132932, -845.2172204283519, -811.2148420654321, -853.6433171086329, -993.05396530743, -1262.3792530983562, -221.7149343159465, -129.24258669367492, -1042.7714924961133, -855.6622486127794, -21.03579929172754, -21.777872124348022, -410.59101090019965, -570.0079392912038, -904.0214334413785, -1327.4848942062647, -514.7241663078968, -865.1345920021906, -1224.0014063739247, -0.5520726356966865, -553.1791295790454, -873.8742744330955, -822.5180488188319, -1012.9476918784849, -1288.5244558955521, -633.4457212448467, -1108.1569397351745, -351.03273089115487, -1091.7782294586195, -1062.9171437394289, -1126.0233924037166, -560.7239518296421, -882.8277063713675, -150.96420899274966, -806.8614926918351, -1274.954090816169, -979.4371439322144, -684.0367737185827, -692.742880730459, -1007.4207764702525, -903.3555896621917, -1060.3053219648586, -25.496638956346686, -740.6073268971704, -512.0655187081659, -1097.0831103104604, -620.3933315068975, -67.11346797386177, -78.30519792787537, -210.40243184810225, -762.9805973310747, -169.76135504890652, -577.7219699562534, -682.868995867616, -875.1284209043805, -1045.3061237466263, -1125.2564854130947, -327.30759361249653, -416.53394030369736, -829.9027437598272, -743.6179264242578, -560.9780660913123, -606.8569758111116, -162.22636279202337, -709.1941176724653, -881.6785972438588, -923.8835417152359, -350.45440169574783, -1187.7032323668125, -384.72832736030557, -805.0631772622188, -736.0123336472915, -378.00255733606514, -106.64828709904505, -1421.1079339262799, -411.62617309482806, -90.93858595520815, -1177.9988079189663, -551.7612249022136, -1227.4288605448419], "episode_lengths": [150, 150, 150, 150, 93, 150, 82, 107, 150, 43, 150, 131, 150, 58, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 82, 57, 150, 150, 48, 50, 121, 150, 150, 150, 150, 150, 150, 44, 147, 150, 150, 150, 150, 136, 150, 91, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 127, 150, 150, 79, 74, 91, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 101, 150, 150, 150, 61, 150, 150, 72, 150, 144, 150], "policy_policy_0_reward": [-346.6643809764741, -928.1532942225936, -1109.073257796853, -1001.547673154241, -165.01127751703234, -847.5107363892072, -155.36041898254948, -362.3322659935123, -975.6151474965907, -85.95181419828823, -1081.5793967065351, -383.3267974773053, -400.6382510710873, -100.67834385545441, -1081.4081602993967, -966.4033219874444, -804.3449308165299, -413.79760917420197, -774.2666153757253, -710.7687338157015, -743.5593446132932, -845.2172204283519, -811.2148420654321, -853.6433171086329, -993.05396530743, -1262.3792530983562, -221.7149343159465, -129.24258669367492, -1042.7714924961133, -855.6622486127794, -21.03579929172754, -21.777872124348022, -410.59101090019965, -570.0079392912038, -904.0214334413785, -1327.4848942062647, -514.7241663078968, -865.1345920021906, -1224.0014063739247, -0.5520726356966865, -553.1791295790454, -873.8742744330955, -822.5180488188319, -1012.9476918784849, -1288.5244558955521, -633.4457212448467, -1108.1569397351745, -351.03273089115487, -1091.7782294586195, -1062.9171437394289, -1126.0233924037166, -560.7239518296421, -882.8277063713675, -150.96420899274966, -806.8614926918351, -1274.954090816169, -979.4371439322144, -684.0367737185827, -692.742880730459, -1007.4207764702525, -903.3555896621917, -1060.3053219648586, -25.496638956346686, -740.6073268971704, -512.0655187081659, -1097.0831103104604, -620.3933315068975, -67.11346797386177, -78.30519792787537, -210.40243184810225, -762.9805973310747, -169.76135504890652, -577.7219699562534, -682.868995867616, -875.1284209043805, -1045.3061237466263, -1125.2564854130947, -327.30759361249653, -416.53394030369736, -829.9027437598272, -743.6179264242578, -560.9780660913123, -606.8569758111116, -162.22636279202337, -709.1941176724653, -881.6785972438588, -923.8835417152359, -350.45440169574783, -1187.7032323668125, -384.72832736030557, -805.0631772622188, -736.0123336472915, -378.00255733606514, -106.64828709904505, -1421.1079339262799, -411.62617309482806, -90.93858595520815, -1177.9988079189663, -551.7612249022136, -1227.4288605448419]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2763821012238953, "mean_inference_ms": 0.8848505846300628, "mean_action_processing_ms": 0.15607978386178067, "mean_env_wait_ms": 1.5214549246163622, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005192279815673828, "StateBufferConnector_ms": 0.00406646728515625, "ViewRequirementAgentConnector_ms": 0.09729957580566406}, "num_episodes": 27, "episode_return_max": -0.5520726356966865, "episode_return_min": -1421.1079339262799, "episode_return_mean": -688.2239525481278, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.56304459969, "num_env_steps_trained_throughput_per_sec": 264.56304459969, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13531.634, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13531.562, "sample_time_ms": 2347.736, "learn_time_ms": 11168.45, "learn_throughput": 358.152, "synch_weights_time_ms": 14.571}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00005", "date": "2024-08-03_05-09-07", "timestamp": 1722641947, "time_this_iter_s": 15.126993894577026, "time_total_s": 163.84802436828613, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0d750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 163.84802436828613, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 12.631818181818181, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 109.62830263376236, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.176540084928274, "policy_loss": -0.01137545861468728, "vf_loss": 5.1840141656498115, "vf_explained_var": 0.949417746004959, "kl": 0.01734430226761107, "entropy": 1.301914937670032, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -0.5520726356966865, "episode_reward_min": -1421.1079339262799, "episode_reward_mean": -704.5297519621772, "episode_len_mean": 135.58, "episode_media": {}, "episodes_timesteps_total": 13558, "policy_reward_min": {"policy_0": -1421.1079339262799}, "policy_reward_max": {"policy_0": -0.5520726356966865}, "policy_reward_mean": {"policy_0": -704.5297519621772}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-21.03579929172754, -21.777872124348022, -410.59101090019965, -570.0079392912038, -904.0214334413785, -1327.4848942062647, -514.7241663078968, -865.1345920021906, -1224.0014063739247, -0.5520726356966865, -553.1791295790454, -873.8742744330955, -822.5180488188319, -1012.9476918784849, -1288.5244558955521, -633.4457212448467, -1108.1569397351745, -351.03273089115487, -1091.7782294586195, -1062.9171437394289, -1126.0233924037166, -560.7239518296421, -882.8277063713675, -150.96420899274966, -806.8614926918351, -1274.954090816169, -979.4371439322144, -684.0367737185827, -692.742880730459, -1007.4207764702525, -903.3555896621917, -1060.3053219648586, -25.496638956346686, -740.6073268971704, -512.0655187081659, -1097.0831103104604, -620.3933315068975, -67.11346797386177, -78.30519792787537, -210.40243184810225, -762.9805973310747, -169.76135504890652, -577.7219699562534, -682.868995867616, -875.1284209043805, -1045.3061237466263, -1125.2564854130947, -327.30759361249653, -416.53394030369736, -829.9027437598272, -743.6179264242578, -560.9780660913123, -606.8569758111116, -162.22636279202337, -709.1941176724653, -881.6785972438588, -923.8835417152359, -350.45440169574783, -1187.7032323668125, -384.72832736030557, -805.0631772622188, -736.0123336472915, -378.00255733606514, -106.64828709904505, -1421.1079339262799, -411.62617309482806, -90.93858595520815, -1177.9988079189663, -551.7612249022136, -1227.4288605448419, -1137.7768377325885, -419.7707972499048, -982.7590056404013, -987.7971301608458, -373.80337762999187, -302.15816199503627, -558.5957582248723, -561.8102644370261, -699.7029455019072, -1271.1376469949917, -227.06088284630118, -720.215009497779, -39.785567350464184, -1002.0073850318341, -158.34048221369324, -404.884941436384, -144.26877153061375, -992.8195975219254, -790.8313344410562, -1307.7249622728998, -732.4476483316345, -1132.3932276753792, -763.6500555747342, -1014.0827224445575, -1246.0051933007248, -1164.8303760770289, -751.3997211620317, -282.88777141067334, -877.7010378304485, -1034.8229599339595], "episode_lengths": [48, 50, 121, 150, 150, 150, 150, 150, 150, 44, 147, 150, 150, 150, 150, 136, 150, 91, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 127, 150, 150, 79, 74, 91, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 101, 150, 150, 150, 61, 150, 150, 72, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 47, 150, 107, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150], "policy_policy_0_reward": [-21.03579929172754, -21.777872124348022, -410.59101090019965, -570.0079392912038, -904.0214334413785, -1327.4848942062647, -514.7241663078968, -865.1345920021906, -1224.0014063739247, -0.5520726356966865, -553.1791295790454, -873.8742744330955, -822.5180488188319, -1012.9476918784849, -1288.5244558955521, -633.4457212448467, -1108.1569397351745, -351.03273089115487, -1091.7782294586195, -1062.9171437394289, -1126.0233924037166, -560.7239518296421, -882.8277063713675, -150.96420899274966, -806.8614926918351, -1274.954090816169, -979.4371439322144, -684.0367737185827, -692.742880730459, -1007.4207764702525, -903.3555896621917, -1060.3053219648586, -25.496638956346686, -740.6073268971704, -512.0655187081659, -1097.0831103104604, -620.3933315068975, -67.11346797386177, -78.30519792787537, -210.40243184810225, -762.9805973310747, -169.76135504890652, -577.7219699562534, -682.868995867616, -875.1284209043805, -1045.3061237466263, -1125.2564854130947, -327.30759361249653, -416.53394030369736, -829.9027437598272, -743.6179264242578, -560.9780660913123, -606.8569758111116, -162.22636279202337, -709.1941176724653, -881.6785972438588, -923.8835417152359, -350.45440169574783, -1187.7032323668125, -384.72832736030557, -805.0631772622188, -736.0123336472915, -378.00255733606514, -106.64828709904505, -1421.1079339262799, -411.62617309482806, -90.93858595520815, -1177.9988079189663, -551.7612249022136, -1227.4288605448419, -1137.7768377325885, -419.7707972499048, -982.7590056404013, -987.7971301608458, -373.80337762999187, -302.15816199503627, -558.5957582248723, -561.8102644370261, -699.7029455019072, -1271.1376469949917, -227.06088284630118, -720.215009497779, -39.785567350464184, -1002.0073850318341, -158.34048221369324, -404.884941436384, -144.26877153061375, -992.8195975219254, -790.8313344410562, -1307.7249622728998, -732.4476483316345, -1132.3932276753792, -763.6500555747342, -1014.0827224445575, -1246.0051933007248, -1164.8303760770289, -751.3997211620317, -282.88777141067334, -877.7010378304485, -1034.8229599339595]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27654575708258927, "mean_inference_ms": 0.8838472115981346, "mean_action_processing_ms": 0.15617843364029363, "mean_env_wait_ms": 1.5237190670426504, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005304574966430664, "StateBufferConnector_ms": 0.0040645599365234375, "ViewRequirementAgentConnector_ms": 0.0973970890045166}, "num_episodes": 30, "episode_return_max": -0.5520726356966865, "episode_return_min": -1421.1079339262799, "episode_return_mean": -704.5297519621772, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.92749831761563, "num_env_steps_trained_throughput_per_sec": 263.92749831761563, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13628.719, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13628.646, "sample_time_ms": 2349.854, "learn_time_ms": 11263.366, "learn_throughput": 355.134, "synch_weights_time_ms": 14.607}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00005", "date": "2024-08-03_05-09-23", "timestamp": 1722641963, "time_this_iter_s": 15.163210391998291, "time_total_s": 179.01123476028442, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b13529d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 179.01123476028442, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 12.631818181818181, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.48231174349785, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.329959993561109, "policy_loss": -0.01689388152687267, "vf_loss": 4.342077759404977, "vf_explained_var": 0.9829156929627061, "kl": 0.01990916316038542, "entropy": 1.1966340642422437, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -25.496638956346686, "episode_reward_min": -1421.1079339262799, "episode_reward_mean": -670.5601928160115, "episode_len_mean": 135.98, "episode_media": {}, "episodes_timesteps_total": 13598, "policy_reward_min": {"policy_0": -1421.1079339262799}, "policy_reward_max": {"policy_0": -25.496638956346686}, "policy_reward_mean": {"policy_0": -670.5601928160115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1007.4207764702525, -903.3555896621917, -1060.3053219648586, -25.496638956346686, -740.6073268971704, -512.0655187081659, -1097.0831103104604, -620.3933315068975, -67.11346797386177, -78.30519792787537, -210.40243184810225, -762.9805973310747, -169.76135504890652, -577.7219699562534, -682.868995867616, -875.1284209043805, -1045.3061237466263, -1125.2564854130947, -327.30759361249653, -416.53394030369736, -829.9027437598272, -743.6179264242578, -560.9780660913123, -606.8569758111116, -162.22636279202337, -709.1941176724653, -881.6785972438588, -923.8835417152359, -350.45440169574783, -1187.7032323668125, -384.72832736030557, -805.0631772622188, -736.0123336472915, -378.00255733606514, -106.64828709904505, -1421.1079339262799, -411.62617309482806, -90.93858595520815, -1177.9988079189663, -551.7612249022136, -1227.4288605448419, -1137.7768377325885, -419.7707972499048, -982.7590056404013, -987.7971301608458, -373.80337762999187, -302.15816199503627, -558.5957582248723, -561.8102644370261, -699.7029455019072, -1271.1376469949917, -227.06088284630118, -720.215009497779, -39.785567350464184, -1002.0073850318341, -158.34048221369324, -404.884941436384, -144.26877153061375, -992.8195975219254, -790.8313344410562, -1307.7249622728998, -732.4476483316345, -1132.3932276753792, -763.6500555747342, -1014.0827224445575, -1246.0051933007248, -1164.8303760770289, -751.3997211620317, -282.88777141067334, -877.7010378304485, -1034.8229599339595, -371.5937779075305, -614.4721521991106, -502.73999710539067, -904.0472380896053, -991.256306954834, -924.3093369431415, -1091.576036543512, -203.42637034079513, -1007.922536780519, -553.6163646331405, -909.2418349387436, -147.7885923216857, -958.8684076996486, -485.3217312293975, -56.122623276591185, -524.7941430683129, -479.0199952352349, -778.593795132366, -947.3317298808995, -109.68047414090614, -263.5187751104879, -1117.2248689365692, -218.5801799131755, -577.5082227956149, -70.53053609653966, -1036.9653436087876, -765.6265235267512, -925.1992382182227, -882.4441464916969], "episode_lengths": [150, 150, 150, 54, 150, 127, 150, 150, 79, 74, 91, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 101, 150, 150, 150, 61, 150, 150, 72, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 47, 150, 107, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 84, 150, 150, 74, 150, 150, 150, 150, 59, 146, 150, 98, 150, 64, 150, 150, 150, 150], "policy_policy_0_reward": [-1007.4207764702525, -903.3555896621917, -1060.3053219648586, -25.496638956346686, -740.6073268971704, -512.0655187081659, -1097.0831103104604, -620.3933315068975, -67.11346797386177, -78.30519792787537, -210.40243184810225, -762.9805973310747, -169.76135504890652, -577.7219699562534, -682.868995867616, -875.1284209043805, -1045.3061237466263, -1125.2564854130947, -327.30759361249653, -416.53394030369736, -829.9027437598272, -743.6179264242578, -560.9780660913123, -606.8569758111116, -162.22636279202337, -709.1941176724653, -881.6785972438588, -923.8835417152359, -350.45440169574783, -1187.7032323668125, -384.72832736030557, -805.0631772622188, -736.0123336472915, -378.00255733606514, -106.64828709904505, -1421.1079339262799, -411.62617309482806, -90.93858595520815, -1177.9988079189663, -551.7612249022136, -1227.4288605448419, -1137.7768377325885, -419.7707972499048, -982.7590056404013, -987.7971301608458, -373.80337762999187, -302.15816199503627, -558.5957582248723, -561.8102644370261, -699.7029455019072, -1271.1376469949917, -227.06088284630118, -720.215009497779, -39.785567350464184, -1002.0073850318341, -158.34048221369324, -404.884941436384, -144.26877153061375, -992.8195975219254, -790.8313344410562, -1307.7249622728998, -732.4476483316345, -1132.3932276753792, -763.6500555747342, -1014.0827224445575, -1246.0051933007248, -1164.8303760770289, -751.3997211620317, -282.88777141067334, -877.7010378304485, -1034.8229599339595, -371.5937779075305, -614.4721521991106, -502.73999710539067, -904.0472380896053, -991.256306954834, -924.3093369431415, -1091.576036543512, -203.42637034079513, -1007.922536780519, -553.6163646331405, -909.2418349387436, -147.7885923216857, -958.8684076996486, -485.3217312293975, -56.122623276591185, -524.7941430683129, -479.0199952352349, -778.593795132366, -947.3317298808995, -109.68047414090614, -263.5187751104879, -1117.2248689365692, -218.5801799131755, -577.5082227956149, -70.53053609653966, -1036.9653436087876, -765.6265235267512, -925.1992382182227, -882.4441464916969]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27679323503150444, "mean_inference_ms": 0.883193793357453, "mean_action_processing_ms": 0.15642214401955548, "mean_env_wait_ms": 1.5258941802617023, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005418300628662109, "StateBufferConnector_ms": 0.0040476322174072266, "ViewRequirementAgentConnector_ms": 0.09711766242980957}, "num_episodes": 29, "episode_return_max": -25.496638956346686, "episode_return_min": -1421.1079339262799, "episode_return_mean": -670.5601928160115, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 259.472868715796, "num_env_steps_trained_throughput_per_sec": 259.472868715796, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13749.179, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13749.105, "sample_time_ms": 2359.373, "learn_time_ms": 11374.158, "learn_throughput": 351.674, "synch_weights_time_ms": 14.735}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00005", "date": "2024-08-03_05-09-38", "timestamp": 1722641978, "time_this_iter_s": 15.423232078552246, "time_total_s": 194.43446683883667, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1357be20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 194.43446683883667, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 12.813636363636363, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 152.76617963314055, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.255602309356133, "policy_loss": -0.009263471323841562, "vf_loss": 4.260520926117897, "vf_explained_var": 0.9707742530231674, "kl": 0.018729443420367413, "entropy": 1.2739923894405365, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -39.785567350464184, "episode_reward_min": -1421.1079339262799, "episode_reward_mean": -700.0706553130741, "episode_len_mean": 137.82, "episode_media": {}, "episodes_timesteps_total": 13782, "policy_reward_min": {"policy_0": -1421.1079339262799}, "policy_reward_max": {"policy_0": -39.785567350464184}, "policy_reward_mean": {"policy_0": -700.0706553130741}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1187.7032323668125, -384.72832736030557, -805.0631772622188, -736.0123336472915, -378.00255733606514, -106.64828709904505, -1421.1079339262799, -411.62617309482806, -90.93858595520815, -1177.9988079189663, -551.7612249022136, -1227.4288605448419, -1137.7768377325885, -419.7707972499048, -982.7590056404013, -987.7971301608458, -373.80337762999187, -302.15816199503627, -558.5957582248723, -561.8102644370261, -699.7029455019072, -1271.1376469949917, -227.06088284630118, -720.215009497779, -39.785567350464184, -1002.0073850318341, -158.34048221369324, -404.884941436384, -144.26877153061375, -992.8195975219254, -790.8313344410562, -1307.7249622728998, -732.4476483316345, -1132.3932276753792, -763.6500555747342, -1014.0827224445575, -1246.0051933007248, -1164.8303760770289, -751.3997211620317, -282.88777141067334, -877.7010378304485, -1034.8229599339595, -371.5937779075305, -614.4721521991106, -502.73999710539067, -904.0472380896053, -991.256306954834, -924.3093369431415, -1091.576036543512, -203.42637034079513, -1007.922536780519, -553.6163646331405, -909.2418349387436, -147.7885923216857, -958.8684076996486, -485.3217312293975, -56.122623276591185, -524.7941430683129, -479.0199952352349, -778.593795132366, -947.3317298808995, -109.68047414090614, -263.5187751104879, -1117.2248689365692, -218.5801799131755, -577.5082227956149, -70.53053609653966, -1036.9653436087876, -765.6265235267512, -925.1992382182227, -882.4441464916969, -69.0849927092778, -811.1059771108204, -688.6349987959688, -1144.9694270391258, -897.2021053794098, -443.9459747860929, -939.3374781624776, -1015.8481555377099, -985.9296424566825, -535.0891655733922, -763.2044013178497, -1062.7090259192892, -717.78481593433, -368.0189658630022, -723.609453637464, -310.8471783650358, -962.924144930587, -731.4281065347973, -634.664564492568, -284.76040248886517, -1104.7735978798216, -688.2021811744665, -564.7226946416519, -988.0568402137017, -1118.0724164077435, -250.6226811863922, -699.0209210979411, -730.4741125113936, -790.2087551745748], "episode_lengths": [150, 101, 150, 150, 150, 61, 150, 150, 72, 150, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 47, 150, 107, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 84, 150, 150, 74, 150, 150, 150, 150, 59, 146, 150, 98, 150, 64, 150, 150, 150, 150, 73, 150, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 127, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150], "policy_policy_0_reward": [-1187.7032323668125, -384.72832736030557, -805.0631772622188, -736.0123336472915, -378.00255733606514, -106.64828709904505, -1421.1079339262799, -411.62617309482806, -90.93858595520815, -1177.9988079189663, -551.7612249022136, -1227.4288605448419, -1137.7768377325885, -419.7707972499048, -982.7590056404013, -987.7971301608458, -373.80337762999187, -302.15816199503627, -558.5957582248723, -561.8102644370261, -699.7029455019072, -1271.1376469949917, -227.06088284630118, -720.215009497779, -39.785567350464184, -1002.0073850318341, -158.34048221369324, -404.884941436384, -144.26877153061375, -992.8195975219254, -790.8313344410562, -1307.7249622728998, -732.4476483316345, -1132.3932276753792, -763.6500555747342, -1014.0827224445575, -1246.0051933007248, -1164.8303760770289, -751.3997211620317, -282.88777141067334, -877.7010378304485, -1034.8229599339595, -371.5937779075305, -614.4721521991106, -502.73999710539067, -904.0472380896053, -991.256306954834, -924.3093369431415, -1091.576036543512, -203.42637034079513, -1007.922536780519, -553.6163646331405, -909.2418349387436, -147.7885923216857, -958.8684076996486, -485.3217312293975, -56.122623276591185, -524.7941430683129, -479.0199952352349, -778.593795132366, -947.3317298808995, -109.68047414090614, -263.5187751104879, -1117.2248689365692, -218.5801799131755, -577.5082227956149, -70.53053609653966, -1036.9653436087876, -765.6265235267512, -925.1992382182227, -882.4441464916969, -69.0849927092778, -811.1059771108204, -688.6349987959688, -1144.9694270391258, -897.2021053794098, -443.9459747860929, -939.3374781624776, -1015.8481555377099, -985.9296424566825, -535.0891655733922, -763.2044013178497, -1062.7090259192892, -717.78481593433, -368.0189658630022, -723.609453637464, -310.8471783650358, -962.924144930587, -731.4281065347973, -634.664564492568, -284.76040248886517, -1104.7735978798216, -688.2021811744665, -564.7226946416519, -988.0568402137017, -1118.0724164077435, -250.6226811863922, -699.0209210979411, -730.4741125113936, -790.2087551745748]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27688691832658596, "mean_inference_ms": 0.8825739078161817, "mean_action_processing_ms": 0.15649292154996292, "mean_env_wait_ms": 1.5279345802004902, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054891109466552734, "StateBufferConnector_ms": 0.0040357112884521484, "ViewRequirementAgentConnector_ms": 0.09714770317077637}, "num_episodes": 29, "episode_return_max": -39.785567350464184, "episode_return_min": -1421.1079339262799, "episode_return_mean": -700.0706553130741, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.4906746572598, "num_env_steps_trained_throughput_per_sec": 267.4906746572598, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13805.701, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13805.627, "sample_time_ms": 2359.398, "learn_time_ms": 11430.353, "learn_throughput": 349.945, "synch_weights_time_ms": 15.034}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00005", "date": "2024-08-03_05-09-53", "timestamp": 1722641993, "time_this_iter_s": 14.963099002838135, "time_total_s": 209.3975658416748, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30f40790>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 209.3975658416748, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 12.695238095238096, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 163.57845749060314, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.148074431717395, "policy_loss": -0.02044018022764552, "vf_loss": 4.163765398661296, "vf_explained_var": 0.969489281748732, "kl": 0.019829155620451896, "entropy": 1.1995300747454167, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -45.26242629996673, "episode_reward_min": -1322.6805897860875, "episode_reward_mean": -692.6412073819406, "episode_len_mean": 137.78, "episode_media": {}, "episodes_timesteps_total": 13778, "policy_reward_min": {"policy_0": -1322.6805897860875}, "policy_reward_max": {"policy_0": -45.26242629996673}, "policy_reward_mean": {"policy_0": -692.6412073819406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-992.8195975219254, -790.8313344410562, -1307.7249622728998, -732.4476483316345, -1132.3932276753792, -763.6500555747342, -1014.0827224445575, -1246.0051933007248, -1164.8303760770289, -751.3997211620317, -282.88777141067334, -877.7010378304485, -1034.8229599339595, -371.5937779075305, -614.4721521991106, -502.73999710539067, -904.0472380896053, -991.256306954834, -924.3093369431415, -1091.576036543512, -203.42637034079513, -1007.922536780519, -553.6163646331405, -909.2418349387436, -147.7885923216857, -958.8684076996486, -485.3217312293975, -56.122623276591185, -524.7941430683129, -479.0199952352349, -778.593795132366, -947.3317298808995, -109.68047414090614, -263.5187751104879, -1117.2248689365692, -218.5801799131755, -577.5082227956149, -70.53053609653966, -1036.9653436087876, -765.6265235267512, -925.1992382182227, -882.4441464916969, -69.0849927092778, -811.1059771108204, -688.6349987959688, -1144.9694270391258, -897.2021053794098, -443.9459747860929, -939.3374781624776, -1015.8481555377099, -985.9296424566825, -535.0891655733922, -763.2044013178497, -1062.7090259192892, -717.78481593433, -368.0189658630022, -723.609453637464, -310.8471783650358, -962.924144930587, -731.4281065347973, -634.664564492568, -284.76040248886517, -1104.7735978798216, -688.2021811744665, -564.7226946416519, -988.0568402137017, -1118.0724164077435, -250.6226811863922, -699.0209210979411, -730.4741125113936, -790.2087551745748, -990.1902695072164, -173.42345161011505, -79.12292664954622, -694.1009630323201, -1322.6805897860875, -825.8588764678566, -674.9521526509938, -1114.330858830302, -838.0136946367574, -707.861709273751, -736.874632045503, -963.024377123799, -651.0764037724716, -577.8340763591104, -82.53215134313464, -846.9564959802409, -650.6052579729337, -456.90055077927803, -336.33563618243886, -516.4933500422256, -810.3130503399599, -828.8359724639818, -45.26242629996673, -351.9893832587831, -374.4779627418269, -383.1800493538472, -429.893692808778, -1059.755478693678, -205.073233768463], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 84, 150, 150, 74, 150, 150, 150, 150, 59, 146, 150, 98, 150, 64, 150, 150, 150, 150, 73, 150, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 127, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 92, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 140, 150, 95, 150, 150, 150, 58, 150, 150, 125, 139, 150, 83], "policy_policy_0_reward": [-992.8195975219254, -790.8313344410562, -1307.7249622728998, -732.4476483316345, -1132.3932276753792, -763.6500555747342, -1014.0827224445575, -1246.0051933007248, -1164.8303760770289, -751.3997211620317, -282.88777141067334, -877.7010378304485, -1034.8229599339595, -371.5937779075305, -614.4721521991106, -502.73999710539067, -904.0472380896053, -991.256306954834, -924.3093369431415, -1091.576036543512, -203.42637034079513, -1007.922536780519, -553.6163646331405, -909.2418349387436, -147.7885923216857, -958.8684076996486, -485.3217312293975, -56.122623276591185, -524.7941430683129, -479.0199952352349, -778.593795132366, -947.3317298808995, -109.68047414090614, -263.5187751104879, -1117.2248689365692, -218.5801799131755, -577.5082227956149, -70.53053609653966, -1036.9653436087876, -765.6265235267512, -925.1992382182227, -882.4441464916969, -69.0849927092778, -811.1059771108204, -688.6349987959688, -1144.9694270391258, -897.2021053794098, -443.9459747860929, -939.3374781624776, -1015.8481555377099, -985.9296424566825, -535.0891655733922, -763.2044013178497, -1062.7090259192892, -717.78481593433, -368.0189658630022, -723.609453637464, -310.8471783650358, -962.924144930587, -731.4281065347973, -634.664564492568, -284.76040248886517, -1104.7735978798216, -688.2021811744665, -564.7226946416519, -988.0568402137017, -1118.0724164077435, -250.6226811863922, -699.0209210979411, -730.4741125113936, -790.2087551745748, -990.1902695072164, -173.42345161011505, -79.12292664954622, -694.1009630323201, -1322.6805897860875, -825.8588764678566, -674.9521526509938, -1114.330858830302, -838.0136946367574, -707.861709273751, -736.874632045503, -963.024377123799, -651.0764037724716, -577.8340763591104, -82.53215134313464, -846.9564959802409, -650.6052579729337, -456.90055077927803, -336.33563618243886, -516.4933500422256, -810.3130503399599, -828.8359724639818, -45.26242629996673, -351.9893832587831, -374.4779627418269, -383.1800493538472, -429.893692808778, -1059.755478693678, -205.073233768463]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2769126380764706, "mean_inference_ms": 0.8818404827780429, "mean_action_processing_ms": 0.1565659023953233, "mean_env_wait_ms": 1.5298535701187521, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005384683609008789, "StateBufferConnector_ms": 0.004021883010864258, "ViewRequirementAgentConnector_ms": 0.09670090675354004}, "num_episodes": 29, "episode_return_max": -45.26242629996673, "episode_return_min": -1322.6805897860875, "episode_return_mean": -692.6412073819406, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.0152935070967, "num_env_steps_trained_throughput_per_sec": 267.0152935070967, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13863.921, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13863.845, "sample_time_ms": 2360.545, "learn_time_ms": 11487.398, "learn_throughput": 348.208, "synch_weights_time_ms": 15.066}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00005", "date": "2024-08-03_05-10-08", "timestamp": 1722642008, "time_this_iter_s": 14.987379312515259, "time_total_s": 224.38494515419006, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0cd30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 224.38494515419006, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.795238095238098, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 204.39620194832483, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.248043276617924, "policy_loss": -0.015406468000340586, "vf_loss": 4.260034843037526, "vf_explained_var": 0.9733068921292821, "kl": 0.01617355329156758, "entropy": 1.4371695641428233, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -45.26242629996673, "episode_reward_min": -1334.599043778013, "episode_reward_mean": -702.0708802633791, "episode_len_mean": 139.24, "episode_media": {}, "episodes_timesteps_total": 13924, "policy_reward_min": {"policy_0": -1334.599043778013}, "policy_reward_max": {"policy_0": -45.26242629996673}, "policy_reward_mean": {"policy_0": -702.0708802633791}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.122623276591185, -524.7941430683129, -479.0199952352349, -778.593795132366, -947.3317298808995, -109.68047414090614, -263.5187751104879, -1117.2248689365692, -218.5801799131755, -577.5082227956149, -70.53053609653966, -1036.9653436087876, -765.6265235267512, -925.1992382182227, -882.4441464916969, -69.0849927092778, -811.1059771108204, -688.6349987959688, -1144.9694270391258, -897.2021053794098, -443.9459747860929, -939.3374781624776, -1015.8481555377099, -985.9296424566825, -535.0891655733922, -763.2044013178497, -1062.7090259192892, -717.78481593433, -368.0189658630022, -723.609453637464, -310.8471783650358, -962.924144930587, -731.4281065347973, -634.664564492568, -284.76040248886517, -1104.7735978798216, -688.2021811744665, -564.7226946416519, -988.0568402137017, -1118.0724164077435, -250.6226811863922, -699.0209210979411, -730.4741125113936, -790.2087551745748, -990.1902695072164, -173.42345161011505, -79.12292664954622, -694.1009630323201, -1322.6805897860875, -825.8588764678566, -674.9521526509938, -1114.330858830302, -838.0136946367574, -707.861709273751, -736.874632045503, -963.024377123799, -651.0764037724716, -577.8340763591104, -82.53215134313464, -846.9564959802409, -650.6052579729337, -456.90055077927803, -336.33563618243886, -516.4933500422256, -810.3130503399599, -828.8359724639818, -45.26242629996673, -351.9893832587831, -374.4779627418269, -383.1800493538472, -429.893692808778, -1059.755478693678, -205.073233768463, -756.1589420519157, -772.9285852115086, -980.4578429933238, -1203.9564977279174, -1147.6623137745107, -1334.599043778013, -824.5444980793769, -593.82500339991, -667.0104924521695, -539.1491546979242, -896.5341943948986, -784.9597136320657, -904.1000038707479, -561.2900351947576, -758.100717220504, -867.1735908324059, -983.4846440143509, -637.7384473810309, -986.728567105928, -1326.686645106582, -936.8868624335964, -873.503604935933, -366.6293667968498, -1013.6700704551635, -830.034908503371, -578.3491714463842, -574.5816623168197], "episode_lengths": [74, 150, 150, 150, 150, 59, 146, 150, 98, 150, 64, 150, 150, 150, 150, 73, 150, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 127, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 92, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 140, 150, 95, 150, 150, 150, 58, 150, 150, 125, 139, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128], "policy_policy_0_reward": [-56.122623276591185, -524.7941430683129, -479.0199952352349, -778.593795132366, -947.3317298808995, -109.68047414090614, -263.5187751104879, -1117.2248689365692, -218.5801799131755, -577.5082227956149, -70.53053609653966, -1036.9653436087876, -765.6265235267512, -925.1992382182227, -882.4441464916969, -69.0849927092778, -811.1059771108204, -688.6349987959688, -1144.9694270391258, -897.2021053794098, -443.9459747860929, -939.3374781624776, -1015.8481555377099, -985.9296424566825, -535.0891655733922, -763.2044013178497, -1062.7090259192892, -717.78481593433, -368.0189658630022, -723.609453637464, -310.8471783650358, -962.924144930587, -731.4281065347973, -634.664564492568, -284.76040248886517, -1104.7735978798216, -688.2021811744665, -564.7226946416519, -988.0568402137017, -1118.0724164077435, -250.6226811863922, -699.0209210979411, -730.4741125113936, -790.2087551745748, -990.1902695072164, -173.42345161011505, -79.12292664954622, -694.1009630323201, -1322.6805897860875, -825.8588764678566, -674.9521526509938, -1114.330858830302, -838.0136946367574, -707.861709273751, -736.874632045503, -963.024377123799, -651.0764037724716, -577.8340763591104, -82.53215134313464, -846.9564959802409, -650.6052579729337, -456.90055077927803, -336.33563618243886, -516.4933500422256, -810.3130503399599, -828.8359724639818, -45.26242629996673, -351.9893832587831, -374.4779627418269, -383.1800493538472, -429.893692808778, -1059.755478693678, -205.073233768463, -756.1589420519157, -772.9285852115086, -980.4578429933238, -1203.9564977279174, -1147.6623137745107, -1334.599043778013, -824.5444980793769, -593.82500339991, -667.0104924521695, -539.1491546979242, -896.5341943948986, -784.9597136320657, -904.1000038707479, -561.2900351947576, -758.100717220504, -867.1735908324059, -983.4846440143509, -637.7384473810309, -986.728567105928, -1326.686645106582, -936.8868624335964, -873.503604935933, -366.6293667968498, -1013.6700704551635, -830.034908503371, -578.3491714463842, -574.5816623168197]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27689143225694, "mean_inference_ms": 0.8812368544302884, "mean_action_processing_ms": 0.15656760290698685, "mean_env_wait_ms": 1.5307767349926455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053789615631103516, "StateBufferConnector_ms": 0.003997325897216797, "ViewRequirementAgentConnector_ms": 0.09631657600402832}, "num_episodes": 27, "episode_return_max": -45.26242629996673, "episode_return_min": -1334.599043778013, "episode_return_mean": -702.0708802633791, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.4140000584913, "num_env_steps_trained_throughput_per_sec": 268.4140000584913, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13920.233, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13920.155, "sample_time_ms": 2360.228, "learn_time_ms": 11543.839, "learn_throughput": 346.505, "synch_weights_time_ms": 15.241}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00005", "date": "2024-08-03_05-10-23", "timestamp": 1722642023, "time_this_iter_s": 14.909878015518188, "time_total_s": 239.29482316970825, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1352b640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 239.29482316970825, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 12.677272727272726, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 164.73009538849195, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.3727470753093565, "policy_loss": -0.012652981856081168, "vf_loss": 4.382182774196068, "vf_explained_var": 0.9692613843207558, "kl": 0.015180668839214696, "entropy": 1.336921438636879, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -21.948783718741176, "episode_reward_min": -1418.456361195876, "episode_reward_mean": -698.3351241814657, "episode_len_mean": 137.03, "episode_media": {}, "episodes_timesteps_total": 13703, "policy_reward_min": {"policy_0": -1418.456361195876}, "policy_reward_max": {"policy_0": -21.948783718741176}, "policy_reward_mean": {"policy_0": -698.3351241814657}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-731.4281065347973, -634.664564492568, -284.76040248886517, -1104.7735978798216, -688.2021811744665, -564.7226946416519, -988.0568402137017, -1118.0724164077435, -250.6226811863922, -699.0209210979411, -730.4741125113936, -790.2087551745748, -990.1902695072164, -173.42345161011505, -79.12292664954622, -694.1009630323201, -1322.6805897860875, -825.8588764678566, -674.9521526509938, -1114.330858830302, -838.0136946367574, -707.861709273751, -736.874632045503, -963.024377123799, -651.0764037724716, -577.8340763591104, -82.53215134313464, -846.9564959802409, -650.6052579729337, -456.90055077927803, -336.33563618243886, -516.4933500422256, -810.3130503399599, -828.8359724639818, -45.26242629996673, -351.9893832587831, -374.4779627418269, -383.1800493538472, -429.893692808778, -1059.755478693678, -205.073233768463, -756.1589420519157, -772.9285852115086, -980.4578429933238, -1203.9564977279174, -1147.6623137745107, -1334.599043778013, -824.5444980793769, -593.82500339991, -667.0104924521695, -539.1491546979242, -896.5341943948986, -784.9597136320657, -904.1000038707479, -561.2900351947576, -758.100717220504, -867.1735908324059, -983.4846440143509, -637.7384473810309, -986.728567105928, -1326.686645106582, -936.8868624335964, -873.503604935933, -366.6293667968498, -1013.6700704551635, -830.034908503371, -578.3491714463842, -574.5816623168197, -624.6009111863816, -1098.695653193311, -688.9072512058509, -159.0061347119939, -166.20818122246823, -951.7179657373254, -1157.2488509233533, -453.2400971890725, -579.1335041640284, -1055.5761303443578, -839.222326289546, -33.969043544534784, -687.5786533347803, -152.47878860465866, -779.3356233479429, -887.0318434755083, -936.2986592500571, -1418.456361195876, -1046.7492838183541, -21.948783718741176, -550.3208841552354, -1182.5513178788162, -1044.7741854943122, -104.63110263846164, -341.2449607586015, -728.0989204550742, -828.6385566592697, -124.82496378256997, -128.6973434717197, -946.9378401935003, -641.9834127848059, -459.7033560288348], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 92, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 150, 140, 150, 95, 150, 150, 150, 58, 150, 150, 125, 139, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 69, 61, 150, 150, 111, 150, 150, 150, 42, 150, 88, 150, 150, 150, 150, 150, 41, 150, 150, 150, 91, 150, 145, 150, 97, 87, 150, 150, 130], "policy_policy_0_reward": [-731.4281065347973, -634.664564492568, -284.76040248886517, -1104.7735978798216, -688.2021811744665, -564.7226946416519, -988.0568402137017, -1118.0724164077435, -250.6226811863922, -699.0209210979411, -730.4741125113936, -790.2087551745748, -990.1902695072164, -173.42345161011505, -79.12292664954622, -694.1009630323201, -1322.6805897860875, -825.8588764678566, -674.9521526509938, -1114.330858830302, -838.0136946367574, -707.861709273751, -736.874632045503, -963.024377123799, -651.0764037724716, -577.8340763591104, -82.53215134313464, -846.9564959802409, -650.6052579729337, -456.90055077927803, -336.33563618243886, -516.4933500422256, -810.3130503399599, -828.8359724639818, -45.26242629996673, -351.9893832587831, -374.4779627418269, -383.1800493538472, -429.893692808778, -1059.755478693678, -205.073233768463, -756.1589420519157, -772.9285852115086, -980.4578429933238, -1203.9564977279174, -1147.6623137745107, -1334.599043778013, -824.5444980793769, -593.82500339991, -667.0104924521695, -539.1491546979242, -896.5341943948986, -784.9597136320657, -904.1000038707479, -561.2900351947576, -758.100717220504, -867.1735908324059, -983.4846440143509, -637.7384473810309, -986.728567105928, -1326.686645106582, -936.8868624335964, -873.503604935933, -366.6293667968498, -1013.6700704551635, -830.034908503371, -578.3491714463842, -574.5816623168197, -624.6009111863816, -1098.695653193311, -688.9072512058509, -159.0061347119939, -166.20818122246823, -951.7179657373254, -1157.2488509233533, -453.2400971890725, -579.1335041640284, -1055.5761303443578, -839.222326289546, -33.969043544534784, -687.5786533347803, -152.47878860465866, -779.3356233479429, -887.0318434755083, -936.2986592500571, -1418.456361195876, -1046.7492838183541, -21.948783718741176, -550.3208841552354, -1182.5513178788162, -1044.7741854943122, -104.63110263846164, -341.2449607586015, -728.0989204550742, -828.6385566592697, -124.82496378256997, -128.6973434717197, -946.9378401935003, -641.9834127848059, -459.7033560288348]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.276954163773454, "mean_inference_ms": 0.8802944896924259, "mean_action_processing_ms": 0.15652520839942727, "mean_env_wait_ms": 1.5323182339388302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005442619323730469, "StateBufferConnector_ms": 0.004022359848022461, "ViewRequirementAgentConnector_ms": 0.09696602821350098}, "num_episodes": 32, "episode_return_max": -21.948783718741176, "episode_return_min": -1418.456361195876, "episode_return_mean": -698.3351241814657, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.0330076554015, "num_env_steps_trained_throughput_per_sec": 268.0330076554015, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 14365.604, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14365.526, "sample_time_ms": 2349.547, "learn_time_ms": 11999.299, "learn_throughput": 333.353, "synch_weights_time_ms": 15.817}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00005", "date": "2024-08-03_05-10-38", "timestamp": 1722642038, "time_this_iter_s": 14.932618379592896, "time_total_s": 254.22744154930115, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0e950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 254.22744154930115, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 12.833333333333334, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 188.69321023225785, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.8928516196707883, "policy_loss": -0.015196021963978032, "vf_loss": 3.9039757579565046, "vf_explained_var": 0.9839880048607786, "kl": 0.017924802664068328, "entropy": 1.3055618088692427, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -21.948783718741176, "episode_reward_min": -1418.456361195876, "episode_reward_mean": -684.8375681923827, "episode_len_mean": 134.59, "episode_media": {}, "episodes_timesteps_total": 13459, "policy_reward_min": {"policy_0": -1418.456361195876}, "policy_reward_max": {"policy_0": -21.948783718741176}, "policy_reward_mean": {"policy_0": -684.8375681923827}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-336.33563618243886, -516.4933500422256, -810.3130503399599, -828.8359724639818, -45.26242629996673, -351.9893832587831, -374.4779627418269, -383.1800493538472, -429.893692808778, -1059.755478693678, -205.073233768463, -756.1589420519157, -772.9285852115086, -980.4578429933238, -1203.9564977279174, -1147.6623137745107, -1334.599043778013, -824.5444980793769, -593.82500339991, -667.0104924521695, -539.1491546979242, -896.5341943948986, -784.9597136320657, -904.1000038707479, -561.2900351947576, -758.100717220504, -867.1735908324059, -983.4846440143509, -637.7384473810309, -986.728567105928, -1326.686645106582, -936.8868624335964, -873.503604935933, -366.6293667968498, -1013.6700704551635, -830.034908503371, -578.3491714463842, -574.5816623168197, -624.6009111863816, -1098.695653193311, -688.9072512058509, -159.0061347119939, -166.20818122246823, -951.7179657373254, -1157.2488509233533, -453.2400971890725, -579.1335041640284, -1055.5761303443578, -839.222326289546, -33.969043544534784, -687.5786533347803, -152.47878860465866, -779.3356233479429, -887.0318434755083, -936.2986592500571, -1418.456361195876, -1046.7492838183541, -21.948783718741176, -550.3208841552354, -1182.5513178788162, -1044.7741854943122, -104.63110263846164, -341.2449607586015, -728.0989204550742, -828.6385566592697, -124.82496378256997, -128.6973434717197, -946.9378401935003, -641.9834127848059, -459.7033560288348, -936.8667096530087, -77.04305277549585, -927.5940333824149, -237.55793799662231, -556.4119070995876, -628.795982094507, -1057.8581298099718, -780.0279299228087, -634.2479256456738, -747.4807784003275, -331.067423931335, -122.26992098104662, -76.73623596039893, -296.55024746704686, -449.8308784055235, -1325.2062893363986, -1010.3788455437405, -32.791457616358585, -521.5053372807452, -1067.6976894997752, -953.6592031195619, -60.468113706486946, -794.9634967535774, -796.497806890121, -762.8707482881149, -965.7924590885366, -934.6119406297298, -987.6484669291173, -682.8731141277792, -864.287050381202], "episode_lengths": [95, 150, 150, 150, 58, 150, 150, 125, 139, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 69, 61, 150, 150, 111, 150, 150, 150, 42, 150, 88, 150, 150, 150, 150, 150, 41, 150, 150, 150, 91, 150, 145, 150, 97, 87, 150, 150, 130, 150, 58, 150, 105, 150, 150, 150, 150, 150, 150, 126, 72, 55, 94, 119, 150, 150, 61, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-336.33563618243886, -516.4933500422256, -810.3130503399599, -828.8359724639818, -45.26242629996673, -351.9893832587831, -374.4779627418269, -383.1800493538472, -429.893692808778, -1059.755478693678, -205.073233768463, -756.1589420519157, -772.9285852115086, -980.4578429933238, -1203.9564977279174, -1147.6623137745107, -1334.599043778013, -824.5444980793769, -593.82500339991, -667.0104924521695, -539.1491546979242, -896.5341943948986, -784.9597136320657, -904.1000038707479, -561.2900351947576, -758.100717220504, -867.1735908324059, -983.4846440143509, -637.7384473810309, -986.728567105928, -1326.686645106582, -936.8868624335964, -873.503604935933, -366.6293667968498, -1013.6700704551635, -830.034908503371, -578.3491714463842, -574.5816623168197, -624.6009111863816, -1098.695653193311, -688.9072512058509, -159.0061347119939, -166.20818122246823, -951.7179657373254, -1157.2488509233533, -453.2400971890725, -579.1335041640284, -1055.5761303443578, -839.222326289546, -33.969043544534784, -687.5786533347803, -152.47878860465866, -779.3356233479429, -887.0318434755083, -936.2986592500571, -1418.456361195876, -1046.7492838183541, -21.948783718741176, -550.3208841552354, -1182.5513178788162, -1044.7741854943122, -104.63110263846164, -341.2449607586015, -728.0989204550742, -828.6385566592697, -124.82496378256997, -128.6973434717197, -946.9378401935003, -641.9834127848059, -459.7033560288348, -936.8667096530087, -77.04305277549585, -927.5940333824149, -237.55793799662231, -556.4119070995876, -628.795982094507, -1057.8581298099718, -780.0279299228087, -634.2479256456738, -747.4807784003275, -331.067423931335, -122.26992098104662, -76.73623596039893, -296.55024746704686, -449.8308784055235, -1325.2062893363986, -1010.3788455437405, -32.791457616358585, -521.5053372807452, -1067.6976894997752, -953.6592031195619, -60.468113706486946, -794.9634967535774, -796.497806890121, -762.8707482881149, -965.7924590885366, -934.6119406297298, -987.6484669291173, -682.8731141277792, -864.287050381202]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2771554794706503, "mean_inference_ms": 0.8798292535703349, "mean_action_processing_ms": 0.15655883651994498, "mean_env_wait_ms": 1.5331066477971007, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054416656494140625, "StateBufferConnector_ms": 0.004045963287353516, "ViewRequirementAgentConnector_ms": 0.09778642654418945}, "num_episodes": 30, "episode_return_max": -21.948783718741176, "episode_return_min": -1418.456361195876, "episode_return_mean": -684.8375681923827, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.3316524369181, "num_env_steps_trained_throughput_per_sec": 268.3316524369181, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 15007.178, "restore_workers_time_ms": 0.026, "training_step_time_ms": 15007.098, "sample_time_ms": 2353.017, "learn_time_ms": 12637.069, "learn_throughput": 316.529, "synch_weights_time_ms": 16.136}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00005", "date": "2024-08-03_05-10-53", "timestamp": 1722642053, "time_this_iter_s": 14.915230989456177, "time_total_s": 269.1426725387573, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1357af80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 269.1426725387573, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 12.72857142857143, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 155.85670367876688, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.553383995840947, "policy_loss": -0.008893914665774598, "vf_loss": 4.558432541042566, "vf_explained_var": 0.9824159653857351, "kl": 0.01765515808871593, "entropy": 1.4511788610368968, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -21.948783718741176, "episode_reward_min": -1418.456361195876, "episode_reward_mean": -661.7753665829944, "episode_len_mean": 130.25, "episode_media": {}, "episodes_timesteps_total": 13025, "policy_reward_min": {"policy_0": -1418.456361195876}, "policy_reward_max": {"policy_0": -21.948783718741176}, "policy_reward_mean": {"policy_0": -661.7753665829944}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-936.8868624335964, -873.503604935933, -366.6293667968498, -1013.6700704551635, -830.034908503371, -578.3491714463842, -574.5816623168197, -624.6009111863816, -1098.695653193311, -688.9072512058509, -159.0061347119939, -166.20818122246823, -951.7179657373254, -1157.2488509233533, -453.2400971890725, -579.1335041640284, -1055.5761303443578, -839.222326289546, -33.969043544534784, -687.5786533347803, -152.47878860465866, -779.3356233479429, -887.0318434755083, -936.2986592500571, -1418.456361195876, -1046.7492838183541, -21.948783718741176, -550.3208841552354, -1182.5513178788162, -1044.7741854943122, -104.63110263846164, -341.2449607586015, -728.0989204550742, -828.6385566592697, -124.82496378256997, -128.6973434717197, -946.9378401935003, -641.9834127848059, -459.7033560288348, -936.8667096530087, -77.04305277549585, -927.5940333824149, -237.55793799662231, -556.4119070995876, -628.795982094507, -1057.8581298099718, -780.0279299228087, -634.2479256456738, -747.4807784003275, -331.067423931335, -122.26992098104662, -76.73623596039893, -296.55024746704686, -449.8308784055235, -1325.2062893363986, -1010.3788455437405, -32.791457616358585, -521.5053372807452, -1067.6976894997752, -953.6592031195619, -60.468113706486946, -794.9634967535774, -796.497806890121, -762.8707482881149, -965.7924590885366, -934.6119406297298, -987.6484669291173, -682.8731141277792, -864.287050381202, -946.4157085935503, -359.1037701845705, -699.3182377864232, -1038.7474931700026, -785.997624247925, -1094.971635614567, -931.1737639897054, -728.9568809936586, -43.65136300772162, -84.65270143746197, -978.5168283730774, -761.1813054870117, -919.751557955388, -197.9160313223443, -627.8159086729484, -85.60483793228195, -1066.690651881103, -246.04146739353058, -464.8137501529167, -1284.0957157339265, -771.6865952408947, -1055.3262339976834, -1405.9130736734658, -563.6076661124499, -295.5179176622446, -171.30965782917835, -729.5524166134637, -945.2221050107876, -771.0429837048375, -256.2057266161156, -251.6773975437101], "episode_lengths": [150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 69, 61, 150, 150, 111, 150, 150, 150, 42, 150, 88, 150, 150, 150, 150, 150, 41, 150, 150, 150, 91, 150, 145, 150, 97, 87, 150, 150, 130, 150, 58, 150, 105, 150, 150, 150, 150, 150, 150, 126, 72, 55, 94, 119, 150, 150, 61, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 51, 150, 150, 150, 73, 150, 54, 150, 99, 150, 150, 150, 150, 150, 150, 83, 68, 150, 150, 150, 100, 87], "policy_policy_0_reward": [-936.8868624335964, -873.503604935933, -366.6293667968498, -1013.6700704551635, -830.034908503371, -578.3491714463842, -574.5816623168197, -624.6009111863816, -1098.695653193311, -688.9072512058509, -159.0061347119939, -166.20818122246823, -951.7179657373254, -1157.2488509233533, -453.2400971890725, -579.1335041640284, -1055.5761303443578, -839.222326289546, -33.969043544534784, -687.5786533347803, -152.47878860465866, -779.3356233479429, -887.0318434755083, -936.2986592500571, -1418.456361195876, -1046.7492838183541, -21.948783718741176, -550.3208841552354, -1182.5513178788162, -1044.7741854943122, -104.63110263846164, -341.2449607586015, -728.0989204550742, -828.6385566592697, -124.82496378256997, -128.6973434717197, -946.9378401935003, -641.9834127848059, -459.7033560288348, -936.8667096530087, -77.04305277549585, -927.5940333824149, -237.55793799662231, -556.4119070995876, -628.795982094507, -1057.8581298099718, -780.0279299228087, -634.2479256456738, -747.4807784003275, -331.067423931335, -122.26992098104662, -76.73623596039893, -296.55024746704686, -449.8308784055235, -1325.2062893363986, -1010.3788455437405, -32.791457616358585, -521.5053372807452, -1067.6976894997752, -953.6592031195619, -60.468113706486946, -794.9634967535774, -796.497806890121, -762.8707482881149, -965.7924590885366, -934.6119406297298, -987.6484669291173, -682.8731141277792, -864.287050381202, -946.4157085935503, -359.1037701845705, -699.3182377864232, -1038.7474931700026, -785.997624247925, -1094.971635614567, -931.1737639897054, -728.9568809936586, -43.65136300772162, -84.65270143746197, -978.5168283730774, -761.1813054870117, -919.751557955388, -197.9160313223443, -627.8159086729484, -85.60483793228195, -1066.690651881103, -246.04146739353058, -464.8137501529167, -1284.0957157339265, -771.6865952408947, -1055.3262339976834, -1405.9130736734658, -563.6076661124499, -295.5179176622446, -171.30965782917835, -729.5524166134637, -945.2221050107876, -771.0429837048375, -256.2057266161156, -251.6773975437101]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27733420197420605, "mean_inference_ms": 0.8793356285285686, "mean_action_processing_ms": 0.15660205887136436, "mean_env_wait_ms": 1.5349018278705682, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005578517913818359, "StateBufferConnector_ms": 0.004140138626098633, "ViewRequirementAgentConnector_ms": 0.10001802444458008}, "num_episodes": 31, "episode_return_max": -21.948783718741176, "episode_return_min": -1418.456361195876, "episode_return_mean": -661.7753665829944, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.480666042952, "num_env_steps_trained_throughput_per_sec": 321.480666042952, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 14778.59, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14778.509, "sample_time_ms": 2358.875, "learn_time_ms": 12402.655, "learn_throughput": 322.512, "synch_weights_time_ms": 16.105}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00005", "date": "2024-08-03_05-11-05", "timestamp": 1722642065, "time_this_iter_s": 12.449533462524414, "time_total_s": 281.59220600128174, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1352bbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 281.59220600128174, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.183333333333334, "ram_util_percent": 19.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 202.7591114739577, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.093323849265774, "policy_loss": -0.010420628956247431, "vf_loss": 4.100199095035593, "vf_explained_var": 0.9854372655351956, "kl": 0.016803177731344494, "entropy": 1.495561002070705, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -16.183164936359667, "episode_reward_min": -1405.9130736734658, "episode_reward_mean": -683.0013235141005, "episode_len_mean": 132.3, "episode_media": {}, "episodes_timesteps_total": 13230, "policy_reward_min": {"policy_0": -1405.9130736734658}, "policy_reward_max": {"policy_0": -16.183164936359667}, "policy_reward_mean": {"policy_0": -683.0013235141005}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1044.7741854943122, -104.63110263846164, -341.2449607586015, -728.0989204550742, -828.6385566592697, -124.82496378256997, -128.6973434717197, -946.9378401935003, -641.9834127848059, -459.7033560288348, -936.8667096530087, -77.04305277549585, -927.5940333824149, -237.55793799662231, -556.4119070995876, -628.795982094507, -1057.8581298099718, -780.0279299228087, -634.2479256456738, -747.4807784003275, -331.067423931335, -122.26992098104662, -76.73623596039893, -296.55024746704686, -449.8308784055235, -1325.2062893363986, -1010.3788455437405, -32.791457616358585, -521.5053372807452, -1067.6976894997752, -953.6592031195619, -60.468113706486946, -794.9634967535774, -796.497806890121, -762.8707482881149, -965.7924590885366, -934.6119406297298, -987.6484669291173, -682.8731141277792, -864.287050381202, -946.4157085935503, -359.1037701845705, -699.3182377864232, -1038.7474931700026, -785.997624247925, -1094.971635614567, -931.1737639897054, -728.9568809936586, -43.65136300772162, -84.65270143746197, -978.5168283730774, -761.1813054870117, -919.751557955388, -197.9160313223443, -627.8159086729484, -85.60483793228195, -1066.690651881103, -246.04146739353058, -464.8137501529167, -1284.0957157339265, -771.6865952408947, -1055.3262339976834, -1405.9130736734658, -563.6076661124499, -295.5179176622446, -171.30965782917835, -729.5524166134637, -945.2221050107876, -771.0429837048375, -256.2057266161156, -251.6773975437101, -723.5035144505728, -951.0049838816992, -769.0923562760835, -920.9713628544708, -653.8154479623555, -278.9387860841248, -574.4981491160295, -138.74218597125835, -1054.76364229164, -699.3986151709527, -875.425375749716, -1242.497378124031, -448.1791048024203, -582.7089299233877, -819.7892528953663, -1028.8113264157687, -1245.1041206761386, -577.5330773380689, -767.0669675962855, -1367.9531980060506, -724.2376012846697, -1084.763308029478, -1017.7401929054267, -16.183164936359667, -96.28557813714446, -1127.2177158129193, -1098.8426503635822, -1100.724483383953, -780.7351180509941], "episode_lengths": [150, 91, 150, 145, 150, 97, 87, 150, 150, 130, 150, 58, 150, 105, 150, 150, 150, 150, 150, 150, 126, 72, 55, 94, 119, 150, 150, 61, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 51, 150, 150, 150, 73, 150, 54, 150, 99, 150, 150, 150, 150, 150, 150, 83, 68, 150, 150, 150, 100, 87, 150, 150, 150, 150, 148, 115, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 71, 150, 150, 150, 150], "policy_policy_0_reward": [-1044.7741854943122, -104.63110263846164, -341.2449607586015, -728.0989204550742, -828.6385566592697, -124.82496378256997, -128.6973434717197, -946.9378401935003, -641.9834127848059, -459.7033560288348, -936.8667096530087, -77.04305277549585, -927.5940333824149, -237.55793799662231, -556.4119070995876, -628.795982094507, -1057.8581298099718, -780.0279299228087, -634.2479256456738, -747.4807784003275, -331.067423931335, -122.26992098104662, -76.73623596039893, -296.55024746704686, -449.8308784055235, -1325.2062893363986, -1010.3788455437405, -32.791457616358585, -521.5053372807452, -1067.6976894997752, -953.6592031195619, -60.468113706486946, -794.9634967535774, -796.497806890121, -762.8707482881149, -965.7924590885366, -934.6119406297298, -987.6484669291173, -682.8731141277792, -864.287050381202, -946.4157085935503, -359.1037701845705, -699.3182377864232, -1038.7474931700026, -785.997624247925, -1094.971635614567, -931.1737639897054, -728.9568809936586, -43.65136300772162, -84.65270143746197, -978.5168283730774, -761.1813054870117, -919.751557955388, -197.9160313223443, -627.8159086729484, -85.60483793228195, -1066.690651881103, -246.04146739353058, -464.8137501529167, -1284.0957157339265, -771.6865952408947, -1055.3262339976834, -1405.9130736734658, -563.6076661124499, -295.5179176622446, -171.30965782917835, -729.5524166134637, -945.2221050107876, -771.0429837048375, -256.2057266161156, -251.6773975437101, -723.5035144505728, -951.0049838816992, -769.0923562760835, -920.9713628544708, -653.8154479623555, -278.9387860841248, -574.4981491160295, -138.74218597125835, -1054.76364229164, -699.3986151709527, -875.425375749716, -1242.497378124031, -448.1791048024203, -582.7089299233877, -819.7892528953663, -1028.8113264157687, -1245.1041206761386, -577.5330773380689, -767.0669675962855, -1367.9531980060506, -724.2376012846697, -1084.763308029478, -1017.7401929054267, -16.183164936359667, -96.28557813714446, -1127.2177158129193, -1098.8426503635822, -1100.724483383953, -780.7351180509941]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2775128650512999, "mean_inference_ms": 0.8790843279552353, "mean_action_processing_ms": 0.15665024544114092, "mean_env_wait_ms": 1.536870481806717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053844451904296875, "StateBufferConnector_ms": 0.004173755645751953, "ViewRequirementAgentConnector_ms": 0.10158610343933105}, "num_episodes": 29, "episode_return_max": -16.183164936359667, "episode_return_min": -1405.9130736734658, "episode_return_mean": -683.0013235141005, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 257.4268105658436, "num_env_steps_trained_throughput_per_sec": 257.4268105658436, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 14833.884, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14833.804, "sample_time_ms": 2368.167, "learn_time_ms": 12448.697, "learn_throughput": 321.319, "synch_weights_time_ms": 16.069}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00005", "date": "2024-08-03_05-11-21", "timestamp": 1722642081, "time_this_iter_s": 15.54740047454834, "time_total_s": 297.1396064758301, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0e170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 297.1396064758301, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 12.736363636363636, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.19413647254308, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.2026173812647665, "policy_loss": -0.011324933208622193, "vf_loss": 4.210167574882507, "vf_explained_var": 0.9711777310197552, "kl": 0.01693113982112211, "entropy": 1.3046052755167088, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -16.183164936359667, "episode_reward_min": -1405.9130736734658, "episode_reward_mean": -683.2604498305254, "episode_len_mean": 135.12, "episode_media": {}, "episodes_timesteps_total": 13512, "policy_reward_min": {"policy_0": -1405.9130736734658}, "policy_reward_max": {"policy_0": -16.183164936359667}, "policy_reward_mean": {"policy_0": -683.2604498305254}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-521.5053372807452, -1067.6976894997752, -953.6592031195619, -60.468113706486946, -794.9634967535774, -796.497806890121, -762.8707482881149, -965.7924590885366, -934.6119406297298, -987.6484669291173, -682.8731141277792, -864.287050381202, -946.4157085935503, -359.1037701845705, -699.3182377864232, -1038.7474931700026, -785.997624247925, -1094.971635614567, -931.1737639897054, -728.9568809936586, -43.65136300772162, -84.65270143746197, -978.5168283730774, -761.1813054870117, -919.751557955388, -197.9160313223443, -627.8159086729484, -85.60483793228195, -1066.690651881103, -246.04146739353058, -464.8137501529167, -1284.0957157339265, -771.6865952408947, -1055.3262339976834, -1405.9130736734658, -563.6076661124499, -295.5179176622446, -171.30965782917835, -729.5524166134637, -945.2221050107876, -771.0429837048375, -256.2057266161156, -251.6773975437101, -723.5035144505728, -951.0049838816992, -769.0923562760835, -920.9713628544708, -653.8154479623555, -278.9387860841248, -574.4981491160295, -138.74218597125835, -1054.76364229164, -699.3986151709527, -875.425375749716, -1242.497378124031, -448.1791048024203, -582.7089299233877, -819.7892528953663, -1028.8113264157687, -1245.1041206761386, -577.5330773380689, -767.0669675962855, -1367.9531980060506, -724.2376012846697, -1084.763308029478, -1017.7401929054267, -16.183164936359667, -96.28557813714446, -1127.2177158129193, -1098.8426503635822, -1100.724483383953, -780.7351180509941, -146.02311072630897, -343.9081991288432, -274.07050485680844, -710.8758315548381, -565.3831828591434, -28.152900269053525, -286.52242722865276, -1114.709600570376, -1041.4644863443457, -805.4104070668294, -958.8082892622584, -398.2284667193592, -429.455033206686, -653.1967299185105, -440.0643540923933, -720.3678393014552, -594.0139700930795, -536.1266874540092, -617.8813286052626, -648.4035588862569, -637.5763924875412, -28.615663155903942, -341.0819490041863, -516.2852407202561, -1106.0352470594585, -251.4063701601989, -586.525939454292, -823.5692497456001], "episode_lengths": [150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 51, 150, 150, 150, 73, 150, 54, 150, 99, 150, 150, 150, 150, 150, 150, 83, 68, 150, 150, 150, 100, 87, 150, 150, 150, 150, 148, 115, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 71, 150, 150, 150, 150, 96, 105, 150, 150, 150, 83, 143, 150, 150, 150, 150, 111, 150, 150, 112, 150, 150, 133, 150, 150, 150, 50, 124, 150, 150, 115, 150, 150], "policy_policy_0_reward": [-521.5053372807452, -1067.6976894997752, -953.6592031195619, -60.468113706486946, -794.9634967535774, -796.497806890121, -762.8707482881149, -965.7924590885366, -934.6119406297298, -987.6484669291173, -682.8731141277792, -864.287050381202, -946.4157085935503, -359.1037701845705, -699.3182377864232, -1038.7474931700026, -785.997624247925, -1094.971635614567, -931.1737639897054, -728.9568809936586, -43.65136300772162, -84.65270143746197, -978.5168283730774, -761.1813054870117, -919.751557955388, -197.9160313223443, -627.8159086729484, -85.60483793228195, -1066.690651881103, -246.04146739353058, -464.8137501529167, -1284.0957157339265, -771.6865952408947, -1055.3262339976834, -1405.9130736734658, -563.6076661124499, -295.5179176622446, -171.30965782917835, -729.5524166134637, -945.2221050107876, -771.0429837048375, -256.2057266161156, -251.6773975437101, -723.5035144505728, -951.0049838816992, -769.0923562760835, -920.9713628544708, -653.8154479623555, -278.9387860841248, -574.4981491160295, -138.74218597125835, -1054.76364229164, -699.3986151709527, -875.425375749716, -1242.497378124031, -448.1791048024203, -582.7089299233877, -819.7892528953663, -1028.8113264157687, -1245.1041206761386, -577.5330773380689, -767.0669675962855, -1367.9531980060506, -724.2376012846697, -1084.763308029478, -1017.7401929054267, -16.183164936359667, -96.28557813714446, -1127.2177158129193, -1098.8426503635822, -1100.724483383953, -780.7351180509941, -146.02311072630897, -343.9081991288432, -274.07050485680844, -710.8758315548381, -565.3831828591434, -28.152900269053525, -286.52242722865276, -1114.709600570376, -1041.4644863443457, -805.4104070668294, -958.8082892622584, -398.2284667193592, -429.455033206686, -653.1967299185105, -440.0643540923933, -720.3678393014552, -594.0139700930795, -536.1266874540092, -617.8813286052626, -648.4035588862569, -637.5763924875412, -28.615663155903942, -341.0819490041863, -516.2852407202561, -1106.0352470594585, -251.4063701601989, -586.525939454292, -823.5692497456001]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2777775710948169, "mean_inference_ms": 0.8791378516609192, "mean_action_processing_ms": 0.15673737038961938, "mean_env_wait_ms": 1.537939952437425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005374908447265625, "StateBufferConnector_ms": 0.004164218902587891, "ViewRequirementAgentConnector_ms": 0.10161924362182617}, "num_episodes": 28, "episode_return_max": -16.183164936359667, "episode_return_min": -1405.9130736734658, "episode_return_mean": -683.2604498305254, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 266.8249560647838, "num_env_steps_trained_throughput_per_sec": 266.8249560647838, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 14821.066, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14820.99, "sample_time_ms": 2363.293, "learn_time_ms": 12440.933, "learn_throughput": 321.519, "synch_weights_time_ms": 15.894}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00005", "date": "2024-08-03_05-11-36", "timestamp": 1722642096, "time_this_iter_s": 14.998591661453247, "time_total_s": 312.1381981372833, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1352b010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 312.1381981372833, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 12.77142857142857, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 206.17999895413718, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.913612452770273, "policy_loss": -0.01041138358511186, "vf_loss": 3.920035760104656, "vf_explained_var": 0.9787988858297467, "kl": 0.01804208273400341, "entropy": 1.424557130287091, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -16.183164936359667, "episode_reward_min": -1405.9130736734658, "episode_reward_mean": -714.4736881731692, "episode_len_mean": 138.05, "episode_media": {}, "episodes_timesteps_total": 13805, "policy_reward_min": {"policy_0": -1405.9130736734658}, "policy_reward_max": {"policy_0": -16.183164936359667}, "policy_reward_mean": {"policy_0": -714.4736881731692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-464.8137501529167, -1284.0957157339265, -771.6865952408947, -1055.3262339976834, -1405.9130736734658, -563.6076661124499, -295.5179176622446, -171.30965782917835, -729.5524166134637, -945.2221050107876, -771.0429837048375, -256.2057266161156, -251.6773975437101, -723.5035144505728, -951.0049838816992, -769.0923562760835, -920.9713628544708, -653.8154479623555, -278.9387860841248, -574.4981491160295, -138.74218597125835, -1054.76364229164, -699.3986151709527, -875.425375749716, -1242.497378124031, -448.1791048024203, -582.7089299233877, -819.7892528953663, -1028.8113264157687, -1245.1041206761386, -577.5330773380689, -767.0669675962855, -1367.9531980060506, -724.2376012846697, -1084.763308029478, -1017.7401929054267, -16.183164936359667, -96.28557813714446, -1127.2177158129193, -1098.8426503635822, -1100.724483383953, -780.7351180509941, -146.02311072630897, -343.9081991288432, -274.07050485680844, -710.8758315548381, -565.3831828591434, -28.152900269053525, -286.52242722865276, -1114.709600570376, -1041.4644863443457, -805.4104070668294, -958.8082892622584, -398.2284667193592, -429.455033206686, -653.1967299185105, -440.0643540923933, -720.3678393014552, -594.0139700930795, -536.1266874540092, -617.8813286052626, -648.4035588862569, -637.5763924875412, -28.615663155903942, -341.0819490041863, -516.2852407202561, -1106.0352470594585, -251.4063701601989, -586.525939454292, -823.5692497456001, -491.4000662228336, -866.453894511674, -667.6634706686283, -1221.9811531624187, -398.7927501343787, -811.7526294179391, -882.6339244790842, -194.54824780050123, -765.3221773470792, -498.48660837475, -50.04279298316735, -1304.4602057983711, -1388.2866429805258, -901.8106030781032, -839.0821513728637, -584.1530576859267, -873.3143888062497, -828.9462630609205, -628.0035570339487, -839.6959688414638, -1330.0770913145695, -607.7792051850785, -337.5539175273952, -703.1190132010415, -1117.7768554409047, -1120.189504043836, -854.1241302365459, -1177.1926672831119, -1024.1294219463823, -801.9346690626887], "episode_lengths": [150, 150, 150, 150, 150, 150, 83, 68, 150, 150, 150, 100, 87, 150, 150, 150, 150, 148, 115, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 71, 150, 150, 150, 150, 96, 105, 150, 150, 150, 83, 143, 150, 150, 150, 150, 111, 150, 150, 112, 150, 150, 133, 150, 150, 150, 50, 124, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 144, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-464.8137501529167, -1284.0957157339265, -771.6865952408947, -1055.3262339976834, -1405.9130736734658, -563.6076661124499, -295.5179176622446, -171.30965782917835, -729.5524166134637, -945.2221050107876, -771.0429837048375, -256.2057266161156, -251.6773975437101, -723.5035144505728, -951.0049838816992, -769.0923562760835, -920.9713628544708, -653.8154479623555, -278.9387860841248, -574.4981491160295, -138.74218597125835, -1054.76364229164, -699.3986151709527, -875.425375749716, -1242.497378124031, -448.1791048024203, -582.7089299233877, -819.7892528953663, -1028.8113264157687, -1245.1041206761386, -577.5330773380689, -767.0669675962855, -1367.9531980060506, -724.2376012846697, -1084.763308029478, -1017.7401929054267, -16.183164936359667, -96.28557813714446, -1127.2177158129193, -1098.8426503635822, -1100.724483383953, -780.7351180509941, -146.02311072630897, -343.9081991288432, -274.07050485680844, -710.8758315548381, -565.3831828591434, -28.152900269053525, -286.52242722865276, -1114.709600570376, -1041.4644863443457, -805.4104070668294, -958.8082892622584, -398.2284667193592, -429.455033206686, -653.1967299185105, -440.0643540923933, -720.3678393014552, -594.0139700930795, -536.1266874540092, -617.8813286052626, -648.4035588862569, -637.5763924875412, -28.615663155903942, -341.0819490041863, -516.2852407202561, -1106.0352470594585, -251.4063701601989, -586.525939454292, -823.5692497456001, -491.4000662228336, -866.453894511674, -667.6634706686283, -1221.9811531624187, -398.7927501343787, -811.7526294179391, -882.6339244790842, -194.54824780050123, -765.3221773470792, -498.48660837475, -50.04279298316735, -1304.4602057983711, -1388.2866429805258, -901.8106030781032, -839.0821513728637, -584.1530576859267, -873.3143888062497, -828.9462630609205, -628.0035570339487, -839.6959688414638, -1330.0770913145695, -607.7792051850785, -337.5539175273952, -703.1190132010415, -1117.7768554409047, -1120.189504043836, -854.1241302365459, -1177.1926672831119, -1024.1294219463823, -801.9346690626887]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2779315959855797, "mean_inference_ms": 0.8790483913582051, "mean_action_processing_ms": 0.1567697726553517, "mean_env_wait_ms": 1.5403846230064602, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055065155029296875, "StateBufferConnector_ms": 0.004260540008544922, "ViewRequirementAgentConnector_ms": 0.10478377342224121}, "num_episodes": 30, "episode_return_max": -16.183164936359667, "episode_return_min": -1405.9130736734658, "episode_return_mean": -714.4736881731692, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.3683037970077, "num_env_steps_trained_throughput_per_sec": 261.3683037970077, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 14835.906, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14835.83, "sample_time_ms": 2370.353, "learn_time_ms": 12448.779, "learn_throughput": 321.317, "synch_weights_time_ms": 15.845}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00005", "date": "2024-08-03_05-11-52", "timestamp": 1722642112, "time_this_iter_s": 15.311532258987427, "time_total_s": 327.44973039627075, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0f0a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 327.44973039627075, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 12.909090909090908, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 220.34955514669417, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.5457401228447756, "policy_loss": -0.012835545182557933, "vf_loss": 3.5548682575424513, "vf_explained_var": 0.9827597673982382, "kl": 0.016995000851117485, "entropy": 1.3910843561093011, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -16.183164936359667, "episode_reward_min": -1388.2866429805258, "episode_reward_mean": -710.0411788932959, "episode_len_mean": 138.06, "episode_media": {}, "episodes_timesteps_total": 13806, "policy_reward_min": {"policy_0": -1388.2866429805258}, "policy_reward_max": {"policy_0": -16.183164936359667}, "policy_reward_mean": {"policy_0": -710.0411788932959}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1028.8113264157687, -1245.1041206761386, -577.5330773380689, -767.0669675962855, -1367.9531980060506, -724.2376012846697, -1084.763308029478, -1017.7401929054267, -16.183164936359667, -96.28557813714446, -1127.2177158129193, -1098.8426503635822, -1100.724483383953, -780.7351180509941, -146.02311072630897, -343.9081991288432, -274.07050485680844, -710.8758315548381, -565.3831828591434, -28.152900269053525, -286.52242722865276, -1114.709600570376, -1041.4644863443457, -805.4104070668294, -958.8082892622584, -398.2284667193592, -429.455033206686, -653.1967299185105, -440.0643540923933, -720.3678393014552, -594.0139700930795, -536.1266874540092, -617.8813286052626, -648.4035588862569, -637.5763924875412, -28.615663155903942, -341.0819490041863, -516.2852407202561, -1106.0352470594585, -251.4063701601989, -586.525939454292, -823.5692497456001, -491.4000662228336, -866.453894511674, -667.6634706686283, -1221.9811531624187, -398.7927501343787, -811.7526294179391, -882.6339244790842, -194.54824780050123, -765.3221773470792, -498.48660837475, -50.04279298316735, -1304.4602057983711, -1388.2866429805258, -901.8106030781032, -839.0821513728637, -584.1530576859267, -873.3143888062497, -828.9462630609205, -628.0035570339487, -839.6959688414638, -1330.0770913145695, -607.7792051850785, -337.5539175273952, -703.1190132010415, -1117.7768554409047, -1120.189504043836, -854.1241302365459, -1177.1926672831119, -1024.1294219463823, -801.9346690626887, -787.1840836616617, -1018.9733649887203, -1008.5086894180467, -606.8959760828033, -363.03255571868834, -40.629529929120906, -914.4627091956811, -1063.8950161701348, -721.9216448182156, -283.62614972171923, -1279.937802390879, -965.5772665039918, -24.274529670157783, -648.5635367789741, -765.0844101387858, -668.6518995145292, -868.7029331034057, -520.9204821387982, -842.5846235851211, -785.9487591220689, -544.1784493872545, -425.80988825007546, -778.3930841634265, -1205.925311190088, -126.51006575875996, -940.1887932684142, -442.7573042597818, -612.910538529147], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 47, 71, 150, 150, 150, 150, 96, 105, 150, 150, 150, 83, 143, 150, 150, 150, 150, 111, 150, 150, 112, 150, 150, 133, 150, 150, 150, 50, 124, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 150, 150, 77, 150, 150, 41, 150, 150, 150, 150, 150, 150, 150, 142, 117, 150, 150, 91, 150, 150, 150], "policy_policy_0_reward": [-1028.8113264157687, -1245.1041206761386, -577.5330773380689, -767.0669675962855, -1367.9531980060506, -724.2376012846697, -1084.763308029478, -1017.7401929054267, -16.183164936359667, -96.28557813714446, -1127.2177158129193, -1098.8426503635822, -1100.724483383953, -780.7351180509941, -146.02311072630897, -343.9081991288432, -274.07050485680844, -710.8758315548381, -565.3831828591434, -28.152900269053525, -286.52242722865276, -1114.709600570376, -1041.4644863443457, -805.4104070668294, -958.8082892622584, -398.2284667193592, -429.455033206686, -653.1967299185105, -440.0643540923933, -720.3678393014552, -594.0139700930795, -536.1266874540092, -617.8813286052626, -648.4035588862569, -637.5763924875412, -28.615663155903942, -341.0819490041863, -516.2852407202561, -1106.0352470594585, -251.4063701601989, -586.525939454292, -823.5692497456001, -491.4000662228336, -866.453894511674, -667.6634706686283, -1221.9811531624187, -398.7927501343787, -811.7526294179391, -882.6339244790842, -194.54824780050123, -765.3221773470792, -498.48660837475, -50.04279298316735, -1304.4602057983711, -1388.2866429805258, -901.8106030781032, -839.0821513728637, -584.1530576859267, -873.3143888062497, -828.9462630609205, -628.0035570339487, -839.6959688414638, -1330.0770913145695, -607.7792051850785, -337.5539175273952, -703.1190132010415, -1117.7768554409047, -1120.189504043836, -854.1241302365459, -1177.1926672831119, -1024.1294219463823, -801.9346690626887, -787.1840836616617, -1018.9733649887203, -1008.5086894180467, -606.8959760828033, -363.03255571868834, -40.629529929120906, -914.4627091956811, -1063.8950161701348, -721.9216448182156, -283.62614972171923, -1279.937802390879, -965.5772665039918, -24.274529670157783, -648.5635367789741, -765.0844101387858, -668.6518995145292, -868.7029331034057, -520.9204821387982, -842.5846235851211, -785.9487591220689, -544.1784493872545, -425.80988825007546, -778.3930841634265, -1205.925311190088, -126.51006575875996, -940.1887932684142, -442.7573042597818, -612.910538529147]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27825017390901763, "mean_inference_ms": 0.8793440120539386, "mean_action_processing_ms": 0.15685052982580916, "mean_env_wait_ms": 1.542181801270479, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005426645278930664, "StateBufferConnector_ms": 0.004193305969238281, "ViewRequirementAgentConnector_ms": 0.10298871994018555}, "num_episodes": 28, "episode_return_max": -16.183164936359667, "episode_return_min": -1388.2866429805258, "episode_return_mean": -710.0411788932959, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.0067561873669, "num_env_steps_trained_throughput_per_sec": 265.0067561873669, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 14803.715, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14803.638, "sample_time_ms": 2382.588, "learn_time_ms": 12404.505, "learn_throughput": 322.463, "synch_weights_time_ms": 15.707}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00005", "date": "2024-08-03_05-12-07", "timestamp": 1722642127, "time_this_iter_s": 15.101520538330078, "time_total_s": 342.55125093460083, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f0f880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 342.55125093460083, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 12.831818181818182, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 205.28102621038755, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.8688391550133625, "policy_loss": -0.010708019890686652, "vf_loss": 3.8753644697368146, "vf_explained_var": 0.9786587956671914, "kl": 0.01844962254666221, "entropy": 1.3521779490013917, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -24.274529670157783, "episode_reward_min": -1388.2866429805258, "episode_reward_mean": -700.6360156098497, "episode_len_mean": 137.46, "episode_media": {}, "episodes_timesteps_total": 13746, "policy_reward_min": {"policy_0": -1388.2866429805258}, "policy_reward_max": {"policy_0": -24.274529670157783}, "policy_reward_mean": {"policy_0": -700.6360156098497}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-594.0139700930795, -536.1266874540092, -617.8813286052626, -648.4035588862569, -637.5763924875412, -28.615663155903942, -341.0819490041863, -516.2852407202561, -1106.0352470594585, -251.4063701601989, -586.525939454292, -823.5692497456001, -491.4000662228336, -866.453894511674, -667.6634706686283, -1221.9811531624187, -398.7927501343787, -811.7526294179391, -882.6339244790842, -194.54824780050123, -765.3221773470792, -498.48660837475, -50.04279298316735, -1304.4602057983711, -1388.2866429805258, -901.8106030781032, -839.0821513728637, -584.1530576859267, -873.3143888062497, -828.9462630609205, -628.0035570339487, -839.6959688414638, -1330.0770913145695, -607.7792051850785, -337.5539175273952, -703.1190132010415, -1117.7768554409047, -1120.189504043836, -854.1241302365459, -1177.1926672831119, -1024.1294219463823, -801.9346690626887, -787.1840836616617, -1018.9733649887203, -1008.5086894180467, -606.8959760828033, -363.03255571868834, -40.629529929120906, -914.4627091956811, -1063.8950161701348, -721.9216448182156, -283.62614972171923, -1279.937802390879, -965.5772665039918, -24.274529670157783, -648.5635367789741, -765.0844101387858, -668.6518995145292, -868.7029331034057, -520.9204821387982, -842.5846235851211, -785.9487591220689, -544.1784493872545, -425.80988825007546, -778.3930841634265, -1205.925311190088, -126.51006575875996, -940.1887932684142, -442.7573042597818, -612.910538529147, -1293.2002292512832, -925.5082045681127, -538.926311054903, -675.239615098297, -664.7476482186963, -537.8630490445329, -39.973402242724504, -669.5303451127106, -635.7503968439229, -1138.1857085834324, -778.9733724913862, -972.317271430845, -458.48202775587527, -620.8310485550186, -1213.470743088962, -1094.4430665202221, -933.4415185054496, -622.9842147755901, -755.1339540374615, -51.711674498219196, -514.7404803146645, -832.2946326931967, -511.14538092661047, -1008.3920985613033, -927.6379743140845, -508.2690695098532, -676.7217373314182, -254.03586273767453, -98.39353183301202, -56.97896779862069], "episode_lengths": [150, 133, 150, 150, 150, 50, 124, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 113, 144, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 48, 150, 150, 150, 77, 150, 150, 41, 150, 150, 150, 150, 150, 150, 150, 142, 117, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 115, 150, 150, 150, 150, 113, 150, 82, 62, 47], "policy_policy_0_reward": [-594.0139700930795, -536.1266874540092, -617.8813286052626, -648.4035588862569, -637.5763924875412, -28.615663155903942, -341.0819490041863, -516.2852407202561, -1106.0352470594585, -251.4063701601989, -586.525939454292, -823.5692497456001, -491.4000662228336, -866.453894511674, -667.6634706686283, -1221.9811531624187, -398.7927501343787, -811.7526294179391, -882.6339244790842, -194.54824780050123, -765.3221773470792, -498.48660837475, -50.04279298316735, -1304.4602057983711, -1388.2866429805258, -901.8106030781032, -839.0821513728637, -584.1530576859267, -873.3143888062497, -828.9462630609205, -628.0035570339487, -839.6959688414638, -1330.0770913145695, -607.7792051850785, -337.5539175273952, -703.1190132010415, -1117.7768554409047, -1120.189504043836, -854.1241302365459, -1177.1926672831119, -1024.1294219463823, -801.9346690626887, -787.1840836616617, -1018.9733649887203, -1008.5086894180467, -606.8959760828033, -363.03255571868834, -40.629529929120906, -914.4627091956811, -1063.8950161701348, -721.9216448182156, -283.62614972171923, -1279.937802390879, -965.5772665039918, -24.274529670157783, -648.5635367789741, -765.0844101387858, -668.6518995145292, -868.7029331034057, -520.9204821387982, -842.5846235851211, -785.9487591220689, -544.1784493872545, -425.80988825007546, -778.3930841634265, -1205.925311190088, -126.51006575875996, -940.1887932684142, -442.7573042597818, -612.910538529147, -1293.2002292512832, -925.5082045681127, -538.926311054903, -675.239615098297, -664.7476482186963, -537.8630490445329, -39.973402242724504, -669.5303451127106, -635.7503968439229, -1138.1857085834324, -778.9733724913862, -972.317271430845, -458.48202775587527, -620.8310485550186, -1213.470743088962, -1094.4430665202221, -933.4415185054496, -622.9842147755901, -755.1339540374615, -51.711674498219196, -514.7404803146645, -832.2946326931967, -511.14538092661047, -1008.3920985613033, -927.6379743140845, -508.2690695098532, -676.7217373314182, -254.03586273767453, -98.39353183301202, -56.97896779862069]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27852230348028345, "mean_inference_ms": 0.8797284154617941, "mean_action_processing_ms": 0.1569958078648661, "mean_env_wait_ms": 1.5443990673657806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005314826965332031, "StateBufferConnector_ms": 0.0041277408599853516, "ViewRequirementAgentConnector_ms": 0.10098147392272949}, "num_episodes": 30, "episode_return_max": -24.274529670157783, "episode_return_min": -1388.2866429805258, "episode_return_mean": -700.6360156098497, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.62503301767293, "num_env_steps_trained_throughput_per_sec": 269.62503301767293, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 14791.88, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14791.799, "sample_time_ms": 2385.878, "learn_time_ms": 12389.56, "learn_throughput": 322.852, "synch_weights_time_ms": 15.516}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00005", "date": "2024-08-03_05-12-22", "timestamp": 1722642142, "time_this_iter_s": 14.843714475631714, "time_total_s": 357.39496541023254, "pid": 486407, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b1357ae60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 357.39496541023254, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 12.87142857142857, "ram_util_percent": 19.199999999999996}}
