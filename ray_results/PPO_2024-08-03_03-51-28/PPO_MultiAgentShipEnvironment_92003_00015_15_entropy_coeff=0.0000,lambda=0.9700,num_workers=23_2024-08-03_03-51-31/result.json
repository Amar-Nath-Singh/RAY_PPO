{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9528367012428741, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.707145690917969, "policy_loss": -0.006675432877091225, "vf_loss": 9.712250866492589, "vf_explained_var": 0.017144101050992806, "kl": 0.007922294015778182, "entropy": 1.4195817064493894, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -85.44894238092512, "episode_reward_min": -1134.3863543771718, "episode_reward_mean": -703.634208900358, "episode_len_mean": 133.75, "episode_media": {}, "episodes_timesteps_total": 3210, "policy_reward_min": {"policy_0": -1134.3863543771718}, "policy_reward_max": {"policy_0": -85.44894238092512}, "policy_reward_mean": {"policy_0": -703.634208900358}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1056.5406642394175, -87.72376105327443, -216.87108733926726, -753.3049113501555, -253.19525833575577, -95.50300247634243, -757.8712023930858, -946.2214724756659, -274.7594820802283, -1134.3863543771718, -1034.273257766224, -816.8814675185928, -1044.7528302295361, -971.4247600259154, -603.6822735752104, -926.9205689529596, -696.5929906299714, -858.4116236644662, -707.5398933674228, -1065.459523500252, -664.7484058555832, -1049.1431871530658, -85.44894238092512, -785.564092868102], "episode_lengths": [150, 70, 150, 150, 77, 61, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150], "policy_policy_0_reward": [-1056.5406642394175, -87.72376105327443, -216.87108733926726, -753.3049113501555, -253.19525833575577, -95.50300247634243, -757.8712023930858, -946.2214724756659, -274.7594820802283, -1134.3863543771718, -1034.273257766224, -816.8814675185928, -1044.7528302295361, -971.4247600259154, -603.6822735752104, -926.9205689529596, -696.5929906299714, -858.4116236644662, -707.5398933674228, -1065.459523500252, -664.7484058555832, -1049.1431871530658, -85.44894238092512, -785.564092868102]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.581412396929469, "mean_inference_ms": 1.6835779551932506, "mean_action_processing_ms": 0.2867144274463664, "mean_env_wait_ms": 2.994195079307577, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01191397507985433, "StateBufferConnector_ms": 0.008318821589152018, "ViewRequirementAgentConnector_ms": 0.18318394819895426}, "num_episodes": 24, "episode_return_max": -85.44894238092512, "episode_return_min": -1134.3863543771718, "episode_return_mean": -703.634208900358, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.39331407170835, "num_env_steps_trained_throughput_per_sec": 307.39331407170835, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13012.656, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13012.589, "sample_time_ms": 1069.941, "learn_time_ms": 11878.195, "learn_throughput": 336.751, "synch_weights_time_ms": 63.742}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00015", "date": "2024-08-03_04-55-39", "timestamp": 1722641139, "time_this_iter_s": 13.024937391281128, "time_total_s": 13.024937391281128, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30f42170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.024937391281128, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.69473684210526, "ram_util_percent": 27.789473684210527}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9790635157376528, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.755034507314365, "policy_loss": -0.010690334311705858, "vf_loss": 9.76295489370823, "vf_explained_var": 0.01384026116381089, "kl": 0.013920520836721077, "entropy": 1.4138841073960067, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -6.187150234304629, "episode_reward_min": -1134.3863543771718, "episode_reward_mean": -693.1573903632406, "episode_len_mean": 136.16, "episode_media": {}, "episodes_timesteps_total": 6808, "policy_reward_min": {"policy_0": -1134.3863543771718}, "policy_reward_max": {"policy_0": -6.187150234304629}, "policy_reward_mean": {"policy_0": -693.1573903632406}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1056.5406642394175, -87.72376105327443, -216.87108733926726, -753.3049113501555, -253.19525833575577, -95.50300247634243, -757.8712023930858, -946.2214724756659, -274.7594820802283, -1134.3863543771718, -1034.273257766224, -816.8814675185928, -1044.7528302295361, -971.4247600259154, -603.6822735752104, -926.9205689529596, -696.5929906299714, -858.4116236644662, -707.5398933674228, -1065.459523500252, -664.7484058555832, -1049.1431871530658, -85.44894238092512, -785.564092868102, -597.4375062947324, -267.83237664459057, -872.6289520938755, -917.1087475414256, -948.8413462286788, -156.05643493853944, -855.5288672208284, -645.6134613519574, -6.187150234304629, -412.83209290724557, -662.0878589282953, -1110.676480690459, -1019.9567502742512, -588.7460824852114, -925.6588574598627, -507.0738410101848, -867.1671824005502, -446.7722735135875, -822.4396504713219, -305.50492056951776, -829.7262242501223, -861.3128704969433, -802.2078219262767, -1012.1054140969678, -752.1078202808679, -577.0375202428336], "episode_lengths": [150, 70, 150, 150, 77, 61, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 113, 150, 150, 150, 58, 150, 150, 40, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1056.5406642394175, -87.72376105327443, -216.87108733926726, -753.3049113501555, -253.19525833575577, -95.50300247634243, -757.8712023930858, -946.2214724756659, -274.7594820802283, -1134.3863543771718, -1034.273257766224, -816.8814675185928, -1044.7528302295361, -971.4247600259154, -603.6822735752104, -926.9205689529596, -696.5929906299714, -858.4116236644662, -707.5398933674228, -1065.459523500252, -664.7484058555832, -1049.1431871530658, -85.44894238092512, -785.564092868102, -597.4375062947324, -267.83237664459057, -872.6289520938755, -917.1087475414256, -948.8413462286788, -156.05643493853944, -855.5288672208284, -645.6134613519574, -6.187150234304629, -412.83209290724557, -662.0878589282953, -1110.676480690459, -1019.9567502742512, -588.7460824852114, -925.6588574598627, -507.0738410101848, -867.1671824005502, -446.7722735135875, -822.4396504713219, -305.50492056951776, -829.7262242501223, -861.3128704969433, -802.2078219262767, -1012.1054140969678, -752.1078202808679, -577.0375202428336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5740484818396725, "mean_inference_ms": 1.6764726944296156, "mean_action_processing_ms": 0.2842153305278516, "mean_env_wait_ms": 2.9837708495039363, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01421356201171875, "StateBufferConnector_ms": 0.008229732513427734, "ViewRequirementAgentConnector_ms": 0.18138504028320312}, "num_episodes": 26, "episode_return_max": -6.187150234304629, "episode_return_min": -1134.3863543771718, "episode_return_mean": -693.1573903632406, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.8534614370382, "num_env_steps_trained_throughput_per_sec": 307.8534614370382, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13002.931, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13002.866, "sample_time_ms": 1037.441, "learn_time_ms": 11897.256, "learn_throughput": 336.212, "synch_weights_time_ms": 67.436}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00015", "date": "2024-08-03_04-55-52", "timestamp": 1722641152, "time_this_iter_s": 13.005477905273438, "time_total_s": 26.030415296554565, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814fa30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.030415296554565, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.442105263157895, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3578607553616164, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.490857565402985, "policy_loss": -0.00677421084449937, "vf_loss": 9.49536036948363, "vf_explained_var": 0.010409665728608767, "kl": 0.011428209033329039, "entropy": 1.4284444745630025, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -6.187150234304629, "episode_reward_min": -1276.974429099296, "episode_reward_mean": -718.2025929531959, "episode_len_mean": 137.6315789473684, "episode_media": {}, "episodes_timesteps_total": 10460, "policy_reward_min": {"policy_0": -1276.974429099296}, "policy_reward_max": {"policy_0": -6.187150234304629}, "policy_reward_mean": {"policy_0": -718.2025929531959}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1056.5406642394175, -87.72376105327443, -216.87108733926726, -753.3049113501555, -253.19525833575577, -95.50300247634243, -757.8712023930858, -946.2214724756659, -274.7594820802283, -1134.3863543771718, -1034.273257766224, -816.8814675185928, -1044.7528302295361, -971.4247600259154, -603.6822735752104, -926.9205689529596, -696.5929906299714, -858.4116236644662, -707.5398933674228, -1065.459523500252, -664.7484058555832, -1049.1431871530658, -85.44894238092512, -785.564092868102, -597.4375062947324, -267.83237664459057, -872.6289520938755, -917.1087475414256, -948.8413462286788, -156.05643493853944, -855.5288672208284, -645.6134613519574, -6.187150234304629, -412.83209290724557, -662.0878589282953, -1110.676480690459, -1019.9567502742512, -588.7460824852114, -925.6588574598627, -507.0738410101848, -867.1671824005502, -446.7722735135875, -822.4396504713219, -305.50492056951776, -829.7262242501223, -861.3128704969433, -802.2078219262767, -1012.1054140969678, -752.1078202808679, -577.0375202428336, -699.2054781733059, -1266.0121051613169, -1191.9876061498728, -962.6325192425159, -101.4733303553319, -201.03629835939967, -592.049047338264, -141.2226925965364, -942.2506798206757, -1276.974429099296, -929.422557938796, -1129.570190782218, -983.0665992895927, -901.6385318178218, -659.2125706015817, -842.5045856492678, -816.961838400382, -1058.0983797346073, -955.4625896380278, -563.5314729902416, -816.7762814719918, -655.8065746861362, -833.6852003877979, -369.7066544547787, -576.7627847930829, -458.47654734802234], "episode_lengths": [150, 70, 150, 150, 77, 61, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 113, 150, 150, 150, 58, 150, 150, 40, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 69, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1056.5406642394175, -87.72376105327443, -216.87108733926726, -753.3049113501555, -253.19525833575577, -95.50300247634243, -757.8712023930858, -946.2214724756659, -274.7594820802283, -1134.3863543771718, -1034.273257766224, -816.8814675185928, -1044.7528302295361, -971.4247600259154, -603.6822735752104, -926.9205689529596, -696.5929906299714, -858.4116236644662, -707.5398933674228, -1065.459523500252, -664.7484058555832, -1049.1431871530658, -85.44894238092512, -785.564092868102, -597.4375062947324, -267.83237664459057, -872.6289520938755, -917.1087475414256, -948.8413462286788, -156.05643493853944, -855.5288672208284, -645.6134613519574, -6.187150234304629, -412.83209290724557, -662.0878589282953, -1110.676480690459, -1019.9567502742512, -588.7460824852114, -925.6588574598627, -507.0738410101848, -867.1671824005502, -446.7722735135875, -822.4396504713219, -305.50492056951776, -829.7262242501223, -861.3128704969433, -802.2078219262767, -1012.1054140969678, -752.1078202808679, -577.0375202428336, -699.2054781733059, -1266.0121051613169, -1191.9876061498728, -962.6325192425159, -101.4733303553319, -201.03629835939967, -592.049047338264, -141.2226925965364, -942.2506798206757, -1276.974429099296, -929.422557938796, -1129.570190782218, -983.0665992895927, -901.6385318178218, -659.2125706015817, -842.5045856492678, -816.961838400382, -1058.0983797346073, -955.4625896380278, -563.5314729902416, -816.7762814719918, -655.8065746861362, -833.6852003877979, -369.7066544547787, -576.7627847930829, -458.47654734802234]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5723572779688835, "mean_inference_ms": 1.680879097626706, "mean_action_processing_ms": 0.2855418551869726, "mean_env_wait_ms": 2.99310813066804, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013634719346698961, "StateBufferConnector_ms": 0.008420567763479133, "ViewRequirementAgentConnector_ms": 0.1861816958377236}, "num_episodes": 26, "episode_return_max": -6.187150234304629, "episode_return_min": -1276.974429099296, "episode_return_mean": -718.2025929531959, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.30752686051324, "num_env_steps_trained_throughput_per_sec": 348.30752686051324, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12496.66, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12496.594, "sample_time_ms": 1047.337, "learn_time_ms": 11382.316, "learn_throughput": 351.422, "synch_weights_time_ms": 66.21}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00015", "date": "2024-08-03_04-56-03", "timestamp": 1722641163, "time_this_iter_s": 11.495031118392944, "time_total_s": 37.52544641494751, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f5cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 37.52544641494751, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.5375, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.9851418783888222, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.165203533569972, "policy_loss": -0.011678672482958063, "vf_loss": 9.17399982213974, "vf_explained_var": 0.1075123485798637, "kl": 0.014484473173160952, "entropy": 1.4492733312149844, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -6.187150234304629, "episode_reward_min": -1276.974429099296, "episode_reward_mean": -715.4331015836459, "episode_len_mean": 137.56, "episode_media": {}, "episodes_timesteps_total": 13756, "policy_reward_min": {"policy_0": -1276.974429099296}, "policy_reward_max": {"policy_0": -6.187150234304629}, "policy_reward_mean": {"policy_0": -715.4331015836459}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-95.50300247634243, -757.8712023930858, -946.2214724756659, -274.7594820802283, -1134.3863543771718, -1034.273257766224, -816.8814675185928, -1044.7528302295361, -971.4247600259154, -603.6822735752104, -926.9205689529596, -696.5929906299714, -858.4116236644662, -707.5398933674228, -1065.459523500252, -664.7484058555832, -1049.1431871530658, -85.44894238092512, -785.564092868102, -597.4375062947324, -267.83237664459057, -872.6289520938755, -917.1087475414256, -948.8413462286788, -156.05643493853944, -855.5288672208284, -645.6134613519574, -6.187150234304629, -412.83209290724557, -662.0878589282953, -1110.676480690459, -1019.9567502742512, -588.7460824852114, -925.6588574598627, -507.0738410101848, -867.1671824005502, -446.7722735135875, -822.4396504713219, -305.50492056951776, -829.7262242501223, -861.3128704969433, -802.2078219262767, -1012.1054140969678, -752.1078202808679, -577.0375202428336, -699.2054781733059, -1266.0121051613169, -1191.9876061498728, -962.6325192425159, -101.4733303553319, -201.03629835939967, -592.049047338264, -141.2226925965364, -942.2506798206757, -1276.974429099296, -929.422557938796, -1129.570190782218, -983.0665992895927, -901.6385318178218, -659.2125706015817, -842.5045856492678, -816.961838400382, -1058.0983797346073, -955.4625896380278, -563.5314729902416, -816.7762814719918, -655.8065746861362, -833.6852003877979, -369.7066544547787, -576.7627847930829, -458.47654734802234, -1004.1380493379219, -359.13696285919104, -838.3677058184093, -535.4221183087354, -942.6738769833233, -1024.073642415613, -847.3850595116853, -869.8961606410234, -447.4275335823907, -183.90042478186308, -930.4679983354304, -1091.8556698243865, -954.4217646561485, -445.80723227773154, -609.028650476, -793.5093684394191, -243.14888875555815, -426.52514132744824, -988.4865804252715, -316.22260045644583, -141.56347087207962, -533.6396936765285, -99.001852400622, -879.892907474244, -456.01252799605277, -241.42750418917012, -1198.9375366491913, -1026.0917434916482, -899.0861102760539], "episode_lengths": [61, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 113, 150, 150, 150, 58, 150, 150, 40, 142, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 69, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 142, 150, 90, 150, 150, 92, 92, 150, 80, 150, 127, 85, 150, 150, 150], "policy_policy_0_reward": [-95.50300247634243, -757.8712023930858, -946.2214724756659, -274.7594820802283, -1134.3863543771718, -1034.273257766224, -816.8814675185928, -1044.7528302295361, -971.4247600259154, -603.6822735752104, -926.9205689529596, -696.5929906299714, -858.4116236644662, -707.5398933674228, -1065.459523500252, -664.7484058555832, -1049.1431871530658, -85.44894238092512, -785.564092868102, -597.4375062947324, -267.83237664459057, -872.6289520938755, -917.1087475414256, -948.8413462286788, -156.05643493853944, -855.5288672208284, -645.6134613519574, -6.187150234304629, -412.83209290724557, -662.0878589282953, -1110.676480690459, -1019.9567502742512, -588.7460824852114, -925.6588574598627, -507.0738410101848, -867.1671824005502, -446.7722735135875, -822.4396504713219, -305.50492056951776, -829.7262242501223, -861.3128704969433, -802.2078219262767, -1012.1054140969678, -752.1078202808679, -577.0375202428336, -699.2054781733059, -1266.0121051613169, -1191.9876061498728, -962.6325192425159, -101.4733303553319, -201.03629835939967, -592.049047338264, -141.2226925965364, -942.2506798206757, -1276.974429099296, -929.422557938796, -1129.570190782218, -983.0665992895927, -901.6385318178218, -659.2125706015817, -842.5045856492678, -816.961838400382, -1058.0983797346073, -955.4625896380278, -563.5314729902416, -816.7762814719918, -655.8065746861362, -833.6852003877979, -369.7066544547787, -576.7627847930829, -458.47654734802234, -1004.1380493379219, -359.13696285919104, -838.3677058184093, -535.4221183087354, -942.6738769833233, -1024.073642415613, -847.3850595116853, -869.8961606410234, -447.4275335823907, -183.90042478186308, -930.4679983354304, -1091.8556698243865, -954.4217646561485, -445.80723227773154, -609.028650476, -793.5093684394191, -243.14888875555815, -426.52514132744824, -988.4865804252715, -316.22260045644583, -141.56347087207962, -533.6396936765285, -99.001852400622, -879.892907474244, -456.01252799605277, -241.42750418917012, -1198.9375366491913, -1026.0917434916482, -899.0861102760539]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5694108422106813, "mean_inference_ms": 1.6886600818415867, "mean_action_processing_ms": 0.28642239982474516, "mean_env_wait_ms": 3.0005206865355554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014492511749267578, "StateBufferConnector_ms": 0.00846242904663086, "ViewRequirementAgentConnector_ms": 0.18792438507080078}, "num_episodes": 29, "episode_return_max": -6.187150234304629, "episode_return_min": -1276.974429099296, "episode_return_mean": -715.4331015836459, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.33557820868134, "num_env_steps_trained_throughput_per_sec": 345.33557820868134, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12268.232, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12268.165, "sample_time_ms": 1065.665, "learn_time_ms": 11138.364, "learn_throughput": 359.119, "synch_weights_time_ms": 63.406}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00015", "date": "2024-08-03_04-56-15", "timestamp": 1722641175, "time_this_iter_s": 11.596121311187744, "time_total_s": 49.121567726135254, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30f41f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 49.121567726135254, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.59375, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.052742556358377, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.299616927901903, "policy_loss": -0.009683612321290032, "vf_loss": 9.306552204489709, "vf_explained_var": 0.07279112289349238, "kl": 0.013814548206543506, "entropy": 1.4570861705889304, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -34.68861518359595, "episode_reward_min": -1344.6604765101758, "episode_reward_mean": -733.6359582081567, "episode_len_mean": 137.6, "episode_media": {}, "episodes_timesteps_total": 13760, "policy_reward_min": {"policy_0": -1344.6604765101758}, "policy_reward_max": {"policy_0": -34.68861518359595}, "policy_reward_mean": {"policy_0": -733.6359582081567}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1110.676480690459, -1019.9567502742512, -588.7460824852114, -925.6588574598627, -507.0738410101848, -867.1671824005502, -446.7722735135875, -822.4396504713219, -305.50492056951776, -829.7262242501223, -861.3128704969433, -802.2078219262767, -1012.1054140969678, -752.1078202808679, -577.0375202428336, -699.2054781733059, -1266.0121051613169, -1191.9876061498728, -962.6325192425159, -101.4733303553319, -201.03629835939967, -592.049047338264, -141.2226925965364, -942.2506798206757, -1276.974429099296, -929.422557938796, -1129.570190782218, -983.0665992895927, -901.6385318178218, -659.2125706015817, -842.5045856492678, -816.961838400382, -1058.0983797346073, -955.4625896380278, -563.5314729902416, -816.7762814719918, -655.8065746861362, -833.6852003877979, -369.7066544547787, -576.7627847930829, -458.47654734802234, -1004.1380493379219, -359.13696285919104, -838.3677058184093, -535.4221183087354, -942.6738769833233, -1024.073642415613, -847.3850595116853, -869.8961606410234, -447.4275335823907, -183.90042478186308, -930.4679983354304, -1091.8556698243865, -954.4217646561485, -445.80723227773154, -609.028650476, -793.5093684394191, -243.14888875555815, -426.52514132744824, -988.4865804252715, -316.22260045644583, -141.56347087207962, -533.6396936765285, -99.001852400622, -879.892907474244, -456.01252799605277, -241.42750418917012, -1198.9375366491913, -1026.0917434916482, -899.0861102760539, -458.3766356506265, -1018.5765216502566, -309.10721781848207, -643.0479442419385, -1243.6402447631474, -917.4440691395324, -67.2176858756644, -813.022625171693, -841.5004152370983, -1074.0151286560726, -34.68861518359595, -537.7815133630695, -171.15749476231906, -406.03433847541146, -1053.1201975319595, -624.1611329181668, -1115.5416481360755, -121.69702789639288, -994.6133240247252, -289.7035616455605, -674.5704607384664, -923.3923363646093, -1293.8894060601858, -1107.199758784547, -1344.6604765101758, -769.7135828855739, -1176.6894639324767, -1289.054713995133, -1261.3117166763384, -107.09653003696233], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 69, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 142, 150, 90, 150, 150, 92, 92, 150, 80, 150, 127, 85, 150, 150, 150, 150, 150, 112, 150, 150, 150, 76, 150, 150, 150, 64, 130, 107, 150, 150, 150, 150, 60, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68], "policy_policy_0_reward": [-1110.676480690459, -1019.9567502742512, -588.7460824852114, -925.6588574598627, -507.0738410101848, -867.1671824005502, -446.7722735135875, -822.4396504713219, -305.50492056951776, -829.7262242501223, -861.3128704969433, -802.2078219262767, -1012.1054140969678, -752.1078202808679, -577.0375202428336, -699.2054781733059, -1266.0121051613169, -1191.9876061498728, -962.6325192425159, -101.4733303553319, -201.03629835939967, -592.049047338264, -141.2226925965364, -942.2506798206757, -1276.974429099296, -929.422557938796, -1129.570190782218, -983.0665992895927, -901.6385318178218, -659.2125706015817, -842.5045856492678, -816.961838400382, -1058.0983797346073, -955.4625896380278, -563.5314729902416, -816.7762814719918, -655.8065746861362, -833.6852003877979, -369.7066544547787, -576.7627847930829, -458.47654734802234, -1004.1380493379219, -359.13696285919104, -838.3677058184093, -535.4221183087354, -942.6738769833233, -1024.073642415613, -847.3850595116853, -869.8961606410234, -447.4275335823907, -183.90042478186308, -930.4679983354304, -1091.8556698243865, -954.4217646561485, -445.80723227773154, -609.028650476, -793.5093684394191, -243.14888875555815, -426.52514132744824, -988.4865804252715, -316.22260045644583, -141.56347087207962, -533.6396936765285, -99.001852400622, -879.892907474244, -456.01252799605277, -241.42750418917012, -1198.9375366491913, -1026.0917434916482, -899.0861102760539, -458.3766356506265, -1018.5765216502566, -309.10721781848207, -643.0479442419385, -1243.6402447631474, -917.4440691395324, -67.2176858756644, -813.022625171693, -841.5004152370983, -1074.0151286560726, -34.68861518359595, -537.7815133630695, -171.15749476231906, -406.03433847541146, -1053.1201975319595, -624.1611329181668, -1115.5416481360755, -121.69702789639288, -994.6133240247252, -289.7035616455605, -674.5704607384664, -923.3923363646093, -1293.8894060601858, -1107.199758784547, -1344.6604765101758, -769.7135828855739, -1176.6894639324767, -1289.054713995133, -1261.3117166763384, -107.09653003696233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5646059702959644, "mean_inference_ms": 1.6942387009236421, "mean_action_processing_ms": 0.2871347072339979, "mean_env_wait_ms": 3.0096954065120123, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014534473419189453, "StateBufferConnector_ms": 0.008701086044311523, "ViewRequirementAgentConnector_ms": 0.1927931308746338}, "num_episodes": 30, "episode_return_max": -34.68861518359595, "episode_return_min": -1344.6604765101758, "episode_return_mean": -733.6359582081567, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.21492715667085, "num_env_steps_trained_throughput_per_sec": 313.21492715667085, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12368.744, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12368.677, "sample_time_ms": 1070.28, "learn_time_ms": 11235.473, "learn_throughput": 356.015, "synch_weights_time_ms": 62.185}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00015", "date": "2024-08-03_04-56-28", "timestamp": 1722641188, "time_this_iter_s": 12.783318281173706, "time_total_s": 61.90488600730896, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa15a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 61.90488600730896, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.426315789473684, "ram_util_percent": 27.87894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.45916340003411, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.075486948589484, "policy_loss": -0.003412518861781185, "vf_loss": 9.076282228032747, "vf_explained_var": 0.20643848720937968, "kl": 0.013158555317962358, "entropy": 1.448641316841046, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -34.68861518359595, "episode_reward_min": -1344.6604765101758, "episode_reward_mean": -722.752374301677, "episode_len_mean": 137.92, "episode_media": {}, "episodes_timesteps_total": 13792, "policy_reward_min": {"policy_0": -1344.6604765101758}, "policy_reward_max": {"policy_0": -34.68861518359595}, "policy_reward_mean": {"policy_0": -722.752374301677}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-983.0665992895927, -901.6385318178218, -659.2125706015817, -842.5045856492678, -816.961838400382, -1058.0983797346073, -955.4625896380278, -563.5314729902416, -816.7762814719918, -655.8065746861362, -833.6852003877979, -369.7066544547787, -576.7627847930829, -458.47654734802234, -1004.1380493379219, -359.13696285919104, -838.3677058184093, -535.4221183087354, -942.6738769833233, -1024.073642415613, -847.3850595116853, -869.8961606410234, -447.4275335823907, -183.90042478186308, -930.4679983354304, -1091.8556698243865, -954.4217646561485, -445.80723227773154, -609.028650476, -793.5093684394191, -243.14888875555815, -426.52514132744824, -988.4865804252715, -316.22260045644583, -141.56347087207962, -533.6396936765285, -99.001852400622, -879.892907474244, -456.01252799605277, -241.42750418917012, -1198.9375366491913, -1026.0917434916482, -899.0861102760539, -458.3766356506265, -1018.5765216502566, -309.10721781848207, -643.0479442419385, -1243.6402447631474, -917.4440691395324, -67.2176858756644, -813.022625171693, -841.5004152370983, -1074.0151286560726, -34.68861518359595, -537.7815133630695, -171.15749476231906, -406.03433847541146, -1053.1201975319595, -624.1611329181668, -1115.5416481360755, -121.69702789639288, -994.6133240247252, -289.7035616455605, -674.5704607384664, -923.3923363646093, -1293.8894060601858, -1107.199758784547, -1344.6604765101758, -769.7135828855739, -1176.6894639324767, -1289.054713995133, -1261.3117166763384, -107.09653003696233, -1127.5098262976735, -749.6756145065448, -1136.0627198915045, -690.8837966199845, -848.6715101155376, -633.163843404835, -404.97292351308295, -135.65304975289672, -859.5021238942594, -959.5935776388458, -483.10519191198034, -1053.0710671982927, -305.40269602356796, -591.4329016852604, -895.70013790434, -534.274924108149, -867.0218668527734, -1032.662230659425, -988.3340972470799, -1035.3993281184532, -526.6199760408866, -54.13966079145734, -710.8776043588547, -305.08205642309895, -868.4842208016212, -1010.7965218858228, -965.8787868922913], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 142, 150, 90, 150, 150, 92, 92, 150, 80, 150, 127, 85, 150, 150, 150, 150, 150, 112, 150, 150, 150, 76, 150, 150, 150, 64, 130, 107, 150, 150, 150, 150, 60, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 100, 83, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 147, 64, 150, 87, 150, 150, 150], "policy_policy_0_reward": [-983.0665992895927, -901.6385318178218, -659.2125706015817, -842.5045856492678, -816.961838400382, -1058.0983797346073, -955.4625896380278, -563.5314729902416, -816.7762814719918, -655.8065746861362, -833.6852003877979, -369.7066544547787, -576.7627847930829, -458.47654734802234, -1004.1380493379219, -359.13696285919104, -838.3677058184093, -535.4221183087354, -942.6738769833233, -1024.073642415613, -847.3850595116853, -869.8961606410234, -447.4275335823907, -183.90042478186308, -930.4679983354304, -1091.8556698243865, -954.4217646561485, -445.80723227773154, -609.028650476, -793.5093684394191, -243.14888875555815, -426.52514132744824, -988.4865804252715, -316.22260045644583, -141.56347087207962, -533.6396936765285, -99.001852400622, -879.892907474244, -456.01252799605277, -241.42750418917012, -1198.9375366491913, -1026.0917434916482, -899.0861102760539, -458.3766356506265, -1018.5765216502566, -309.10721781848207, -643.0479442419385, -1243.6402447631474, -917.4440691395324, -67.2176858756644, -813.022625171693, -841.5004152370983, -1074.0151286560726, -34.68861518359595, -537.7815133630695, -171.15749476231906, -406.03433847541146, -1053.1201975319595, -624.1611329181668, -1115.5416481360755, -121.69702789639288, -994.6133240247252, -289.7035616455605, -674.5704607384664, -923.3923363646093, -1293.8894060601858, -1107.199758784547, -1344.6604765101758, -769.7135828855739, -1176.6894639324767, -1289.054713995133, -1261.3117166763384, -107.09653003696233, -1127.5098262976735, -749.6756145065448, -1136.0627198915045, -690.8837966199845, -848.6715101155376, -633.163843404835, -404.97292351308295, -135.65304975289672, -859.5021238942594, -959.5935776388458, -483.10519191198034, -1053.0710671982927, -305.40269602356796, -591.4329016852604, -895.70013790434, -534.274924108149, -867.0218668527734, -1032.662230659425, -988.3340972470799, -1035.3993281184532, -526.6199760408866, -54.13966079145734, -710.8776043588547, -305.08205642309895, -868.4842208016212, -1010.7965218858228, -965.8787868922913]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5632056082588389, "mean_inference_ms": 1.6995726421840152, "mean_action_processing_ms": 0.2875995205890359, "mean_env_wait_ms": 3.0148981046034953, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014007091522216797, "StateBufferConnector_ms": 0.008754491806030273, "ViewRequirementAgentConnector_ms": 0.1936798095703125}, "num_episodes": 27, "episode_return_max": -34.68861518359595, "episode_return_min": -1344.6604765101758, "episode_return_mean": -722.752374301677, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.3274823171586, "num_env_steps_trained_throughput_per_sec": 308.3274823171586, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12469.492, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12469.424, "sample_time_ms": 1065.219, "learn_time_ms": 11341.449, "learn_throughput": 352.689, "synch_weights_time_ms": 62.02}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00015", "date": "2024-08-03_04-56-41", "timestamp": 1722641201, "time_this_iter_s": 12.986057043075562, "time_total_s": 74.89094305038452, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f5cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 74.89094305038452, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.605555555555554, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.893377689023812, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.724865461389223, "policy_loss": -0.01490547397309759, "vf_loss": 8.736352750162284, "vf_explained_var": 0.3388343023136258, "kl": 0.01715963319192421, "entropy": 1.3762589269628127, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -34.68861518359595, "episode_reward_min": -1344.6604765101758, "episode_reward_mean": -709.4127026786493, "episode_len_mean": 136.23, "episode_media": {}, "episodes_timesteps_total": 13623, "policy_reward_min": {"policy_0": -1344.6604765101758}, "policy_reward_max": {"policy_0": -34.68861518359595}, "policy_reward_mean": {"policy_0": -709.4127026786493}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-426.52514132744824, -988.4865804252715, -316.22260045644583, -141.56347087207962, -533.6396936765285, -99.001852400622, -879.892907474244, -456.01252799605277, -241.42750418917012, -1198.9375366491913, -1026.0917434916482, -899.0861102760539, -458.3766356506265, -1018.5765216502566, -309.10721781848207, -643.0479442419385, -1243.6402447631474, -917.4440691395324, -67.2176858756644, -813.022625171693, -841.5004152370983, -1074.0151286560726, -34.68861518359595, -537.7815133630695, -171.15749476231906, -406.03433847541146, -1053.1201975319595, -624.1611329181668, -1115.5416481360755, -121.69702789639288, -994.6133240247252, -289.7035616455605, -674.5704607384664, -923.3923363646093, -1293.8894060601858, -1107.199758784547, -1344.6604765101758, -769.7135828855739, -1176.6894639324767, -1289.054713995133, -1261.3117166763384, -107.09653003696233, -1127.5098262976735, -749.6756145065448, -1136.0627198915045, -690.8837966199845, -848.6715101155376, -633.163843404835, -404.97292351308295, -135.65304975289672, -859.5021238942594, -959.5935776388458, -483.10519191198034, -1053.0710671982927, -305.40269602356796, -591.4329016852604, -895.70013790434, -534.274924108149, -867.0218668527734, -1032.662230659425, -988.3340972470799, -1035.3993281184532, -526.6199760408866, -54.13966079145734, -710.8776043588547, -305.08205642309895, -868.4842208016212, -1010.7965218858228, -965.8787868922913, -980.7562046921277, -744.6008924989688, -610.1032656488014, -764.8679605130137, -787.0809817975392, -499.7548411925286, -909.2801148199972, -1301.6566589424604, -912.3802136916674, -633.6808048640494, -476.8056559762187, -153.08315888062205, -830.2193705664528, -104.59550703176221, -1091.4713846588186, -792.5497073886021, -808.7002388535933, -1133.881053516724, -932.742617473653, -194.94917253524102, -198.58051229890927, -561.1831735635712, -1012.9994905425862, -147.5074310436952, -499.1426427400914, -669.7675026509289, -716.7123154945322, -1005.3977235385124, -1014.0251729542396, -192.53160914361115, -597.3771764518839], "episode_lengths": [150, 150, 92, 92, 150, 80, 150, 127, 85, 150, 150, 150, 150, 150, 112, 150, 150, 150, 76, 150, 150, 150, 64, 130, 107, 150, 150, 150, 150, 60, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 100, 83, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 147, 64, 150, 87, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 84, 150, 150, 150, 150, 150, 84, 94, 150, 150, 69, 150, 150, 150, 150, 150, 127, 150], "policy_policy_0_reward": [-426.52514132744824, -988.4865804252715, -316.22260045644583, -141.56347087207962, -533.6396936765285, -99.001852400622, -879.892907474244, -456.01252799605277, -241.42750418917012, -1198.9375366491913, -1026.0917434916482, -899.0861102760539, -458.3766356506265, -1018.5765216502566, -309.10721781848207, -643.0479442419385, -1243.6402447631474, -917.4440691395324, -67.2176858756644, -813.022625171693, -841.5004152370983, -1074.0151286560726, -34.68861518359595, -537.7815133630695, -171.15749476231906, -406.03433847541146, -1053.1201975319595, -624.1611329181668, -1115.5416481360755, -121.69702789639288, -994.6133240247252, -289.7035616455605, -674.5704607384664, -923.3923363646093, -1293.8894060601858, -1107.199758784547, -1344.6604765101758, -769.7135828855739, -1176.6894639324767, -1289.054713995133, -1261.3117166763384, -107.09653003696233, -1127.5098262976735, -749.6756145065448, -1136.0627198915045, -690.8837966199845, -848.6715101155376, -633.163843404835, -404.97292351308295, -135.65304975289672, -859.5021238942594, -959.5935776388458, -483.10519191198034, -1053.0710671982927, -305.40269602356796, -591.4329016852604, -895.70013790434, -534.274924108149, -867.0218668527734, -1032.662230659425, -988.3340972470799, -1035.3993281184532, -526.6199760408866, -54.13966079145734, -710.8776043588547, -305.08205642309895, -868.4842208016212, -1010.7965218858228, -965.8787868922913, -980.7562046921277, -744.6008924989688, -610.1032656488014, -764.8679605130137, -787.0809817975392, -499.7548411925286, -909.2801148199972, -1301.6566589424604, -912.3802136916674, -633.6808048640494, -476.8056559762187, -153.08315888062205, -830.2193705664528, -104.59550703176221, -1091.4713846588186, -792.5497073886021, -808.7002388535933, -1133.881053516724, -932.742617473653, -194.94917253524102, -198.58051229890927, -561.1831735635712, -1012.9994905425862, -147.5074310436952, -499.1426427400914, -669.7675026509289, -716.7123154945322, -1005.3977235385124, -1014.0251729542396, -192.53160914361115, -597.3771764518839]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.561280689939318, "mean_inference_ms": 1.7004051017906066, "mean_action_processing_ms": 0.286820283066201, "mean_env_wait_ms": 3.0173815685599243, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012968063354492188, "StateBufferConnector_ms": 0.008604288101196289, "ViewRequirementAgentConnector_ms": 0.19394254684448242}, "num_episodes": 31, "episode_return_max": -34.68861518359595, "episode_return_min": -1344.6604765101758, "episode_return_mean": -709.4127026786493, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.2744046724173, "num_env_steps_trained_throughput_per_sec": 301.2744046724173, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12584.843, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12584.774, "sample_time_ms": 1063.767, "learn_time_ms": 11456.162, "learn_throughput": 349.157, "synch_weights_time_ms": 64.111}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00015", "date": "2024-08-03_04-56-54", "timestamp": 1722641214, "time_this_iter_s": 13.289374351501465, "time_total_s": 88.18031740188599, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f7be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 88.18031740188599, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.442105263157895, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.126113183796406, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.16914336780707, "policy_loss": -0.01437141242834817, "vf_loss": 8.179483258227508, "vf_explained_var": 0.4351126498232285, "kl": 0.020225085562985138, "entropy": 1.3513132261733214, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -54.13966079145734, "episode_reward_min": -1372.1834574119794, "episode_reward_mean": -720.0385188490109, "episode_len_mean": 138.03, "episode_media": {}, "episodes_timesteps_total": 13803, "policy_reward_min": {"policy_0": -1372.1834574119794}, "policy_reward_max": {"policy_0": -54.13966079145734}, "policy_reward_mean": {"policy_0": -720.0385188490109}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-289.7035616455605, -674.5704607384664, -923.3923363646093, -1293.8894060601858, -1107.199758784547, -1344.6604765101758, -769.7135828855739, -1176.6894639324767, -1289.054713995133, -1261.3117166763384, -107.09653003696233, -1127.5098262976735, -749.6756145065448, -1136.0627198915045, -690.8837966199845, -848.6715101155376, -633.163843404835, -404.97292351308295, -135.65304975289672, -859.5021238942594, -959.5935776388458, -483.10519191198034, -1053.0710671982927, -305.40269602356796, -591.4329016852604, -895.70013790434, -534.274924108149, -867.0218668527734, -1032.662230659425, -988.3340972470799, -1035.3993281184532, -526.6199760408866, -54.13966079145734, -710.8776043588547, -305.08205642309895, -868.4842208016212, -1010.7965218858228, -965.8787868922913, -980.7562046921277, -744.6008924989688, -610.1032656488014, -764.8679605130137, -787.0809817975392, -499.7548411925286, -909.2801148199972, -1301.6566589424604, -912.3802136916674, -633.6808048640494, -476.8056559762187, -153.08315888062205, -830.2193705664528, -104.59550703176221, -1091.4713846588186, -792.5497073886021, -808.7002388535933, -1133.881053516724, -932.742617473653, -194.94917253524102, -198.58051229890927, -561.1831735635712, -1012.9994905425862, -147.5074310436952, -499.1426427400914, -669.7675026509289, -716.7123154945322, -1005.3977235385124, -1014.0251729542396, -192.53160914361115, -597.3771764518839, -1037.0615129101307, -945.585641975912, -68.43676494841776, -1249.5261632763202, -586.4141459969978, -161.05146794470494, -575.6057075626484, -364.07696140339834, -950.6298093544945, -216.00590379858392, -644.0042857749538, -660.0607164075379, -439.36778367345255, -777.4918261230412, -1127.957402545413, -1074.1007525328184, -453.786495482257, -220.54805390614985, -398.1291992947888, -611.1897491044509, -919.4857127773543, -450.155109259316, -987.1765157919824, -627.4000110509853, -452.07983230148074, -506.537385379436, -232.66975930497165, -688.0604566182916, -1372.1834574119794, -875.9437935600694, -1041.490689294786], "episode_lengths": [103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 100, 83, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 147, 64, 150, 87, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 84, 150, 150, 150, 150, 150, 84, 94, 150, 150, 69, 150, 150, 150, 150, 150, 127, 150, 150, 150, 83, 150, 150, 70, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 110, 72, 134, 150, 150, 150, 150, 150, 112, 150, 107, 150, 150, 150, 150], "policy_policy_0_reward": [-289.7035616455605, -674.5704607384664, -923.3923363646093, -1293.8894060601858, -1107.199758784547, -1344.6604765101758, -769.7135828855739, -1176.6894639324767, -1289.054713995133, -1261.3117166763384, -107.09653003696233, -1127.5098262976735, -749.6756145065448, -1136.0627198915045, -690.8837966199845, -848.6715101155376, -633.163843404835, -404.97292351308295, -135.65304975289672, -859.5021238942594, -959.5935776388458, -483.10519191198034, -1053.0710671982927, -305.40269602356796, -591.4329016852604, -895.70013790434, -534.274924108149, -867.0218668527734, -1032.662230659425, -988.3340972470799, -1035.3993281184532, -526.6199760408866, -54.13966079145734, -710.8776043588547, -305.08205642309895, -868.4842208016212, -1010.7965218858228, -965.8787868922913, -980.7562046921277, -744.6008924989688, -610.1032656488014, -764.8679605130137, -787.0809817975392, -499.7548411925286, -909.2801148199972, -1301.6566589424604, -912.3802136916674, -633.6808048640494, -476.8056559762187, -153.08315888062205, -830.2193705664528, -104.59550703176221, -1091.4713846588186, -792.5497073886021, -808.7002388535933, -1133.881053516724, -932.742617473653, -194.94917253524102, -198.58051229890927, -561.1831735635712, -1012.9994905425862, -147.5074310436952, -499.1426427400914, -669.7675026509289, -716.7123154945322, -1005.3977235385124, -1014.0251729542396, -192.53160914361115, -597.3771764518839, -1037.0615129101307, -945.585641975912, -68.43676494841776, -1249.5261632763202, -586.4141459969978, -161.05146794470494, -575.6057075626484, -364.07696140339834, -950.6298093544945, -216.00590379858392, -644.0042857749538, -660.0607164075379, -439.36778367345255, -777.4918261230412, -1127.957402545413, -1074.1007525328184, -453.786495482257, -220.54805390614985, -398.1291992947888, -611.1897491044509, -919.4857127773543, -450.155109259316, -987.1765157919824, -627.4000110509853, -452.07983230148074, -506.537385379436, -232.66975930497165, -688.0604566182916, -1372.1834574119794, -875.9437935600694, -1041.490689294786]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5601359998602491, "mean_inference_ms": 1.6976252638588876, "mean_action_processing_ms": 0.28624924469452667, "mean_env_wait_ms": 3.0170061237001, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01272273063659668, "StateBufferConnector_ms": 0.008281469345092773, "ViewRequirementAgentConnector_ms": 0.18983888626098633}, "num_episodes": 31, "episode_return_max": -54.13966079145734, "episode_return_min": -1372.1834574119794, "episode_return_mean": -720.0385188490109, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.0896984500855, "num_env_steps_trained_throughput_per_sec": 301.0896984500855, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12672.373, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12672.306, "sample_time_ms": 1059.39, "learn_time_ms": 11548.291, "learn_throughput": 346.372, "synch_weights_time_ms": 63.882}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00015", "date": "2024-08-03_04-57-07", "timestamp": 1722641227, "time_this_iter_s": 13.298196792602539, "time_total_s": 101.47851419448853, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30f41d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 101.47851419448853, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.247368421052634, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.146608912944794, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.399985353151957, "policy_loss": -0.016578585449800207, "vf_loss": 8.41048046151797, "vf_explained_var": 0.5082272582376997, "kl": 0.02032674370911991, "entropy": 1.4566232380767663, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -19.117592753957048, "episode_reward_min": -1372.1834574119794, "episode_reward_mean": -684.110618267277, "episode_len_mean": 136.02, "episode_media": {}, "episodes_timesteps_total": 13602, "policy_reward_min": {"policy_0": -1372.1834574119794}, "policy_reward_max": {"policy_0": -19.117592753957048}, "policy_reward_mean": {"policy_0": -684.110618267277}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1032.662230659425, -988.3340972470799, -1035.3993281184532, -526.6199760408866, -54.13966079145734, -710.8776043588547, -305.08205642309895, -868.4842208016212, -1010.7965218858228, -965.8787868922913, -980.7562046921277, -744.6008924989688, -610.1032656488014, -764.8679605130137, -787.0809817975392, -499.7548411925286, -909.2801148199972, -1301.6566589424604, -912.3802136916674, -633.6808048640494, -476.8056559762187, -153.08315888062205, -830.2193705664528, -104.59550703176221, -1091.4713846588186, -792.5497073886021, -808.7002388535933, -1133.881053516724, -932.742617473653, -194.94917253524102, -198.58051229890927, -561.1831735635712, -1012.9994905425862, -147.5074310436952, -499.1426427400914, -669.7675026509289, -716.7123154945322, -1005.3977235385124, -1014.0251729542396, -192.53160914361115, -597.3771764518839, -1037.0615129101307, -945.585641975912, -68.43676494841776, -1249.5261632763202, -586.4141459969978, -161.05146794470494, -575.6057075626484, -364.07696140339834, -950.6298093544945, -216.00590379858392, -644.0042857749538, -660.0607164075379, -439.36778367345255, -777.4918261230412, -1127.957402545413, -1074.1007525328184, -453.786495482257, -220.54805390614985, -398.1291992947888, -611.1897491044509, -919.4857127773543, -450.155109259316, -987.1765157919824, -627.4000110509853, -452.07983230148074, -506.537385379436, -232.66975930497165, -688.0604566182916, -1372.1834574119794, -875.9437935600694, -1041.490689294786, -832.262496317724, -747.9370814108721, -946.9359396388015, -77.28329426858228, -95.60205650289986, -368.33163712015926, -981.8454016793828, -185.45768334677027, -920.0587648455136, -354.72352737591217, -568.8970393319212, -744.4985682809473, -245.96612348756767, -19.117592753957048, -1236.9327541472362, -716.4232275012778, -829.4354814850282, -986.6796944344864, -606.1200298627708, -862.2175166573999, -202.75208590285047, -821.5920457395557, -922.1996930392768, -1006.9120537619439, -938.7034352601592, -531.2262623469978, -1283.859067865704, -886.2191664104723], "episode_lengths": [150, 150, 150, 147, 64, 150, 87, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 84, 150, 150, 150, 150, 150, 84, 94, 150, 150, 69, 150, 150, 150, 150, 150, 127, 150, 150, 150, 83, 150, 150, 70, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 110, 72, 134, 150, 150, 150, 150, 150, 112, 150, 107, 150, 150, 150, 150, 150, 150, 150, 57, 71, 150, 150, 101, 150, 150, 150, 150, 80, 59, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1032.662230659425, -988.3340972470799, -1035.3993281184532, -526.6199760408866, -54.13966079145734, -710.8776043588547, -305.08205642309895, -868.4842208016212, -1010.7965218858228, -965.8787868922913, -980.7562046921277, -744.6008924989688, -610.1032656488014, -764.8679605130137, -787.0809817975392, -499.7548411925286, -909.2801148199972, -1301.6566589424604, -912.3802136916674, -633.6808048640494, -476.8056559762187, -153.08315888062205, -830.2193705664528, -104.59550703176221, -1091.4713846588186, -792.5497073886021, -808.7002388535933, -1133.881053516724, -932.742617473653, -194.94917253524102, -198.58051229890927, -561.1831735635712, -1012.9994905425862, -147.5074310436952, -499.1426427400914, -669.7675026509289, -716.7123154945322, -1005.3977235385124, -1014.0251729542396, -192.53160914361115, -597.3771764518839, -1037.0615129101307, -945.585641975912, -68.43676494841776, -1249.5261632763202, -586.4141459969978, -161.05146794470494, -575.6057075626484, -364.07696140339834, -950.6298093544945, -216.00590379858392, -644.0042857749538, -660.0607164075379, -439.36778367345255, -777.4918261230412, -1127.957402545413, -1074.1007525328184, -453.786495482257, -220.54805390614985, -398.1291992947888, -611.1897491044509, -919.4857127773543, -450.155109259316, -987.1765157919824, -627.4000110509853, -452.07983230148074, -506.537385379436, -232.66975930497165, -688.0604566182916, -1372.1834574119794, -875.9437935600694, -1041.490689294786, -832.262496317724, -747.9370814108721, -946.9359396388015, -77.28329426858228, -95.60205650289986, -368.33163712015926, -981.8454016793828, -185.45768334677027, -920.0587648455136, -354.72352737591217, -568.8970393319212, -744.4985682809473, -245.96612348756767, -19.117592753957048, -1236.9327541472362, -716.4232275012778, -829.4354814850282, -986.6796944344864, -606.1200298627708, -862.2175166573999, -202.75208590285047, -821.5920457395557, -922.1996930392768, -1006.9120537619439, -938.7034352601592, -531.2262623469978, -1283.859067865704, -886.2191664104723]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5591353919061465, "mean_inference_ms": 1.695326771111055, "mean_action_processing_ms": 0.28555703071042354, "mean_env_wait_ms": 3.018199470647395, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012102603912353516, "StateBufferConnector_ms": 0.008099794387817383, "ViewRequirementAgentConnector_ms": 0.195662260055542}, "num_episodes": 28, "episode_return_max": -19.117592753957048, "episode_return_min": -1372.1834574119794, "episode_return_mean": -684.110618267277, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.0040710477864, "num_env_steps_trained_throughput_per_sec": 311.0040710477864, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12693.396, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12693.329, "sample_time_ms": 1059.765, "learn_time_ms": 11568.981, "learn_throughput": 345.752, "synch_weights_time_ms": 63.842}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00015", "date": "2024-08-03_04-57-20", "timestamp": 1722641240, "time_this_iter_s": 12.874802827835083, "time_total_s": 114.35331702232361, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f5cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.35331702232361, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.755555555555553, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.174133958419166, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.835644504924615, "policy_loss": -0.013668508115612592, "vf_loss": 7.843278058369955, "vf_explained_var": 0.6203923744459947, "kl": 0.013441657021273083, "entropy": 1.3775031390289465, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -19.117592753957048, "episode_reward_min": -1476.7252073511322, "episode_reward_mean": -652.3556891181242, "episode_len_mean": 134.63, "episode_media": {}, "episodes_timesteps_total": 13463, "policy_reward_min": {"policy_0": -1476.7252073511322}, "policy_reward_max": {"policy_0": -19.117592753957048}, "policy_reward_mean": {"policy_0": -652.3556891181242}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-932.742617473653, -194.94917253524102, -198.58051229890927, -561.1831735635712, -1012.9994905425862, -147.5074310436952, -499.1426427400914, -669.7675026509289, -716.7123154945322, -1005.3977235385124, -1014.0251729542396, -192.53160914361115, -597.3771764518839, -1037.0615129101307, -945.585641975912, -68.43676494841776, -1249.5261632763202, -586.4141459969978, -161.05146794470494, -575.6057075626484, -364.07696140339834, -950.6298093544945, -216.00590379858392, -644.0042857749538, -660.0607164075379, -439.36778367345255, -777.4918261230412, -1127.957402545413, -1074.1007525328184, -453.786495482257, -220.54805390614985, -398.1291992947888, -611.1897491044509, -919.4857127773543, -450.155109259316, -987.1765157919824, -627.4000110509853, -452.07983230148074, -506.537385379436, -232.66975930497165, -688.0604566182916, -1372.1834574119794, -875.9437935600694, -1041.490689294786, -832.262496317724, -747.9370814108721, -946.9359396388015, -77.28329426858228, -95.60205650289986, -368.33163712015926, -981.8454016793828, -185.45768334677027, -920.0587648455136, -354.72352737591217, -568.8970393319212, -744.4985682809473, -245.96612348756767, -19.117592753957048, -1236.9327541472362, -716.4232275012778, -829.4354814850282, -986.6796944344864, -606.1200298627708, -862.2175166573999, -202.75208590285047, -821.5920457395557, -922.1996930392768, -1006.9120537619439, -938.7034352601592, -531.2262623469978, -1283.859067865704, -886.2191664104723, -620.2411958019777, -213.10623827537117, -820.0729655957265, -700.6216393968632, -948.1893794356326, -890.4904033887851, -640.093799334346, -1226.5253866910682, -97.9098146409778, -788.3028353142196, -624.0906926370795, -603.1691999099314, -1034.2270903834947, -449.7328826382429, -255.04025749310406, -451.29035152062244, -1052.305579219544, -891.7118368160574, -59.10766216383428, -39.91823229797334, -1476.7252073511322, -241.286109258789, -407.3289644778843, -776.5641572508652, -193.6725978631301, -337.9011407305019, -1238.9845486746528, -779.6394152758598], "episode_lengths": [150, 84, 94, 150, 150, 69, 150, 150, 150, 150, 150, 127, 150, 150, 150, 83, 150, 150, 70, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 110, 72, 134, 150, 150, 150, 150, 150, 112, 150, 107, 150, 150, 150, 150, 150, 150, 150, 57, 71, 150, 150, 101, 150, 150, 150, 150, 80, 59, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 53, 150, 150, 150, 150, 68, 147, 150, 150], "policy_policy_0_reward": [-932.742617473653, -194.94917253524102, -198.58051229890927, -561.1831735635712, -1012.9994905425862, -147.5074310436952, -499.1426427400914, -669.7675026509289, -716.7123154945322, -1005.3977235385124, -1014.0251729542396, -192.53160914361115, -597.3771764518839, -1037.0615129101307, -945.585641975912, -68.43676494841776, -1249.5261632763202, -586.4141459969978, -161.05146794470494, -575.6057075626484, -364.07696140339834, -950.6298093544945, -216.00590379858392, -644.0042857749538, -660.0607164075379, -439.36778367345255, -777.4918261230412, -1127.957402545413, -1074.1007525328184, -453.786495482257, -220.54805390614985, -398.1291992947888, -611.1897491044509, -919.4857127773543, -450.155109259316, -987.1765157919824, -627.4000110509853, -452.07983230148074, -506.537385379436, -232.66975930497165, -688.0604566182916, -1372.1834574119794, -875.9437935600694, -1041.490689294786, -832.262496317724, -747.9370814108721, -946.9359396388015, -77.28329426858228, -95.60205650289986, -368.33163712015926, -981.8454016793828, -185.45768334677027, -920.0587648455136, -354.72352737591217, -568.8970393319212, -744.4985682809473, -245.96612348756767, -19.117592753957048, -1236.9327541472362, -716.4232275012778, -829.4354814850282, -986.6796944344864, -606.1200298627708, -862.2175166573999, -202.75208590285047, -821.5920457395557, -922.1996930392768, -1006.9120537619439, -938.7034352601592, -531.2262623469978, -1283.859067865704, -886.2191664104723, -620.2411958019777, -213.10623827537117, -820.0729655957265, -700.6216393968632, -948.1893794356326, -890.4904033887851, -640.093799334346, -1226.5253866910682, -97.9098146409778, -788.3028353142196, -624.0906926370795, -603.1691999099314, -1034.2270903834947, -449.7328826382429, -255.04025749310406, -451.29035152062244, -1052.305579219544, -891.7118368160574, -59.10766216383428, -39.91823229797334, -1476.7252073511322, -241.286109258789, -407.3289644778843, -776.5641572508652, -193.6725978631301, -337.9011407305019, -1238.9845486746528, -779.6394152758598]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5584323236390065, "mean_inference_ms": 1.6954439943293695, "mean_action_processing_ms": 0.28472876801221697, "mean_env_wait_ms": 3.0206713988497715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011915206909179688, "StateBufferConnector_ms": 0.007790327072143555, "ViewRequirementAgentConnector_ms": 0.1987440586090088}, "num_episodes": 28, "episode_return_max": -19.117592753957048, "episode_return_min": -1476.7252073511322, "episode_return_mean": -652.3556891181242, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.43223985841433, "num_env_steps_trained_throughput_per_sec": 306.43223985841433, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12729.403, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12729.337, "sample_time_ms": 1071.934, "learn_time_ms": 11593.034, "learn_throughput": 345.035, "synch_weights_time_ms": 63.631}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00015", "date": "2024-08-03_04-57-33", "timestamp": 1722641253, "time_this_iter_s": 13.065505743026733, "time_total_s": 127.41882276535034, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa2a70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 127.41882276535034, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.400000000000002, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.09229129552841, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.0603702386220295, "policy_loss": -0.012515327810736684, "vf_loss": 7.066741912066936, "vf_explained_var": 0.7192724961787462, "kl": 0.013682843104697907, "entropy": 1.3626354520519575, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -19.117592753957048, "episode_reward_min": -1476.7252073511322, "episode_reward_mean": -670.1024692963911, "episode_len_mean": 134.59, "episode_media": {}, "episodes_timesteps_total": 13459, "policy_reward_min": {"policy_0": -1476.7252073511322}, "policy_reward_max": {"policy_0": -19.117592753957048}, "policy_reward_mean": {"policy_0": -670.1024692963911}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-450.155109259316, -987.1765157919824, -627.4000110509853, -452.07983230148074, -506.537385379436, -232.66975930497165, -688.0604566182916, -1372.1834574119794, -875.9437935600694, -1041.490689294786, -832.262496317724, -747.9370814108721, -946.9359396388015, -77.28329426858228, -95.60205650289986, -368.33163712015926, -981.8454016793828, -185.45768334677027, -920.0587648455136, -354.72352737591217, -568.8970393319212, -744.4985682809473, -245.96612348756767, -19.117592753957048, -1236.9327541472362, -716.4232275012778, -829.4354814850282, -986.6796944344864, -606.1200298627708, -862.2175166573999, -202.75208590285047, -821.5920457395557, -922.1996930392768, -1006.9120537619439, -938.7034352601592, -531.2262623469978, -1283.859067865704, -886.2191664104723, -620.2411958019777, -213.10623827537117, -820.0729655957265, -700.6216393968632, -948.1893794356326, -890.4904033887851, -640.093799334346, -1226.5253866910682, -97.9098146409778, -788.3028353142196, -624.0906926370795, -603.1691999099314, -1034.2270903834947, -449.7328826382429, -255.04025749310406, -451.29035152062244, -1052.305579219544, -891.7118368160574, -59.10766216383428, -39.91823229797334, -1476.7252073511322, -241.286109258789, -407.3289644778843, -776.5641572508652, -193.6725978631301, -337.9011407305019, -1238.9845486746528, -779.6394152758598, -1059.3852568030534, -855.5160437620435, -852.6293748322917, -253.50342632861958, -312.6458935824291, -118.38490715400384, -938.7831492040501, -710.9680484252644, -79.34700300137037, -860.5104795203702, -876.5257688186663, -519.4658151975163, -134.61081289328732, -867.1552737281439, -1273.192715684903, -991.954723096399, -397.01563349190735, -19.751569707000847, -609.5491652253498, -267.0664429259345, -1033.9273009958458, -1244.276299078832, -1011.4507889473256, -570.4632543054556, -1214.4212565660985, -64.68586196905396, -914.9812052363417, -675.0409551306354, -622.5259980574058, -353.9693430218428, -619.6331471234031, -790.0723098896304, -1102.775041972936, -781.9263493745677], "episode_lengths": [150, 150, 150, 112, 150, 107, 150, 150, 150, 150, 150, 150, 150, 57, 71, 150, 150, 101, 150, 150, 150, 150, 80, 59, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 53, 150, 150, 150, 150, 68, 147, 150, 150, 150, 150, 139, 127, 135, 53, 150, 142, 57, 150, 150, 150, 66, 150, 150, 150, 150, 40, 150, 110, 150, 150, 150, 150, 150, 59, 150, 150, 150, 128, 150, 150, 150, 150], "policy_policy_0_reward": [-450.155109259316, -987.1765157919824, -627.4000110509853, -452.07983230148074, -506.537385379436, -232.66975930497165, -688.0604566182916, -1372.1834574119794, -875.9437935600694, -1041.490689294786, -832.262496317724, -747.9370814108721, -946.9359396388015, -77.28329426858228, -95.60205650289986, -368.33163712015926, -981.8454016793828, -185.45768334677027, -920.0587648455136, -354.72352737591217, -568.8970393319212, -744.4985682809473, -245.96612348756767, -19.117592753957048, -1236.9327541472362, -716.4232275012778, -829.4354814850282, -986.6796944344864, -606.1200298627708, -862.2175166573999, -202.75208590285047, -821.5920457395557, -922.1996930392768, -1006.9120537619439, -938.7034352601592, -531.2262623469978, -1283.859067865704, -886.2191664104723, -620.2411958019777, -213.10623827537117, -820.0729655957265, -700.6216393968632, -948.1893794356326, -890.4904033887851, -640.093799334346, -1226.5253866910682, -97.9098146409778, -788.3028353142196, -624.0906926370795, -603.1691999099314, -1034.2270903834947, -449.7328826382429, -255.04025749310406, -451.29035152062244, -1052.305579219544, -891.7118368160574, -59.10766216383428, -39.91823229797334, -1476.7252073511322, -241.286109258789, -407.3289644778843, -776.5641572508652, -193.6725978631301, -337.9011407305019, -1238.9845486746528, -779.6394152758598, -1059.3852568030534, -855.5160437620435, -852.6293748322917, -253.50342632861958, -312.6458935824291, -118.38490715400384, -938.7831492040501, -710.9680484252644, -79.34700300137037, -860.5104795203702, -876.5257688186663, -519.4658151975163, -134.61081289328732, -867.1552737281439, -1273.192715684903, -991.954723096399, -397.01563349190735, -19.751569707000847, -609.5491652253498, -267.0664429259345, -1033.9273009958458, -1244.276299078832, -1011.4507889473256, -570.4632543054556, -1214.4212565660985, -64.68586196905396, -914.9812052363417, -675.0409551306354, -622.5259980574058, -353.9693430218428, -619.6331471234031, -790.0723098896304, -1102.775041972936, -781.9263493745677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5570483508180741, "mean_inference_ms": 1.6951933724626616, "mean_action_processing_ms": 0.28390002357857513, "mean_env_wait_ms": 3.023593083377292, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011955022811889648, "StateBufferConnector_ms": 0.007832050323486328, "ViewRequirementAgentConnector_ms": 0.20085430145263672}, "num_episodes": 34, "episode_return_max": -19.117592753957048, "episode_return_min": -1476.7252073511322, "episode_return_mean": -670.1024692963911, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.73823763498996, "num_env_steps_trained_throughput_per_sec": 306.73823763498996, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12732.182, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12732.116, "sample_time_ms": 1071.638, "learn_time_ms": 11596.164, "learn_throughput": 344.942, "synch_weights_time_ms": 63.572}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00015", "date": "2024-08-03_04-57-46", "timestamp": 1722641266, "time_this_iter_s": 13.052474021911621, "time_total_s": 140.47129678726196, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270cdc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 140.47129678726196, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.226315789473684, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.80454581131538, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.893696533640226, "policy_loss": -0.009674708595169553, "vf_loss": 6.897761900722981, "vf_explained_var": 0.7190295004596313, "kl": 0.012496840185485792, "entropy": 1.42369217214485, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -19.751569707000847, "episode_reward_min": -1476.7252073511322, "episode_reward_mean": -690.9066672800225, "episode_len_mean": 136.92, "episode_media": {}, "episodes_timesteps_total": 13692, "policy_reward_min": {"policy_0": -1476.7252073511322}, "policy_reward_max": {"policy_0": -19.751569707000847}, "policy_reward_mean": {"policy_0": -690.9066672800225}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-716.4232275012778, -829.4354814850282, -986.6796944344864, -606.1200298627708, -862.2175166573999, -202.75208590285047, -821.5920457395557, -922.1996930392768, -1006.9120537619439, -938.7034352601592, -531.2262623469978, -1283.859067865704, -886.2191664104723, -620.2411958019777, -213.10623827537117, -820.0729655957265, -700.6216393968632, -948.1893794356326, -890.4904033887851, -640.093799334346, -1226.5253866910682, -97.9098146409778, -788.3028353142196, -624.0906926370795, -603.1691999099314, -1034.2270903834947, -449.7328826382429, -255.04025749310406, -451.29035152062244, -1052.305579219544, -891.7118368160574, -59.10766216383428, -39.91823229797334, -1476.7252073511322, -241.286109258789, -407.3289644778843, -776.5641572508652, -193.6725978631301, -337.9011407305019, -1238.9845486746528, -779.6394152758598, -1059.3852568030534, -855.5160437620435, -852.6293748322917, -253.50342632861958, -312.6458935824291, -118.38490715400384, -938.7831492040501, -710.9680484252644, -79.34700300137037, -860.5104795203702, -876.5257688186663, -519.4658151975163, -134.61081289328732, -867.1552737281439, -1273.192715684903, -991.954723096399, -397.01563349190735, -19.751569707000847, -609.5491652253498, -267.0664429259345, -1033.9273009958458, -1244.276299078832, -1011.4507889473256, -570.4632543054556, -1214.4212565660985, -64.68586196905396, -914.9812052363417, -675.0409551306354, -622.5259980574058, -353.9693430218428, -619.6331471234031, -790.0723098896304, -1102.775041972936, -781.9263493745677, -355.3025288195075, -144.35053430512704, -678.6743519997806, -481.12766038701454, -373.0484334258361, -1196.8904157427708, -1087.902215155098, -265.42407885233047, -715.5157504433113, -735.8435711990818, -667.5961835500094, -1015.91796265078, -975.2714802742454, -697.3313398695966, -686.9008934755368, -498.0103726535842, -299.7160797891773, -1089.6182604424482, -474.3433925469888, -905.3393684645358, -1155.0661081898565, -1158.4329457470744, -1378.1093318979563, -574.6457386770376, -29.587770286006414], "episode_lengths": [150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 59, 53, 150, 150, 150, 150, 68, 147, 150, 150, 150, 150, 139, 127, 135, 53, 150, 142, 57, 150, 150, 150, 66, 150, 150, 150, 150, 40, 150, 110, 150, 150, 150, 150, 150, 59, 150, 150, 150, 128, 150, 150, 150, 150, 150, 80, 150, 150, 142, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 55], "policy_policy_0_reward": [-716.4232275012778, -829.4354814850282, -986.6796944344864, -606.1200298627708, -862.2175166573999, -202.75208590285047, -821.5920457395557, -922.1996930392768, -1006.9120537619439, -938.7034352601592, -531.2262623469978, -1283.859067865704, -886.2191664104723, -620.2411958019777, -213.10623827537117, -820.0729655957265, -700.6216393968632, -948.1893794356326, -890.4904033887851, -640.093799334346, -1226.5253866910682, -97.9098146409778, -788.3028353142196, -624.0906926370795, -603.1691999099314, -1034.2270903834947, -449.7328826382429, -255.04025749310406, -451.29035152062244, -1052.305579219544, -891.7118368160574, -59.10766216383428, -39.91823229797334, -1476.7252073511322, -241.286109258789, -407.3289644778843, -776.5641572508652, -193.6725978631301, -337.9011407305019, -1238.9845486746528, -779.6394152758598, -1059.3852568030534, -855.5160437620435, -852.6293748322917, -253.50342632861958, -312.6458935824291, -118.38490715400384, -938.7831492040501, -710.9680484252644, -79.34700300137037, -860.5104795203702, -876.5257688186663, -519.4658151975163, -134.61081289328732, -867.1552737281439, -1273.192715684903, -991.954723096399, -397.01563349190735, -19.751569707000847, -609.5491652253498, -267.0664429259345, -1033.9273009958458, -1244.276299078832, -1011.4507889473256, -570.4632543054556, -1214.4212565660985, -64.68586196905396, -914.9812052363417, -675.0409551306354, -622.5259980574058, -353.9693430218428, -619.6331471234031, -790.0723098896304, -1102.775041972936, -781.9263493745677, -355.3025288195075, -144.35053430512704, -678.6743519997806, -481.12766038701454, -373.0484334258361, -1196.8904157427708, -1087.902215155098, -265.42407885233047, -715.5157504433113, -735.8435711990818, -667.5961835500094, -1015.91796265078, -975.2714802742454, -697.3313398695966, -686.9008934755368, -498.0103726535842, -299.7160797891773, -1089.6182604424482, -474.3433925469888, -905.3393684645358, -1155.0661081898565, -1158.4329457470744, -1378.1093318979563, -574.6457386770376, -29.587770286006414]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556363346227781, "mean_inference_ms": 1.6945723840232818, "mean_action_processing_ms": 0.2832893183746905, "mean_env_wait_ms": 3.0253477122965093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011842489242553711, "StateBufferConnector_ms": 0.007841110229492188, "ViewRequirementAgentConnector_ms": 0.19600653648376465}, "num_episodes": 25, "episode_return_max": -19.751569707000847, "episode_return_min": -1476.7252073511322, "episode_return_mean": -690.9066672800225, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.6411958548977, "num_env_steps_trained_throughput_per_sec": 307.6411958548977, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12733.079, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12733.012, "sample_time_ms": 1077.327, "learn_time_ms": 11592.708, "learn_throughput": 345.044, "synch_weights_time_ms": 62.237}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00015", "date": "2024-08-03_04-58-00", "timestamp": 1722641280, "time_this_iter_s": 13.014802932739258, "time_total_s": 153.48609972000122, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa3be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 153.48609972000122, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.41111111111111, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.96860534151395, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.013134731849035, "policy_loss": -0.013860429523144072, "vf_loss": 7.0201175158222515, "vf_explained_var": 0.7836049862826864, "kl": 0.015315217758870871, "entropy": 1.4199407430986564, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -19.751569707000847, "episode_reward_min": -1476.7252073511322, "episode_reward_mean": -692.7631700272633, "episode_len_mean": 135.81, "episode_media": {}, "episodes_timesteps_total": 13581, "policy_reward_min": {"policy_0": -1476.7252073511322}, "policy_reward_max": {"policy_0": -19.751569707000847}, "policy_reward_mean": {"policy_0": -692.7631700272633}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1052.305579219544, -891.7118368160574, -59.10766216383428, -39.91823229797334, -1476.7252073511322, -241.286109258789, -407.3289644778843, -776.5641572508652, -193.6725978631301, -337.9011407305019, -1238.9845486746528, -779.6394152758598, -1059.3852568030534, -855.5160437620435, -852.6293748322917, -253.50342632861958, -312.6458935824291, -118.38490715400384, -938.7831492040501, -710.9680484252644, -79.34700300137037, -860.5104795203702, -876.5257688186663, -519.4658151975163, -134.61081289328732, -867.1552737281439, -1273.192715684903, -991.954723096399, -397.01563349190735, -19.751569707000847, -609.5491652253498, -267.0664429259345, -1033.9273009958458, -1244.276299078832, -1011.4507889473256, -570.4632543054556, -1214.4212565660985, -64.68586196905396, -914.9812052363417, -675.0409551306354, -622.5259980574058, -353.9693430218428, -619.6331471234031, -790.0723098896304, -1102.775041972936, -781.9263493745677, -355.3025288195075, -144.35053430512704, -678.6743519997806, -481.12766038701454, -373.0484334258361, -1196.8904157427708, -1087.902215155098, -265.42407885233047, -715.5157504433113, -735.8435711990818, -667.5961835500094, -1015.91796265078, -975.2714802742454, -697.3313398695966, -686.9008934755368, -498.0103726535842, -299.7160797891773, -1089.6182604424482, -474.3433925469888, -905.3393684645358, -1155.0661081898565, -1158.4329457470744, -1378.1093318979563, -574.6457386770376, -29.587770286006414, -883.1190455287176, -393.0853142744499, -545.0278299833232, -441.2026893912596, -275.1861352787915, -1093.265553933379, -853.9309810005273, -292.21788660081506, -844.0421134501399, -306.8847825164498, -743.7359518749244, -699.7674296629067, -1216.9954773370312, -1246.5573990310534, -503.61052546896934, -703.8612834428022, -55.72833960395534, -557.2152337675963, -803.3344884458834, -925.2047210019225, -933.2429107979167, -1074.7222197723677, -739.2536854651601, -97.42591545866829, -652.8297151535344, -846.2957941522517, -1015.7147093681658, -1229.0840090260026, -1170.5520266604583], "episode_lengths": [150, 150, 59, 53, 150, 150, 150, 150, 68, 147, 150, 150, 150, 150, 139, 127, 135, 53, 150, 142, 57, 150, 150, 150, 66, 150, 150, 150, 150, 40, 150, 110, 150, 150, 150, 150, 150, 59, 150, 150, 150, 128, 150, 150, 150, 150, 150, 80, 150, 150, 142, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 129, 150, 150, 93, 150, 96, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1052.305579219544, -891.7118368160574, -59.10766216383428, -39.91823229797334, -1476.7252073511322, -241.286109258789, -407.3289644778843, -776.5641572508652, -193.6725978631301, -337.9011407305019, -1238.9845486746528, -779.6394152758598, -1059.3852568030534, -855.5160437620435, -852.6293748322917, -253.50342632861958, -312.6458935824291, -118.38490715400384, -938.7831492040501, -710.9680484252644, -79.34700300137037, -860.5104795203702, -876.5257688186663, -519.4658151975163, -134.61081289328732, -867.1552737281439, -1273.192715684903, -991.954723096399, -397.01563349190735, -19.751569707000847, -609.5491652253498, -267.0664429259345, -1033.9273009958458, -1244.276299078832, -1011.4507889473256, -570.4632543054556, -1214.4212565660985, -64.68586196905396, -914.9812052363417, -675.0409551306354, -622.5259980574058, -353.9693430218428, -619.6331471234031, -790.0723098896304, -1102.775041972936, -781.9263493745677, -355.3025288195075, -144.35053430512704, -678.6743519997806, -481.12766038701454, -373.0484334258361, -1196.8904157427708, -1087.902215155098, -265.42407885233047, -715.5157504433113, -735.8435711990818, -667.5961835500094, -1015.91796265078, -975.2714802742454, -697.3313398695966, -686.9008934755368, -498.0103726535842, -299.7160797891773, -1089.6182604424482, -474.3433925469888, -905.3393684645358, -1155.0661081898565, -1158.4329457470744, -1378.1093318979563, -574.6457386770376, -29.587770286006414, -883.1190455287176, -393.0853142744499, -545.0278299833232, -441.2026893912596, -275.1861352787915, -1093.265553933379, -853.9309810005273, -292.21788660081506, -844.0421134501399, -306.8847825164498, -743.7359518749244, -699.7674296629067, -1216.9954773370312, -1246.5573990310534, -503.61052546896934, -703.8612834428022, -55.72833960395534, -557.2152337675963, -803.3344884458834, -925.2047210019225, -933.2429107979167, -1074.7222197723677, -739.2536854651601, -97.42591545866829, -652.8297151535344, -846.2957941522517, -1015.7147093681658, -1229.0840090260026, -1170.5520266604583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5553175048614333, "mean_inference_ms": 1.692132895438512, "mean_action_processing_ms": 0.2826022803706968, "mean_env_wait_ms": 3.0244347657062667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01195216178894043, "StateBufferConnector_ms": 0.00787496566772461, "ViewRequirementAgentConnector_ms": 0.19820332527160645}, "num_episodes": 29, "episode_return_max": -19.751569707000847, "episode_return_min": -1476.7252073511322, "episode_return_mean": -692.7631700272633, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 342.034325557849, "num_env_steps_trained_throughput_per_sec": 342.034325557849, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12754.142, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12754.073, "sample_time_ms": 1074.191, "learn_time_ms": 11617.005, "learn_throughput": 344.323, "synch_weights_time_ms": 62.137}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00015", "date": "2024-08-03_04-58-11", "timestamp": 1722641291, "time_this_iter_s": 11.706837177276611, "time_total_s": 165.19293689727783, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa3e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 165.19293689727783, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.458823529411767, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 48.97096206645171, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.265412258108457, "policy_loss": -0.012256631730512406, "vf_loss": 6.271584934989611, "vf_explained_var": 0.7950419516613086, "kl": 0.013551946207523254, "entropy": 1.4407490901648998, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -29.587770286006414, "episode_reward_min": -1378.1093318979563, "episode_reward_mean": -737.1066215653832, "episode_len_mean": 140.29, "episode_media": {}, "episodes_timesteps_total": 14029, "policy_reward_min": {"policy_0": -1378.1093318979563}, "policy_reward_max": {"policy_0": -29.587770286006414}, "policy_reward_mean": {"policy_0": -737.1066215653832}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-267.0664429259345, -1033.9273009958458, -1244.276299078832, -1011.4507889473256, -570.4632543054556, -1214.4212565660985, -64.68586196905396, -914.9812052363417, -675.0409551306354, -622.5259980574058, -353.9693430218428, -619.6331471234031, -790.0723098896304, -1102.775041972936, -781.9263493745677, -355.3025288195075, -144.35053430512704, -678.6743519997806, -481.12766038701454, -373.0484334258361, -1196.8904157427708, -1087.902215155098, -265.42407885233047, -715.5157504433113, -735.8435711990818, -667.5961835500094, -1015.91796265078, -975.2714802742454, -697.3313398695966, -686.9008934755368, -498.0103726535842, -299.7160797891773, -1089.6182604424482, -474.3433925469888, -905.3393684645358, -1155.0661081898565, -1158.4329457470744, -1378.1093318979563, -574.6457386770376, -29.587770286006414, -883.1190455287176, -393.0853142744499, -545.0278299833232, -441.2026893912596, -275.1861352787915, -1093.265553933379, -853.9309810005273, -292.21788660081506, -844.0421134501399, -306.8847825164498, -743.7359518749244, -699.7674296629067, -1216.9954773370312, -1246.5573990310534, -503.61052546896934, -703.8612834428022, -55.72833960395534, -557.2152337675963, -803.3344884458834, -925.2047210019225, -933.2429107979167, -1074.7222197723677, -739.2536854651601, -97.42591545866829, -652.8297151535344, -846.2957941522517, -1015.7147093681658, -1229.0840090260026, -1170.5520266604583, -705.4830918778039, -834.9686154427482, -271.9677269666769, -1226.905570285303, -1329.829627437029, -795.3007803510595, -430.14394980775006, -855.4417135661337, -44.507016785840456, -793.865601470055, -554.6371219699636, -490.9908832137166, -211.3507718464501, -683.5720862410657, -1082.7048041116386, -1296.2752323746627, -808.339638354789, -1080.628876383479, -937.1448685497978, -687.8437469950512, -178.85872285794412, -253.74694549816417, -1245.0399345911721, -388.3879496603347, -1297.7114452223043, -1167.3496540446922, -645.0976381740772, -1203.4618431783488, -709.7003949644946, -613.1495842350436, -835.9798291913141], "episode_lengths": [110, 150, 150, 150, 150, 150, 59, 150, 150, 150, 128, 150, 150, 150, 150, 150, 80, 150, 150, 142, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 129, 150, 150, 93, 150, 96, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 69, 150, 125, 150, 124, 140, 150, 150, 150, 150, 150, 150, 100, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-267.0664429259345, -1033.9273009958458, -1244.276299078832, -1011.4507889473256, -570.4632543054556, -1214.4212565660985, -64.68586196905396, -914.9812052363417, -675.0409551306354, -622.5259980574058, -353.9693430218428, -619.6331471234031, -790.0723098896304, -1102.775041972936, -781.9263493745677, -355.3025288195075, -144.35053430512704, -678.6743519997806, -481.12766038701454, -373.0484334258361, -1196.8904157427708, -1087.902215155098, -265.42407885233047, -715.5157504433113, -735.8435711990818, -667.5961835500094, -1015.91796265078, -975.2714802742454, -697.3313398695966, -686.9008934755368, -498.0103726535842, -299.7160797891773, -1089.6182604424482, -474.3433925469888, -905.3393684645358, -1155.0661081898565, -1158.4329457470744, -1378.1093318979563, -574.6457386770376, -29.587770286006414, -883.1190455287176, -393.0853142744499, -545.0278299833232, -441.2026893912596, -275.1861352787915, -1093.265553933379, -853.9309810005273, -292.21788660081506, -844.0421134501399, -306.8847825164498, -743.7359518749244, -699.7674296629067, -1216.9954773370312, -1246.5573990310534, -503.61052546896934, -703.8612834428022, -55.72833960395534, -557.2152337675963, -803.3344884458834, -925.2047210019225, -933.2429107979167, -1074.7222197723677, -739.2536854651601, -97.42591545866829, -652.8297151535344, -846.2957941522517, -1015.7147093681658, -1229.0840090260026, -1170.5520266604583, -705.4830918778039, -834.9686154427482, -271.9677269666769, -1226.905570285303, -1329.829627437029, -795.3007803510595, -430.14394980775006, -855.4417135661337, -44.507016785840456, -793.865601470055, -554.6371219699636, -490.9908832137166, -211.3507718464501, -683.5720862410657, -1082.7048041116386, -1296.2752323746627, -808.339638354789, -1080.628876383479, -937.1448685497978, -687.8437469950512, -178.85872285794412, -253.74694549816417, -1245.0399345911721, -388.3879496603347, -1297.7114452223043, -1167.3496540446922, -645.0976381740772, -1203.4618431783488, -709.7003949644946, -613.1495842350436, -835.9798291913141]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552397417055607, "mean_inference_ms": 1.6904767413550439, "mean_action_processing_ms": 0.2823136216468641, "mean_env_wait_ms": 3.0256673621109558, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011949539184570312, "StateBufferConnector_ms": 0.008014678955078125, "ViewRequirementAgentConnector_ms": 0.19464349746704102}, "num_episodes": 31, "episode_return_max": -29.587770286006414, "episode_return_min": -1378.1093318979563, "episode_return_mean": -737.1066215653832, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.47903572355665, "num_env_steps_trained_throughput_per_sec": 307.47903572355665, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12896.75, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12896.681, "sample_time_ms": 1065.936, "learn_time_ms": 11767.177, "learn_throughput": 339.929, "synch_weights_time_ms": 62.828}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00015", "date": "2024-08-03_04-58-24", "timestamp": 1722641304, "time_this_iter_s": 13.021122455596924, "time_total_s": 178.21405935287476, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270ef80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 178.21405935287476, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.54444444444444, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.41790667672952, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.71293054819107, "policy_loss": -0.014283894683467224, "vf_loss": 6.720643757780393, "vf_explained_var": 0.8738579771791896, "kl": 0.01463348212740434, "entropy": 1.4370056752115488, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -3.6291436390535283, "episode_reward_min": -1378.1093318979563, "episode_reward_mean": -716.0904451095344, "episode_len_mean": 136.81, "episode_media": {}, "episodes_timesteps_total": 13681, "policy_reward_min": {"policy_0": -1378.1093318979563}, "policy_reward_max": {"policy_0": -3.6291436390535283}, "policy_reward_mean": {"policy_0": -716.0904451095344}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-498.0103726535842, -299.7160797891773, -1089.6182604424482, -474.3433925469888, -905.3393684645358, -1155.0661081898565, -1158.4329457470744, -1378.1093318979563, -574.6457386770376, -29.587770286006414, -883.1190455287176, -393.0853142744499, -545.0278299833232, -441.2026893912596, -275.1861352787915, -1093.265553933379, -853.9309810005273, -292.21788660081506, -844.0421134501399, -306.8847825164498, -743.7359518749244, -699.7674296629067, -1216.9954773370312, -1246.5573990310534, -503.61052546896934, -703.8612834428022, -55.72833960395534, -557.2152337675963, -803.3344884458834, -925.2047210019225, -933.2429107979167, -1074.7222197723677, -739.2536854651601, -97.42591545866829, -652.8297151535344, -846.2957941522517, -1015.7147093681658, -1229.0840090260026, -1170.5520266604583, -705.4830918778039, -834.9686154427482, -271.9677269666769, -1226.905570285303, -1329.829627437029, -795.3007803510595, -430.14394980775006, -855.4417135661337, -44.507016785840456, -793.865601470055, -554.6371219699636, -490.9908832137166, -211.3507718464501, -683.5720862410657, -1082.7048041116386, -1296.2752323746627, -808.339638354789, -1080.628876383479, -937.1448685497978, -687.8437469950512, -178.85872285794412, -253.74694549816417, -1245.0399345911721, -388.3879496603347, -1297.7114452223043, -1167.3496540446922, -645.0976381740772, -1203.4618431783488, -709.7003949644946, -613.1495842350436, -835.9798291913141, -850.443069089575, -3.6291436390535283, -1243.83341913458, -326.5921106403429, -910.6961620523821, -724.8546360774344, -75.23691805977863, -146.8823768795824, -545.1285219444183, -21.869331152718097, -801.0338927939383, -1083.4444351121872, -753.7653595379333, -627.7587066569291, -709.2916548292825, -465.358698128852, -821.3401971583329, -1140.902540992775, -62.123060367354064, -918.3395801153313, -1193.3710153267377, -926.8860703981732, -22.030311599829872, -790.38227062668, -903.7916888104168, -1130.1318292607177, -511.3876379291361, -339.71520133884684, -739.6122572068363, -452.86321230029074], "episode_lengths": [150, 121, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 129, 150, 150, 93, 150, 96, 150, 150, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 69, 150, 125, 150, 124, 140, 150, 150, 150, 150, 150, 150, 100, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 138, 150, 150, 66, 77, 135, 49, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 61, 150, 150, 150, 118, 150, 150, 150], "policy_policy_0_reward": [-498.0103726535842, -299.7160797891773, -1089.6182604424482, -474.3433925469888, -905.3393684645358, -1155.0661081898565, -1158.4329457470744, -1378.1093318979563, -574.6457386770376, -29.587770286006414, -883.1190455287176, -393.0853142744499, -545.0278299833232, -441.2026893912596, -275.1861352787915, -1093.265553933379, -853.9309810005273, -292.21788660081506, -844.0421134501399, -306.8847825164498, -743.7359518749244, -699.7674296629067, -1216.9954773370312, -1246.5573990310534, -503.61052546896934, -703.8612834428022, -55.72833960395534, -557.2152337675963, -803.3344884458834, -925.2047210019225, -933.2429107979167, -1074.7222197723677, -739.2536854651601, -97.42591545866829, -652.8297151535344, -846.2957941522517, -1015.7147093681658, -1229.0840090260026, -1170.5520266604583, -705.4830918778039, -834.9686154427482, -271.9677269666769, -1226.905570285303, -1329.829627437029, -795.3007803510595, -430.14394980775006, -855.4417135661337, -44.507016785840456, -793.865601470055, -554.6371219699636, -490.9908832137166, -211.3507718464501, -683.5720862410657, -1082.7048041116386, -1296.2752323746627, -808.339638354789, -1080.628876383479, -937.1448685497978, -687.8437469950512, -178.85872285794412, -253.74694549816417, -1245.0399345911721, -388.3879496603347, -1297.7114452223043, -1167.3496540446922, -645.0976381740772, -1203.4618431783488, -709.7003949644946, -613.1495842350436, -835.9798291913141, -850.443069089575, -3.6291436390535283, -1243.83341913458, -326.5921106403429, -910.6961620523821, -724.8546360774344, -75.23691805977863, -146.8823768795824, -545.1285219444183, -21.869331152718097, -801.0338927939383, -1083.4444351121872, -753.7653595379333, -627.7587066569291, -709.2916548292825, -465.358698128852, -821.3401971583329, -1140.902540992775, -62.123060367354064, -918.3395801153313, -1193.3710153267377, -926.8860703981732, -22.030311599829872, -790.38227062668, -903.7916888104168, -1130.1318292607177, -511.3876379291361, -339.71520133884684, -739.6122572068363, -452.86321230029074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555075795110844, "mean_inference_ms": 1.6894320948115336, "mean_action_processing_ms": 0.28218764035845606, "mean_env_wait_ms": 3.0307305901036337, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011801481246948242, "StateBufferConnector_ms": 0.007904529571533203, "ViewRequirementAgentConnector_ms": 0.1927485466003418}, "num_episodes": 30, "episode_return_max": -3.6291436390535283, "episode_return_min": -1378.1093318979563, "episode_return_mean": -716.0904451095344, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.49286801228874, "num_env_steps_trained_throughput_per_sec": 313.49286801228874, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12895.618, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12895.548, "sample_time_ms": 1062.441, "learn_time_ms": 11768.586, "learn_throughput": 339.888, "synch_weights_time_ms": 63.78}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00015", "date": "2024-08-03_04-58-37", "timestamp": 1722641317, "time_this_iter_s": 12.772922992706299, "time_total_s": 190.98698234558105, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa1870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 190.98698234558105, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.62222222222222, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 84.55841248929501, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.1658692672848705, "policy_loss": -0.013039979500657257, "vf_loss": 5.172920114298662, "vf_explained_var": 0.9036451537782947, "kl": 0.013337635634222049, "entropy": 1.2800321420033773, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -3.6291436390535283, "episode_reward_min": -1329.829627437029, "episode_reward_mean": -696.5795395440074, "episode_len_mean": 137.03, "episode_media": {}, "episodes_timesteps_total": 13703, "policy_reward_min": {"policy_0": -1329.829627437029}, "policy_reward_max": {"policy_0": -3.6291436390535283}, "policy_reward_mean": {"policy_0": -696.5795395440074}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-557.2152337675963, -803.3344884458834, -925.2047210019225, -933.2429107979167, -1074.7222197723677, -739.2536854651601, -97.42591545866829, -652.8297151535344, -846.2957941522517, -1015.7147093681658, -1229.0840090260026, -1170.5520266604583, -705.4830918778039, -834.9686154427482, -271.9677269666769, -1226.905570285303, -1329.829627437029, -795.3007803510595, -430.14394980775006, -855.4417135661337, -44.507016785840456, -793.865601470055, -554.6371219699636, -490.9908832137166, -211.3507718464501, -683.5720862410657, -1082.7048041116386, -1296.2752323746627, -808.339638354789, -1080.628876383479, -937.1448685497978, -687.8437469950512, -178.85872285794412, -253.74694549816417, -1245.0399345911721, -388.3879496603347, -1297.7114452223043, -1167.3496540446922, -645.0976381740772, -1203.4618431783488, -709.7003949644946, -613.1495842350436, -835.9798291913141, -850.443069089575, -3.6291436390535283, -1243.83341913458, -326.5921106403429, -910.6961620523821, -724.8546360774344, -75.23691805977863, -146.8823768795824, -545.1285219444183, -21.869331152718097, -801.0338927939383, -1083.4444351121872, -753.7653595379333, -627.7587066569291, -709.2916548292825, -465.358698128852, -821.3401971583329, -1140.902540992775, -62.123060367354064, -918.3395801153313, -1193.3710153267377, -926.8860703981732, -22.030311599829872, -790.38227062668, -903.7916888104168, -1130.1318292607177, -511.3876379291361, -339.71520133884684, -739.6122572068363, -452.86321230029074, -417.86721249002994, -637.4637244294211, -576.8101028926269, -899.9212403257766, -435.8365828391019, -737.0614228594732, -753.3649259228374, -450.162153566508, -855.5598624224777, -499.0280915388382, -948.9044243774443, -1213.288906436375, -274.55117589560217, -68.69533508060842, -907.1814618016251, -678.4707518213833, -687.392753468711, -1177.1070084172425, -380.0807066035672, -854.5235788585529, -438.8724304268386, -568.4198027885506, -256.8789984642614, -415.9232327640397, -708.1552637730714, -372.1915730781434, -496.28482717834834], "episode_lengths": [150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 141, 150, 69, 150, 125, 150, 124, 140, 150, 150, 150, 150, 150, 150, 100, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 138, 150, 150, 66, 77, 135, 49, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 61, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 113, 150, 141, 150, 150, 98, 64, 150, 150, 150, 150, 150, 150, 150, 150, 80, 116, 150, 150, 150], "policy_policy_0_reward": [-557.2152337675963, -803.3344884458834, -925.2047210019225, -933.2429107979167, -1074.7222197723677, -739.2536854651601, -97.42591545866829, -652.8297151535344, -846.2957941522517, -1015.7147093681658, -1229.0840090260026, -1170.5520266604583, -705.4830918778039, -834.9686154427482, -271.9677269666769, -1226.905570285303, -1329.829627437029, -795.3007803510595, -430.14394980775006, -855.4417135661337, -44.507016785840456, -793.865601470055, -554.6371219699636, -490.9908832137166, -211.3507718464501, -683.5720862410657, -1082.7048041116386, -1296.2752323746627, -808.339638354789, -1080.628876383479, -937.1448685497978, -687.8437469950512, -178.85872285794412, -253.74694549816417, -1245.0399345911721, -388.3879496603347, -1297.7114452223043, -1167.3496540446922, -645.0976381740772, -1203.4618431783488, -709.7003949644946, -613.1495842350436, -835.9798291913141, -850.443069089575, -3.6291436390535283, -1243.83341913458, -326.5921106403429, -910.6961620523821, -724.8546360774344, -75.23691805977863, -146.8823768795824, -545.1285219444183, -21.869331152718097, -801.0338927939383, -1083.4444351121872, -753.7653595379333, -627.7587066569291, -709.2916548292825, -465.358698128852, -821.3401971583329, -1140.902540992775, -62.123060367354064, -918.3395801153313, -1193.3710153267377, -926.8860703981732, -22.030311599829872, -790.38227062668, -903.7916888104168, -1130.1318292607177, -511.3876379291361, -339.71520133884684, -739.6122572068363, -452.86321230029074, -417.86721249002994, -637.4637244294211, -576.8101028926269, -899.9212403257766, -435.8365828391019, -737.0614228594732, -753.3649259228374, -450.162153566508, -855.5598624224777, -499.0280915388382, -948.9044243774443, -1213.288906436375, -274.55117589560217, -68.69533508060842, -907.1814618016251, -678.4707518213833, -687.392753468711, -1177.1070084172425, -380.0807066035672, -854.5235788585529, -438.8724304268386, -568.4198027885506, -256.8789984642614, -415.9232327640397, -708.1552637730714, -372.1915730781434, -496.28482717834834]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556570671331587, "mean_inference_ms": 1.688951685496692, "mean_action_processing_ms": 0.2819726732097403, "mean_env_wait_ms": 3.032674017247818, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01172327995300293, "StateBufferConnector_ms": 0.007850885391235352, "ViewRequirementAgentConnector_ms": 0.19158005714416504}, "num_episodes": 27, "episode_return_max": -3.6291436390535283, "episode_return_min": -1329.829627437029, "episode_return_mean": -696.5795395440074, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.4772073696292, "num_env_steps_trained_throughput_per_sec": 304.4772073696292, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12912.023, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12911.953, "sample_time_ms": 1076.071, "learn_time_ms": 11770.577, "learn_throughput": 339.83, "synch_weights_time_ms": 64.519}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00015", "date": "2024-08-03_04-58-50", "timestamp": 1722641330, "time_this_iter_s": 13.150382995605469, "time_total_s": 204.13736534118652, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b32766200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 204.13736534118652, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.510526315789473, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70.16696355839571, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.854062960545222, "policy_loss": -0.00902002530444103, "vf_loss": 5.857015778869391, "vf_explained_var": 0.8863006368279457, "kl": 0.013515389079384477, "entropy": 1.4711247973144055, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -3.6291436390535283, "episode_reward_min": -1369.6835411300754, "episode_reward_mean": -719.1466390324781, "episode_len_mean": 138.18, "episode_media": {}, "episodes_timesteps_total": 13818, "policy_reward_min": {"policy_0": -1369.6835411300754}, "policy_reward_max": {"policy_0": -3.6291436390535283}, "policy_reward_mean": {"policy_0": -719.1466390324781}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.339638354789, -1080.628876383479, -937.1448685497978, -687.8437469950512, -178.85872285794412, -253.74694549816417, -1245.0399345911721, -388.3879496603347, -1297.7114452223043, -1167.3496540446922, -645.0976381740772, -1203.4618431783488, -709.7003949644946, -613.1495842350436, -835.9798291913141, -850.443069089575, -3.6291436390535283, -1243.83341913458, -326.5921106403429, -910.6961620523821, -724.8546360774344, -75.23691805977863, -146.8823768795824, -545.1285219444183, -21.869331152718097, -801.0338927939383, -1083.4444351121872, -753.7653595379333, -627.7587066569291, -709.2916548292825, -465.358698128852, -821.3401971583329, -1140.902540992775, -62.123060367354064, -918.3395801153313, -1193.3710153267377, -926.8860703981732, -22.030311599829872, -790.38227062668, -903.7916888104168, -1130.1318292607177, -511.3876379291361, -339.71520133884684, -739.6122572068363, -452.86321230029074, -417.86721249002994, -637.4637244294211, -576.8101028926269, -899.9212403257766, -435.8365828391019, -737.0614228594732, -753.3649259228374, -450.162153566508, -855.5598624224777, -499.0280915388382, -948.9044243774443, -1213.288906436375, -274.55117589560217, -68.69533508060842, -907.1814618016251, -678.4707518213833, -687.392753468711, -1177.1070084172425, -380.0807066035672, -854.5235788585529, -438.8724304268386, -568.4198027885506, -256.8789984642614, -415.9232327640397, -708.1552637730714, -372.1915730781434, -496.28482717834834, -933.7751490030023, -854.5597962704617, -1093.4379604679064, -694.0782111119366, -875.3245465357455, -949.4638197465466, -823.1639505409779, -718.7678364966032, -1369.6835411300754, -1016.3209989756905, -972.5944348314885, -897.006619904928, -1051.0176995596416, -731.9256341925118, -1277.7067162106591, -891.7886485645392, -571.8500857438073, -444.53913095030987, -1190.9756475457255, -1239.7706023583846, -1009.7852219699414, -695.2583548190189, -822.5433188397218, -994.3995013709043, -514.6182630143022, -135.9911763490712, -441.68916354076123, -697.4939416202362], "episode_lengths": [150, 150, 150, 150, 100, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 138, 150, 150, 66, 77, 135, 49, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 61, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 113, 150, 141, 150, 150, 98, 64, 150, 150, 150, 150, 150, 150, 150, 150, 80, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150], "policy_policy_0_reward": [-808.339638354789, -1080.628876383479, -937.1448685497978, -687.8437469950512, -178.85872285794412, -253.74694549816417, -1245.0399345911721, -388.3879496603347, -1297.7114452223043, -1167.3496540446922, -645.0976381740772, -1203.4618431783488, -709.7003949644946, -613.1495842350436, -835.9798291913141, -850.443069089575, -3.6291436390535283, -1243.83341913458, -326.5921106403429, -910.6961620523821, -724.8546360774344, -75.23691805977863, -146.8823768795824, -545.1285219444183, -21.869331152718097, -801.0338927939383, -1083.4444351121872, -753.7653595379333, -627.7587066569291, -709.2916548292825, -465.358698128852, -821.3401971583329, -1140.902540992775, -62.123060367354064, -918.3395801153313, -1193.3710153267377, -926.8860703981732, -22.030311599829872, -790.38227062668, -903.7916888104168, -1130.1318292607177, -511.3876379291361, -339.71520133884684, -739.6122572068363, -452.86321230029074, -417.86721249002994, -637.4637244294211, -576.8101028926269, -899.9212403257766, -435.8365828391019, -737.0614228594732, -753.3649259228374, -450.162153566508, -855.5598624224777, -499.0280915388382, -948.9044243774443, -1213.288906436375, -274.55117589560217, -68.69533508060842, -907.1814618016251, -678.4707518213833, -687.392753468711, -1177.1070084172425, -380.0807066035672, -854.5235788585529, -438.8724304268386, -568.4198027885506, -256.8789984642614, -415.9232327640397, -708.1552637730714, -372.1915730781434, -496.28482717834834, -933.7751490030023, -854.5597962704617, -1093.4379604679064, -694.0782111119366, -875.3245465357455, -949.4638197465466, -823.1639505409779, -718.7678364966032, -1369.6835411300754, -1016.3209989756905, -972.5944348314885, -897.006619904928, -1051.0176995596416, -731.9256341925118, -1277.7067162106591, -891.7886485645392, -571.8500857438073, -444.53913095030987, -1190.9756475457255, -1239.7706023583846, -1009.7852219699414, -695.2583548190189, -822.5433188397218, -994.3995013709043, -514.6182630143022, -135.9911763490712, -441.68916354076123, -697.4939416202362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.555537528818817, "mean_inference_ms": 1.6888082979556085, "mean_action_processing_ms": 0.2818440232108356, "mean_env_wait_ms": 3.033144481014399, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011631488800048828, "StateBufferConnector_ms": 0.007866144180297852, "ViewRequirementAgentConnector_ms": 0.19083476066589355}, "num_episodes": 28, "episode_return_max": -3.6291436390535283, "episode_return_min": -1369.6835411300754, "episode_return_mean": -719.1466390324781, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.78957491192836, "num_env_steps_trained_throughput_per_sec": 328.78957491192836, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12800.914, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12800.843, "sample_time_ms": 1075.165, "learn_time_ms": 11661.079, "learn_throughput": 343.021, "synch_weights_time_ms": 63.806}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00015", "date": "2024-08-03_04-59-03", "timestamp": 1722641343, "time_this_iter_s": 12.177857637405396, "time_total_s": 216.31522297859192, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f4ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 216.31522297859192, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.68333333333333, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70.59749944408735, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.853953556964795, "policy_loss": -0.01666624563416311, "vf_loss": 5.864438942819834, "vf_explained_var": 0.90221907881399, "kl": 0.013769608277349733, "entropy": 1.5477289711435636, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -22.030311599829872, "episode_reward_min": -1369.6835411300754, "episode_reward_mean": -711.3755094440802, "episode_len_mean": 139.78, "episode_media": {}, "episodes_timesteps_total": 13978, "policy_reward_min": {"policy_0": -1369.6835411300754}, "policy_reward_max": {"policy_0": -22.030311599829872}, "policy_reward_mean": {"policy_0": -711.3755094440802}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-465.358698128852, -821.3401971583329, -1140.902540992775, -62.123060367354064, -918.3395801153313, -1193.3710153267377, -926.8860703981732, -22.030311599829872, -790.38227062668, -903.7916888104168, -1130.1318292607177, -511.3876379291361, -339.71520133884684, -739.6122572068363, -452.86321230029074, -417.86721249002994, -637.4637244294211, -576.8101028926269, -899.9212403257766, -435.8365828391019, -737.0614228594732, -753.3649259228374, -450.162153566508, -855.5598624224777, -499.0280915388382, -948.9044243774443, -1213.288906436375, -274.55117589560217, -68.69533508060842, -907.1814618016251, -678.4707518213833, -687.392753468711, -1177.1070084172425, -380.0807066035672, -854.5235788585529, -438.8724304268386, -568.4198027885506, -256.8789984642614, -415.9232327640397, -708.1552637730714, -372.1915730781434, -496.28482717834834, -933.7751490030023, -854.5597962704617, -1093.4379604679064, -694.0782111119366, -875.3245465357455, -949.4638197465466, -823.1639505409779, -718.7678364966032, -1369.6835411300754, -1016.3209989756905, -972.5944348314885, -897.006619904928, -1051.0176995596416, -731.9256341925118, -1277.7067162106591, -891.7886485645392, -571.8500857438073, -444.53913095030987, -1190.9756475457255, -1239.7706023583846, -1009.7852219699414, -695.2583548190189, -822.5433188397218, -994.3995013709043, -514.6182630143022, -135.9911763490712, -441.68916354076123, -697.4939416202362, -949.6402707631477, -615.7913829411299, -990.7233559181183, -862.4391937301376, -393.086517568848, -126.6099073356872, -1078.9086205459382, -361.20280984440814, -565.9750178577812, -1261.5483639736472, -411.37815030639337, -970.2932318709074, -343.63778236703627, -697.586078456517, -823.4938810008427, -591.640091673224, -409.53166621410304, -774.9643944980864, -854.7911378466702, -905.2424562088825, -1081.0923538668135, -1014.4272909749965, -812.5270418126719, -66.39505155480992, -293.01204517529084, -529.0472948889692, -111.67904589981337, -778.209197410596, -604.8398916063272, -820.0743265495505], "episode_lengths": [150, 150, 150, 52, 150, 150, 150, 61, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 113, 150, 141, 150, 150, 98, 64, 150, 150, 150, 150, 150, 150, 150, 150, 80, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 80, 150, 128, 129, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 67, 141, 124, 81, 150, 150, 150], "policy_policy_0_reward": [-465.358698128852, -821.3401971583329, -1140.902540992775, -62.123060367354064, -918.3395801153313, -1193.3710153267377, -926.8860703981732, -22.030311599829872, -790.38227062668, -903.7916888104168, -1130.1318292607177, -511.3876379291361, -339.71520133884684, -739.6122572068363, -452.86321230029074, -417.86721249002994, -637.4637244294211, -576.8101028926269, -899.9212403257766, -435.8365828391019, -737.0614228594732, -753.3649259228374, -450.162153566508, -855.5598624224777, -499.0280915388382, -948.9044243774443, -1213.288906436375, -274.55117589560217, -68.69533508060842, -907.1814618016251, -678.4707518213833, -687.392753468711, -1177.1070084172425, -380.0807066035672, -854.5235788585529, -438.8724304268386, -568.4198027885506, -256.8789984642614, -415.9232327640397, -708.1552637730714, -372.1915730781434, -496.28482717834834, -933.7751490030023, -854.5597962704617, -1093.4379604679064, -694.0782111119366, -875.3245465357455, -949.4638197465466, -823.1639505409779, -718.7678364966032, -1369.6835411300754, -1016.3209989756905, -972.5944348314885, -897.006619904928, -1051.0176995596416, -731.9256341925118, -1277.7067162106591, -891.7886485645392, -571.8500857438073, -444.53913095030987, -1190.9756475457255, -1239.7706023583846, -1009.7852219699414, -695.2583548190189, -822.5433188397218, -994.3995013709043, -514.6182630143022, -135.9911763490712, -441.68916354076123, -697.4939416202362, -949.6402707631477, -615.7913829411299, -990.7233559181183, -862.4391937301376, -393.086517568848, -126.6099073356872, -1078.9086205459382, -361.20280984440814, -565.9750178577812, -1261.5483639736472, -411.37815030639337, -970.2932318709074, -343.63778236703627, -697.586078456517, -823.4938810008427, -591.640091673224, -409.53166621410304, -774.9643944980864, -854.7911378466702, -905.2424562088825, -1081.0923538668135, -1014.4272909749965, -812.5270418126719, -66.39505155480992, -293.01204517529084, -529.0472948889692, -111.67904589981337, -778.209197410596, -604.8398916063272, -820.0743265495505]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5546744161272209, "mean_inference_ms": 1.6867850435420573, "mean_action_processing_ms": 0.2815687518489387, "mean_env_wait_ms": 3.034625301286261, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011565446853637695, "StateBufferConnector_ms": 0.00793766975402832, "ViewRequirementAgentConnector_ms": 0.19296860694885254}, "num_episodes": 30, "episode_return_max": -22.030311599829872, "episode_return_min": -1369.6835411300754, "episode_return_mean": -711.3755094440802, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.38028616255843, "num_env_steps_trained_throughput_per_sec": 313.38028616255843, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12748.811, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12748.74, "sample_time_ms": 1077.69, "learn_time_ms": 11607.252, "learn_throughput": 344.612, "synch_weights_time_ms": 63.011}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00015", "date": "2024-08-03_04-59-15", "timestamp": 1722641355, "time_this_iter_s": 12.77579665184021, "time_total_s": 229.09101963043213, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b32765360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 229.09101963043213, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.65555555555555, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 88.6707580268383, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.479738583415747, "policy_loss": -0.019811655819648877, "vf_loss": 5.491594487677018, "vf_explained_var": 0.9348510089640816, "kl": 0.01771238012570393, "entropy": 1.4823303955296676, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -66.39505155480992, "episode_reward_min": -1370.5076492912642, "episode_reward_mean": -727.6343427577317, "episode_len_mean": 140.34, "episode_media": {}, "episodes_timesteps_total": 14034, "policy_reward_min": {"policy_0": -1370.5076492912642}, "policy_reward_max": {"policy_0": -66.39505155480992}, "policy_reward_mean": {"policy_0": -727.6343427577317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-687.392753468711, -1177.1070084172425, -380.0807066035672, -854.5235788585529, -438.8724304268386, -568.4198027885506, -256.8789984642614, -415.9232327640397, -708.1552637730714, -372.1915730781434, -496.28482717834834, -933.7751490030023, -854.5597962704617, -1093.4379604679064, -694.0782111119366, -875.3245465357455, -949.4638197465466, -823.1639505409779, -718.7678364966032, -1369.6835411300754, -1016.3209989756905, -972.5944348314885, -897.006619904928, -1051.0176995596416, -731.9256341925118, -1277.7067162106591, -891.7886485645392, -571.8500857438073, -444.53913095030987, -1190.9756475457255, -1239.7706023583846, -1009.7852219699414, -695.2583548190189, -822.5433188397218, -994.3995013709043, -514.6182630143022, -135.9911763490712, -441.68916354076123, -697.4939416202362, -949.6402707631477, -615.7913829411299, -990.7233559181183, -862.4391937301376, -393.086517568848, -126.6099073356872, -1078.9086205459382, -361.20280984440814, -565.9750178577812, -1261.5483639736472, -411.37815030639337, -970.2932318709074, -343.63778236703627, -697.586078456517, -823.4938810008427, -591.640091673224, -409.53166621410304, -774.9643944980864, -854.7911378466702, -905.2424562088825, -1081.0923538668135, -1014.4272909749965, -812.5270418126719, -66.39505155480992, -293.01204517529084, -529.0472948889692, -111.67904589981337, -778.209197410596, -604.8398916063272, -820.0743265495505, -1014.2071392252087, -1000.9919988389643, -1370.5076492912642, -100.37123326453457, -928.0177659996848, -931.1359316211207, -805.5487560496456, -288.74597173880596, -906.8227309445563, -1080.682554858423, -972.1776298305451, -1132.8487319046258, -650.0856095493983, -173.94366148052853, -251.74355074667557, -358.07030238523527, -706.9353895425122, -793.5680704468939, -236.14249716579204, -154.81883798293597, -976.4353295208836, -1072.320876969872, -486.5487433584107, -478.7626785267572, -882.6516166374961, -289.3222928626798, -1326.5135000341172, -716.1471858211669, -85.21537195329401, -946.7856988344647, -1280.216970239106], "episode_lengths": [150, 150, 150, 150, 150, 150, 80, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 109, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 80, 150, 128, 129, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 67, 141, 124, 81, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 117, 150, 150, 150, 150, 150, 100, 93, 150, 150, 150, 119, 83, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150], "policy_policy_0_reward": [-687.392753468711, -1177.1070084172425, -380.0807066035672, -854.5235788585529, -438.8724304268386, -568.4198027885506, -256.8789984642614, -415.9232327640397, -708.1552637730714, -372.1915730781434, -496.28482717834834, -933.7751490030023, -854.5597962704617, -1093.4379604679064, -694.0782111119366, -875.3245465357455, -949.4638197465466, -823.1639505409779, -718.7678364966032, -1369.6835411300754, -1016.3209989756905, -972.5944348314885, -897.006619904928, -1051.0176995596416, -731.9256341925118, -1277.7067162106591, -891.7886485645392, -571.8500857438073, -444.53913095030987, -1190.9756475457255, -1239.7706023583846, -1009.7852219699414, -695.2583548190189, -822.5433188397218, -994.3995013709043, -514.6182630143022, -135.9911763490712, -441.68916354076123, -697.4939416202362, -949.6402707631477, -615.7913829411299, -990.7233559181183, -862.4391937301376, -393.086517568848, -126.6099073356872, -1078.9086205459382, -361.20280984440814, -565.9750178577812, -1261.5483639736472, -411.37815030639337, -970.2932318709074, -343.63778236703627, -697.586078456517, -823.4938810008427, -591.640091673224, -409.53166621410304, -774.9643944980864, -854.7911378466702, -905.2424562088825, -1081.0923538668135, -1014.4272909749965, -812.5270418126719, -66.39505155480992, -293.01204517529084, -529.0472948889692, -111.67904589981337, -778.209197410596, -604.8398916063272, -820.0743265495505, -1014.2071392252087, -1000.9919988389643, -1370.5076492912642, -100.37123326453457, -928.0177659996848, -931.1359316211207, -805.5487560496456, -288.74597173880596, -906.8227309445563, -1080.682554858423, -972.1776298305451, -1132.8487319046258, -650.0856095493983, -173.94366148052853, -251.74355074667557, -358.07030238523527, -706.9353895425122, -793.5680704468939, -236.14249716579204, -154.81883798293597, -976.4353295208836, -1072.320876969872, -486.5487433584107, -478.7626785267572, -882.6516166374961, -289.3222928626798, -1326.5135000341172, -716.1471858211669, -85.21537195329401, -946.7856988344647, -1280.216970239106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540155134263852, "mean_inference_ms": 1.6855667453230445, "mean_action_processing_ms": 0.2811273175854865, "mean_env_wait_ms": 3.037326054126589, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01173090934753418, "StateBufferConnector_ms": 0.008121967315673828, "ViewRequirementAgentConnector_ms": 0.1952955722808838}, "num_episodes": 31, "episode_return_max": -66.39505155480992, "episode_return_min": -1370.5076492912642, "episode_return_mean": -727.6343427577317, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.0427038074532, "num_env_steps_trained_throughput_per_sec": 325.0427038074532, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12693.261, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12693.19, "sample_time_ms": 1077.666, "learn_time_ms": 11551.765, "learn_throughput": 346.267, "synch_weights_time_ms": 62.964}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00015", "date": "2024-08-03_04-59-28", "timestamp": 1722641368, "time_this_iter_s": 12.319461822509766, "time_total_s": 241.4104814529419, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f4ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 241.4104814529419, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.558823529411764, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 120.11460066835086, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.967406844844421, "policy_loss": -0.012791744449835581, "vf_loss": 4.973443552106619, "vf_explained_var": 0.9377012339110176, "kl": 0.015048495243127036, "entropy": 1.6780446399003268, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -51.79147273227773, "episode_reward_min": -1370.5076492912642, "episode_reward_mean": -722.4534354767133, "episode_len_mean": 138.49, "episode_media": {}, "episodes_timesteps_total": 13849, "policy_reward_min": {"policy_0": -1370.5076492912642}, "policy_reward_max": {"policy_0": -51.79147273227773}, "policy_reward_mean": {"policy_0": -722.4534354767133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-444.53913095030987, -1190.9756475457255, -1239.7706023583846, -1009.7852219699414, -695.2583548190189, -822.5433188397218, -994.3995013709043, -514.6182630143022, -135.9911763490712, -441.68916354076123, -697.4939416202362, -949.6402707631477, -615.7913829411299, -990.7233559181183, -862.4391937301376, -393.086517568848, -126.6099073356872, -1078.9086205459382, -361.20280984440814, -565.9750178577812, -1261.5483639736472, -411.37815030639337, -970.2932318709074, -343.63778236703627, -697.586078456517, -823.4938810008427, -591.640091673224, -409.53166621410304, -774.9643944980864, -854.7911378466702, -905.2424562088825, -1081.0923538668135, -1014.4272909749965, -812.5270418126719, -66.39505155480992, -293.01204517529084, -529.0472948889692, -111.67904589981337, -778.209197410596, -604.8398916063272, -820.0743265495505, -1014.2071392252087, -1000.9919988389643, -1370.5076492912642, -100.37123326453457, -928.0177659996848, -931.1359316211207, -805.5487560496456, -288.74597173880596, -906.8227309445563, -1080.682554858423, -972.1776298305451, -1132.8487319046258, -650.0856095493983, -173.94366148052853, -251.74355074667557, -358.07030238523527, -706.9353895425122, -793.5680704468939, -236.14249716579204, -154.81883798293597, -976.4353295208836, -1072.320876969872, -486.5487433584107, -478.7626785267572, -882.6516166374961, -289.3222928626798, -1326.5135000341172, -716.1471858211669, -85.21537195329401, -946.7856988344647, -1280.216970239106, -594.9817039541929, -553.0414982270518, -952.8655425751475, -1053.461075277749, -1057.796732140695, -1000.3082269473432, -51.79147273227773, -1091.0660623995286, -669.3862078499535, -1054.0103430977465, -309.34826154179854, -952.5617737040293, -1053.1194906645385, -482.4019913593468, -964.9850381503961, -977.2335158073488, -815.1511632643612, -521.2131788708441, -191.73254901074012, -1216.1063383912212, -245.8182090299024, -793.0023007647815, -181.5529243733345, -750.7763387427508, -753.2122905399802, -993.9199274190094, -1262.0115615547465, -1017.3493786151953], "episode_lengths": [109, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 80, 150, 128, 129, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 67, 141, 124, 81, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 117, 150, 150, 150, 150, 150, 100, 93, 150, 150, 150, 119, 83, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 134, 150, 150, 150, 150, 59, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 104, 150, 98, 150, 96, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-444.53913095030987, -1190.9756475457255, -1239.7706023583846, -1009.7852219699414, -695.2583548190189, -822.5433188397218, -994.3995013709043, -514.6182630143022, -135.9911763490712, -441.68916354076123, -697.4939416202362, -949.6402707631477, -615.7913829411299, -990.7233559181183, -862.4391937301376, -393.086517568848, -126.6099073356872, -1078.9086205459382, -361.20280984440814, -565.9750178577812, -1261.5483639736472, -411.37815030639337, -970.2932318709074, -343.63778236703627, -697.586078456517, -823.4938810008427, -591.640091673224, -409.53166621410304, -774.9643944980864, -854.7911378466702, -905.2424562088825, -1081.0923538668135, -1014.4272909749965, -812.5270418126719, -66.39505155480992, -293.01204517529084, -529.0472948889692, -111.67904589981337, -778.209197410596, -604.8398916063272, -820.0743265495505, -1014.2071392252087, -1000.9919988389643, -1370.5076492912642, -100.37123326453457, -928.0177659996848, -931.1359316211207, -805.5487560496456, -288.74597173880596, -906.8227309445563, -1080.682554858423, -972.1776298305451, -1132.8487319046258, -650.0856095493983, -173.94366148052853, -251.74355074667557, -358.07030238523527, -706.9353895425122, -793.5680704468939, -236.14249716579204, -154.81883798293597, -976.4353295208836, -1072.320876969872, -486.5487433584107, -478.7626785267572, -882.6516166374961, -289.3222928626798, -1326.5135000341172, -716.1471858211669, -85.21537195329401, -946.7856988344647, -1280.216970239106, -594.9817039541929, -553.0414982270518, -952.8655425751475, -1053.461075277749, -1057.796732140695, -1000.3082269473432, -51.79147273227773, -1091.0660623995286, -669.3862078499535, -1054.0103430977465, -309.34826154179854, -952.5617737040293, -1053.1194906645385, -482.4019913593468, -964.9850381503961, -977.2335158073488, -815.1511632643612, -521.2131788708441, -191.73254901074012, -1216.1063383912212, -245.8182090299024, -793.0023007647815, -181.5529243733345, -750.7763387427508, -753.2122905399802, -993.9199274190094, -1262.0115615547465, -1017.3493786151953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541287634451849, "mean_inference_ms": 1.6861436855192624, "mean_action_processing_ms": 0.28106891686052965, "mean_env_wait_ms": 3.041342341899967, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011691808700561523, "StateBufferConnector_ms": 0.008887767791748047, "ViewRequirementAgentConnector_ms": 0.19670629501342773}, "num_episodes": 28, "episode_return_max": -51.79147273227773, "episode_return_min": -1370.5076492912642, "episode_return_mean": -722.4534354767133, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.13291847862496, "num_env_steps_trained_throughput_per_sec": 309.13291847862496, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12681.858, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12681.784, "sample_time_ms": 1062.21, "learn_time_ms": 11555.881, "learn_throughput": 346.144, "synch_weights_time_ms": 62.86}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00015", "date": "2024-08-03_04-59-41", "timestamp": 1722641381, "time_this_iter_s": 12.951565504074097, "time_total_s": 254.362046957016, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa0040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 254.362046957016, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.44736842105263, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 133.56463083426158, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.712183088809252, "policy_loss": -0.015134133338384951, "vf_loss": 4.7198289978007475, "vf_explained_var": 0.9553260631859303, "kl": 0.016676016821050646, "entropy": 1.5969574719667434, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -8.34760299595261, "episode_reward_min": -1370.5076492912642, "episode_reward_mean": -737.482733986188, "episode_len_mean": 138.93, "episode_media": {}, "episodes_timesteps_total": 13893, "policy_reward_min": {"policy_0": -1370.5076492912642}, "policy_reward_max": {"policy_0": -8.34760299595261}, "policy_reward_mean": {"policy_0": -737.482733986188}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-591.640091673224, -409.53166621410304, -774.9643944980864, -854.7911378466702, -905.2424562088825, -1081.0923538668135, -1014.4272909749965, -812.5270418126719, -66.39505155480992, -293.01204517529084, -529.0472948889692, -111.67904589981337, -778.209197410596, -604.8398916063272, -820.0743265495505, -1014.2071392252087, -1000.9919988389643, -1370.5076492912642, -100.37123326453457, -928.0177659996848, -931.1359316211207, -805.5487560496456, -288.74597173880596, -906.8227309445563, -1080.682554858423, -972.1776298305451, -1132.8487319046258, -650.0856095493983, -173.94366148052853, -251.74355074667557, -358.07030238523527, -706.9353895425122, -793.5680704468939, -236.14249716579204, -154.81883798293597, -976.4353295208836, -1072.320876969872, -486.5487433584107, -478.7626785267572, -882.6516166374961, -289.3222928626798, -1326.5135000341172, -716.1471858211669, -85.21537195329401, -946.7856988344647, -1280.216970239106, -594.9817039541929, -553.0414982270518, -952.8655425751475, -1053.461075277749, -1057.796732140695, -1000.3082269473432, -51.79147273227773, -1091.0660623995286, -669.3862078499535, -1054.0103430977465, -309.34826154179854, -952.5617737040293, -1053.1194906645385, -482.4019913593468, -964.9850381503961, -977.2335158073488, -815.1511632643612, -521.2131788708441, -191.73254901074012, -1216.1063383912212, -245.8182090299024, -793.0023007647815, -181.5529243733345, -750.7763387427508, -753.2122905399802, -993.9199274190094, -1262.0115615547465, -1017.3493786151953, -751.6391233310013, -597.6120224328336, -522.1799613851482, -807.0455060443036, -982.9159805366633, -8.34760299595261, -815.7381019943482, -85.66375445312907, -841.275166950348, -882.494666779135, -1075.591988125136, -856.3313202760316, -950.5698034494565, -712.6757549699612, -918.2362266110418, -1038.2859526132104, -341.92602156636764, -987.8337522442041, -581.3125801449469, -815.6089185521618, -586.03152964106, -1115.7682057385855, -904.0964795869136, -1017.4417488437053, -870.4194011383491, -1075.267167402409], "episode_lengths": [150, 107, 150, 150, 150, 150, 150, 150, 67, 141, 124, 81, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 117, 150, 150, 150, 150, 150, 100, 93, 150, 150, 150, 119, 83, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 134, 150, 150, 150, 150, 59, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 104, 150, 98, 150, 96, 150, 150, 150, 150, 150, 150, 138, 145, 150, 150, 45, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-591.640091673224, -409.53166621410304, -774.9643944980864, -854.7911378466702, -905.2424562088825, -1081.0923538668135, -1014.4272909749965, -812.5270418126719, -66.39505155480992, -293.01204517529084, -529.0472948889692, -111.67904589981337, -778.209197410596, -604.8398916063272, -820.0743265495505, -1014.2071392252087, -1000.9919988389643, -1370.5076492912642, -100.37123326453457, -928.0177659996848, -931.1359316211207, -805.5487560496456, -288.74597173880596, -906.8227309445563, -1080.682554858423, -972.1776298305451, -1132.8487319046258, -650.0856095493983, -173.94366148052853, -251.74355074667557, -358.07030238523527, -706.9353895425122, -793.5680704468939, -236.14249716579204, -154.81883798293597, -976.4353295208836, -1072.320876969872, -486.5487433584107, -478.7626785267572, -882.6516166374961, -289.3222928626798, -1326.5135000341172, -716.1471858211669, -85.21537195329401, -946.7856988344647, -1280.216970239106, -594.9817039541929, -553.0414982270518, -952.8655425751475, -1053.461075277749, -1057.796732140695, -1000.3082269473432, -51.79147273227773, -1091.0660623995286, -669.3862078499535, -1054.0103430977465, -309.34826154179854, -952.5617737040293, -1053.1194906645385, -482.4019913593468, -964.9850381503961, -977.2335158073488, -815.1511632643612, -521.2131788708441, -191.73254901074012, -1216.1063383912212, -245.8182090299024, -793.0023007647815, -181.5529243733345, -750.7763387427508, -753.2122905399802, -993.9199274190094, -1262.0115615547465, -1017.3493786151953, -751.6391233310013, -597.6120224328336, -522.1799613851482, -807.0455060443036, -982.9159805366633, -8.34760299595261, -815.7381019943482, -85.66375445312907, -841.275166950348, -882.494666779135, -1075.591988125136, -856.3313202760316, -950.5698034494565, -712.6757549699612, -918.2362266110418, -1038.2859526132104, -341.92602156636764, -987.8337522442041, -581.3125801449469, -815.6089185521618, -586.03152964106, -1115.7682057385855, -904.0964795869136, -1017.4417488437053, -870.4194011383491, -1075.267167402409]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541708368995546, "mean_inference_ms": 1.6856102001000364, "mean_action_processing_ms": 0.2809353603748143, "mean_env_wait_ms": 3.0430926736346424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011541128158569336, "StateBufferConnector_ms": 0.008817195892333984, "ViewRequirementAgentConnector_ms": 0.1944897174835205}, "num_episodes": 26, "episode_return_max": -8.34760299595261, "episode_return_min": -1370.5076492912642, "episode_return_mean": -737.482733986188, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 406.34831073830554, "num_env_steps_trained_throughput_per_sec": 406.34831073830554, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12362.191, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12362.117, "sample_time_ms": 1060.205, "learn_time_ms": 11237.665, "learn_throughput": 355.946, "synch_weights_time_ms": 63.4}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00015", "date": "2024-08-03_04-59-51", "timestamp": 1722641391, "time_this_iter_s": 9.855323791503906, "time_total_s": 264.2173707485199, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f7760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 264.2173707485199, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 19.57857142857143, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 153.77845456401508, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.058307300756375, "policy_loss": -0.016184154357082054, "vf_loss": 5.066731688131889, "vf_explained_var": 0.9556956711535652, "kl": 0.017284722275144326, "entropy": 1.8360176290074983, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -8.34760299595261, "episode_reward_min": -1363.4194222335211, "episode_reward_mean": -749.523563116066, "episode_len_mean": 140.09, "episode_media": {}, "episodes_timesteps_total": 14009, "policy_reward_min": {"policy_0": -1363.4194222335211}, "policy_reward_max": {"policy_0": -8.34760299595261}, "policy_reward_mean": {"policy_0": -749.523563116066}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1132.8487319046258, -650.0856095493983, -173.94366148052853, -251.74355074667557, -358.07030238523527, -706.9353895425122, -793.5680704468939, -236.14249716579204, -154.81883798293597, -976.4353295208836, -1072.320876969872, -486.5487433584107, -478.7626785267572, -882.6516166374961, -289.3222928626798, -1326.5135000341172, -716.1471858211669, -85.21537195329401, -946.7856988344647, -1280.216970239106, -594.9817039541929, -553.0414982270518, -952.8655425751475, -1053.461075277749, -1057.796732140695, -1000.3082269473432, -51.79147273227773, -1091.0660623995286, -669.3862078499535, -1054.0103430977465, -309.34826154179854, -952.5617737040293, -1053.1194906645385, -482.4019913593468, -964.9850381503961, -977.2335158073488, -815.1511632643612, -521.2131788708441, -191.73254901074012, -1216.1063383912212, -245.8182090299024, -793.0023007647815, -181.5529243733345, -750.7763387427508, -753.2122905399802, -993.9199274190094, -1262.0115615547465, -1017.3493786151953, -751.6391233310013, -597.6120224328336, -522.1799613851482, -807.0455060443036, -982.9159805366633, -8.34760299595261, -815.7381019943482, -85.66375445312907, -841.275166950348, -882.494666779135, -1075.591988125136, -856.3313202760316, -950.5698034494565, -712.6757549699612, -918.2362266110418, -1038.2859526132104, -341.92602156636764, -987.8337522442041, -581.3125801449469, -815.6089185521618, -586.03152964106, -1115.7682057385855, -904.0964795869136, -1017.4417488437053, -870.4194011383491, -1075.267167402409, -692.1098197064214, -715.5702744804, -1028.1411858653, -1363.4194222335211, -1205.4183441644498, -749.1332819317672, -472.8366123482494, -740.2510183232735, -305.5899351002759, -1080.9918593771313, -591.1976663176507, -971.5589677275001, -172.94225910470576, -1006.2922054277806, -1104.5826388085684, -567.452792021326, -119.34451935020624, -970.1849632574588, -969.4930214119838, -834.6472951854254, -206.5878279088119, -854.1580986266777, -905.9057454216037, -1300.7240576913898, -504.573782434004, -817.6579666054587], "episode_lengths": [150, 150, 100, 93, 150, 150, 150, 119, 83, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 134, 150, 150, 150, 150, 59, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 104, 150, 98, 150, 96, 150, 150, 150, 150, 150, 150, 138, 145, 150, 150, 45, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 95, 150, 150, 150, 76, 150, 150, 150, 106, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1132.8487319046258, -650.0856095493983, -173.94366148052853, -251.74355074667557, -358.07030238523527, -706.9353895425122, -793.5680704468939, -236.14249716579204, -154.81883798293597, -976.4353295208836, -1072.320876969872, -486.5487433584107, -478.7626785267572, -882.6516166374961, -289.3222928626798, -1326.5135000341172, -716.1471858211669, -85.21537195329401, -946.7856988344647, -1280.216970239106, -594.9817039541929, -553.0414982270518, -952.8655425751475, -1053.461075277749, -1057.796732140695, -1000.3082269473432, -51.79147273227773, -1091.0660623995286, -669.3862078499535, -1054.0103430977465, -309.34826154179854, -952.5617737040293, -1053.1194906645385, -482.4019913593468, -964.9850381503961, -977.2335158073488, -815.1511632643612, -521.2131788708441, -191.73254901074012, -1216.1063383912212, -245.8182090299024, -793.0023007647815, -181.5529243733345, -750.7763387427508, -753.2122905399802, -993.9199274190094, -1262.0115615547465, -1017.3493786151953, -751.6391233310013, -597.6120224328336, -522.1799613851482, -807.0455060443036, -982.9159805366633, -8.34760299595261, -815.7381019943482, -85.66375445312907, -841.275166950348, -882.494666779135, -1075.591988125136, -856.3313202760316, -950.5698034494565, -712.6757549699612, -918.2362266110418, -1038.2859526132104, -341.92602156636764, -987.8337522442041, -581.3125801449469, -815.6089185521618, -586.03152964106, -1115.7682057385855, -904.0964795869136, -1017.4417488437053, -870.4194011383491, -1075.267167402409, -692.1098197064214, -715.5702744804, -1028.1411858653, -1363.4194222335211, -1205.4183441644498, -749.1332819317672, -472.8366123482494, -740.2510183232735, -305.5899351002759, -1080.9918593771313, -591.1976663176507, -971.5589677275001, -172.94225910470576, -1006.2922054277806, -1104.5826388085684, -567.452792021326, -119.34451935020624, -970.1849632574588, -969.4930214119838, -834.6472951854254, -206.5878279088119, -854.1580986266777, -905.9057454216037, -1300.7240576913898, -504.573782434004, -817.6579666054587]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543883520989109, "mean_inference_ms": 1.6849661905163202, "mean_action_processing_ms": 0.28081855315549276, "mean_env_wait_ms": 3.043986736362497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011490106582641602, "StateBufferConnector_ms": 0.009160280227661133, "ViewRequirementAgentConnector_ms": 0.199845552444458}, "num_episodes": 26, "episode_return_max": -8.34760299595261, "episode_return_min": -1363.4194222335211, "episode_return_mean": -749.523563116066, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.2908967810706, "num_env_steps_trained_throughput_per_sec": 328.2908967810706, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12280.407, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12280.333, "sample_time_ms": 1061.411, "learn_time_ms": 11152.373, "learn_throughput": 358.668, "synch_weights_time_ms": 65.69}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00015", "date": "2024-08-03_05-00-03", "timestamp": 1722641403, "time_this_iter_s": 12.19761347770691, "time_total_s": 276.4149842262268, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa2c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 276.4149842262268, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.96470588235294, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 131.9254099826018, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.140912775198618, "policy_loss": -0.013260200496491355, "vf_loss": 5.147200021892786, "vf_explained_var": 0.9609848755101363, "kl": 0.015531607131318525, "entropy": 1.6262900015960138, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -8.34760299595261, "episode_reward_min": -1475.0874042992489, "episode_reward_mean": -796.3457412299852, "episode_len_mean": 140.76, "episode_media": {}, "episodes_timesteps_total": 14076, "policy_reward_min": {"policy_0": -1475.0874042992489}, "policy_reward_max": {"policy_0": -8.34760299595261}, "policy_reward_mean": {"policy_0": -796.3457412299852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-952.5617737040293, -1053.1194906645385, -482.4019913593468, -964.9850381503961, -977.2335158073488, -815.1511632643612, -521.2131788708441, -191.73254901074012, -1216.1063383912212, -245.8182090299024, -793.0023007647815, -181.5529243733345, -750.7763387427508, -753.2122905399802, -993.9199274190094, -1262.0115615547465, -1017.3493786151953, -751.6391233310013, -597.6120224328336, -522.1799613851482, -807.0455060443036, -982.9159805366633, -8.34760299595261, -815.7381019943482, -85.66375445312907, -841.275166950348, -882.494666779135, -1075.591988125136, -856.3313202760316, -950.5698034494565, -712.6757549699612, -918.2362266110418, -1038.2859526132104, -341.92602156636764, -987.8337522442041, -581.3125801449469, -815.6089185521618, -586.03152964106, -1115.7682057385855, -904.0964795869136, -1017.4417488437053, -870.4194011383491, -1075.267167402409, -692.1098197064214, -715.5702744804, -1028.1411858653, -1363.4194222335211, -1205.4183441644498, -749.1332819317672, -472.8366123482494, -740.2510183232735, -305.5899351002759, -1080.9918593771313, -591.1976663176507, -971.5589677275001, -172.94225910470576, -1006.2922054277806, -1104.5826388085684, -567.452792021326, -119.34451935020624, -970.1849632574588, -969.4930214119838, -834.6472951854254, -206.5878279088119, -854.1580986266777, -905.9057454216037, -1300.7240576913898, -504.573782434004, -817.6579666054587, -769.2185681571843, -1306.0887054648545, -562.7718370726805, -1247.8774091037071, -682.8344213326337, -1143.4821133227542, -189.75929900429927, -88.85002418960283, -888.3659842778387, -596.3833796791337, -1106.790865323369, -1261.1691654221752, -1102.5562928148793, -938.6242038644442, -634.0406657392301, -586.9535381054466, -1037.0512205889252, -529.9909488862279, -153.3129717442768, -1257.829016364476, -506.7905823884637, -867.4706671052933, -916.9076887899799, -1447.1336945646444, -120.8166769989651, -1418.7821886277482, -1019.3933005913029, -1009.994035479361, -1475.0874042992489, -277.9251572965793, -925.0998274985104], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 104, 150, 98, 150, 96, 150, 150, 150, 150, 150, 150, 138, 145, 150, 150, 45, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 95, 150, 150, 150, 76, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 52, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 93, 150], "policy_policy_0_reward": [-952.5617737040293, -1053.1194906645385, -482.4019913593468, -964.9850381503961, -977.2335158073488, -815.1511632643612, -521.2131788708441, -191.73254901074012, -1216.1063383912212, -245.8182090299024, -793.0023007647815, -181.5529243733345, -750.7763387427508, -753.2122905399802, -993.9199274190094, -1262.0115615547465, -1017.3493786151953, -751.6391233310013, -597.6120224328336, -522.1799613851482, -807.0455060443036, -982.9159805366633, -8.34760299595261, -815.7381019943482, -85.66375445312907, -841.275166950348, -882.494666779135, -1075.591988125136, -856.3313202760316, -950.5698034494565, -712.6757549699612, -918.2362266110418, -1038.2859526132104, -341.92602156636764, -987.8337522442041, -581.3125801449469, -815.6089185521618, -586.03152964106, -1115.7682057385855, -904.0964795869136, -1017.4417488437053, -870.4194011383491, -1075.267167402409, -692.1098197064214, -715.5702744804, -1028.1411858653, -1363.4194222335211, -1205.4183441644498, -749.1332819317672, -472.8366123482494, -740.2510183232735, -305.5899351002759, -1080.9918593771313, -591.1976663176507, -971.5589677275001, -172.94225910470576, -1006.2922054277806, -1104.5826388085684, -567.452792021326, -119.34451935020624, -970.1849632574588, -969.4930214119838, -834.6472951854254, -206.5878279088119, -854.1580986266777, -905.9057454216037, -1300.7240576913898, -504.573782434004, -817.6579666054587, -769.2185681571843, -1306.0887054648545, -562.7718370726805, -1247.8774091037071, -682.8344213326337, -1143.4821133227542, -189.75929900429927, -88.85002418960283, -888.3659842778387, -596.3833796791337, -1106.790865323369, -1261.1691654221752, -1102.5562928148793, -938.6242038644442, -634.0406657392301, -586.9535381054466, -1037.0512205889252, -529.9909488862279, -153.3129717442768, -1257.829016364476, -506.7905823884637, -867.4706671052933, -916.9076887899799, -1447.1336945646444, -120.8166769989651, -1418.7821886277482, -1019.3933005913029, -1009.994035479361, -1475.0874042992489, -277.9251572965793, -925.0998274985104]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540555671618533, "mean_inference_ms": 1.6838749204151235, "mean_action_processing_ms": 0.28058257821512617, "mean_env_wait_ms": 3.0476782497121264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011459589004516602, "StateBufferConnector_ms": 0.008317232131958008, "ViewRequirementAgentConnector_ms": 0.19635415077209473}, "num_episodes": 31, "episode_return_max": -8.34760299595261, "episode_return_min": -1475.0874042992489, "episode_return_mean": -796.3457412299852, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.233753140282, "num_env_steps_trained_throughput_per_sec": 318.233753140282, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12367.871, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12367.8, "sample_time_ms": 1067.535, "learn_time_ms": 11233.128, "learn_throughput": 356.09, "synch_weights_time_ms": 66.278}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00015", "date": "2024-08-03_05-00-16", "timestamp": 1722641416, "time_this_iter_s": 12.582993984222412, "time_total_s": 288.9979782104492, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa3a30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 288.9979782104492, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.988888888888887, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 159.4383446455002, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.53418526922663, "policy_loss": -0.013576060764899011, "vf_loss": 4.541954089452823, "vf_explained_var": 0.9514836933463812, "kl": 0.012930497567261555, "entropy": 1.1477623752628763, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -88.85002418960283, "episode_reward_min": -1475.0874042992489, "episode_reward_mean": -784.3633822931148, "episode_len_mean": 141.78, "episode_media": {}, "episodes_timesteps_total": 14178, "policy_reward_min": {"policy_0": -1475.0874042992489}, "policy_reward_max": {"policy_0": -88.85002418960283}, "policy_reward_mean": {"policy_0": -784.3633822931148}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-712.6757549699612, -918.2362266110418, -1038.2859526132104, -341.92602156636764, -987.8337522442041, -581.3125801449469, -815.6089185521618, -586.03152964106, -1115.7682057385855, -904.0964795869136, -1017.4417488437053, -870.4194011383491, -1075.267167402409, -692.1098197064214, -715.5702744804, -1028.1411858653, -1363.4194222335211, -1205.4183441644498, -749.1332819317672, -472.8366123482494, -740.2510183232735, -305.5899351002759, -1080.9918593771313, -591.1976663176507, -971.5589677275001, -172.94225910470576, -1006.2922054277806, -1104.5826388085684, -567.452792021326, -119.34451935020624, -970.1849632574588, -969.4930214119838, -834.6472951854254, -206.5878279088119, -854.1580986266777, -905.9057454216037, -1300.7240576913898, -504.573782434004, -817.6579666054587, -769.2185681571843, -1306.0887054648545, -562.7718370726805, -1247.8774091037071, -682.8344213326337, -1143.4821133227542, -189.75929900429927, -88.85002418960283, -888.3659842778387, -596.3833796791337, -1106.790865323369, -1261.1691654221752, -1102.5562928148793, -938.6242038644442, -634.0406657392301, -586.9535381054466, -1037.0512205889252, -529.9909488862279, -153.3129717442768, -1257.829016364476, -506.7905823884637, -867.4706671052933, -916.9076887899799, -1447.1336945646444, -120.8166769989651, -1418.7821886277482, -1019.3933005913029, -1009.994035479361, -1475.0874042992489, -277.9251572965793, -925.0998274985104, -890.2077412469981, -1452.3690896281562, -729.6574621775135, -982.8459378733468, -254.17028175296502, -482.9400339147391, -895.5763124103175, -807.1635013945267, -701.1401864643028, -800.754370817351, -1066.1489550539322, -647.6409805228917, -1153.0176262863674, -593.9657070984656, -1306.237933916532, -924.1090991209304, -692.6607041325661, -343.89466021392417, -160.024480270092, -801.9988742686328, -563.3040804493195, -259.77313082531066, -873.4143331884104, -321.4310175572948, -631.3073676272027, -815.8516496163288, -593.7987448163118, -641.5570767452455, -347.7666841114848, -416.58905182751334], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 95, 150, 150, 150, 76, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 52, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 71, 150, 150, 129, 150, 88, 150, 150, 150, 150, 122, 150], "policy_policy_0_reward": [-712.6757549699612, -918.2362266110418, -1038.2859526132104, -341.92602156636764, -987.8337522442041, -581.3125801449469, -815.6089185521618, -586.03152964106, -1115.7682057385855, -904.0964795869136, -1017.4417488437053, -870.4194011383491, -1075.267167402409, -692.1098197064214, -715.5702744804, -1028.1411858653, -1363.4194222335211, -1205.4183441644498, -749.1332819317672, -472.8366123482494, -740.2510183232735, -305.5899351002759, -1080.9918593771313, -591.1976663176507, -971.5589677275001, -172.94225910470576, -1006.2922054277806, -1104.5826388085684, -567.452792021326, -119.34451935020624, -970.1849632574588, -969.4930214119838, -834.6472951854254, -206.5878279088119, -854.1580986266777, -905.9057454216037, -1300.7240576913898, -504.573782434004, -817.6579666054587, -769.2185681571843, -1306.0887054648545, -562.7718370726805, -1247.8774091037071, -682.8344213326337, -1143.4821133227542, -189.75929900429927, -88.85002418960283, -888.3659842778387, -596.3833796791337, -1106.790865323369, -1261.1691654221752, -1102.5562928148793, -938.6242038644442, -634.0406657392301, -586.9535381054466, -1037.0512205889252, -529.9909488862279, -153.3129717442768, -1257.829016364476, -506.7905823884637, -867.4706671052933, -916.9076887899799, -1447.1336945646444, -120.8166769989651, -1418.7821886277482, -1019.3933005913029, -1009.994035479361, -1475.0874042992489, -277.9251572965793, -925.0998274985104, -890.2077412469981, -1452.3690896281562, -729.6574621775135, -982.8459378733468, -254.17028175296502, -482.9400339147391, -895.5763124103175, -807.1635013945267, -701.1401864643028, -800.754370817351, -1066.1489550539322, -647.6409805228917, -1153.0176262863674, -593.9657070984656, -1306.237933916532, -924.1090991209304, -692.6607041325661, -343.89466021392417, -160.024480270092, -801.9988742686328, -563.3040804493195, -259.77313082531066, -873.4143331884104, -321.4310175572948, -631.3073676272027, -815.8516496163288, -593.7987448163118, -641.5570767452455, -347.7666841114848, -416.58905182751334]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536696831980946, "mean_inference_ms": 1.6823067496196038, "mean_action_processing_ms": 0.28022669281697704, "mean_env_wait_ms": 3.048149830413342, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011555671691894531, "StateBufferConnector_ms": 0.00830221176147461, "ViewRequirementAgentConnector_ms": 0.19939565658569336}, "num_episodes": 30, "episode_return_max": -88.85002418960283, "episode_return_min": -1475.0874042992489, "episode_return_mean": -784.3633822931148, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.54632297099533, "num_env_steps_trained_throughput_per_sec": 320.54632297099533, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12314.839, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12314.763, "sample_time_ms": 1068.722, "learn_time_ms": 11175.978, "learn_throughput": 357.91, "synch_weights_time_ms": 69.178}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00015", "date": "2024-08-03_05-00-28", "timestamp": 1722641428, "time_this_iter_s": 12.490852117538452, "time_total_s": 301.48883032798767, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b327f7760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 301.48883032798767, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.727777777777774, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 126.31967658201853, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.016597390423218, "policy_loss": -0.010127602861515091, "vf_loss": 5.020497541377941, "vf_explained_var": 0.954000669096907, "kl": 0.013863980189065235, "entropy": 1.1341226141278942, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -88.85002418960283, "episode_reward_min": -1475.0874042992489, "episode_reward_mean": -743.3257391441139, "episode_len_mean": 140.89, "episode_media": {}, "episodes_timesteps_total": 14089, "policy_reward_min": {"policy_0": -1475.0874042992489}, "policy_reward_max": {"policy_0": -88.85002418960283}, "policy_reward_mean": {"policy_0": -743.3257391441139}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1006.2922054277806, -1104.5826388085684, -567.452792021326, -119.34451935020624, -970.1849632574588, -969.4930214119838, -834.6472951854254, -206.5878279088119, -854.1580986266777, -905.9057454216037, -1300.7240576913898, -504.573782434004, -817.6579666054587, -769.2185681571843, -1306.0887054648545, -562.7718370726805, -1247.8774091037071, -682.8344213326337, -1143.4821133227542, -189.75929900429927, -88.85002418960283, -888.3659842778387, -596.3833796791337, -1106.790865323369, -1261.1691654221752, -1102.5562928148793, -938.6242038644442, -634.0406657392301, -586.9535381054466, -1037.0512205889252, -529.9909488862279, -153.3129717442768, -1257.829016364476, -506.7905823884637, -867.4706671052933, -916.9076887899799, -1447.1336945646444, -120.8166769989651, -1418.7821886277482, -1019.3933005913029, -1009.994035479361, -1475.0874042992489, -277.9251572965793, -925.0998274985104, -890.2077412469981, -1452.3690896281562, -729.6574621775135, -982.8459378733468, -254.17028175296502, -482.9400339147391, -895.5763124103175, -807.1635013945267, -701.1401864643028, -800.754370817351, -1066.1489550539322, -647.6409805228917, -1153.0176262863674, -593.9657070984656, -1306.237933916532, -924.1090991209304, -692.6607041325661, -343.89466021392417, -160.024480270092, -801.9988742686328, -563.3040804493195, -259.77313082531066, -873.4143331884104, -321.4310175572948, -631.3073676272027, -815.8516496163288, -593.7987448163118, -641.5570767452455, -347.7666841114848, -416.58905182751334, -1097.9673117344348, -306.3389106268483, -603.0125441649348, -470.2734567164451, -726.2007073241577, -364.1614601143211, -968.8179724509662, -513.1275679770965, -866.7247720854547, -374.55778944510575, -296.3349272482693, -1242.4640046678055, -362.38830411602925, -859.4551091515937, -701.6959942667954, -664.6194829250885, -544.917659453124, -245.63838729100326, -911.2814028553553, -652.3346408286407, -704.353715953576, -449.49150554783614, -465.83828890878226, -1194.534648345737, -1011.8245077587438, -351.9449988753398], "episode_lengths": [150, 150, 150, 76, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 77, 52, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 148, 71, 150, 150, 129, 150, 88, 150, 150, 150, 150, 122, 150, 150, 107, 150, 138, 150, 150, 150, 150, 150, 108, 122, 150, 127, 150, 150, 150, 150, 141, 150, 150, 150, 150, 110, 150, 150, 150], "policy_policy_0_reward": [-1006.2922054277806, -1104.5826388085684, -567.452792021326, -119.34451935020624, -970.1849632574588, -969.4930214119838, -834.6472951854254, -206.5878279088119, -854.1580986266777, -905.9057454216037, -1300.7240576913898, -504.573782434004, -817.6579666054587, -769.2185681571843, -1306.0887054648545, -562.7718370726805, -1247.8774091037071, -682.8344213326337, -1143.4821133227542, -189.75929900429927, -88.85002418960283, -888.3659842778387, -596.3833796791337, -1106.790865323369, -1261.1691654221752, -1102.5562928148793, -938.6242038644442, -634.0406657392301, -586.9535381054466, -1037.0512205889252, -529.9909488862279, -153.3129717442768, -1257.829016364476, -506.7905823884637, -867.4706671052933, -916.9076887899799, -1447.1336945646444, -120.8166769989651, -1418.7821886277482, -1019.3933005913029, -1009.994035479361, -1475.0874042992489, -277.9251572965793, -925.0998274985104, -890.2077412469981, -1452.3690896281562, -729.6574621775135, -982.8459378733468, -254.17028175296502, -482.9400339147391, -895.5763124103175, -807.1635013945267, -701.1401864643028, -800.754370817351, -1066.1489550539322, -647.6409805228917, -1153.0176262863674, -593.9657070984656, -1306.237933916532, -924.1090991209304, -692.6607041325661, -343.89466021392417, -160.024480270092, -801.9988742686328, -563.3040804493195, -259.77313082531066, -873.4143331884104, -321.4310175572948, -631.3073676272027, -815.8516496163288, -593.7987448163118, -641.5570767452455, -347.7666841114848, -416.58905182751334, -1097.9673117344348, -306.3389106268483, -603.0125441649348, -470.2734567164451, -726.2007073241577, -364.1614601143211, -968.8179724509662, -513.1275679770965, -866.7247720854547, -374.55778944510575, -296.3349272482693, -1242.4640046678055, -362.38830411602925, -859.4551091515937, -701.6959942667954, -664.6194829250885, -544.917659453124, -245.63838729100326, -911.2814028553553, -652.3346408286407, -704.353715953576, -449.49150554783614, -465.83828890878226, -1194.534648345737, -1011.8245077587438, -351.9449988753398]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553685590044599, "mean_inference_ms": 1.6822674657661187, "mean_action_processing_ms": 0.2802413483608045, "mean_env_wait_ms": 3.049349778053845, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011391162872314453, "StateBufferConnector_ms": 0.00826263427734375, "ViewRequirementAgentConnector_ms": 0.19806218147277832}, "num_episodes": 26, "episode_return_max": -88.85002418960283, "episode_return_min": -1475.0874042992489, "episode_return_mean": -743.3257391441139, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.17969504949133, "num_env_steps_trained_throughput_per_sec": 308.17969504949133, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12336.837, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12336.761, "sample_time_ms": 1067.241, "learn_time_ms": 11199.751, "learn_throughput": 357.151, "synch_weights_time_ms": 68.891}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00015", "date": "2024-08-03_05-00-41", "timestamp": 1722641441, "time_this_iter_s": 12.991398334503174, "time_total_s": 314.48022866249084, "pid": 482962, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b30fa04c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 314.48022866249084, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.766666666666666, "ram_util_percent": 27.90555555555555}}
