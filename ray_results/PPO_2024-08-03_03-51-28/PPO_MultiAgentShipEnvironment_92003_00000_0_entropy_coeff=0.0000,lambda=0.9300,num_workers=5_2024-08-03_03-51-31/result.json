{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.114958284733196, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.642313261826834, "policy_loss": -0.006733482958225068, "vf_loss": 9.647309919198355, "vf_explained_var": 0.029977380049725375, "kl": 0.008755330839623337, "entropy": 1.4224143008391061, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -247.24828439127998, "episode_reward_min": -1172.8241516776313, "episode_reward_mean": -716.3347300916823, "episode_len_mean": 146.64, "episode_media": {}, "episodes_timesteps_total": 3666, "policy_reward_min": {"policy_0": -1172.8241516776313}, "policy_reward_max": {"policy_0": -247.24828439127998}, "policy_reward_mean": {"policy_0": -716.3347300916823}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-667.1696760787665, -945.7655640204719, -895.0419031004404, -344.8550043217682, -843.70198470191, -1172.8241516776313, -697.2122363659071, -1083.4481755609088, -881.0368942377098, -427.97871511955236, -586.9240543035972, -985.4421842328264, -247.24828439127998, -269.0499649852329, -893.1031524587116, -894.342804144673, -845.9132074687635, -908.5139237111396, -424.02353037915464, -605.102418528464, -593.4984628961015, -581.016829862609, -267.2457977739094, -940.4941806903074, -907.4151512802208], "episode_lengths": [145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 106, 150, 150, 146, 150, 150, 150], "policy_policy_0_reward": [-667.1696760787665, -945.7655640204719, -895.0419031004404, -344.8550043217682, -843.70198470191, -1172.8241516776313, -697.2122363659071, -1083.4481755609088, -881.0368942377098, -427.97871511955236, -586.9240543035972, -985.4421842328264, -247.24828439127998, -269.0499649852329, -893.1031524587116, -894.342804144673, -845.9132074687635, -908.5139237111396, -424.02353037915464, -605.102418528464, -593.4984628961015, -581.016829862609, -267.2457977739094, -940.4941806903074, -907.4151512802208]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2924564328235335, "mean_inference_ms": 0.8926907133371493, "mean_action_processing_ms": 0.16382993681451652, "mean_env_wait_ms": 1.5812517254242437, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0058841705322265625, "StateBufferConnector_ms": 0.004429817199707031, "ViewRequirementAgentConnector_ms": 0.09766960144042969}, "num_episodes": 25, "episode_return_max": -247.24828439127998, "episode_return_min": -1172.8241516776313, "episode_return_mean": -716.3347300916823, "episodes_this_iter": 25}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.1120362117959, "num_env_steps_trained_throughput_per_sec": 279.1120362117959, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 14331.174, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14331.104, "sample_time_ms": 2448.983, "learn_time_ms": 11862.586, "learn_throughput": 337.195, "synch_weights_time_ms": 18.357}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00000", "date": "2024-08-03_03-51-58", "timestamp": 1722637318, "time_this_iter_s": 14.336052179336548, "time_total_s": 14.336052179336548, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8d80700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14.336052179336548, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.252380952380953, "ram_util_percent": 17.076190476190483}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.7035508478060364, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.259851802388827, "policy_loss": -0.012965812111603251, "vf_loss": 9.269729341069857, "vf_explained_var": 0.2650858949248989, "kl": 0.015515627390186639, "entropy": 1.4860157628854116, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -1.5375497142459205, "episode_reward_min": -1250.4959902611074, "episode_reward_mean": -685.5191936238017, "episode_len_mean": 137.67857142857142, "episode_media": {}, "episodes_timesteps_total": 7710, "policy_reward_min": {"policy_0": -1250.4959902611074}, "policy_reward_max": {"policy_0": -1.5375497142459205}, "policy_reward_mean": {"policy_0": -685.5191936238017}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-667.1696760787665, -945.7655640204719, -895.0419031004404, -344.8550043217682, -843.70198470191, -1172.8241516776313, -697.2122363659071, -1083.4481755609088, -881.0368942377098, -427.97871511955236, -586.9240543035972, -985.4421842328264, -247.24828439127998, -269.0499649852329, -893.1031524587116, -894.342804144673, -845.9132074687635, -908.5139237111396, -424.02353037915464, -605.102418528464, -593.4984628961015, -581.016829862609, -267.2457977739094, -940.4941806903074, -907.4151512802208, -978.5340333646296, -820.798568058008, -377.34019655870753, -768.6632187853767, -1151.5234074767945, -54.14214265564848, -549.5660687926328, -206.92268325957443, -71.93085583339543, -1072.9183983737394, -681.9351988885313, -780.5710838449484, -332.3828212159171, -969.3224712521829, -1138.3850863285932, -651.3973915821653, -120.87521727192782, -745.7466583990041, -1139.3954984974266, -628.7475306595564, -912.0904624255724, -93.11170514078987, -416.6374945468861, -464.13463868080464, -920.7837718620736, -1.5375497142459205, -711.2949684808515, -739.003413730378, -823.4521462122852, -907.0659184870782, -1250.4959902611074], "episode_lengths": [145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 106, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 64, 112, 67, 59, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 66, 105, 150, 150, 35, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-667.1696760787665, -945.7655640204719, -895.0419031004404, -344.8550043217682, -843.70198470191, -1172.8241516776313, -697.2122363659071, -1083.4481755609088, -881.0368942377098, -427.97871511955236, -586.9240543035972, -985.4421842328264, -247.24828439127998, -269.0499649852329, -893.1031524587116, -894.342804144673, -845.9132074687635, -908.5139237111396, -424.02353037915464, -605.102418528464, -593.4984628961015, -581.016829862609, -267.2457977739094, -940.4941806903074, -907.4151512802208, -978.5340333646296, -820.798568058008, -377.34019655870753, -768.6632187853767, -1151.5234074767945, -54.14214265564848, -549.5660687926328, -206.92268325957443, -71.93085583339543, -1072.9183983737394, -681.9351988885313, -780.5710838449484, -332.3828212159171, -969.3224712521829, -1138.3850863285932, -651.3973915821653, -120.87521727192782, -745.7466583990041, -1139.3954984974266, -628.7475306595564, -912.0904624255724, -93.11170514078987, -416.6374945468861, -464.13463868080464, -920.7837718620736, -1.5375497142459205, -711.2949684808515, -739.003413730378, -823.4521462122852, -907.0659184870782, -1250.4959902611074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2922236305655255, "mean_inference_ms": 0.8948573645208153, "mean_action_processing_ms": 0.1635034337960714, "mean_env_wait_ms": 1.591980959212109, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005903840065002441, "StateBufferConnector_ms": 0.004271524293082101, "ViewRequirementAgentConnector_ms": 0.09828039578029088}, "num_episodes": 31, "episode_return_max": -1.5375497142459205, "episode_return_min": -1250.4959902611074, "episode_return_mean": -685.5191936238017, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 368.22137472869343, "num_env_steps_trained_throughput_per_sec": 368.22137472869343, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12597.108, "restore_workers_time_ms": 0.023, "training_step_time_ms": 12597.043, "sample_time_ms": 2461.389, "learn_time_ms": 10118.601, "learn_throughput": 395.312, "synch_weights_time_ms": 16.114}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00000", "date": "2024-08-03_03-52-09", "timestamp": 1722637329, "time_this_iter_s": 10.869361400604248, "time_total_s": 25.205413579940796, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8c345e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.205413579940796, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 14.326666666666664, "ram_util_percent": 17.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.369385449153682, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.91029269893964, "policy_loss": -0.01011884156226491, "vf_loss": 8.91754421889782, "vf_explained_var": 0.26561619391043984, "kl": 0.014410305194845329, "entropy": 1.475800388927261, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -1.5375497142459205, "episode_reward_min": -1250.4959902611074, "episode_reward_mean": -712.4879830835317, "episode_len_mean": 137.85714285714286, "episode_media": {}, "episodes_timesteps_total": 11580, "policy_reward_min": {"policy_0": -1250.4959902611074}, "policy_reward_max": {"policy_0": -1.5375497142459205}, "policy_reward_mean": {"policy_0": -712.4879830835317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-667.1696760787665, -945.7655640204719, -895.0419031004404, -344.8550043217682, -843.70198470191, -1172.8241516776313, -697.2122363659071, -1083.4481755609088, -881.0368942377098, -427.97871511955236, -586.9240543035972, -985.4421842328264, -247.24828439127998, -269.0499649852329, -893.1031524587116, -894.342804144673, -845.9132074687635, -908.5139237111396, -424.02353037915464, -605.102418528464, -593.4984628961015, -581.016829862609, -267.2457977739094, -940.4941806903074, -907.4151512802208, -978.5340333646296, -820.798568058008, -377.34019655870753, -768.6632187853767, -1151.5234074767945, -54.14214265564848, -549.5660687926328, -206.92268325957443, -71.93085583339543, -1072.9183983737394, -681.9351988885313, -780.5710838449484, -332.3828212159171, -969.3224712521829, -1138.3850863285932, -651.3973915821653, -120.87521727192782, -745.7466583990041, -1139.3954984974266, -628.7475306595564, -912.0904624255724, -93.11170514078987, -416.6374945468861, -464.13463868080464, -920.7837718620736, -1.5375497142459205, -711.2949684808515, -739.003413730378, -823.4521462122852, -907.0659184870782, -1250.4959902611074, -1151.5894355389382, -1185.0796181911528, -298.77773499640966, -772.2002428433565, -290.33144882455764, -1082.2037530840978, -1018.4249870308479, -1065.067842829099, -102.35825060118242, -807.9702672290614, -755.7059535558517, -805.2718838522649, -796.4124236324939, -733.4557666596363, -758.2098958004856, -84.72994052840586, -380.57721708025167, -934.9793227345484, -633.6408165778156, -1011.7432615336584, -1230.1573480223467, -793.8087606605956, -1150.6587286787458, -1122.2594202141224, -636.6664082347323, -762.8736430241008, -95.90437766433065, -998.8569864606756], "episode_lengths": [145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 150, 150, 106, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 64, 112, 67, 59, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 66, 105, 150, 150, 35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 51, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150], "policy_policy_0_reward": [-667.1696760787665, -945.7655640204719, -895.0419031004404, -344.8550043217682, -843.70198470191, -1172.8241516776313, -697.2122363659071, -1083.4481755609088, -881.0368942377098, -427.97871511955236, -586.9240543035972, -985.4421842328264, -247.24828439127998, -269.0499649852329, -893.1031524587116, -894.342804144673, -845.9132074687635, -908.5139237111396, -424.02353037915464, -605.102418528464, -593.4984628961015, -581.016829862609, -267.2457977739094, -940.4941806903074, -907.4151512802208, -978.5340333646296, -820.798568058008, -377.34019655870753, -768.6632187853767, -1151.5234074767945, -54.14214265564848, -549.5660687926328, -206.92268325957443, -71.93085583339543, -1072.9183983737394, -681.9351988885313, -780.5710838449484, -332.3828212159171, -969.3224712521829, -1138.3850863285932, -651.3973915821653, -120.87521727192782, -745.7466583990041, -1139.3954984974266, -628.7475306595564, -912.0904624255724, -93.11170514078987, -416.6374945468861, -464.13463868080464, -920.7837718620736, -1.5375497142459205, -711.2949684808515, -739.003413730378, -823.4521462122852, -907.0659184870782, -1250.4959902611074, -1151.5894355389382, -1185.0796181911528, -298.77773499640966, -772.2002428433565, -290.33144882455764, -1082.2037530840978, -1018.4249870308479, -1065.067842829099, -102.35825060118242, -807.9702672290614, -755.7059535558517, -805.2718838522649, -796.4124236324939, -733.4557666596363, -758.2098958004856, -84.72994052840586, -380.57721708025167, -934.9793227345484, -633.6408165778156, -1011.7432615336584, -1230.1573480223467, -793.8087606605956, -1150.6587286787458, -1122.2594202141224, -636.6664082347323, -762.8736430241008, -95.90437766433065, -998.8569864606756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2917897090898107, "mean_inference_ms": 0.8962500954833869, "mean_action_processing_ms": 0.16342101897468123, "mean_env_wait_ms": 1.5946760162784375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005746739251273019, "StateBufferConnector_ms": 0.004188219706217448, "ViewRequirementAgentConnector_ms": 0.09891844931102935}, "num_episodes": 28, "episode_return_max": -1.5375497142459205, "episode_return_min": -1250.4959902611074, "episode_return_mean": -712.4879830835317, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 419.9282879746371, "num_env_steps_trained_throughput_per_sec": 419.9282879746371, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11573.221, "restore_workers_time_ms": 0.021, "training_step_time_ms": 11573.16, "sample_time_ms": 2451.865, "learn_time_ms": 9105.166, "learn_throughput": 439.311, "synch_weights_time_ms": 15.267}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00000", "date": "2024-08-03_03-52-19", "timestamp": 1722637339, "time_this_iter_s": 9.533912658691406, "time_total_s": 34.7393262386322, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8c35240>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 34.7393262386322, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 14.15, "ram_util_percent": 17.099999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.623369786888361, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.304738753537337, "policy_loss": -0.011864344158190458, "vf_loss": 7.3136618400613465, "vf_explained_var": 0.6023677948241433, "kl": 0.014784474162464296, "entropy": 1.5647482761492333, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -1.5375497142459205, "episode_reward_min": -1250.4959902611074, "episode_reward_mean": -676.4761269710971, "episode_len_mean": 135.59, "episode_media": {}, "episodes_timesteps_total": 13559, "policy_reward_min": {"policy_0": -1250.4959902611074}, "policy_reward_max": {"policy_0": -1.5375497142459205}, "policy_reward_mean": {"policy_0": -676.4761269710971}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-893.1031524587116, -894.342804144673, -845.9132074687635, -908.5139237111396, -424.02353037915464, -605.102418528464, -593.4984628961015, -581.016829862609, -267.2457977739094, -940.4941806903074, -907.4151512802208, -978.5340333646296, -820.798568058008, -377.34019655870753, -768.6632187853767, -1151.5234074767945, -54.14214265564848, -549.5660687926328, -206.92268325957443, -71.93085583339543, -1072.9183983737394, -681.9351988885313, -780.5710838449484, -332.3828212159171, -969.3224712521829, -1138.3850863285932, -651.3973915821653, -120.87521727192782, -745.7466583990041, -1139.3954984974266, -628.7475306595564, -912.0904624255724, -93.11170514078987, -416.6374945468861, -464.13463868080464, -920.7837718620736, -1.5375497142459205, -711.2949684808515, -739.003413730378, -823.4521462122852, -907.0659184870782, -1250.4959902611074, -1151.5894355389382, -1185.0796181911528, -298.77773499640966, -772.2002428433565, -290.33144882455764, -1082.2037530840978, -1018.4249870308479, -1065.067842829099, -102.35825060118242, -807.9702672290614, -755.7059535558517, -805.2718838522649, -796.4124236324939, -733.4557666596363, -758.2098958004856, -84.72994052840586, -380.57721708025167, -934.9793227345484, -633.6408165778156, -1011.7432615336584, -1230.1573480223467, -793.8087606605956, -1150.6587286787458, -1122.2594202141224, -636.6664082347323, -762.8736430241008, -95.90437766433065, -998.8569864606756, -893.6239503306963, -500.75979238173693, -763.9210185060016, -916.2965018473583, -356.6365263627647, -716.9931221665566, -822.525260455513, -34.731728864611966, -567.9653641923925, -353.66866646103045, -426.0735802610951, -865.4515306432978, -277.78126381862603, -883.0500460259742, -1008.6347267139503, -274.69232961315925, -713.0551200343735, -749.8628428088072, -527.3480883624903, -71.10641423937047, -643.3853315355466, -869.4822897279322, -638.3961727788833, -1079.1950849022824, -458.1133486891344, -952.6208632833367, -76.28401687158166, -92.34845681959683, -739.885981469617, -572.4314910233339], "episode_lengths": [150, 150, 150, 150, 106, 150, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 64, 112, 67, 59, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 66, 105, 150, 150, 35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 51, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 102, 150, 150, 52, 150, 124, 150, 150, 150, 150, 150, 87, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 81, 94, 150, 150], "policy_policy_0_reward": [-893.1031524587116, -894.342804144673, -845.9132074687635, -908.5139237111396, -424.02353037915464, -605.102418528464, -593.4984628961015, -581.016829862609, -267.2457977739094, -940.4941806903074, -907.4151512802208, -978.5340333646296, -820.798568058008, -377.34019655870753, -768.6632187853767, -1151.5234074767945, -54.14214265564848, -549.5660687926328, -206.92268325957443, -71.93085583339543, -1072.9183983737394, -681.9351988885313, -780.5710838449484, -332.3828212159171, -969.3224712521829, -1138.3850863285932, -651.3973915821653, -120.87521727192782, -745.7466583990041, -1139.3954984974266, -628.7475306595564, -912.0904624255724, -93.11170514078987, -416.6374945468861, -464.13463868080464, -920.7837718620736, -1.5375497142459205, -711.2949684808515, -739.003413730378, -823.4521462122852, -907.0659184870782, -1250.4959902611074, -1151.5894355389382, -1185.0796181911528, -298.77773499640966, -772.2002428433565, -290.33144882455764, -1082.2037530840978, -1018.4249870308479, -1065.067842829099, -102.35825060118242, -807.9702672290614, -755.7059535558517, -805.2718838522649, -796.4124236324939, -733.4557666596363, -758.2098958004856, -84.72994052840586, -380.57721708025167, -934.9793227345484, -633.6408165778156, -1011.7432615336584, -1230.1573480223467, -793.8087606605956, -1150.6587286787458, -1122.2594202141224, -636.6664082347323, -762.8736430241008, -95.90437766433065, -998.8569864606756, -893.6239503306963, -500.75979238173693, -763.9210185060016, -916.2965018473583, -356.6365263627647, -716.9931221665566, -822.525260455513, -34.731728864611966, -567.9653641923925, -353.66866646103045, -426.0735802610951, -865.4515306432978, -277.78126381862603, -883.0500460259742, -1008.6347267139503, -274.69232961315925, -713.0551200343735, -749.8628428088072, -527.3480883624903, -71.10641423937047, -643.3853315355466, -869.4822897279322, -638.3961727788833, -1079.1950849022824, -458.1133486891344, -952.6208632833367, -76.28401687158166, -92.34845681959683, -739.885981469617, -572.4314910233339]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29172495700266393, "mean_inference_ms": 0.897552817448422, "mean_action_processing_ms": 0.1630928526692068, "mean_env_wait_ms": 1.5984671218481856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055582523345947266, "StateBufferConnector_ms": 0.004162788391113281, "ViewRequirementAgentConnector_ms": 0.10110855102539062}, "num_episodes": 30, "episode_return_max": -1.5375497142459205, "episode_return_min": -1250.4959902611074, "episode_return_mean": -676.4761269710971, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 357.0085979935554, "num_env_steps_trained_throughput_per_sec": 357.0085979935554, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 11480.972, "restore_workers_time_ms": 0.02, "training_step_time_ms": 11480.912, "sample_time_ms": 2443.4, "learn_time_ms": 9021.837, "learn_throughput": 443.369, "synch_weights_time_ms": 14.849}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00000", "date": "2024-08-03_03-52-30", "timestamp": 1722637350, "time_this_iter_s": 11.21125054359436, "time_total_s": 45.95057678222656, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8c355a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 45.95057678222656, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.543750000000001, "ram_util_percent": 17.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.51814252783855, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.116085587441921, "policy_loss": -0.023022431594048005, "vf_loss": 7.134397621949514, "vf_explained_var": 0.6731991371139884, "kl": 0.023634157756350766, "entropy": 1.6421158451586961, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -1.5375497142459205, "episode_reward_min": -1250.4959902611074, "episode_reward_mean": -649.7179465176333, "episode_len_mean": 132.86, "episode_media": {}, "episodes_timesteps_total": 13286, "policy_reward_min": {"policy_0": -1250.4959902611074}, "policy_reward_max": {"policy_0": -1.5375497142459205}, "policy_reward_mean": {"policy_0": -649.7179465176333}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-93.11170514078987, -416.6374945468861, -464.13463868080464, -920.7837718620736, -1.5375497142459205, -711.2949684808515, -739.003413730378, -823.4521462122852, -907.0659184870782, -1250.4959902611074, -1151.5894355389382, -1185.0796181911528, -298.77773499640966, -772.2002428433565, -290.33144882455764, -1082.2037530840978, -1018.4249870308479, -1065.067842829099, -102.35825060118242, -807.9702672290614, -755.7059535558517, -805.2718838522649, -796.4124236324939, -733.4557666596363, -758.2098958004856, -84.72994052840586, -380.57721708025167, -934.9793227345484, -633.6408165778156, -1011.7432615336584, -1230.1573480223467, -793.8087606605956, -1150.6587286787458, -1122.2594202141224, -636.6664082347323, -762.8736430241008, -95.90437766433065, -998.8569864606756, -893.6239503306963, -500.75979238173693, -763.9210185060016, -916.2965018473583, -356.6365263627647, -716.9931221665566, -822.525260455513, -34.731728864611966, -567.9653641923925, -353.66866646103045, -426.0735802610951, -865.4515306432978, -277.78126381862603, -883.0500460259742, -1008.6347267139503, -274.69232961315925, -713.0551200343735, -749.8628428088072, -527.3480883624903, -71.10641423937047, -643.3853315355466, -869.4822897279322, -638.3961727788833, -1079.1950849022824, -458.1133486891344, -952.6208632833367, -76.28401687158166, -92.34845681959683, -739.885981469617, -572.4314910233339, -885.5748207031044, -62.780510452131196, -239.60286981452668, -766.8535906358868, -520.5512834678105, -1105.8079808171299, -5.397504285870492, -1046.8620428734903, -342.2610660321929, -519.2644368844204, -250.49956977753604, -493.7617556953246, -301.10116172689374, -977.7107972808183, -230.4476193801329, -1100.4023896143606, -889.8284912479139, -107.91627493235177, -1088.2188271212963, -313.0276435087237, -976.3157832081865, -552.8733096148013, -375.4260961973576, -117.37749239762827, -513.5308414275488, -854.0836220796575, -787.6942790907652, -880.5505838219989, -865.3254690200631, -469.9867787383622, -980.530541782553, -716.4749737411872], "episode_lengths": [66, 105, 150, 150, 35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 51, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 102, 150, 150, 52, 150, 124, 150, 150, 150, 150, 150, 87, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 81, 94, 150, 150, 150, 74, 120, 150, 116, 150, 37, 150, 116, 150, 86, 150, 135, 150, 79, 150, 150, 72, 150, 150, 150, 150, 104, 48, 130, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-93.11170514078987, -416.6374945468861, -464.13463868080464, -920.7837718620736, -1.5375497142459205, -711.2949684808515, -739.003413730378, -823.4521462122852, -907.0659184870782, -1250.4959902611074, -1151.5894355389382, -1185.0796181911528, -298.77773499640966, -772.2002428433565, -290.33144882455764, -1082.2037530840978, -1018.4249870308479, -1065.067842829099, -102.35825060118242, -807.9702672290614, -755.7059535558517, -805.2718838522649, -796.4124236324939, -733.4557666596363, -758.2098958004856, -84.72994052840586, -380.57721708025167, -934.9793227345484, -633.6408165778156, -1011.7432615336584, -1230.1573480223467, -793.8087606605956, -1150.6587286787458, -1122.2594202141224, -636.6664082347323, -762.8736430241008, -95.90437766433065, -998.8569864606756, -893.6239503306963, -500.75979238173693, -763.9210185060016, -916.2965018473583, -356.6365263627647, -716.9931221665566, -822.525260455513, -34.731728864611966, -567.9653641923925, -353.66866646103045, -426.0735802610951, -865.4515306432978, -277.78126381862603, -883.0500460259742, -1008.6347267139503, -274.69232961315925, -713.0551200343735, -749.8628428088072, -527.3480883624903, -71.10641423937047, -643.3853315355466, -869.4822897279322, -638.3961727788833, -1079.1950849022824, -458.1133486891344, -952.6208632833367, -76.28401687158166, -92.34845681959683, -739.885981469617, -572.4314910233339, -885.5748207031044, -62.780510452131196, -239.60286981452668, -766.8535906358868, -520.5512834678105, -1105.8079808171299, -5.397504285870492, -1046.8620428734903, -342.2610660321929, -519.2644368844204, -250.49956977753604, -493.7617556953246, -301.10116172689374, -977.7107972808183, -230.4476193801329, -1100.4023896143606, -889.8284912479139, -107.91627493235177, -1088.2188271212963, -313.0276435087237, -976.3157832081865, -552.8733096148013, -375.4260961973576, -117.37749239762827, -513.5308414275488, -854.0836220796575, -787.6942790907652, -880.5505838219989, -865.3254690200631, -469.9867787383622, -980.530541782553, -716.4749737411872]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2915457364682687, "mean_inference_ms": 0.8981614975630694, "mean_action_processing_ms": 0.1628656379588212, "mean_env_wait_ms": 1.6029386213109604, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005276679992675781, "StateBufferConnector_ms": 0.0040552616119384766, "ViewRequirementAgentConnector_ms": 0.10169267654418945}, "num_episodes": 32, "episode_return_max": -1.5375497142459205, "episode_return_min": -1250.4959902611074, "episode_return_mean": -649.7179465176333, "episodes_this_iter": 32}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 293.1852903859198, "num_env_steps_trained_throughput_per_sec": 293.1852903859198, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 11913.431, "restore_workers_time_ms": 0.022, "training_step_time_ms": 11913.367, "sample_time_ms": 2454.473, "learn_time_ms": 9443.391, "learn_throughput": 423.577, "synch_weights_time_ms": 14.695}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00000", "date": "2024-08-03_03-52-44", "timestamp": 1722637364, "time_this_iter_s": 13.650911808013916, "time_total_s": 59.60148859024048, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8d80700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 59.60148859024048, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 13.536842105263156, "ram_util_percent": 17.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.6796203357478, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.719578505059084, "policy_loss": -0.01079224283360721, "vf_loss": 7.7258433401584625, "vf_explained_var": 0.597993874984483, "kl": 0.015149869266648852, "entropy": 1.7587510189662376, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -5.397504285870492, "episode_reward_min": -1280.1238151367045, "episode_reward_mean": -687.2155742288088, "episode_len_mean": 136.43, "episode_media": {}, "episodes_timesteps_total": 13643, "policy_reward_min": {"policy_0": -1280.1238151367045}, "policy_reward_max": {"policy_0": -5.397504285870492}, "policy_reward_mean": {"policy_0": -687.2155742288088}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-934.9793227345484, -633.6408165778156, -1011.7432615336584, -1230.1573480223467, -793.8087606605956, -1150.6587286787458, -1122.2594202141224, -636.6664082347323, -762.8736430241008, -95.90437766433065, -998.8569864606756, -893.6239503306963, -500.75979238173693, -763.9210185060016, -916.2965018473583, -356.6365263627647, -716.9931221665566, -822.525260455513, -34.731728864611966, -567.9653641923925, -353.66866646103045, -426.0735802610951, -865.4515306432978, -277.78126381862603, -883.0500460259742, -1008.6347267139503, -274.69232961315925, -713.0551200343735, -749.8628428088072, -527.3480883624903, -71.10641423937047, -643.3853315355466, -869.4822897279322, -638.3961727788833, -1079.1950849022824, -458.1133486891344, -952.6208632833367, -76.28401687158166, -92.34845681959683, -739.885981469617, -572.4314910233339, -885.5748207031044, -62.780510452131196, -239.60286981452668, -766.8535906358868, -520.5512834678105, -1105.8079808171299, -5.397504285870492, -1046.8620428734903, -342.2610660321929, -519.2644368844204, -250.49956977753604, -493.7617556953246, -301.10116172689374, -977.7107972808183, -230.4476193801329, -1100.4023896143606, -889.8284912479139, -107.91627493235177, -1088.2188271212963, -313.0276435087237, -976.3157832081865, -552.8733096148013, -375.4260961973576, -117.37749239762827, -513.5308414275488, -854.0836220796575, -787.6942790907652, -880.5505838219989, -865.3254690200631, -469.9867787383622, -980.530541782553, -716.4749737411872, -647.3940450791899, -821.3986855831479, -694.5522490816143, -1122.2165456261596, -1280.1238151367045, -784.5445673040133, -546.896271424628, -962.1173170831751, -710.440153744538, -735.9698971693881, -1062.5996798153365, -619.2088579898681, -1005.7186957444616, -952.84318959343, -1033.6901612932804, -1054.011684498867, -608.1755216059672, -844.1148828923908, -978.4698217080904, -885.6844903679295, -183.87260417888217, -1214.312646310121, -944.903319226483, -505.8291803859167, -1018.5378989280407, -769.7128544023959, -178.30799433810833], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 75, 150, 150, 150, 150, 150, 102, 150, 150, 52, 150, 124, 150, 150, 150, 150, 150, 87, 150, 150, 150, 53, 150, 150, 150, 150, 150, 150, 81, 94, 150, 150, 150, 74, 120, 150, 116, 150, 37, 150, 116, 150, 86, 150, 135, 150, 79, 150, 150, 72, 150, 150, 150, 150, 104, 48, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 121, 150, 150, 80], "policy_policy_0_reward": [-934.9793227345484, -633.6408165778156, -1011.7432615336584, -1230.1573480223467, -793.8087606605956, -1150.6587286787458, -1122.2594202141224, -636.6664082347323, -762.8736430241008, -95.90437766433065, -998.8569864606756, -893.6239503306963, -500.75979238173693, -763.9210185060016, -916.2965018473583, -356.6365263627647, -716.9931221665566, -822.525260455513, -34.731728864611966, -567.9653641923925, -353.66866646103045, -426.0735802610951, -865.4515306432978, -277.78126381862603, -883.0500460259742, -1008.6347267139503, -274.69232961315925, -713.0551200343735, -749.8628428088072, -527.3480883624903, -71.10641423937047, -643.3853315355466, -869.4822897279322, -638.3961727788833, -1079.1950849022824, -458.1133486891344, -952.6208632833367, -76.28401687158166, -92.34845681959683, -739.885981469617, -572.4314910233339, -885.5748207031044, -62.780510452131196, -239.60286981452668, -766.8535906358868, -520.5512834678105, -1105.8079808171299, -5.397504285870492, -1046.8620428734903, -342.2610660321929, -519.2644368844204, -250.49956977753604, -493.7617556953246, -301.10116172689374, -977.7107972808183, -230.4476193801329, -1100.4023896143606, -889.8284912479139, -107.91627493235177, -1088.2188271212963, -313.0276435087237, -976.3157832081865, -552.8733096148013, -375.4260961973576, -117.37749239762827, -513.5308414275488, -854.0836220796575, -787.6942790907652, -880.5505838219989, -865.3254690200631, -469.9867787383622, -980.530541782553, -716.4749737411872, -647.3940450791899, -821.3986855831479, -694.5522490816143, -1122.2165456261596, -1280.1238151367045, -784.5445673040133, -546.896271424628, -962.1173170831751, -710.440153744538, -735.9698971693881, -1062.5996798153365, -619.2088579898681, -1005.7186957444616, -952.84318959343, -1033.6901612932804, -1054.011684498867, -608.1755216059672, -844.1148828923908, -978.4698217080904, -885.6844903679295, -183.87260417888217, -1214.312646310121, -944.903319226483, -505.8291803859167, -1018.5378989280407, -769.7128544023959, -178.30799433810833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2915024364776099, "mean_inference_ms": 0.8982443302741839, "mean_action_processing_ms": 0.16272668652286001, "mean_env_wait_ms": 1.6070587850565972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005154848098754883, "StateBufferConnector_ms": 0.00402379035949707, "ViewRequirementAgentConnector_ms": 0.10111260414123535}, "num_episodes": 27, "episode_return_max": -5.397504285870492, "episode_return_min": -1280.1238151367045, "episode_return_mean": -687.2155742288088, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.45798178769553, "num_env_steps_trained_throughput_per_sec": 275.45798178769553, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12348.073, "restore_workers_time_ms": 0.022, "training_step_time_ms": 12348.009, "sample_time_ms": 2459.437, "learn_time_ms": 9872.23, "learn_throughput": 405.177, "synch_weights_time_ms": 15.532}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00000", "date": "2024-08-03_03-52-58", "timestamp": 1722637378, "time_this_iter_s": 14.529123544692993, "time_total_s": 74.13061213493347, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8c35510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 74.13061213493347, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 13.071428571428571, "ram_util_percent": 17.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.604557847976686, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.490701065460841, "policy_loss": -0.018693739402806386, "vf_loss": 6.50415551563104, "vf_explained_var": 0.6638039362306396, "kl": 0.01752179671560346, "entropy": 1.725258565073212, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -5.397504285870492, "episode_reward_min": -1305.0254534098199, "episode_reward_mean": -699.3392069408594, "episode_len_mean": 136.39, "episode_media": {}, "episodes_timesteps_total": 13639, "policy_reward_min": {"policy_0": -1305.0254534098199}, "policy_reward_max": {"policy_0": -5.397504285870492}, "policy_reward_mean": {"policy_0": -699.3392069408594}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-749.8628428088072, -527.3480883624903, -71.10641423937047, -643.3853315355466, -869.4822897279322, -638.3961727788833, -1079.1950849022824, -458.1133486891344, -952.6208632833367, -76.28401687158166, -92.34845681959683, -739.885981469617, -572.4314910233339, -885.5748207031044, -62.780510452131196, -239.60286981452668, -766.8535906358868, -520.5512834678105, -1105.8079808171299, -5.397504285870492, -1046.8620428734903, -342.2610660321929, -519.2644368844204, -250.49956977753604, -493.7617556953246, -301.10116172689374, -977.7107972808183, -230.4476193801329, -1100.4023896143606, -889.8284912479139, -107.91627493235177, -1088.2188271212963, -313.0276435087237, -976.3157832081865, -552.8733096148013, -375.4260961973576, -117.37749239762827, -513.5308414275488, -854.0836220796575, -787.6942790907652, -880.5505838219989, -865.3254690200631, -469.9867787383622, -980.530541782553, -716.4749737411872, -647.3940450791899, -821.3986855831479, -694.5522490816143, -1122.2165456261596, -1280.1238151367045, -784.5445673040133, -546.896271424628, -962.1173170831751, -710.440153744538, -735.9698971693881, -1062.5996798153365, -619.2088579898681, -1005.7186957444616, -952.84318959343, -1033.6901612932804, -1054.011684498867, -608.1755216059672, -844.1148828923908, -978.4698217080904, -885.6844903679295, -183.87260417888217, -1214.312646310121, -944.903319226483, -505.8291803859167, -1018.5378989280407, -769.7128544023959, -178.30799433810833, -949.7110857736049, -1195.3534001587382, -935.158587998806, -847.931923495569, -1305.0254534098199, -573.9967999354337, -858.07876059449, -674.8271499451474, -1104.1738997178359, -892.7697077477007, -795.3785248805576, -538.7979475244847, -506.8105203324082, -417.06446340685005, -572.0497119629224, -202.34244856805847, -734.980879931272, -400.29419587715677, -265.5643476747865, -244.39038797475283, -927.2450931376587, -1127.0252448378533, -750.6170878739833, -966.072194125392, -866.9559918189165, -922.9483532326585, -488.5848859723881, -895.6238257806317], "episode_lengths": [150, 150, 53, 150, 150, 150, 150, 150, 150, 81, 94, 150, 150, 150, 74, 120, 150, 116, 150, 37, 150, 116, 150, 86, 150, 135, 150, 79, 150, 150, 72, 150, 150, 150, 150, 104, 48, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 121, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 118, 106, 150, 150, 150, 122, 90, 78, 150, 150, 150, 150, 150, 150, 111, 150], "policy_policy_0_reward": [-749.8628428088072, -527.3480883624903, -71.10641423937047, -643.3853315355466, -869.4822897279322, -638.3961727788833, -1079.1950849022824, -458.1133486891344, -952.6208632833367, -76.28401687158166, -92.34845681959683, -739.885981469617, -572.4314910233339, -885.5748207031044, -62.780510452131196, -239.60286981452668, -766.8535906358868, -520.5512834678105, -1105.8079808171299, -5.397504285870492, -1046.8620428734903, -342.2610660321929, -519.2644368844204, -250.49956977753604, -493.7617556953246, -301.10116172689374, -977.7107972808183, -230.4476193801329, -1100.4023896143606, -889.8284912479139, -107.91627493235177, -1088.2188271212963, -313.0276435087237, -976.3157832081865, -552.8733096148013, -375.4260961973576, -117.37749239762827, -513.5308414275488, -854.0836220796575, -787.6942790907652, -880.5505838219989, -865.3254690200631, -469.9867787383622, -980.530541782553, -716.4749737411872, -647.3940450791899, -821.3986855831479, -694.5522490816143, -1122.2165456261596, -1280.1238151367045, -784.5445673040133, -546.896271424628, -962.1173170831751, -710.440153744538, -735.9698971693881, -1062.5996798153365, -619.2088579898681, -1005.7186957444616, -952.84318959343, -1033.6901612932804, -1054.011684498867, -608.1755216059672, -844.1148828923908, -978.4698217080904, -885.6844903679295, -183.87260417888217, -1214.312646310121, -944.903319226483, -505.8291803859167, -1018.5378989280407, -769.7128544023959, -178.30799433810833, -949.7110857736049, -1195.3534001587382, -935.158587998806, -847.931923495569, -1305.0254534098199, -573.9967999354337, -858.07876059449, -674.8271499451474, -1104.1738997178359, -892.7697077477007, -795.3785248805576, -538.7979475244847, -506.8105203324082, -417.06446340685005, -572.0497119629224, -202.34244856805847, -734.980879931272, -400.29419587715677, -265.5643476747865, -244.39038797475283, -927.2450931376587, -1127.0252448378533, -750.6170878739833, -966.072194125392, -866.9559918189165, -922.9483532326585, -488.5848859723881, -895.6238257806317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29107322385161055, "mean_inference_ms": 0.8970910705650482, "mean_action_processing_ms": 0.16229049310751187, "mean_env_wait_ms": 1.6099478029865033, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0050776004791259766, "StateBufferConnector_ms": 0.004061698913574219, "ViewRequirementAgentConnector_ms": 0.10180473327636719}, "num_episodes": 28, "episode_return_max": -5.397504285870492, "episode_return_min": -1305.0254534098199, "episode_return_mean": -699.3392069408594, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 390.0719923150041, "num_env_steps_trained_throughput_per_sec": 390.0719923150041, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12048.996, "restore_workers_time_ms": 0.023, "training_step_time_ms": 12048.929, "sample_time_ms": 2472.489, "learn_time_ms": 9560.528, "learn_throughput": 418.387, "synch_weights_time_ms": 15.112}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00000", "date": "2024-08-03_03-53-09", "timestamp": 1722637389, "time_this_iter_s": 10.258831977844238, "time_total_s": 84.38944411277771, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8c37130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 84.38944411277771, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 14.766666666666667, "ram_util_percent": 17.106666666666666}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.33722889572382, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.668344601988792, "policy_loss": -0.005864745632667715, "vf_loss": 6.669960369666417, "vf_explained_var": 0.7918248577664296, "kl": 0.014222661216293403, "entropy": 1.7832223898420732, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -65.87483677664238, "episode_reward_min": -1384.2200476941375, "episode_reward_mean": -767.9797408625693, "episode_len_mean": 140.03, "episode_media": {}, "episodes_timesteps_total": 14003, "policy_reward_min": {"policy_0": -1384.2200476941375}, "policy_reward_max": {"policy_0": -65.87483677664238}, "policy_reward_mean": {"policy_0": -767.9797408625693}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-889.8284912479139, -107.91627493235177, -1088.2188271212963, -313.0276435087237, -976.3157832081865, -552.8733096148013, -375.4260961973576, -117.37749239762827, -513.5308414275488, -854.0836220796575, -787.6942790907652, -880.5505838219989, -865.3254690200631, -469.9867787383622, -980.530541782553, -716.4749737411872, -647.3940450791899, -821.3986855831479, -694.5522490816143, -1122.2165456261596, -1280.1238151367045, -784.5445673040133, -546.896271424628, -962.1173170831751, -710.440153744538, -735.9698971693881, -1062.5996798153365, -619.2088579898681, -1005.7186957444616, -952.84318959343, -1033.6901612932804, -1054.011684498867, -608.1755216059672, -844.1148828923908, -978.4698217080904, -885.6844903679295, -183.87260417888217, -1214.312646310121, -944.903319226483, -505.8291803859167, -1018.5378989280407, -769.7128544023959, -178.30799433810833, -949.7110857736049, -1195.3534001587382, -935.158587998806, -847.931923495569, -1305.0254534098199, -573.9967999354337, -858.07876059449, -674.8271499451474, -1104.1738997178359, -892.7697077477007, -795.3785248805576, -538.7979475244847, -506.8105203324082, -417.06446340685005, -572.0497119629224, -202.34244856805847, -734.980879931272, -400.29419587715677, -265.5643476747865, -244.39038797475283, -927.2450931376587, -1127.0252448378533, -750.6170878739833, -966.072194125392, -866.9559918189165, -922.9483532326585, -488.5848859723881, -895.6238257806317, -1312.7459972289785, -647.2195940774961, -1208.5173648155373, -616.1000256063455, -1007.1377178091942, -887.7130942791192, -1365.205550313842, -463.2091528705505, -438.02267824598636, -644.2923742359919, -1384.2200476941375, -468.1474994591187, -1174.505961614699, -1089.9445284898766, -884.4336900053927, -1360.978723675217, -849.9049390119914, -896.0791253673366, -997.120072253914, -840.0912426570367, -386.1891808957748, -214.7051910042674, -65.87483677664238, -1206.3718452070955, -420.18463148080633, -749.9614682330165, -287.5961793292007, -588.3157731603422, -728.6046883256286], "episode_lengths": [150, 72, 150, 150, 150, 150, 104, 48, 130, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 121, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 118, 106, 150, 150, 150, 122, 90, 78, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 117, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 51, 150, 150, 150, 104, 126, 150], "policy_policy_0_reward": [-889.8284912479139, -107.91627493235177, -1088.2188271212963, -313.0276435087237, -976.3157832081865, -552.8733096148013, -375.4260961973576, -117.37749239762827, -513.5308414275488, -854.0836220796575, -787.6942790907652, -880.5505838219989, -865.3254690200631, -469.9867787383622, -980.530541782553, -716.4749737411872, -647.3940450791899, -821.3986855831479, -694.5522490816143, -1122.2165456261596, -1280.1238151367045, -784.5445673040133, -546.896271424628, -962.1173170831751, -710.440153744538, -735.9698971693881, -1062.5996798153365, -619.2088579898681, -1005.7186957444616, -952.84318959343, -1033.6901612932804, -1054.011684498867, -608.1755216059672, -844.1148828923908, -978.4698217080904, -885.6844903679295, -183.87260417888217, -1214.312646310121, -944.903319226483, -505.8291803859167, -1018.5378989280407, -769.7128544023959, -178.30799433810833, -949.7110857736049, -1195.3534001587382, -935.158587998806, -847.931923495569, -1305.0254534098199, -573.9967999354337, -858.07876059449, -674.8271499451474, -1104.1738997178359, -892.7697077477007, -795.3785248805576, -538.7979475244847, -506.8105203324082, -417.06446340685005, -572.0497119629224, -202.34244856805847, -734.980879931272, -400.29419587715677, -265.5643476747865, -244.39038797475283, -927.2450931376587, -1127.0252448378533, -750.6170878739833, -966.072194125392, -866.9559918189165, -922.9483532326585, -488.5848859723881, -895.6238257806317, -1312.7459972289785, -647.2195940774961, -1208.5173648155373, -616.1000256063455, -1007.1377178091942, -887.7130942791192, -1365.205550313842, -463.2091528705505, -438.02267824598636, -644.2923742359919, -1384.2200476941375, -468.1474994591187, -1174.505961614699, -1089.9445284898766, -884.4336900053927, -1360.978723675217, -849.9049390119914, -896.0791253673366, -997.120072253914, -840.0912426570367, -386.1891808957748, -214.7051910042674, -65.87483677664238, -1206.3718452070955, -420.18463148080633, -749.9614682330165, -287.5961793292007, -588.3157731603422, -728.6046883256286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.29123609984893634, "mean_inference_ms": 0.9072666161372807, "mean_action_processing_ms": 0.162243663527181, "mean_env_wait_ms": 1.6159874884998766, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005266904830932617, "StateBufferConnector_ms": 0.004071474075317383, "ViewRequirementAgentConnector_ms": 0.10236096382141113}, "num_episodes": 29, "episode_return_max": -65.87483677664238, "episode_return_min": -1384.2200476941375, "episode_return_mean": -767.9797408625693, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.6330445821415, "num_env_steps_trained_throughput_per_sec": 307.6330445821415, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12168.187, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12168.118, "sample_time_ms": 2505.004, "learn_time_ms": 9647.269, "learn_throughput": 414.625, "synch_weights_time_ms": 15.047}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00000", "date": "2024-08-03_03-53-22", "timestamp": 1722637402, "time_this_iter_s": 13.009735822677612, "time_total_s": 97.39917993545532, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8c37400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 97.39917993545532, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 24.311111111111114, "ram_util_percent": 18.422222222222224}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.48846226433913, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.447021884719531, "policy_loss": -0.00903271346857461, "vf_loss": 5.451816648741564, "vf_explained_var": 0.8418793500090639, "kl": 0.01417986716138937, "entropy": 1.6013298213481904, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -13.441518198573167, "episode_reward_min": -1384.2200476941375, "episode_reward_mean": -757.9761261929116, "episode_len_mean": 139.0, "episode_media": {}, "episodes_timesteps_total": 13900, "policy_reward_min": {"policy_0": -1384.2200476941375}, "policy_reward_max": {"policy_0": -13.441518198573167}, "policy_reward_mean": {"policy_0": -757.9761261929116}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1005.7186957444616, -952.84318959343, -1033.6901612932804, -1054.011684498867, -608.1755216059672, -844.1148828923908, -978.4698217080904, -885.6844903679295, -183.87260417888217, -1214.312646310121, -944.903319226483, -505.8291803859167, -1018.5378989280407, -769.7128544023959, -178.30799433810833, -949.7110857736049, -1195.3534001587382, -935.158587998806, -847.931923495569, -1305.0254534098199, -573.9967999354337, -858.07876059449, -674.8271499451474, -1104.1738997178359, -892.7697077477007, -795.3785248805576, -538.7979475244847, -506.8105203324082, -417.06446340685005, -572.0497119629224, -202.34244856805847, -734.980879931272, -400.29419587715677, -265.5643476747865, -244.39038797475283, -927.2450931376587, -1127.0252448378533, -750.6170878739833, -966.072194125392, -866.9559918189165, -922.9483532326585, -488.5848859723881, -895.6238257806317, -1312.7459972289785, -647.2195940774961, -1208.5173648155373, -616.1000256063455, -1007.1377178091942, -887.7130942791192, -1365.205550313842, -463.2091528705505, -438.02267824598636, -644.2923742359919, -1384.2200476941375, -468.1474994591187, -1174.505961614699, -1089.9445284898766, -884.4336900053927, -1360.978723675217, -849.9049390119914, -896.0791253673366, -997.120072253914, -840.0912426570367, -386.1891808957748, -214.7051910042674, -65.87483677664238, -1206.3718452070955, -420.18463148080633, -749.9614682330165, -287.5961793292007, -588.3157731603422, -728.6046883256286, -468.90884733318427, -759.8959307659169, -705.4537207207701, -13.441518198573167, -724.7147992742746, -650.3499988499321, -410.10235762015236, -538.2021894421999, -1184.9081761049688, -600.7341256788116, -453.12340856879086, -971.1833699183184, -817.2628479654733, -1029.8565072724687, -720.7206499436611, -362.9933112971885, -1010.9419453742888, -199.9167139756468, -166.19909640898814, -1279.1149860270982, -1098.4558741873848, -492.98317381476085, -769.091749521833, -1185.2116280742553, -750.1258667646279, -1022.1200913352986, -409.5144820613126, -680.7342595022152], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 121, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 118, 106, 150, 150, 150, 122, 90, 78, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 117, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 51, 150, 150, 150, 104, 126, 150, 150, 150, 150, 45, 150, 149, 150, 150, 150, 149, 150, 150, 150, 150, 150, 97, 150, 112, 60, 150, 150, 144, 150, 150, 150, 150, 95, 150], "policy_policy_0_reward": [-1005.7186957444616, -952.84318959343, -1033.6901612932804, -1054.011684498867, -608.1755216059672, -844.1148828923908, -978.4698217080904, -885.6844903679295, -183.87260417888217, -1214.312646310121, -944.903319226483, -505.8291803859167, -1018.5378989280407, -769.7128544023959, -178.30799433810833, -949.7110857736049, -1195.3534001587382, -935.158587998806, -847.931923495569, -1305.0254534098199, -573.9967999354337, -858.07876059449, -674.8271499451474, -1104.1738997178359, -892.7697077477007, -795.3785248805576, -538.7979475244847, -506.8105203324082, -417.06446340685005, -572.0497119629224, -202.34244856805847, -734.980879931272, -400.29419587715677, -265.5643476747865, -244.39038797475283, -927.2450931376587, -1127.0252448378533, -750.6170878739833, -966.072194125392, -866.9559918189165, -922.9483532326585, -488.5848859723881, -895.6238257806317, -1312.7459972289785, -647.2195940774961, -1208.5173648155373, -616.1000256063455, -1007.1377178091942, -887.7130942791192, -1365.205550313842, -463.2091528705505, -438.02267824598636, -644.2923742359919, -1384.2200476941375, -468.1474994591187, -1174.505961614699, -1089.9445284898766, -884.4336900053927, -1360.978723675217, -849.9049390119914, -896.0791253673366, -997.120072253914, -840.0912426570367, -386.1891808957748, -214.7051910042674, -65.87483677664238, -1206.3718452070955, -420.18463148080633, -749.9614682330165, -287.5961793292007, -588.3157731603422, -728.6046883256286, -468.90884733318427, -759.8959307659169, -705.4537207207701, -13.441518198573167, -724.7147992742746, -650.3499988499321, -410.10235762015236, -538.2021894421999, -1184.9081761049688, -600.7341256788116, -453.12340856879086, -971.1833699183184, -817.2628479654733, -1029.8565072724687, -720.7206499436611, -362.9933112971885, -1010.9419453742888, -199.9167139756468, -166.19909640898814, -1279.1149860270982, -1098.4558741873848, -492.98317381476085, -769.091749521833, -1185.2116280742553, -750.1258667646279, -1022.1200913352986, -409.5144820613126, -680.7342595022152]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3021366607801299, "mean_inference_ms": 0.9440694209779622, "mean_action_processing_ms": 0.16613182848414668, "mean_env_wait_ms": 1.6682076891821356, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007781982421875, "StateBufferConnector_ms": 0.0053632259368896484, "ViewRequirementAgentConnector_ms": 0.13246798515319824}, "num_episodes": 28, "episode_return_max": -13.441518198573167, "episode_return_min": -1384.2200476941375, "episode_return_mean": -757.9761261929116, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 263.24631102161413, "num_env_steps_trained_throughput_per_sec": 263.24631102161413, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12504.489, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12504.419, "sample_time_ms": 2782.167, "learn_time_ms": 9706.785, "learn_throughput": 412.083, "synch_weights_time_ms": 14.682}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00000", "date": "2024-08-03_03-53-37", "timestamp": 1722637417, "time_this_iter_s": 15.20176100730896, "time_total_s": 112.60094094276428, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8c365f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 112.60094094276428, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 89.06363636363638, "ram_util_percent": 27.418181818181814}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 55.88300680021445, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.77566803569595, "policy_loss": -0.015222437065191722, "vf_loss": 5.785015238821506, "vf_explained_var": 0.8994513199354212, "kl": 0.019642021829107167, "entropy": 1.7375769667327403, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -13.441518198573167, "episode_reward_min": -1384.2200476941375, "episode_reward_mean": -745.1321225969384, "episode_len_mean": 138.21, "episode_media": {}, "episodes_timesteps_total": 13821, "policy_reward_min": {"policy_0": -1384.2200476941375}, "policy_reward_max": {"policy_0": -13.441518198573167}, "policy_reward_mean": {"policy_0": -745.1321225969384}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-734.980879931272, -400.29419587715677, -265.5643476747865, -244.39038797475283, -927.2450931376587, -1127.0252448378533, -750.6170878739833, -966.072194125392, -866.9559918189165, -922.9483532326585, -488.5848859723881, -895.6238257806317, -1312.7459972289785, -647.2195940774961, -1208.5173648155373, -616.1000256063455, -1007.1377178091942, -887.7130942791192, -1365.205550313842, -463.2091528705505, -438.02267824598636, -644.2923742359919, -1384.2200476941375, -468.1474994591187, -1174.505961614699, -1089.9445284898766, -884.4336900053927, -1360.978723675217, -849.9049390119914, -896.0791253673366, -997.120072253914, -840.0912426570367, -386.1891808957748, -214.7051910042674, -65.87483677664238, -1206.3718452070955, -420.18463148080633, -749.9614682330165, -287.5961793292007, -588.3157731603422, -728.6046883256286, -468.90884733318427, -759.8959307659169, -705.4537207207701, -13.441518198573167, -724.7147992742746, -650.3499988499321, -410.10235762015236, -538.2021894421999, -1184.9081761049688, -600.7341256788116, -453.12340856879086, -971.1833699183184, -817.2628479654733, -1029.8565072724687, -720.7206499436611, -362.9933112971885, -1010.9419453742888, -199.9167139756468, -166.19909640898814, -1279.1149860270982, -1098.4558741873848, -492.98317381476085, -769.091749521833, -1185.2116280742553, -750.1258667646279, -1022.1200913352986, -409.5144820613126, -680.7342595022152, -484.68041903459897, -779.2585320058788, -757.430246629874, -925.6213587588201, -1146.4243578518867, -374.4595272041021, -711.5918214643528, -1042.933526828072, -909.5131975073588, -866.155542973949, -932.0283667947004, -1063.659317018726, -945.3314856162259, -1241.6276967777912, -100.99547029373521, -153.7436032391395, -64.80218815799738, -1192.9754238517896, -1058.0169681051832, -819.6965176028224, -366.4627379823186, -881.2963834537877, -1030.940783870113, -528.8743278378225, -1283.2115774200206, -585.6177961438451, -694.2938300404903, -256.71682792284895, -300.0985763557914, -1249.8980842245328, -514.8984783608936], "episode_lengths": [150, 122, 90, 78, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 150, 150, 150, 150, 150, 117, 112, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 51, 150, 150, 150, 104, 126, 150, 150, 150, 150, 45, 150, 149, 150, 150, 150, 149, 150, 150, 150, 150, 150, 97, 150, 112, 60, 150, 150, 144, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 143, 150, 150, 150, 150, 119, 96, 70, 150, 150, 150, 124, 150, 150, 150, 150, 150, 130, 96, 98, 150, 150], "policy_policy_0_reward": [-734.980879931272, -400.29419587715677, -265.5643476747865, -244.39038797475283, -927.2450931376587, -1127.0252448378533, -750.6170878739833, -966.072194125392, -866.9559918189165, -922.9483532326585, -488.5848859723881, -895.6238257806317, -1312.7459972289785, -647.2195940774961, -1208.5173648155373, -616.1000256063455, -1007.1377178091942, -887.7130942791192, -1365.205550313842, -463.2091528705505, -438.02267824598636, -644.2923742359919, -1384.2200476941375, -468.1474994591187, -1174.505961614699, -1089.9445284898766, -884.4336900053927, -1360.978723675217, -849.9049390119914, -896.0791253673366, -997.120072253914, -840.0912426570367, -386.1891808957748, -214.7051910042674, -65.87483677664238, -1206.3718452070955, -420.18463148080633, -749.9614682330165, -287.5961793292007, -588.3157731603422, -728.6046883256286, -468.90884733318427, -759.8959307659169, -705.4537207207701, -13.441518198573167, -724.7147992742746, -650.3499988499321, -410.10235762015236, -538.2021894421999, -1184.9081761049688, -600.7341256788116, -453.12340856879086, -971.1833699183184, -817.2628479654733, -1029.8565072724687, -720.7206499436611, -362.9933112971885, -1010.9419453742888, -199.9167139756468, -166.19909640898814, -1279.1149860270982, -1098.4558741873848, -492.98317381476085, -769.091749521833, -1185.2116280742553, -750.1258667646279, -1022.1200913352986, -409.5144820613126, -680.7342595022152, -484.68041903459897, -779.2585320058788, -757.430246629874, -925.6213587588201, -1146.4243578518867, -374.4595272041021, -711.5918214643528, -1042.933526828072, -909.5131975073588, -866.155542973949, -932.0283667947004, -1063.659317018726, -945.3314856162259, -1241.6276967777912, -100.99547029373521, -153.7436032391395, -64.80218815799738, -1192.9754238517896, -1058.0169681051832, -819.6965176028224, -366.4627379823186, -881.2963834537877, -1030.940783870113, -528.8743278378225, -1283.2115774200206, -585.6177961438451, -694.2938300404903, -256.71682792284895, -300.0985763557914, -1249.8980842245328, -514.8984783608936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31356727137851126, "mean_inference_ms": 0.9811373777394141, "mean_action_processing_ms": 0.17009733171949776, "mean_env_wait_ms": 1.7220186276522012, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007995128631591797, "StateBufferConnector_ms": 0.0054776668548583984, "ViewRequirementAgentConnector_ms": 0.1351912021636963}, "num_episodes": 31, "episode_return_max": -13.441518198573167, "episode_return_min": -1384.2200476941375, "episode_return_mean": -745.1321225969384, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 444.787702437173, "num_env_steps_trained_throughput_per_sec": 444.787702437173, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12153.347, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12153.278, "sample_time_ms": 2747.518, "learn_time_ms": 9390.341, "learn_throughput": 425.97, "synch_weights_time_ms": 14.644}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00000", "date": "2024-08-03_03-53-46", "timestamp": 1722637426, "time_this_iter_s": 9.000126361846924, "time_total_s": 121.6010673046112, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8c377f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 121.6010673046112, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 14.807692307692308, "ram_util_percent": 17.123076923076923}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 68.61653441985449, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.21434967542688, "policy_loss": -0.014603796181230184, "vf_loss": 5.223775617033243, "vf_explained_var": 0.9035608010366559, "kl": 0.017316433064964568, "entropy": 1.7076290875673295, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -13.441518198573167, "episode_reward_min": -1360.978723675217, "episode_reward_mean": -730.7599668760947, "episode_len_mean": 138.23, "episode_media": {}, "episodes_timesteps_total": 13823, "policy_reward_min": {"policy_0": -1360.978723675217}, "policy_reward_max": {"policy_0": -13.441518198573167}, "policy_reward_mean": {"policy_0": -730.7599668760947}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1360.978723675217, -849.9049390119914, -896.0791253673366, -997.120072253914, -840.0912426570367, -386.1891808957748, -214.7051910042674, -65.87483677664238, -1206.3718452070955, -420.18463148080633, -749.9614682330165, -287.5961793292007, -588.3157731603422, -728.6046883256286, -468.90884733318427, -759.8959307659169, -705.4537207207701, -13.441518198573167, -724.7147992742746, -650.3499988499321, -410.10235762015236, -538.2021894421999, -1184.9081761049688, -600.7341256788116, -453.12340856879086, -971.1833699183184, -817.2628479654733, -1029.8565072724687, -720.7206499436611, -362.9933112971885, -1010.9419453742888, -199.9167139756468, -166.19909640898814, -1279.1149860270982, -1098.4558741873848, -492.98317381476085, -769.091749521833, -1185.2116280742553, -750.1258667646279, -1022.1200913352986, -409.5144820613126, -680.7342595022152, -484.68041903459897, -779.2585320058788, -757.430246629874, -925.6213587588201, -1146.4243578518867, -374.4595272041021, -711.5918214643528, -1042.933526828072, -909.5131975073588, -866.155542973949, -932.0283667947004, -1063.659317018726, -945.3314856162259, -1241.6276967777912, -100.99547029373521, -153.7436032391395, -64.80218815799738, -1192.9754238517896, -1058.0169681051832, -819.6965176028224, -366.4627379823186, -881.2963834537877, -1030.940783870113, -528.8743278378225, -1283.2115774200206, -585.6177961438451, -694.2938300404903, -256.71682792284895, -300.0985763557914, -1249.8980842245328, -514.8984783608936, -112.17358326213774, -1288.4504158739624, -1163.1970183778405, -621.2551393827754, -1167.1460498847846, -415.5921635310693, -802.4788120328353, -801.2504799125602, -728.5653491071637, -96.09715855469484, -1314.856824806358, -1170.1822156998533, -54.31274250448814, -1160.0759307278065, -659.0525166146714, -1014.5807525110996, -508.9600304044762, -1058.3673558344221, -884.2446102346345, -904.1267665374161, -510.98204129690384, -951.2122808531091, -574.2995434343754, -474.3496692892509, -626.8793579862571, -1164.9335101749516, -516.8798740694582], "episode_lengths": [150, 150, 150, 150, 150, 95, 150, 51, 150, 150, 150, 104, 126, 150, 150, 150, 150, 45, 150, 149, 150, 150, 150, 149, 150, 150, 150, 150, 150, 97, 150, 112, 60, 150, 150, 144, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 143, 150, 150, 150, 150, 119, 96, 70, 150, 150, 150, 124, 150, 150, 150, 150, 150, 130, 96, 98, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 65, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150], "policy_policy_0_reward": [-1360.978723675217, -849.9049390119914, -896.0791253673366, -997.120072253914, -840.0912426570367, -386.1891808957748, -214.7051910042674, -65.87483677664238, -1206.3718452070955, -420.18463148080633, -749.9614682330165, -287.5961793292007, -588.3157731603422, -728.6046883256286, -468.90884733318427, -759.8959307659169, -705.4537207207701, -13.441518198573167, -724.7147992742746, -650.3499988499321, -410.10235762015236, -538.2021894421999, -1184.9081761049688, -600.7341256788116, -453.12340856879086, -971.1833699183184, -817.2628479654733, -1029.8565072724687, -720.7206499436611, -362.9933112971885, -1010.9419453742888, -199.9167139756468, -166.19909640898814, -1279.1149860270982, -1098.4558741873848, -492.98317381476085, -769.091749521833, -1185.2116280742553, -750.1258667646279, -1022.1200913352986, -409.5144820613126, -680.7342595022152, -484.68041903459897, -779.2585320058788, -757.430246629874, -925.6213587588201, -1146.4243578518867, -374.4595272041021, -711.5918214643528, -1042.933526828072, -909.5131975073588, -866.155542973949, -932.0283667947004, -1063.659317018726, -945.3314856162259, -1241.6276967777912, -100.99547029373521, -153.7436032391395, -64.80218815799738, -1192.9754238517896, -1058.0169681051832, -819.6965176028224, -366.4627379823186, -881.2963834537877, -1030.940783870113, -528.8743278378225, -1283.2115774200206, -585.6177961438451, -694.2938300404903, -256.71682792284895, -300.0985763557914, -1249.8980842245328, -514.8984783608936, -112.17358326213774, -1288.4504158739624, -1163.1970183778405, -621.2551393827754, -1167.1460498847846, -415.5921635310693, -802.4788120328353, -801.2504799125602, -728.5653491071637, -96.09715855469484, -1314.856824806358, -1170.1822156998533, -54.31274250448814, -1160.0759307278065, -659.0525166146714, -1014.5807525110996, -508.9600304044762, -1058.3673558344221, -884.2446102346345, -904.1267665374161, -510.98204129690384, -951.2122808531091, -574.2995434343754, -474.3496692892509, -626.8793579862571, -1164.9335101749516, -516.8798740694582]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3221130636543905, "mean_inference_ms": 1.004975109643942, "mean_action_processing_ms": 0.1730920579418023, "mean_env_wait_ms": 1.7622018550068008, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.007874250411987305, "StateBufferConnector_ms": 0.005398750305175781, "ViewRequirementAgentConnector_ms": 0.13337159156799316}, "num_episodes": 27, "episode_return_max": -13.441518198573167, "episode_return_min": -1360.978723675217, "episode_return_mean": -730.7599668760947, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.61850620180326, "num_env_steps_trained_throughput_per_sec": 280.61850620180326, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12145.654, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12145.583, "sample_time_ms": 2755.699, "learn_time_ms": 9374.905, "learn_throughput": 426.671, "synch_weights_time_ms": 14.24}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00000", "date": "2024-08-03_03-54-00", "timestamp": 1722637440, "time_this_iter_s": 14.261752128601074, "time_total_s": 135.86281943321228, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad0dc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 135.86281943321228, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 12.86, "ram_util_percent": 17.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 87.4651342868805, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.339189884066582, "policy_loss": -0.009543926048597011, "vf_loss": 5.34447031741341, "vf_explained_var": 0.934987960755825, "kl": 0.01426427344916496, "entropy": 1.5803949444244305, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -49.826615678349896, "episode_reward_min": -1314.856824806358, "episode_reward_mean": -755.4401369220994, "episode_len_mean": 139.82, "episode_media": {}, "episodes_timesteps_total": 13982, "policy_reward_min": {"policy_0": -1314.856824806358}, "policy_reward_max": {"policy_0": -49.826615678349896}, "policy_reward_mean": {"policy_0": -755.4401369220994}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-362.9933112971885, -1010.9419453742888, -199.9167139756468, -166.19909640898814, -1279.1149860270982, -1098.4558741873848, -492.98317381476085, -769.091749521833, -1185.2116280742553, -750.1258667646279, -1022.1200913352986, -409.5144820613126, -680.7342595022152, -484.68041903459897, -779.2585320058788, -757.430246629874, -925.6213587588201, -1146.4243578518867, -374.4595272041021, -711.5918214643528, -1042.933526828072, -909.5131975073588, -866.155542973949, -932.0283667947004, -1063.659317018726, -945.3314856162259, -1241.6276967777912, -100.99547029373521, -153.7436032391395, -64.80218815799738, -1192.9754238517896, -1058.0169681051832, -819.6965176028224, -366.4627379823186, -881.2963834537877, -1030.940783870113, -528.8743278378225, -1283.2115774200206, -585.6177961438451, -694.2938300404903, -256.71682792284895, -300.0985763557914, -1249.8980842245328, -514.8984783608936, -112.17358326213774, -1288.4504158739624, -1163.1970183778405, -621.2551393827754, -1167.1460498847846, -415.5921635310693, -802.4788120328353, -801.2504799125602, -728.5653491071637, -96.09715855469484, -1314.856824806358, -1170.1822156998533, -54.31274250448814, -1160.0759307278065, -659.0525166146714, -1014.5807525110996, -508.9600304044762, -1058.3673558344221, -884.2446102346345, -904.1267665374161, -510.98204129690384, -951.2122808531091, -574.2995434343754, -474.3496692892509, -626.8793579862571, -1164.9335101749516, -516.8798740694582, -783.2306660948457, -1045.5893786516456, -413.4964593148176, -1174.801226768526, -587.2262614151203, -281.9296984947736, -420.3459505734782, -875.2532183801706, -1036.162069542405, -729.4060979061455, -1305.1823115512907, -658.6742786259354, -188.58007090640896, -1070.5807927724525, -49.826615678349896, -203.20927071794657, -479.99127332839606, -1121.273805108022, -700.8304406031817, -1277.2973141657412, -641.2816526149263, -952.5656081164872, -662.1892415571181, -931.4996479223369, -1006.8211608829516, -1117.7129459546106, -1156.6341071702082, -618.9862204415504, -618.2755643763762], "episode_lengths": [97, 150, 112, 60, 150, 150, 144, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 143, 150, 150, 150, 150, 119, 96, 70, 150, 150, 150, 124, 150, 150, 150, 150, 150, 130, 96, 98, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 65, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 74, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 138, 150], "policy_policy_0_reward": [-362.9933112971885, -1010.9419453742888, -199.9167139756468, -166.19909640898814, -1279.1149860270982, -1098.4558741873848, -492.98317381476085, -769.091749521833, -1185.2116280742553, -750.1258667646279, -1022.1200913352986, -409.5144820613126, -680.7342595022152, -484.68041903459897, -779.2585320058788, -757.430246629874, -925.6213587588201, -1146.4243578518867, -374.4595272041021, -711.5918214643528, -1042.933526828072, -909.5131975073588, -866.155542973949, -932.0283667947004, -1063.659317018726, -945.3314856162259, -1241.6276967777912, -100.99547029373521, -153.7436032391395, -64.80218815799738, -1192.9754238517896, -1058.0169681051832, -819.6965176028224, -366.4627379823186, -881.2963834537877, -1030.940783870113, -528.8743278378225, -1283.2115774200206, -585.6177961438451, -694.2938300404903, -256.71682792284895, -300.0985763557914, -1249.8980842245328, -514.8984783608936, -112.17358326213774, -1288.4504158739624, -1163.1970183778405, -621.2551393827754, -1167.1460498847846, -415.5921635310693, -802.4788120328353, -801.2504799125602, -728.5653491071637, -96.09715855469484, -1314.856824806358, -1170.1822156998533, -54.31274250448814, -1160.0759307278065, -659.0525166146714, -1014.5807525110996, -508.9600304044762, -1058.3673558344221, -884.2446102346345, -904.1267665374161, -510.98204129690384, -951.2122808531091, -574.2995434343754, -474.3496692892509, -626.8793579862571, -1164.9335101749516, -516.8798740694582, -783.2306660948457, -1045.5893786516456, -413.4964593148176, -1174.801226768526, -587.2262614151203, -281.9296984947736, -420.3459505734782, -875.2532183801706, -1036.162069542405, -729.4060979061455, -1305.1823115512907, -658.6742786259354, -188.58007090640896, -1070.5807927724525, -49.826615678349896, -203.20927071794657, -479.99127332839606, -1121.273805108022, -700.8304406031817, -1277.2973141657412, -641.2816526149263, -952.5656081164872, -662.1892415571181, -931.4996479223369, -1006.8211608829516, -1117.7129459546106, -1156.6341071702082, -618.9862204415504, -618.2755643763762]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32435334537374894, "mean_inference_ms": 1.008239943605538, "mean_action_processing_ms": 0.17385628901137307, "mean_env_wait_ms": 1.7747316272077667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0066339969635009766, "StateBufferConnector_ms": 0.004836082458496094, "ViewRequirementAgentConnector_ms": 0.11859679222106934}, "num_episodes": 29, "episode_return_max": -49.826615678349896, "episode_return_min": -1314.856824806358, "episode_return_mean": -755.4401369220994, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.48846663796445, "num_env_steps_trained_throughput_per_sec": 287.48846663796445, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12450.711, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12450.641, "sample_time_ms": 2759.568, "learn_time_ms": 9676.074, "learn_throughput": 413.391, "synch_weights_time_ms": 14.254}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00000", "date": "2024-08-03_03-54-14", "timestamp": 1722637454, "time_this_iter_s": 13.922485828399658, "time_total_s": 149.78530526161194, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8c37640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 149.78530526161194, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 12.834999999999999, "ram_util_percent": 17.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115.07772663434346, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.145168610662222, "policy_loss": -0.012193819806270767, "vf_loss": 4.152237630883852, "vf_explained_var": 0.9429115610197186, "kl": 0.017133638499126407, "entropy": 1.5281953447808823, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -49.826615678349896, "episode_reward_min": -1314.856824806358, "episode_reward_mean": -722.9585578925407, "episode_len_mean": 139.44, "episode_media": {}, "episodes_timesteps_total": 13944, "policy_reward_min": {"policy_0": -1314.856824806358}, "policy_reward_max": {"policy_0": -49.826615678349896}, "policy_reward_mean": {"policy_0": -722.9585578925407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.80218815799738, -1192.9754238517896, -1058.0169681051832, -819.6965176028224, -366.4627379823186, -881.2963834537877, -1030.940783870113, -528.8743278378225, -1283.2115774200206, -585.6177961438451, -694.2938300404903, -256.71682792284895, -300.0985763557914, -1249.8980842245328, -514.8984783608936, -112.17358326213774, -1288.4504158739624, -1163.1970183778405, -621.2551393827754, -1167.1460498847846, -415.5921635310693, -802.4788120328353, -801.2504799125602, -728.5653491071637, -96.09715855469484, -1314.856824806358, -1170.1822156998533, -54.31274250448814, -1160.0759307278065, -659.0525166146714, -1014.5807525110996, -508.9600304044762, -1058.3673558344221, -884.2446102346345, -904.1267665374161, -510.98204129690384, -951.2122808531091, -574.2995434343754, -474.3496692892509, -626.8793579862571, -1164.9335101749516, -516.8798740694582, -783.2306660948457, -1045.5893786516456, -413.4964593148176, -1174.801226768526, -587.2262614151203, -281.9296984947736, -420.3459505734782, -875.2532183801706, -1036.162069542405, -729.4060979061455, -1305.1823115512907, -658.6742786259354, -188.58007090640896, -1070.5807927724525, -49.826615678349896, -203.20927071794657, -479.99127332839606, -1121.273805108022, -700.8304406031817, -1277.2973141657412, -641.2816526149263, -952.5656081164872, -662.1892415571181, -931.4996479223369, -1006.8211608829516, -1117.7129459546106, -1156.6341071702082, -618.9862204415504, -618.2755643763762, -626.0054869369619, -1120.8988958320078, -605.8876271770866, -445.62737421436987, -853.9288840348372, -700.2808083309375, -462.05515750242273, -700.954236694055, -760.9302521992522, -493.39950863806087, -753.8387512531854, -870.3844390816802, -486.9760068140193, -660.089372097593, -970.0945390907667, -652.2951750179892, -777.4403321033062, -865.204481821124, -311.14818700383523, -216.18693692346886, -149.65606820087785, -1097.6518162515463, -778.4779824332653, -300.56895273698984, -968.6843801956254, -1166.0010889123262, -385.05436238502534, -306.65458233986243, -128.3240591657859], "episode_lengths": [70, 150, 150, 150, 124, 150, 150, 150, 150, 150, 130, 96, 98, 150, 150, 80, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 65, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 74, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 94, 89, 150, 150, 102, 150, 150, 97, 94, 67], "policy_policy_0_reward": [-64.80218815799738, -1192.9754238517896, -1058.0169681051832, -819.6965176028224, -366.4627379823186, -881.2963834537877, -1030.940783870113, -528.8743278378225, -1283.2115774200206, -585.6177961438451, -694.2938300404903, -256.71682792284895, -300.0985763557914, -1249.8980842245328, -514.8984783608936, -112.17358326213774, -1288.4504158739624, -1163.1970183778405, -621.2551393827754, -1167.1460498847846, -415.5921635310693, -802.4788120328353, -801.2504799125602, -728.5653491071637, -96.09715855469484, -1314.856824806358, -1170.1822156998533, -54.31274250448814, -1160.0759307278065, -659.0525166146714, -1014.5807525110996, -508.9600304044762, -1058.3673558344221, -884.2446102346345, -904.1267665374161, -510.98204129690384, -951.2122808531091, -574.2995434343754, -474.3496692892509, -626.8793579862571, -1164.9335101749516, -516.8798740694582, -783.2306660948457, -1045.5893786516456, -413.4964593148176, -1174.801226768526, -587.2262614151203, -281.9296984947736, -420.3459505734782, -875.2532183801706, -1036.162069542405, -729.4060979061455, -1305.1823115512907, -658.6742786259354, -188.58007090640896, -1070.5807927724525, -49.826615678349896, -203.20927071794657, -479.99127332839606, -1121.273805108022, -700.8304406031817, -1277.2973141657412, -641.2816526149263, -952.5656081164872, -662.1892415571181, -931.4996479223369, -1006.8211608829516, -1117.7129459546106, -1156.6341071702082, -618.9862204415504, -618.2755643763762, -626.0054869369619, -1120.8988958320078, -605.8876271770866, -445.62737421436987, -853.9288840348372, -700.2808083309375, -462.05515750242273, -700.954236694055, -760.9302521992522, -493.39950863806087, -753.8387512531854, -870.3844390816802, -486.9760068140193, -660.089372097593, -970.0945390907667, -652.2951750179892, -777.4403321033062, -865.204481821124, -311.14818700383523, -216.18693692346886, -149.65606820087785, -1097.6518162515463, -778.4779824332653, -300.56895273698984, -968.6843801956254, -1166.0010889123262, -385.05436238502534, -306.65458233986243, -128.3240591657859]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.32180752445989647, "mean_inference_ms": 0.9984062754111847, "mean_action_processing_ms": 0.1727381871252099, "mean_env_wait_ms": 1.7639041028479625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005488872528076172, "StateBufferConnector_ms": 0.004045009613037109, "ViewRequirementAgentConnector_ms": 0.10129833221435547}, "num_episodes": 29, "episode_return_max": -49.826615678349896, "episode_return_min": -1314.856824806358, "episode_return_mean": -722.9585578925407, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.0493868811035, "num_env_steps_trained_throughput_per_sec": 277.0493868811035, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12941.953, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12941.881, "sample_time_ms": 2763.414, "learn_time_ms": 10162.989, "learn_throughput": 393.585, "synch_weights_time_ms": 14.693}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00000", "date": "2024-08-03_03-54-29", "timestamp": 1722637469, "time_this_iter_s": 14.444813251495361, "time_total_s": 164.2301185131073, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8c35990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.2301185131073, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.28095238095238, "ram_util_percent": 17.161904761904758}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 110.41581531763077, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.542708789805571, "policy_loss": -0.012680670806730632, "vf_loss": 4.550383282452822, "vf_explained_var": 0.9674113309631746, "kl": 0.01673992471514795, "entropy": 1.5798368708540995, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -49.826615678349896, "episode_reward_min": -1305.1823115512907, "episode_reward_mean": -716.379709303166, "episode_len_mean": 141.37, "episode_media": {}, "episodes_timesteps_total": 14137, "policy_reward_min": {"policy_0": -1305.1823115512907}, "policy_reward_max": {"policy_0": -49.826615678349896}, "policy_reward_mean": {"policy_0": -716.379709303166}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-659.0525166146714, -1014.5807525110996, -508.9600304044762, -1058.3673558344221, -884.2446102346345, -904.1267665374161, -510.98204129690384, -951.2122808531091, -574.2995434343754, -474.3496692892509, -626.8793579862571, -1164.9335101749516, -516.8798740694582, -783.2306660948457, -1045.5893786516456, -413.4964593148176, -1174.801226768526, -587.2262614151203, -281.9296984947736, -420.3459505734782, -875.2532183801706, -1036.162069542405, -729.4060979061455, -1305.1823115512907, -658.6742786259354, -188.58007090640896, -1070.5807927724525, -49.826615678349896, -203.20927071794657, -479.99127332839606, -1121.273805108022, -700.8304406031817, -1277.2973141657412, -641.2816526149263, -952.5656081164872, -662.1892415571181, -931.4996479223369, -1006.8211608829516, -1117.7129459546106, -1156.6341071702082, -618.9862204415504, -618.2755643763762, -626.0054869369619, -1120.8988958320078, -605.8876271770866, -445.62737421436987, -853.9288840348372, -700.2808083309375, -462.05515750242273, -700.954236694055, -760.9302521992522, -493.39950863806087, -753.8387512531854, -870.3844390816802, -486.9760068140193, -660.089372097593, -970.0945390907667, -652.2951750179892, -777.4403321033062, -865.204481821124, -311.14818700383523, -216.18693692346886, -149.65606820087785, -1097.6518162515463, -778.4779824332653, -300.56895273698984, -968.6843801956254, -1166.0010889123262, -385.05436238502534, -306.65458233986243, -128.3240591657859, -761.6415708885181, -891.3592498445241, -357.33192832878603, -368.8862934551633, -1048.8516092081895, -568.7881238176273, -914.2107085385934, -1126.5770193526816, -1083.5588109840585, -320.662566491678, -857.8330912963763, -918.2430630377606, -396.4551462477714, -804.9704496173314, -570.4861710562312, -1223.8174281591, -778.1678147159965, -327.8684385752353, -842.1844297252251, -856.138905121191, -709.001536084709, -1242.7332852765478, -797.1763863059301, -918.4987270979807, -66.73952784233407, -789.8172878353685, -488.50033315260225, -235.61116077556346, -799.4384632180094], "episode_lengths": [150, 150, 138, 150, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 74, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 94, 89, 150, 150, 102, 150, 150, 97, 94, 67, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 93, 150, 150, 110, 150], "policy_policy_0_reward": [-659.0525166146714, -1014.5807525110996, -508.9600304044762, -1058.3673558344221, -884.2446102346345, -904.1267665374161, -510.98204129690384, -951.2122808531091, -574.2995434343754, -474.3496692892509, -626.8793579862571, -1164.9335101749516, -516.8798740694582, -783.2306660948457, -1045.5893786516456, -413.4964593148176, -1174.801226768526, -587.2262614151203, -281.9296984947736, -420.3459505734782, -875.2532183801706, -1036.162069542405, -729.4060979061455, -1305.1823115512907, -658.6742786259354, -188.58007090640896, -1070.5807927724525, -49.826615678349896, -203.20927071794657, -479.99127332839606, -1121.273805108022, -700.8304406031817, -1277.2973141657412, -641.2816526149263, -952.5656081164872, -662.1892415571181, -931.4996479223369, -1006.8211608829516, -1117.7129459546106, -1156.6341071702082, -618.9862204415504, -618.2755643763762, -626.0054869369619, -1120.8988958320078, -605.8876271770866, -445.62737421436987, -853.9288840348372, -700.2808083309375, -462.05515750242273, -700.954236694055, -760.9302521992522, -493.39950863806087, -753.8387512531854, -870.3844390816802, -486.9760068140193, -660.089372097593, -970.0945390907667, -652.2951750179892, -777.4403321033062, -865.204481821124, -311.14818700383523, -216.18693692346886, -149.65606820087785, -1097.6518162515463, -778.4779824332653, -300.56895273698984, -968.6843801956254, -1166.0010889123262, -385.05436238502534, -306.65458233986243, -128.3240591657859, -761.6415708885181, -891.3592498445241, -357.33192832878603, -368.8862934551633, -1048.8516092081895, -568.7881238176273, -914.2107085385934, -1126.5770193526816, -1083.5588109840585, -320.662566491678, -857.8330912963763, -918.2430630377606, -396.4551462477714, -804.9704496173314, -570.4861710562312, -1223.8174281591, -778.1678147159965, -327.8684385752353, -842.1844297252251, -856.138905121191, -709.001536084709, -1242.7332852765478, -797.1763863059301, -918.4987270979807, -66.73952784233407, -789.8172878353685, -488.50033315260225, -235.61116077556346, -799.4384632180094]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31965188651793136, "mean_inference_ms": 0.990654344366555, "mean_action_processing_ms": 0.17191953138623758, "mean_env_wait_ms": 1.7552612131186194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005505800247192383, "StateBufferConnector_ms": 0.003997087478637695, "ViewRequirementAgentConnector_ms": 0.1003570556640625}, "num_episodes": 29, "episode_return_max": -49.826615678349896, "episode_return_min": -1305.1823115512907, "episode_return_mean": -716.379709303166, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.7102867834106, "num_env_steps_trained_throughput_per_sec": 273.7102867834106, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13282.932, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13282.858, "sample_time_ms": 2769.867, "learn_time_ms": 10497.391, "learn_throughput": 381.047, "synch_weights_time_ms": 14.817}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00000", "date": "2024-08-03_03-54-43", "timestamp": 1722637483, "time_this_iter_s": 14.621132850646973, "time_total_s": 178.85125136375427, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad0ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 178.85125136375427, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 13.025, "ram_util_percent": 17.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.36574751536051, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.510407515739401, "policy_loss": -0.009541364092729054, "vf_loss": 4.5146041214466095, "vf_explained_var": 0.9731990186497569, "kl": 0.017867403357013256, "entropy": 1.546652061616381, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -48.710982972654904, "episode_reward_min": -1277.2973141657412, "episode_reward_mean": -690.1920602673804, "episode_len_mean": 137.03, "episode_media": {}, "episodes_timesteps_total": 13703, "policy_reward_min": {"policy_0": -1277.2973141657412}, "policy_reward_max": {"policy_0": -48.710982972654904}, "policy_reward_mean": {"policy_0": -690.1920602673804}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1121.273805108022, -700.8304406031817, -1277.2973141657412, -641.2816526149263, -952.5656081164872, -662.1892415571181, -931.4996479223369, -1006.8211608829516, -1117.7129459546106, -1156.6341071702082, -618.9862204415504, -618.2755643763762, -626.0054869369619, -1120.8988958320078, -605.8876271770866, -445.62737421436987, -853.9288840348372, -700.2808083309375, -462.05515750242273, -700.954236694055, -760.9302521992522, -493.39950863806087, -753.8387512531854, -870.3844390816802, -486.9760068140193, -660.089372097593, -970.0945390907667, -652.2951750179892, -777.4403321033062, -865.204481821124, -311.14818700383523, -216.18693692346886, -149.65606820087785, -1097.6518162515463, -778.4779824332653, -300.56895273698984, -968.6843801956254, -1166.0010889123262, -385.05436238502534, -306.65458233986243, -128.3240591657859, -761.6415708885181, -891.3592498445241, -357.33192832878603, -368.8862934551633, -1048.8516092081895, -568.7881238176273, -914.2107085385934, -1126.5770193526816, -1083.5588109840585, -320.662566491678, -857.8330912963763, -918.2430630377606, -396.4551462477714, -804.9704496173314, -570.4861710562312, -1223.8174281591, -778.1678147159965, -327.8684385752353, -842.1844297252251, -856.138905121191, -709.001536084709, -1242.7332852765478, -797.1763863059301, -918.4987270979807, -66.73952784233407, -789.8172878353685, -488.50033315260225, -235.61116077556346, -799.4384632180094, -443.2858736608908, -1014.1169820311492, -737.2564293607148, -428.5905130459879, -180.7871744396996, -1115.2657413702432, -962.7425655774492, -63.12333593232167, -395.4159919131517, -285.6428201986999, -869.4983225639877, -57.18680622988065, -56.64758656867684, -960.401420209174, -1227.0808175093034, -982.3938649111224, -467.9953502734897, -751.2713382355889, -865.6772747351185, -901.958617696827, -331.75649682188526, -807.8646983898714, -600.4453854285997, -1092.62058673155, -417.14672081708295, -48.710982972654904, -959.5522189916217, -353.8212701258677, -1033.8587855509447, -121.47307409163048], "episode_lengths": [150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 94, 89, 150, 150, 102, 150, 150, 97, 94, 67, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 93, 150, 150, 110, 150, 150, 150, 150, 150, 71, 150, 150, 68, 150, 99, 150, 71, 54, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 51, 150, 150, 150, 52], "policy_policy_0_reward": [-1121.273805108022, -700.8304406031817, -1277.2973141657412, -641.2816526149263, -952.5656081164872, -662.1892415571181, -931.4996479223369, -1006.8211608829516, -1117.7129459546106, -1156.6341071702082, -618.9862204415504, -618.2755643763762, -626.0054869369619, -1120.8988958320078, -605.8876271770866, -445.62737421436987, -853.9288840348372, -700.2808083309375, -462.05515750242273, -700.954236694055, -760.9302521992522, -493.39950863806087, -753.8387512531854, -870.3844390816802, -486.9760068140193, -660.089372097593, -970.0945390907667, -652.2951750179892, -777.4403321033062, -865.204481821124, -311.14818700383523, -216.18693692346886, -149.65606820087785, -1097.6518162515463, -778.4779824332653, -300.56895273698984, -968.6843801956254, -1166.0010889123262, -385.05436238502534, -306.65458233986243, -128.3240591657859, -761.6415708885181, -891.3592498445241, -357.33192832878603, -368.8862934551633, -1048.8516092081895, -568.7881238176273, -914.2107085385934, -1126.5770193526816, -1083.5588109840585, -320.662566491678, -857.8330912963763, -918.2430630377606, -396.4551462477714, -804.9704496173314, -570.4861710562312, -1223.8174281591, -778.1678147159965, -327.8684385752353, -842.1844297252251, -856.138905121191, -709.001536084709, -1242.7332852765478, -797.1763863059301, -918.4987270979807, -66.73952784233407, -789.8172878353685, -488.50033315260225, -235.61116077556346, -799.4384632180094, -443.2858736608908, -1014.1169820311492, -737.2564293607148, -428.5905130459879, -180.7871744396996, -1115.2657413702432, -962.7425655774492, -63.12333593232167, -395.4159919131517, -285.6428201986999, -869.4983225639877, -57.18680622988065, -56.64758656867684, -960.401420209174, -1227.0808175093034, -982.3938649111224, -467.9953502734897, -751.2713382355889, -865.6772747351185, -901.958617696827, -331.75649682188526, -807.8646983898714, -600.4453854285997, -1092.62058673155, -417.14672081708295, -48.710982972654904, -959.5522189916217, -353.8212701258677, -1033.8587855509447, -121.47307409163048]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31777017829356125, "mean_inference_ms": 0.9843727369688938, "mean_action_processing_ms": 0.17133867398510833, "mean_env_wait_ms": 1.7480174993707807, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005507230758666992, "StateBufferConnector_ms": 0.0040166378021240234, "ViewRequirementAgentConnector_ms": 0.1004638671875}, "num_episodes": 30, "episode_return_max": -48.710982972654904, "episode_return_min": -1277.2973141657412, "episode_return_mean": -690.1920602673804, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.37928775312065, "num_env_steps_trained_throughput_per_sec": 269.37928775312065, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13403.502, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13403.426, "sample_time_ms": 2770.784, "learn_time_ms": 10616.566, "learn_throughput": 376.77, "synch_weights_time_ms": 15.286}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00000", "date": "2024-08-03_03-54-58", "timestamp": 1722637498, "time_this_iter_s": 14.85636568069458, "time_total_s": 193.70761704444885, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad0670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 193.70761704444885, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 12.686363636363636, "ram_util_percent": 17.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 129.6735740184784, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.126547754307588, "policy_loss": -0.008040434586291667, "vf_loss": 4.1302316159009935, "vf_explained_var": 0.9747249685227871, "kl": 0.014570940368745748, "entropy": 1.4709443796426058, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -48.710982972654904, "episode_reward_min": -1344.5685263206524, "episode_reward_mean": -647.9332697485984, "episode_len_mean": 132.82, "episode_media": {}, "episodes_timesteps_total": 13282, "policy_reward_min": {"policy_0": -1344.5685263206524}, "policy_reward_max": {"policy_0": -48.710982972654904}, "policy_reward_mean": {"policy_0": -647.9332697485984}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-311.14818700383523, -216.18693692346886, -149.65606820087785, -1097.6518162515463, -778.4779824332653, -300.56895273698984, -968.6843801956254, -1166.0010889123262, -385.05436238502534, -306.65458233986243, -128.3240591657859, -761.6415708885181, -891.3592498445241, -357.33192832878603, -368.8862934551633, -1048.8516092081895, -568.7881238176273, -914.2107085385934, -1126.5770193526816, -1083.5588109840585, -320.662566491678, -857.8330912963763, -918.2430630377606, -396.4551462477714, -804.9704496173314, -570.4861710562312, -1223.8174281591, -778.1678147159965, -327.8684385752353, -842.1844297252251, -856.138905121191, -709.001536084709, -1242.7332852765478, -797.1763863059301, -918.4987270979807, -66.73952784233407, -789.8172878353685, -488.50033315260225, -235.61116077556346, -799.4384632180094, -443.2858736608908, -1014.1169820311492, -737.2564293607148, -428.5905130459879, -180.7871744396996, -1115.2657413702432, -962.7425655774492, -63.12333593232167, -395.4159919131517, -285.6428201986999, -869.4983225639877, -57.18680622988065, -56.64758656867684, -960.401420209174, -1227.0808175093034, -982.3938649111224, -467.9953502734897, -751.2713382355889, -865.6772747351185, -901.958617696827, -331.75649682188526, -807.8646983898714, -600.4453854285997, -1092.62058673155, -417.14672081708295, -48.710982972654904, -959.5522189916217, -353.8212701258677, -1033.8587855509447, -121.47307409163048, -837.6778616022942, -681.3390340408754, -380.8488334993653, -108.16240666450791, -1202.6240869052353, -499.3654816525344, -1143.693564012718, -985.5948158745916, -193.7115705286157, -367.71560891287334, -105.43499659974678, -151.10266627978697, -813.7782794818606, -1344.5685263206524, -734.2187829097705, -783.1934350057493, -1003.147349932858, -356.4912447801781, -263.01889564099446, -903.3839067681868, -450.7506321689907, -763.1993690574603, -906.7081685736083, -422.00908449459894, -624.3406902179937, -494.03776568092593, -924.9171761265817, -375.31309845681324, -714.1708393857343, -851.2618142988676], "episode_lengths": [124, 94, 89, 150, 150, 102, 150, 150, 97, 94, 67, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 93, 150, 150, 110, 150, 150, 150, 150, 150, 71, 150, 150, 68, 150, 99, 150, 71, 54, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 51, 150, 150, 150, 52, 150, 150, 120, 71, 150, 150, 150, 150, 101, 126, 68, 67, 150, 150, 150, 150, 150, 111, 104, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150], "policy_policy_0_reward": [-311.14818700383523, -216.18693692346886, -149.65606820087785, -1097.6518162515463, -778.4779824332653, -300.56895273698984, -968.6843801956254, -1166.0010889123262, -385.05436238502534, -306.65458233986243, -128.3240591657859, -761.6415708885181, -891.3592498445241, -357.33192832878603, -368.8862934551633, -1048.8516092081895, -568.7881238176273, -914.2107085385934, -1126.5770193526816, -1083.5588109840585, -320.662566491678, -857.8330912963763, -918.2430630377606, -396.4551462477714, -804.9704496173314, -570.4861710562312, -1223.8174281591, -778.1678147159965, -327.8684385752353, -842.1844297252251, -856.138905121191, -709.001536084709, -1242.7332852765478, -797.1763863059301, -918.4987270979807, -66.73952784233407, -789.8172878353685, -488.50033315260225, -235.61116077556346, -799.4384632180094, -443.2858736608908, -1014.1169820311492, -737.2564293607148, -428.5905130459879, -180.7871744396996, -1115.2657413702432, -962.7425655774492, -63.12333593232167, -395.4159919131517, -285.6428201986999, -869.4983225639877, -57.18680622988065, -56.64758656867684, -960.401420209174, -1227.0808175093034, -982.3938649111224, -467.9953502734897, -751.2713382355889, -865.6772747351185, -901.958617696827, -331.75649682188526, -807.8646983898714, -600.4453854285997, -1092.62058673155, -417.14672081708295, -48.710982972654904, -959.5522189916217, -353.8212701258677, -1033.8587855509447, -121.47307409163048, -837.6778616022942, -681.3390340408754, -380.8488334993653, -108.16240666450791, -1202.6240869052353, -499.3654816525344, -1143.693564012718, -985.5948158745916, -193.7115705286157, -367.71560891287334, -105.43499659974678, -151.10266627978697, -813.7782794818606, -1344.5685263206524, -734.2187829097705, -783.1934350057493, -1003.147349932858, -356.4912447801781, -263.01889564099446, -903.3839067681868, -450.7506321689907, -763.1993690574603, -906.7081685736083, -422.00908449459894, -624.3406902179937, -494.03776568092593, -924.9171761265817, -375.31309845681324, -714.1708393857343, -851.2618142988676]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31655692837443206, "mean_inference_ms": 0.9795436692677194, "mean_action_processing_ms": 0.17091843781597946, "mean_env_wait_ms": 1.7416231463110543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005323886871337891, "StateBufferConnector_ms": 0.004012584686279297, "ViewRequirementAgentConnector_ms": 0.09986114501953125}, "num_episodes": 30, "episode_return_max": -48.710982972654904, "episode_return_min": -1344.5685263206524, "episode_return_mean": -647.9332697485984, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.6616686236471, "num_env_steps_trained_throughput_per_sec": 275.6616686236471, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13402.429, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13402.352, "sample_time_ms": 2765.825, "learn_time_ms": 10621.058, "learn_throughput": 376.61, "synch_weights_time_ms": 14.688}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00000", "date": "2024-08-03_03-55-13", "timestamp": 1722637513, "time_this_iter_s": 14.518419742584229, "time_total_s": 208.22603678703308, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad2b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 208.22603678703308, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.939999999999998, "ram_util_percent": 17.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 134.93975217342376, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.135743499795596, "policy_loss": -0.009189600518341952, "vf_loss": 4.140849254528681, "vf_explained_var": 0.9726549337307612, "kl": 0.013668390614717908, "entropy": 1.6673213141659895, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -48.710982972654904, "episode_reward_min": -1344.5685263206524, "episode_reward_mean": -644.7290427856742, "episode_len_mean": 132.76, "episode_media": {}, "episodes_timesteps_total": 13276, "policy_reward_min": {"policy_0": -1344.5685263206524}, "policy_reward_max": {"policy_0": -48.710982972654904}, "policy_reward_mean": {"policy_0": -644.7290427856742}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-856.138905121191, -709.001536084709, -1242.7332852765478, -797.1763863059301, -918.4987270979807, -66.73952784233407, -789.8172878353685, -488.50033315260225, -235.61116077556346, -799.4384632180094, -443.2858736608908, -1014.1169820311492, -737.2564293607148, -428.5905130459879, -180.7871744396996, -1115.2657413702432, -962.7425655774492, -63.12333593232167, -395.4159919131517, -285.6428201986999, -869.4983225639877, -57.18680622988065, -56.64758656867684, -960.401420209174, -1227.0808175093034, -982.3938649111224, -467.9953502734897, -751.2713382355889, -865.6772747351185, -901.958617696827, -331.75649682188526, -807.8646983898714, -600.4453854285997, -1092.62058673155, -417.14672081708295, -48.710982972654904, -959.5522189916217, -353.8212701258677, -1033.8587855509447, -121.47307409163048, -837.6778616022942, -681.3390340408754, -380.8488334993653, -108.16240666450791, -1202.6240869052353, -499.3654816525344, -1143.693564012718, -985.5948158745916, -193.7115705286157, -367.71560891287334, -105.43499659974678, -151.10266627978697, -813.7782794818606, -1344.5685263206524, -734.2187829097705, -783.1934350057493, -1003.147349932858, -356.4912447801781, -263.01889564099446, -903.3839067681868, -450.7506321689907, -763.1993690574603, -906.7081685736083, -422.00908449459894, -624.3406902179937, -494.03776568092593, -924.9171761265817, -375.31309845681324, -714.1708393857343, -851.2618142988676, -435.9117742442244, -769.7464708319809, -266.08311471898674, -330.02704445362065, -508.05343543944304, -658.2661993838905, -1004.0760033744491, -965.7126137852177, -920.9298679353101, -888.9108990566268, -772.9438305659389, -1051.1977847903695, -122.90724058115538, -155.91263529754713, -853.8522479947884, -91.39174904444315, -873.1680439009253, -1207.0239221490704, -968.0349050617313, -155.5521279428065, -983.6751656096527, -1063.9491049607775, -814.4238958927378, -645.7522410216038, -813.3213508397889, -577.8530103147621, -494.9719100856843, -55.88997207996445, -282.5561060629977, -917.7849661765424], "episode_lengths": [150, 150, 150, 150, 150, 93, 150, 150, 110, 150, 150, 150, 150, 150, 71, 150, 150, 68, 150, 99, 150, 71, 54, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 51, 150, 150, 150, 52, 150, 150, 120, 71, 150, 150, 150, 150, 101, 126, 68, 67, 150, 150, 150, 150, 150, 111, 104, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 88, 122, 150, 150, 150, 150, 150, 150, 150, 150, 81, 81, 150, 87, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 40, 90, 150], "policy_policy_0_reward": [-856.138905121191, -709.001536084709, -1242.7332852765478, -797.1763863059301, -918.4987270979807, -66.73952784233407, -789.8172878353685, -488.50033315260225, -235.61116077556346, -799.4384632180094, -443.2858736608908, -1014.1169820311492, -737.2564293607148, -428.5905130459879, -180.7871744396996, -1115.2657413702432, -962.7425655774492, -63.12333593232167, -395.4159919131517, -285.6428201986999, -869.4983225639877, -57.18680622988065, -56.64758656867684, -960.401420209174, -1227.0808175093034, -982.3938649111224, -467.9953502734897, -751.2713382355889, -865.6772747351185, -901.958617696827, -331.75649682188526, -807.8646983898714, -600.4453854285997, -1092.62058673155, -417.14672081708295, -48.710982972654904, -959.5522189916217, -353.8212701258677, -1033.8587855509447, -121.47307409163048, -837.6778616022942, -681.3390340408754, -380.8488334993653, -108.16240666450791, -1202.6240869052353, -499.3654816525344, -1143.693564012718, -985.5948158745916, -193.7115705286157, -367.71560891287334, -105.43499659974678, -151.10266627978697, -813.7782794818606, -1344.5685263206524, -734.2187829097705, -783.1934350057493, -1003.147349932858, -356.4912447801781, -263.01889564099446, -903.3839067681868, -450.7506321689907, -763.1993690574603, -906.7081685736083, -422.00908449459894, -624.3406902179937, -494.03776568092593, -924.9171761265817, -375.31309845681324, -714.1708393857343, -851.2618142988676, -435.9117742442244, -769.7464708319809, -266.08311471898674, -330.02704445362065, -508.05343543944304, -658.2661993838905, -1004.0760033744491, -965.7126137852177, -920.9298679353101, -888.9108990566268, -772.9438305659389, -1051.1977847903695, -122.90724058115538, -155.91263529754713, -853.8522479947884, -91.39174904444315, -873.1680439009253, -1207.0239221490704, -968.0349050617313, -155.5521279428065, -983.6751656096527, -1063.9491049607775, -814.4238958927378, -645.7522410216038, -813.3213508397889, -577.8530103147621, -494.9719100856843, -55.88997207996445, -282.5561060629977, -917.7849661765424]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3150308466619061, "mean_inference_ms": 0.9742974020812605, "mean_action_processing_ms": 0.1702994644924086, "mean_env_wait_ms": 1.7359392248643628, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005292177200317383, "StateBufferConnector_ms": 0.004025697708129883, "ViewRequirementAgentConnector_ms": 0.09989404678344727}, "num_episodes": 30, "episode_return_max": -48.710982972654904, "episode_return_min": -1344.5685263206524, "episode_return_mean": -644.7290427856742, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.0543642206046, "num_env_steps_trained_throughput_per_sec": 275.0543642206046, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13831.235, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13831.16, "sample_time_ms": 2759.162, "learn_time_ms": 11056.336, "learn_throughput": 361.783, "synch_weights_time_ms": 14.881}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00000", "date": "2024-08-03_03-55-28", "timestamp": 1722637528, "time_this_iter_s": 14.549735069274902, "time_total_s": 222.77577185630798, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad36d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 222.77577185630798, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 13.285714285714286, "ram_util_percent": 17.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 121.27531309127808, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.532950424651305, "policy_loss": -0.009824042909410005, "vf_loss": 4.538598776360353, "vf_explained_var": 0.9703453799088796, "kl": 0.013969217625223499, "entropy": 1.507448709011078, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -48.710982972654904, "episode_reward_min": -1396.450354599286, "episode_reward_mean": -666.8383429037458, "episode_len_mean": 136.56, "episode_media": {}, "episodes_timesteps_total": 13656, "policy_reward_min": {"policy_0": -1396.450354599286}, "policy_reward_max": {"policy_0": -48.710982972654904}, "policy_reward_mean": {"policy_0": -666.8383429037458}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-751.2713382355889, -865.6772747351185, -901.958617696827, -331.75649682188526, -807.8646983898714, -600.4453854285997, -1092.62058673155, -417.14672081708295, -48.710982972654904, -959.5522189916217, -353.8212701258677, -1033.8587855509447, -121.47307409163048, -837.6778616022942, -681.3390340408754, -380.8488334993653, -108.16240666450791, -1202.6240869052353, -499.3654816525344, -1143.693564012718, -985.5948158745916, -193.7115705286157, -367.71560891287334, -105.43499659974678, -151.10266627978697, -813.7782794818606, -1344.5685263206524, -734.2187829097705, -783.1934350057493, -1003.147349932858, -356.4912447801781, -263.01889564099446, -903.3839067681868, -450.7506321689907, -763.1993690574603, -906.7081685736083, -422.00908449459894, -624.3406902179937, -494.03776568092593, -924.9171761265817, -375.31309845681324, -714.1708393857343, -851.2618142988676, -435.9117742442244, -769.7464708319809, -266.08311471898674, -330.02704445362065, -508.05343543944304, -658.2661993838905, -1004.0760033744491, -965.7126137852177, -920.9298679353101, -888.9108990566268, -772.9438305659389, -1051.1977847903695, -122.90724058115538, -155.91263529754713, -853.8522479947884, -91.39174904444315, -873.1680439009253, -1207.0239221490704, -968.0349050617313, -155.5521279428065, -983.6751656096527, -1063.9491049607775, -814.4238958927378, -645.7522410216038, -813.3213508397889, -577.8530103147621, -494.9719100856843, -55.88997207996445, -282.5561060629977, -917.7849661765424, -808.3734669724848, -879.3311285139841, -733.305313409933, -429.77755810997434, -712.6002912230863, -176.791814934646, -1088.5718686431992, -783.0596277407897, -263.4574776581192, -407.6625994073207, -485.5689827275168, -469.01009181956414, -1006.0027335064033, -350.7651634248154, -905.0853463846536, -768.246868934584, -1181.68258501179, -350.91759551229825, -842.0749436188718, -839.8335932904489, -573.52507714345, -691.3296997591208, -1396.450354599286, -608.1595026837633, -1275.6220933429677, -471.5618954683189, -863.2495464719605], "episode_lengths": [150, 150, 150, 98, 150, 150, 150, 150, 51, 150, 150, 150, 52, 150, 150, 120, 71, 150, 150, 150, 150, 101, 126, 68, 67, 150, 150, 150, 150, 150, 111, 104, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 88, 122, 150, 150, 150, 150, 150, 150, 150, 150, 81, 81, 150, 87, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 40, 90, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-751.2713382355889, -865.6772747351185, -901.958617696827, -331.75649682188526, -807.8646983898714, -600.4453854285997, -1092.62058673155, -417.14672081708295, -48.710982972654904, -959.5522189916217, -353.8212701258677, -1033.8587855509447, -121.47307409163048, -837.6778616022942, -681.3390340408754, -380.8488334993653, -108.16240666450791, -1202.6240869052353, -499.3654816525344, -1143.693564012718, -985.5948158745916, -193.7115705286157, -367.71560891287334, -105.43499659974678, -151.10266627978697, -813.7782794818606, -1344.5685263206524, -734.2187829097705, -783.1934350057493, -1003.147349932858, -356.4912447801781, -263.01889564099446, -903.3839067681868, -450.7506321689907, -763.1993690574603, -906.7081685736083, -422.00908449459894, -624.3406902179937, -494.03776568092593, -924.9171761265817, -375.31309845681324, -714.1708393857343, -851.2618142988676, -435.9117742442244, -769.7464708319809, -266.08311471898674, -330.02704445362065, -508.05343543944304, -658.2661993838905, -1004.0760033744491, -965.7126137852177, -920.9298679353101, -888.9108990566268, -772.9438305659389, -1051.1977847903695, -122.90724058115538, -155.91263529754713, -853.8522479947884, -91.39174904444315, -873.1680439009253, -1207.0239221490704, -968.0349050617313, -155.5521279428065, -983.6751656096527, -1063.9491049607775, -814.4238958927378, -645.7522410216038, -813.3213508397889, -577.8530103147621, -494.9719100856843, -55.88997207996445, -282.5561060629977, -917.7849661765424, -808.3734669724848, -879.3311285139841, -733.305313409933, -429.77755810997434, -712.6002912230863, -176.791814934646, -1088.5718686431992, -783.0596277407897, -263.4574776581192, -407.6625994073207, -485.5689827275168, -469.01009181956414, -1006.0027335064033, -350.7651634248154, -905.0853463846536, -768.246868934584, -1181.68258501179, -350.91759551229825, -842.0749436188718, -839.8335932904489, -573.52507714345, -691.3296997591208, -1396.450354599286, -608.1595026837633, -1275.6220933429677, -471.5618954683189, -863.2495464719605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.31380861176177616, "mean_inference_ms": 0.9698853928096564, "mean_action_processing_ms": 0.1697028742479162, "mean_env_wait_ms": 1.730963959307571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005242824554443359, "StateBufferConnector_ms": 0.004054069519042969, "ViewRequirementAgentConnector_ms": 0.10048580169677734}, "num_episodes": 27, "episode_return_max": -48.710982972654904, "episode_return_min": -1396.450354599286, "episode_return_mean": -666.8383429037458, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.76028612782045, "num_env_steps_trained_throughput_per_sec": 270.76028612782045, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 14008.305, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14008.232, "sample_time_ms": 2739.203, "learn_time_ms": 11253.289, "learn_throughput": 355.452, "synch_weights_time_ms": 14.963}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00000", "date": "2024-08-03_03-55-42", "timestamp": 1722637542, "time_this_iter_s": 14.781799077987671, "time_total_s": 237.55757093429565, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8c355a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 237.55757093429565, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 13.14285714285714, "ram_util_percent": 17.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 146.55099319020908, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.43897538309296, "policy_loss": -0.01030478697697011, "vf_loss": 4.4447734646499155, "vf_explained_var": 0.9733963625505566, "kl": 0.015076766954371138, "entropy": 1.6322865840047598, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -19.46731264898761, "episode_reward_min": -1396.450354599286, "episode_reward_mean": -681.9887021948178, "episode_len_mean": 138.07, "episode_media": {}, "episodes_timesteps_total": 13807, "policy_reward_min": {"policy_0": -1396.450354599286}, "policy_reward_max": {"policy_0": -19.46731264898761}, "policy_reward_mean": {"policy_0": -681.9887021948178}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-356.4912447801781, -263.01889564099446, -903.3839067681868, -450.7506321689907, -763.1993690574603, -906.7081685736083, -422.00908449459894, -624.3406902179937, -494.03776568092593, -924.9171761265817, -375.31309845681324, -714.1708393857343, -851.2618142988676, -435.9117742442244, -769.7464708319809, -266.08311471898674, -330.02704445362065, -508.05343543944304, -658.2661993838905, -1004.0760033744491, -965.7126137852177, -920.9298679353101, -888.9108990566268, -772.9438305659389, -1051.1977847903695, -122.90724058115538, -155.91263529754713, -853.8522479947884, -91.39174904444315, -873.1680439009253, -1207.0239221490704, -968.0349050617313, -155.5521279428065, -983.6751656096527, -1063.9491049607775, -814.4238958927378, -645.7522410216038, -813.3213508397889, -577.8530103147621, -494.9719100856843, -55.88997207996445, -282.5561060629977, -917.7849661765424, -808.3734669724848, -879.3311285139841, -733.305313409933, -429.77755810997434, -712.6002912230863, -176.791814934646, -1088.5718686431992, -783.0596277407897, -263.4574776581192, -407.6625994073207, -485.5689827275168, -469.01009181956414, -1006.0027335064033, -350.7651634248154, -905.0853463846536, -768.246868934584, -1181.68258501179, -350.91759551229825, -842.0749436188718, -839.8335932904489, -573.52507714345, -691.3296997591208, -1396.450354599286, -608.1595026837633, -1275.6220933429677, -471.5618954683189, -863.2495464719605, -946.0933151612015, -605.5656780781843, -889.6875908321024, -977.6318630382838, -180.2894016026931, -19.46731264898761, -297.7007409440358, -659.9736217224153, -647.7515900492947, -1306.987517085855, -953.0109661977297, -806.9065005988948, -1260.7325603491404, -867.8665126869735, -258.62945808023727, -385.2950948981044, -581.7530741987474, -435.19976354099794, -992.6996742116531, -1380.8695249773398, -676.3557237798808, -454.0309216014597, -1253.3176705777921, -596.7552131785612, -244.03771050030946, -288.5165913514763, -414.9910240480207, -753.1789912412706, -775.3914966271723, -1226.6835761116547], "episode_lengths": [111, 104, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 88, 122, 150, 150, 150, 150, 150, 150, 150, 150, 81, 81, 150, 87, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 40, 90, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 46, 92, 150, 150, 150, 150, 150, 150, 150, 108, 109, 150, 150, 150, 150, 150, 150, 150, 150, 87, 103, 150, 150, 150, 150], "policy_policy_0_reward": [-356.4912447801781, -263.01889564099446, -903.3839067681868, -450.7506321689907, -763.1993690574603, -906.7081685736083, -422.00908449459894, -624.3406902179937, -494.03776568092593, -924.9171761265817, -375.31309845681324, -714.1708393857343, -851.2618142988676, -435.9117742442244, -769.7464708319809, -266.08311471898674, -330.02704445362065, -508.05343543944304, -658.2661993838905, -1004.0760033744491, -965.7126137852177, -920.9298679353101, -888.9108990566268, -772.9438305659389, -1051.1977847903695, -122.90724058115538, -155.91263529754713, -853.8522479947884, -91.39174904444315, -873.1680439009253, -1207.0239221490704, -968.0349050617313, -155.5521279428065, -983.6751656096527, -1063.9491049607775, -814.4238958927378, -645.7522410216038, -813.3213508397889, -577.8530103147621, -494.9719100856843, -55.88997207996445, -282.5561060629977, -917.7849661765424, -808.3734669724848, -879.3311285139841, -733.305313409933, -429.77755810997434, -712.6002912230863, -176.791814934646, -1088.5718686431992, -783.0596277407897, -263.4574776581192, -407.6625994073207, -485.5689827275168, -469.01009181956414, -1006.0027335064033, -350.7651634248154, -905.0853463846536, -768.246868934584, -1181.68258501179, -350.91759551229825, -842.0749436188718, -839.8335932904489, -573.52507714345, -691.3296997591208, -1396.450354599286, -608.1595026837633, -1275.6220933429677, -471.5618954683189, -863.2495464719605, -946.0933151612015, -605.5656780781843, -889.6875908321024, -977.6318630382838, -180.2894016026931, -19.46731264898761, -297.7007409440358, -659.9736217224153, -647.7515900492947, -1306.987517085855, -953.0109661977297, -806.9065005988948, -1260.7325603491404, -867.8665126869735, -258.62945808023727, -385.2950948981044, -581.7530741987474, -435.19976354099794, -992.6996742116531, -1380.8695249773398, -676.3557237798808, -454.0309216014597, -1253.3176705777921, -596.7552131785612, -244.03771050030946, -288.5165913514763, -414.9910240480207, -753.1789912412706, -775.3914966271723, -1226.6835761116547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3127484677130727, "mean_inference_ms": 0.9662103123226556, "mean_action_processing_ms": 0.16937116810692687, "mean_env_wait_ms": 1.7271040442789325, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005155801773071289, "StateBufferConnector_ms": 0.004071712493896484, "ViewRequirementAgentConnector_ms": 0.10073518753051758}, "num_episodes": 30, "episode_return_max": -19.46731264898761, "episode_return_min": -1396.450354599286, "episode_return_mean": -681.9887021948178, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.61933844423965, "num_env_steps_trained_throughput_per_sec": 272.61933844423965, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13956.063, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13955.992, "sample_time_ms": 2490.156, "learn_time_ms": 11449.781, "learn_throughput": 349.352, "synch_weights_time_ms": 15.273}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00000", "date": "2024-08-03_03-55-57", "timestamp": 1722637557, "time_this_iter_s": 14.67973256111145, "time_total_s": 252.2373034954071, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad2ef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 252.2373034954071, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 12.828571428571427, "ram_util_percent": 17.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 166.34638973673185, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.7945247408002616, "policy_loss": -0.00862568485851322, "vf_loss": 3.799060678854585, "vf_explained_var": 0.988168727606535, "kl": 0.013686876319964862, "entropy": 1.6321477127571902, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -19.46731264898761, "episode_reward_min": -1396.450354599286, "episode_reward_mean": -714.511911399488, "episode_len_mean": 138.27, "episode_media": {}, "episodes_timesteps_total": 13827, "policy_reward_min": {"policy_0": -1396.450354599286}, "policy_reward_max": {"policy_0": -19.46731264898761}, "policy_reward_mean": {"policy_0": -714.511911399488}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-873.1680439009253, -1207.0239221490704, -968.0349050617313, -155.5521279428065, -983.6751656096527, -1063.9491049607775, -814.4238958927378, -645.7522410216038, -813.3213508397889, -577.8530103147621, -494.9719100856843, -55.88997207996445, -282.5561060629977, -917.7849661765424, -808.3734669724848, -879.3311285139841, -733.305313409933, -429.77755810997434, -712.6002912230863, -176.791814934646, -1088.5718686431992, -783.0596277407897, -263.4574776581192, -407.6625994073207, -485.5689827275168, -469.01009181956414, -1006.0027335064033, -350.7651634248154, -905.0853463846536, -768.246868934584, -1181.68258501179, -350.91759551229825, -842.0749436188718, -839.8335932904489, -573.52507714345, -691.3296997591208, -1396.450354599286, -608.1595026837633, -1275.6220933429677, -471.5618954683189, -863.2495464719605, -946.0933151612015, -605.5656780781843, -889.6875908321024, -977.6318630382838, -180.2894016026931, -19.46731264898761, -297.7007409440358, -659.9736217224153, -647.7515900492947, -1306.987517085855, -953.0109661977297, -806.9065005988948, -1260.7325603491404, -867.8665126869735, -258.62945808023727, -385.2950948981044, -581.7530741987474, -435.19976354099794, -992.6996742116531, -1380.8695249773398, -676.3557237798808, -454.0309216014597, -1253.3176705777921, -596.7552131785612, -244.03771050030946, -288.5165913514763, -414.9910240480207, -753.1789912412706, -775.3914966271723, -1226.6835761116547, -1152.063725692767, -601.1205133660492, -1190.7913472104776, -968.7978345866073, -247.85381238916784, -1072.5862444630823, -1091.668170837403, -363.67570287765216, -1228.5586570788482, -248.70377678442162, -1189.0349880506, -773.0317615245447, -478.7475133592777, -144.53536178587945, -421.6595965387208, -956.2226696319481, -785.2741100540408, -532.3721067731962, -642.6155603337432, -814.7663930032489, -848.7747815912899, -317.93404870503747, -1084.769796071737, -613.244136219872, -1105.6146672864054, -985.3049131041797, -990.3875640287717, -33.44729288307927, -214.28947138389282], "episode_lengths": [150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 40, 90, 150, 150, 150, 150, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 46, 92, 150, 150, 150, 150, 150, 150, 150, 108, 109, 150, 150, 150, 150, 150, 150, 150, 150, 87, 103, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 127, 150, 125, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 45, 104], "policy_policy_0_reward": [-873.1680439009253, -1207.0239221490704, -968.0349050617313, -155.5521279428065, -983.6751656096527, -1063.9491049607775, -814.4238958927378, -645.7522410216038, -813.3213508397889, -577.8530103147621, -494.9719100856843, -55.88997207996445, -282.5561060629977, -917.7849661765424, -808.3734669724848, -879.3311285139841, -733.305313409933, -429.77755810997434, -712.6002912230863, -176.791814934646, -1088.5718686431992, -783.0596277407897, -263.4574776581192, -407.6625994073207, -485.5689827275168, -469.01009181956414, -1006.0027335064033, -350.7651634248154, -905.0853463846536, -768.246868934584, -1181.68258501179, -350.91759551229825, -842.0749436188718, -839.8335932904489, -573.52507714345, -691.3296997591208, -1396.450354599286, -608.1595026837633, -1275.6220933429677, -471.5618954683189, -863.2495464719605, -946.0933151612015, -605.5656780781843, -889.6875908321024, -977.6318630382838, -180.2894016026931, -19.46731264898761, -297.7007409440358, -659.9736217224153, -647.7515900492947, -1306.987517085855, -953.0109661977297, -806.9065005988948, -1260.7325603491404, -867.8665126869735, -258.62945808023727, -385.2950948981044, -581.7530741987474, -435.19976354099794, -992.6996742116531, -1380.8695249773398, -676.3557237798808, -454.0309216014597, -1253.3176705777921, -596.7552131785612, -244.03771050030946, -288.5165913514763, -414.9910240480207, -753.1789912412706, -775.3914966271723, -1226.6835761116547, -1152.063725692767, -601.1205133660492, -1190.7913472104776, -968.7978345866073, -247.85381238916784, -1072.5862444630823, -1091.668170837403, -363.67570287765216, -1228.5586570788482, -248.70377678442162, -1189.0349880506, -773.0317615245447, -478.7475133592777, -144.53536178587945, -421.6595965387208, -956.2226696319481, -785.2741100540408, -532.3721067731962, -642.6155603337432, -814.7663930032489, -848.7747815912899, -317.93404870503747, -1084.769796071737, -613.244136219872, -1105.6146672864054, -985.3049131041797, -990.3875640287717, -33.44729288307927, -214.28947138389282]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3117194064939233, "mean_inference_ms": 0.9625745718545607, "mean_action_processing_ms": 0.16895702718503117, "mean_env_wait_ms": 1.7237333009693827, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005233287811279297, "StateBufferConnector_ms": 0.00404810905456543, "ViewRequirementAgentConnector_ms": 0.10127472877502441}, "num_episodes": 29, "episode_return_max": -19.46731264898761, "episode_return_min": -1396.450354599286, "episode_return_mean": -714.511911399488, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 274.47083695333407, "num_env_steps_trained_throughput_per_sec": 274.47083695333407, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 14514.107, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14514.035, "sample_time_ms": 2493.629, "learn_time_ms": 12004.22, "learn_throughput": 333.216, "synch_weights_time_ms": 15.405}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00000", "date": "2024-08-03_03-56-12", "timestamp": 1722637572, "time_this_iter_s": 14.58024001121521, "time_total_s": 266.8175435066223, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad2710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 266.8175435066223, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 12.823809523809524, "ram_util_percent": 17.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 162.22293874820073, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.8189100578427313, "policy_loss": -0.007074147864477709, "vf_loss": 3.82191439991196, "vf_explained_var": 0.9845231369758646, "kl": 0.013619635827611411, "entropy": 1.6100215756644805, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -16.135642397923075, "episode_reward_min": -1432.2555744720687, "episode_reward_mean": -728.0262139555671, "episode_len_mean": 136.63, "episode_media": {}, "episodes_timesteps_total": 13663, "policy_reward_min": {"policy_0": -1432.2555744720687}, "policy_reward_max": {"policy_0": -16.135642397923075}, "policy_reward_mean": {"policy_0": -728.0262139555671}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-350.91759551229825, -842.0749436188718, -839.8335932904489, -573.52507714345, -691.3296997591208, -1396.450354599286, -608.1595026837633, -1275.6220933429677, -471.5618954683189, -863.2495464719605, -946.0933151612015, -605.5656780781843, -889.6875908321024, -977.6318630382838, -180.2894016026931, -19.46731264898761, -297.7007409440358, -659.9736217224153, -647.7515900492947, -1306.987517085855, -953.0109661977297, -806.9065005988948, -1260.7325603491404, -867.8665126869735, -258.62945808023727, -385.2950948981044, -581.7530741987474, -435.19976354099794, -992.6996742116531, -1380.8695249773398, -676.3557237798808, -454.0309216014597, -1253.3176705777921, -596.7552131785612, -244.03771050030946, -288.5165913514763, -414.9910240480207, -753.1789912412706, -775.3914966271723, -1226.6835761116547, -1152.063725692767, -601.1205133660492, -1190.7913472104776, -968.7978345866073, -247.85381238916784, -1072.5862444630823, -1091.668170837403, -363.67570287765216, -1228.5586570788482, -248.70377678442162, -1189.0349880506, -773.0317615245447, -478.7475133592777, -144.53536178587945, -421.6595965387208, -956.2226696319481, -785.2741100540408, -532.3721067731962, -642.6155603337432, -814.7663930032489, -848.7747815912899, -317.93404870503747, -1084.769796071737, -613.244136219872, -1105.6146672864054, -985.3049131041797, -990.3875640287717, -33.44729288307927, -214.28947138389282, -16.135642397923075, -731.3850377638312, -498.21165855555233, -950.6060855494694, -1381.7569710568512, -618.9765121358785, -1432.2555744720687, -849.071750684169, -731.9144220327196, -1007.9856965216383, -593.3031389067917, -654.952108581043, -665.4615018636086, -64.22912619855965, -1010.1552374993612, -665.5543148031458, -62.08827482266577, -411.36148206378476, -1184.9767710595097, -132.18421216706074, -1089.035750515777, -1042.0872623821313, -421.4876006083627, -734.8706079110216, -998.2139743708697, -1408.51435052765, -741.8828390869506, -921.9493959436837, -875.486000157246, -272.7851541258732, -485.80144136460444], "episode_lengths": [99, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 46, 92, 150, 150, 150, 150, 150, 150, 150, 108, 109, 150, 150, 150, 150, 150, 150, 150, 150, 87, 103, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 127, 150, 125, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 45, 104, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 61, 150, 150, 79, 150, 150, 113, 150, 150, 150, 150, 150, 150, 85, 124], "policy_policy_0_reward": [-350.91759551229825, -842.0749436188718, -839.8335932904489, -573.52507714345, -691.3296997591208, -1396.450354599286, -608.1595026837633, -1275.6220933429677, -471.5618954683189, -863.2495464719605, -946.0933151612015, -605.5656780781843, -889.6875908321024, -977.6318630382838, -180.2894016026931, -19.46731264898761, -297.7007409440358, -659.9736217224153, -647.7515900492947, -1306.987517085855, -953.0109661977297, -806.9065005988948, -1260.7325603491404, -867.8665126869735, -258.62945808023727, -385.2950948981044, -581.7530741987474, -435.19976354099794, -992.6996742116531, -1380.8695249773398, -676.3557237798808, -454.0309216014597, -1253.3176705777921, -596.7552131785612, -244.03771050030946, -288.5165913514763, -414.9910240480207, -753.1789912412706, -775.3914966271723, -1226.6835761116547, -1152.063725692767, -601.1205133660492, -1190.7913472104776, -968.7978345866073, -247.85381238916784, -1072.5862444630823, -1091.668170837403, -363.67570287765216, -1228.5586570788482, -248.70377678442162, -1189.0349880506, -773.0317615245447, -478.7475133592777, -144.53536178587945, -421.6595965387208, -956.2226696319481, -785.2741100540408, -532.3721067731962, -642.6155603337432, -814.7663930032489, -848.7747815912899, -317.93404870503747, -1084.769796071737, -613.244136219872, -1105.6146672864054, -985.3049131041797, -990.3875640287717, -33.44729288307927, -214.28947138389282, -16.135642397923075, -731.3850377638312, -498.21165855555233, -950.6060855494694, -1381.7569710568512, -618.9765121358785, -1432.2555744720687, -849.071750684169, -731.9144220327196, -1007.9856965216383, -593.3031389067917, -654.952108581043, -665.4615018636086, -64.22912619855965, -1010.1552374993612, -665.5543148031458, -62.08827482266577, -411.36148206378476, -1184.9767710595097, -132.18421216706074, -1089.035750515777, -1042.0872623821313, -421.4876006083627, -734.8706079110216, -998.2139743708697, -1408.51435052765, -741.8828390869506, -921.9493959436837, -875.486000157246, -272.7851541258732, -485.80144136460444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3108334838527685, "mean_inference_ms": 0.9598612603132162, "mean_action_processing_ms": 0.16873538775832905, "mean_env_wait_ms": 1.7209081942163067, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0056002140045166016, "StateBufferConnector_ms": 0.004084587097167969, "ViewRequirementAgentConnector_ms": 0.10254907608032227}, "num_episodes": 31, "episode_return_max": -16.135642397923075, "episode_return_min": -1432.2555744720687, "episode_return_mean": -728.0262139555671, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.0178884181308, "num_env_steps_trained_throughput_per_sec": 268.0178884181308, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 14581.122, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14581.051, "sample_time_ms": 2491.644, "learn_time_ms": 12073.17, "learn_throughput": 331.313, "synch_weights_time_ms": 15.465}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00000", "date": "2024-08-03_03-56-27", "timestamp": 1722637587, "time_this_iter_s": 14.93242621421814, "time_total_s": 281.74996972084045, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad1f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 281.74996972084045, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 12.814285714285715, "ram_util_percent": 17.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 188.44032716353735, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.516140614449978, "policy_loss": -0.012039093275234336, "vf_loss": 3.52398448685805, "vf_explained_var": 0.9850089228401582, "kl": 0.014038973759913174, "entropy": 1.647727536658446, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -16.135642397923075, "episode_reward_min": -1432.2555744720687, "episode_reward_mean": -724.2447231243684, "episode_len_mean": 138.41, "episode_media": {}, "episodes_timesteps_total": 13841, "policy_reward_min": {"policy_0": -1432.2555744720687}, "policy_reward_max": {"policy_0": -16.135642397923075}, "policy_reward_mean": {"policy_0": -724.2447231243684}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-435.19976354099794, -992.6996742116531, -1380.8695249773398, -676.3557237798808, -454.0309216014597, -1253.3176705777921, -596.7552131785612, -244.03771050030946, -288.5165913514763, -414.9910240480207, -753.1789912412706, -775.3914966271723, -1226.6835761116547, -1152.063725692767, -601.1205133660492, -1190.7913472104776, -968.7978345866073, -247.85381238916784, -1072.5862444630823, -1091.668170837403, -363.67570287765216, -1228.5586570788482, -248.70377678442162, -1189.0349880506, -773.0317615245447, -478.7475133592777, -144.53536178587945, -421.6595965387208, -956.2226696319481, -785.2741100540408, -532.3721067731962, -642.6155603337432, -814.7663930032489, -848.7747815912899, -317.93404870503747, -1084.769796071737, -613.244136219872, -1105.6146672864054, -985.3049131041797, -990.3875640287717, -33.44729288307927, -214.28947138389282, -16.135642397923075, -731.3850377638312, -498.21165855555233, -950.6060855494694, -1381.7569710568512, -618.9765121358785, -1432.2555744720687, -849.071750684169, -731.9144220327196, -1007.9856965216383, -593.3031389067917, -654.952108581043, -665.4615018636086, -64.22912619855965, -1010.1552374993612, -665.5543148031458, -62.08827482266577, -411.36148206378476, -1184.9767710595097, -132.18421216706074, -1089.035750515777, -1042.0872623821313, -421.4876006083627, -734.8706079110216, -998.2139743708697, -1408.51435052765, -741.8828390869506, -921.9493959436837, -875.486000157246, -272.7851541258732, -485.80144136460444, -592.5848618363402, -718.2823384462746, -106.23432006618167, -588.2628872358316, -623.9015655997383, -644.7185331844224, -1088.2909702207896, -49.077066272776946, -910.3999633284132, -597.8256151435071, -708.3709843615695, -1077.743534607199, -652.2091312748336, -844.9640225553541, -757.394003506637, -1081.5867552991983, -884.333092092636, -382.4760268811782, -680.187156126158, -184.23365835726477, -753.3520474087921, -229.3395311061091, -962.7281314479523, -877.9162221300935, -857.8946056373493, -1099.5930190147146, -1226.017973802177], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 87, 103, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 127, 150, 125, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 45, 104, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 61, 150, 150, 79, 150, 150, 113, 150, 150, 150, 150, 150, 150, 85, 124, 150, 150, 83, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 147, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-435.19976354099794, -992.6996742116531, -1380.8695249773398, -676.3557237798808, -454.0309216014597, -1253.3176705777921, -596.7552131785612, -244.03771050030946, -288.5165913514763, -414.9910240480207, -753.1789912412706, -775.3914966271723, -1226.6835761116547, -1152.063725692767, -601.1205133660492, -1190.7913472104776, -968.7978345866073, -247.85381238916784, -1072.5862444630823, -1091.668170837403, -363.67570287765216, -1228.5586570788482, -248.70377678442162, -1189.0349880506, -773.0317615245447, -478.7475133592777, -144.53536178587945, -421.6595965387208, -956.2226696319481, -785.2741100540408, -532.3721067731962, -642.6155603337432, -814.7663930032489, -848.7747815912899, -317.93404870503747, -1084.769796071737, -613.244136219872, -1105.6146672864054, -985.3049131041797, -990.3875640287717, -33.44729288307927, -214.28947138389282, -16.135642397923075, -731.3850377638312, -498.21165855555233, -950.6060855494694, -1381.7569710568512, -618.9765121358785, -1432.2555744720687, -849.071750684169, -731.9144220327196, -1007.9856965216383, -593.3031389067917, -654.952108581043, -665.4615018636086, -64.22912619855965, -1010.1552374993612, -665.5543148031458, -62.08827482266577, -411.36148206378476, -1184.9767710595097, -132.18421216706074, -1089.035750515777, -1042.0872623821313, -421.4876006083627, -734.8706079110216, -998.2139743708697, -1408.51435052765, -741.8828390869506, -921.9493959436837, -875.486000157246, -272.7851541258732, -485.80144136460444, -592.5848618363402, -718.2823384462746, -106.23432006618167, -588.2628872358316, -623.9015655997383, -644.7185331844224, -1088.2909702207896, -49.077066272776946, -910.3999633284132, -597.8256151435071, -708.3709843615695, -1077.743534607199, -652.2091312748336, -844.9640225553541, -757.394003506637, -1081.5867552991983, -884.333092092636, -382.4760268811782, -680.187156126158, -184.23365835726477, -753.3520474087921, -229.3395311061091, -962.7281314479523, -877.9162221300935, -857.8946056373493, -1099.5930190147146, -1226.017973802177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.3101240859004372, "mean_inference_ms": 0.9573479340763267, "mean_action_processing_ms": 0.16842795815404707, "mean_env_wait_ms": 1.71855528503774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055637359619140625, "StateBufferConnector_ms": 0.0041027069091796875, "ViewRequirementAgentConnector_ms": 0.10307049751281738}, "num_episodes": 27, "episode_return_max": -16.135642397923075, "episode_return_min": -1432.2555744720687, "episode_return_mean": -724.2447231243684, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 275.06296388406, "num_env_steps_trained_throughput_per_sec": 275.06296388406, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 14643.975, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14643.903, "sample_time_ms": 2494.5, "learn_time_ms": 12133.182, "learn_throughput": 329.674, "synch_weights_time_ms": 15.444}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00000", "date": "2024-08-03_03-56-41", "timestamp": 1722637601, "time_this_iter_s": 14.550063848495483, "time_total_s": 296.30003356933594, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad0820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 296.30003356933594, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 12.776190476190477, "ram_util_percent": 17.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.4833154141903, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.105042378604412, "policy_loss": -0.00958846338277605, "vf_loss": 4.110289775704344, "vf_explained_var": 0.9734754872197906, "kl": 0.014518051733193734, "entropy": 1.4336334875474372, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -16.135642397923075, "episode_reward_min": -1432.2555744720687, "episode_reward_mean": -695.5902386921164, "episode_len_mean": 137.52, "episode_media": {}, "episodes_timesteps_total": 13752, "policy_reward_min": {"policy_0": -1432.2555744720687}, "policy_reward_max": {"policy_0": -16.135642397923075}, "policy_reward_mean": {"policy_0": -695.5902386921164}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-785.2741100540408, -532.3721067731962, -642.6155603337432, -814.7663930032489, -848.7747815912899, -317.93404870503747, -1084.769796071737, -613.244136219872, -1105.6146672864054, -985.3049131041797, -990.3875640287717, -33.44729288307927, -214.28947138389282, -16.135642397923075, -731.3850377638312, -498.21165855555233, -950.6060855494694, -1381.7569710568512, -618.9765121358785, -1432.2555744720687, -849.071750684169, -731.9144220327196, -1007.9856965216383, -593.3031389067917, -654.952108581043, -665.4615018636086, -64.22912619855965, -1010.1552374993612, -665.5543148031458, -62.08827482266577, -411.36148206378476, -1184.9767710595097, -132.18421216706074, -1089.035750515777, -1042.0872623821313, -421.4876006083627, -734.8706079110216, -998.2139743708697, -1408.51435052765, -741.8828390869506, -921.9493959436837, -875.486000157246, -272.7851541258732, -485.80144136460444, -592.5848618363402, -718.2823384462746, -106.23432006618167, -588.2628872358316, -623.9015655997383, -644.7185331844224, -1088.2909702207896, -49.077066272776946, -910.3999633284132, -597.8256151435071, -708.3709843615695, -1077.743534607199, -652.2091312748336, -844.9640225553541, -757.394003506637, -1081.5867552991983, -884.333092092636, -382.4760268811782, -680.187156126158, -184.23365835726477, -753.3520474087921, -229.3395311061091, -962.7281314479523, -877.9162221300935, -857.8946056373493, -1099.5930190147146, -1226.017973802177, -365.31944325427924, -732.9631242741982, -433.81726443190576, -406.9279091018396, -545.536477133161, -83.63403205584508, -697.4836058228477, -680.0473109881198, -625.6984080176336, -476.7387371456321, -832.2362232035372, -700.7094970127264, -422.86187955563395, -39.34727548170282, -781.8933906818266, -1294.6352179245837, -743.1997696002145, -1029.3694618540712, -612.0259075828535, -1034.008122780118, -84.81117566631391, -386.0061214599317, -263.15875165530423, -811.1946507912315, -1075.6440953623737, -1089.4399429233988, -484.87701484730457, -728.6706192882431, -1293.3756848030243], "episode_lengths": [150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 45, 104, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 61, 150, 150, 79, 150, 150, 113, 150, 150, 150, 150, 150, 150, 85, 124, 150, 150, 83, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 147, 150, 150, 150, 150, 150, 150, 106, 150, 131, 150, 129, 74, 143, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 65, 150, 123, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-785.2741100540408, -532.3721067731962, -642.6155603337432, -814.7663930032489, -848.7747815912899, -317.93404870503747, -1084.769796071737, -613.244136219872, -1105.6146672864054, -985.3049131041797, -990.3875640287717, -33.44729288307927, -214.28947138389282, -16.135642397923075, -731.3850377638312, -498.21165855555233, -950.6060855494694, -1381.7569710568512, -618.9765121358785, -1432.2555744720687, -849.071750684169, -731.9144220327196, -1007.9856965216383, -593.3031389067917, -654.952108581043, -665.4615018636086, -64.22912619855965, -1010.1552374993612, -665.5543148031458, -62.08827482266577, -411.36148206378476, -1184.9767710595097, -132.18421216706074, -1089.035750515777, -1042.0872623821313, -421.4876006083627, -734.8706079110216, -998.2139743708697, -1408.51435052765, -741.8828390869506, -921.9493959436837, -875.486000157246, -272.7851541258732, -485.80144136460444, -592.5848618363402, -718.2823384462746, -106.23432006618167, -588.2628872358316, -623.9015655997383, -644.7185331844224, -1088.2909702207896, -49.077066272776946, -910.3999633284132, -597.8256151435071, -708.3709843615695, -1077.743534607199, -652.2091312748336, -844.9640225553541, -757.394003506637, -1081.5867552991983, -884.333092092636, -382.4760268811782, -680.187156126158, -184.23365835726477, -753.3520474087921, -229.3395311061091, -962.7281314479523, -877.9162221300935, -857.8946056373493, -1099.5930190147146, -1226.017973802177, -365.31944325427924, -732.9631242741982, -433.81726443190576, -406.9279091018396, -545.536477133161, -83.63403205584508, -697.4836058228477, -680.0473109881198, -625.6984080176336, -476.7387371456321, -832.2362232035372, -700.7094970127264, -422.86187955563395, -39.34727548170282, -781.8933906818266, -1294.6352179245837, -743.1997696002145, -1029.3694618540712, -612.0259075828535, -1034.008122780118, -84.81117566631391, -386.0061214599317, -263.15875165530423, -811.1946507912315, -1075.6440953623737, -1089.4399429233988, -484.87701484730457, -728.6706192882431, -1293.3756848030243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30931939555691473, "mean_inference_ms": 0.9548232128812576, "mean_action_processing_ms": 0.16809272118612725, "mean_env_wait_ms": 1.7163162939717387, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005558967590332031, "StateBufferConnector_ms": 0.0040743350982666016, "ViewRequirementAgentConnector_ms": 0.10206031799316406}, "num_episodes": 29, "episode_return_max": -16.135642397923075, "episode_return_min": -1432.2555744720687, "episode_return_mean": -695.5902386921164, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 276.72735429276753, "num_env_steps_trained_throughput_per_sec": 276.72735429276753, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 14645.655, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14645.583, "sample_time_ms": 2493.406, "learn_time_ms": 12136.29, "learn_throughput": 329.59, "synch_weights_time_ms": 15.146}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00000", "date": "2024-08-03_03-56-56", "timestamp": 1722637616, "time_this_iter_s": 14.46156620979309, "time_total_s": 310.761599779129, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad3be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 310.761599779129, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 13.215, "ram_util_percent": 17.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 192.12617209156355, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.740993452320496, "policy_loss": -0.012378253320639488, "vf_loss": 3.7482325823356706, "vf_explained_var": 0.98565637798359, "kl": 0.017190320193246126, "entropy": 1.7968688088158766, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -32.80217677585611, "episode_reward_min": -1408.51435052765, "episode_reward_mean": -708.7034775657888, "episode_len_mean": 138.35, "episode_media": {}, "episodes_timesteps_total": 13835, "policy_reward_min": {"policy_0": -1408.51435052765}, "policy_reward_max": {"policy_0": -32.80217677585611}, "policy_reward_mean": {"policy_0": -708.7034775657888}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-62.08827482266577, -411.36148206378476, -1184.9767710595097, -132.18421216706074, -1089.035750515777, -1042.0872623821313, -421.4876006083627, -734.8706079110216, -998.2139743708697, -1408.51435052765, -741.8828390869506, -921.9493959436837, -875.486000157246, -272.7851541258732, -485.80144136460444, -592.5848618363402, -718.2823384462746, -106.23432006618167, -588.2628872358316, -623.9015655997383, -644.7185331844224, -1088.2909702207896, -49.077066272776946, -910.3999633284132, -597.8256151435071, -708.3709843615695, -1077.743534607199, -652.2091312748336, -844.9640225553541, -757.394003506637, -1081.5867552991983, -884.333092092636, -382.4760268811782, -680.187156126158, -184.23365835726477, -753.3520474087921, -229.3395311061091, -962.7281314479523, -877.9162221300935, -857.8946056373493, -1099.5930190147146, -1226.017973802177, -365.31944325427924, -732.9631242741982, -433.81726443190576, -406.9279091018396, -545.536477133161, -83.63403205584508, -697.4836058228477, -680.0473109881198, -625.6984080176336, -476.7387371456321, -832.2362232035372, -700.7094970127264, -422.86187955563395, -39.34727548170282, -781.8933906818266, -1294.6352179245837, -743.1997696002145, -1029.3694618540712, -612.0259075828535, -1034.008122780118, -84.81117566631391, -386.0061214599317, -263.15875165530423, -811.1946507912315, -1075.6440953623737, -1089.4399429233988, -484.87701484730457, -728.6706192882431, -1293.3756848030243, -998.5049435211224, -536.5862820609269, -331.0880454793944, -673.6694387439935, -852.2512896537676, -320.9148057305753, -659.5198586627052, -32.80217677585611, -695.0788937022147, -1050.7240424111926, -241.2436338625535, -387.0759134227175, -828.666598477691, -731.0155597171519, -758.4363997538044, -1053.453513693641, -1241.216585741392, -973.6290848573545, -839.2924657186063, -537.0282405195549, -1023.073773064512, -918.4720134456917, -914.7068129761703, -837.0661654470501, -1255.8082862219203, -952.7300149228188, -1005.4951313908483, -1191.6447887123554, -310.87874914075957], "episode_lengths": [61, 150, 150, 79, 150, 150, 113, 150, 150, 150, 150, 150, 150, 85, 124, 150, 150, 83, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 111, 147, 150, 150, 150, 150, 150, 150, 106, 150, 131, 150, 129, 74, 143, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 65, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 52, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 150, 94], "policy_policy_0_reward": [-62.08827482266577, -411.36148206378476, -1184.9767710595097, -132.18421216706074, -1089.035750515777, -1042.0872623821313, -421.4876006083627, -734.8706079110216, -998.2139743708697, -1408.51435052765, -741.8828390869506, -921.9493959436837, -875.486000157246, -272.7851541258732, -485.80144136460444, -592.5848618363402, -718.2823384462746, -106.23432006618167, -588.2628872358316, -623.9015655997383, -644.7185331844224, -1088.2909702207896, -49.077066272776946, -910.3999633284132, -597.8256151435071, -708.3709843615695, -1077.743534607199, -652.2091312748336, -844.9640225553541, -757.394003506637, -1081.5867552991983, -884.333092092636, -382.4760268811782, -680.187156126158, -184.23365835726477, -753.3520474087921, -229.3395311061091, -962.7281314479523, -877.9162221300935, -857.8946056373493, -1099.5930190147146, -1226.017973802177, -365.31944325427924, -732.9631242741982, -433.81726443190576, -406.9279091018396, -545.536477133161, -83.63403205584508, -697.4836058228477, -680.0473109881198, -625.6984080176336, -476.7387371456321, -832.2362232035372, -700.7094970127264, -422.86187955563395, -39.34727548170282, -781.8933906818266, -1294.6352179245837, -743.1997696002145, -1029.3694618540712, -612.0259075828535, -1034.008122780118, -84.81117566631391, -386.0061214599317, -263.15875165530423, -811.1946507912315, -1075.6440953623737, -1089.4399429233988, -484.87701484730457, -728.6706192882431, -1293.3756848030243, -998.5049435211224, -536.5862820609269, -331.0880454793944, -673.6694387439935, -852.2512896537676, -320.9148057305753, -659.5198586627052, -32.80217677585611, -695.0788937022147, -1050.7240424111926, -241.2436338625535, -387.0759134227175, -828.666598477691, -731.0155597171519, -758.4363997538044, -1053.453513693641, -1241.216585741392, -973.6290848573545, -839.2924657186063, -537.0282405195549, -1023.073773064512, -918.4720134456917, -914.7068129761703, -837.0661654470501, -1255.8082862219203, -952.7300149228188, -1005.4951313908483, -1191.6447887123554, -310.87874914075957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30882457940972013, "mean_inference_ms": 0.9525129054876095, "mean_action_processing_ms": 0.16776420173811565, "mean_env_wait_ms": 1.713358959464369, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005257129669189453, "StateBufferConnector_ms": 0.004045724868774414, "ViewRequirementAgentConnector_ms": 0.1008138656616211}, "num_episodes": 29, "episode_return_max": -32.80217677585611, "episode_return_min": -1408.51435052765, "episode_return_mean": -708.7034775657888, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.87100702600935, "num_env_steps_trained_throughput_per_sec": 326.87100702600935, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 14407.98, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14407.908, "sample_time_ms": 2492.108, "learn_time_ms": 11899.44, "learn_throughput": 336.15, "synch_weights_time_ms": 15.619}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00000", "date": "2024-08-03_03-57-08", "timestamp": 1722637628, "time_this_iter_s": 12.245221853256226, "time_total_s": 323.00682163238525, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad1120>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 323.00682163238525, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 13.255555555555556, "ram_util_percent": 17.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 182.20606902043025, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.863901946445306, "policy_loss": -0.013210337767668534, "vf_loss": 3.8724222940703235, "vf_explained_var": 0.988694628328085, "kl": 0.015683041004740536, "entropy": 1.4915878356744845, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -5.854326701775631, "episode_reward_min": -1294.6352179245837, "episode_reward_mean": -701.7543780597782, "episode_len_mean": 139.18, "episode_media": {}, "episodes_timesteps_total": 13918, "policy_reward_min": {"policy_0": -1294.6352179245837}, "policy_reward_max": {"policy_0": -5.854326701775631}, "policy_reward_mean": {"policy_0": -701.7543780597782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-757.394003506637, -1081.5867552991983, -884.333092092636, -382.4760268811782, -680.187156126158, -184.23365835726477, -753.3520474087921, -229.3395311061091, -962.7281314479523, -877.9162221300935, -857.8946056373493, -1099.5930190147146, -1226.017973802177, -365.31944325427924, -732.9631242741982, -433.81726443190576, -406.9279091018396, -545.536477133161, -83.63403205584508, -697.4836058228477, -680.0473109881198, -625.6984080176336, -476.7387371456321, -832.2362232035372, -700.7094970127264, -422.86187955563395, -39.34727548170282, -781.8933906818266, -1294.6352179245837, -743.1997696002145, -1029.3694618540712, -612.0259075828535, -1034.008122780118, -84.81117566631391, -386.0061214599317, -263.15875165530423, -811.1946507912315, -1075.6440953623737, -1089.4399429233988, -484.87701484730457, -728.6706192882431, -1293.3756848030243, -998.5049435211224, -536.5862820609269, -331.0880454793944, -673.6694387439935, -852.2512896537676, -320.9148057305753, -659.5198586627052, -32.80217677585611, -695.0788937022147, -1050.7240424111926, -241.2436338625535, -387.0759134227175, -828.666598477691, -731.0155597171519, -758.4363997538044, -1053.453513693641, -1241.216585741392, -973.6290848573545, -839.2924657186063, -537.0282405195549, -1023.073773064512, -918.4720134456917, -914.7068129761703, -837.0661654470501, -1255.8082862219203, -952.7300149228188, -1005.4951313908483, -1191.6447887123554, -310.87874914075957, -935.7296448180203, -651.6149086080549, -140.03197561977194, -842.4286858845187, -705.1040030844536, -788.7644966631851, -15.199755467096223, -5.854326701775631, -597.92962675756, -331.98744894721796, -797.7821352269318, -787.9986761676402, -842.8760688201484, -730.737981301031, -584.6739293166894, -1139.9997738629659, -829.8944858552901, -702.7898486671809, -1142.3997775335642, -947.5682212252782, -220.66164754913908, -731.3057002305974, -576.4627301758409, -311.7518619654582, -1113.8761392605713, -522.8522547965015, -821.3277438493739, -633.3794885238774, -837.6976237596464], "episode_lengths": [150, 150, 150, 150, 150, 111, 147, 150, 150, 150, 150, 150, 150, 106, 150, 131, 150, 129, 74, 143, 150, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 65, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 52, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 68, 150, 150, 150, 39, 44, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 130, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-757.394003506637, -1081.5867552991983, -884.333092092636, -382.4760268811782, -680.187156126158, -184.23365835726477, -753.3520474087921, -229.3395311061091, -962.7281314479523, -877.9162221300935, -857.8946056373493, -1099.5930190147146, -1226.017973802177, -365.31944325427924, -732.9631242741982, -433.81726443190576, -406.9279091018396, -545.536477133161, -83.63403205584508, -697.4836058228477, -680.0473109881198, -625.6984080176336, -476.7387371456321, -832.2362232035372, -700.7094970127264, -422.86187955563395, -39.34727548170282, -781.8933906818266, -1294.6352179245837, -743.1997696002145, -1029.3694618540712, -612.0259075828535, -1034.008122780118, -84.81117566631391, -386.0061214599317, -263.15875165530423, -811.1946507912315, -1075.6440953623737, -1089.4399429233988, -484.87701484730457, -728.6706192882431, -1293.3756848030243, -998.5049435211224, -536.5862820609269, -331.0880454793944, -673.6694387439935, -852.2512896537676, -320.9148057305753, -659.5198586627052, -32.80217677585611, -695.0788937022147, -1050.7240424111926, -241.2436338625535, -387.0759134227175, -828.666598477691, -731.0155597171519, -758.4363997538044, -1053.453513693641, -1241.216585741392, -973.6290848573545, -839.2924657186063, -537.0282405195549, -1023.073773064512, -918.4720134456917, -914.7068129761703, -837.0661654470501, -1255.8082862219203, -952.7300149228188, -1005.4951313908483, -1191.6447887123554, -310.87874914075957, -935.7296448180203, -651.6149086080549, -140.03197561977194, -842.4286858845187, -705.1040030844536, -788.7644966631851, -15.199755467096223, -5.854326701775631, -597.92962675756, -331.98744894721796, -797.7821352269318, -787.9986761676402, -842.8760688201484, -730.737981301031, -584.6739293166894, -1139.9997738629659, -829.8944858552901, -702.7898486671809, -1142.3997775335642, -947.5682212252782, -220.66164754913908, -731.3057002305974, -576.4627301758409, -311.7518619654582, -1113.8761392605713, -522.8522547965015, -821.3277438493739, -633.3794885238774, -837.6976237596464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.30826958773007435, "mean_inference_ms": 0.9502932121785994, "mean_action_processing_ms": 0.16754154236605764, "mean_env_wait_ms": 1.710634256842534, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00516963005065918, "StateBufferConnector_ms": 0.004128217697143555, "ViewRequirementAgentConnector_ms": 0.10231852531433105}, "num_episodes": 29, "episode_return_max": -5.854326701775631, "episode_return_min": -1294.6352179245837, "episode_return_mean": -701.7543780597782, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.7533864952542, "num_env_steps_trained_throughput_per_sec": 272.7533864952542, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 14389.611, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14389.543, "sample_time_ms": 2491.645, "learn_time_ms": 11881.539, "learn_throughput": 336.657, "synch_weights_time_ms": 15.618}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00000", "date": "2024-08-03_03-57-23", "timestamp": 1722637643, "time_this_iter_s": 14.671824932098389, "time_total_s": 337.67864656448364, "pid": 463214, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad05e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 337.67864656448364, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 12.714285714285714, "ram_util_percent": 17.199999999999996}}
