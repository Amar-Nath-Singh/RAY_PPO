{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9840546074944237, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.685595393180847, "policy_loss": -0.003481144935358316, "vf_loss": 9.687748703360558, "vf_explained_var": 0.007296671035389105, "kl": 0.007351949141457226, "entropy": 1.4255100725839536, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -78.71296411127322, "episode_reward_min": -1200.2320293129733, "episode_reward_mean": -632.2727769109841, "episode_len_mean": 136.82608695652175, "episode_media": {}, "episodes_timesteps_total": 3147, "policy_reward_min": {"policy_0": -1200.2320293129733}, "policy_reward_max": {"policy_0": -78.71296411127322}, "policy_reward_mean": {"policy_0": -632.2727769109841}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-739.1819909916235, -933.4973414525005, -308.94786436445145, -1200.2320293129733, -943.1811280554963, -696.5927440428677, -887.910818774709, -962.5868730269378, -619.9860320326995, -78.71296411127322, -642.5445423479661, -779.0337303261686, -521.7250279060971, -452.1626778185475, -797.0385674222904, -339.04560716464175, -689.1985822424582, -432.1017670329284, -539.0818949871228, -130.50406942955806, -487.9168724800482, -774.0333909063129, -587.0573527229622], "episode_lengths": [150, 150, 104, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 95, 150, 117, 150, 57, 150, 150, 150], "policy_policy_0_reward": [-739.1819909916235, -933.4973414525005, -308.94786436445145, -1200.2320293129733, -943.1811280554963, -696.5927440428677, -887.910818774709, -962.5868730269378, -619.9860320326995, -78.71296411127322, -642.5445423479661, -779.0337303261686, -521.7250279060971, -452.1626778185475, -797.0385674222904, -339.04560716464175, -689.1985822424582, -432.1017670329284, -539.0818949871228, -130.50406942955806, -487.9168724800482, -774.0333909063129, -587.0573527229622]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5774533226921172, "mean_inference_ms": 1.7437355171274966, "mean_action_processing_ms": 0.28856029566328195, "mean_env_wait_ms": 3.047718696065895, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011756109154742697, "StateBufferConnector_ms": 0.008129036944845448, "ViewRequirementAgentConnector_ms": 0.1814313556836999}, "num_episodes": 23, "episode_return_max": -78.71296411127322, "episode_return_min": -1200.2320293129733, "episode_return_mean": -632.2727769109841, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.44577618392134, "num_env_steps_trained_throughput_per_sec": 291.44577618392134, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13724.691, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13724.623, "sample_time_ms": 1190.077, "learn_time_ms": 12467.311, "learn_throughput": 320.839, "synch_weights_time_ms": 66.504}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00013", "date": "2024-08-03_04-20-11", "timestamp": 1722639011, "time_this_iter_s": 13.736528635025024, "time_total_s": 13.736528635025024, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70ab90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.736528635025024, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 22.014999999999997, "ram_util_percent": 48.435}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1329627914354203, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.3832890411218, "policy_loss": -0.014166497213591357, "vf_loss": 9.394132885336877, "vf_explained_var": 0.06852033641189337, "kl": 0.017336984686032033, "entropy": 1.4476680610328914, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -78.71296411127322, "episode_reward_min": -1200.2320293129733, "episode_reward_mean": -681.8054716307939, "episode_len_mean": 141.2826086956522, "episode_media": {}, "episodes_timesteps_total": 6499, "policy_reward_min": {"policy_0": -1200.2320293129733}, "policy_reward_max": {"policy_0": -78.71296411127322}, "policy_reward_mean": {"policy_0": -681.8054716307939}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-739.1819909916235, -933.4973414525005, -308.94786436445145, -1200.2320293129733, -943.1811280554963, -696.5927440428677, -887.910818774709, -962.5868730269378, -619.9860320326995, -78.71296411127322, -642.5445423479661, -779.0337303261686, -521.7250279060971, -452.1626778185475, -797.0385674222904, -339.04560716464175, -689.1985822424582, -432.1017670329284, -539.0818949871228, -130.50406942955806, -487.9168724800482, -774.0333909063129, -587.0573527229622, -943.5954300508669, -571.6014285591164, -690.0327954446848, -832.8322270137053, -305.7601007559822, -673.0272139361726, -938.7896875089544, -642.9377040154696, -950.786777585181, -671.2042484182849, -784.4370637396115, -484.5613273061566, -649.7168379792606, -485.1783072934818, -272.98401420908453, -874.8185156233216, -1116.8230330925498, -949.840367127329, -763.7895893839561, -820.5516595252263, -1009.9913442819319, -458.1461387014569, -929.3720145121039], "episode_lengths": [150, 150, 104, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 95, 150, 117, 150, 57, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 142, 85, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-739.1819909916235, -933.4973414525005, -308.94786436445145, -1200.2320293129733, -943.1811280554963, -696.5927440428677, -887.910818774709, -962.5868730269378, -619.9860320326995, -78.71296411127322, -642.5445423479661, -779.0337303261686, -521.7250279060971, -452.1626778185475, -797.0385674222904, -339.04560716464175, -689.1985822424582, -432.1017670329284, -539.0818949871228, -130.50406942955806, -487.9168724800482, -774.0333909063129, -587.0573527229622, -943.5954300508669, -571.6014285591164, -690.0327954446848, -832.8322270137053, -305.7601007559822, -673.0272139361726, -938.7896875089544, -642.9377040154696, -950.786777585181, -671.2042484182849, -784.4370637396115, -484.5613273061566, -649.7168379792606, -485.1783072934818, -272.98401420908453, -874.8185156233216, -1116.8230330925498, -949.840367127329, -763.7895893839561, -820.5516595252263, -1009.9913442819319, -458.1461387014569, -929.3720145121039]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5807119361131915, "mean_inference_ms": 1.7616166166693248, "mean_action_processing_ms": 0.29341293448981565, "mean_env_wait_ms": 3.066887296677709, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0147638113602348, "StateBufferConnector_ms": 0.008480963499649712, "ViewRequirementAgentConnector_ms": 0.18679577371348505}, "num_episodes": 23, "episode_return_max": -78.71296411127322, "episode_return_min": -1200.2320293129733, "episode_return_mean": -681.8054716307939, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.7526587916981, "num_env_steps_trained_throughput_per_sec": 302.7526587916981, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13468.404, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13468.336, "sample_time_ms": 1230.947, "learn_time_ms": 12158.396, "learn_throughput": 328.991, "synch_weights_time_ms": 78.214}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00013", "date": "2024-08-03_04-20-25", "timestamp": 1722639025, "time_this_iter_s": 13.225974798202515, "time_total_s": 26.96250343322754, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c709c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.96250343322754, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 38.33157894736843, "ram_util_percent": 48.63684210526316}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.0263354693229, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.8802701373895, "policy_loss": -0.011004429829093472, "vf_loss": 8.88835893770059, "vf_explained_var": 0.2253660515571634, "kl": 0.015295485193678359, "entropy": 1.4345258283118407, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -54.4670411651434, "episode_reward_min": -1295.894987523678, "episode_reward_mean": -687.1158920133598, "episode_len_mean": 140.08219178082192, "episode_media": {}, "episodes_timesteps_total": 10226, "policy_reward_min": {"policy_0": -1295.894987523678}, "policy_reward_max": {"policy_0": -54.4670411651434}, "policy_reward_mean": {"policy_0": -687.1158920133598}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-739.1819909916235, -933.4973414525005, -308.94786436445145, -1200.2320293129733, -943.1811280554963, -696.5927440428677, -887.910818774709, -962.5868730269378, -619.9860320326995, -78.71296411127322, -642.5445423479661, -779.0337303261686, -521.7250279060971, -452.1626778185475, -797.0385674222904, -339.04560716464175, -689.1985822424582, -432.1017670329284, -539.0818949871228, -130.50406942955806, -487.9168724800482, -774.0333909063129, -587.0573527229622, -943.5954300508669, -571.6014285591164, -690.0327954446848, -832.8322270137053, -305.7601007559822, -673.0272139361726, -938.7896875089544, -642.9377040154696, -950.786777585181, -671.2042484182849, -784.4370637396115, -484.5613273061566, -649.7168379792606, -485.1783072934818, -272.98401420908453, -874.8185156233216, -1116.8230330925498, -949.840367127329, -763.7895893839561, -820.5516595252263, -1009.9913442819319, -458.1461387014569, -929.3720145121039, -150.4723397915425, -145.54388020794866, -505.47385429995336, -514.3194798573203, -345.08925050471873, -559.6712212782503, -872.8123562413055, -362.0958579679053, -1295.894987523678, -641.126347173403, -1070.2490441737316, -224.29368903394726, -834.2336231785478, -1045.25367038634, -1118.3580083257477, -54.4670411651434, -1043.669699932387, -415.6270469516815, -1146.0312139258147, -485.8194400484063, -933.4685043503415, -656.5630150615119, -1011.2254842538152, -497.9083709500146, -1048.980072740882, -837.7999176780517, -979.9610049563648], "episode_lengths": [150, 150, 104, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 95, 150, 117, 150, 57, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 142, 85, 150, 150, 150, 150, 150, 150, 150, 150, 101, 70, 150, 150, 150, 150, 150, 101, 150, 150, 150, 110, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150], "policy_policy_0_reward": [-739.1819909916235, -933.4973414525005, -308.94786436445145, -1200.2320293129733, -943.1811280554963, -696.5927440428677, -887.910818774709, -962.5868730269378, -619.9860320326995, -78.71296411127322, -642.5445423479661, -779.0337303261686, -521.7250279060971, -452.1626778185475, -797.0385674222904, -339.04560716464175, -689.1985822424582, -432.1017670329284, -539.0818949871228, -130.50406942955806, -487.9168724800482, -774.0333909063129, -587.0573527229622, -943.5954300508669, -571.6014285591164, -690.0327954446848, -832.8322270137053, -305.7601007559822, -673.0272139361726, -938.7896875089544, -642.9377040154696, -950.786777585181, -671.2042484182849, -784.4370637396115, -484.5613273061566, -649.7168379792606, -485.1783072934818, -272.98401420908453, -874.8185156233216, -1116.8230330925498, -949.840367127329, -763.7895893839561, -820.5516595252263, -1009.9913442819319, -458.1461387014569, -929.3720145121039, -150.4723397915425, -145.54388020794866, -505.47385429995336, -514.3194798573203, -345.08925050471873, -559.6712212782503, -872.8123562413055, -362.0958579679053, -1295.894987523678, -641.126347173403, -1070.2490441737316, -224.29368903394726, -834.2336231785478, -1045.25367038634, -1118.3580083257477, -54.4670411651434, -1043.669699932387, -415.6270469516815, -1146.0312139258147, -485.8194400484063, -933.4685043503415, -656.5630150615119, -1011.2254842538152, -497.9083709500146, -1048.980072740882, -837.7999176780517, -979.9610049563648]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5809792076457094, "mean_inference_ms": 1.7659504266193622, "mean_action_processing_ms": 0.2947383182322015, "mean_env_wait_ms": 3.0761349846122625, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014521651072044894, "StateBufferConnector_ms": 0.013148294736261237, "ViewRequirementAgentConnector_ms": 0.19138741166624304}, "num_episodes": 27, "episode_return_max": -54.4670411651434, "episode_return_min": -1295.894987523678, "episode_return_mean": -687.1158920133598, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.767289193557, "num_env_steps_trained_throughput_per_sec": 292.767289193557, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13533.184, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13533.11, "sample_time_ms": 1220.907, "learn_time_ms": 12237.282, "learn_throughput": 326.87, "synch_weights_time_ms": 74.156}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00013", "date": "2024-08-03_04-20-38", "timestamp": 1722639038, "time_this_iter_s": 13.676245212554932, "time_total_s": 40.63874864578247, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70bd90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 40.63874864578247, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 22.973684210526315, "ram_util_percent": 48.70000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.00240918211639, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.963748509685198, "policy_loss": -0.009967339957074727, "vf_loss": 8.97071601897478, "vf_explained_var": 0.3721149635811647, "kl": 0.015753053740142308, "entropy": 1.5078418500721456, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -3.9231740536401514, "episode_reward_min": -1295.894987523678, "episode_reward_mean": -703.6801717202814, "episode_len_mean": 140.16, "episode_media": {}, "episodes_timesteps_total": 14016, "policy_reward_min": {"policy_0": -1295.894987523678}, "policy_reward_max": {"policy_0": -3.9231740536401514}, "policy_reward_mean": {"policy_0": -703.6801717202814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-933.4973414525005, -308.94786436445145, -1200.2320293129733, -943.1811280554963, -696.5927440428677, -887.910818774709, -962.5868730269378, -619.9860320326995, -78.71296411127322, -642.5445423479661, -779.0337303261686, -521.7250279060971, -452.1626778185475, -797.0385674222904, -339.04560716464175, -689.1985822424582, -432.1017670329284, -539.0818949871228, -130.50406942955806, -487.9168724800482, -774.0333909063129, -587.0573527229622, -943.5954300508669, -571.6014285591164, -690.0327954446848, -832.8322270137053, -305.7601007559822, -673.0272139361726, -938.7896875089544, -642.9377040154696, -950.786777585181, -671.2042484182849, -784.4370637396115, -484.5613273061566, -649.7168379792606, -485.1783072934818, -272.98401420908453, -874.8185156233216, -1116.8230330925498, -949.840367127329, -763.7895893839561, -820.5516595252263, -1009.9913442819319, -458.1461387014569, -929.3720145121039, -150.4723397915425, -145.54388020794866, -505.47385429995336, -514.3194798573203, -345.08925050471873, -559.6712212782503, -872.8123562413055, -362.0958579679053, -1295.894987523678, -641.126347173403, -1070.2490441737316, -224.29368903394726, -834.2336231785478, -1045.25367038634, -1118.3580083257477, -54.4670411651434, -1043.669699932387, -415.6270469516815, -1146.0312139258147, -485.8194400484063, -933.4685043503415, -656.5630150615119, -1011.2254842538152, -497.9083709500146, -1048.980072740882, -837.7999176780517, -979.9610049563648, -1164.7762160139537, -906.7083011366287, -283.2250523348743, -1018.9867199120524, -229.0373594736955, -159.4610695344992, -1157.4772175938208, -830.6197881548748, -984.7138875457288, -394.7458917137379, -922.5533591618982, -1180.3789293458933, -848.1675635421947, -250.30640467915873, -593.1548924823473, -1028.9414381699528, -935.934237812883, -1118.4965428253847, -3.9231740536401514, -534.3460016743051, -884.6857541132636, -372.8410887655278, -754.6514171279208, -1114.0458530311073, -1062.6437562644337, -507.6284799904058, -642.5775149123784, -1062.7111346779338], "episode_lengths": [150, 104, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 95, 150, 117, 150, 57, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 142, 85, 150, 150, 150, 150, 150, 150, 150, 150, 101, 70, 150, 150, 150, 150, 150, 101, 150, 150, 150, 110, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 127, 150, 118, 106, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-933.4973414525005, -308.94786436445145, -1200.2320293129733, -943.1811280554963, -696.5927440428677, -887.910818774709, -962.5868730269378, -619.9860320326995, -78.71296411127322, -642.5445423479661, -779.0337303261686, -521.7250279060971, -452.1626778185475, -797.0385674222904, -339.04560716464175, -689.1985822424582, -432.1017670329284, -539.0818949871228, -130.50406942955806, -487.9168724800482, -774.0333909063129, -587.0573527229622, -943.5954300508669, -571.6014285591164, -690.0327954446848, -832.8322270137053, -305.7601007559822, -673.0272139361726, -938.7896875089544, -642.9377040154696, -950.786777585181, -671.2042484182849, -784.4370637396115, -484.5613273061566, -649.7168379792606, -485.1783072934818, -272.98401420908453, -874.8185156233216, -1116.8230330925498, -949.840367127329, -763.7895893839561, -820.5516595252263, -1009.9913442819319, -458.1461387014569, -929.3720145121039, -150.4723397915425, -145.54388020794866, -505.47385429995336, -514.3194798573203, -345.08925050471873, -559.6712212782503, -872.8123562413055, -362.0958579679053, -1295.894987523678, -641.126347173403, -1070.2490441737316, -224.29368903394726, -834.2336231785478, -1045.25367038634, -1118.3580083257477, -54.4670411651434, -1043.669699932387, -415.6270469516815, -1146.0312139258147, -485.8194400484063, -933.4685043503415, -656.5630150615119, -1011.2254842538152, -497.9083709500146, -1048.980072740882, -837.7999176780517, -979.9610049563648, -1164.7762160139537, -906.7083011366287, -283.2250523348743, -1018.9867199120524, -229.0373594736955, -159.4610695344992, -1157.4772175938208, -830.6197881548748, -984.7138875457288, -394.7458917137379, -922.5533591618982, -1180.3789293458933, -848.1675635421947, -250.30640467915873, -593.1548924823473, -1028.9414381699528, -935.934237812883, -1118.4965428253847, -3.9231740536401514, -534.3460016743051, -884.6857541132636, -372.8410887655278, -754.6514171279208, -1114.0458530311073, -1062.6437562644337, -507.6284799904058, -642.5775149123784, -1062.7111346779338]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5822638590981248, "mean_inference_ms": 1.7737800754556903, "mean_action_processing_ms": 0.2960601450586287, "mean_env_wait_ms": 3.0881028331323774, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01476287841796875, "StateBufferConnector_ms": 0.012137889862060547, "ViewRequirementAgentConnector_ms": 0.19947218894958496}, "num_episodes": 28, "episode_return_max": -3.9231740536401514, "episode_return_min": -1295.894987523678, "episode_return_mean": -703.6801717202814, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.9062065387097, "num_env_steps_trained_throughput_per_sec": 348.9062065387097, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13015.991, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13015.919, "sample_time_ms": 1205.215, "learn_time_ms": 11740.332, "learn_throughput": 340.706, "synch_weights_time_ms": 69.624}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00013", "date": "2024-08-03_04-20-50", "timestamp": 1722639050, "time_this_iter_s": 11.476808547973633, "time_total_s": 52.1155571937561, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70ab90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.1155571937561, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 47.470588235294116, "ram_util_percent": 48.77058823529411}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.370991614088416, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.276137375831604, "policy_loss": -0.009956032837120194, "vf_loss": 8.283110464115937, "vf_explained_var": 0.4579881351441145, "kl": 0.015667089515712485, "entropy": 1.504449500516057, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -3.9231740536401514, "episode_reward_min": -1397.5680883155321, "episode_reward_mean": -733.324636795678, "episode_len_mean": 142.27, "episode_media": {}, "episodes_timesteps_total": 14227, "policy_reward_min": {"policy_0": -1397.5680883155321}, "policy_reward_max": {"policy_0": -3.9231740536401514}, "policy_reward_mean": {"policy_0": -733.324636795678}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-938.7896875089544, -642.9377040154696, -950.786777585181, -671.2042484182849, -784.4370637396115, -484.5613273061566, -649.7168379792606, -485.1783072934818, -272.98401420908453, -874.8185156233216, -1116.8230330925498, -949.840367127329, -763.7895893839561, -820.5516595252263, -1009.9913442819319, -458.1461387014569, -929.3720145121039, -150.4723397915425, -145.54388020794866, -505.47385429995336, -514.3194798573203, -345.08925050471873, -559.6712212782503, -872.8123562413055, -362.0958579679053, -1295.894987523678, -641.126347173403, -1070.2490441737316, -224.29368903394726, -834.2336231785478, -1045.25367038634, -1118.3580083257477, -54.4670411651434, -1043.669699932387, -415.6270469516815, -1146.0312139258147, -485.8194400484063, -933.4685043503415, -656.5630150615119, -1011.2254842538152, -497.9083709500146, -1048.980072740882, -837.7999176780517, -979.9610049563648, -1164.7762160139537, -906.7083011366287, -283.2250523348743, -1018.9867199120524, -229.0373594736955, -159.4610695344992, -1157.4772175938208, -830.6197881548748, -984.7138875457288, -394.7458917137379, -922.5533591618982, -1180.3789293458933, -848.1675635421947, -250.30640467915873, -593.1548924823473, -1028.9414381699528, -935.934237812883, -1118.4965428253847, -3.9231740536401514, -534.3460016743051, -884.6857541132636, -372.8410887655278, -754.6514171279208, -1114.0458530311073, -1062.6437562644337, -507.6284799904058, -642.5775149123784, -1062.7111346779338, -886.0756696957367, -143.40410524506467, -538.6725543073198, -599.1860255059839, -1024.7343034770151, -824.4229848234526, -787.9621200046879, -987.6118562900803, -882.3262826735288, -703.8240587848645, -410.5718042281478, -1397.5680883155321, -560.0146966752536, -940.2376096304874, -135.3747016025619, -1188.345263330368, -952.2914355326479, -951.8713714690296, -696.0953434885598, -931.2948018409024, -823.5111342453073, -543.119135464096, -438.1018181969791, -1150.4475508359521, -483.96997649977754, -660.945819486395, -491.4713074790792, -650.9357621323725], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 142, 85, 150, 150, 150, 150, 150, 150, 150, 150, 101, 70, 150, 150, 150, 150, 150, 101, 150, 150, 150, 110, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 127, 150, 118, 106, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-938.7896875089544, -642.9377040154696, -950.786777585181, -671.2042484182849, -784.4370637396115, -484.5613273061566, -649.7168379792606, -485.1783072934818, -272.98401420908453, -874.8185156233216, -1116.8230330925498, -949.840367127329, -763.7895893839561, -820.5516595252263, -1009.9913442819319, -458.1461387014569, -929.3720145121039, -150.4723397915425, -145.54388020794866, -505.47385429995336, -514.3194798573203, -345.08925050471873, -559.6712212782503, -872.8123562413055, -362.0958579679053, -1295.894987523678, -641.126347173403, -1070.2490441737316, -224.29368903394726, -834.2336231785478, -1045.25367038634, -1118.3580083257477, -54.4670411651434, -1043.669699932387, -415.6270469516815, -1146.0312139258147, -485.8194400484063, -933.4685043503415, -656.5630150615119, -1011.2254842538152, -497.9083709500146, -1048.980072740882, -837.7999176780517, -979.9610049563648, -1164.7762160139537, -906.7083011366287, -283.2250523348743, -1018.9867199120524, -229.0373594736955, -159.4610695344992, -1157.4772175938208, -830.6197881548748, -984.7138875457288, -394.7458917137379, -922.5533591618982, -1180.3789293458933, -848.1675635421947, -250.30640467915873, -593.1548924823473, -1028.9414381699528, -935.934237812883, -1118.4965428253847, -3.9231740536401514, -534.3460016743051, -884.6857541132636, -372.8410887655278, -754.6514171279208, -1114.0458530311073, -1062.6437562644337, -507.6284799904058, -642.5775149123784, -1062.7111346779338, -886.0756696957367, -143.40410524506467, -538.6725543073198, -599.1860255059839, -1024.7343034770151, -824.4229848234526, -787.9621200046879, -987.6118562900803, -882.3262826735288, -703.8240587848645, -410.5718042281478, -1397.5680883155321, -560.0146966752536, -940.2376096304874, -135.3747016025619, -1188.345263330368, -952.2914355326479, -951.8713714690296, -696.0953434885598, -931.2948018409024, -823.5111342453073, -543.119135464096, -438.1018181969791, -1150.4475508359521, -483.96997649977754, -660.945819486395, -491.4713074790792, -650.9357621323725]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5826059921031324, "mean_inference_ms": 1.774868644728924, "mean_action_processing_ms": 0.2969102897840211, "mean_env_wait_ms": 3.0964539910644233, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015436172485351562, "StateBufferConnector_ms": 0.012354850769042969, "ViewRequirementAgentConnector_ms": 0.20381546020507812}, "num_episodes": 28, "episode_return_max": -3.9231740536401514, "episode_return_min": -1397.5680883155321, "episode_return_mean": -733.324636795678, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.2885671801923, "num_env_steps_trained_throughput_per_sec": 306.2885671801923, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13024.711, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13024.64, "sample_time_ms": 1207.1, "learn_time_ms": 11748.969, "learn_throughput": 340.455, "synch_weights_time_ms": 67.82}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00013", "date": "2024-08-03_04-21-03", "timestamp": 1722639063, "time_this_iter_s": 13.07178544998169, "time_total_s": 65.1873426437378, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c709c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 65.1873426437378, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 23.53888888888889, "ram_util_percent": 48.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.679649961243072, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.928266155719757, "policy_loss": -0.007324228702539889, "vf_loss": 7.932528907557328, "vf_explained_var": 0.5313728889450431, "kl": 0.016076937511661525, "entropy": 1.5390761025249957, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -2.046103762681901, "episode_reward_min": -1397.5680883155321, "episode_reward_mean": -752.988915282669, "episode_len_mean": 141.29, "episode_media": {}, "episodes_timesteps_total": 14129, "policy_reward_min": {"policy_0": -1397.5680883155321}, "policy_reward_max": {"policy_0": -2.046103762681901}, "policy_reward_mean": {"policy_0": -752.988915282669}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1045.25367038634, -1118.3580083257477, -54.4670411651434, -1043.669699932387, -415.6270469516815, -1146.0312139258147, -485.8194400484063, -933.4685043503415, -656.5630150615119, -1011.2254842538152, -497.9083709500146, -1048.980072740882, -837.7999176780517, -979.9610049563648, -1164.7762160139537, -906.7083011366287, -283.2250523348743, -1018.9867199120524, -229.0373594736955, -159.4610695344992, -1157.4772175938208, -830.6197881548748, -984.7138875457288, -394.7458917137379, -922.5533591618982, -1180.3789293458933, -848.1675635421947, -250.30640467915873, -593.1548924823473, -1028.9414381699528, -935.934237812883, -1118.4965428253847, -3.9231740536401514, -534.3460016743051, -884.6857541132636, -372.8410887655278, -754.6514171279208, -1114.0458530311073, -1062.6437562644337, -507.6284799904058, -642.5775149123784, -1062.7111346779338, -886.0756696957367, -143.40410524506467, -538.6725543073198, -599.1860255059839, -1024.7343034770151, -824.4229848234526, -787.9621200046879, -987.6118562900803, -882.3262826735288, -703.8240587848645, -410.5718042281478, -1397.5680883155321, -560.0146966752536, -940.2376096304874, -135.3747016025619, -1188.345263330368, -952.2914355326479, -951.8713714690296, -696.0953434885598, -931.2948018409024, -823.5111342453073, -543.119135464096, -438.1018181969791, -1150.4475508359521, -483.96997649977754, -660.945819486395, -491.4713074790792, -650.9357621323725, -1138.247080377487, -48.23636356068567, -933.6526566877709, -975.4433903454272, -314.4479457186026, -574.0670101017681, -390.13546967608033, -1017.1851662288339, -1179.3110504700394, -961.6073047771378, -412.9202503891821, -321.61882203580603, -685.4572184262285, -1064.8716647860665, -1306.1689222712976, -253.3936296883058, -696.3690951131418, -470.00859184528355, -1075.0303556280385, -1191.0549081392514, -482.7876080568363, -2.046103762681901, -364.6379912709935, -1232.841817874271, -427.9866452165451, -938.7473309100535, -839.0341548710879, -1276.6934925919018, -1050.7372236374142, -666.8931457765144], "episode_lengths": [150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 127, 150, 118, 106, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 150, 150, 150, 150, 150, 150, 116, 97, 150, 150, 150, 84, 150, 150, 150, 150, 141, 48, 135, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1045.25367038634, -1118.3580083257477, -54.4670411651434, -1043.669699932387, -415.6270469516815, -1146.0312139258147, -485.8194400484063, -933.4685043503415, -656.5630150615119, -1011.2254842538152, -497.9083709500146, -1048.980072740882, -837.7999176780517, -979.9610049563648, -1164.7762160139537, -906.7083011366287, -283.2250523348743, -1018.9867199120524, -229.0373594736955, -159.4610695344992, -1157.4772175938208, -830.6197881548748, -984.7138875457288, -394.7458917137379, -922.5533591618982, -1180.3789293458933, -848.1675635421947, -250.30640467915873, -593.1548924823473, -1028.9414381699528, -935.934237812883, -1118.4965428253847, -3.9231740536401514, -534.3460016743051, -884.6857541132636, -372.8410887655278, -754.6514171279208, -1114.0458530311073, -1062.6437562644337, -507.6284799904058, -642.5775149123784, -1062.7111346779338, -886.0756696957367, -143.40410524506467, -538.6725543073198, -599.1860255059839, -1024.7343034770151, -824.4229848234526, -787.9621200046879, -987.6118562900803, -882.3262826735288, -703.8240587848645, -410.5718042281478, -1397.5680883155321, -560.0146966752536, -940.2376096304874, -135.3747016025619, -1188.345263330368, -952.2914355326479, -951.8713714690296, -696.0953434885598, -931.2948018409024, -823.5111342453073, -543.119135464096, -438.1018181969791, -1150.4475508359521, -483.96997649977754, -660.945819486395, -491.4713074790792, -650.9357621323725, -1138.247080377487, -48.23636356068567, -933.6526566877709, -975.4433903454272, -314.4479457186026, -574.0670101017681, -390.13546967608033, -1017.1851662288339, -1179.3110504700394, -961.6073047771378, -412.9202503891821, -321.61882203580603, -685.4572184262285, -1064.8716647860665, -1306.1689222712976, -253.3936296883058, -696.3690951131418, -470.00859184528355, -1075.0303556280385, -1191.0549081392514, -482.7876080568363, -2.046103762681901, -364.6379912709935, -1232.841817874271, -427.9866452165451, -938.7473309100535, -839.0341548710879, -1276.6934925919018, -1050.7372236374142, -666.8931457765144]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5803811187061602, "mean_inference_ms": 1.770801130898495, "mean_action_processing_ms": 0.29638957021834367, "mean_env_wait_ms": 3.0954598871442527, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01509404182434082, "StateBufferConnector_ms": 0.01223301887512207, "ViewRequirementAgentConnector_ms": 0.20311307907104492}, "num_episodes": 30, "episode_return_max": -2.046103762681901, "episode_return_min": -1397.5680883155321, "episode_return_mean": -752.988915282669, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.0008863776202, "num_env_steps_trained_throughput_per_sec": 301.0008863776202, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 13068.761, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13068.69, "sample_time_ms": 1204.848, "learn_time_ms": 11794.994, "learn_throughput": 339.127, "synch_weights_time_ms": 68.084}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00013", "date": "2024-08-03_04-21-16", "timestamp": 1722639076, "time_this_iter_s": 13.301091194152832, "time_total_s": 78.48843383789062, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78f7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 78.48843383789062, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 22.94736842105263, "ram_util_percent": 48.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.288397369285423, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.675585473577182, "policy_loss": -0.012001600303240897, "vf_loss": 7.683909199635187, "vf_explained_var": 0.7092839515457551, "kl": 0.01913382683621118, "entropy": 1.489006020501256, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -2.046103762681901, "episode_reward_min": -1397.5680883155321, "episode_reward_mean": -730.846913335832, "episode_len_mean": 140.07, "episode_media": {}, "episodes_timesteps_total": 14007, "policy_reward_min": {"policy_0": -1397.5680883155321}, "policy_reward_max": {"policy_0": -2.046103762681901}, "policy_reward_mean": {"policy_0": -730.846913335832}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.9231740536401514, -534.3460016743051, -884.6857541132636, -372.8410887655278, -754.6514171279208, -1114.0458530311073, -1062.6437562644337, -507.6284799904058, -642.5775149123784, -1062.7111346779338, -886.0756696957367, -143.40410524506467, -538.6725543073198, -599.1860255059839, -1024.7343034770151, -824.4229848234526, -787.9621200046879, -987.6118562900803, -882.3262826735288, -703.8240587848645, -410.5718042281478, -1397.5680883155321, -560.0146966752536, -940.2376096304874, -135.3747016025619, -1188.345263330368, -952.2914355326479, -951.8713714690296, -696.0953434885598, -931.2948018409024, -823.5111342453073, -543.119135464096, -438.1018181969791, -1150.4475508359521, -483.96997649977754, -660.945819486395, -491.4713074790792, -650.9357621323725, -1138.247080377487, -48.23636356068567, -933.6526566877709, -975.4433903454272, -314.4479457186026, -574.0670101017681, -390.13546967608033, -1017.1851662288339, -1179.3110504700394, -961.6073047771378, -412.9202503891821, -321.61882203580603, -685.4572184262285, -1064.8716647860665, -1306.1689222712976, -253.3936296883058, -696.3690951131418, -470.00859184528355, -1075.0303556280385, -1191.0549081392514, -482.7876080568363, -2.046103762681901, -364.6379912709935, -1232.841817874271, -427.9866452165451, -938.7473309100535, -839.0341548710879, -1276.6934925919018, -1050.7372236374142, -666.8931457765144, -304.5915655463329, -18.21403241837921, -899.4670463944414, -1216.6210344694675, -993.7984582980903, -1207.605727884198, -856.1135142709356, -568.2547108652275, -1007.7189125770462, -679.4832805522502, -1147.9484059034198, -968.7026762960681, -373.65297981513334, -729.4041112486975, -61.39601547574084, -804.1287967944189, -660.5422508754746, -703.9946220128314, -883.4937756786011, -1184.9125237877845, -252.4457032164809, -101.07867862143188, -814.7131078612084, -1140.4280743286592, -771.2003597785587, -546.7940363338748, -632.2978774833141, -444.83440767383775, -1198.3467265066931, -350.02129452875596, -1066.2106189900223, -480.2018409890078], "episode_lengths": [45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 150, 150, 150, 150, 150, 150, 116, 97, 150, 150, 150, 84, 150, 150, 150, 150, 141, 48, 135, 150, 150, 150, 150, 150, 150, 150, 150, 34, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 66, 150, 150, 150, 150, 150, 88, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142], "policy_policy_0_reward": [-3.9231740536401514, -534.3460016743051, -884.6857541132636, -372.8410887655278, -754.6514171279208, -1114.0458530311073, -1062.6437562644337, -507.6284799904058, -642.5775149123784, -1062.7111346779338, -886.0756696957367, -143.40410524506467, -538.6725543073198, -599.1860255059839, -1024.7343034770151, -824.4229848234526, -787.9621200046879, -987.6118562900803, -882.3262826735288, -703.8240587848645, -410.5718042281478, -1397.5680883155321, -560.0146966752536, -940.2376096304874, -135.3747016025619, -1188.345263330368, -952.2914355326479, -951.8713714690296, -696.0953434885598, -931.2948018409024, -823.5111342453073, -543.119135464096, -438.1018181969791, -1150.4475508359521, -483.96997649977754, -660.945819486395, -491.4713074790792, -650.9357621323725, -1138.247080377487, -48.23636356068567, -933.6526566877709, -975.4433903454272, -314.4479457186026, -574.0670101017681, -390.13546967608033, -1017.1851662288339, -1179.3110504700394, -961.6073047771378, -412.9202503891821, -321.61882203580603, -685.4572184262285, -1064.8716647860665, -1306.1689222712976, -253.3936296883058, -696.3690951131418, -470.00859184528355, -1075.0303556280385, -1191.0549081392514, -482.7876080568363, -2.046103762681901, -364.6379912709935, -1232.841817874271, -427.9866452165451, -938.7473309100535, -839.0341548710879, -1276.6934925919018, -1050.7372236374142, -666.8931457765144, -304.5915655463329, -18.21403241837921, -899.4670463944414, -1216.6210344694675, -993.7984582980903, -1207.605727884198, -856.1135142709356, -568.2547108652275, -1007.7189125770462, -679.4832805522502, -1147.9484059034198, -968.7026762960681, -373.65297981513334, -729.4041112486975, -61.39601547574084, -804.1287967944189, -660.5422508754746, -703.9946220128314, -883.4937756786011, -1184.9125237877845, -252.4457032164809, -101.07867862143188, -814.7131078612084, -1140.4280743286592, -771.2003597785587, -546.7940363338748, -632.2978774833141, -444.83440767383775, -1198.3467265066931, -350.02129452875596, -1066.2106189900223, -480.2018409890078]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5895564333052785, "mean_inference_ms": 1.8030999455614276, "mean_action_processing_ms": 0.3019030625984371, "mean_env_wait_ms": 3.1585625755327644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.015111684799194336, "StateBufferConnector_ms": 0.008787870407104492, "ViewRequirementAgentConnector_ms": 0.21573495864868164}, "num_episodes": 32, "episode_return_max": -2.046103762681901, "episode_return_min": -1397.5680883155321, "episode_return_mean": -730.846913335832, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.90265579105, "num_env_steps_trained_throughput_per_sec": 279.90265579105, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 13243.324, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13243.249, "sample_time_ms": 1302.521, "learn_time_ms": 11869.34, "learn_throughput": 337.003, "synch_weights_time_ms": 70.576}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00013", "date": "2024-08-03_04-21-31", "timestamp": 1722639091, "time_this_iter_s": 14.302699089050293, "time_total_s": 92.79113292694092, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c785870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 92.79113292694092, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 35.97619047619048, "ram_util_percent": 48.89047619047619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.467494172851243, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.052449586987495, "policy_loss": -0.012421714966088378, "vf_loss": 7.061290842294693, "vf_explained_var": 0.7491646007324259, "kl": 0.018654855096974655, "entropy": 1.505170017729203, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -2.046103762681901, "episode_reward_min": -1306.1689222712976, "episode_reward_mean": -721.8492959266696, "episode_len_mean": 138.53, "episode_media": {}, "episodes_timesteps_total": 13853, "policy_reward_min": {"policy_0": -1306.1689222712976}, "policy_reward_max": {"policy_0": -2.046103762681901}, "policy_reward_mean": {"policy_0": -721.8492959266696}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-952.2914355326479, -951.8713714690296, -696.0953434885598, -931.2948018409024, -823.5111342453073, -543.119135464096, -438.1018181969791, -1150.4475508359521, -483.96997649977754, -660.945819486395, -491.4713074790792, -650.9357621323725, -1138.247080377487, -48.23636356068567, -933.6526566877709, -975.4433903454272, -314.4479457186026, -574.0670101017681, -390.13546967608033, -1017.1851662288339, -1179.3110504700394, -961.6073047771378, -412.9202503891821, -321.61882203580603, -685.4572184262285, -1064.8716647860665, -1306.1689222712976, -253.3936296883058, -696.3690951131418, -470.00859184528355, -1075.0303556280385, -1191.0549081392514, -482.7876080568363, -2.046103762681901, -364.6379912709935, -1232.841817874271, -427.9866452165451, -938.7473309100535, -839.0341548710879, -1276.6934925919018, -1050.7372236374142, -666.8931457765144, -304.5915655463329, -18.21403241837921, -899.4670463944414, -1216.6210344694675, -993.7984582980903, -1207.605727884198, -856.1135142709356, -568.2547108652275, -1007.7189125770462, -679.4832805522502, -1147.9484059034198, -968.7026762960681, -373.65297981513334, -729.4041112486975, -61.39601547574084, -804.1287967944189, -660.5422508754746, -703.9946220128314, -883.4937756786011, -1184.9125237877845, -252.4457032164809, -101.07867862143188, -814.7131078612084, -1140.4280743286592, -771.2003597785587, -546.7940363338748, -632.2978774833141, -444.83440767383775, -1198.3467265066931, -350.02129452875596, -1066.2106189900223, -480.2018409890078, -555.4629650072133, -488.3712627265436, -972.7019901945703, -602.9965095993674, -1019.8847994847569, -975.8139320542812, -1061.9124551782404, -102.08171992232931, -119.8390405795891, -824.9205585927032, -1215.2721409239425, -791.9151179308881, -1048.73088987411, -784.2016247530404, -808.6694837602, -482.01011911107145, -76.9414856650575, -1136.443888858287, -17.08709262863374, -860.671631607452, -1189.6771984033203, -489.7178256262619, -383.7800045218196, -740.7552512797598, -681.549011445073, -619.2165585562482], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 150, 150, 150, 150, 150, 150, 116, 97, 150, 150, 150, 84, 150, 150, 150, 150, 141, 48, 135, 150, 150, 150, 150, 150, 150, 150, 150, 34, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 66, 150, 150, 150, 150, 150, 88, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 68, 72, 150, 150, 150, 150, 150, 150, 121, 66, 150, 47, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-952.2914355326479, -951.8713714690296, -696.0953434885598, -931.2948018409024, -823.5111342453073, -543.119135464096, -438.1018181969791, -1150.4475508359521, -483.96997649977754, -660.945819486395, -491.4713074790792, -650.9357621323725, -1138.247080377487, -48.23636356068567, -933.6526566877709, -975.4433903454272, -314.4479457186026, -574.0670101017681, -390.13546967608033, -1017.1851662288339, -1179.3110504700394, -961.6073047771378, -412.9202503891821, -321.61882203580603, -685.4572184262285, -1064.8716647860665, -1306.1689222712976, -253.3936296883058, -696.3690951131418, -470.00859184528355, -1075.0303556280385, -1191.0549081392514, -482.7876080568363, -2.046103762681901, -364.6379912709935, -1232.841817874271, -427.9866452165451, -938.7473309100535, -839.0341548710879, -1276.6934925919018, -1050.7372236374142, -666.8931457765144, -304.5915655463329, -18.21403241837921, -899.4670463944414, -1216.6210344694675, -993.7984582980903, -1207.605727884198, -856.1135142709356, -568.2547108652275, -1007.7189125770462, -679.4832805522502, -1147.9484059034198, -968.7026762960681, -373.65297981513334, -729.4041112486975, -61.39601547574084, -804.1287967944189, -660.5422508754746, -703.9946220128314, -883.4937756786011, -1184.9125237877845, -252.4457032164809, -101.07867862143188, -814.7131078612084, -1140.4280743286592, -771.2003597785587, -546.7940363338748, -632.2978774833141, -444.83440767383775, -1198.3467265066931, -350.02129452875596, -1066.2106189900223, -480.2018409890078, -555.4629650072133, -488.3712627265436, -972.7019901945703, -602.9965095993674, -1019.8847994847569, -975.8139320542812, -1061.9124551782404, -102.08171992232931, -119.8390405795891, -824.9205585927032, -1215.2721409239425, -791.9151179308881, -1048.73088987411, -784.2016247530404, -808.6694837602, -482.01011911107145, -76.9414856650575, -1136.443888858287, -17.08709262863374, -860.671631607452, -1189.6771984033203, -489.7178256262619, -383.7800045218196, -740.7552512797598, -681.549011445073, -619.2165585562482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5963449487061872, "mean_inference_ms": 1.8256260064842107, "mean_action_processing_ms": 0.3056427975698998, "mean_env_wait_ms": 3.2027115397726336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014164209365844727, "StateBufferConnector_ms": 0.008435487747192383, "ViewRequirementAgentConnector_ms": 0.22497820854187012}, "num_episodes": 26, "episode_return_max": -2.046103762681901, "episode_return_min": -1306.1689222712976, "episode_return_mean": -721.8492959266696, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.88648707150054, "num_env_steps_trained_throughput_per_sec": 296.88648707150054, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13272.055, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13271.981, "sample_time_ms": 1294.0, "learn_time_ms": 11906.762, "learn_throughput": 335.944, "synch_weights_time_ms": 70.356}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00013", "date": "2024-08-03_04-21-44", "timestamp": 1722639104, "time_this_iter_s": 13.486108303070068, "time_total_s": 106.27724123001099, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad2d40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 106.27724123001099, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 22.731578947368423, "ram_util_percent": 48.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.214230901996295, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.539138965308666, "policy_loss": -0.012785507013904861, "vf_loss": 6.548100391030312, "vf_explained_var": 0.7994613322118919, "kl": 0.01987511599497035, "entropy": 1.5094178933650255, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -2.046103762681901, "episode_reward_min": -1306.1689222712976, "episode_reward_mean": -729.2038801247465, "episode_len_mean": 138.56, "episode_media": {}, "episodes_timesteps_total": 13856, "policy_reward_min": {"policy_0": -1306.1689222712976}, "policy_reward_max": {"policy_0": -2.046103762681901}, "policy_reward_mean": {"policy_0": -729.2038801247465}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1306.1689222712976, -253.3936296883058, -696.3690951131418, -470.00859184528355, -1075.0303556280385, -1191.0549081392514, -482.7876080568363, -2.046103762681901, -364.6379912709935, -1232.841817874271, -427.9866452165451, -938.7473309100535, -839.0341548710879, -1276.6934925919018, -1050.7372236374142, -666.8931457765144, -304.5915655463329, -18.21403241837921, -899.4670463944414, -1216.6210344694675, -993.7984582980903, -1207.605727884198, -856.1135142709356, -568.2547108652275, -1007.7189125770462, -679.4832805522502, -1147.9484059034198, -968.7026762960681, -373.65297981513334, -729.4041112486975, -61.39601547574084, -804.1287967944189, -660.5422508754746, -703.9946220128314, -883.4937756786011, -1184.9125237877845, -252.4457032164809, -101.07867862143188, -814.7131078612084, -1140.4280743286592, -771.2003597785587, -546.7940363338748, -632.2978774833141, -444.83440767383775, -1198.3467265066931, -350.02129452875596, -1066.2106189900223, -480.2018409890078, -555.4629650072133, -488.3712627265436, -972.7019901945703, -602.9965095993674, -1019.8847994847569, -975.8139320542812, -1061.9124551782404, -102.08171992232931, -119.8390405795891, -824.9205585927032, -1215.2721409239425, -791.9151179308881, -1048.73088987411, -784.2016247530404, -808.6694837602, -482.01011911107145, -76.9414856650575, -1136.443888858287, -17.08709262863374, -860.671631607452, -1189.6771984033203, -489.7178256262619, -383.7800045218196, -740.7552512797598, -681.549011445073, -619.2165585562482, -1101.4992864820697, -1072.333707350334, -765.5418237854606, -128.86895551614958, -1141.3093631779377, -522.5318432739148, -707.1564197315784, -415.5779089743951, -353.0153526717266, -598.2400975856673, -652.806618656153, -445.70974583521337, -798.8015030083814, -767.7078123567393, -469.529783930231, -819.0203606189533, -1071.7691372584625, -1109.2433285354705, -722.929670726737, -1030.7892598486712, -1292.6726544640426, -820.7283087487887, -64.66192310722964, -1023.0140240081242, -741.9011423774334, -889.3552380300068], "episode_lengths": [150, 84, 150, 150, 150, 150, 141, 48, 135, 150, 150, 150, 150, 150, 150, 150, 150, 34, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 66, 150, 150, 150, 150, 150, 88, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 68, 72, 150, 150, 150, 150, 150, 150, 121, 66, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150], "policy_policy_0_reward": [-1306.1689222712976, -253.3936296883058, -696.3690951131418, -470.00859184528355, -1075.0303556280385, -1191.0549081392514, -482.7876080568363, -2.046103762681901, -364.6379912709935, -1232.841817874271, -427.9866452165451, -938.7473309100535, -839.0341548710879, -1276.6934925919018, -1050.7372236374142, -666.8931457765144, -304.5915655463329, -18.21403241837921, -899.4670463944414, -1216.6210344694675, -993.7984582980903, -1207.605727884198, -856.1135142709356, -568.2547108652275, -1007.7189125770462, -679.4832805522502, -1147.9484059034198, -968.7026762960681, -373.65297981513334, -729.4041112486975, -61.39601547574084, -804.1287967944189, -660.5422508754746, -703.9946220128314, -883.4937756786011, -1184.9125237877845, -252.4457032164809, -101.07867862143188, -814.7131078612084, -1140.4280743286592, -771.2003597785587, -546.7940363338748, -632.2978774833141, -444.83440767383775, -1198.3467265066931, -350.02129452875596, -1066.2106189900223, -480.2018409890078, -555.4629650072133, -488.3712627265436, -972.7019901945703, -602.9965095993674, -1019.8847994847569, -975.8139320542812, -1061.9124551782404, -102.08171992232931, -119.8390405795891, -824.9205585927032, -1215.2721409239425, -791.9151179308881, -1048.73088987411, -784.2016247530404, -808.6694837602, -482.01011911107145, -76.9414856650575, -1136.443888858287, -17.08709262863374, -860.671631607452, -1189.6771984033203, -489.7178256262619, -383.7800045218196, -740.7552512797598, -681.549011445073, -619.2165585562482, -1101.4992864820697, -1072.333707350334, -765.5418237854606, -128.86895551614958, -1141.3093631779377, -522.5318432739148, -707.1564197315784, -415.5779089743951, -353.0153526717266, -598.2400975856673, -652.806618656153, -445.70974583521337, -798.8015030083814, -767.7078123567393, -469.529783930231, -819.0203606189533, -1071.7691372584625, -1109.2433285354705, -722.929670726737, -1030.7892598486712, -1292.6726544640426, -820.7283087487887, -64.66192310722964, -1023.0140240081242, -741.9011423774334, -889.3552380300068]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.602915676127723, "mean_inference_ms": 1.8495685022605557, "mean_action_processing_ms": 0.30932044641844253, "mean_env_wait_ms": 3.2477298560008077, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01354837417602539, "StateBufferConnector_ms": 0.008230447769165039, "ViewRequirementAgentConnector_ms": 0.22689390182495117}, "num_episodes": 26, "episode_return_max": -2.046103762681901, "episode_return_min": -1306.1689222712976, "episode_return_mean": -729.2038801247465, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.2467358590764, "num_env_steps_trained_throughput_per_sec": 307.2467358590764, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 13243.924, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13243.849, "sample_time_ms": 1276.238, "learn_time_ms": 11895.884, "learn_throughput": 336.251, "synch_weights_time_ms": 70.876}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00013", "date": "2024-08-03_04-21-57", "timestamp": 1722639117, "time_this_iter_s": 13.032258987426758, "time_total_s": 119.30950021743774, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c787ac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 119.30950021743774, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 37.05, "ram_util_percent": 48.97777777777778}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.52155755062898, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.109026141961416, "policy_loss": -0.009904087569642192, "vf_loss": 6.114831153055032, "vf_explained_var": 0.8294355468824506, "kl": 0.021299478414281717, "entropy": 1.608131963138779, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -17.08709262863374, "episode_reward_min": -1292.6726544640426, "episode_reward_mean": -707.1215890212193, "episode_len_mean": 138.77, "episode_media": {}, "episodes_timesteps_total": 13877, "policy_reward_min": {"policy_0": -1292.6726544640426}, "policy_reward_max": {"policy_0": -17.08709262863374}, "policy_reward_mean": {"policy_0": -707.1215890212193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-373.65297981513334, -729.4041112486975, -61.39601547574084, -804.1287967944189, -660.5422508754746, -703.9946220128314, -883.4937756786011, -1184.9125237877845, -252.4457032164809, -101.07867862143188, -814.7131078612084, -1140.4280743286592, -771.2003597785587, -546.7940363338748, -632.2978774833141, -444.83440767383775, -1198.3467265066931, -350.02129452875596, -1066.2106189900223, -480.2018409890078, -555.4629650072133, -488.3712627265436, -972.7019901945703, -602.9965095993674, -1019.8847994847569, -975.8139320542812, -1061.9124551782404, -102.08171992232931, -119.8390405795891, -824.9205585927032, -1215.2721409239425, -791.9151179308881, -1048.73088987411, -784.2016247530404, -808.6694837602, -482.01011911107145, -76.9414856650575, -1136.443888858287, -17.08709262863374, -860.671631607452, -1189.6771984033203, -489.7178256262619, -383.7800045218196, -740.7552512797598, -681.549011445073, -619.2165585562482, -1101.4992864820697, -1072.333707350334, -765.5418237854606, -128.86895551614958, -1141.3093631779377, -522.5318432739148, -707.1564197315784, -415.5779089743951, -353.0153526717266, -598.2400975856673, -652.806618656153, -445.70974583521337, -798.8015030083814, -767.7078123567393, -469.529783930231, -819.0203606189533, -1071.7691372584625, -1109.2433285354705, -722.929670726737, -1030.7892598486712, -1292.6726544640426, -820.7283087487887, -64.66192310722964, -1023.0140240081242, -741.9011423774334, -889.3552380300068, -997.3702416784585, -1096.5129013623032, -934.1108698678942, -635.5904116361036, -703.7946748630069, -257.0882654807173, -808.1216655598432, -785.0506700399374, -531.6386020439605, -904.9833632173081, -650.6327699694316, -821.1494656629606, -818.2718386291787, -142.64855364382342, -900.4897333525633, -482.56174329459225, -747.002774109075, -858.7187602191841, -98.50692921369415, -779.1524084862634, -579.7716595945352, -417.31044539412187, -1199.234507551599, -231.2863002127528, -843.6568667337395, -1207.015854146775, -638.5457141336801, -864.5032816792635], "episode_lengths": [129, 150, 66, 150, 150, 150, 150, 150, 88, 59, 150, 150, 150, 150, 150, 150, 150, 150, 150, 142, 150, 150, 150, 150, 150, 150, 150, 68, 72, 150, 150, 150, 150, 150, 150, 121, 66, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 81, 150, 150, 130, 150, 109, 150, 150, 150, 150], "policy_policy_0_reward": [-373.65297981513334, -729.4041112486975, -61.39601547574084, -804.1287967944189, -660.5422508754746, -703.9946220128314, -883.4937756786011, -1184.9125237877845, -252.4457032164809, -101.07867862143188, -814.7131078612084, -1140.4280743286592, -771.2003597785587, -546.7940363338748, -632.2978774833141, -444.83440767383775, -1198.3467265066931, -350.02129452875596, -1066.2106189900223, -480.2018409890078, -555.4629650072133, -488.3712627265436, -972.7019901945703, -602.9965095993674, -1019.8847994847569, -975.8139320542812, -1061.9124551782404, -102.08171992232931, -119.8390405795891, -824.9205585927032, -1215.2721409239425, -791.9151179308881, -1048.73088987411, -784.2016247530404, -808.6694837602, -482.01011911107145, -76.9414856650575, -1136.443888858287, -17.08709262863374, -860.671631607452, -1189.6771984033203, -489.7178256262619, -383.7800045218196, -740.7552512797598, -681.549011445073, -619.2165585562482, -1101.4992864820697, -1072.333707350334, -765.5418237854606, -128.86895551614958, -1141.3093631779377, -522.5318432739148, -707.1564197315784, -415.5779089743951, -353.0153526717266, -598.2400975856673, -652.806618656153, -445.70974583521337, -798.8015030083814, -767.7078123567393, -469.529783930231, -819.0203606189533, -1071.7691372584625, -1109.2433285354705, -722.929670726737, -1030.7892598486712, -1292.6726544640426, -820.7283087487887, -64.66192310722964, -1023.0140240081242, -741.9011423774334, -889.3552380300068, -997.3702416784585, -1096.5129013623032, -934.1108698678942, -635.5904116361036, -703.7946748630069, -257.0882654807173, -808.1216655598432, -785.0506700399374, -531.6386020439605, -904.9833632173081, -650.6327699694316, -821.1494656629606, -818.2718386291787, -142.64855364382342, -900.4897333525633, -482.56174329459225, -747.002774109075, -858.7187602191841, -98.50692921369415, -779.1524084862634, -579.7716595945352, -417.31044539412187, -1199.234507551599, -231.2863002127528, -843.6568667337395, -1207.015854146775, -638.5457141336801, -864.5032816792635]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6066001252357873, "mean_inference_ms": 1.8619399734117916, "mean_action_processing_ms": 0.3106576993795053, "mean_env_wait_ms": 3.2703429295765876, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013075590133666992, "StateBufferConnector_ms": 0.00815582275390625, "ViewRequirementAgentConnector_ms": 0.2207479476928711}, "num_episodes": 28, "episode_return_max": -17.08709262863374, "episode_return_min": -1292.6726544640426, "episode_return_mean": -707.1215890212193, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.73226711964196, "num_env_steps_trained_throughput_per_sec": 290.73226711964196, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13295.369, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13295.295, "sample_time_ms": 1279.027, "learn_time_ms": 11945.729, "learn_throughput": 334.848, "synch_weights_time_ms": 69.694}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00013", "date": "2024-08-03_04-22-11", "timestamp": 1722639131, "time_this_iter_s": 13.770734071731567, "time_total_s": 133.0802342891693, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70a9e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 133.0802342891693, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 22.66, "ram_util_percent": 49.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.26467780868212, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.01861451715231, "policy_loss": -0.010788910714715409, "vf_loss": 6.024235228449106, "vf_explained_var": 0.8589557718485594, "kl": 0.017756049348433105, "entropy": 1.5861168845246236, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -17.08709262863374, "episode_reward_min": -1292.6726544640426, "episode_reward_mean": -754.1854978230423, "episode_len_mean": 140.61, "episode_media": {}, "episodes_timesteps_total": 14061, "policy_reward_min": {"policy_0": -1292.6726544640426}, "policy_reward_max": {"policy_0": -17.08709262863374}, "policy_reward_mean": {"policy_0": -754.1854978230423}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1215.2721409239425, -791.9151179308881, -1048.73088987411, -784.2016247530404, -808.6694837602, -482.01011911107145, -76.9414856650575, -1136.443888858287, -17.08709262863374, -860.671631607452, -1189.6771984033203, -489.7178256262619, -383.7800045218196, -740.7552512797598, -681.549011445073, -619.2165585562482, -1101.4992864820697, -1072.333707350334, -765.5418237854606, -128.86895551614958, -1141.3093631779377, -522.5318432739148, -707.1564197315784, -415.5779089743951, -353.0153526717266, -598.2400975856673, -652.806618656153, -445.70974583521337, -798.8015030083814, -767.7078123567393, -469.529783930231, -819.0203606189533, -1071.7691372584625, -1109.2433285354705, -722.929670726737, -1030.7892598486712, -1292.6726544640426, -820.7283087487887, -64.66192310722964, -1023.0140240081242, -741.9011423774334, -889.3552380300068, -997.3702416784585, -1096.5129013623032, -934.1108698678942, -635.5904116361036, -703.7946748630069, -257.0882654807173, -808.1216655598432, -785.0506700399374, -531.6386020439605, -904.9833632173081, -650.6327699694316, -821.1494656629606, -818.2718386291787, -142.64855364382342, -900.4897333525633, -482.56174329459225, -747.002774109075, -858.7187602191841, -98.50692921369415, -779.1524084862634, -579.7716595945352, -417.31044539412187, -1199.234507551599, -231.2863002127528, -843.6568667337395, -1207.015854146775, -638.5457141336801, -864.5032816792635, -1229.8771723015934, -789.4329097842882, -294.73427380548407, -1122.8751439981254, -781.120911311707, -1141.9777256744246, -1135.974887062076, -1114.2813326726302, -314.7758319173445, -978.8237351611891, -803.8170192215063, -551.9610771560416, -994.4828255521423, -846.3250909283643, -1102.6456563476988, -871.6820429166912, -246.51091917609943, -445.35002784248724, -1173.528213551692, -1170.5944947444245, -1230.0458297190723, -1060.541701568857, -1051.9867818860955, -674.3273089256968, -431.5576175133271, -668.62624161521, -77.76513631582179, -1248.4095392431466, -602.1606880615374, -474.2817795476478], "episode_lengths": [150, 150, 150, 150, 150, 121, 66, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 81, 150, 150, 130, 150, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 139, 134], "policy_policy_0_reward": [-1215.2721409239425, -791.9151179308881, -1048.73088987411, -784.2016247530404, -808.6694837602, -482.01011911107145, -76.9414856650575, -1136.443888858287, -17.08709262863374, -860.671631607452, -1189.6771984033203, -489.7178256262619, -383.7800045218196, -740.7552512797598, -681.549011445073, -619.2165585562482, -1101.4992864820697, -1072.333707350334, -765.5418237854606, -128.86895551614958, -1141.3093631779377, -522.5318432739148, -707.1564197315784, -415.5779089743951, -353.0153526717266, -598.2400975856673, -652.806618656153, -445.70974583521337, -798.8015030083814, -767.7078123567393, -469.529783930231, -819.0203606189533, -1071.7691372584625, -1109.2433285354705, -722.929670726737, -1030.7892598486712, -1292.6726544640426, -820.7283087487887, -64.66192310722964, -1023.0140240081242, -741.9011423774334, -889.3552380300068, -997.3702416784585, -1096.5129013623032, -934.1108698678942, -635.5904116361036, -703.7946748630069, -257.0882654807173, -808.1216655598432, -785.0506700399374, -531.6386020439605, -904.9833632173081, -650.6327699694316, -821.1494656629606, -818.2718386291787, -142.64855364382342, -900.4897333525633, -482.56174329459225, -747.002774109075, -858.7187602191841, -98.50692921369415, -779.1524084862634, -579.7716595945352, -417.31044539412187, -1199.234507551599, -231.2863002127528, -843.6568667337395, -1207.015854146775, -638.5457141336801, -864.5032816792635, -1229.8771723015934, -789.4329097842882, -294.73427380548407, -1122.8751439981254, -781.120911311707, -1141.9777256744246, -1135.974887062076, -1114.2813326726302, -314.7758319173445, -978.8237351611891, -803.8170192215063, -551.9610771560416, -994.4828255521423, -846.3250909283643, -1102.6456563476988, -871.6820429166912, -246.51091917609943, -445.35002784248724, -1173.528213551692, -1170.5944947444245, -1230.0458297190723, -1060.541701568857, -1051.9867818860955, -674.3273089256968, -431.5576175133271, -668.62624161521, -77.76513631582179, -1248.4095392431466, -602.1606880615374, -474.2817795476478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6022143463405326, "mean_inference_ms": 1.847998414381155, "mean_action_processing_ms": 0.3076676382660111, "mean_env_wait_ms": 3.253896799003386, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012831687927246094, "StateBufferConnector_ms": 0.008176803588867188, "ViewRequirementAgentConnector_ms": 0.20926475524902344}, "num_episodes": 30, "episode_return_max": -17.08709262863374, "episode_return_min": -1292.6726544640426, "episode_return_mean": -754.1854978230423, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.78083246886814, "num_env_steps_trained_throughput_per_sec": 298.78083246886814, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13261.676, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13261.6, "sample_time_ms": 1282.751, "learn_time_ms": 11906.433, "learn_throughput": 335.953, "synch_weights_time_ms": 71.563}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00013", "date": "2024-08-03_04-22-25", "timestamp": 1722639145, "time_this_iter_s": 13.40096926689148, "time_total_s": 146.4812035560608, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c785870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 146.4812035560608, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 47.86315789473684, "ram_util_percent": 49.05789473684211}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 92.08241842389107, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.485785789787769, "policy_loss": -0.009706005247426219, "vf_loss": 5.490745211392641, "vf_explained_var": 0.8970684748142957, "kl": 0.01635873219820498, "entropy": 1.6101922973990441, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -64.66192310722964, "episode_reward_min": -1326.0528687546825, "episode_reward_mean": -768.5612941574171, "episode_len_mean": 140.54, "episode_media": {}, "episodes_timesteps_total": 14054, "policy_reward_min": {"policy_0": -1326.0528687546825}, "policy_reward_max": {"policy_0": -64.66192310722964}, "policy_reward_mean": {"policy_0": -768.5612941574171}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-469.529783930231, -819.0203606189533, -1071.7691372584625, -1109.2433285354705, -722.929670726737, -1030.7892598486712, -1292.6726544640426, -820.7283087487887, -64.66192310722964, -1023.0140240081242, -741.9011423774334, -889.3552380300068, -997.3702416784585, -1096.5129013623032, -934.1108698678942, -635.5904116361036, -703.7946748630069, -257.0882654807173, -808.1216655598432, -785.0506700399374, -531.6386020439605, -904.9833632173081, -650.6327699694316, -821.1494656629606, -818.2718386291787, -142.64855364382342, -900.4897333525633, -482.56174329459225, -747.002774109075, -858.7187602191841, -98.50692921369415, -779.1524084862634, -579.7716595945352, -417.31044539412187, -1199.234507551599, -231.2863002127528, -843.6568667337395, -1207.015854146775, -638.5457141336801, -864.5032816792635, -1229.8771723015934, -789.4329097842882, -294.73427380548407, -1122.8751439981254, -781.120911311707, -1141.9777256744246, -1135.974887062076, -1114.2813326726302, -314.7758319173445, -978.8237351611891, -803.8170192215063, -551.9610771560416, -994.4828255521423, -846.3250909283643, -1102.6456563476988, -871.6820429166912, -246.51091917609943, -445.35002784248724, -1173.528213551692, -1170.5944947444245, -1230.0458297190723, -1060.541701568857, -1051.9867818860955, -674.3273089256968, -431.5576175133271, -668.62624161521, -77.76513631582179, -1248.4095392431466, -602.1606880615374, -474.2817795476478, -783.8824737503282, -891.5662784578839, -139.47632287674463, -739.8877865494237, -187.1779316287122, -665.9159402418546, -893.8142984679106, -575.1360634319213, -762.9437154430261, -621.1576967001491, -625.6893892471517, -1010.6844590273738, -294.3190505619465, -1129.3733166679378, -78.06677706247044, -1070.7130346757235, -1326.0528687546825, -827.1589081602388, -1238.3378454151627, -1095.5022825800115, -867.136472144193, -377.3319029725861, -989.8312477683324, -1149.3820379269812, -488.4194846708087, -159.69117321486385, -413.54522367384317, -887.8748822174272, -1073.8614265184456, -871.3891059802318], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 81, 150, 150, 130, 150, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 139, 134, 150, 150, 85, 150, 80, 150, 150, 150, 150, 150, 150, 150, 132, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150], "policy_policy_0_reward": [-469.529783930231, -819.0203606189533, -1071.7691372584625, -1109.2433285354705, -722.929670726737, -1030.7892598486712, -1292.6726544640426, -820.7283087487887, -64.66192310722964, -1023.0140240081242, -741.9011423774334, -889.3552380300068, -997.3702416784585, -1096.5129013623032, -934.1108698678942, -635.5904116361036, -703.7946748630069, -257.0882654807173, -808.1216655598432, -785.0506700399374, -531.6386020439605, -904.9833632173081, -650.6327699694316, -821.1494656629606, -818.2718386291787, -142.64855364382342, -900.4897333525633, -482.56174329459225, -747.002774109075, -858.7187602191841, -98.50692921369415, -779.1524084862634, -579.7716595945352, -417.31044539412187, -1199.234507551599, -231.2863002127528, -843.6568667337395, -1207.015854146775, -638.5457141336801, -864.5032816792635, -1229.8771723015934, -789.4329097842882, -294.73427380548407, -1122.8751439981254, -781.120911311707, -1141.9777256744246, -1135.974887062076, -1114.2813326726302, -314.7758319173445, -978.8237351611891, -803.8170192215063, -551.9610771560416, -994.4828255521423, -846.3250909283643, -1102.6456563476988, -871.6820429166912, -246.51091917609943, -445.35002784248724, -1173.528213551692, -1170.5944947444245, -1230.0458297190723, -1060.541701568857, -1051.9867818860955, -674.3273089256968, -431.5576175133271, -668.62624161521, -77.76513631582179, -1248.4095392431466, -602.1606880615374, -474.2817795476478, -783.8824737503282, -891.5662784578839, -139.47632287674463, -739.8877865494237, -187.1779316287122, -665.9159402418546, -893.8142984679106, -575.1360634319213, -762.9437154430261, -621.1576967001491, -625.6893892471517, -1010.6844590273738, -294.3190505619465, -1129.3733166679378, -78.06677706247044, -1070.7130346757235, -1326.0528687546825, -827.1589081602388, -1238.3378454151627, -1095.5022825800115, -867.136472144193, -377.3319029725861, -989.8312477683324, -1149.3820379269812, -488.4194846708087, -159.69117321486385, -413.54522367384317, -887.8748822174272, -1073.8614265184456, -871.3891059802318]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5981091836857897, "mean_inference_ms": 1.8377529870174234, "mean_action_processing_ms": 0.3056155852890409, "mean_env_wait_ms": 3.243626634612985, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012609481811523438, "StateBufferConnector_ms": 0.008153438568115234, "ViewRequirementAgentConnector_ms": 0.19477033615112305}, "num_episodes": 30, "episode_return_max": -64.66192310722964, "episode_return_min": -1326.0528687546825, "episode_return_mean": -768.5612941574171, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.04310082495726, "num_env_steps_trained_throughput_per_sec": 301.04310082495726, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13269.179, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13269.101, "sample_time_ms": 1277.485, "learn_time_ms": 11921.75, "learn_throughput": 335.521, "synch_weights_time_ms": 69.02}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00013", "date": "2024-08-03_04-22-38", "timestamp": 1722639158, "time_this_iter_s": 13.299907684326172, "time_total_s": 159.78111124038696, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7aacb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 159.78111124038696, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 23.047368421052635, "ram_util_percent": 49.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 84.74761840105057, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.73123702382048, "policy_loss": -0.011203095845606489, "vf_loss": 5.737623635431131, "vf_explained_var": 0.8958787315835556, "kl": 0.016611329835980845, "entropy": 1.6692116111516953, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -77.76513631582179, "episode_reward_min": -1326.0528687546825, "episode_reward_mean": -780.9724595552673, "episode_len_mean": 140.1, "episode_media": {}, "episodes_timesteps_total": 14010, "policy_reward_min": {"policy_0": -1326.0528687546825}, "policy_reward_max": {"policy_0": -77.76513631582179}, "policy_reward_mean": {"policy_0": -780.9724595552673}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-858.7187602191841, -98.50692921369415, -779.1524084862634, -579.7716595945352, -417.31044539412187, -1199.234507551599, -231.2863002127528, -843.6568667337395, -1207.015854146775, -638.5457141336801, -864.5032816792635, -1229.8771723015934, -789.4329097842882, -294.73427380548407, -1122.8751439981254, -781.120911311707, -1141.9777256744246, -1135.974887062076, -1114.2813326726302, -314.7758319173445, -978.8237351611891, -803.8170192215063, -551.9610771560416, -994.4828255521423, -846.3250909283643, -1102.6456563476988, -871.6820429166912, -246.51091917609943, -445.35002784248724, -1173.528213551692, -1170.5944947444245, -1230.0458297190723, -1060.541701568857, -1051.9867818860955, -674.3273089256968, -431.5576175133271, -668.62624161521, -77.76513631582179, -1248.4095392431466, -602.1606880615374, -474.2817795476478, -783.8824737503282, -891.5662784578839, -139.47632287674463, -739.8877865494237, -187.1779316287122, -665.9159402418546, -893.8142984679106, -575.1360634319213, -762.9437154430261, -621.1576967001491, -625.6893892471517, -1010.6844590273738, -294.3190505619465, -1129.3733166679378, -78.06677706247044, -1070.7130346757235, -1326.0528687546825, -827.1589081602388, -1238.3378454151627, -1095.5022825800115, -867.136472144193, -377.3319029725861, -989.8312477683324, -1149.3820379269812, -488.4194846708087, -159.69117321486385, -413.54522367384317, -887.8748822174272, -1073.8614265184456, -871.3891059802318, -662.8667135897317, -993.4882329397963, -177.04755587015, -1093.6129727730156, -859.9376532822323, -1234.246458341096, -416.67750494864157, -86.92050173346853, -1095.6277937135628, -698.2597575103202, -1289.5895266717562, -739.4087650134447, -397.8917636826446, -294.6020007287033, -1176.3443752459896, -1193.8213782211749, -876.8257854991967, -919.7262547516159, -1114.8165114825183, -848.8236712317619, -242.59845364957116, -898.1508182302206, -871.6320080692011, -1160.7047871031036, -699.3306837577525, -1184.7309350105927, -902.0137558265096, -835.9832843230289, -548.0700126495215], "episode_lengths": [150, 81, 150, 150, 130, 150, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 139, 134, 150, 150, 85, 150, 80, 150, 150, 150, 150, 150, 150, 150, 132, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-858.7187602191841, -98.50692921369415, -779.1524084862634, -579.7716595945352, -417.31044539412187, -1199.234507551599, -231.2863002127528, -843.6568667337395, -1207.015854146775, -638.5457141336801, -864.5032816792635, -1229.8771723015934, -789.4329097842882, -294.73427380548407, -1122.8751439981254, -781.120911311707, -1141.9777256744246, -1135.974887062076, -1114.2813326726302, -314.7758319173445, -978.8237351611891, -803.8170192215063, -551.9610771560416, -994.4828255521423, -846.3250909283643, -1102.6456563476988, -871.6820429166912, -246.51091917609943, -445.35002784248724, -1173.528213551692, -1170.5944947444245, -1230.0458297190723, -1060.541701568857, -1051.9867818860955, -674.3273089256968, -431.5576175133271, -668.62624161521, -77.76513631582179, -1248.4095392431466, -602.1606880615374, -474.2817795476478, -783.8824737503282, -891.5662784578839, -139.47632287674463, -739.8877865494237, -187.1779316287122, -665.9159402418546, -893.8142984679106, -575.1360634319213, -762.9437154430261, -621.1576967001491, -625.6893892471517, -1010.6844590273738, -294.3190505619465, -1129.3733166679378, -78.06677706247044, -1070.7130346757235, -1326.0528687546825, -827.1589081602388, -1238.3378454151627, -1095.5022825800115, -867.136472144193, -377.3319029725861, -989.8312477683324, -1149.3820379269812, -488.4194846708087, -159.69117321486385, -413.54522367384317, -887.8748822174272, -1073.8614265184456, -871.3891059802318, -662.8667135897317, -993.4882329397963, -177.04755587015, -1093.6129727730156, -859.9376532822323, -1234.246458341096, -416.67750494864157, -86.92050173346853, -1095.6277937135628, -698.2597575103202, -1289.5895266717562, -739.4087650134447, -397.8917636826446, -294.6020007287033, -1176.3443752459896, -1193.8213782211749, -876.8257854991967, -919.7262547516159, -1114.8165114825183, -848.8236712317619, -242.59845364957116, -898.1508182302206, -871.6320080692011, -1160.7047871031036, -699.3306837577525, -1184.7309350105927, -902.0137558265096, -835.9832843230289, -548.0700126495215]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5952126325288463, "mean_inference_ms": 1.8297100677986484, "mean_action_processing_ms": 0.303967936814793, "mean_env_wait_ms": 3.2352083049275664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011845111846923828, "StateBufferConnector_ms": 0.008037090301513672, "ViewRequirementAgentConnector_ms": 0.19399571418762207}, "num_episodes": 29, "episode_return_max": -77.76513631582179, "episode_return_min": -1326.0528687546825, "episode_return_mean": -780.9724595552673, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.5211723118556, "num_env_steps_trained_throughput_per_sec": 284.5211723118556, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13308.776, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13308.7, "sample_time_ms": 1277.638, "learn_time_ms": 11962.374, "learn_throughput": 334.382, "synch_weights_time_ms": 67.838}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00013", "date": "2024-08-03_04-22-52", "timestamp": 1722639172, "time_this_iter_s": 14.068742513656616, "time_total_s": 173.84985375404358, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70ad40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 173.84985375404358, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 37.14, "ram_util_percent": 49.11000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 96.5772283732891, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.81221100911498, "policy_loss": -0.011998779860247548, "vf_loss": 4.8193159890671575, "vf_explained_var": 0.9469925597930948, "kl": 0.016818874408727424, "entropy": 1.5183329629401365, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -33.45372536620896, "episode_reward_min": -1326.0528687546825, "episode_reward_mean": -719.6796381454022, "episode_len_mean": 135.22, "episode_media": {}, "episodes_timesteps_total": 13522, "policy_reward_min": {"policy_0": -1326.0528687546825}, "policy_reward_max": {"policy_0": -33.45372536620896}, "policy_reward_mean": {"policy_0": -719.6796381454022}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1230.0458297190723, -1060.541701568857, -1051.9867818860955, -674.3273089256968, -431.5576175133271, -668.62624161521, -77.76513631582179, -1248.4095392431466, -602.1606880615374, -474.2817795476478, -783.8824737503282, -891.5662784578839, -139.47632287674463, -739.8877865494237, -187.1779316287122, -665.9159402418546, -893.8142984679106, -575.1360634319213, -762.9437154430261, -621.1576967001491, -625.6893892471517, -1010.6844590273738, -294.3190505619465, -1129.3733166679378, -78.06677706247044, -1070.7130346757235, -1326.0528687546825, -827.1589081602388, -1238.3378454151627, -1095.5022825800115, -867.136472144193, -377.3319029725861, -989.8312477683324, -1149.3820379269812, -488.4194846708087, -159.69117321486385, -413.54522367384317, -887.8748822174272, -1073.8614265184456, -871.3891059802318, -662.8667135897317, -993.4882329397963, -177.04755587015, -1093.6129727730156, -859.9376532822323, -1234.246458341096, -416.67750494864157, -86.92050173346853, -1095.6277937135628, -698.2597575103202, -1289.5895266717562, -739.4087650134447, -397.8917636826446, -294.6020007287033, -1176.3443752459896, -1193.8213782211749, -876.8257854991967, -919.7262547516159, -1114.8165114825183, -848.8236712317619, -242.59845364957116, -898.1508182302206, -871.6320080692011, -1160.7047871031036, -699.3306837577525, -1184.7309350105927, -902.0137558265096, -835.9832843230289, -548.0700126495215, -113.55447609728928, -76.37424425236566, -702.8353140207146, -620.5953006125569, -986.268191818729, -1064.8774210096976, -285.6004053981179, -1167.3657635161253, -757.5709493854123, -1152.2219604129148, -832.6075465193491, -587.4339512941233, -912.6074242280308, -96.863945806872, -720.652559684533, -659.7143107394193, -67.79104954133456, -386.86642864300023, -186.02592479841485, -942.8399392038019, -583.4253125259866, -33.45372536620896, -762.9818959176421, -927.0615628450963, -465.2348988379572, -1017.5477248212603, -218.7129784757288, -806.7356916548922, -142.75877226478886, -1133.4374678191139, -287.1747399936759], "episode_lengths": [150, 150, 150, 150, 150, 150, 61, 150, 139, 134, 150, 150, 85, 150, 80, 150, 150, 150, 150, 150, 150, 150, 132, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 58, 70, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 69, 150, 150, 73, 150, 98, 150, 150, 47, 150, 150, 150, 150, 72, 150, 82, 150, 92], "policy_policy_0_reward": [-1230.0458297190723, -1060.541701568857, -1051.9867818860955, -674.3273089256968, -431.5576175133271, -668.62624161521, -77.76513631582179, -1248.4095392431466, -602.1606880615374, -474.2817795476478, -783.8824737503282, -891.5662784578839, -139.47632287674463, -739.8877865494237, -187.1779316287122, -665.9159402418546, -893.8142984679106, -575.1360634319213, -762.9437154430261, -621.1576967001491, -625.6893892471517, -1010.6844590273738, -294.3190505619465, -1129.3733166679378, -78.06677706247044, -1070.7130346757235, -1326.0528687546825, -827.1589081602388, -1238.3378454151627, -1095.5022825800115, -867.136472144193, -377.3319029725861, -989.8312477683324, -1149.3820379269812, -488.4194846708087, -159.69117321486385, -413.54522367384317, -887.8748822174272, -1073.8614265184456, -871.3891059802318, -662.8667135897317, -993.4882329397963, -177.04755587015, -1093.6129727730156, -859.9376532822323, -1234.246458341096, -416.67750494864157, -86.92050173346853, -1095.6277937135628, -698.2597575103202, -1289.5895266717562, -739.4087650134447, -397.8917636826446, -294.6020007287033, -1176.3443752459896, -1193.8213782211749, -876.8257854991967, -919.7262547516159, -1114.8165114825183, -848.8236712317619, -242.59845364957116, -898.1508182302206, -871.6320080692011, -1160.7047871031036, -699.3306837577525, -1184.7309350105927, -902.0137558265096, -835.9832843230289, -548.0700126495215, -113.55447609728928, -76.37424425236566, -702.8353140207146, -620.5953006125569, -986.268191818729, -1064.8774210096976, -285.6004053981179, -1167.3657635161253, -757.5709493854123, -1152.2219604129148, -832.6075465193491, -587.4339512941233, -912.6074242280308, -96.863945806872, -720.652559684533, -659.7143107394193, -67.79104954133456, -386.86642864300023, -186.02592479841485, -942.8399392038019, -583.4253125259866, -33.45372536620896, -762.9818959176421, -927.0615628450963, -465.2348988379572, -1017.5477248212603, -218.7129784757288, -806.7356916548922, -142.75877226478886, -1133.4374678191139, -287.1747399936759]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5925769980043654, "mean_inference_ms": 1.8199113427304063, "mean_action_processing_ms": 0.30217322645742517, "mean_env_wait_ms": 3.22182999464163, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012040376663208008, "StateBufferConnector_ms": 0.007837295532226562, "ViewRequirementAgentConnector_ms": 0.19786763191223145}, "num_episodes": 31, "episode_return_max": -33.45372536620896, "episode_return_min": -1326.0528687546825, "episode_return_mean": -719.6796381454022, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 334.9384030313801, "num_env_steps_trained_throughput_per_sec": 334.9384030313801, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 13356.586, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13356.509, "sample_time_ms": 1276.239, "learn_time_ms": 12010.521, "learn_throughput": 333.041, "synch_weights_time_ms": 68.882}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00013", "date": "2024-08-03_04-23-04", "timestamp": 1722639184, "time_this_iter_s": 11.95616888999939, "time_total_s": 185.80602264404297, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad3d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 185.80602264404297, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 24.264705882352946, "ram_util_percent": 49.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 114.7302113155524, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.0665480718016624, "policy_loss": -0.008413848688845368, "vf_loss": 5.070734393348297, "vf_explained_var": 0.9391974460333585, "kl": 0.014674303436792517, "entropy": 1.7479021289696297, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -33.45372536620896, "episode_reward_min": -1326.0528687546825, "episode_reward_mean": -758.6745206509466, "episode_len_mean": 137.47, "episode_media": {}, "episodes_timesteps_total": 13747, "policy_reward_min": {"policy_0": -1326.0528687546825}, "policy_reward_max": {"policy_0": -33.45372536620896}, "policy_reward_mean": {"policy_0": -758.6745206509466}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1326.0528687546825, -827.1589081602388, -1238.3378454151627, -1095.5022825800115, -867.136472144193, -377.3319029725861, -989.8312477683324, -1149.3820379269812, -488.4194846708087, -159.69117321486385, -413.54522367384317, -887.8748822174272, -1073.8614265184456, -871.3891059802318, -662.8667135897317, -993.4882329397963, -177.04755587015, -1093.6129727730156, -859.9376532822323, -1234.246458341096, -416.67750494864157, -86.92050173346853, -1095.6277937135628, -698.2597575103202, -1289.5895266717562, -739.4087650134447, -397.8917636826446, -294.6020007287033, -1176.3443752459896, -1193.8213782211749, -876.8257854991967, -919.7262547516159, -1114.8165114825183, -848.8236712317619, -242.59845364957116, -898.1508182302206, -871.6320080692011, -1160.7047871031036, -699.3306837577525, -1184.7309350105927, -902.0137558265096, -835.9832843230289, -548.0700126495215, -113.55447609728928, -76.37424425236566, -702.8353140207146, -620.5953006125569, -986.268191818729, -1064.8774210096976, -285.6004053981179, -1167.3657635161253, -757.5709493854123, -1152.2219604129148, -832.6075465193491, -587.4339512941233, -912.6074242280308, -96.863945806872, -720.652559684533, -659.7143107394193, -67.79104954133456, -386.86642864300023, -186.02592479841485, -942.8399392038019, -583.4253125259866, -33.45372536620896, -762.9818959176421, -927.0615628450963, -465.2348988379572, -1017.5477248212603, -218.7129784757288, -806.7356916548922, -142.75877226478886, -1133.4374678191139, -287.1747399936759, -834.4228221655318, -1041.8990351151824, -1298.0909799614394, -1159.8330841333977, -426.4587450500566, -1234.4201605876785, -1003.2820247343774, -433.2717856335567, -1278.0428010690819, -1279.1899335396163, -434.92517800135187, -904.157416851907, -988.5103051605015, -808.0290776806535, -540.5183636654459, -1060.726351768059, -872.4913094219696, -531.2377688561616, -777.0727032080099, -1071.9136805799444, -754.9361925593159, -510.0664083131089, -895.0229695087133, -107.63965989045336, -1168.231169888643, -474.60548239721174], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 58, 70, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 69, 150, 150, 73, 150, 98, 150, 150, 47, 150, 150, 150, 150, 72, 150, 82, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 49, 150, 150], "policy_policy_0_reward": [-1326.0528687546825, -827.1589081602388, -1238.3378454151627, -1095.5022825800115, -867.136472144193, -377.3319029725861, -989.8312477683324, -1149.3820379269812, -488.4194846708087, -159.69117321486385, -413.54522367384317, -887.8748822174272, -1073.8614265184456, -871.3891059802318, -662.8667135897317, -993.4882329397963, -177.04755587015, -1093.6129727730156, -859.9376532822323, -1234.246458341096, -416.67750494864157, -86.92050173346853, -1095.6277937135628, -698.2597575103202, -1289.5895266717562, -739.4087650134447, -397.8917636826446, -294.6020007287033, -1176.3443752459896, -1193.8213782211749, -876.8257854991967, -919.7262547516159, -1114.8165114825183, -848.8236712317619, -242.59845364957116, -898.1508182302206, -871.6320080692011, -1160.7047871031036, -699.3306837577525, -1184.7309350105927, -902.0137558265096, -835.9832843230289, -548.0700126495215, -113.55447609728928, -76.37424425236566, -702.8353140207146, -620.5953006125569, -986.268191818729, -1064.8774210096976, -285.6004053981179, -1167.3657635161253, -757.5709493854123, -1152.2219604129148, -832.6075465193491, -587.4339512941233, -912.6074242280308, -96.863945806872, -720.652559684533, -659.7143107394193, -67.79104954133456, -386.86642864300023, -186.02592479841485, -942.8399392038019, -583.4253125259866, -33.45372536620896, -762.9818959176421, -927.0615628450963, -465.2348988379572, -1017.5477248212603, -218.7129784757288, -806.7356916548922, -142.75877226478886, -1133.4374678191139, -287.1747399936759, -834.4228221655318, -1041.8990351151824, -1298.0909799614394, -1159.8330841333977, -426.4587450500566, -1234.4201605876785, -1003.2820247343774, -433.2717856335567, -1278.0428010690819, -1279.1899335396163, -434.92517800135187, -904.157416851907, -988.5103051605015, -808.0290776806535, -540.5183636654459, -1060.726351768059, -872.4913094219696, -531.2377688561616, -777.0727032080099, -1071.9136805799444, -754.9361925593159, -510.0664083131089, -895.0229695087133, -107.63965989045336, -1168.231169888643, -474.60548239721174]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5914061179491797, "mean_inference_ms": 1.8155109666626967, "mean_action_processing_ms": 0.3009364228249565, "mean_env_wait_ms": 3.2217728823219254, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012216329574584961, "StateBufferConnector_ms": 0.007993221282958984, "ViewRequirementAgentConnector_ms": 0.20913457870483398}, "num_episodes": 26, "episode_return_max": -33.45372536620896, "episode_return_min": -1326.0528687546825, "episode_return_mean": -758.6745206509466, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 289.9922453092971, "num_env_steps_trained_throughput_per_sec": 289.9922453092971, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 13429.976, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13429.897, "sample_time_ms": 1276.436, "learn_time_ms": 12078.121, "learn_throughput": 331.177, "synch_weights_time_ms": 74.422}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00013", "date": "2024-08-03_04-23-18", "timestamp": 1722639198, "time_this_iter_s": 13.817177057266235, "time_total_s": 199.6231997013092, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7875b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 199.6231997013092, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 24.3, "ram_util_percent": 49.20000000000001}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 131.48786641955377, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.737668007115523, "policy_loss": -0.008946538456560424, "vf_loss": 4.743058700362841, "vf_explained_var": 0.9460607882589102, "kl": 0.01236624019414499, "entropy": 1.5402104229976734, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -33.45372536620896, "episode_reward_min": -1332.6267507727412, "episode_reward_mean": -746.4090932788538, "episode_len_mean": 138.67, "episode_media": {}, "episodes_timesteps_total": 13867, "policy_reward_min": {"policy_0": -1332.6267507727412}, "policy_reward_max": {"policy_0": -33.45372536620896}, "policy_reward_mean": {"policy_0": -746.4090932788538}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-876.8257854991967, -919.7262547516159, -1114.8165114825183, -848.8236712317619, -242.59845364957116, -898.1508182302206, -871.6320080692011, -1160.7047871031036, -699.3306837577525, -1184.7309350105927, -902.0137558265096, -835.9832843230289, -548.0700126495215, -113.55447609728928, -76.37424425236566, -702.8353140207146, -620.5953006125569, -986.268191818729, -1064.8774210096976, -285.6004053981179, -1167.3657635161253, -757.5709493854123, -1152.2219604129148, -832.6075465193491, -587.4339512941233, -912.6074242280308, -96.863945806872, -720.652559684533, -659.7143107394193, -67.79104954133456, -386.86642864300023, -186.02592479841485, -942.8399392038019, -583.4253125259866, -33.45372536620896, -762.9818959176421, -927.0615628450963, -465.2348988379572, -1017.5477248212603, -218.7129784757288, -806.7356916548922, -142.75877226478886, -1133.4374678191139, -287.1747399936759, -834.4228221655318, -1041.8990351151824, -1298.0909799614394, -1159.8330841333977, -426.4587450500566, -1234.4201605876785, -1003.2820247343774, -433.2717856335567, -1278.0428010690819, -1279.1899335396163, -434.92517800135187, -904.157416851907, -988.5103051605015, -808.0290776806535, -540.5183636654459, -1060.726351768059, -872.4913094219696, -531.2377688561616, -777.0727032080099, -1071.9136805799444, -754.9361925593159, -510.0664083131089, -895.0229695087133, -107.63965989045336, -1168.231169888643, -474.60548239721174, -593.8127845135745, -563.3853923280875, -834.2554828929942, -669.1243093582908, -525.5179246777939, -913.8000952833903, -1332.6267507727412, -1146.0918725269787, -535.6074870192047, -815.3569531706266, -1318.6943545512563, -591.1702307198588, -817.7428412125611, -729.5157734322491, -673.018440524875, -770.0833819431804, -1125.0774169347553, -256.81370992932324, -388.6304051364857, -830.1154466707129, -604.2587260435125, -41.765126638908406, -95.49579805120923, -800.9078381967843, -1150.2682351369278, -938.6896196878282, -902.6889467781214, -685.6591010900539, -1245.9501545503442, -1053.1904792816351], "episode_lengths": [150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 58, 70, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 69, 150, 150, 73, 150, 98, 150, 150, 47, 150, 150, 150, 150, 72, 150, 82, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 49, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 53, 75, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-876.8257854991967, -919.7262547516159, -1114.8165114825183, -848.8236712317619, -242.59845364957116, -898.1508182302206, -871.6320080692011, -1160.7047871031036, -699.3306837577525, -1184.7309350105927, -902.0137558265096, -835.9832843230289, -548.0700126495215, -113.55447609728928, -76.37424425236566, -702.8353140207146, -620.5953006125569, -986.268191818729, -1064.8774210096976, -285.6004053981179, -1167.3657635161253, -757.5709493854123, -1152.2219604129148, -832.6075465193491, -587.4339512941233, -912.6074242280308, -96.863945806872, -720.652559684533, -659.7143107394193, -67.79104954133456, -386.86642864300023, -186.02592479841485, -942.8399392038019, -583.4253125259866, -33.45372536620896, -762.9818959176421, -927.0615628450963, -465.2348988379572, -1017.5477248212603, -218.7129784757288, -806.7356916548922, -142.75877226478886, -1133.4374678191139, -287.1747399936759, -834.4228221655318, -1041.8990351151824, -1298.0909799614394, -1159.8330841333977, -426.4587450500566, -1234.4201605876785, -1003.2820247343774, -433.2717856335567, -1278.0428010690819, -1279.1899335396163, -434.92517800135187, -904.157416851907, -988.5103051605015, -808.0290776806535, -540.5183636654459, -1060.726351768059, -872.4913094219696, -531.2377688561616, -777.0727032080099, -1071.9136805799444, -754.9361925593159, -510.0664083131089, -895.0229695087133, -107.63965989045336, -1168.231169888643, -474.60548239721174, -593.8127845135745, -563.3853923280875, -834.2554828929942, -669.1243093582908, -525.5179246777939, -913.8000952833903, -1332.6267507727412, -1146.0918725269787, -535.6074870192047, -815.3569531706266, -1318.6943545512563, -591.1702307198588, -817.7428412125611, -729.5157734322491, -673.018440524875, -770.0833819431804, -1125.0774169347553, -256.81370992932324, -388.6304051364857, -830.1154466707129, -604.2587260435125, -41.765126638908406, -95.49579805120923, -800.9078381967843, -1150.2682351369278, -938.6896196878282, -902.6889467781214, -685.6591010900539, -1245.9501545503442, -1053.1904792816351]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.602161471878977, "mean_inference_ms": 1.8566561768970218, "mean_action_processing_ms": 0.3079307135232302, "mean_env_wait_ms": 3.2873951810965947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.02434062957763672, "StateBufferConnector_ms": 0.008720874786376953, "ViewRequirementAgentConnector_ms": 0.3362548351287842}, "num_episodes": 30, "episode_return_max": -33.45372536620896, "episode_return_min": -1332.6267507727412, "episode_return_mean": -746.4090932788538, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.0233765714538, "num_env_steps_trained_throughput_per_sec": 267.0233765714538, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13599.073, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13598.992, "sample_time_ms": 1419.031, "learn_time_ms": 12103.917, "learn_throughput": 330.472, "synch_weights_time_ms": 75.134}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00013", "date": "2024-08-03_04-23-33", "timestamp": 1722639213, "time_this_iter_s": 14.992372989654541, "time_total_s": 214.61557269096375, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7a92d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 214.61557269096375, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 32.1, "ram_util_percent": 49.3047619047619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 155.59016656279564, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.465089611212412, "policy_loss": -0.0036463419625457996, "vf_loss": 4.464739595601956, "vf_explained_var": 0.9551148276776076, "kl": 0.013734161718214939, "entropy": 1.2388085501889388, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -33.01912543552965, "episode_reward_min": -1332.6267507727412, "episode_reward_mean": -688.6356456563942, "episode_len_mean": 133.58, "episode_media": {}, "episodes_timesteps_total": 13358, "policy_reward_min": {"policy_0": -1332.6267507727412}, "policy_reward_max": {"policy_0": -33.01912543552965}, "policy_reward_mean": {"policy_0": -688.6356456563942}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-33.45372536620896, -762.9818959176421, -927.0615628450963, -465.2348988379572, -1017.5477248212603, -218.7129784757288, -806.7356916548922, -142.75877226478886, -1133.4374678191139, -287.1747399936759, -834.4228221655318, -1041.8990351151824, -1298.0909799614394, -1159.8330841333977, -426.4587450500566, -1234.4201605876785, -1003.2820247343774, -433.2717856335567, -1278.0428010690819, -1279.1899335396163, -434.92517800135187, -904.157416851907, -988.5103051605015, -808.0290776806535, -540.5183636654459, -1060.726351768059, -872.4913094219696, -531.2377688561616, -777.0727032080099, -1071.9136805799444, -754.9361925593159, -510.0664083131089, -895.0229695087133, -107.63965989045336, -1168.231169888643, -474.60548239721174, -593.8127845135745, -563.3853923280875, -834.2554828929942, -669.1243093582908, -525.5179246777939, -913.8000952833903, -1332.6267507727412, -1146.0918725269787, -535.6074870192047, -815.3569531706266, -1318.6943545512563, -591.1702307198588, -817.7428412125611, -729.5157734322491, -673.018440524875, -770.0833819431804, -1125.0774169347553, -256.81370992932324, -388.6304051364857, -830.1154466707129, -604.2587260435125, -41.765126638908406, -95.49579805120923, -800.9078381967843, -1150.2682351369278, -938.6896196878282, -902.6889467781214, -685.6591010900539, -1245.9501545503442, -1053.1904792816351, -950.9256618476094, -695.0315232442841, -697.414602912114, -555.0722974341843, -850.0586213657829, -979.9277105521043, -589.3921352807434, -621.2590259999783, -86.78633730869612, -749.2423044684429, -882.8703299485413, -362.8168013159683, -395.1792631318002, -386.2057648061793, -252.31164021075324, -34.37603167722968, -846.5405576842718, -1087.9074286169769, -1031.3219643926457, -74.57190555008333, -873.6561480043673, -84.22244411827609, -35.7997471078994, -516.4794037576942, -1088.8024607322307, -786.2536563538608, -418.39379987726585, -229.14824005445834, -33.01912543552965, -140.26052646706324, -144.3437721048757, -147.30073184153878, -631.4941664694059, -971.7684887745833], "episode_lengths": [47, 150, 150, 150, 150, 72, 150, 82, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 49, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 53, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 124, 150, 150, 150, 134, 67, 150, 150, 150, 117, 150, 86, 49, 150, 150, 150, 77, 150, 64, 45, 150, 150, 150, 136, 90, 53, 66, 54, 91, 150, 150], "policy_policy_0_reward": [-33.45372536620896, -762.9818959176421, -927.0615628450963, -465.2348988379572, -1017.5477248212603, -218.7129784757288, -806.7356916548922, -142.75877226478886, -1133.4374678191139, -287.1747399936759, -834.4228221655318, -1041.8990351151824, -1298.0909799614394, -1159.8330841333977, -426.4587450500566, -1234.4201605876785, -1003.2820247343774, -433.2717856335567, -1278.0428010690819, -1279.1899335396163, -434.92517800135187, -904.157416851907, -988.5103051605015, -808.0290776806535, -540.5183636654459, -1060.726351768059, -872.4913094219696, -531.2377688561616, -777.0727032080099, -1071.9136805799444, -754.9361925593159, -510.0664083131089, -895.0229695087133, -107.63965989045336, -1168.231169888643, -474.60548239721174, -593.8127845135745, -563.3853923280875, -834.2554828929942, -669.1243093582908, -525.5179246777939, -913.8000952833903, -1332.6267507727412, -1146.0918725269787, -535.6074870192047, -815.3569531706266, -1318.6943545512563, -591.1702307198588, -817.7428412125611, -729.5157734322491, -673.018440524875, -770.0833819431804, -1125.0774169347553, -256.81370992932324, -388.6304051364857, -830.1154466707129, -604.2587260435125, -41.765126638908406, -95.49579805120923, -800.9078381967843, -1150.2682351369278, -938.6896196878282, -902.6889467781214, -685.6591010900539, -1245.9501545503442, -1053.1904792816351, -950.9256618476094, -695.0315232442841, -697.414602912114, -555.0722974341843, -850.0586213657829, -979.9277105521043, -589.3921352807434, -621.2590259999783, -86.78633730869612, -749.2423044684429, -882.8703299485413, -362.8168013159683, -395.1792631318002, -386.2057648061793, -252.31164021075324, -34.37603167722968, -846.5405576842718, -1087.9074286169769, -1031.3219643926457, -74.57190555008333, -873.6561480043673, -84.22244411827609, -35.7997471078994, -516.4794037576942, -1088.8024607322307, -786.2536563538608, -418.39379987726585, -229.14824005445834, -33.01912543552965, -140.26052646706324, -144.3437721048757, -147.30073184153878, -631.4941664694059, -971.7684887745833]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6149621338530464, "mean_inference_ms": 1.9008859843729147, "mean_action_processing_ms": 0.31640493343335213, "mean_env_wait_ms": 3.3589263764080783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.024319887161254883, "StateBufferConnector_ms": 0.008855342864990234, "ViewRequirementAgentConnector_ms": 0.33876585960388184}, "num_episodes": 34, "episode_return_max": -33.01912543552965, "episode_return_min": -1332.6267507727412, "episode_return_mean": -688.6356456563942, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.75324479299525, "num_env_steps_trained_throughput_per_sec": 300.75324479299525, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13499.999, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13499.918, "sample_time_ms": 1351.327, "learn_time_ms": 12074.763, "learn_throughput": 331.269, "synch_weights_time_ms": 72.91}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00013", "date": "2024-08-03_04-23-46", "timestamp": 1722639226, "time_this_iter_s": 13.31067180633545, "time_total_s": 227.9262444972992, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7ab640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 227.9262444972992, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 22.821052631578947, "ram_util_percent": 49.29999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 127.09930070638657, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.06440057232976, "policy_loss": -0.01085990504846753, "vf_loss": 5.069673933337132, "vf_explained_var": 0.9479179179916779, "kl": 0.019037124783790226, "entropy": 1.2458846465374032, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -33.01912543552965, "episode_reward_min": -1364.457897084577, "episode_reward_mean": -657.2738043852487, "episode_len_mean": 130.96, "episode_media": {}, "episodes_timesteps_total": 13096, "policy_reward_min": {"policy_0": -1364.457897084577}, "policy_reward_max": {"policy_0": -33.01912543552965}, "policy_reward_mean": {"policy_0": -657.2738043852487}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-510.0664083131089, -895.0229695087133, -107.63965989045336, -1168.231169888643, -474.60548239721174, -593.8127845135745, -563.3853923280875, -834.2554828929942, -669.1243093582908, -525.5179246777939, -913.8000952833903, -1332.6267507727412, -1146.0918725269787, -535.6074870192047, -815.3569531706266, -1318.6943545512563, -591.1702307198588, -817.7428412125611, -729.5157734322491, -673.018440524875, -770.0833819431804, -1125.0774169347553, -256.81370992932324, -388.6304051364857, -830.1154466707129, -604.2587260435125, -41.765126638908406, -95.49579805120923, -800.9078381967843, -1150.2682351369278, -938.6896196878282, -902.6889467781214, -685.6591010900539, -1245.9501545503442, -1053.1904792816351, -950.9256618476094, -695.0315232442841, -697.414602912114, -555.0722974341843, -850.0586213657829, -979.9277105521043, -589.3921352807434, -621.2590259999783, -86.78633730869612, -749.2423044684429, -882.8703299485413, -362.8168013159683, -395.1792631318002, -386.2057648061793, -252.31164021075324, -34.37603167722968, -846.5405576842718, -1087.9074286169769, -1031.3219643926457, -74.57190555008333, -873.6561480043673, -84.22244411827609, -35.7997471078994, -516.4794037576942, -1088.8024607322307, -786.2536563538608, -418.39379987726585, -229.14824005445834, -33.01912543552965, -140.26052646706324, -144.3437721048757, -147.30073184153878, -631.4941664694059, -971.7684887745833, -105.54755752687065, -176.74976722502237, -840.3377669375925, -739.902637684506, -895.3336412757182, -818.3112781327884, -1065.8220593435465, -698.6848124170739, -61.03144972285992, -920.9093509330137, -610.4629279965457, -785.4654984650423, -1364.457897084577, -442.67536484084314, -260.7685813519382, -432.37523584909644, -1031.7647888624865, -960.6276360791402, -605.5131702798619, -165.92371712332357, -1242.851777405622, -338.3647999469544, -823.0946313939071, -675.0422099439627, -803.7973655171876, -321.0749880027326, -923.6218742525731, -984.2596947469691, -156.9625481341984, -842.6091068993269, -1298.0009152497485], "episode_lengths": [138, 150, 49, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 53, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 124, 150, 150, 150, 134, 67, 150, 150, 150, 117, 150, 86, 49, 150, 150, 150, 77, 150, 64, 45, 150, 150, 150, 136, 90, 53, 66, 54, 91, 150, 150, 64, 72, 150, 143, 150, 150, 150, 150, 48, 150, 150, 150, 150, 113, 89, 150, 150, 150, 150, 61, 150, 106, 150, 150, 150, 123, 150, 150, 94, 150, 150], "policy_policy_0_reward": [-510.0664083131089, -895.0229695087133, -107.63965989045336, -1168.231169888643, -474.60548239721174, -593.8127845135745, -563.3853923280875, -834.2554828929942, -669.1243093582908, -525.5179246777939, -913.8000952833903, -1332.6267507727412, -1146.0918725269787, -535.6074870192047, -815.3569531706266, -1318.6943545512563, -591.1702307198588, -817.7428412125611, -729.5157734322491, -673.018440524875, -770.0833819431804, -1125.0774169347553, -256.81370992932324, -388.6304051364857, -830.1154466707129, -604.2587260435125, -41.765126638908406, -95.49579805120923, -800.9078381967843, -1150.2682351369278, -938.6896196878282, -902.6889467781214, -685.6591010900539, -1245.9501545503442, -1053.1904792816351, -950.9256618476094, -695.0315232442841, -697.414602912114, -555.0722974341843, -850.0586213657829, -979.9277105521043, -589.3921352807434, -621.2590259999783, -86.78633730869612, -749.2423044684429, -882.8703299485413, -362.8168013159683, -395.1792631318002, -386.2057648061793, -252.31164021075324, -34.37603167722968, -846.5405576842718, -1087.9074286169769, -1031.3219643926457, -74.57190555008333, -873.6561480043673, -84.22244411827609, -35.7997471078994, -516.4794037576942, -1088.8024607322307, -786.2536563538608, -418.39379987726585, -229.14824005445834, -33.01912543552965, -140.26052646706324, -144.3437721048757, -147.30073184153878, -631.4941664694059, -971.7684887745833, -105.54755752687065, -176.74976722502237, -840.3377669375925, -739.902637684506, -895.3336412757182, -818.3112781327884, -1065.8220593435465, -698.6848124170739, -61.03144972285992, -920.9093509330137, -610.4629279965457, -785.4654984650423, -1364.457897084577, -442.67536484084314, -260.7685813519382, -432.37523584909644, -1031.7647888624865, -960.6276360791402, -605.5131702798619, -165.92371712332357, -1242.851777405622, -338.3647999469544, -823.0946313939071, -675.0422099439627, -803.7973655171876, -321.0749880027326, -923.6218742525731, -984.2596947469691, -156.9625481341984, -842.6091068993269, -1298.0009152497485]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6338417770280536, "mean_inference_ms": 1.9626038445844092, "mean_action_processing_ms": 0.32751971528848073, "mean_env_wait_ms": 3.4558664526205383, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.04195427894592285, "StateBufferConnector_ms": 0.01953911781311035, "ViewRequirementAgentConnector_ms": 0.3851661682128906}, "num_episodes": 31, "episode_return_max": -33.01912543552965, "episode_return_min": -1364.457897084577, "episode_return_mean": -657.2738043852487, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.12181323698223, "num_env_steps_trained_throughput_per_sec": 281.12181323698223, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13575.553, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13575.473, "sample_time_ms": 1468.722, "learn_time_ms": 12032.385, "learn_throughput": 332.436, "synch_weights_time_ms": 73.494}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00013", "date": "2024-08-03_04-24-01", "timestamp": 1722639241, "time_this_iter_s": 14.242784261703491, "time_total_s": 242.16902875900269, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7abe20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 242.16902875900269, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 44.42857142857143, "ram_util_percent": 49.3047619047619}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.90571753382682, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.110090300316612, "policy_loss": -0.013030420852495202, "vf_loss": 4.118161656955878, "vf_explained_var": 0.9835963330542048, "kl": 0.016996637729607755, "entropy": 1.3992619901895522, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -20.399086755275935, "episode_reward_min": -1364.457897084577, "episode_reward_mean": -643.2877727552419, "episode_len_mean": 129.23, "episode_media": {}, "episodes_timesteps_total": 12923, "policy_reward_min": {"policy_0": -1364.457897084577}, "policy_reward_max": {"policy_0": -20.399086755275935}, "policy_reward_mean": {"policy_0": -643.2877727552419}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-938.6896196878282, -902.6889467781214, -685.6591010900539, -1245.9501545503442, -1053.1904792816351, -950.9256618476094, -695.0315232442841, -697.414602912114, -555.0722974341843, -850.0586213657829, -979.9277105521043, -589.3921352807434, -621.2590259999783, -86.78633730869612, -749.2423044684429, -882.8703299485413, -362.8168013159683, -395.1792631318002, -386.2057648061793, -252.31164021075324, -34.37603167722968, -846.5405576842718, -1087.9074286169769, -1031.3219643926457, -74.57190555008333, -873.6561480043673, -84.22244411827609, -35.7997471078994, -516.4794037576942, -1088.8024607322307, -786.2536563538608, -418.39379987726585, -229.14824005445834, -33.01912543552965, -140.26052646706324, -144.3437721048757, -147.30073184153878, -631.4941664694059, -971.7684887745833, -105.54755752687065, -176.74976722502237, -840.3377669375925, -739.902637684506, -895.3336412757182, -818.3112781327884, -1065.8220593435465, -698.6848124170739, -61.03144972285992, -920.9093509330137, -610.4629279965457, -785.4654984650423, -1364.457897084577, -442.67536484084314, -260.7685813519382, -432.37523584909644, -1031.7647888624865, -960.6276360791402, -605.5131702798619, -165.92371712332357, -1242.851777405622, -338.3647999469544, -823.0946313939071, -675.0422099439627, -803.7973655171876, -321.0749880027326, -923.6218742525731, -984.2596947469691, -156.9625481341984, -842.6091068993269, -1298.0009152497485, -894.3076190454298, -100.87910380987776, -110.29990306164633, -388.8391327493859, -982.1288347807389, -256.7997555318024, -93.73298394485153, -748.3291776943918, -65.17259784218601, -901.1893995842386, -429.01913260755333, -850.9097780215606, -808.0350867976116, -864.9464503887298, -848.6350659209878, -1260.5011460731946, -678.0642440327687, -940.9039556588245, -936.5975451434031, -762.3209537217989, -950.0488947399199, -724.3558557607245, -20.399086755275935, -638.5660355723767, -612.623017595521, -1148.523792426204, -1173.649016572768, -878.9009461887723, -106.70871910602469, -704.7120735351821], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 138, 124, 150, 150, 150, 134, 67, 150, 150, 150, 117, 150, 86, 49, 150, 150, 150, 77, 150, 64, 45, 150, 150, 150, 136, 90, 53, 66, 54, 91, 150, 150, 64, 72, 150, 143, 150, 150, 150, 150, 48, 150, 150, 150, 150, 113, 89, 150, 150, 150, 150, 61, 150, 106, 150, 150, 150, 123, 150, 150, 94, 150, 150, 150, 72, 70, 150, 150, 150, 81, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 79, 150], "policy_policy_0_reward": [-938.6896196878282, -902.6889467781214, -685.6591010900539, -1245.9501545503442, -1053.1904792816351, -950.9256618476094, -695.0315232442841, -697.414602912114, -555.0722974341843, -850.0586213657829, -979.9277105521043, -589.3921352807434, -621.2590259999783, -86.78633730869612, -749.2423044684429, -882.8703299485413, -362.8168013159683, -395.1792631318002, -386.2057648061793, -252.31164021075324, -34.37603167722968, -846.5405576842718, -1087.9074286169769, -1031.3219643926457, -74.57190555008333, -873.6561480043673, -84.22244411827609, -35.7997471078994, -516.4794037576942, -1088.8024607322307, -786.2536563538608, -418.39379987726585, -229.14824005445834, -33.01912543552965, -140.26052646706324, -144.3437721048757, -147.30073184153878, -631.4941664694059, -971.7684887745833, -105.54755752687065, -176.74976722502237, -840.3377669375925, -739.902637684506, -895.3336412757182, -818.3112781327884, -1065.8220593435465, -698.6848124170739, -61.03144972285992, -920.9093509330137, -610.4629279965457, -785.4654984650423, -1364.457897084577, -442.67536484084314, -260.7685813519382, -432.37523584909644, -1031.7647888624865, -960.6276360791402, -605.5131702798619, -165.92371712332357, -1242.851777405622, -338.3647999469544, -823.0946313939071, -675.0422099439627, -803.7973655171876, -321.0749880027326, -923.6218742525731, -984.2596947469691, -156.9625481341984, -842.6091068993269, -1298.0009152497485, -894.3076190454298, -100.87910380987776, -110.29990306164633, -388.8391327493859, -982.1288347807389, -256.7997555318024, -93.73298394485153, -748.3291776943918, -65.17259784218601, -901.1893995842386, -429.01913260755333, -850.9097780215606, -808.0350867976116, -864.9464503887298, -848.6350659209878, -1260.5011460731946, -678.0642440327687, -940.9039556588245, -936.5975451434031, -762.3209537217989, -950.0488947399199, -724.3558557607245, -20.399086755275935, -638.5660355723767, -612.623017595521, -1148.523792426204, -1173.649016572768, -878.9009461887723, -106.70871910602469, -704.7120735351821]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6399238652523901, "mean_inference_ms": 1.9798486376635926, "mean_action_processing_ms": 0.3307389886034594, "mean_env_wait_ms": 3.4852875757591626, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029973983764648438, "StateBufferConnector_ms": 0.01893782615661621, "ViewRequirementAgentConnector_ms": 0.2779216766357422}, "num_episodes": 30, "episode_return_max": -20.399086755275935, "episode_return_min": -1364.457897084577, "episode_return_mean": -643.2877727552419, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.2034396146213, "num_env_steps_trained_throughput_per_sec": 328.2034396146213, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13492.424, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13492.343, "sample_time_ms": 1474.065, "learn_time_ms": 11943.516, "learn_throughput": 334.91, "synch_weights_time_ms": 73.878}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00013", "date": "2024-08-03_04-24-13", "timestamp": 1722639253, "time_this_iter_s": 12.200215101242065, "time_total_s": 254.36924386024475, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7a9ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 254.36924386024475, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 23.511764705882353, "ram_util_percent": 49.3}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 163.16308131019275, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.082105329136054, "policy_loss": -0.011554907823059088, "vf_loss": 4.088493852814039, "vf_explained_var": 0.966185957317551, "kl": 0.017720997465403343, "entropy": 1.4991252000133197, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -3.276501281255425, "episode_reward_min": -1364.457897084577, "episode_reward_mean": -675.4491328186294, "episode_len_mean": 131.72, "episode_media": {}, "episodes_timesteps_total": 13172, "policy_reward_min": {"policy_0": -1364.457897084577}, "policy_reward_max": {"policy_0": -3.276501281255425}, "policy_reward_mean": {"policy_0": -675.4491328186294}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-516.4794037576942, -1088.8024607322307, -786.2536563538608, -418.39379987726585, -229.14824005445834, -33.01912543552965, -140.26052646706324, -144.3437721048757, -147.30073184153878, -631.4941664694059, -971.7684887745833, -105.54755752687065, -176.74976722502237, -840.3377669375925, -739.902637684506, -895.3336412757182, -818.3112781327884, -1065.8220593435465, -698.6848124170739, -61.03144972285992, -920.9093509330137, -610.4629279965457, -785.4654984650423, -1364.457897084577, -442.67536484084314, -260.7685813519382, -432.37523584909644, -1031.7647888624865, -960.6276360791402, -605.5131702798619, -165.92371712332357, -1242.851777405622, -338.3647999469544, -823.0946313939071, -675.0422099439627, -803.7973655171876, -321.0749880027326, -923.6218742525731, -984.2596947469691, -156.9625481341984, -842.6091068993269, -1298.0009152497485, -894.3076190454298, -100.87910380987776, -110.29990306164633, -388.8391327493859, -982.1288347807389, -256.7997555318024, -93.73298394485153, -748.3291776943918, -65.17259784218601, -901.1893995842386, -429.01913260755333, -850.9097780215606, -808.0350867976116, -864.9464503887298, -848.6350659209878, -1260.5011460731946, -678.0642440327687, -940.9039556588245, -936.5975451434031, -762.3209537217989, -950.0488947399199, -724.3558557607245, -20.399086755275935, -638.5660355723767, -612.623017595521, -1148.523792426204, -1173.649016572768, -878.9009461887723, -106.70871910602469, -704.7120735351821, -716.6468164315273, -17.331236244624755, -799.9800875861913, -95.3982294849951, -384.2322246647515, -1103.7572615877075, -885.2749909775233, -821.3773875841856, -459.6515730351805, -780.3543150431501, -837.8911846960848, -1013.1682957423162, -977.4654145376707, -515.5929023451203, -3.276501281255425, -1215.2918757603695, -634.0762342633599, -1077.131062587409, -796.3434729457643, -497.19639279588137, -708.0621127657312, -1106.8528220908988, -1039.4323648975721, -1118.4403256803378, -995.1613730304824, -1083.9167570568475, -940.6229024918947, -541.2784370968166], "episode_lengths": [150, 150, 150, 136, 90, 53, 66, 54, 91, 150, 150, 64, 72, 150, 143, 150, 150, 150, 150, 48, 150, 150, 150, 150, 113, 89, 150, 150, 150, 150, 61, 150, 106, 150, 150, 150, 123, 150, 150, 94, 150, 150, 150, 72, 70, 150, 150, 150, 81, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 79, 150, 150, 44, 150, 74, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-516.4794037576942, -1088.8024607322307, -786.2536563538608, -418.39379987726585, -229.14824005445834, -33.01912543552965, -140.26052646706324, -144.3437721048757, -147.30073184153878, -631.4941664694059, -971.7684887745833, -105.54755752687065, -176.74976722502237, -840.3377669375925, -739.902637684506, -895.3336412757182, -818.3112781327884, -1065.8220593435465, -698.6848124170739, -61.03144972285992, -920.9093509330137, -610.4629279965457, -785.4654984650423, -1364.457897084577, -442.67536484084314, -260.7685813519382, -432.37523584909644, -1031.7647888624865, -960.6276360791402, -605.5131702798619, -165.92371712332357, -1242.851777405622, -338.3647999469544, -823.0946313939071, -675.0422099439627, -803.7973655171876, -321.0749880027326, -923.6218742525731, -984.2596947469691, -156.9625481341984, -842.6091068993269, -1298.0009152497485, -894.3076190454298, -100.87910380987776, -110.29990306164633, -388.8391327493859, -982.1288347807389, -256.7997555318024, -93.73298394485153, -748.3291776943918, -65.17259784218601, -901.1893995842386, -429.01913260755333, -850.9097780215606, -808.0350867976116, -864.9464503887298, -848.6350659209878, -1260.5011460731946, -678.0642440327687, -940.9039556588245, -936.5975451434031, -762.3209537217989, -950.0488947399199, -724.3558557607245, -20.399086755275935, -638.5660355723767, -612.623017595521, -1148.523792426204, -1173.649016572768, -878.9009461887723, -106.70871910602469, -704.7120735351821, -716.6468164315273, -17.331236244624755, -799.9800875861913, -95.3982294849951, -384.2322246647515, -1103.7572615877075, -885.2749909775233, -821.3773875841856, -459.6515730351805, -780.3543150431501, -837.8911846960848, -1013.1682957423162, -977.4654145376707, -515.5929023451203, -3.276501281255425, -1215.2918757603695, -634.0762342633599, -1077.131062587409, -796.3434729457643, -497.19639279588137, -708.0621127657312, -1106.8528220908988, -1039.4323648975721, -1118.4403256803378, -995.1613730304824, -1083.9167570568475, -940.6229024918947, -541.2784370968166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6440433536375345, "mean_inference_ms": 1.9907606751449265, "mean_action_processing_ms": 0.33244805932987204, "mean_env_wait_ms": 3.50161560408122, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029809951782226562, "StateBufferConnector_ms": 0.018704891204833984, "ViewRequirementAgentConnector_ms": 0.26130151748657227}, "num_episodes": 28, "episode_return_max": -3.276501281255425, "episode_return_min": -1364.457897084577, "episode_return_mean": -675.4491328186294, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.71568739848476, "num_env_steps_trained_throughput_per_sec": 303.71568739848476, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13433.608, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13433.527, "sample_time_ms": 1462.084, "learn_time_ms": 11895.955, "learn_throughput": 336.249, "synch_weights_time_ms": 74.61}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00013", "date": "2024-08-03_04-24-26", "timestamp": 1722639266, "time_this_iter_s": 13.181872606277466, "time_total_s": 267.5511164665222, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7aa170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 267.5511164665222, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 39.22105263157895, "ram_util_percent": 49.315789473684205}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 194.68130518992743, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.288049639761448, "policy_loss": -0.014437326676852536, "vf_loss": 4.296536988268296, "vf_explained_var": 0.9837955866629878, "kl": 0.020251600295402288, "entropy": 1.2549232807010413, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -3.276501281255425, "episode_reward_min": -1298.0009152497485, "episode_reward_mean": -706.8704722509169, "episode_len_mean": 136.12, "episode_media": {}, "episodes_timesteps_total": 13612, "policy_reward_min": {"policy_0": -1298.0009152497485}, "policy_reward_max": {"policy_0": -3.276501281255425}, "policy_reward_mean": {"policy_0": -706.8704722509169}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-960.6276360791402, -605.5131702798619, -165.92371712332357, -1242.851777405622, -338.3647999469544, -823.0946313939071, -675.0422099439627, -803.7973655171876, -321.0749880027326, -923.6218742525731, -984.2596947469691, -156.9625481341984, -842.6091068993269, -1298.0009152497485, -894.3076190454298, -100.87910380987776, -110.29990306164633, -388.8391327493859, -982.1288347807389, -256.7997555318024, -93.73298394485153, -748.3291776943918, -65.17259784218601, -901.1893995842386, -429.01913260755333, -850.9097780215606, -808.0350867976116, -864.9464503887298, -848.6350659209878, -1260.5011460731946, -678.0642440327687, -940.9039556588245, -936.5975451434031, -762.3209537217989, -950.0488947399199, -724.3558557607245, -20.399086755275935, -638.5660355723767, -612.623017595521, -1148.523792426204, -1173.649016572768, -878.9009461887723, -106.70871910602469, -704.7120735351821, -716.6468164315273, -17.331236244624755, -799.9800875861913, -95.3982294849951, -384.2322246647515, -1103.7572615877075, -885.2749909775233, -821.3773875841856, -459.6515730351805, -780.3543150431501, -837.8911846960848, -1013.1682957423162, -977.4654145376707, -515.5929023451203, -3.276501281255425, -1215.2918757603695, -634.0762342633599, -1077.131062587409, -796.3434729457643, -497.19639279588137, -708.0621127657312, -1106.8528220908988, -1039.4323648975721, -1118.4403256803378, -995.1613730304824, -1083.9167570568475, -940.6229024918947, -541.2784370968166, -1052.0537965235794, -631.5736398030374, -735.6739424776641, -797.6539727035239, -869.6230552912766, -1072.6484178775052, -859.5236023705626, -683.4809900824928, -898.6643239220884, -317.5393715948511, -905.577206604343, -456.212756827877, -1033.7011159019894, -924.0972632531019, -228.69992950842666, -76.61918361153543, -802.3377325284627, -506.73282342422004, -855.7992704845814, -964.0795252173444, -716.4777111383428, -360.68439322884865, -802.9357250157155, -57.743668468545735, -1079.8050989336282, -942.6996528108051, -679.4632382094621, -187.89752293298224], "episode_lengths": [150, 150, 61, 150, 106, 150, 150, 150, 123, 150, 150, 94, 150, 150, 150, 72, 70, 150, 150, 150, 81, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 79, 150, 150, 44, 150, 74, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 145, 150, 150, 101, 79, 150, 150, 150, 150, 150, 108, 150, 68, 150, 150, 150, 108], "policy_policy_0_reward": [-960.6276360791402, -605.5131702798619, -165.92371712332357, -1242.851777405622, -338.3647999469544, -823.0946313939071, -675.0422099439627, -803.7973655171876, -321.0749880027326, -923.6218742525731, -984.2596947469691, -156.9625481341984, -842.6091068993269, -1298.0009152497485, -894.3076190454298, -100.87910380987776, -110.29990306164633, -388.8391327493859, -982.1288347807389, -256.7997555318024, -93.73298394485153, -748.3291776943918, -65.17259784218601, -901.1893995842386, -429.01913260755333, -850.9097780215606, -808.0350867976116, -864.9464503887298, -848.6350659209878, -1260.5011460731946, -678.0642440327687, -940.9039556588245, -936.5975451434031, -762.3209537217989, -950.0488947399199, -724.3558557607245, -20.399086755275935, -638.5660355723767, -612.623017595521, -1148.523792426204, -1173.649016572768, -878.9009461887723, -106.70871910602469, -704.7120735351821, -716.6468164315273, -17.331236244624755, -799.9800875861913, -95.3982294849951, -384.2322246647515, -1103.7572615877075, -885.2749909775233, -821.3773875841856, -459.6515730351805, -780.3543150431501, -837.8911846960848, -1013.1682957423162, -977.4654145376707, -515.5929023451203, -3.276501281255425, -1215.2918757603695, -634.0762342633599, -1077.131062587409, -796.3434729457643, -497.19639279588137, -708.0621127657312, -1106.8528220908988, -1039.4323648975721, -1118.4403256803378, -995.1613730304824, -1083.9167570568475, -940.6229024918947, -541.2784370968166, -1052.0537965235794, -631.5736398030374, -735.6739424776641, -797.6539727035239, -869.6230552912766, -1072.6484178775052, -859.5236023705626, -683.4809900824928, -898.6643239220884, -317.5393715948511, -905.577206604343, -456.212756827877, -1033.7011159019894, -924.0972632531019, -228.69992950842666, -76.61918361153543, -802.3377325284627, -506.73282342422004, -855.7992704845814, -964.0795252173444, -716.4777111383428, -360.68439322884865, -802.9357250157155, -57.743668468545735, -1079.8050989336282, -942.6996528108051, -679.4632382094621, -187.89752293298224]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6451070172785259, "mean_inference_ms": 1.9901578264920587, "mean_action_processing_ms": 0.3329289028421756, "mean_env_wait_ms": 3.5033136885467955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.029179096221923828, "StateBufferConnector_ms": 0.008106231689453125, "ViewRequirementAgentConnector_ms": 0.24611830711364746}, "num_episodes": 28, "episode_return_max": -3.276501281255425, "episode_return_min": -1298.0009152497485, "episode_return_mean": -706.8704722509169, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.38401240055344, "num_env_steps_trained_throughput_per_sec": 314.38401240055344, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13367.163, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13367.084, "sample_time_ms": 1457.278, "learn_time_ms": 11836.095, "learn_throughput": 337.949, "synch_weights_time_ms": 72.834}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00013", "date": "2024-08-03_04-24-39", "timestamp": 1722639279, "time_this_iter_s": 12.736884355545044, "time_total_s": 280.28800082206726, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7aacb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 280.28800082206726, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 22.638888888888893, "ram_util_percent": 49.4}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 181.07124331394832, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.132920562227567, "policy_loss": -0.006506221385401053, "vf_loss": 4.13435159077247, "vf_explained_var": 0.969357446829478, "kl": 0.011588519864987296, "entropy": 1.3963739494482676, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -3.276501281255425, "episode_reward_min": -1260.5011460731946, "episode_reward_mean": -733.8279715804575, "episode_len_mean": 137.48, "episode_media": {}, "episodes_timesteps_total": 13748, "policy_reward_min": {"policy_0": -1260.5011460731946}, "policy_reward_max": {"policy_0": -3.276501281255425}, "policy_reward_mean": {"policy_0": -733.8279715804575}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1260.5011460731946, -678.0642440327687, -940.9039556588245, -936.5975451434031, -762.3209537217989, -950.0488947399199, -724.3558557607245, -20.399086755275935, -638.5660355723767, -612.623017595521, -1148.523792426204, -1173.649016572768, -878.9009461887723, -106.70871910602469, -704.7120735351821, -716.6468164315273, -17.331236244624755, -799.9800875861913, -95.3982294849951, -384.2322246647515, -1103.7572615877075, -885.2749909775233, -821.3773875841856, -459.6515730351805, -780.3543150431501, -837.8911846960848, -1013.1682957423162, -977.4654145376707, -515.5929023451203, -3.276501281255425, -1215.2918757603695, -634.0762342633599, -1077.131062587409, -796.3434729457643, -497.19639279588137, -708.0621127657312, -1106.8528220908988, -1039.4323648975721, -1118.4403256803378, -995.1613730304824, -1083.9167570568475, -940.6229024918947, -541.2784370968166, -1052.0537965235794, -631.5736398030374, -735.6739424776641, -797.6539727035239, -869.6230552912766, -1072.6484178775052, -859.5236023705626, -683.4809900824928, -898.6643239220884, -317.5393715948511, -905.577206604343, -456.212756827877, -1033.7011159019894, -924.0972632531019, -228.69992950842666, -76.61918361153543, -802.3377325284627, -506.73282342422004, -855.7992704845814, -964.0795252173444, -716.4777111383428, -360.68439322884865, -802.9357250157155, -57.743668468545735, -1079.8050989336282, -942.6996528108051, -679.4632382094621, -187.89752293298224, -799.2697539153579, -626.2570284279838, -676.1016705018116, -925.2347764698027, -553.9655394763373, -5.574938314697421, -726.214925855284, -506.01518178944696, -735.2063052113442, -958.7889090675114, -883.4129702026991, -41.29349441763205, -817.4267630402907, -664.0765718728742, -1245.7232788696674, -733.1212845226872, -1155.612380680217, -965.3021321857846, -1118.0884110469883, -644.2567613367219, -1029.2335678022184, -644.6355099365201, -853.5624157789641, -868.4206311012498, -639.6334243204826, -151.04630552676642, -305.8676392558787, -961.7252741193561, -945.6505446639571], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 150, 150, 150, 79, 150, 150, 44, 150, 74, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 145, 150, 150, 101, 79, 150, 150, 150, 150, 150, 108, 150, 68, 150, 150, 150, 108, 150, 150, 150, 150, 135, 38, 150, 113, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 101, 150, 150], "policy_policy_0_reward": [-1260.5011460731946, -678.0642440327687, -940.9039556588245, -936.5975451434031, -762.3209537217989, -950.0488947399199, -724.3558557607245, -20.399086755275935, -638.5660355723767, -612.623017595521, -1148.523792426204, -1173.649016572768, -878.9009461887723, -106.70871910602469, -704.7120735351821, -716.6468164315273, -17.331236244624755, -799.9800875861913, -95.3982294849951, -384.2322246647515, -1103.7572615877075, -885.2749909775233, -821.3773875841856, -459.6515730351805, -780.3543150431501, -837.8911846960848, -1013.1682957423162, -977.4654145376707, -515.5929023451203, -3.276501281255425, -1215.2918757603695, -634.0762342633599, -1077.131062587409, -796.3434729457643, -497.19639279588137, -708.0621127657312, -1106.8528220908988, -1039.4323648975721, -1118.4403256803378, -995.1613730304824, -1083.9167570568475, -940.6229024918947, -541.2784370968166, -1052.0537965235794, -631.5736398030374, -735.6739424776641, -797.6539727035239, -869.6230552912766, -1072.6484178775052, -859.5236023705626, -683.4809900824928, -898.6643239220884, -317.5393715948511, -905.577206604343, -456.212756827877, -1033.7011159019894, -924.0972632531019, -228.69992950842666, -76.61918361153543, -802.3377325284627, -506.73282342422004, -855.7992704845814, -964.0795252173444, -716.4777111383428, -360.68439322884865, -802.9357250157155, -57.743668468545735, -1079.8050989336282, -942.6996528108051, -679.4632382094621, -187.89752293298224, -799.2697539153579, -626.2570284279838, -676.1016705018116, -925.2347764698027, -553.9655394763373, -5.574938314697421, -726.214925855284, -506.01518178944696, -735.2063052113442, -958.7889090675114, -883.4129702026991, -41.29349441763205, -817.4267630402907, -664.0765718728742, -1245.7232788696674, -733.1212845226872, -1155.612380680217, -965.3021321857846, -1118.0884110469883, -644.2567613367219, -1029.2335678022184, -644.6355099365201, -853.5624157789641, -868.4206311012498, -639.6334243204826, -151.04630552676642, -305.8676392558787, -961.7252741193561, -945.6505446639571]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6412474965399108, "mean_inference_ms": 1.9758051370611307, "mean_action_processing_ms": 0.33057369274827325, "mean_env_wait_ms": 3.4828988662129117, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012385129928588867, "StateBufferConnector_ms": 0.007791042327880859, "ViewRequirementAgentConnector_ms": 0.20280766487121582}, "num_episodes": 29, "episode_return_max": -3.276501281255425, "episode_return_min": -1260.5011460731946, "episode_return_mean": -733.8279715804575, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.70517855735534, "num_env_steps_trained_throughput_per_sec": 282.70517855735534, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13453.352, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13453.272, "sample_time_ms": 1454.327, "learn_time_ms": 11925.061, "learn_throughput": 335.428, "synch_weights_time_ms": 73.003}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00013", "date": "2024-08-03_04-24-53", "timestamp": 1722639293, "time_this_iter_s": 14.161314964294434, "time_total_s": 294.4493157863617, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7a9ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 294.4493157863617, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 22.605, "ram_util_percent": 49.39999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 187.06302061279615, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.377115650475025, "policy_loss": -0.007974665648362134, "vf_loss": 4.379433207958937, "vf_explained_var": 0.9800927493721246, "kl": 0.012885289414528742, "entropy": 1.412770445520679, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -3.276501281255425, "episode_reward_min": -1323.5449311351, "episode_reward_mean": -739.0677412656266, "episode_len_mean": 137.26, "episode_media": {}, "episodes_timesteps_total": 13726, "policy_reward_min": {"policy_0": -1323.5449311351}, "policy_reward_max": {"policy_0": -3.276501281255425}, "policy_reward_mean": {"policy_0": -739.0677412656266}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-3.276501281255425, -1215.2918757603695, -634.0762342633599, -1077.131062587409, -796.3434729457643, -497.19639279588137, -708.0621127657312, -1106.8528220908988, -1039.4323648975721, -1118.4403256803378, -995.1613730304824, -1083.9167570568475, -940.6229024918947, -541.2784370968166, -1052.0537965235794, -631.5736398030374, -735.6739424776641, -797.6539727035239, -869.6230552912766, -1072.6484178775052, -859.5236023705626, -683.4809900824928, -898.6643239220884, -317.5393715948511, -905.577206604343, -456.212756827877, -1033.7011159019894, -924.0972632531019, -228.69992950842666, -76.61918361153543, -802.3377325284627, -506.73282342422004, -855.7992704845814, -964.0795252173444, -716.4777111383428, -360.68439322884865, -802.9357250157155, -57.743668468545735, -1079.8050989336282, -942.6996528108051, -679.4632382094621, -187.89752293298224, -799.2697539153579, -626.2570284279838, -676.1016705018116, -925.2347764698027, -553.9655394763373, -5.574938314697421, -726.214925855284, -506.01518178944696, -735.2063052113442, -958.7889090675114, -883.4129702026991, -41.29349441763205, -817.4267630402907, -664.0765718728742, -1245.7232788696674, -733.1212845226872, -1155.612380680217, -965.3021321857846, -1118.0884110469883, -644.2567613367219, -1029.2335678022184, -644.6355099365201, -853.5624157789641, -868.4206311012498, -639.6334243204826, -151.04630552676642, -305.8676392558787, -961.7252741193561, -945.6505446639571, -1041.0607163644297, -967.7826906412412, -1187.5606724041877, -1004.2240925831768, -706.0375052302031, -153.87455767304039, -377.1897998068137, -1186.4961053368952, -837.7667284921058, -693.5860039061319, -1156.0712817232607, -443.83964185864187, -1030.7525293475446, -197.5796279969872, -80.75052425778266, -838.7783632046492, -1323.5449311351, -945.2462754273851, -38.05303261018298, -563.3651436549804, -864.1519982527017, -482.6230111392541, -918.220169541107, -389.84100360669856, -1179.6578140710394, -150.92872100923847, -701.8621423558708, -1186.931447423135, -821.1976403069223], "episode_lengths": [35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 145, 150, 150, 101, 79, 150, 150, 150, 150, 150, 108, 150, 68, 150, 150, 150, 108, 150, 150, 150, 150, 135, 38, 150, 113, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 101, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 133, 150, 85, 50, 150, 150, 150, 59, 150, 150, 150, 150, 111, 150, 85, 150, 150, 150], "policy_policy_0_reward": [-3.276501281255425, -1215.2918757603695, -634.0762342633599, -1077.131062587409, -796.3434729457643, -497.19639279588137, -708.0621127657312, -1106.8528220908988, -1039.4323648975721, -1118.4403256803378, -995.1613730304824, -1083.9167570568475, -940.6229024918947, -541.2784370968166, -1052.0537965235794, -631.5736398030374, -735.6739424776641, -797.6539727035239, -869.6230552912766, -1072.6484178775052, -859.5236023705626, -683.4809900824928, -898.6643239220884, -317.5393715948511, -905.577206604343, -456.212756827877, -1033.7011159019894, -924.0972632531019, -228.69992950842666, -76.61918361153543, -802.3377325284627, -506.73282342422004, -855.7992704845814, -964.0795252173444, -716.4777111383428, -360.68439322884865, -802.9357250157155, -57.743668468545735, -1079.8050989336282, -942.6996528108051, -679.4632382094621, -187.89752293298224, -799.2697539153579, -626.2570284279838, -676.1016705018116, -925.2347764698027, -553.9655394763373, -5.574938314697421, -726.214925855284, -506.01518178944696, -735.2063052113442, -958.7889090675114, -883.4129702026991, -41.29349441763205, -817.4267630402907, -664.0765718728742, -1245.7232788696674, -733.1212845226872, -1155.612380680217, -965.3021321857846, -1118.0884110469883, -644.2567613367219, -1029.2335678022184, -644.6355099365201, -853.5624157789641, -868.4206311012498, -639.6334243204826, -151.04630552676642, -305.8676392558787, -961.7252741193561, -945.6505446639571, -1041.0607163644297, -967.7826906412412, -1187.5606724041877, -1004.2240925831768, -706.0375052302031, -153.87455767304039, -377.1897998068137, -1186.4961053368952, -837.7667284921058, -693.5860039061319, -1156.0712817232607, -443.83964185864187, -1030.7525293475446, -197.5796279969872, -80.75052425778266, -838.7783632046492, -1323.5449311351, -945.2462754273851, -38.05303261018298, -563.3651436549804, -864.1519982527017, -482.6230111392541, -918.220169541107, -389.84100360669856, -1179.6578140710394, -150.92872100923847, -701.8621423558708, -1186.931447423135, -821.1976403069223]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.639088024882016, "mean_inference_ms": 1.9657859673095157, "mean_action_processing_ms": 0.32897113659199234, "mean_env_wait_ms": 3.471302759780175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012651443481445312, "StateBufferConnector_ms": 0.008164405822753906, "ViewRequirementAgentConnector_ms": 0.20235347747802734}, "num_episodes": 29, "episode_return_max": -3.276501281255425, "episode_return_min": -1323.5449311351, "episode_return_mean": -739.0677412656266, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.4105319376898, "num_env_steps_trained_throughput_per_sec": 297.4105319376898, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13392.423, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13392.343, "sample_time_ms": 1496.956, "learn_time_ms": 11818.939, "learn_throughput": 338.44, "synch_weights_time_ms": 75.556}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00013", "date": "2024-08-03_04-25-07", "timestamp": 1722639307, "time_this_iter_s": 13.463568449020386, "time_total_s": 307.9128842353821, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7aa170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 307.9128842353821, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 35.5, "ram_util_percent": 49.48947368421052}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 213.10446058511735, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.7028942560156186, "policy_loss": -0.0082792907608867, "vf_loss": 3.705413511643807, "vf_explained_var": 0.9836668716122706, "kl": 0.013127667670278242, "entropy": 1.4743279887984195, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -5.574938314697421, "episode_reward_min": -1454.6571853184375, "episode_reward_mean": -715.4611681904016, "episode_len_mean": 133.73, "episode_media": {}, "episodes_timesteps_total": 13373, "policy_reward_min": {"policy_0": -1454.6571853184375}, "policy_reward_max": {"policy_0": -5.574938314697421}, "policy_reward_mean": {"policy_0": -715.4611681904016}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-855.7992704845814, -964.0795252173444, -716.4777111383428, -360.68439322884865, -802.9357250157155, -57.743668468545735, -1079.8050989336282, -942.6996528108051, -679.4632382094621, -187.89752293298224, -799.2697539153579, -626.2570284279838, -676.1016705018116, -925.2347764698027, -553.9655394763373, -5.574938314697421, -726.214925855284, -506.01518178944696, -735.2063052113442, -958.7889090675114, -883.4129702026991, -41.29349441763205, -817.4267630402907, -664.0765718728742, -1245.7232788696674, -733.1212845226872, -1155.612380680217, -965.3021321857846, -1118.0884110469883, -644.2567613367219, -1029.2335678022184, -644.6355099365201, -853.5624157789641, -868.4206311012498, -639.6334243204826, -151.04630552676642, -305.8676392558787, -961.7252741193561, -945.6505446639571, -1041.0607163644297, -967.7826906412412, -1187.5606724041877, -1004.2240925831768, -706.0375052302031, -153.87455767304039, -377.1897998068137, -1186.4961053368952, -837.7667284921058, -693.5860039061319, -1156.0712817232607, -443.83964185864187, -1030.7525293475446, -197.5796279969872, -80.75052425778266, -838.7783632046492, -1323.5449311351, -945.2462754273851, -38.05303261018298, -563.3651436549804, -864.1519982527017, -482.6230111392541, -918.220169541107, -389.84100360669856, -1179.6578140710394, -150.92872100923847, -701.8621423558708, -1186.931447423135, -821.1976403069223, -962.3907137159413, -965.1217038486857, -1052.5048166774486, -1454.6571853184375, -742.5784450764402, -1022.0992892153778, -642.2169830663779, -69.513148475111, -973.4191406355702, -1092.3989407626027, -543.8538252087726, -59.54972919512901, -202.52987971824837, -749.393477032594, -346.45742663038124, -950.3665229800177, -644.7752031519832, -1155.2133964032555, -147.04916522699625, -625.5509265305274, -105.40066653649802, -272.90545619012863, -932.817965710331, -1108.916697093533, -92.44349745809896, -880.0518087271774, -1164.431036387121, -809.4701270511347, -841.021036858665, -312.4903989258322, -568.1888201762083, -759.0610215440331], "episode_lengths": [150, 150, 150, 108, 150, 68, 150, 150, 150, 108, 150, 150, 150, 150, 135, 38, 150, 113, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 101, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 133, 150, 85, 50, 150, 150, 150, 59, 150, 150, 150, 150, 111, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 62, 67, 150, 103, 150, 150, 150, 74, 150, 49, 135, 150, 150, 70, 150, 150, 150, 150, 83, 150, 150], "policy_policy_0_reward": [-855.7992704845814, -964.0795252173444, -716.4777111383428, -360.68439322884865, -802.9357250157155, -57.743668468545735, -1079.8050989336282, -942.6996528108051, -679.4632382094621, -187.89752293298224, -799.2697539153579, -626.2570284279838, -676.1016705018116, -925.2347764698027, -553.9655394763373, -5.574938314697421, -726.214925855284, -506.01518178944696, -735.2063052113442, -958.7889090675114, -883.4129702026991, -41.29349441763205, -817.4267630402907, -664.0765718728742, -1245.7232788696674, -733.1212845226872, -1155.612380680217, -965.3021321857846, -1118.0884110469883, -644.2567613367219, -1029.2335678022184, -644.6355099365201, -853.5624157789641, -868.4206311012498, -639.6334243204826, -151.04630552676642, -305.8676392558787, -961.7252741193561, -945.6505446639571, -1041.0607163644297, -967.7826906412412, -1187.5606724041877, -1004.2240925831768, -706.0375052302031, -153.87455767304039, -377.1897998068137, -1186.4961053368952, -837.7667284921058, -693.5860039061319, -1156.0712817232607, -443.83964185864187, -1030.7525293475446, -197.5796279969872, -80.75052425778266, -838.7783632046492, -1323.5449311351, -945.2462754273851, -38.05303261018298, -563.3651436549804, -864.1519982527017, -482.6230111392541, -918.220169541107, -389.84100360669856, -1179.6578140710394, -150.92872100923847, -701.8621423558708, -1186.931447423135, -821.1976403069223, -962.3907137159413, -965.1217038486857, -1052.5048166774486, -1454.6571853184375, -742.5784450764402, -1022.0992892153778, -642.2169830663779, -69.513148475111, -973.4191406355702, -1092.3989407626027, -543.8538252087726, -59.54972919512901, -202.52987971824837, -749.393477032594, -346.45742663038124, -950.3665229800177, -644.7752031519832, -1155.2133964032555, -147.04916522699625, -625.5509265305274, -105.40066653649802, -272.90545619012863, -932.817965710331, -1108.916697093533, -92.44349745809896, -880.0518087271774, -1164.431036387121, -809.4701270511347, -841.021036858665, -312.4903989258322, -568.1888201762083, -759.0610215440331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6368737726632225, "mean_inference_ms": 1.957884940187595, "mean_action_processing_ms": 0.3275577128078768, "mean_env_wait_ms": 3.462213467610916, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012608528137207031, "StateBufferConnector_ms": 0.008232593536376953, "ViewRequirementAgentConnector_ms": 0.2171630859375}, "num_episodes": 32, "episode_return_max": -5.574938314697421, "episode_return_min": -1454.6571853184375, "episode_return_mean": -715.4611681904016, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.1200189025492, "num_env_steps_trained_throughput_per_sec": 326.1200189025492, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 13424.716, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13424.635, "sample_time_ms": 1503.933, "learn_time_ms": 11843.97, "learn_throughput": 337.725, "synch_weights_time_ms": 75.847}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00013", "date": "2024-08-03_04-25-19", "timestamp": 1722639319, "time_this_iter_s": 12.27852177619934, "time_total_s": 320.1914060115814, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70ab90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 320.1914060115814, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 23.222222222222218, "ram_util_percent": 49.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 219.71262732545534, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 4.030046263585488, "policy_loss": -0.009609549039062889, "vf_loss": 4.033264292031527, "vf_explained_var": 0.979683120114108, "kl": 0.01451898487142292, "entropy": 1.4201912365853786, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -29.529645390381955, "episode_reward_min": -1454.6571853184375, "episode_reward_mean": -716.5977035531198, "episode_len_mean": 131.83, "episode_media": {}, "episodes_timesteps_total": 13183, "policy_reward_min": {"policy_0": -1454.6571853184375}, "policy_reward_max": {"policy_0": -29.529645390381955}, "policy_reward_mean": {"policy_0": -716.5977035531198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-644.6355099365201, -853.5624157789641, -868.4206311012498, -639.6334243204826, -151.04630552676642, -305.8676392558787, -961.7252741193561, -945.6505446639571, -1041.0607163644297, -967.7826906412412, -1187.5606724041877, -1004.2240925831768, -706.0375052302031, -153.87455767304039, -377.1897998068137, -1186.4961053368952, -837.7667284921058, -693.5860039061319, -1156.0712817232607, -443.83964185864187, -1030.7525293475446, -197.5796279969872, -80.75052425778266, -838.7783632046492, -1323.5449311351, -945.2462754273851, -38.05303261018298, -563.3651436549804, -864.1519982527017, -482.6230111392541, -918.220169541107, -389.84100360669856, -1179.6578140710394, -150.92872100923847, -701.8621423558708, -1186.931447423135, -821.1976403069223, -962.3907137159413, -965.1217038486857, -1052.5048166774486, -1454.6571853184375, -742.5784450764402, -1022.0992892153778, -642.2169830663779, -69.513148475111, -973.4191406355702, -1092.3989407626027, -543.8538252087726, -59.54972919512901, -202.52987971824837, -749.393477032594, -346.45742663038124, -950.3665229800177, -644.7752031519832, -1155.2133964032555, -147.04916522699625, -625.5509265305274, -105.40066653649802, -272.90545619012863, -932.817965710331, -1108.916697093533, -92.44349745809896, -880.0518087271774, -1164.431036387121, -809.4701270511347, -841.021036858665, -312.4903989258322, -568.1888201762083, -759.0610215440331, -755.5336121552328, -446.9344899243345, -281.84394510996214, -1174.5893843588196, -166.35096312376123, -578.2334007407919, -986.6684292899653, -75.17205678894882, -969.4977240360963, -336.6874514543815, -974.4999025145589, -1153.782403328607, -600.6619127266148, -1436.433335303624, -135.8323152571303, -1220.0539345435725, -1118.1693191677189, -867.2283765429078, -953.2387321147382, -1101.4580340529935, -1158.6295170906908, -635.9721844423415, -307.0187542660246, -508.0132155272462, -74.46226857766091, -29.529645390381955, -823.7906328651218, -1126.658596749007, -870.958602091662, -952.3443005568444, -751.1685476276866], "episode_lengths": [150, 150, 150, 150, 70, 101, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 133, 150, 85, 50, 150, 150, 150, 59, 150, 150, 150, 150, 111, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 62, 67, 150, 103, 150, 150, 150, 74, 150, 49, 135, 150, 150, 70, 150, 150, 150, 150, 83, 150, 150, 150, 150, 85, 150, 75, 150, 150, 42, 150, 91, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 93, 150, 75, 53, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-644.6355099365201, -853.5624157789641, -868.4206311012498, -639.6334243204826, -151.04630552676642, -305.8676392558787, -961.7252741193561, -945.6505446639571, -1041.0607163644297, -967.7826906412412, -1187.5606724041877, -1004.2240925831768, -706.0375052302031, -153.87455767304039, -377.1897998068137, -1186.4961053368952, -837.7667284921058, -693.5860039061319, -1156.0712817232607, -443.83964185864187, -1030.7525293475446, -197.5796279969872, -80.75052425778266, -838.7783632046492, -1323.5449311351, -945.2462754273851, -38.05303261018298, -563.3651436549804, -864.1519982527017, -482.6230111392541, -918.220169541107, -389.84100360669856, -1179.6578140710394, -150.92872100923847, -701.8621423558708, -1186.931447423135, -821.1976403069223, -962.3907137159413, -965.1217038486857, -1052.5048166774486, -1454.6571853184375, -742.5784450764402, -1022.0992892153778, -642.2169830663779, -69.513148475111, -973.4191406355702, -1092.3989407626027, -543.8538252087726, -59.54972919512901, -202.52987971824837, -749.393477032594, -346.45742663038124, -950.3665229800177, -644.7752031519832, -1155.2133964032555, -147.04916522699625, -625.5509265305274, -105.40066653649802, -272.90545619012863, -932.817965710331, -1108.916697093533, -92.44349745809896, -880.0518087271774, -1164.431036387121, -809.4701270511347, -841.021036858665, -312.4903989258322, -568.1888201762083, -759.0610215440331, -755.5336121552328, -446.9344899243345, -281.84394510996214, -1174.5893843588196, -166.35096312376123, -578.2334007407919, -986.6684292899653, -75.17205678894882, -969.4977240360963, -336.6874514543815, -974.4999025145589, -1153.782403328607, -600.6619127266148, -1436.433335303624, -135.8323152571303, -1220.0539345435725, -1118.1693191677189, -867.2283765429078, -953.2387321147382, -1101.4580340529935, -1158.6295170906908, -635.9721844423415, -307.0187542660246, -508.0132155272462, -74.46226857766091, -29.529645390381955, -823.7906328651218, -1126.658596749007, -870.958602091662, -952.3443005568444, -751.1685476276866]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.6360510073386978, "mean_inference_ms": 1.9542058126482877, "mean_action_processing_ms": 0.32669687183957097, "mean_env_wait_ms": 3.455377950336293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012604475021362305, "StateBufferConnector_ms": 0.00830984115600586, "ViewRequirementAgentConnector_ms": 0.21448636054992676}, "num_episodes": 31, "episode_return_max": -29.529645390381955, "episode_return_min": -1454.6571853184375, "episode_return_mean": -716.5977035531198, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.96009316789883, "num_env_steps_trained_throughput_per_sec": 312.96009316789883, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 13323.487, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13323.408, "sample_time_ms": 1511.203, "learn_time_ms": 11740.832, "learn_throughput": 340.691, "synch_weights_time_ms": 70.542}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00013", "date": "2024-08-03_04-25-32", "timestamp": 1722639332, "time_this_iter_s": 12.7953200340271, "time_total_s": 332.9867260456085, "pid": 477388, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c70bac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 332.9867260456085, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 50.400000000000006, "ram_util_percent": 49.56666666666667}}
