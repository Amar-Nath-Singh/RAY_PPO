{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4789493644610048, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.322177662452061, "policy_loss": -0.003151597521112611, "vf_loss": 9.32533227801323, "vf_explained_var": -0.011944433612128099, "kl": 0.007104287264041886, "entropy": 1.4238785725086927, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -64.02889466034196, "episode_reward_min": -1161.151237166657, "episode_reward_mean": -681.9529004134105, "episode_len_mean": 129.11111111111111, "episode_media": {}, "episodes_timesteps_total": 3486, "policy_reward_min": {"policy_0": -1161.151237166657}, "policy_reward_max": {"policy_0": -64.02889466034196}, "policy_reward_mean": {"policy_0": -681.9529004134105}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-354.3696007569714, -856.9461418771547, -370.91568878603135, -932.5975373886413, -1161.151237166657, -820.0288819337342, -758.8005988671483, -1115.3815446725212, -999.5255484211382, -925.8780019365277, -1131.3962888254932, -993.0674891355338, -906.821943376704, -926.1685239920564, -159.3343247967069, -1034.970888689097, -261.68037127915983, -759.4815211887743, -511.22291154026044, -332.20539983859237, -612.4003249622539, -272.51625392273206, -868.2225334308812, -64.02889466034196, -827.6292771871096, -248.07902699888382, -207.90755553097807], "episode_lengths": [97, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 105, 150, 150, 116, 150, 92, 150, 48, 150, 70, 67], "policy_policy_0_reward": [-354.3696007569714, -856.9461418771547, -370.91568878603135, -932.5975373886413, -1161.151237166657, -820.0288819337342, -758.8005988671483, -1115.3815446725212, -999.5255484211382, -925.8780019365277, -1131.3962888254932, -993.0674891355338, -906.821943376704, -926.1685239920564, -159.3343247967069, -1034.970888689097, -261.68037127915983, -759.4815211887743, -511.22291154026044, -332.20539983859237, -612.4003249622539, -272.51625392273206, -868.2225334308812, -64.02889466034196, -827.6292771871096, -248.07902699888382, -207.90755553097807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28051838120987765, "mean_inference_ms": 0.8769059592412944, "mean_action_processing_ms": 0.16158868531532125, "mean_env_wait_ms": 1.524202523893174, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00583684002911603, "StateBufferConnector_ms": 0.0043242065994827834, "ViewRequirementAgentConnector_ms": 0.09417004055447048}, "num_episodes": 27, "episode_return_max": -64.02889466034196, "episode_return_min": -1161.151237166657, "episode_return_mean": -681.9529004134105, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 283.10577054502687, "num_env_steps_trained_throughput_per_sec": 283.10577054502687, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 14129.008, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14128.934, "sample_time_ms": 2373.494, "learn_time_ms": 11740.423, "learn_throughput": 340.703, "synch_weights_time_ms": 14.312}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00002", "date": "2024-08-03_04-32-23", "timestamp": 1722639743, "time_this_iter_s": 14.135971307754517, "time_total_s": 14.135971307754517, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580e9870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 14.135971307754517, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 11.938095238095238, "ram_util_percent": 16.095238095238102}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.596734819871684, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.478661413987478, "policy_loss": -0.008821847804938443, "vf_loss": 9.48633954624335, "vf_explained_var": 0.06833871733397245, "kl": 0.012939221935130264, "entropy": 1.4441191802422206, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -64.02889466034196, "episode_reward_min": -1161.151237166657, "episode_reward_mean": -679.148785765888, "episode_len_mean": 132.08620689655172, "episode_media": {}, "episodes_timesteps_total": 7661, "policy_reward_min": {"policy_0": -1161.151237166657}, "policy_reward_max": {"policy_0": -64.02889466034196}, "policy_reward_mean": {"policy_0": -679.148785765888}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-354.3696007569714, -856.9461418771547, -370.91568878603135, -932.5975373886413, -1161.151237166657, -820.0288819337342, -758.8005988671483, -1115.3815446725212, -999.5255484211382, -925.8780019365277, -1131.3962888254932, -993.0674891355338, -906.821943376704, -926.1685239920564, -159.3343247967069, -1034.970888689097, -261.68037127915983, -759.4815211887743, -511.22291154026044, -332.20539983859237, -612.4003249622539, -272.51625392273206, -868.2225334308812, -64.02889466034196, -827.6292771871096, -248.07902699888382, -207.90755553097807, -402.12551873562074, -862.3413501383333, -1090.07513570772, -832.4049891093105, -1099.9994235933866, -133.07749362957307, -96.3119476160094, -801.4256208317398, -337.23454354582503, -560.2974962542486, -1047.5386236942015, -119.93026318138412, -88.84156896614516, -872.3629037489565, -906.0118705857079, -759.1247854043233, -1055.2580018119986, -544.1639897245238, -590.8361999425864, -700.1865937767449, -1015.6636378176285, -355.7163554490583, -363.3702219754497, -912.2174979732446, -881.3760325995792, -770.0240653627585, -308.0037355882369, -594.4860083746847, -1055.653487510601, -846.3517608392402, -975.4901397705953], "episode_lengths": [97, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 105, 150, 150, 116, 150, 92, 150, 48, 150, 70, 67, 150, 150, 150, 150, 150, 68, 63, 150, 95, 150, 150, 57, 97, 150, 150, 150, 150, 120, 145, 150, 150, 145, 108, 150, 150, 150, 127, 150, 150, 150, 150], "policy_policy_0_reward": [-354.3696007569714, -856.9461418771547, -370.91568878603135, -932.5975373886413, -1161.151237166657, -820.0288819337342, -758.8005988671483, -1115.3815446725212, -999.5255484211382, -925.8780019365277, -1131.3962888254932, -993.0674891355338, -906.821943376704, -926.1685239920564, -159.3343247967069, -1034.970888689097, -261.68037127915983, -759.4815211887743, -511.22291154026044, -332.20539983859237, -612.4003249622539, -272.51625392273206, -868.2225334308812, -64.02889466034196, -827.6292771871096, -248.07902699888382, -207.90755553097807, -402.12551873562074, -862.3413501383333, -1090.07513570772, -832.4049891093105, -1099.9994235933866, -133.07749362957307, -96.3119476160094, -801.4256208317398, -337.23454354582503, -560.2974962542486, -1047.5386236942015, -119.93026318138412, -88.84156896614516, -872.3629037489565, -906.0118705857079, -759.1247854043233, -1055.2580018119986, -544.1639897245238, -590.8361999425864, -700.1865937767449, -1015.6636378176285, -355.7163554490583, -363.3702219754497, -912.2174979732446, -881.3760325995792, -770.0240653627585, -308.0037355882369, -594.4860083746847, -1055.653487510601, -846.3517608392402, -975.4901397705953]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2782691730449171, "mean_inference_ms": 0.8736672201603766, "mean_action_processing_ms": 0.16087582268578704, "mean_env_wait_ms": 1.5198133408299106, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005607358340559335, "StateBufferConnector_ms": 0.004186712462326576, "ViewRequirementAgentConnector_ms": 0.09458270566216831}, "num_episodes": 31, "episode_return_max": -64.02889466034196, "episode_return_min": -1161.151237166657, "episode_return_mean": -679.148785765888, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 292.3852817754768, "num_env_steps_trained_throughput_per_sec": 292.3852817754768, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13904.8, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13904.731, "sample_time_ms": 2334.47, "learn_time_ms": 11555.237, "learn_throughput": 346.163, "synch_weights_time_ms": 14.254}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00002", "date": "2024-08-03_04-32-37", "timestamp": 1722639757, "time_this_iter_s": 13.68739628791809, "time_total_s": 27.823367595672607, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c7236d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 27.823367595672607, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 12.805263157894736, "ram_util_percent": 16.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.6219517722725865, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.693904531002044, "policy_loss": -0.006299059605225921, "vf_loss": 8.699169993400574, "vf_explained_var": 0.1612361676370104, "kl": 0.012597450741031939, "entropy": 1.485864211494724, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -27.76215940738079, "episode_reward_min": -1224.7696717378237, "episode_reward_mean": -665.8250536709019, "episode_len_mean": 131.48314606741573, "episode_media": {}, "episodes_timesteps_total": 11702, "policy_reward_min": {"policy_0": -1224.7696717378237}, "policy_reward_max": {"policy_0": -27.76215940738079}, "policy_reward_mean": {"policy_0": -665.8250536709019}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-354.3696007569714, -856.9461418771547, -370.91568878603135, -932.5975373886413, -1161.151237166657, -820.0288819337342, -758.8005988671483, -1115.3815446725212, -999.5255484211382, -925.8780019365277, -1131.3962888254932, -993.0674891355338, -906.821943376704, -926.1685239920564, -159.3343247967069, -1034.970888689097, -261.68037127915983, -759.4815211887743, -511.22291154026044, -332.20539983859237, -612.4003249622539, -272.51625392273206, -868.2225334308812, -64.02889466034196, -827.6292771871096, -248.07902699888382, -207.90755553097807, -402.12551873562074, -862.3413501383333, -1090.07513570772, -832.4049891093105, -1099.9994235933866, -133.07749362957307, -96.3119476160094, -801.4256208317398, -337.23454354582503, -560.2974962542486, -1047.5386236942015, -119.93026318138412, -88.84156896614516, -872.3629037489565, -906.0118705857079, -759.1247854043233, -1055.2580018119986, -544.1639897245238, -590.8361999425864, -700.1865937767449, -1015.6636378176285, -355.7163554490583, -363.3702219754497, -912.2174979732446, -881.3760325995792, -770.0240653627585, -308.0037355882369, -594.4860083746847, -1055.653487510601, -846.3517608392402, -975.4901397705953, -664.8859281975624, -528.002195550312, -267.95299031945456, -921.5981904249576, -760.9152809445624, -30.127537610005863, -647.7008316857407, -752.5551343755484, -359.7933099802987, -27.76215940738079, -782.5861580850375, -671.5416153955965, -540.8606019755489, -719.9981357241506, -987.1486348324622, -435.4944785107249, -1106.5248464261872, -355.9015474483427, -1089.8347268232094, -872.7610932385791, -105.8666793057244, -1033.1918323465559, -109.26722799999308, -730.2478710192592, -1224.7696717378237, -858.06604991997, -565.4897990039713, -1048.8485046506482, -337.54279533326405, -648.4811918786174, -682.083182137269], "episode_lengths": [97, 150, 121, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 105, 150, 150, 116, 150, 92, 150, 48, 150, 70, 67, 150, 150, 150, 150, 150, 68, 63, 150, 95, 150, 150, 57, 97, 150, 150, 150, 150, 120, 145, 150, 150, 145, 108, 150, 150, 150, 127, 150, 150, 150, 150, 141, 131, 85, 150, 150, 39, 150, 150, 108, 38, 150, 150, 110, 150, 150, 150, 150, 112, 150, 150, 79, 150, 82, 150, 150, 150, 150, 150, 116, 150, 150], "policy_policy_0_reward": [-354.3696007569714, -856.9461418771547, -370.91568878603135, -932.5975373886413, -1161.151237166657, -820.0288819337342, -758.8005988671483, -1115.3815446725212, -999.5255484211382, -925.8780019365277, -1131.3962888254932, -993.0674891355338, -906.821943376704, -926.1685239920564, -159.3343247967069, -1034.970888689097, -261.68037127915983, -759.4815211887743, -511.22291154026044, -332.20539983859237, -612.4003249622539, -272.51625392273206, -868.2225334308812, -64.02889466034196, -827.6292771871096, -248.07902699888382, -207.90755553097807, -402.12551873562074, -862.3413501383333, -1090.07513570772, -832.4049891093105, -1099.9994235933866, -133.07749362957307, -96.3119476160094, -801.4256208317398, -337.23454354582503, -560.2974962542486, -1047.5386236942015, -119.93026318138412, -88.84156896614516, -872.3629037489565, -906.0118705857079, -759.1247854043233, -1055.2580018119986, -544.1639897245238, -590.8361999425864, -700.1865937767449, -1015.6636378176285, -355.7163554490583, -363.3702219754497, -912.2174979732446, -881.3760325995792, -770.0240653627585, -308.0037355882369, -594.4860083746847, -1055.653487510601, -846.3517608392402, -975.4901397705953, -664.8859281975624, -528.002195550312, -267.95299031945456, -921.5981904249576, -760.9152809445624, -30.127537610005863, -647.7008316857407, -752.5551343755484, -359.7933099802987, -27.76215940738079, -782.5861580850375, -671.5416153955965, -540.8606019755489, -719.9981357241506, -987.1486348324622, -435.4944785107249, -1106.5248464261872, -355.9015474483427, -1089.8347268232094, -872.7610932385791, -105.8666793057244, -1033.1918323465559, -109.26722799999308, -730.2478710192592, -1224.7696717378237, -858.06604991997, -565.4897990039713, -1048.8485046506482, -337.54279533326405, -648.4811918786174, -682.083182137269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2774248409463577, "mean_inference_ms": 0.8728746954576274, "mean_action_processing_ms": 0.16040221627576134, "mean_env_wait_ms": 1.5203108770308138, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054439801848336555, "StateBufferConnector_ms": 0.004124373532413097, "ViewRequirementAgentConnector_ms": 0.09506230943658378}, "num_episodes": 31, "episode_return_max": -27.76215940738079, "episode_return_min": -1224.7696717378237, "episode_return_mean": -665.8250536709019, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.6915448435792, "num_env_steps_trained_throughput_per_sec": 290.6915448435792, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13856.634, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13856.568, "sample_time_ms": 2325.612, "learn_time_ms": 11515.223, "learn_throughput": 347.366, "synch_weights_time_ms": 14.986}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00002", "date": "2024-08-03_04-32-51", "timestamp": 1722639771, "time_this_iter_s": 13.76780891418457, "time_total_s": 41.59117650985718, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78e440>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 41.59117650985718, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.554999999999998, "ram_util_percent": 16.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.52585175242275, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.23510071784258, "policy_loss": -0.011221049379673786, "vf_loss": 8.244713724652927, "vf_explained_var": 0.5754863927140832, "kl": 0.01595367743432235, "entropy": 1.5826877341916163, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -3.7913783731518476, "episode_reward_min": -1344.1202918452075, "episode_reward_mean": -676.5245544008359, "episode_len_mean": 132.89, "episode_media": {}, "episodes_timesteps_total": 13289, "policy_reward_min": {"policy_0": -1344.1202918452075}, "policy_reward_max": {"policy_0": -3.7913783731518476}, "policy_reward_mean": {"policy_0": -676.5245544008359}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-511.22291154026044, -332.20539983859237, -612.4003249622539, -272.51625392273206, -868.2225334308812, -64.02889466034196, -827.6292771871096, -248.07902699888382, -207.90755553097807, -402.12551873562074, -862.3413501383333, -1090.07513570772, -832.4049891093105, -1099.9994235933866, -133.07749362957307, -96.3119476160094, -801.4256208317398, -337.23454354582503, -560.2974962542486, -1047.5386236942015, -119.93026318138412, -88.84156896614516, -872.3629037489565, -906.0118705857079, -759.1247854043233, -1055.2580018119986, -544.1639897245238, -590.8361999425864, -700.1865937767449, -1015.6636378176285, -355.7163554490583, -363.3702219754497, -912.2174979732446, -881.3760325995792, -770.0240653627585, -308.0037355882369, -594.4860083746847, -1055.653487510601, -846.3517608392402, -975.4901397705953, -664.8859281975624, -528.002195550312, -267.95299031945456, -921.5981904249576, -760.9152809445624, -30.127537610005863, -647.7008316857407, -752.5551343755484, -359.7933099802987, -27.76215940738079, -782.5861580850375, -671.5416153955965, -540.8606019755489, -719.9981357241506, -987.1486348324622, -435.4944785107249, -1106.5248464261872, -355.9015474483427, -1089.8347268232094, -872.7610932385791, -105.8666793057244, -1033.1918323465559, -109.26722799999308, -730.2478710192592, -1224.7696717378237, -858.06604991997, -565.4897990039713, -1048.8485046506482, -337.54279533326405, -648.4811918786174, -682.083182137269, -300.91193780908776, -1150.6623576891936, -840.8883428519742, -864.1433692351167, -3.7913783731518476, -1002.9950235545558, -835.6514862431048, -381.21840588516744, -177.7868039466657, -999.1187188304864, -715.533825056737, -950.6517518995481, -1344.1202918452075, -952.5506212954328, -875.3024475147563, -729.0793966224687, -1011.8251907527796, -378.41881314391173, -15.62243850263626, -783.7381536099824, -805.7084087672882, -759.4241425558772, -939.8668853328963, -829.9683342559227, -1265.4384165503554, -899.8833188082947, -670.2529542694887, -1097.5042108181165, -1280.4843704431723], "episode_lengths": [150, 116, 150, 92, 150, 48, 150, 70, 67, 150, 150, 150, 150, 150, 68, 63, 150, 95, 150, 150, 57, 97, 150, 150, 150, 150, 120, 145, 150, 150, 145, 108, 150, 150, 150, 127, 150, 150, 150, 150, 141, 131, 85, 150, 150, 39, 150, 150, 108, 38, 150, 150, 110, 150, 150, 150, 150, 112, 150, 150, 79, 150, 82, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 49, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-511.22291154026044, -332.20539983859237, -612.4003249622539, -272.51625392273206, -868.2225334308812, -64.02889466034196, -827.6292771871096, -248.07902699888382, -207.90755553097807, -402.12551873562074, -862.3413501383333, -1090.07513570772, -832.4049891093105, -1099.9994235933866, -133.07749362957307, -96.3119476160094, -801.4256208317398, -337.23454354582503, -560.2974962542486, -1047.5386236942015, -119.93026318138412, -88.84156896614516, -872.3629037489565, -906.0118705857079, -759.1247854043233, -1055.2580018119986, -544.1639897245238, -590.8361999425864, -700.1865937767449, -1015.6636378176285, -355.7163554490583, -363.3702219754497, -912.2174979732446, -881.3760325995792, -770.0240653627585, -308.0037355882369, -594.4860083746847, -1055.653487510601, -846.3517608392402, -975.4901397705953, -664.8859281975624, -528.002195550312, -267.95299031945456, -921.5981904249576, -760.9152809445624, -30.127537610005863, -647.7008316857407, -752.5551343755484, -359.7933099802987, -27.76215940738079, -782.5861580850375, -671.5416153955965, -540.8606019755489, -719.9981357241506, -987.1486348324622, -435.4944785107249, -1106.5248464261872, -355.9015474483427, -1089.8347268232094, -872.7610932385791, -105.8666793057244, -1033.1918323465559, -109.26722799999308, -730.2478710192592, -1224.7696717378237, -858.06604991997, -565.4897990039713, -1048.8485046506482, -337.54279533326405, -648.4811918786174, -682.083182137269, -300.91193780908776, -1150.6623576891936, -840.8883428519742, -864.1433692351167, -3.7913783731518476, -1002.9950235545558, -835.6514862431048, -381.21840588516744, -177.7868039466657, -999.1187188304864, -715.533825056737, -950.6517518995481, -1344.1202918452075, -952.5506212954328, -875.3024475147563, -729.0793966224687, -1011.8251907527796, -378.41881314391173, -15.62243850263626, -783.7381536099824, -805.7084087672882, -759.4241425558772, -939.8668853328963, -829.9683342559227, -1265.4384165503554, -899.8833188082947, -670.2529542694887, -1097.5042108181165, -1280.4843704431723]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27697598841330395, "mean_inference_ms": 0.8736902579544883, "mean_action_processing_ms": 0.160164365697098, "mean_env_wait_ms": 1.5238287851650498, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051441192626953125, "StateBufferConnector_ms": 0.0040628910064697266, "ViewRequirementAgentConnector_ms": 0.09693002700805664}, "num_episodes": 29, "episode_return_max": -3.7913783731518476, "episode_return_min": -1344.1202918452075, "episode_return_mean": -676.5245544008359, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.7698375671083, "num_env_steps_trained_throughput_per_sec": 308.7698375671083, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13631.142, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13631.071, "sample_time_ms": 2333.414, "learn_time_ms": 11281.558, "learn_throughput": 354.561, "synch_weights_time_ms": 15.342}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00002", "date": "2024-08-03_04-33-04", "timestamp": 1722639784, "time_this_iter_s": 12.962401151657104, "time_total_s": 54.55357766151428, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814d480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 54.55357766151428, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 12.93888888888889, "ram_util_percent": 16.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 60.02869000633557, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.345124225566784, "policy_loss": -0.010174830006629538, "vf_loss": 6.35342668145895, "vf_explained_var": 0.677127089475592, "kl": 0.01670743556048062, "entropy": 1.4691059485077858, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -3.7913783731518476, "episode_reward_min": -1344.1202918452075, "episode_reward_mean": -704.8416568213258, "episode_len_mean": 136.76, "episode_media": {}, "episodes_timesteps_total": 13676, "policy_reward_min": {"policy_0": -1344.1202918452075}, "policy_reward_max": {"policy_0": -3.7913783731518476}, "policy_reward_mean": {"policy_0": -704.8416568213258}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1015.6636378176285, -355.7163554490583, -363.3702219754497, -912.2174979732446, -881.3760325995792, -770.0240653627585, -308.0037355882369, -594.4860083746847, -1055.653487510601, -846.3517608392402, -975.4901397705953, -664.8859281975624, -528.002195550312, -267.95299031945456, -921.5981904249576, -760.9152809445624, -30.127537610005863, -647.7008316857407, -752.5551343755484, -359.7933099802987, -27.76215940738079, -782.5861580850375, -671.5416153955965, -540.8606019755489, -719.9981357241506, -987.1486348324622, -435.4944785107249, -1106.5248464261872, -355.9015474483427, -1089.8347268232094, -872.7610932385791, -105.8666793057244, -1033.1918323465559, -109.26722799999308, -730.2478710192592, -1224.7696717378237, -858.06604991997, -565.4897990039713, -1048.8485046506482, -337.54279533326405, -648.4811918786174, -682.083182137269, -300.91193780908776, -1150.6623576891936, -840.8883428519742, -864.1433692351167, -3.7913783731518476, -1002.9950235545558, -835.6514862431048, -381.21840588516744, -177.7868039466657, -999.1187188304864, -715.533825056737, -950.6517518995481, -1344.1202918452075, -952.5506212954328, -875.3024475147563, -729.0793966224687, -1011.8251907527796, -378.41881314391173, -15.62243850263626, -783.7381536099824, -805.7084087672882, -759.4241425558772, -939.8668853328963, -829.9683342559227, -1265.4384165503554, -899.8833188082947, -670.2529542694887, -1097.5042108181165, -1280.4843704431723, -601.2192147605336, -674.7631277294344, -645.2008219509595, -447.6269172864287, -848.2787666375301, -159.07749104326086, -35.64387617560719, -461.2778039607463, -821.956720878699, -1243.0119761648816, -1070.4836544496056, -456.3492694401831, -1065.9308635547195, -689.6624167460996, -1109.5482835131866, -932.6830536288427, -570.0454776194899, -827.1308062564414, -634.2154742273658, -618.159287790707, -794.5511719767518, -1091.7495202351427, -759.4090545232519, -254.5459017856913, -1071.9269855035675, -390.759268481914, -72.16295129452959, -586.6000530796938, -741.5005294241233], "episode_lengths": [150, 145, 108, 150, 150, 150, 127, 150, 150, 150, 150, 141, 131, 85, 150, 150, 39, 150, 150, 108, 38, 150, 150, 110, 150, 150, 150, 150, 112, 150, 150, 79, 150, 82, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 49, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 50, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 104, 56, 150, 150], "policy_policy_0_reward": [-1015.6636378176285, -355.7163554490583, -363.3702219754497, -912.2174979732446, -881.3760325995792, -770.0240653627585, -308.0037355882369, -594.4860083746847, -1055.653487510601, -846.3517608392402, -975.4901397705953, -664.8859281975624, -528.002195550312, -267.95299031945456, -921.5981904249576, -760.9152809445624, -30.127537610005863, -647.7008316857407, -752.5551343755484, -359.7933099802987, -27.76215940738079, -782.5861580850375, -671.5416153955965, -540.8606019755489, -719.9981357241506, -987.1486348324622, -435.4944785107249, -1106.5248464261872, -355.9015474483427, -1089.8347268232094, -872.7610932385791, -105.8666793057244, -1033.1918323465559, -109.26722799999308, -730.2478710192592, -1224.7696717378237, -858.06604991997, -565.4897990039713, -1048.8485046506482, -337.54279533326405, -648.4811918786174, -682.083182137269, -300.91193780908776, -1150.6623576891936, -840.8883428519742, -864.1433692351167, -3.7913783731518476, -1002.9950235545558, -835.6514862431048, -381.21840588516744, -177.7868039466657, -999.1187188304864, -715.533825056737, -950.6517518995481, -1344.1202918452075, -952.5506212954328, -875.3024475147563, -729.0793966224687, -1011.8251907527796, -378.41881314391173, -15.62243850263626, -783.7381536099824, -805.7084087672882, -759.4241425558772, -939.8668853328963, -829.9683342559227, -1265.4384165503554, -899.8833188082947, -670.2529542694887, -1097.5042108181165, -1280.4843704431723, -601.2192147605336, -674.7631277294344, -645.2008219509595, -447.6269172864287, -848.2787666375301, -159.07749104326086, -35.64387617560719, -461.2778039607463, -821.956720878699, -1243.0119761648816, -1070.4836544496056, -456.3492694401831, -1065.9308635547195, -689.6624167460996, -1109.5482835131866, -932.6830536288427, -570.0454776194899, -827.1308062564414, -634.2154742273658, -618.159287790707, -794.5511719767518, -1091.7495202351427, -759.4090545232519, -254.5459017856913, -1071.9269855035675, -390.759268481914, -72.16295129452959, -586.6000530796938, -741.5005294241233]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2761473543586378, "mean_inference_ms": 0.8722736431952407, "mean_action_processing_ms": 0.1595151529530006, "mean_env_wait_ms": 1.521822962140412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005049943923950195, "StateBufferConnector_ms": 0.003994464874267578, "ViewRequirementAgentConnector_ms": 0.09726548194885254}, "num_episodes": 29, "episode_return_max": -3.7913783731518476, "episode_return_min": -1344.1202918452075, "episode_return_mean": -704.8416568213258, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.5803151059693, "num_env_steps_trained_throughput_per_sec": 288.5803151059693, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13677.108, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13677.038, "sample_time_ms": 2325.261, "learn_time_ms": 11335.703, "learn_throughput": 352.867, "synch_weights_time_ms": 15.325}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00002", "date": "2024-08-03_04-33-18", "timestamp": 1722639798, "time_this_iter_s": 13.868881940841675, "time_total_s": 68.42245960235596, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580eadd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 68.42245960235596, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.559999999999999, "ram_util_percent": 16.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 74.64626518189907, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.3755568022529285, "policy_loss": -0.006835976054814333, "vf_loss": 5.3812143112222355, "vf_explained_var": 0.8418520473564665, "kl": 0.013336037711997057, "entropy": 1.4887425363063813, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -3.7913783731518476, "episode_reward_min": -1344.1202918452075, "episode_reward_mean": -705.5112634892101, "episode_len_mean": 137.23, "episode_media": {}, "episodes_timesteps_total": 13723, "policy_reward_min": {"policy_0": -1344.1202918452075}, "policy_reward_max": {"policy_0": -3.7913783731518476}, "policy_reward_mean": {"policy_0": -705.5112634892101}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1089.8347268232094, -872.7610932385791, -105.8666793057244, -1033.1918323465559, -109.26722799999308, -730.2478710192592, -1224.7696717378237, -858.06604991997, -565.4897990039713, -1048.8485046506482, -337.54279533326405, -648.4811918786174, -682.083182137269, -300.91193780908776, -1150.6623576891936, -840.8883428519742, -864.1433692351167, -3.7913783731518476, -1002.9950235545558, -835.6514862431048, -381.21840588516744, -177.7868039466657, -999.1187188304864, -715.533825056737, -950.6517518995481, -1344.1202918452075, -952.5506212954328, -875.3024475147563, -729.0793966224687, -1011.8251907527796, -378.41881314391173, -15.62243850263626, -783.7381536099824, -805.7084087672882, -759.4241425558772, -939.8668853328963, -829.9683342559227, -1265.4384165503554, -899.8833188082947, -670.2529542694887, -1097.5042108181165, -1280.4843704431723, -601.2192147605336, -674.7631277294344, -645.2008219509595, -447.6269172864287, -848.2787666375301, -159.07749104326086, -35.64387617560719, -461.2778039607463, -821.956720878699, -1243.0119761648816, -1070.4836544496056, -456.3492694401831, -1065.9308635547195, -689.6624167460996, -1109.5482835131866, -932.6830536288427, -570.0454776194899, -827.1308062564414, -634.2154742273658, -618.159287790707, -794.5511719767518, -1091.7495202351427, -759.4090545232519, -254.5459017856913, -1071.9269855035675, -390.759268481914, -72.16295129452959, -586.6000530796938, -741.5005294241233, -135.70380056750432, -344.72692544314305, -949.9438381125757, -554.2566085586182, -28.129613490593208, -292.2763947074187, -359.28452138494407, -781.0823162539566, -311.3510303936176, -1267.9643977694927, -364.29784402514355, -928.2895008467117, -952.3636772526659, -546.6050563665096, -694.2625058407407, -656.0264154973626, -245.9508635823134, -230.88194197968315, -683.4737113778398, -1074.8492162656028, -587.3395275356563, -937.4663588456814, -548.1320885127257, -36.10643652561304, -1274.9038851789537, -1030.5967814076996, -1041.0331216473783, -596.1485811801667, -1253.2162263930477], "episode_lengths": [150, 150, 79, 150, 82, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 150, 150, 49, 150, 150, 117, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 50, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 104, 56, 150, 150, 73, 117, 150, 150, 57, 150, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 113, 55, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1089.8347268232094, -872.7610932385791, -105.8666793057244, -1033.1918323465559, -109.26722799999308, -730.2478710192592, -1224.7696717378237, -858.06604991997, -565.4897990039713, -1048.8485046506482, -337.54279533326405, -648.4811918786174, -682.083182137269, -300.91193780908776, -1150.6623576891936, -840.8883428519742, -864.1433692351167, -3.7913783731518476, -1002.9950235545558, -835.6514862431048, -381.21840588516744, -177.7868039466657, -999.1187188304864, -715.533825056737, -950.6517518995481, -1344.1202918452075, -952.5506212954328, -875.3024475147563, -729.0793966224687, -1011.8251907527796, -378.41881314391173, -15.62243850263626, -783.7381536099824, -805.7084087672882, -759.4241425558772, -939.8668853328963, -829.9683342559227, -1265.4384165503554, -899.8833188082947, -670.2529542694887, -1097.5042108181165, -1280.4843704431723, -601.2192147605336, -674.7631277294344, -645.2008219509595, -447.6269172864287, -848.2787666375301, -159.07749104326086, -35.64387617560719, -461.2778039607463, -821.956720878699, -1243.0119761648816, -1070.4836544496056, -456.3492694401831, -1065.9308635547195, -689.6624167460996, -1109.5482835131866, -932.6830536288427, -570.0454776194899, -827.1308062564414, -634.2154742273658, -618.159287790707, -794.5511719767518, -1091.7495202351427, -759.4090545232519, -254.5459017856913, -1071.9269855035675, -390.759268481914, -72.16295129452959, -586.6000530796938, -741.5005294241233, -135.70380056750432, -344.72692544314305, -949.9438381125757, -554.2566085586182, -28.129613490593208, -292.2763947074187, -359.28452138494407, -781.0823162539566, -311.3510303936176, -1267.9643977694927, -364.29784402514355, -928.2895008467117, -952.3636772526659, -546.6050563665096, -694.2625058407407, -656.0264154973626, -245.9508635823134, -230.88194197968315, -683.4737113778398, -1074.8492162656028, -587.3395275356563, -937.4663588456814, -548.1320885127257, -36.10643652561304, -1274.9038851789537, -1030.5967814076996, -1041.0331216473783, -596.1485811801667, -1253.2162263930477]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27600589107750423, "mean_inference_ms": 0.8711331698452056, "mean_action_processing_ms": 0.15905750529048257, "mean_env_wait_ms": 1.522732665717888, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0049211978912353516, "StateBufferConnector_ms": 0.003978729248046875, "ViewRequirementAgentConnector_ms": 0.09794473648071289}, "num_episodes": 29, "episode_return_max": -3.7913783731518476, "episode_return_min": -1344.1202918452075, "episode_return_mean": -705.5112634892101, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 278.2406475147179, "num_env_steps_trained_throughput_per_sec": 278.2406475147179, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 13793.6, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13793.53, "sample_time_ms": 2334.704, "learn_time_ms": 11442.754, "learn_throughput": 349.566, "synch_weights_time_ms": 15.312}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00002", "date": "2024-08-03_04-33-32", "timestamp": 1722639812, "time_this_iter_s": 14.38375735282898, "time_total_s": 82.80621695518494, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814ef80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 82.80621695518494, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.557142857142859, "ram_util_percent": 16.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.97345603307089, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.298565641293923, "policy_loss": -0.013716766536526847, "vf_loss": 5.310245665659507, "vf_explained_var": 0.7997051728268464, "kl": 0.01821409451428433, "entropy": 1.6060739799092214, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -15.62243850263626, "episode_reward_min": -1336.3968659185298, "episode_reward_mean": -705.5694135709574, "episode_len_mean": 137.63, "episode_media": {}, "episodes_timesteps_total": 13763, "policy_reward_min": {"policy_0": -1336.3968659185298}, "policy_reward_max": {"policy_0": -15.62243850263626}, "policy_reward_mean": {"policy_0": -705.5694135709574}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1011.8251907527796, -378.41881314391173, -15.62243850263626, -783.7381536099824, -805.7084087672882, -759.4241425558772, -939.8668853328963, -829.9683342559227, -1265.4384165503554, -899.8833188082947, -670.2529542694887, -1097.5042108181165, -1280.4843704431723, -601.2192147605336, -674.7631277294344, -645.2008219509595, -447.6269172864287, -848.2787666375301, -159.07749104326086, -35.64387617560719, -461.2778039607463, -821.956720878699, -1243.0119761648816, -1070.4836544496056, -456.3492694401831, -1065.9308635547195, -689.6624167460996, -1109.5482835131866, -932.6830536288427, -570.0454776194899, -827.1308062564414, -634.2154742273658, -618.159287790707, -794.5511719767518, -1091.7495202351427, -759.4090545232519, -254.5459017856913, -1071.9269855035675, -390.759268481914, -72.16295129452959, -586.6000530796938, -741.5005294241233, -135.70380056750432, -344.72692544314305, -949.9438381125757, -554.2566085586182, -28.129613490593208, -292.2763947074187, -359.28452138494407, -781.0823162539566, -311.3510303936176, -1267.9643977694927, -364.29784402514355, -928.2895008467117, -952.3636772526659, -546.6050563665096, -694.2625058407407, -656.0264154973626, -245.9508635823134, -230.88194197968315, -683.4737113778398, -1074.8492162656028, -587.3395275356563, -937.4663588456814, -548.1320885127257, -36.10643652561304, -1274.9038851789537, -1030.5967814076996, -1041.0331216473783, -596.1485811801667, -1253.2162263930477, -337.4718411270634, -226.18776125133476, -1196.6676884481608, -564.4905524742657, -941.3265875726436, -1119.6406085310412, -963.1805813900936, -1001.0294641598612, -634.664044795885, -741.501820193672, -623.3202829938116, -574.9482708968254, -725.0600944579679, -963.3876350124372, -810.1885985453316, -910.8069537737788, -649.9764657122334, -763.6605179057922, -1071.2585233972445, -161.20301039413627, -627.650797665566, -665.5674349283737, -1336.3968659185298, -516.939574021002, -658.1680690691696, -773.6635259869805, -673.379888574229, -892.5656781151356, -312.3686549097008], "episode_lengths": [150, 129, 35, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 50, 111, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 104, 56, 150, 150, 73, 117, 150, 150, 57, 150, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 113, 55, 150, 150, 150, 150, 150, 90, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 110, 150, 150, 130, 150, 96], "policy_policy_0_reward": [-1011.8251907527796, -378.41881314391173, -15.62243850263626, -783.7381536099824, -805.7084087672882, -759.4241425558772, -939.8668853328963, -829.9683342559227, -1265.4384165503554, -899.8833188082947, -670.2529542694887, -1097.5042108181165, -1280.4843704431723, -601.2192147605336, -674.7631277294344, -645.2008219509595, -447.6269172864287, -848.2787666375301, -159.07749104326086, -35.64387617560719, -461.2778039607463, -821.956720878699, -1243.0119761648816, -1070.4836544496056, -456.3492694401831, -1065.9308635547195, -689.6624167460996, -1109.5482835131866, -932.6830536288427, -570.0454776194899, -827.1308062564414, -634.2154742273658, -618.159287790707, -794.5511719767518, -1091.7495202351427, -759.4090545232519, -254.5459017856913, -1071.9269855035675, -390.759268481914, -72.16295129452959, -586.6000530796938, -741.5005294241233, -135.70380056750432, -344.72692544314305, -949.9438381125757, -554.2566085586182, -28.129613490593208, -292.2763947074187, -359.28452138494407, -781.0823162539566, -311.3510303936176, -1267.9643977694927, -364.29784402514355, -928.2895008467117, -952.3636772526659, -546.6050563665096, -694.2625058407407, -656.0264154973626, -245.9508635823134, -230.88194197968315, -683.4737113778398, -1074.8492162656028, -587.3395275356563, -937.4663588456814, -548.1320885127257, -36.10643652561304, -1274.9038851789537, -1030.5967814076996, -1041.0331216473783, -596.1485811801667, -1253.2162263930477, -337.4718411270634, -226.18776125133476, -1196.6676884481608, -564.4905524742657, -941.3265875726436, -1119.6406085310412, -963.1805813900936, -1001.0294641598612, -634.664044795885, -741.501820193672, -623.3202829938116, -574.9482708968254, -725.0600944579679, -963.3876350124372, -810.1885985453316, -910.8069537737788, -649.9764657122334, -763.6605179057922, -1071.2585233972445, -161.20301039413627, -627.650797665566, -665.5674349283737, -1336.3968659185298, -516.939574021002, -658.1680690691696, -773.6635259869805, -673.379888574229, -892.5656781151356, -312.3686549097008]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2758606410248832, "mean_inference_ms": 0.8725233652062303, "mean_action_processing_ms": 0.1587669467520682, "mean_env_wait_ms": 1.5227672667648688, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0048370361328125, "StateBufferConnector_ms": 0.00393986701965332, "ViewRequirementAgentConnector_ms": 0.0964665412902832}, "num_episodes": 29, "episode_return_max": -15.62243850263626, "episode_return_min": -1336.3968659185298, "episode_return_mean": -705.5694135709574, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 279.0938166518798, "num_env_steps_trained_throughput_per_sec": 279.0938166518798, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 13870.53, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13870.459, "sample_time_ms": 2357.624, "learn_time_ms": 11496.645, "learn_throughput": 347.928, "synch_weights_time_ms": 15.374}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00002", "date": "2024-08-03_04-33-46", "timestamp": 1722639826, "time_this_iter_s": 14.337347984313965, "time_total_s": 97.1435649394989, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580e9d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 97.1435649394989, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 12.74, "ram_util_percent": 16.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 92.84206116000811, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.264835193256537, "policy_loss": -0.01702716430784979, "vf_loss": 6.279368711511294, "vf_explained_var": 0.8607681040341656, "kl": 0.02081413523234612, "entropy": 1.6691892492274443, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -28.129613490593208, "episode_reward_min": -1336.3968659185298, "episode_reward_mean": -727.7263061073539, "episode_len_mean": 139.2, "episode_media": {}, "episodes_timesteps_total": 13920, "policy_reward_min": {"policy_0": -1336.3968659185298}, "policy_reward_max": {"policy_0": -28.129613490593208}, "policy_reward_mean": {"policy_0": -727.7263061073539}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1109.5482835131866, -932.6830536288427, -570.0454776194899, -827.1308062564414, -634.2154742273658, -618.159287790707, -794.5511719767518, -1091.7495202351427, -759.4090545232519, -254.5459017856913, -1071.9269855035675, -390.759268481914, -72.16295129452959, -586.6000530796938, -741.5005294241233, -135.70380056750432, -344.72692544314305, -949.9438381125757, -554.2566085586182, -28.129613490593208, -292.2763947074187, -359.28452138494407, -781.0823162539566, -311.3510303936176, -1267.9643977694927, -364.29784402514355, -928.2895008467117, -952.3636772526659, -546.6050563665096, -694.2625058407407, -656.0264154973626, -245.9508635823134, -230.88194197968315, -683.4737113778398, -1074.8492162656028, -587.3395275356563, -937.4663588456814, -548.1320885127257, -36.10643652561304, -1274.9038851789537, -1030.5967814076996, -1041.0331216473783, -596.1485811801667, -1253.2162263930477, -337.4718411270634, -226.18776125133476, -1196.6676884481608, -564.4905524742657, -941.3265875726436, -1119.6406085310412, -963.1805813900936, -1001.0294641598612, -634.664044795885, -741.501820193672, -623.3202829938116, -574.9482708968254, -725.0600944579679, -963.3876350124372, -810.1885985453316, -910.8069537737788, -649.9764657122334, -763.6605179057922, -1071.2585233972445, -161.20301039413627, -627.650797665566, -665.5674349283737, -1336.3968659185298, -516.939574021002, -658.1680690691696, -773.6635259869805, -673.379888574229, -892.5656781151356, -312.3686549097008, -1054.4463281265914, -1116.873986808369, -1270.811550677455, -561.9813759735478, -811.4405123240449, -466.8463335332854, -739.0859409260704, -776.4866282964063, -1091.0044287360154, -1009.1236600839467, -1006.7410413872291, -862.3007639020271, -36.55083309204916, -79.16826844987357, -1290.1050571102448, -210.70004558583656, -971.6086252566464, -1316.379642977264, -986.2078295766462, -1226.3006378886435, -580.5363995376291, -901.7493172811606, -950.581727421176, -1059.3032002859143, -638.7080172357428, -782.8537350685531, -376.4119246866983], "episode_lengths": [150, 150, 150, 150, 144, 150, 150, 150, 150, 150, 150, 104, 56, 150, 150, 73, 117, 150, 150, 57, 150, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 113, 55, 150, 150, 150, 150, 150, 90, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 110, 150, 150, 130, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 71, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140], "policy_policy_0_reward": [-1109.5482835131866, -932.6830536288427, -570.0454776194899, -827.1308062564414, -634.2154742273658, -618.159287790707, -794.5511719767518, -1091.7495202351427, -759.4090545232519, -254.5459017856913, -1071.9269855035675, -390.759268481914, -72.16295129452959, -586.6000530796938, -741.5005294241233, -135.70380056750432, -344.72692544314305, -949.9438381125757, -554.2566085586182, -28.129613490593208, -292.2763947074187, -359.28452138494407, -781.0823162539566, -311.3510303936176, -1267.9643977694927, -364.29784402514355, -928.2895008467117, -952.3636772526659, -546.6050563665096, -694.2625058407407, -656.0264154973626, -245.9508635823134, -230.88194197968315, -683.4737113778398, -1074.8492162656028, -587.3395275356563, -937.4663588456814, -548.1320885127257, -36.10643652561304, -1274.9038851789537, -1030.5967814076996, -1041.0331216473783, -596.1485811801667, -1253.2162263930477, -337.4718411270634, -226.18776125133476, -1196.6676884481608, -564.4905524742657, -941.3265875726436, -1119.6406085310412, -963.1805813900936, -1001.0294641598612, -634.664044795885, -741.501820193672, -623.3202829938116, -574.9482708968254, -725.0600944579679, -963.3876350124372, -810.1885985453316, -910.8069537737788, -649.9764657122334, -763.6605179057922, -1071.2585233972445, -161.20301039413627, -627.650797665566, -665.5674349283737, -1336.3968659185298, -516.939574021002, -658.1680690691696, -773.6635259869805, -673.379888574229, -892.5656781151356, -312.3686549097008, -1054.4463281265914, -1116.873986808369, -1270.811550677455, -561.9813759735478, -811.4405123240449, -466.8463335332854, -739.0859409260704, -776.4866282964063, -1091.0044287360154, -1009.1236600839467, -1006.7410413872291, -862.3007639020271, -36.55083309204916, -79.16826844987357, -1290.1050571102448, -210.70004558583656, -971.6086252566464, -1316.379642977264, -986.2078295766462, -1226.3006378886435, -580.5363995376291, -901.7493172811606, -950.581727421176, -1059.3032002859143, -638.7080172357428, -782.8537350685531, -376.4119246866983]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2756411046459859, "mean_inference_ms": 0.8775129214946082, "mean_action_processing_ms": 0.15834487247315546, "mean_env_wait_ms": 1.525648553664584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004924774169921875, "StateBufferConnector_ms": 0.003926515579223633, "ViewRequirementAgentConnector_ms": 0.09584331512451172}, "num_episodes": 27, "episode_return_max": -28.129613490593208, "episode_return_min": -1336.3968659185298, "episode_return_mean": -727.7263061073539, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 286.3821697209608, "num_env_steps_trained_throughput_per_sec": 286.3821697209608, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13882.634, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13882.564, "sample_time_ms": 2379.126, "learn_time_ms": 11486.895, "learn_throughput": 348.223, "synch_weights_time_ms": 15.68}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00002", "date": "2024-08-03_04-34-00", "timestamp": 1722639840, "time_this_iter_s": 13.972664833068848, "time_total_s": 111.11622977256775, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580e8310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 111.11622977256775, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 12.735, "ram_util_percent": 16.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 140.96161012053489, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.169013128678004, "policy_loss": -0.008739747221989091, "vf_loss": 5.174749767531951, "vf_explained_var": 0.9276701228072246, "kl": 0.01541990868205783, "entropy": 1.6228637150178353, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -30.480685490492004, "episode_reward_min": -1336.3968659185298, "episode_reward_mean": -747.5679784194207, "episode_len_mean": 138.66, "episode_media": {}, "episodes_timesteps_total": 13866, "policy_reward_min": {"policy_0": -1336.3968659185298}, "policy_reward_max": {"policy_0": -30.480685490492004}, "policy_reward_mean": {"policy_0": -747.5679784194207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-656.0264154973626, -245.9508635823134, -230.88194197968315, -683.4737113778398, -1074.8492162656028, -587.3395275356563, -937.4663588456814, -548.1320885127257, -36.10643652561304, -1274.9038851789537, -1030.5967814076996, -1041.0331216473783, -596.1485811801667, -1253.2162263930477, -337.4718411270634, -226.18776125133476, -1196.6676884481608, -564.4905524742657, -941.3265875726436, -1119.6406085310412, -963.1805813900936, -1001.0294641598612, -634.664044795885, -741.501820193672, -623.3202829938116, -574.9482708968254, -725.0600944579679, -963.3876350124372, -810.1885985453316, -910.8069537737788, -649.9764657122334, -763.6605179057922, -1071.2585233972445, -161.20301039413627, -627.650797665566, -665.5674349283737, -1336.3968659185298, -516.939574021002, -658.1680690691696, -773.6635259869805, -673.379888574229, -892.5656781151356, -312.3686549097008, -1054.4463281265914, -1116.873986808369, -1270.811550677455, -561.9813759735478, -811.4405123240449, -466.8463335332854, -739.0859409260704, -776.4866282964063, -1091.0044287360154, -1009.1236600839467, -1006.7410413872291, -862.3007639020271, -36.55083309204916, -79.16826844987357, -1290.1050571102448, -210.70004558583656, -971.6086252566464, -1316.379642977264, -986.2078295766462, -1226.3006378886435, -580.5363995376291, -901.7493172811606, -950.581727421176, -1059.3032002859143, -638.7080172357428, -782.8537350685531, -376.4119246866983, -721.9578272498455, -42.450145005868904, -565.6020925134596, -1146.3413440950574, -201.71373679012012, -891.5225726133444, -106.70070970947981, -734.341033393942, -829.9326317700416, -576.9437522130517, -1083.047806379057, -793.4901909945852, -303.4910267613244, -1077.5241697296842, -360.9375924546836, -1021.2408267967954, -392.33179447387397, -895.6842735113596, -718.690537194975, -754.2308989411081, -1083.0104806341517, -358.2802524612916, -942.7987219348265, -860.3743962276932, -1136.562653316676, -1082.902294499438, -586.1104780124979, -884.9635528792802, -766.0346035130126, -30.480685490492004], "episode_lengths": [150, 150, 85, 150, 150, 150, 150, 113, 55, 150, 150, 150, 150, 150, 90, 114, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 110, 150, 150, 130, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 71, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 49, 150, 150, 99, 150, 52, 150, 150, 134, 150, 150, 118, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40], "policy_policy_0_reward": [-656.0264154973626, -245.9508635823134, -230.88194197968315, -683.4737113778398, -1074.8492162656028, -587.3395275356563, -937.4663588456814, -548.1320885127257, -36.10643652561304, -1274.9038851789537, -1030.5967814076996, -1041.0331216473783, -596.1485811801667, -1253.2162263930477, -337.4718411270634, -226.18776125133476, -1196.6676884481608, -564.4905524742657, -941.3265875726436, -1119.6406085310412, -963.1805813900936, -1001.0294641598612, -634.664044795885, -741.501820193672, -623.3202829938116, -574.9482708968254, -725.0600944579679, -963.3876350124372, -810.1885985453316, -910.8069537737788, -649.9764657122334, -763.6605179057922, -1071.2585233972445, -161.20301039413627, -627.650797665566, -665.5674349283737, -1336.3968659185298, -516.939574021002, -658.1680690691696, -773.6635259869805, -673.379888574229, -892.5656781151356, -312.3686549097008, -1054.4463281265914, -1116.873986808369, -1270.811550677455, -561.9813759735478, -811.4405123240449, -466.8463335332854, -739.0859409260704, -776.4866282964063, -1091.0044287360154, -1009.1236600839467, -1006.7410413872291, -862.3007639020271, -36.55083309204916, -79.16826844987357, -1290.1050571102448, -210.70004558583656, -971.6086252566464, -1316.379642977264, -986.2078295766462, -1226.3006378886435, -580.5363995376291, -901.7493172811606, -950.581727421176, -1059.3032002859143, -638.7080172357428, -782.8537350685531, -376.4119246866983, -721.9578272498455, -42.450145005868904, -565.6020925134596, -1146.3413440950574, -201.71373679012012, -891.5225726133444, -106.70070970947981, -734.341033393942, -829.9326317700416, -576.9437522130517, -1083.047806379057, -793.4901909945852, -303.4910267613244, -1077.5241697296842, -360.9375924546836, -1021.2408267967954, -392.33179447387397, -895.6842735113596, -718.690537194975, -754.2308989411081, -1083.0104806341517, -358.2802524612916, -942.7987219348265, -860.3743962276932, -1136.562653316676, -1082.902294499438, -586.1104780124979, -884.9635528792802, -766.0346035130126, -30.480685490492004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2753637543846816, "mean_inference_ms": 0.8831990436570061, "mean_action_processing_ms": 0.15809545033788036, "mean_env_wait_ms": 1.5271842518097674, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005099058151245117, "StateBufferConnector_ms": 0.003927946090698242, "ViewRequirementAgentConnector_ms": 0.09588980674743652}, "num_episodes": 30, "episode_return_max": -30.480685490492004, "episode_return_min": -1336.3968659185298, "episode_return_mean": -747.5679784194207, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.6186841302589, "num_env_steps_trained_throughput_per_sec": 291.6186841302589, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 13864.181, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13864.111, "sample_time_ms": 2368.901, "learn_time_ms": 11478.822, "learn_throughput": 348.468, "synch_weights_time_ms": 15.491}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00002", "date": "2024-08-03_04-34-14", "timestamp": 1722639854, "time_this_iter_s": 13.721657037734985, "time_total_s": 124.83788681030273, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580e9510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 124.83788681030273, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 12.768421052631581, "ram_util_percent": 16.10526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 124.16823514103889, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.950230296204487, "policy_loss": -0.01285342912451597, "vf_loss": 4.960328308492899, "vf_explained_var": 0.9507125806684296, "kl": 0.014380038820066459, "entropy": 1.5586035107572873, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -30.480685490492004, "episode_reward_min": -1502.4423016927487, "episode_reward_mean": -731.1053784686023, "episode_len_mean": 137.99, "episode_media": {}, "episodes_timesteps_total": 13799, "policy_reward_min": {"policy_0": -1502.4423016927487}, "policy_reward_max": {"policy_0": -30.480685490492004}, "policy_reward_mean": {"policy_0": -731.1053784686023}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-910.8069537737788, -649.9764657122334, -763.6605179057922, -1071.2585233972445, -161.20301039413627, -627.650797665566, -665.5674349283737, -1336.3968659185298, -516.939574021002, -658.1680690691696, -773.6635259869805, -673.379888574229, -892.5656781151356, -312.3686549097008, -1054.4463281265914, -1116.873986808369, -1270.811550677455, -561.9813759735478, -811.4405123240449, -466.8463335332854, -739.0859409260704, -776.4866282964063, -1091.0044287360154, -1009.1236600839467, -1006.7410413872291, -862.3007639020271, -36.55083309204916, -79.16826844987357, -1290.1050571102448, -210.70004558583656, -971.6086252566464, -1316.379642977264, -986.2078295766462, -1226.3006378886435, -580.5363995376291, -901.7493172811606, -950.581727421176, -1059.3032002859143, -638.7080172357428, -782.8537350685531, -376.4119246866983, -721.9578272498455, -42.450145005868904, -565.6020925134596, -1146.3413440950574, -201.71373679012012, -891.5225726133444, -106.70070970947981, -734.341033393942, -829.9326317700416, -576.9437522130517, -1083.047806379057, -793.4901909945852, -303.4910267613244, -1077.5241697296842, -360.9375924546836, -1021.2408267967954, -392.33179447387397, -895.6842735113596, -718.690537194975, -754.2308989411081, -1083.0104806341517, -358.2802524612916, -942.7987219348265, -860.3743962276932, -1136.562653316676, -1082.902294499438, -586.1104780124979, -884.9635528792802, -766.0346035130126, -30.480685490492004, -543.68149370375, -791.1742947466579, -809.2731791629691, -831.978202714331, -1027.698000571151, -1138.612089082116, -808.599176379056, -257.5395552995941, -941.1767595583248, -992.7485663740874, -921.609685723788, -151.1418681736694, -670.2388899064381, -410.27420555178975, -728.3636695798592, -190.95085724216136, -1123.5557568175986, -1191.1523989439372, -819.2617013156006, -196.91299101502727, -693.8621875164168, -1502.4423016927487, -257.4622650646308, -450.2565900189447, -996.1864591657412, -272.47943669537136, -539.1013678888055, -482.3575492275235, -232.8394935661788], "episode_lengths": [150, 150, 150, 150, 93, 150, 150, 150, 110, 150, 150, 130, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 53, 71, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 49, 150, 150, 99, 150, 52, 150, 150, 134, 150, 150, 118, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 72, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 102, 105, 150, 90, 150, 150, 94], "policy_policy_0_reward": [-910.8069537737788, -649.9764657122334, -763.6605179057922, -1071.2585233972445, -161.20301039413627, -627.650797665566, -665.5674349283737, -1336.3968659185298, -516.939574021002, -658.1680690691696, -773.6635259869805, -673.379888574229, -892.5656781151356, -312.3686549097008, -1054.4463281265914, -1116.873986808369, -1270.811550677455, -561.9813759735478, -811.4405123240449, -466.8463335332854, -739.0859409260704, -776.4866282964063, -1091.0044287360154, -1009.1236600839467, -1006.7410413872291, -862.3007639020271, -36.55083309204916, -79.16826844987357, -1290.1050571102448, -210.70004558583656, -971.6086252566464, -1316.379642977264, -986.2078295766462, -1226.3006378886435, -580.5363995376291, -901.7493172811606, -950.581727421176, -1059.3032002859143, -638.7080172357428, -782.8537350685531, -376.4119246866983, -721.9578272498455, -42.450145005868904, -565.6020925134596, -1146.3413440950574, -201.71373679012012, -891.5225726133444, -106.70070970947981, -734.341033393942, -829.9326317700416, -576.9437522130517, -1083.047806379057, -793.4901909945852, -303.4910267613244, -1077.5241697296842, -360.9375924546836, -1021.2408267967954, -392.33179447387397, -895.6842735113596, -718.690537194975, -754.2308989411081, -1083.0104806341517, -358.2802524612916, -942.7987219348265, -860.3743962276932, -1136.562653316676, -1082.902294499438, -586.1104780124979, -884.9635528792802, -766.0346035130126, -30.480685490492004, -543.68149370375, -791.1742947466579, -809.2731791629691, -831.978202714331, -1027.698000571151, -1138.612089082116, -808.599176379056, -257.5395552995941, -941.1767595583248, -992.7485663740874, -921.609685723788, -151.1418681736694, -670.2388899064381, -410.27420555178975, -728.3636695798592, -190.95085724216136, -1123.5557568175986, -1191.1523989439372, -819.2617013156006, -196.91299101502727, -693.8621875164168, -1502.4423016927487, -257.4622650646308, -450.2565900189447, -996.1864591657412, -272.47943669537136, -539.1013678888055, -482.3575492275235, -232.8394935661788]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2753201455338948, "mean_inference_ms": 0.886801849625595, "mean_action_processing_ms": 0.15802654157014276, "mean_env_wait_ms": 1.5287874955598197, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005405902862548828, "StateBufferConnector_ms": 0.003968715667724609, "ViewRequirementAgentConnector_ms": 0.09720373153686523}, "num_episodes": 29, "episode_return_max": -30.480685490492004, "episode_return_min": -1502.4423016927487, "episode_return_mean": -731.1053784686023, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.87693889518977, "num_env_steps_trained_throughput_per_sec": 299.87693889518977, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13811.645, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13811.575, "sample_time_ms": 2366.906, "learn_time_ms": 11428.458, "learn_throughput": 350.003, "synch_weights_time_ms": 15.32}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00002", "date": "2024-08-03_04-34-28", "timestamp": 1722639868, "time_this_iter_s": 13.344491958618164, "time_total_s": 138.1823787689209, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814f7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 138.1823787689209, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 12.642105263157896, "ram_util_percent": 16.12631578947369}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 189.0777652045091, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.825633799284697, "policy_loss": -0.012575239180781258, "vf_loss": 4.8354775411387285, "vf_explained_var": 0.9481554156790177, "kl": 0.014765645599466866, "entropy": 1.698205202197035, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -30.480685490492004, "episode_reward_min": -1502.4423016927487, "episode_reward_mean": -739.63951110671, "episode_len_mean": 140.03, "episode_media": {}, "episodes_timesteps_total": 14003, "policy_reward_min": {"policy_0": -1502.4423016927487}, "policy_reward_max": {"policy_0": -30.480685490492004}, "policy_reward_mean": {"policy_0": -739.63951110671}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-210.70004558583656, -971.6086252566464, -1316.379642977264, -986.2078295766462, -1226.3006378886435, -580.5363995376291, -901.7493172811606, -950.581727421176, -1059.3032002859143, -638.7080172357428, -782.8537350685531, -376.4119246866983, -721.9578272498455, -42.450145005868904, -565.6020925134596, -1146.3413440950574, -201.71373679012012, -891.5225726133444, -106.70070970947981, -734.341033393942, -829.9326317700416, -576.9437522130517, -1083.047806379057, -793.4901909945852, -303.4910267613244, -1077.5241697296842, -360.9375924546836, -1021.2408267967954, -392.33179447387397, -895.6842735113596, -718.690537194975, -754.2308989411081, -1083.0104806341517, -358.2802524612916, -942.7987219348265, -860.3743962276932, -1136.562653316676, -1082.902294499438, -586.1104780124979, -884.9635528792802, -766.0346035130126, -30.480685490492004, -543.68149370375, -791.1742947466579, -809.2731791629691, -831.978202714331, -1027.698000571151, -1138.612089082116, -808.599176379056, -257.5395552995941, -941.1767595583248, -992.7485663740874, -921.609685723788, -151.1418681736694, -670.2388899064381, -410.27420555178975, -728.3636695798592, -190.95085724216136, -1123.5557568175986, -1191.1523989439372, -819.2617013156006, -196.91299101502727, -693.8621875164168, -1502.4423016927487, -257.4622650646308, -450.2565900189447, -996.1864591657412, -272.47943669537136, -539.1013678888055, -482.3575492275235, -232.8394935661788, -573.8477497094154, -499.6964067938155, -1235.6400035326378, -539.546136471686, -973.6387283945801, -915.7530246496175, -1189.5479659617383, -489.07768377707123, -895.9663326290731, -551.506245379438, -864.1727369196963, -665.6570639739514, -153.8143386243859, -616.3111738534052, -734.7417121538322, -910.4819709687029, -836.5040353038572, -812.1402522736769, -452.0295035381648, -901.1866401174523, -1198.1759721910505, -1047.7245758150784, -853.4277978054992, -813.1348380400497, -846.8980159878192, -751.8884497031959, -1047.1217578451876, -403.1539174722635, -1267.2009037234732], "episode_lengths": [128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 49, 150, 150, 99, 150, 52, 150, 150, 134, 150, 150, 118, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 72, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 102, 105, 150, 90, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150], "policy_policy_0_reward": [-210.70004558583656, -971.6086252566464, -1316.379642977264, -986.2078295766462, -1226.3006378886435, -580.5363995376291, -901.7493172811606, -950.581727421176, -1059.3032002859143, -638.7080172357428, -782.8537350685531, -376.4119246866983, -721.9578272498455, -42.450145005868904, -565.6020925134596, -1146.3413440950574, -201.71373679012012, -891.5225726133444, -106.70070970947981, -734.341033393942, -829.9326317700416, -576.9437522130517, -1083.047806379057, -793.4901909945852, -303.4910267613244, -1077.5241697296842, -360.9375924546836, -1021.2408267967954, -392.33179447387397, -895.6842735113596, -718.690537194975, -754.2308989411081, -1083.0104806341517, -358.2802524612916, -942.7987219348265, -860.3743962276932, -1136.562653316676, -1082.902294499438, -586.1104780124979, -884.9635528792802, -766.0346035130126, -30.480685490492004, -543.68149370375, -791.1742947466579, -809.2731791629691, -831.978202714331, -1027.698000571151, -1138.612089082116, -808.599176379056, -257.5395552995941, -941.1767595583248, -992.7485663740874, -921.609685723788, -151.1418681736694, -670.2388899064381, -410.27420555178975, -728.3636695798592, -190.95085724216136, -1123.5557568175986, -1191.1523989439372, -819.2617013156006, -196.91299101502727, -693.8621875164168, -1502.4423016927487, -257.4622650646308, -450.2565900189447, -996.1864591657412, -272.47943669537136, -539.1013678888055, -482.3575492275235, -232.8394935661788, -573.8477497094154, -499.6964067938155, -1235.6400035326378, -539.546136471686, -973.6387283945801, -915.7530246496175, -1189.5479659617383, -489.07768377707123, -895.9663326290731, -551.506245379438, -864.1727369196963, -665.6570639739514, -153.8143386243859, -616.3111738534052, -734.7417121538322, -910.4819709687029, -836.5040353038572, -812.1402522736769, -452.0295035381648, -901.1866401174523, -1198.1759721910505, -1047.7245758150784, -853.4277978054992, -813.1348380400497, -846.8980159878192, -751.8884497031959, -1047.1217578451876, -403.1539174722635, -1267.2009037234732]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27496461359405805, "mean_inference_ms": 0.8878190142857801, "mean_action_processing_ms": 0.15782629553606442, "mean_env_wait_ms": 1.527457654561167, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005636453628540039, "StateBufferConnector_ms": 0.003954172134399414, "ViewRequirementAgentConnector_ms": 0.09694433212280273}, "num_episodes": 29, "episode_return_max": -30.480685490492004, "episode_return_min": -1502.4423016927487, "episode_return_mean": -739.63951110671, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 288.4326930509126, "num_env_steps_trained_throughput_per_sec": 288.4326930509126, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13785.551, "restore_workers_time_ms": 0.023, "training_step_time_ms": 13785.481, "sample_time_ms": 2359.325, "learn_time_ms": 11410.005, "learn_throughput": 350.57, "synch_weights_time_ms": 15.254}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00002", "date": "2024-08-03_04-34-42", "timestamp": 1722639882, "time_this_iter_s": 13.87640643119812, "time_total_s": 152.05878520011902, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814c160>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 152.05878520011902, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 12.530000000000003, "ram_util_percent": 16.125000000000007}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 167.92703834176064, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.437194769084454, "policy_loss": -0.012463813750461366, "vf_loss": 4.446707491576672, "vf_explained_var": 0.9700563215340178, "kl": 0.015468020577524546, "entropy": 1.6893163381765286, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -30.480685490492004, "episode_reward_min": -1502.4423016927487, "episode_reward_mean": -735.1194212441828, "episode_len_mean": 141.55, "episode_media": {}, "episodes_timesteps_total": 14155, "policy_reward_min": {"policy_0": -1502.4423016927487}, "policy_reward_max": {"policy_0": -30.480685490492004}, "policy_reward_mean": {"policy_0": -735.1194212441828}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-360.9375924546836, -1021.2408267967954, -392.33179447387397, -895.6842735113596, -718.690537194975, -754.2308989411081, -1083.0104806341517, -358.2802524612916, -942.7987219348265, -860.3743962276932, -1136.562653316676, -1082.902294499438, -586.1104780124979, -884.9635528792802, -766.0346035130126, -30.480685490492004, -543.68149370375, -791.1742947466579, -809.2731791629691, -831.978202714331, -1027.698000571151, -1138.612089082116, -808.599176379056, -257.5395552995941, -941.1767595583248, -992.7485663740874, -921.609685723788, -151.1418681736694, -670.2388899064381, -410.27420555178975, -728.3636695798592, -190.95085724216136, -1123.5557568175986, -1191.1523989439372, -819.2617013156006, -196.91299101502727, -693.8621875164168, -1502.4423016927487, -257.4622650646308, -450.2565900189447, -996.1864591657412, -272.47943669537136, -539.1013678888055, -482.3575492275235, -232.8394935661788, -573.8477497094154, -499.6964067938155, -1235.6400035326378, -539.546136471686, -973.6387283945801, -915.7530246496175, -1189.5479659617383, -489.07768377707123, -895.9663326290731, -551.506245379438, -864.1727369196963, -665.6570639739514, -153.8143386243859, -616.3111738534052, -734.7417121538322, -910.4819709687029, -836.5040353038572, -812.1402522736769, -452.0295035381648, -901.1866401174523, -1198.1759721910505, -1047.7245758150784, -853.4277978054992, -813.1348380400497, -846.8980159878192, -751.8884497031959, -1047.1217578451876, -403.1539174722635, -1267.2009037234732, -1017.8051672931904, -1068.357392996433, -719.831118647065, -290.9379972996727, -726.3902777333678, -621.0917778139275, -473.18708811158007, -1094.0864899461162, -1015.9041963369395, -894.8413087824579, -391.2348874219561, -840.6663911015276, -112.83992823652324, -715.659069142214, -924.9153908303092, -1249.4961731267742, -395.28919897614924, -267.5850900780156, -577.0181983622491, -746.8281298590042, -924.8437369994239, -405.3275979840946, -777.3359146901627, -1246.0888054254597, -863.0067195894336, -263.8231089839966], "episode_lengths": [96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 40, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 72, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 102, 105, 150, 90, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 125, 150, 58, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-360.9375924546836, -1021.2408267967954, -392.33179447387397, -895.6842735113596, -718.690537194975, -754.2308989411081, -1083.0104806341517, -358.2802524612916, -942.7987219348265, -860.3743962276932, -1136.562653316676, -1082.902294499438, -586.1104780124979, -884.9635528792802, -766.0346035130126, -30.480685490492004, -543.68149370375, -791.1742947466579, -809.2731791629691, -831.978202714331, -1027.698000571151, -1138.612089082116, -808.599176379056, -257.5395552995941, -941.1767595583248, -992.7485663740874, -921.609685723788, -151.1418681736694, -670.2388899064381, -410.27420555178975, -728.3636695798592, -190.95085724216136, -1123.5557568175986, -1191.1523989439372, -819.2617013156006, -196.91299101502727, -693.8621875164168, -1502.4423016927487, -257.4622650646308, -450.2565900189447, -996.1864591657412, -272.47943669537136, -539.1013678888055, -482.3575492275235, -232.8394935661788, -573.8477497094154, -499.6964067938155, -1235.6400035326378, -539.546136471686, -973.6387283945801, -915.7530246496175, -1189.5479659617383, -489.07768377707123, -895.9663326290731, -551.506245379438, -864.1727369196963, -665.6570639739514, -153.8143386243859, -616.3111738534052, -734.7417121538322, -910.4819709687029, -836.5040353038572, -812.1402522736769, -452.0295035381648, -901.1866401174523, -1198.1759721910505, -1047.7245758150784, -853.4277978054992, -813.1348380400497, -846.8980159878192, -751.8884497031959, -1047.1217578451876, -403.1539174722635, -1267.2009037234732, -1017.8051672931904, -1068.357392996433, -719.831118647065, -290.9379972996727, -726.3902777333678, -621.0917778139275, -473.18708811158007, -1094.0864899461162, -1015.9041963369395, -894.8413087824579, -391.2348874219561, -840.6663911015276, -112.83992823652324, -715.659069142214, -924.9153908303092, -1249.4961731267742, -395.28919897614924, -267.5850900780156, -577.0181983622491, -746.8281298590042, -924.8437369994239, -405.3275979840946, -777.3359146901627, -1246.0888054254597, -863.0067195894336, -263.8231089839966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2747230223021617, "mean_inference_ms": 0.8846186765349932, "mean_action_processing_ms": 0.1576689740415234, "mean_env_wait_ms": 1.5281672166177145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005616188049316406, "StateBufferConnector_ms": 0.003934621810913086, "ViewRequirementAgentConnector_ms": 0.09702754020690918}, "num_episodes": 26, "episode_return_max": -30.480685490492004, "episode_return_min": -1502.4423016927487, "episode_return_mean": -735.1194212441828, "episodes_this_iter": 26}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.48004284038547, "num_env_steps_trained_throughput_per_sec": 281.48004284038547, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 13838.554, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13838.48, "sample_time_ms": 2363.374, "learn_time_ms": 11458.618, "learn_throughput": 349.082, "synch_weights_time_ms": 15.555}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00002", "date": "2024-08-03_04-34-56", "timestamp": 1722639896, "time_this_iter_s": 14.218329429626465, "time_total_s": 166.27711462974548, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270cca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 166.27711462974548, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 12.49, "ram_util_percent": 16.179999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 177.09880623022715, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.349872063845396, "policy_loss": -0.008298949265251092, "vf_loss": 4.355414141714573, "vf_explained_var": 0.9784931725511948, "kl": 0.014638599450457463, "entropy": 1.6346983763078848, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -67.72241990632553, "episode_reward_min": -1502.4423016927487, "episode_reward_mean": -706.5163482318054, "episode_len_mean": 140.21, "episode_media": {}, "episodes_timesteps_total": 14021, "policy_reward_min": {"policy_0": -1502.4423016927487}, "policy_reward_max": {"policy_0": -67.72241990632553}, "policy_reward_mean": {"policy_0": -706.5163482318054}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-190.95085724216136, -1123.5557568175986, -1191.1523989439372, -819.2617013156006, -196.91299101502727, -693.8621875164168, -1502.4423016927487, -257.4622650646308, -450.2565900189447, -996.1864591657412, -272.47943669537136, -539.1013678888055, -482.3575492275235, -232.8394935661788, -573.8477497094154, -499.6964067938155, -1235.6400035326378, -539.546136471686, -973.6387283945801, -915.7530246496175, -1189.5479659617383, -489.07768377707123, -895.9663326290731, -551.506245379438, -864.1727369196963, -665.6570639739514, -153.8143386243859, -616.3111738534052, -734.7417121538322, -910.4819709687029, -836.5040353038572, -812.1402522736769, -452.0295035381648, -901.1866401174523, -1198.1759721910505, -1047.7245758150784, -853.4277978054992, -813.1348380400497, -846.8980159878192, -751.8884497031959, -1047.1217578451876, -403.1539174722635, -1267.2009037234732, -1017.8051672931904, -1068.357392996433, -719.831118647065, -290.9379972996727, -726.3902777333678, -621.0917778139275, -473.18708811158007, -1094.0864899461162, -1015.9041963369395, -894.8413087824579, -391.2348874219561, -840.6663911015276, -112.83992823652324, -715.659069142214, -924.9153908303092, -1249.4961731267742, -395.28919897614924, -267.5850900780156, -577.0181983622491, -746.8281298590042, -924.8437369994239, -405.3275979840946, -777.3359146901627, -1246.0888054254597, -863.0067195894336, -263.8231089839966, -502.0351368192796, -828.7508954958234, -988.5683758485792, -278.16174373791273, -675.9174569789442, -532.3838792909262, -673.2071110709746, -344.1368867645874, -1181.602846010761, -580.7136067150619, -858.3567624871989, -477.4180776292377, -995.3194954201886, -354.9799165643129, -410.93561916135, -514.204070111145, -1091.5507755255394, -689.0197775697449, -721.3844308389087, -88.14060827613336, -922.2138434297063, -213.11031630999247, -216.9184172323521, -67.72241990632553, -1322.301006306591, -681.0160842520088, -876.442986910208, -906.1119361754851, -910.3616466703936, -1000.4947976491114, -134.95545047320212], "episode_lengths": [124, 150, 150, 150, 150, 150, 150, 102, 105, 150, 90, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 125, 150, 58, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 70, 150, 68, 120, 68, 150, 150, 150, 150, 150, 150, 64], "policy_policy_0_reward": [-190.95085724216136, -1123.5557568175986, -1191.1523989439372, -819.2617013156006, -196.91299101502727, -693.8621875164168, -1502.4423016927487, -257.4622650646308, -450.2565900189447, -996.1864591657412, -272.47943669537136, -539.1013678888055, -482.3575492275235, -232.8394935661788, -573.8477497094154, -499.6964067938155, -1235.6400035326378, -539.546136471686, -973.6387283945801, -915.7530246496175, -1189.5479659617383, -489.07768377707123, -895.9663326290731, -551.506245379438, -864.1727369196963, -665.6570639739514, -153.8143386243859, -616.3111738534052, -734.7417121538322, -910.4819709687029, -836.5040353038572, -812.1402522736769, -452.0295035381648, -901.1866401174523, -1198.1759721910505, -1047.7245758150784, -853.4277978054992, -813.1348380400497, -846.8980159878192, -751.8884497031959, -1047.1217578451876, -403.1539174722635, -1267.2009037234732, -1017.8051672931904, -1068.357392996433, -719.831118647065, -290.9379972996727, -726.3902777333678, -621.0917778139275, -473.18708811158007, -1094.0864899461162, -1015.9041963369395, -894.8413087824579, -391.2348874219561, -840.6663911015276, -112.83992823652324, -715.659069142214, -924.9153908303092, -1249.4961731267742, -395.28919897614924, -267.5850900780156, -577.0181983622491, -746.8281298590042, -924.8437369994239, -405.3275979840946, -777.3359146901627, -1246.0888054254597, -863.0067195894336, -263.8231089839966, -502.0351368192796, -828.7508954958234, -988.5683758485792, -278.16174373791273, -675.9174569789442, -532.3838792909262, -673.2071110709746, -344.1368867645874, -1181.602846010761, -580.7136067150619, -858.3567624871989, -477.4180776292377, -995.3194954201886, -354.9799165643129, -410.93561916135, -514.204070111145, -1091.5507755255394, -689.0197775697449, -721.3844308389087, -88.14060827613336, -922.2138434297063, -213.11031630999247, -216.9184172323521, -67.72241990632553, -1322.301006306591, -681.0160842520088, -876.442986910208, -906.1119361754851, -910.3616466703936, -1000.4947976491114, -134.95545047320212]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2744042917999522, "mean_inference_ms": 0.8823366868976669, "mean_action_processing_ms": 0.15744617444606057, "mean_env_wait_ms": 1.52827372707591, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00522303581237793, "StateBufferConnector_ms": 0.0038938522338867188, "ViewRequirementAgentConnector_ms": 0.09578680992126465}, "num_episodes": 31, "episode_return_max": -67.72241990632553, "episode_return_min": -1502.4423016927487, "episode_return_mean": -706.5163482318054, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.0066291471182, "num_env_steps_trained_throughput_per_sec": 280.0066291471182, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 13891.062, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13890.988, "sample_time_ms": 2368.019, "learn_time_ms": 11506.537, "learn_throughput": 347.628, "synch_weights_time_ms": 15.491}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00002", "date": "2024-08-03_04-35-10", "timestamp": 1722639910, "time_this_iter_s": 14.292162656784058, "time_total_s": 180.56927728652954, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814c280>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 180.56927728652954, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 12.471428571428573, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 198.31532125671706, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.058260228484869, "policy_loss": -0.006206582575881233, "vf_loss": 4.062915545701981, "vf_explained_var": 0.9775872896735867, "kl": 0.010547801424854708, "entropy": 1.6130908823261658, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -24.334217855341524, "episode_reward_min": -1322.301006306591, "episode_reward_mean": -697.4964280590407, "episode_len_mean": 138.76, "episode_media": {}, "episodes_timesteps_total": 13876, "policy_reward_min": {"policy_0": -1322.301006306591}, "policy_reward_max": {"policy_0": -24.334217855341524}, "policy_reward_mean": {"policy_0": -697.4964280590407}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-734.7417121538322, -910.4819709687029, -836.5040353038572, -812.1402522736769, -452.0295035381648, -901.1866401174523, -1198.1759721910505, -1047.7245758150784, -853.4277978054992, -813.1348380400497, -846.8980159878192, -751.8884497031959, -1047.1217578451876, -403.1539174722635, -1267.2009037234732, -1017.8051672931904, -1068.357392996433, -719.831118647065, -290.9379972996727, -726.3902777333678, -621.0917778139275, -473.18708811158007, -1094.0864899461162, -1015.9041963369395, -894.8413087824579, -391.2348874219561, -840.6663911015276, -112.83992823652324, -715.659069142214, -924.9153908303092, -1249.4961731267742, -395.28919897614924, -267.5850900780156, -577.0181983622491, -746.8281298590042, -924.8437369994239, -405.3275979840946, -777.3359146901627, -1246.0888054254597, -863.0067195894336, -263.8231089839966, -502.0351368192796, -828.7508954958234, -988.5683758485792, -278.16174373791273, -675.9174569789442, -532.3838792909262, -673.2071110709746, -344.1368867645874, -1181.602846010761, -580.7136067150619, -858.3567624871989, -477.4180776292377, -995.3194954201886, -354.9799165643129, -410.93561916135, -514.204070111145, -1091.5507755255394, -689.0197775697449, -721.3844308389087, -88.14060827613336, -922.2138434297063, -213.11031630999247, -216.9184172323521, -67.72241990632553, -1322.301006306591, -681.0160842520088, -876.442986910208, -906.1119361754851, -910.3616466703936, -1000.4947976491114, -134.95545047320212, -683.1469942673557, -826.4554866895033, -1071.3669653185939, -562.7589441124743, -407.3128342819863, -399.12229044454983, -1222.585333587428, -776.8534303783946, -461.1041046599264, -993.6616879715798, -156.79331178073534, -925.070067395949, -637.5476673469294, -62.813678345836436, -604.9076155673632, -760.2262248752921, -753.1727129271172, -97.36589371520587, -845.413820875431, -922.3477198239104, -1066.6028706290022, -958.6371501909389, -803.1530541436548, -732.187551207134, -725.6584597532767, -691.8517741924493, -24.334217855341524, -38.55306722735881], "episode_lengths": [150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 125, 150, 58, 150, 150, 150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 70, 150, 68, 120, 68, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 121, 101, 150, 150, 150, 150, 119, 150, 150, 69, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 57, 60], "policy_policy_0_reward": [-734.7417121538322, -910.4819709687029, -836.5040353038572, -812.1402522736769, -452.0295035381648, -901.1866401174523, -1198.1759721910505, -1047.7245758150784, -853.4277978054992, -813.1348380400497, -846.8980159878192, -751.8884497031959, -1047.1217578451876, -403.1539174722635, -1267.2009037234732, -1017.8051672931904, -1068.357392996433, -719.831118647065, -290.9379972996727, -726.3902777333678, -621.0917778139275, -473.18708811158007, -1094.0864899461162, -1015.9041963369395, -894.8413087824579, -391.2348874219561, -840.6663911015276, -112.83992823652324, -715.659069142214, -924.9153908303092, -1249.4961731267742, -395.28919897614924, -267.5850900780156, -577.0181983622491, -746.8281298590042, -924.8437369994239, -405.3275979840946, -777.3359146901627, -1246.0888054254597, -863.0067195894336, -263.8231089839966, -502.0351368192796, -828.7508954958234, -988.5683758485792, -278.16174373791273, -675.9174569789442, -532.3838792909262, -673.2071110709746, -344.1368867645874, -1181.602846010761, -580.7136067150619, -858.3567624871989, -477.4180776292377, -995.3194954201886, -354.9799165643129, -410.93561916135, -514.204070111145, -1091.5507755255394, -689.0197775697449, -721.3844308389087, -88.14060827613336, -922.2138434297063, -213.11031630999247, -216.9184172323521, -67.72241990632553, -1322.301006306591, -681.0160842520088, -876.442986910208, -906.1119361754851, -910.3616466703936, -1000.4947976491114, -134.95545047320212, -683.1469942673557, -826.4554866895033, -1071.3669653185939, -562.7589441124743, -407.3128342819863, -399.12229044454983, -1222.585333587428, -776.8534303783946, -461.1041046599264, -993.6616879715798, -156.79331178073534, -925.070067395949, -637.5476673469294, -62.813678345836436, -604.9076155673632, -760.2262248752921, -753.1727129271172, -97.36589371520587, -845.413820875431, -922.3477198239104, -1066.6028706290022, -958.6371501909389, -803.1530541436548, -732.187551207134, -725.6584597532767, -691.8517741924493, -24.334217855341524, -38.55306722735881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27432625207265693, "mean_inference_ms": 0.8806268208572674, "mean_action_processing_ms": 0.1573802552469849, "mean_env_wait_ms": 1.5304526384477426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004828691482543945, "StateBufferConnector_ms": 0.003849506378173828, "ViewRequirementAgentConnector_ms": 0.09511923789978027}, "num_episodes": 28, "episode_return_max": -24.334217855341524, "episode_return_min": -1322.301006306591, "episode_return_mean": -697.4964280590407, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.9958581022819, "num_env_steps_trained_throughput_per_sec": 277.9958581022819, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 14034.468, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14034.393, "sample_time_ms": 2372.883, "learn_time_ms": 11645.229, "learn_throughput": 343.488, "synch_weights_time_ms": 15.336}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00002", "date": "2024-08-03_04-35-25", "timestamp": 1722639925, "time_this_iter_s": 14.39576768875122, "time_total_s": 194.96504497528076, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814ed40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 194.96504497528076, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 12.635, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 192.7175521949927, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.5090079282720885, "policy_loss": -0.010257869302101123, "vf_loss": 3.5162481206158795, "vf_explained_var": 0.9765227306634188, "kl": 0.015286817198042032, "entropy": 1.5683592141916354, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -15.77494498399848, "episode_reward_min": -1322.301006306591, "episode_reward_mean": -661.3002359520063, "episode_len_mean": 136.88, "episode_media": {}, "episodes_timesteps_total": 13688, "policy_reward_min": {"policy_0": -1322.301006306591}, "policy_reward_max": {"policy_0": -15.77494498399848}, "policy_reward_mean": {"policy_0": -661.3002359520063}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-395.28919897614924, -267.5850900780156, -577.0181983622491, -746.8281298590042, -924.8437369994239, -405.3275979840946, -777.3359146901627, -1246.0888054254597, -863.0067195894336, -263.8231089839966, -502.0351368192796, -828.7508954958234, -988.5683758485792, -278.16174373791273, -675.9174569789442, -532.3838792909262, -673.2071110709746, -344.1368867645874, -1181.602846010761, -580.7136067150619, -858.3567624871989, -477.4180776292377, -995.3194954201886, -354.9799165643129, -410.93561916135, -514.204070111145, -1091.5507755255394, -689.0197775697449, -721.3844308389087, -88.14060827613336, -922.2138434297063, -213.11031630999247, -216.9184172323521, -67.72241990632553, -1322.301006306591, -681.0160842520088, -876.442986910208, -906.1119361754851, -910.3616466703936, -1000.4947976491114, -134.95545047320212, -683.1469942673557, -826.4554866895033, -1071.3669653185939, -562.7589441124743, -407.3128342819863, -399.12229044454983, -1222.585333587428, -776.8534303783946, -461.1041046599264, -993.6616879715798, -156.79331178073534, -925.070067395949, -637.5476673469294, -62.813678345836436, -604.9076155673632, -760.2262248752921, -753.1727129271172, -97.36589371520587, -845.413820875431, -922.3477198239104, -1066.6028706290022, -958.6371501909389, -803.1530541436548, -732.187551207134, -725.6584597532767, -691.8517741924493, -24.334217855341524, -38.55306722735881, -625.9669318548127, -335.7730916537467, -125.47324291240591, -225.65547475889787, -863.7891976337798, -1131.7431661482344, -1020.036990928814, -645.3890592089621, -767.9880898955903, -1164.6472909181396, -404.2514346906877, -1076.7553385167525, -997.8401496201498, -957.4151406305378, -860.2972613229565, -15.77494498399848, -763.2203471097669, -708.640539564029, -718.51303506732, -989.8131602056773, -683.0644104082457, -637.2783375020196, -1009.899733455689, -50.148063887980754, -215.42780881015966, -831.262184486221, -560.552820180254, -952.0256572691966, -517.1576000263951, -740.5257850594184, -817.1094983450878], "episode_lengths": [150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 150, 150, 150, 150, 150, 70, 150, 68, 120, 68, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 121, 101, 150, 150, 150, 150, 119, 150, 150, 69, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 57, 60, 150, 106, 93, 102, 150, 150, 150, 127, 150, 150, 147, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 150, 150, 57, 91, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-395.28919897614924, -267.5850900780156, -577.0181983622491, -746.8281298590042, -924.8437369994239, -405.3275979840946, -777.3359146901627, -1246.0888054254597, -863.0067195894336, -263.8231089839966, -502.0351368192796, -828.7508954958234, -988.5683758485792, -278.16174373791273, -675.9174569789442, -532.3838792909262, -673.2071110709746, -344.1368867645874, -1181.602846010761, -580.7136067150619, -858.3567624871989, -477.4180776292377, -995.3194954201886, -354.9799165643129, -410.93561916135, -514.204070111145, -1091.5507755255394, -689.0197775697449, -721.3844308389087, -88.14060827613336, -922.2138434297063, -213.11031630999247, -216.9184172323521, -67.72241990632553, -1322.301006306591, -681.0160842520088, -876.442986910208, -906.1119361754851, -910.3616466703936, -1000.4947976491114, -134.95545047320212, -683.1469942673557, -826.4554866895033, -1071.3669653185939, -562.7589441124743, -407.3128342819863, -399.12229044454983, -1222.585333587428, -776.8534303783946, -461.1041046599264, -993.6616879715798, -156.79331178073534, -925.070067395949, -637.5476673469294, -62.813678345836436, -604.9076155673632, -760.2262248752921, -753.1727129271172, -97.36589371520587, -845.413820875431, -922.3477198239104, -1066.6028706290022, -958.6371501909389, -803.1530541436548, -732.187551207134, -725.6584597532767, -691.8517741924493, -24.334217855341524, -38.55306722735881, -625.9669318548127, -335.7730916537467, -125.47324291240591, -225.65547475889787, -863.7891976337798, -1131.7431661482344, -1020.036990928814, -645.3890592089621, -767.9880898955903, -1164.6472909181396, -404.2514346906877, -1076.7553385167525, -997.8401496201498, -957.4151406305378, -860.2972613229565, -15.77494498399848, -763.2203471097669, -708.640539564029, -718.51303506732, -989.8131602056773, -683.0644104082457, -637.2783375020196, -1009.899733455689, -50.148063887980754, -215.42780881015966, -831.262184486221, -560.552820180254, -952.0256572691966, -517.1576000263951, -740.5257850594184, -817.1094983450878]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.274508223244758, "mean_inference_ms": 0.8809079460150816, "mean_action_processing_ms": 0.15749930666747083, "mean_env_wait_ms": 1.5322586937539548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004981517791748047, "StateBufferConnector_ms": 0.0039212703704833984, "ViewRequirementAgentConnector_ms": 0.09615421295166016}, "num_episodes": 31, "episode_return_max": -15.77494498399848, "episode_return_min": -1322.301006306591, "episode_return_mean": -661.3002359520063, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.8041464484196, "num_env_steps_trained_throughput_per_sec": 282.8041464484196, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 14062.779, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14062.703, "sample_time_ms": 2382.033, "learn_time_ms": 11664.436, "learn_throughput": 342.923, "synch_weights_time_ms": 15.281}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00002", "date": "2024-08-03_04-35-39", "timestamp": 1722639939, "time_this_iter_s": 14.15131664276123, "time_total_s": 209.116361618042, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814ec20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 209.116361618042, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 12.461904761904762, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 158.53028812408448, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.20029948229591, "policy_loss": -0.013600396011315751, "vf_loss": 4.210714826981227, "vf_explained_var": 0.9690059522166848, "kl": 0.015316148885904126, "entropy": 1.4097877179582914, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -15.77494498399848, "episode_reward_min": -1322.301006306591, "episode_reward_mean": -625.8841685084757, "episode_len_mean": 134.01, "episode_media": {}, "episodes_timesteps_total": 13401, "policy_reward_min": {"policy_0": -1322.301006306591}, "policy_reward_max": {"policy_0": -15.77494498399848}, "policy_reward_mean": {"policy_0": -625.8841685084757}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88.14060827613336, -922.2138434297063, -213.11031630999247, -216.9184172323521, -67.72241990632553, -1322.301006306591, -681.0160842520088, -876.442986910208, -906.1119361754851, -910.3616466703936, -1000.4947976491114, -134.95545047320212, -683.1469942673557, -826.4554866895033, -1071.3669653185939, -562.7589441124743, -407.3128342819863, -399.12229044454983, -1222.585333587428, -776.8534303783946, -461.1041046599264, -993.6616879715798, -156.79331178073534, -925.070067395949, -637.5476673469294, -62.813678345836436, -604.9076155673632, -760.2262248752921, -753.1727129271172, -97.36589371520587, -845.413820875431, -922.3477198239104, -1066.6028706290022, -958.6371501909389, -803.1530541436548, -732.187551207134, -725.6584597532767, -691.8517741924493, -24.334217855341524, -38.55306722735881, -625.9669318548127, -335.7730916537467, -125.47324291240591, -225.65547475889787, -863.7891976337798, -1131.7431661482344, -1020.036990928814, -645.3890592089621, -767.9880898955903, -1164.6472909181396, -404.2514346906877, -1076.7553385167525, -997.8401496201498, -957.4151406305378, -860.2972613229565, -15.77494498399848, -763.2203471097669, -708.640539564029, -718.51303506732, -989.8131602056773, -683.0644104082457, -637.2783375020196, -1009.899733455689, -50.148063887980754, -215.42780881015966, -831.262184486221, -560.552820180254, -952.0256572691966, -517.1576000263951, -740.5257850594184, -817.1094983450878, -661.1972732111882, -383.1390695645867, -502.532414259721, -483.4815904067805, -956.7684228055988, -88.41874908207707, -440.1274361933607, -655.0653227397443, -669.4552932506554, -568.3644854990172, -551.926258414535, -77.21805123279401, -774.2254284221352, -280.5224004844453, -61.23595732021625, -618.2746033228061, -973.8218198535179, -569.8301024250562, -673.9259673668066, -718.468045861893, -1177.1797706998577, -740.6669357681342, -328.9925866565275, -115.3602548700642, -963.0219003914169, -494.2119802803714, -478.5510556480491, -361.8467575982876, -256.35668700576133], "episode_lengths": [70, 150, 68, 120, 68, 150, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 121, 101, 150, 150, 150, 150, 119, 150, 150, 69, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 57, 60, 150, 106, 93, 102, 150, 150, 150, 127, 150, 150, 147, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 150, 150, 57, 91, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 72, 150, 150, 150, 131, 150, 85, 150, 150, 56, 150, 150, 132, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-88.14060827613336, -922.2138434297063, -213.11031630999247, -216.9184172323521, -67.72241990632553, -1322.301006306591, -681.0160842520088, -876.442986910208, -906.1119361754851, -910.3616466703936, -1000.4947976491114, -134.95545047320212, -683.1469942673557, -826.4554866895033, -1071.3669653185939, -562.7589441124743, -407.3128342819863, -399.12229044454983, -1222.585333587428, -776.8534303783946, -461.1041046599264, -993.6616879715798, -156.79331178073534, -925.070067395949, -637.5476673469294, -62.813678345836436, -604.9076155673632, -760.2262248752921, -753.1727129271172, -97.36589371520587, -845.413820875431, -922.3477198239104, -1066.6028706290022, -958.6371501909389, -803.1530541436548, -732.187551207134, -725.6584597532767, -691.8517741924493, -24.334217855341524, -38.55306722735881, -625.9669318548127, -335.7730916537467, -125.47324291240591, -225.65547475889787, -863.7891976337798, -1131.7431661482344, -1020.036990928814, -645.3890592089621, -767.9880898955903, -1164.6472909181396, -404.2514346906877, -1076.7553385167525, -997.8401496201498, -957.4151406305378, -860.2972613229565, -15.77494498399848, -763.2203471097669, -708.640539564029, -718.51303506732, -989.8131602056773, -683.0644104082457, -637.2783375020196, -1009.899733455689, -50.148063887980754, -215.42780881015966, -831.262184486221, -560.552820180254, -952.0256572691966, -517.1576000263951, -740.5257850594184, -817.1094983450878, -661.1972732111882, -383.1390695645867, -502.532414259721, -483.4815904067805, -956.7684228055988, -88.41874908207707, -440.1274361933607, -655.0653227397443, -669.4552932506554, -568.3644854990172, -551.926258414535, -77.21805123279401, -774.2254284221352, -280.5224004844453, -61.23595732021625, -618.2746033228061, -973.8218198535179, -569.8301024250562, -673.9259673668066, -718.468045861893, -1177.1797706998577, -740.6669357681342, -328.9925866565275, -115.3602548700642, -963.0219003914169, -494.2119802803714, -478.5510556480491, -361.8467575982876, -256.35668700576133]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.274718140170736, "mean_inference_ms": 0.8801959578221314, "mean_action_processing_ms": 0.15751935939581435, "mean_env_wait_ms": 1.5338966786197252, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.00516510009765625, "StateBufferConnector_ms": 0.003939628601074219, "ViewRequirementAgentConnector_ms": 0.09705400466918945}, "num_episodes": 29, "episode_return_max": -15.77494498399848, "episode_return_min": -1322.301006306591, "episode_return_mean": -625.8841685084757, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.01646258450097, "num_env_steps_trained_throughput_per_sec": 313.01646258450097, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 13903.063, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13902.986, "sample_time_ms": 2377.896, "learn_time_ms": 11508.815, "learn_throughput": 347.56, "synch_weights_time_ms": 15.317}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00002", "date": "2024-08-03_04-35-52", "timestamp": 1722639952, "time_this_iter_s": 12.78768014907837, "time_total_s": 221.90404176712036, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73601c7a9cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 221.90404176712036, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.9, "ram_util_percent": 16.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 182.83054673075677, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.329491369177898, "policy_loss": -0.005681854556314647, "vf_loss": 4.331835586329301, "vf_explained_var": 0.973492075689137, "kl": 0.016393648794140382, "entropy": 1.5804447098324697, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -15.77494498399848, "episode_reward_min": -1376.6388535103315, "episode_reward_mean": -634.4645541051682, "episode_len_mean": 135.75, "episode_media": {}, "episodes_timesteps_total": 13575, "policy_reward_min": {"policy_0": -1376.6388535103315}, "policy_reward_max": {"policy_0": -15.77494498399848}, "policy_reward_mean": {"policy_0": -634.4645541051682}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-753.1727129271172, -97.36589371520587, -845.413820875431, -922.3477198239104, -1066.6028706290022, -958.6371501909389, -803.1530541436548, -732.187551207134, -725.6584597532767, -691.8517741924493, -24.334217855341524, -38.55306722735881, -625.9669318548127, -335.7730916537467, -125.47324291240591, -225.65547475889787, -863.7891976337798, -1131.7431661482344, -1020.036990928814, -645.3890592089621, -767.9880898955903, -1164.6472909181396, -404.2514346906877, -1076.7553385167525, -997.8401496201498, -957.4151406305378, -860.2972613229565, -15.77494498399848, -763.2203471097669, -708.640539564029, -718.51303506732, -989.8131602056773, -683.0644104082457, -637.2783375020196, -1009.899733455689, -50.148063887980754, -215.42780881015966, -831.262184486221, -560.552820180254, -952.0256572691966, -517.1576000263951, -740.5257850594184, -817.1094983450878, -661.1972732111882, -383.1390695645867, -502.532414259721, -483.4815904067805, -956.7684228055988, -88.41874908207707, -440.1274361933607, -655.0653227397443, -669.4552932506554, -568.3644854990172, -551.926258414535, -77.21805123279401, -774.2254284221352, -280.5224004844453, -61.23595732021625, -618.2746033228061, -973.8218198535179, -569.8301024250562, -673.9259673668066, -718.468045861893, -1177.1797706998577, -740.6669357681342, -328.9925866565275, -115.3602548700642, -963.0219003914169, -494.2119802803714, -478.5510556480491, -361.8467575982876, -256.35668700576133, -666.508627577499, -1255.1295842165632, -942.2813757489658, -711.1041507179739, -190.30721222063718, -665.8532769712878, -687.164766607036, -1376.6388535103315, -751.3544151315225, -1114.5025743929752, -798.9651804281441, -306.76948735684255, -142.1508065922827, -516.3916151600572, -366.402880101201, -134.55256409279085, -1141.4853556598443, -410.200045876516, -316.833107015868, -278.17750283456496, -960.5929144749658, -1125.8067276075158, -592.3387692473336, -841.3781070203295, -951.2938461261923, -91.67788791018347, -1046.185689222429, -367.5073864628119], "episode_lengths": [150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 57, 60, 150, 106, 93, 102, 150, 150, 150, 127, 150, 150, 147, 150, 150, 150, 150, 46, 150, 150, 150, 150, 150, 150, 150, 57, 91, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 72, 150, 150, 150, 131, 150, 85, 150, 150, 56, 150, 150, 132, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 83, 108, 150, 75, 150, 150, 150, 90, 150, 150, 150, 150, 150, 62, 150, 150], "policy_policy_0_reward": [-753.1727129271172, -97.36589371520587, -845.413820875431, -922.3477198239104, -1066.6028706290022, -958.6371501909389, -803.1530541436548, -732.187551207134, -725.6584597532767, -691.8517741924493, -24.334217855341524, -38.55306722735881, -625.9669318548127, -335.7730916537467, -125.47324291240591, -225.65547475889787, -863.7891976337798, -1131.7431661482344, -1020.036990928814, -645.3890592089621, -767.9880898955903, -1164.6472909181396, -404.2514346906877, -1076.7553385167525, -997.8401496201498, -957.4151406305378, -860.2972613229565, -15.77494498399848, -763.2203471097669, -708.640539564029, -718.51303506732, -989.8131602056773, -683.0644104082457, -637.2783375020196, -1009.899733455689, -50.148063887980754, -215.42780881015966, -831.262184486221, -560.552820180254, -952.0256572691966, -517.1576000263951, -740.5257850594184, -817.1094983450878, -661.1972732111882, -383.1390695645867, -502.532414259721, -483.4815904067805, -956.7684228055988, -88.41874908207707, -440.1274361933607, -655.0653227397443, -669.4552932506554, -568.3644854990172, -551.926258414535, -77.21805123279401, -774.2254284221352, -280.5224004844453, -61.23595732021625, -618.2746033228061, -973.8218198535179, -569.8301024250562, -673.9259673668066, -718.468045861893, -1177.1797706998577, -740.6669357681342, -328.9925866565275, -115.3602548700642, -963.0219003914169, -494.2119802803714, -478.5510556480491, -361.8467575982876, -256.35668700576133, -666.508627577499, -1255.1295842165632, -942.2813757489658, -711.1041507179739, -190.30721222063718, -665.8532769712878, -687.164766607036, -1376.6388535103315, -751.3544151315225, -1114.5025743929752, -798.9651804281441, -306.76948735684255, -142.1508065922827, -516.3916151600572, -366.402880101201, -134.55256409279085, -1141.4853556598443, -410.200045876516, -316.833107015868, -278.17750283456496, -960.5929144749658, -1125.8067276075158, -592.3387692473336, -841.3781070203295, -951.2938461261923, -91.67788791018347, -1046.185689222429, -367.5073864628119]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2749245672479226, "mean_inference_ms": 0.8795360620648368, "mean_action_processing_ms": 0.15752965157281681, "mean_env_wait_ms": 1.5351958198501974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005335807800292969, "StateBufferConnector_ms": 0.0039556026458740234, "ViewRequirementAgentConnector_ms": 0.0974881649017334}, "num_episodes": 28, "episode_return_max": -15.77494498399848, "episode_return_min": -1376.6388535103315, "episode_return_mean": -634.4645541051682, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.71049006799274, "num_env_steps_trained_throughput_per_sec": 280.71049006799274, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13894.808, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13894.733, "sample_time_ms": 2371.942, "learn_time_ms": 11506.112, "learn_throughput": 347.641, "synch_weights_time_ms": 15.753}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00002", "date": "2024-08-03_04-36-06", "timestamp": 1722639966, "time_this_iter_s": 14.255842208862305, "time_total_s": 236.15988397598267, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270d1b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 236.15988397598267, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 12.695, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 229.74974130590758, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.570312146718303, "policy_loss": -0.007245096895106448, "vf_loss": 3.5748185911526282, "vf_explained_var": 0.9818898762265841, "kl": 0.014177307784901448, "entropy": 1.514536151662469, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -30.838047509993594, "episode_reward_min": -1376.6388535103315, "episode_reward_mean": -612.1579001458981, "episode_len_mean": 134.61, "episode_media": {}, "episodes_timesteps_total": 13461, "policy_reward_min": {"policy_0": -1376.6388535103315}, "policy_reward_max": {"policy_0": -30.838047509993594}, "policy_reward_mean": {"policy_0": -612.1579001458981}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-718.51303506732, -989.8131602056773, -683.0644104082457, -637.2783375020196, -1009.899733455689, -50.148063887980754, -215.42780881015966, -831.262184486221, -560.552820180254, -952.0256572691966, -517.1576000263951, -740.5257850594184, -817.1094983450878, -661.1972732111882, -383.1390695645867, -502.532414259721, -483.4815904067805, -956.7684228055988, -88.41874908207707, -440.1274361933607, -655.0653227397443, -669.4552932506554, -568.3644854990172, -551.926258414535, -77.21805123279401, -774.2254284221352, -280.5224004844453, -61.23595732021625, -618.2746033228061, -973.8218198535179, -569.8301024250562, -673.9259673668066, -718.468045861893, -1177.1797706998577, -740.6669357681342, -328.9925866565275, -115.3602548700642, -963.0219003914169, -494.2119802803714, -478.5510556480491, -361.8467575982876, -256.35668700576133, -666.508627577499, -1255.1295842165632, -942.2813757489658, -711.1041507179739, -190.30721222063718, -665.8532769712878, -687.164766607036, -1376.6388535103315, -751.3544151315225, -1114.5025743929752, -798.9651804281441, -306.76948735684255, -142.1508065922827, -516.3916151600572, -366.402880101201, -134.55256409279085, -1141.4853556598443, -410.200045876516, -316.833107015868, -278.17750283456496, -960.5929144749658, -1125.8067276075158, -592.3387692473336, -841.3781070203295, -951.2938461261923, -91.67788791018347, -1046.185689222429, -367.5073864628119, -787.7497653396765, -934.6341340161687, -490.2557596802422, -159.14748923151683, -789.4983891691633, -580.7957526973919, -534.472960128638, -94.73003020106994, -77.28650436178461, -305.78083004874213, -136.91470909082048, -30.838047509993594, -647.0828840311602, -1090.5202035152488, -890.414091185153, -42.766072768203436, -1166.1755659978646, -850.6877945670128, -341.32227805460366, -629.880545385382, -807.4462868612993, -1109.7831077755309, -651.947470870972, -853.5423392129214, -581.1438006863187, -477.9343094368331, -850.8714682391737, -532.8603589178337, -888.5889679768162, -784.1986720085469], "episode_lengths": [150, 150, 150, 150, 150, 57, 91, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 72, 150, 150, 150, 131, 150, 85, 150, 150, 56, 150, 150, 132, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 83, 108, 150, 75, 150, 150, 150, 90, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 115, 61, 150, 150, 150, 53, 69, 93, 62, 60, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-718.51303506732, -989.8131602056773, -683.0644104082457, -637.2783375020196, -1009.899733455689, -50.148063887980754, -215.42780881015966, -831.262184486221, -560.552820180254, -952.0256572691966, -517.1576000263951, -740.5257850594184, -817.1094983450878, -661.1972732111882, -383.1390695645867, -502.532414259721, -483.4815904067805, -956.7684228055988, -88.41874908207707, -440.1274361933607, -655.0653227397443, -669.4552932506554, -568.3644854990172, -551.926258414535, -77.21805123279401, -774.2254284221352, -280.5224004844453, -61.23595732021625, -618.2746033228061, -973.8218198535179, -569.8301024250562, -673.9259673668066, -718.468045861893, -1177.1797706998577, -740.6669357681342, -328.9925866565275, -115.3602548700642, -963.0219003914169, -494.2119802803714, -478.5510556480491, -361.8467575982876, -256.35668700576133, -666.508627577499, -1255.1295842165632, -942.2813757489658, -711.1041507179739, -190.30721222063718, -665.8532769712878, -687.164766607036, -1376.6388535103315, -751.3544151315225, -1114.5025743929752, -798.9651804281441, -306.76948735684255, -142.1508065922827, -516.3916151600572, -366.402880101201, -134.55256409279085, -1141.4853556598443, -410.200045876516, -316.833107015868, -278.17750283456496, -960.5929144749658, -1125.8067276075158, -592.3387692473336, -841.3781070203295, -951.2938461261923, -91.67788791018347, -1046.185689222429, -367.5073864628119, -787.7497653396765, -934.6341340161687, -490.2557596802422, -159.14748923151683, -789.4983891691633, -580.7957526973919, -534.472960128638, -94.73003020106994, -77.28650436178461, -305.78083004874213, -136.91470909082048, -30.838047509993594, -647.0828840311602, -1090.5202035152488, -890.414091185153, -42.766072768203436, -1166.1755659978646, -850.6877945670128, -341.32227805460366, -629.880545385382, -807.4462868612993, -1109.7831077755309, -651.947470870972, -853.5423392129214, -581.1438006863187, -477.9343094368331, -850.8714682391737, -532.8603589178337, -888.5889679768162, -784.1986720085469]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2751442914162797, "mean_inference_ms": 0.8788187145509195, "mean_action_processing_ms": 0.15763511015539922, "mean_env_wait_ms": 1.536474068168615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005623579025268555, "StateBufferConnector_ms": 0.003981113433837891, "ViewRequirementAgentConnector_ms": 0.09816813468933105}, "num_episodes": 30, "episode_return_max": -30.838047509993594, "episode_return_min": -1376.6388535103315, "episode_return_mean": -612.1579001458981, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 277.8652880318103, "num_env_steps_trained_throughput_per_sec": 277.8652880318103, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13937.62, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13937.543, "sample_time_ms": 2351.178, "learn_time_ms": 11570.051, "learn_throughput": 345.72, "synch_weights_time_ms": 15.435}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00002", "date": "2024-08-03_04-36-20", "timestamp": 1722639980, "time_this_iter_s": 14.403356075286865, "time_total_s": 250.56324005126953, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814ec20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 250.56324005126953, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 12.595238095238095, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 236.14232276479405, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.794861286878586, "policy_loss": -0.012071443878812715, "vf_loss": 3.8043098725378512, "vf_explained_var": 0.9885823030024767, "kl": 0.014613412845657595, "entropy": 1.7611596452693143, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -29.80618190298946, "episode_reward_min": -1407.7122598625583, "episode_reward_mean": -653.254000603696, "episode_len_mean": 134.84, "episode_media": {}, "episodes_timesteps_total": 13484, "policy_reward_min": {"policy_0": -1407.7122598625583}, "policy_reward_max": {"policy_0": -29.80618190298946}, "policy_reward_mean": {"policy_0": -653.254000603696}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-569.8301024250562, -673.9259673668066, -718.468045861893, -1177.1797706998577, -740.6669357681342, -328.9925866565275, -115.3602548700642, -963.0219003914169, -494.2119802803714, -478.5510556480491, -361.8467575982876, -256.35668700576133, -666.508627577499, -1255.1295842165632, -942.2813757489658, -711.1041507179739, -190.30721222063718, -665.8532769712878, -687.164766607036, -1376.6388535103315, -751.3544151315225, -1114.5025743929752, -798.9651804281441, -306.76948735684255, -142.1508065922827, -516.3916151600572, -366.402880101201, -134.55256409279085, -1141.4853556598443, -410.200045876516, -316.833107015868, -278.17750283456496, -960.5929144749658, -1125.8067276075158, -592.3387692473336, -841.3781070203295, -951.2938461261923, -91.67788791018347, -1046.185689222429, -367.5073864628119, -787.7497653396765, -934.6341340161687, -490.2557596802422, -159.14748923151683, -789.4983891691633, -580.7957526973919, -534.472960128638, -94.73003020106994, -77.28650436178461, -305.78083004874213, -136.91470909082048, -30.838047509993594, -647.0828840311602, -1090.5202035152488, -890.414091185153, -42.766072768203436, -1166.1755659978646, -850.6877945670128, -341.32227805460366, -629.880545385382, -807.4462868612993, -1109.7831077755309, -651.947470870972, -853.5423392129214, -581.1438006863187, -477.9343094368331, -850.8714682391737, -532.8603589178337, -888.5889679768162, -784.1986720085469, -628.6334644098857, -472.11309092760314, -364.250343765206, -866.8403988080764, -201.03420162308547, -29.80618190298946, -597.3257963031044, -1196.2781400364056, -1002.8712787971347, -890.7441964472825, -1239.567968775149, -916.0423979615351, -552.8603247391072, -993.074616321976, -494.377956506598, -881.1822574094529, -474.11265256352203, -209.54784255774666, -557.642867777764, -130.75239869223037, -1025.6603183603245, -1166.6219520770242, -648.0832137837746, -1407.7122598625583, -783.7746750092091, -868.5634976031505, -1220.2034274245743, -770.3790268839725, -952.9413779655035, -35.164591250668664], "episode_lengths": [132, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 83, 108, 150, 75, 150, 150, 150, 90, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 115, 61, 150, 150, 150, 53, 69, 93, 62, 60, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 72, 41, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52], "policy_policy_0_reward": [-569.8301024250562, -673.9259673668066, -718.468045861893, -1177.1797706998577, -740.6669357681342, -328.9925866565275, -115.3602548700642, -963.0219003914169, -494.2119802803714, -478.5510556480491, -361.8467575982876, -256.35668700576133, -666.508627577499, -1255.1295842165632, -942.2813757489658, -711.1041507179739, -190.30721222063718, -665.8532769712878, -687.164766607036, -1376.6388535103315, -751.3544151315225, -1114.5025743929752, -798.9651804281441, -306.76948735684255, -142.1508065922827, -516.3916151600572, -366.402880101201, -134.55256409279085, -1141.4853556598443, -410.200045876516, -316.833107015868, -278.17750283456496, -960.5929144749658, -1125.8067276075158, -592.3387692473336, -841.3781070203295, -951.2938461261923, -91.67788791018347, -1046.185689222429, -367.5073864628119, -787.7497653396765, -934.6341340161687, -490.2557596802422, -159.14748923151683, -789.4983891691633, -580.7957526973919, -534.472960128638, -94.73003020106994, -77.28650436178461, -305.78083004874213, -136.91470909082048, -30.838047509993594, -647.0828840311602, -1090.5202035152488, -890.414091185153, -42.766072768203436, -1166.1755659978646, -850.6877945670128, -341.32227805460366, -629.880545385382, -807.4462868612993, -1109.7831077755309, -651.947470870972, -853.5423392129214, -581.1438006863187, -477.9343094368331, -850.8714682391737, -532.8603589178337, -888.5889679768162, -784.1986720085469, -628.6334644098857, -472.11309092760314, -364.250343765206, -866.8403988080764, -201.03420162308547, -29.80618190298946, -597.3257963031044, -1196.2781400364056, -1002.8712787971347, -890.7441964472825, -1239.567968775149, -916.0423979615351, -552.8603247391072, -993.074616321976, -494.377956506598, -881.1822574094529, -474.11265256352203, -209.54784255774666, -557.642867777764, -130.75239869223037, -1025.6603183603245, -1166.6219520770242, -648.0832137837746, -1407.7122598625583, -783.7746750092091, -868.5634976031505, -1220.2034274245743, -770.3790268839725, -952.9413779655035, -35.164591250668664]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27517096134858177, "mean_inference_ms": 0.8782514073427414, "mean_action_processing_ms": 0.157599731135634, "mean_env_wait_ms": 1.5378248058801172, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005704402923583984, "StateBufferConnector_ms": 0.00407719612121582, "ViewRequirementAgentConnector_ms": 0.10026907920837402}, "num_episodes": 30, "episode_return_max": -29.80618190298946, "episode_return_min": -1407.7122598625583, "episode_return_mean": -653.254000603696, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.09523897445473, "num_env_steps_trained_throughput_per_sec": 281.09523897445473, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13988.971, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13988.894, "sample_time_ms": 2361.213, "learn_time_ms": 11611.378, "learn_throughput": 344.49, "synch_weights_time_ms": 15.457}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00002", "date": "2024-08-03_04-36-35", "timestamp": 1722639995, "time_this_iter_s": 14.238330841064453, "time_total_s": 264.801570892334, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b580e9240>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 264.801570892334, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 12.9, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 223.56329509019852, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.752189170445005, "policy_loss": -0.008985886808174352, "vf_loss": 3.7588640888532003, "vf_explained_var": 0.9872151186068853, "kl": 0.01372001771342186, "entropy": 1.8050399644921222, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -29.80618190298946, "episode_reward_min": -1407.7122598625583, "episode_reward_mean": -673.3501244704695, "episode_len_mean": 133.77, "episode_media": {}, "episodes_timesteps_total": 13377, "policy_reward_min": {"policy_0": -1407.7122598625583}, "policy_reward_max": {"policy_0": -29.80618190298946}, "policy_reward_mean": {"policy_0": -673.3501244704695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-278.17750283456496, -960.5929144749658, -1125.8067276075158, -592.3387692473336, -841.3781070203295, -951.2938461261923, -91.67788791018347, -1046.185689222429, -367.5073864628119, -787.7497653396765, -934.6341340161687, -490.2557596802422, -159.14748923151683, -789.4983891691633, -580.7957526973919, -534.472960128638, -94.73003020106994, -77.28650436178461, -305.78083004874213, -136.91470909082048, -30.838047509993594, -647.0828840311602, -1090.5202035152488, -890.414091185153, -42.766072768203436, -1166.1755659978646, -850.6877945670128, -341.32227805460366, -629.880545385382, -807.4462868612993, -1109.7831077755309, -651.947470870972, -853.5423392129214, -581.1438006863187, -477.9343094368331, -850.8714682391737, -532.8603589178337, -888.5889679768162, -784.1986720085469, -628.6334644098857, -472.11309092760314, -364.250343765206, -866.8403988080764, -201.03420162308547, -29.80618190298946, -597.3257963031044, -1196.2781400364056, -1002.8712787971347, -890.7441964472825, -1239.567968775149, -916.0423979615351, -552.8603247391072, -993.074616321976, -494.377956506598, -881.1822574094529, -474.11265256352203, -209.54784255774666, -557.642867777764, -130.75239869223037, -1025.6603183603245, -1166.6219520770242, -648.0832137837746, -1407.7122598625583, -783.7746750092091, -868.5634976031505, -1220.2034274245743, -770.3790268839725, -952.9413779655035, -35.164591250668664, -981.5911357464133, -1009.9320436678455, -181.28762064753403, -949.2756574802182, -69.88210598686352, -379.8819760896754, -373.66699501835666, -741.1875908819555, -563.4396748406728, -733.7036878849985, -1386.6764030831466, -932.2088185033406, -870.4723321847848, -595.4164645203427, -356.1379320221278, -881.3103591240551, -316.1180707345249, -950.5716432639781, -91.93383235420389, -508.42949789333227, -469.71188586837474, -957.8512736752709, -1165.3793444487542, -338.2172134154223, -596.7142805446193, -678.2242639437279, -966.0622555536578, -1315.8146627640613, -1283.0874224477907, -696.6470424484348, -41.78682358943943], "episode_lengths": [90, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 115, 61, 150, 150, 150, 53, 69, 93, 62, 60, 150, 150, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 72, 41, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 74, 150, 62, 150, 136, 150, 150, 150, 150, 150, 150, 150, 97, 150, 137, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45], "policy_policy_0_reward": [-278.17750283456496, -960.5929144749658, -1125.8067276075158, -592.3387692473336, -841.3781070203295, -951.2938461261923, -91.67788791018347, -1046.185689222429, -367.5073864628119, -787.7497653396765, -934.6341340161687, -490.2557596802422, -159.14748923151683, -789.4983891691633, -580.7957526973919, -534.472960128638, -94.73003020106994, -77.28650436178461, -305.78083004874213, -136.91470909082048, -30.838047509993594, -647.0828840311602, -1090.5202035152488, -890.414091185153, -42.766072768203436, -1166.1755659978646, -850.6877945670128, -341.32227805460366, -629.880545385382, -807.4462868612993, -1109.7831077755309, -651.947470870972, -853.5423392129214, -581.1438006863187, -477.9343094368331, -850.8714682391737, -532.8603589178337, -888.5889679768162, -784.1986720085469, -628.6334644098857, -472.11309092760314, -364.250343765206, -866.8403988080764, -201.03420162308547, -29.80618190298946, -597.3257963031044, -1196.2781400364056, -1002.8712787971347, -890.7441964472825, -1239.567968775149, -916.0423979615351, -552.8603247391072, -993.074616321976, -494.377956506598, -881.1822574094529, -474.11265256352203, -209.54784255774666, -557.642867777764, -130.75239869223037, -1025.6603183603245, -1166.6219520770242, -648.0832137837746, -1407.7122598625583, -783.7746750092091, -868.5634976031505, -1220.2034274245743, -770.3790268839725, -952.9413779655035, -35.164591250668664, -981.5911357464133, -1009.9320436678455, -181.28762064753403, -949.2756574802182, -69.88210598686352, -379.8819760896754, -373.66699501835666, -741.1875908819555, -563.4396748406728, -733.7036878849985, -1386.6764030831466, -932.2088185033406, -870.4723321847848, -595.4164645203427, -356.1379320221278, -881.3103591240551, -316.1180707345249, -950.5716432639781, -91.93383235420389, -508.42949789333227, -469.71188586837474, -957.8512736752709, -1165.3793444487542, -338.2172134154223, -596.7142805446193, -678.2242639437279, -966.0622555536578, -1315.8146627640613, -1283.0874224477907, -696.6470424484348, -41.78682358943943]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2752641200000901, "mean_inference_ms": 0.8782759652754021, "mean_action_processing_ms": 0.1577317704871989, "mean_env_wait_ms": 1.5394717030634393, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005615711212158203, "StateBufferConnector_ms": 0.004032611846923828, "ViewRequirementAgentConnector_ms": 0.0987691879272461}, "num_episodes": 31, "episode_return_max": -29.80618190298946, "episode_return_min": -1407.7122598625583, "episode_return_mean": -673.3501244704695, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.1875288510201, "num_env_steps_trained_throughput_per_sec": 282.1875288510201, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 14072.588, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14072.51, "sample_time_ms": 2364.305, "learn_time_ms": 11691.937, "learn_throughput": 342.116, "synch_weights_time_ms": 15.434}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00002", "date": "2024-08-03_04-36-49", "timestamp": 1722640009, "time_this_iter_s": 14.181787967681885, "time_total_s": 278.98335886001587, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x73603c78eef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 278.98335886001587, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 12.649999999999999, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 289.42895282705626, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.585976059858998, "policy_loss": -0.009650634025456383, "vf_loss": 3.592613230769833, "vf_explained_var": 0.9909158763786157, "kl": 0.015768353984458392, "entropy": 1.7170325078070163, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -29.80618190298946, "episode_reward_min": -1407.7122598625583, "episode_reward_mean": -700.2275925833857, "episode_len_mean": 137.16, "episode_media": {}, "episodes_timesteps_total": 13716, "policy_reward_min": {"policy_0": -1407.7122598625583}, "policy_reward_max": {"policy_0": -29.80618190298946}, "policy_reward_mean": {"policy_0": -700.2275925833857}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-807.4462868612993, -1109.7831077755309, -651.947470870972, -853.5423392129214, -581.1438006863187, -477.9343094368331, -850.8714682391737, -532.8603589178337, -888.5889679768162, -784.1986720085469, -628.6334644098857, -472.11309092760314, -364.250343765206, -866.8403988080764, -201.03420162308547, -29.80618190298946, -597.3257963031044, -1196.2781400364056, -1002.8712787971347, -890.7441964472825, -1239.567968775149, -916.0423979615351, -552.8603247391072, -993.074616321976, -494.377956506598, -881.1822574094529, -474.11265256352203, -209.54784255774666, -557.642867777764, -130.75239869223037, -1025.6603183603245, -1166.6219520770242, -648.0832137837746, -1407.7122598625583, -783.7746750092091, -868.5634976031505, -1220.2034274245743, -770.3790268839725, -952.9413779655035, -35.164591250668664, -981.5911357464133, -1009.9320436678455, -181.28762064753403, -949.2756574802182, -69.88210598686352, -379.8819760896754, -373.66699501835666, -741.1875908819555, -563.4396748406728, -733.7036878849985, -1386.6764030831466, -932.2088185033406, -870.4723321847848, -595.4164645203427, -356.1379320221278, -881.3103591240551, -316.1180707345249, -950.5716432639781, -91.93383235420389, -508.42949789333227, -469.71188586837474, -957.8512736752709, -1165.3793444487542, -338.2172134154223, -596.7142805446193, -678.2242639437279, -966.0622555536578, -1315.8146627640613, -1283.0874224477907, -696.6470424484348, -41.78682358943943, -421.4483864544811, -1317.0108195753553, -889.8321665889721, -802.2392899129368, -345.274264917783, -710.5696622414024, -938.6705804493876, -806.6967750647123, -233.90563082966904, -136.538929083589, -1005.8751674586852, -931.1653324517051, -576.2736976445034, -834.0530884235942, -1027.0098951425064, -254.03317817217317, -809.4865579312545, -945.7312798109618, -661.4748809176366, -146.8371123464397, -406.17768520530984, -436.6512778613696, -298.6085093745811, -907.7555246551052, -82.12528783904474, -624.1030576683413, -1081.2465686602598, -846.2712715532798, -1046.593570942748], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 72, 41, 132, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 74, 150, 62, 150, 136, 150, 150, 150, 150, 150, 150, 150, 97, 150, 137, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 115, 150, 150, 150, 150, 150, 150, 150, 76, 71, 150, 150, 150, 150, 150, 82, 150, 150, 150, 91, 107, 150, 150, 150, 55, 150, 150, 150, 150], "policy_policy_0_reward": [-807.4462868612993, -1109.7831077755309, -651.947470870972, -853.5423392129214, -581.1438006863187, -477.9343094368331, -850.8714682391737, -532.8603589178337, -888.5889679768162, -784.1986720085469, -628.6334644098857, -472.11309092760314, -364.250343765206, -866.8403988080764, -201.03420162308547, -29.80618190298946, -597.3257963031044, -1196.2781400364056, -1002.8712787971347, -890.7441964472825, -1239.567968775149, -916.0423979615351, -552.8603247391072, -993.074616321976, -494.377956506598, -881.1822574094529, -474.11265256352203, -209.54784255774666, -557.642867777764, -130.75239869223037, -1025.6603183603245, -1166.6219520770242, -648.0832137837746, -1407.7122598625583, -783.7746750092091, -868.5634976031505, -1220.2034274245743, -770.3790268839725, -952.9413779655035, -35.164591250668664, -981.5911357464133, -1009.9320436678455, -181.28762064753403, -949.2756574802182, -69.88210598686352, -379.8819760896754, -373.66699501835666, -741.1875908819555, -563.4396748406728, -733.7036878849985, -1386.6764030831466, -932.2088185033406, -870.4723321847848, -595.4164645203427, -356.1379320221278, -881.3103591240551, -316.1180707345249, -950.5716432639781, -91.93383235420389, -508.42949789333227, -469.71188586837474, -957.8512736752709, -1165.3793444487542, -338.2172134154223, -596.7142805446193, -678.2242639437279, -966.0622555536578, -1315.8146627640613, -1283.0874224477907, -696.6470424484348, -41.78682358943943, -421.4483864544811, -1317.0108195753553, -889.8321665889721, -802.2392899129368, -345.274264917783, -710.5696622414024, -938.6705804493876, -806.6967750647123, -233.90563082966904, -136.538929083589, -1005.8751674586852, -931.1653324517051, -576.2736976445034, -834.0530884235942, -1027.0098951425064, -254.03317817217317, -809.4865579312545, -945.7312798109618, -661.4748809176366, -146.8371123464397, -406.17768520530984, -436.6512778613696, -298.6085093745811, -907.7555246551052, -82.12528783904474, -624.1030576683413, -1081.2465686602598, -846.2712715532798, -1046.593570942748]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27519455721661024, "mean_inference_ms": 0.877762227845651, "mean_action_processing_ms": 0.15762977870352887, "mean_env_wait_ms": 1.5403557826397338, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005379438400268555, "StateBufferConnector_ms": 0.003992557525634766, "ViewRequirementAgentConnector_ms": 0.09795618057250977}, "num_episodes": 29, "episode_return_max": -29.80618190298946, "episode_return_min": -1407.7122598625583, "episode_return_mean": -700.2275925833857, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 282.7317531712962, "num_env_steps_trained_throughput_per_sec": 282.7317531712962, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 14100.55, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14100.475, "sample_time_ms": 2366.302, "learn_time_ms": 11717.902, "learn_throughput": 341.358, "synch_weights_time_ms": 15.442}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00002", "date": "2024-08-03_04-37-03", "timestamp": 1722640023, "time_this_iter_s": 14.155235052108765, "time_total_s": 293.13859391212463, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814f1c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 293.13859391212463, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 12.785, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 250.93582284053167, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.8971170514822004, "policy_loss": -0.01097313123512625, "vf_loss": 3.9050779876609645, "vf_explained_var": 0.9842053418979049, "kl": 0.01574262108809613, "entropy": 1.7105941520382961, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -35.164591250668664, "episode_reward_min": -1407.7122598625583, "episode_reward_mean": -704.7893855549261, "episode_len_mean": 136.28, "episode_media": {}, "episodes_timesteps_total": 13628, "policy_reward_min": {"policy_0": -1407.7122598625583}, "policy_reward_max": {"policy_0": -35.164591250668664}, "policy_reward_mean": {"policy_0": -704.7893855549261}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-130.75239869223037, -1025.6603183603245, -1166.6219520770242, -648.0832137837746, -1407.7122598625583, -783.7746750092091, -868.5634976031505, -1220.2034274245743, -770.3790268839725, -952.9413779655035, -35.164591250668664, -981.5911357464133, -1009.9320436678455, -181.28762064753403, -949.2756574802182, -69.88210598686352, -379.8819760896754, -373.66699501835666, -741.1875908819555, -563.4396748406728, -733.7036878849985, -1386.6764030831466, -932.2088185033406, -870.4723321847848, -595.4164645203427, -356.1379320221278, -881.3103591240551, -316.1180707345249, -950.5716432639781, -91.93383235420389, -508.42949789333227, -469.71188586837474, -957.8512736752709, -1165.3793444487542, -338.2172134154223, -596.7142805446193, -678.2242639437279, -966.0622555536578, -1315.8146627640613, -1283.0874224477907, -696.6470424484348, -41.78682358943943, -421.4483864544811, -1317.0108195753553, -889.8321665889721, -802.2392899129368, -345.274264917783, -710.5696622414024, -938.6705804493876, -806.6967750647123, -233.90563082966904, -136.538929083589, -1005.8751674586852, -931.1653324517051, -576.2736976445034, -834.0530884235942, -1027.0098951425064, -254.03317817217317, -809.4865579312545, -945.7312798109618, -661.4748809176366, -146.8371123464397, -406.17768520530984, -436.6512778613696, -298.6085093745811, -907.7555246551052, -82.12528783904474, -624.1030576683413, -1081.2465686602598, -846.2712715532798, -1046.593570942748, -829.71038362657, -269.06550377603736, -1138.9456570938846, -955.9701740353713, -529.7936509047445, -699.8154081041595, -481.8764632773941, -1047.156186629981, -431.5049117114527, -1151.2315739110727, -445.54357451929917, -928.2802610687502, -387.07346371745774, -1049.6851149122213, -582.1265532735632, -542.6632547858077, -172.88700399119878, -94.0979918175079, -1311.7066228889867, -366.98416609963436, -832.8914888926579, -273.2905616955491, -553.658635585475, -1363.2596886719036, -1104.4769266540209, -1094.542935471215, -1020.709411891183, -445.22441957100517, -458.63006819580994], "episode_lengths": [94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 74, 150, 62, 150, 136, 150, 150, 150, 150, 150, 150, 150, 97, 150, 137, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 115, 150, 150, 150, 150, 150, 150, 150, 76, 71, 150, 150, 150, 150, 150, 82, 150, 150, 150, 91, 107, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 139, 83, 55, 150, 98, 150, 85, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-130.75239869223037, -1025.6603183603245, -1166.6219520770242, -648.0832137837746, -1407.7122598625583, -783.7746750092091, -868.5634976031505, -1220.2034274245743, -770.3790268839725, -952.9413779655035, -35.164591250668664, -981.5911357464133, -1009.9320436678455, -181.28762064753403, -949.2756574802182, -69.88210598686352, -379.8819760896754, -373.66699501835666, -741.1875908819555, -563.4396748406728, -733.7036878849985, -1386.6764030831466, -932.2088185033406, -870.4723321847848, -595.4164645203427, -356.1379320221278, -881.3103591240551, -316.1180707345249, -950.5716432639781, -91.93383235420389, -508.42949789333227, -469.71188586837474, -957.8512736752709, -1165.3793444487542, -338.2172134154223, -596.7142805446193, -678.2242639437279, -966.0622555536578, -1315.8146627640613, -1283.0874224477907, -696.6470424484348, -41.78682358943943, -421.4483864544811, -1317.0108195753553, -889.8321665889721, -802.2392899129368, -345.274264917783, -710.5696622414024, -938.6705804493876, -806.6967750647123, -233.90563082966904, -136.538929083589, -1005.8751674586852, -931.1653324517051, -576.2736976445034, -834.0530884235942, -1027.0098951425064, -254.03317817217317, -809.4865579312545, -945.7312798109618, -661.4748809176366, -146.8371123464397, -406.17768520530984, -436.6512778613696, -298.6085093745811, -907.7555246551052, -82.12528783904474, -624.1030576683413, -1081.2465686602598, -846.2712715532798, -1046.593570942748, -829.71038362657, -269.06550377603736, -1138.9456570938846, -955.9701740353713, -529.7936509047445, -699.8154081041595, -481.8764632773941, -1047.156186629981, -431.5049117114527, -1151.2315739110727, -445.54357451929917, -928.2802610687502, -387.07346371745774, -1049.6851149122213, -582.1265532735632, -542.6632547858077, -172.88700399119878, -94.0979918175079, -1311.7066228889867, -366.98416609963436, -832.8914888926579, -273.2905616955491, -553.658635585475, -1363.2596886719036, -1104.4769266540209, -1094.542935471215, -1020.709411891183, -445.22441957100517, -458.63006819580994]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27517539600949326, "mean_inference_ms": 0.8772974840791314, "mean_action_processing_ms": 0.15763309476514062, "mean_env_wait_ms": 1.5415748454367435, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005081653594970703, "StateBufferConnector_ms": 0.0038886070251464844, "ViewRequirementAgentConnector_ms": 0.09596133232116699}, "num_episodes": 29, "episode_return_max": -35.164591250668664, "episode_return_min": -1407.7122598625583, "episode_return_mean": -704.7893855549261, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.4415171983348, "num_env_steps_trained_throughput_per_sec": 284.4415171983348, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 14085.755, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14085.682, "sample_time_ms": 2366.586, "learn_time_ms": 11703.212, "learn_throughput": 341.787, "synch_weights_time_ms": 15.099}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00002", "date": "2024-08-03_04-37-17", "timestamp": 1722640037, "time_this_iter_s": 14.069722652435303, "time_total_s": 307.20831656455994, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270c0d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 307.20831656455994, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 12.595, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 327.37115807533263, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.8456694754461447, "policy_loss": -0.008634203921246808, "vf_loss": 3.8520377506812413, "vf_explained_var": 0.9848448673884074, "kl": 0.013182181721443482, "entropy": 1.688711486880978, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -41.78682358943943, "episode_reward_min": -1363.2596886719036, "episode_reward_mean": -708.0616271781608, "episode_len_mean": 137.23, "episode_media": {}, "episodes_timesteps_total": 13723, "policy_reward_min": {"policy_0": -1363.2596886719036}, "policy_reward_max": {"policy_0": -41.78682358943943}, "policy_reward_mean": {"policy_0": -708.0616271781608}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-508.42949789333227, -469.71188586837474, -957.8512736752709, -1165.3793444487542, -338.2172134154223, -596.7142805446193, -678.2242639437279, -966.0622555536578, -1315.8146627640613, -1283.0874224477907, -696.6470424484348, -41.78682358943943, -421.4483864544811, -1317.0108195753553, -889.8321665889721, -802.2392899129368, -345.274264917783, -710.5696622414024, -938.6705804493876, -806.6967750647123, -233.90563082966904, -136.538929083589, -1005.8751674586852, -931.1653324517051, -576.2736976445034, -834.0530884235942, -1027.0098951425064, -254.03317817217317, -809.4865579312545, -945.7312798109618, -661.4748809176366, -146.8371123464397, -406.17768520530984, -436.6512778613696, -298.6085093745811, -907.7555246551052, -82.12528783904474, -624.1030576683413, -1081.2465686602598, -846.2712715532798, -1046.593570942748, -829.71038362657, -269.06550377603736, -1138.9456570938846, -955.9701740353713, -529.7936509047445, -699.8154081041595, -481.8764632773941, -1047.156186629981, -431.5049117114527, -1151.2315739110727, -445.54357451929917, -928.2802610687502, -387.07346371745774, -1049.6851149122213, -582.1265532735632, -542.6632547858077, -172.88700399119878, -94.0979918175079, -1311.7066228889867, -366.98416609963436, -832.8914888926579, -273.2905616955491, -553.658635585475, -1363.2596886719036, -1104.4769266540209, -1094.542935471215, -1020.709411891183, -445.22441957100517, -458.63006819580994, -870.0270827908238, -643.7889471193768, -325.8411625460824, -574.1505165971582, -651.6017259254664, -1357.369261253587, -994.548500297516, -1177.1775940743732, -595.4132233726154, -121.79544093540376, -936.630246564434, -338.9511399619991, -1043.9768537958255, -525.8077524466328, -970.286721278831, -869.8439224468507, -754.4553693814972, -915.5833401324178, -776.7515804548606, -1101.3119065972687, -910.5298496579524, -852.957578432363, -790.7319366934474, -989.962209224173, -302.40036239178147, -119.0444713098895, -387.6850751423236, -439.41771036160344, -1106.4941015720997, -257.2396625128339], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 45, 115, 150, 150, 150, 150, 150, 150, 150, 76, 71, 150, 150, 150, 150, 150, 82, 150, 150, 150, 91, 107, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 139, 83, 55, 150, 98, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 74, 150, 90, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 86, 150, 116, 150, 99], "policy_policy_0_reward": [-508.42949789333227, -469.71188586837474, -957.8512736752709, -1165.3793444487542, -338.2172134154223, -596.7142805446193, -678.2242639437279, -966.0622555536578, -1315.8146627640613, -1283.0874224477907, -696.6470424484348, -41.78682358943943, -421.4483864544811, -1317.0108195753553, -889.8321665889721, -802.2392899129368, -345.274264917783, -710.5696622414024, -938.6705804493876, -806.6967750647123, -233.90563082966904, -136.538929083589, -1005.8751674586852, -931.1653324517051, -576.2736976445034, -834.0530884235942, -1027.0098951425064, -254.03317817217317, -809.4865579312545, -945.7312798109618, -661.4748809176366, -146.8371123464397, -406.17768520530984, -436.6512778613696, -298.6085093745811, -907.7555246551052, -82.12528783904474, -624.1030576683413, -1081.2465686602598, -846.2712715532798, -1046.593570942748, -829.71038362657, -269.06550377603736, -1138.9456570938846, -955.9701740353713, -529.7936509047445, -699.8154081041595, -481.8764632773941, -1047.156186629981, -431.5049117114527, -1151.2315739110727, -445.54357451929917, -928.2802610687502, -387.07346371745774, -1049.6851149122213, -582.1265532735632, -542.6632547858077, -172.88700399119878, -94.0979918175079, -1311.7066228889867, -366.98416609963436, -832.8914888926579, -273.2905616955491, -553.658635585475, -1363.2596886719036, -1104.4769266540209, -1094.542935471215, -1020.709411891183, -445.22441957100517, -458.63006819580994, -870.0270827908238, -643.7889471193768, -325.8411625460824, -574.1505165971582, -651.6017259254664, -1357.369261253587, -994.548500297516, -1177.1775940743732, -595.4132233726154, -121.79544093540376, -936.630246564434, -338.9511399619991, -1043.9768537958255, -525.8077524466328, -970.286721278831, -869.8439224468507, -754.4553693814972, -915.5833401324178, -776.7515804548606, -1101.3119065972687, -910.5298496579524, -852.957578432363, -790.7319366934474, -989.962209224173, -302.40036239178147, -119.0444713098895, -387.6850751423236, -439.41771036160344, -1106.4941015720997, -257.2396625128339]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2751956791958371, "mean_inference_ms": 0.8767076593727654, "mean_action_processing_ms": 0.1576390620933918, "mean_env_wait_ms": 1.5421538429087343, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004945516586303711, "StateBufferConnector_ms": 0.003901958465576172, "ViewRequirementAgentConnector_ms": 0.09631133079528809}, "num_episodes": 30, "episode_return_max": -41.78682358943943, "episode_return_min": -1363.2596886719036, "episode_return_mean": -708.0616271781608, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.66448818647405, "num_env_steps_trained_throughput_per_sec": 284.66448818647405, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 14062.38, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14062.307, "sample_time_ms": 2367.071, "learn_time_ms": 11679.235, "learn_throughput": 342.488, "synch_weights_time_ms": 15.209}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00002", "date": "2024-08-03_04-37-31", "timestamp": 1722640051, "time_this_iter_s": 14.058846950531006, "time_total_s": 321.26716351509094, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814c670>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.26716351509094, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 12.569999999999999, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 307.4841091712316, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.509776832163334, "policy_loss": -0.010736415085557383, "vf_loss": 3.5169683627784254, "vf_explained_var": 0.9890701067323486, "kl": 0.017564708156199555, "entropy": 1.724524067590634, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -82.12528783904474, "episode_reward_min": -1363.2596886719036, "episode_reward_mean": -724.5702128016428, "episode_len_mean": 138.44, "episode_media": {}, "episodes_timesteps_total": 13844, "policy_reward_min": {"policy_0": -1363.2596886719036}, "policy_reward_max": {"policy_0": -82.12528783904474}, "policy_reward_mean": {"policy_0": -724.5702128016428}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-254.03317817217317, -809.4865579312545, -945.7312798109618, -661.4748809176366, -146.8371123464397, -406.17768520530984, -436.6512778613696, -298.6085093745811, -907.7555246551052, -82.12528783904474, -624.1030576683413, -1081.2465686602598, -846.2712715532798, -1046.593570942748, -829.71038362657, -269.06550377603736, -1138.9456570938846, -955.9701740353713, -529.7936509047445, -699.8154081041595, -481.8764632773941, -1047.156186629981, -431.5049117114527, -1151.2315739110727, -445.54357451929917, -928.2802610687502, -387.07346371745774, -1049.6851149122213, -582.1265532735632, -542.6632547858077, -172.88700399119878, -94.0979918175079, -1311.7066228889867, -366.98416609963436, -832.8914888926579, -273.2905616955491, -553.658635585475, -1363.2596886719036, -1104.4769266540209, -1094.542935471215, -1020.709411891183, -445.22441957100517, -458.63006819580994, -870.0270827908238, -643.7889471193768, -325.8411625460824, -574.1505165971582, -651.6017259254664, -1357.369261253587, -994.548500297516, -1177.1775940743732, -595.4132233726154, -121.79544093540376, -936.630246564434, -338.9511399619991, -1043.9768537958255, -525.8077524466328, -970.286721278831, -869.8439224468507, -754.4553693814972, -915.5833401324178, -776.7515804548606, -1101.3119065972687, -910.5298496579524, -852.957578432363, -790.7319366934474, -989.962209224173, -302.40036239178147, -119.0444713098895, -387.6850751423236, -439.41771036160344, -1106.4941015720997, -257.2396625128339, -750.3226490576144, -1069.3806416134391, -831.0657587217204, -1139.5895218573512, -861.3962610377516, -309.36422916733034, -624.4429028402978, -447.98594289764947, -653.9366789986611, -651.7153021769215, -703.5644130530014, -1247.2001961676306, -1260.5707592765118, -929.4992626265107, -1003.4015746555118, -915.2119026766202, -861.8560040848571, -888.3157370687858, -833.4146845317669, -1035.4626664020304, -581.8469512334291, -467.4296752644315, -1220.5372525908183, -162.65944768127386, -975.9361737431819, -878.78169993913, -340.45992581614814], "episode_lengths": [82, 150, 150, 150, 91, 107, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 139, 83, 55, 150, 98, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 74, 150, 90, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 86, 150, 116, 150, 99, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 99], "policy_policy_0_reward": [-254.03317817217317, -809.4865579312545, -945.7312798109618, -661.4748809176366, -146.8371123464397, -406.17768520530984, -436.6512778613696, -298.6085093745811, -907.7555246551052, -82.12528783904474, -624.1030576683413, -1081.2465686602598, -846.2712715532798, -1046.593570942748, -829.71038362657, -269.06550377603736, -1138.9456570938846, -955.9701740353713, -529.7936509047445, -699.8154081041595, -481.8764632773941, -1047.156186629981, -431.5049117114527, -1151.2315739110727, -445.54357451929917, -928.2802610687502, -387.07346371745774, -1049.6851149122213, -582.1265532735632, -542.6632547858077, -172.88700399119878, -94.0979918175079, -1311.7066228889867, -366.98416609963436, -832.8914888926579, -273.2905616955491, -553.658635585475, -1363.2596886719036, -1104.4769266540209, -1094.542935471215, -1020.709411891183, -445.22441957100517, -458.63006819580994, -870.0270827908238, -643.7889471193768, -325.8411625460824, -574.1505165971582, -651.6017259254664, -1357.369261253587, -994.548500297516, -1177.1775940743732, -595.4132233726154, -121.79544093540376, -936.630246564434, -338.9511399619991, -1043.9768537958255, -525.8077524466328, -970.286721278831, -869.8439224468507, -754.4553693814972, -915.5833401324178, -776.7515804548606, -1101.3119065972687, -910.5298496579524, -852.957578432363, -790.7319366934474, -989.962209224173, -302.40036239178147, -119.0444713098895, -387.6850751423236, -439.41771036160344, -1106.4941015720997, -257.2396625128339, -750.3226490576144, -1069.3806416134391, -831.0657587217204, -1139.5895218573512, -861.3962610377516, -309.36422916733034, -624.4429028402978, -447.98594289764947, -653.9366789986611, -651.7153021769215, -703.5644130530014, -1247.2001961676306, -1260.5707592765118, -929.4992626265107, -1003.4015746555118, -915.2119026766202, -861.8560040848571, -888.3157370687858, -833.4146845317669, -1035.4626664020304, -581.8469512334291, -467.4296752644315, -1220.5372525908183, -162.65944768127386, -975.9361737431819, -878.78169993913, -340.45992581614814]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27514121475678777, "mean_inference_ms": 0.8758605807838973, "mean_action_processing_ms": 0.15754519143308673, "mean_env_wait_ms": 1.5428423212590614, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004860877990722656, "StateBufferConnector_ms": 0.0038709640502929688, "ViewRequirementAgentConnector_ms": 0.0957181453704834}, "num_episodes": 27, "episode_return_max": -82.12528783904474, "episode_return_min": -1363.2596886719036, "episode_return_mean": -724.5702128016428, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 287.61605532141397, "num_env_steps_trained_throughput_per_sec": 287.61605532141397, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 14014.252, "restore_workers_time_ms": 0.023, "training_step_time_ms": 14014.18, "sample_time_ms": 2361.345, "learn_time_ms": 11636.935, "learn_throughput": 343.733, "synch_weights_time_ms": 15.121}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00002", "date": "2024-08-03_04-37-45", "timestamp": 1722640065, "time_this_iter_s": 13.914921998977661, "time_total_s": 335.1820855140686, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b3270ea70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 335.1820855140686, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 12.655000000000001, "ram_util_percent": 16.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 345.0851766864459, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.9492352711657683, "policy_loss": -0.010777083819266408, "vf_loss": 3.9568643040955065, "vf_explained_var": 0.980439810268581, "kl": 0.016175993333005578, "entropy": 1.7047384465734163, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -33.71835102616254, "episode_reward_min": -1363.2596886719036, "episode_reward_mean": -745.6609181661879, "episode_len_mean": 137.77, "episode_media": {}, "episodes_timesteps_total": 13777, "policy_reward_min": {"policy_0": -1363.2596886719036}, "policy_reward_max": {"policy_0": -33.71835102616254}, "policy_reward_mean": {"policy_0": -745.6609181661879}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-172.88700399119878, -94.0979918175079, -1311.7066228889867, -366.98416609963436, -832.8914888926579, -273.2905616955491, -553.658635585475, -1363.2596886719036, -1104.4769266540209, -1094.542935471215, -1020.709411891183, -445.22441957100517, -458.63006819580994, -870.0270827908238, -643.7889471193768, -325.8411625460824, -574.1505165971582, -651.6017259254664, -1357.369261253587, -994.548500297516, -1177.1775940743732, -595.4132233726154, -121.79544093540376, -936.630246564434, -338.9511399619991, -1043.9768537958255, -525.8077524466328, -970.286721278831, -869.8439224468507, -754.4553693814972, -915.5833401324178, -776.7515804548606, -1101.3119065972687, -910.5298496579524, -852.957578432363, -790.7319366934474, -989.962209224173, -302.40036239178147, -119.0444713098895, -387.6850751423236, -439.41771036160344, -1106.4941015720997, -257.2396625128339, -750.3226490576144, -1069.3806416134391, -831.0657587217204, -1139.5895218573512, -861.3962610377516, -309.36422916733034, -624.4429028402978, -447.98594289764947, -653.9366789986611, -651.7153021769215, -703.5644130530014, -1247.2001961676306, -1260.5707592765118, -929.4992626265107, -1003.4015746555118, -915.2119026766202, -861.8560040848571, -888.3157370687858, -833.4146845317669, -1035.4626664020304, -581.8469512334291, -467.4296752644315, -1220.5372525908183, -162.65944768127386, -975.9361737431819, -878.78169993913, -340.45992581614814, -1309.998150646285, -33.71835102616254, -83.43464703597155, -1054.2115707320038, -681.6508571051914, -746.9084589993729, -1244.3318809735922, -1006.9150019843685, -881.2379912252223, -789.7041516376624, -587.5904413369624, -504.5309837733564, -828.2835935059572, -553.8064216521252, -655.2498891542081, -1167.0483216321488, -505.3520991015296, -132.41220845435402, -722.2138162205359, -923.0177970546036, -211.28299229791554, -863.6950093982856, -740.4892322005669, -978.7396186775356, -1031.4362530075566, -1101.6955324071546, -1024.037434254949, -1013.0797486591384, -308.46008831267113, -442.0758922733939], "episode_lengths": [83, 55, 150, 98, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 74, 150, 90, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 86, 150, 116, 150, 99, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 91, 150, 150, 99, 150, 70, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 64, 150, 150, 112, 150, 149, 150, 150, 150, 150, 150, 90, 150], "policy_policy_0_reward": [-172.88700399119878, -94.0979918175079, -1311.7066228889867, -366.98416609963436, -832.8914888926579, -273.2905616955491, -553.658635585475, -1363.2596886719036, -1104.4769266540209, -1094.542935471215, -1020.709411891183, -445.22441957100517, -458.63006819580994, -870.0270827908238, -643.7889471193768, -325.8411625460824, -574.1505165971582, -651.6017259254664, -1357.369261253587, -994.548500297516, -1177.1775940743732, -595.4132233726154, -121.79544093540376, -936.630246564434, -338.9511399619991, -1043.9768537958255, -525.8077524466328, -970.286721278831, -869.8439224468507, -754.4553693814972, -915.5833401324178, -776.7515804548606, -1101.3119065972687, -910.5298496579524, -852.957578432363, -790.7319366934474, -989.962209224173, -302.40036239178147, -119.0444713098895, -387.6850751423236, -439.41771036160344, -1106.4941015720997, -257.2396625128339, -750.3226490576144, -1069.3806416134391, -831.0657587217204, -1139.5895218573512, -861.3962610377516, -309.36422916733034, -624.4429028402978, -447.98594289764947, -653.9366789986611, -651.7153021769215, -703.5644130530014, -1247.2001961676306, -1260.5707592765118, -929.4992626265107, -1003.4015746555118, -915.2119026766202, -861.8560040848571, -888.3157370687858, -833.4146845317669, -1035.4626664020304, -581.8469512334291, -467.4296752644315, -1220.5372525908183, -162.65944768127386, -975.9361737431819, -878.78169993913, -340.45992581614814, -1309.998150646285, -33.71835102616254, -83.43464703597155, -1054.2115707320038, -681.6508571051914, -746.9084589993729, -1244.3318809735922, -1006.9150019843685, -881.2379912252223, -789.7041516376624, -587.5904413369624, -504.5309837733564, -828.2835935059572, -553.8064216521252, -655.2498891542081, -1167.0483216321488, -505.3520991015296, -132.41220845435402, -722.2138162205359, -923.0177970546036, -211.28299229791554, -863.6950093982856, -740.4892322005669, -978.7396186775356, -1031.4362530075566, -1101.6955324071546, -1024.037434254949, -1013.0797486591384, -308.46008831267113, -442.0758922733939]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27521919889359464, "mean_inference_ms": 0.8758079083977057, "mean_action_processing_ms": 0.1575589073919081, "mean_env_wait_ms": 1.5433341591082463, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004769086837768555, "StateBufferConnector_ms": 0.0038771629333496094, "ViewRequirementAgentConnector_ms": 0.09561872482299805}, "num_episodes": 30, "episode_return_max": -33.71835102616254, "episode_return_min": -1363.2596886719036, "episode_return_mean": -745.6609181661879, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 284.84396313785925, "num_env_steps_trained_throughput_per_sec": 284.84396313785925, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 14004.124, "restore_workers_time_ms": 0.024, "training_step_time_ms": 14004.049, "sample_time_ms": 2358.484, "learn_time_ms": 11629.652, "learn_throughput": 343.948, "synch_weights_time_ms": 15.135}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00002", "date": "2024-08-03_04-37-59", "timestamp": 1722640079, "time_this_iter_s": 14.050022840499878, "time_total_s": 349.2321083545685, "pid": 479661, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b5814d480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 349.2321083545685, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 12.665000000000001, "ram_util_percent": 16.199999999999996}}
