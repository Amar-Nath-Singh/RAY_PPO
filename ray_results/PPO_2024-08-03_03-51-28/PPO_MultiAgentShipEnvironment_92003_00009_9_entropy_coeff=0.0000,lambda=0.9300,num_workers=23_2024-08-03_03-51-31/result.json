{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.1042869784869254, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.401131193339825, "policy_loss": -0.005432422989300297, "vf_loss": 9.404929009079932, "vf_explained_var": 0.011218420416116714, "kl": 0.00824283610254497, "entropy": 1.397621135537823, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -214.5598844160465, "episode_reward_min": -1026.5657591388551, "episode_reward_mean": -683.5333683724017, "episode_len_mean": 148.3913043478261, "episode_media": {}, "episodes_timesteps_total": 3413, "policy_reward_min": {"policy_0": -1026.5657591388551}, "policy_reward_max": {"policy_0": -214.5598844160465}, "policy_reward_mean": {"policy_0": -683.5333683724017}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-740.228794037985, -979.506473098369, -523.0657167316735, -778.7033942086604, -893.9835765018546, -608.8127183597426, -775.2126450664414, -505.77704684317945, -458.47705853022677, -939.4733942369425, -1026.5657591388551, -877.2472991106418, -549.4377290340094, -619.2382785087735, -841.0068798093632, -629.8002100089099, -951.000599469137, -825.8169512294123, -442.11183279994395, -396.7811469387826, -457.9746579214979, -214.5598844160465, -686.4854265647901], "episode_lengths": [150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150], "policy_policy_0_reward": [-740.228794037985, -979.506473098369, -523.0657167316735, -778.7033942086604, -893.9835765018546, -608.8127183597426, -775.2126450664414, -505.77704684317945, -458.47705853022677, -939.4733942369425, -1026.5657591388551, -877.2472991106418, -549.4377290340094, -619.2382785087735, -841.0068798093632, -629.8002100089099, -951.000599469137, -825.8169512294123, -442.11183279994395, -396.7811469387826, -457.9746579214979, -214.5598844160465, -686.4854265647901]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5688759617966505, "mean_inference_ms": 1.6573286448010476, "mean_action_processing_ms": 0.283216527981192, "mean_env_wait_ms": 2.9598663460393873, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010958961818529211, "StateBufferConnector_ms": 0.00783464182978091, "ViewRequirementAgentConnector_ms": 0.17717299254044241}, "num_episodes": 23, "episode_return_max": -214.5598844160465, "episode_return_min": -1026.5657591388551, "episode_return_mean": -683.5333683724017, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.0639911893079, "num_env_steps_trained_throughput_per_sec": 304.0639911893079, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13155.136, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13155.068, "sample_time_ms": 1034.997, "learn_time_ms": 12052.507, "learn_throughput": 331.881, "synch_weights_time_ms": 66.832}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00009", "date": "2024-08-03_03-57-53", "timestamp": 1722637673, "time_this_iter_s": 13.165607690811157, "time_total_s": 13.165607690811157, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad1fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.165607690811157, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.326315789473682, "ram_util_percent": 27.557894736842105}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.3708110774246354, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.147034719089667, "policy_loss": -0.003772452099171157, "vf_loss": 9.148795942465464, "vf_explained_var": 0.14198722559958696, "kl": 0.010124710981896594, "entropy": 1.3747458297759294, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -10.213555227146633, "episode_reward_min": -1142.4564000505686, "episode_reward_mean": -647.9862650052136, "episode_len_mean": 140.14893617021278, "episode_media": {}, "episodes_timesteps_total": 6587, "policy_reward_min": {"policy_0": -1142.4564000505686}, "policy_reward_max": {"policy_0": -10.213555227146633}, "policy_reward_mean": {"policy_0": -647.9862650052136}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-740.228794037985, -979.506473098369, -523.0657167316735, -778.7033942086604, -893.9835765018546, -608.8127183597426, -775.2126450664414, -505.77704684317945, -458.47705853022677, -939.4733942369425, -1026.5657591388551, -877.2472991106418, -549.4377290340094, -619.2382785087735, -841.0068798093632, -629.8002100089099, -951.000599469137, -825.8169512294123, -442.11183279994395, -396.7811469387826, -457.9746579214979, -214.5598844160465, -686.4854265647901, -414.075903054557, -858.5212719925105, -822.509476169525, -10.213555227146633, -840.7153435021585, -680.5874284493167, -957.006483130353, -472.17533564378544, -176.75978399077775, -116.05614630177, -370.03531878551115, -332.0481821415669, -1059.0430392382264, -275.6094605084761, -748.6003485262065, -1142.4564000505686, -931.3130711672704, -765.5906228192729, -899.2746337214401, -835.311396723032, -281.58459468602024, -672.1607583237143, -305.494548163797, -766.9438803627945], "episode_lengths": [150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 105, 150, 150, 46, 150, 150, 150, 150, 97, 71, 150, 104, 150, 94, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150], "policy_policy_0_reward": [-740.228794037985, -979.506473098369, -523.0657167316735, -778.7033942086604, -893.9835765018546, -608.8127183597426, -775.2126450664414, -505.77704684317945, -458.47705853022677, -939.4733942369425, -1026.5657591388551, -877.2472991106418, -549.4377290340094, -619.2382785087735, -841.0068798093632, -629.8002100089099, -951.000599469137, -825.8169512294123, -442.11183279994395, -396.7811469387826, -457.9746579214979, -214.5598844160465, -686.4854265647901, -414.075903054557, -858.5212719925105, -822.509476169525, -10.213555227146633, -840.7153435021585, -680.5874284493167, -957.006483130353, -472.17533564378544, -176.75978399077775, -116.05614630177, -370.03531878551115, -332.0481821415669, -1059.0430392382264, -275.6094605084761, -748.6003485262065, -1142.4564000505686, -931.3130711672704, -765.5906228192729, -899.2746337214401, -835.311396723032, -281.58459468602024, -672.1607583237143, -305.494548163797, -766.9438803627945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5663067771373399, "mean_inference_ms": 1.6624368139966503, "mean_action_processing_ms": 0.2833047574995857, "mean_env_wait_ms": 2.9636061873954147, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013531015274372506, "StateBufferConnector_ms": 0.008068186171511386, "ViewRequirementAgentConnector_ms": 0.1808714359364611}, "num_episodes": 24, "episode_return_max": -10.213555227146633, "episode_return_min": -1142.4564000505686, "episode_return_mean": -647.9862650052136, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.9397451418074, "num_env_steps_trained_throughput_per_sec": 309.9397451418074, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13030.441, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13030.374, "sample_time_ms": 1020.127, "learn_time_ms": 11942.569, "learn_throughput": 334.936, "synch_weights_time_ms": 66.953}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00009", "date": "2024-08-03_03-58-06", "timestamp": 1722637686, "time_this_iter_s": 12.917419672012329, "time_total_s": 26.083027362823486, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad2cb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.083027362823486, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.005263157894735, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.31921690441668, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.574264635145664, "policy_loss": -0.010863912089553196, "vf_loss": 8.582407017052173, "vf_explained_var": 0.381784134109815, "kl": 0.01367548771534833, "entropy": 1.3577916628370683, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -10.213555227146633, "episode_reward_min": -1319.1283892770102, "episode_reward_mean": -650.7636529993399, "episode_len_mean": 139.7945205479452, "episode_media": {}, "episodes_timesteps_total": 10205, "policy_reward_min": {"policy_0": -1319.1283892770102}, "policy_reward_max": {"policy_0": -10.213555227146633}, "policy_reward_mean": {"policy_0": -650.7636529993399}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-740.228794037985, -979.506473098369, -523.0657167316735, -778.7033942086604, -893.9835765018546, -608.8127183597426, -775.2126450664414, -505.77704684317945, -458.47705853022677, -939.4733942369425, -1026.5657591388551, -877.2472991106418, -549.4377290340094, -619.2382785087735, -841.0068798093632, -629.8002100089099, -951.000599469137, -825.8169512294123, -442.11183279994395, -396.7811469387826, -457.9746579214979, -214.5598844160465, -686.4854265647901, -414.075903054557, -858.5212719925105, -822.509476169525, -10.213555227146633, -840.7153435021585, -680.5874284493167, -957.006483130353, -472.17533564378544, -176.75978399077775, -116.05614630177, -370.03531878551115, -332.0481821415669, -1059.0430392382264, -275.6094605084761, -748.6003485262065, -1142.4564000505686, -931.3130711672704, -765.5906228192729, -899.2746337214401, -835.311396723032, -281.58459468602024, -672.1607583237143, -305.494548163797, -766.9438803627945, -775.3247730379202, -531.6428761647826, -420.6659201946082, -1011.8244624264569, -802.3983643383668, -1111.0988322000028, -202.75030910699854, -533.1665803904536, -1047.3874243343892, -450.43853669654277, -390.31180330205643, -1319.1283892770102, -1036.8364894355473, -732.612726189141, -541.7067714878708, -921.732427278347, -94.61905485858985, -256.78121619113006, -503.176116099778, -76.14293576924939, -694.0785033971287, -899.4640872471394, -1132.0220153640914, -578.1188327594974, -620.8134862977453, -366.149279861936], "episode_lengths": [150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 105, 150, 150, 46, 150, 150, 150, 150, 97, 71, 150, 104, 150, 94, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 122, 143, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 69, 116, 150, 65, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-740.228794037985, -979.506473098369, -523.0657167316735, -778.7033942086604, -893.9835765018546, -608.8127183597426, -775.2126450664414, -505.77704684317945, -458.47705853022677, -939.4733942369425, -1026.5657591388551, -877.2472991106418, -549.4377290340094, -619.2382785087735, -841.0068798093632, -629.8002100089099, -951.000599469137, -825.8169512294123, -442.11183279994395, -396.7811469387826, -457.9746579214979, -214.5598844160465, -686.4854265647901, -414.075903054557, -858.5212719925105, -822.509476169525, -10.213555227146633, -840.7153435021585, -680.5874284493167, -957.006483130353, -472.17533564378544, -176.75978399077775, -116.05614630177, -370.03531878551115, -332.0481821415669, -1059.0430392382264, -275.6094605084761, -748.6003485262065, -1142.4564000505686, -931.3130711672704, -765.5906228192729, -899.2746337214401, -835.311396723032, -281.58459468602024, -672.1607583237143, -305.494548163797, -766.9438803627945, -775.3247730379202, -531.6428761647826, -420.6659201946082, -1011.8244624264569, -802.3983643383668, -1111.0988322000028, -202.75030910699854, -533.1665803904536, -1047.3874243343892, -450.43853669654277, -390.31180330205643, -1319.1283892770102, -1036.8364894355473, -732.612726189141, -541.7067714878708, -921.732427278347, -94.61905485858985, -256.78121619113006, -503.176116099778, -76.14293576924939, -694.0785033971287, -899.4640872471394, -1132.0220153640914, -578.1188327594974, -620.8134862977453, -366.149279861936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5659126121207887, "mean_inference_ms": 1.6709386472122751, "mean_action_processing_ms": 0.2841648995832799, "mean_env_wait_ms": 2.974576795657986, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013340662603508937, "StateBufferConnector_ms": 0.008224134575830747, "ViewRequirementAgentConnector_ms": 0.18483710615602258}, "num_episodes": 26, "episode_return_max": -10.213555227146633, "episode_return_min": -1319.1283892770102, "episode_return_mean": -650.7636529993399, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 527.8522729871954, "num_env_steps_trained_throughput_per_sec": 527.8522729871954, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 11212.924, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11212.853, "sample_time_ms": 1046.661, "learn_time_ms": 10104.727, "learn_throughput": 395.854, "synch_weights_time_ms": 60.751}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00009", "date": "2024-08-03_03-58-13", "timestamp": 1722637693, "time_this_iter_s": 7.5901830196380615, "time_total_s": 33.67321038246155, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad3f40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 33.67321038246155, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 22.970000000000002, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.34960071220994, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.177611780166626, "policy_loss": -0.012229166479664854, "vf_loss": 7.186280998587608, "vf_explained_var": 0.7048723926146825, "kl": 0.0178683551934076, "entropy": 1.3721656329929828, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -10.213555227146633, "episode_reward_min": -1319.1283892770102, "episode_reward_mean": -654.8156755801066, "episode_len_mean": 139.31, "episode_media": {}, "episodes_timesteps_total": 13931, "policy_reward_min": {"policy_0": -1319.1283892770102}, "policy_reward_max": {"policy_0": -10.213555227146633}, "policy_reward_mean": {"policy_0": -654.8156755801066}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-979.506473098369, -523.0657167316735, -778.7033942086604, -893.9835765018546, -608.8127183597426, -775.2126450664414, -505.77704684317945, -458.47705853022677, -939.4733942369425, -1026.5657591388551, -877.2472991106418, -549.4377290340094, -619.2382785087735, -841.0068798093632, -629.8002100089099, -951.000599469137, -825.8169512294123, -442.11183279994395, -396.7811469387826, -457.9746579214979, -214.5598844160465, -686.4854265647901, -414.075903054557, -858.5212719925105, -822.509476169525, -10.213555227146633, -840.7153435021585, -680.5874284493167, -957.006483130353, -472.17533564378544, -176.75978399077775, -116.05614630177, -370.03531878551115, -332.0481821415669, -1059.0430392382264, -275.6094605084761, -748.6003485262065, -1142.4564000505686, -931.3130711672704, -765.5906228192729, -899.2746337214401, -835.311396723032, -281.58459468602024, -672.1607583237143, -305.494548163797, -766.9438803627945, -775.3247730379202, -531.6428761647826, -420.6659201946082, -1011.8244624264569, -802.3983643383668, -1111.0988322000028, -202.75030910699854, -533.1665803904536, -1047.3874243343892, -450.43853669654277, -390.31180330205643, -1319.1283892770102, -1036.8364894355473, -732.612726189141, -541.7067714878708, -921.732427278347, -94.61905485858985, -256.78121619113006, -503.176116099778, -76.14293576924939, -694.0785033971287, -899.4640872471394, -1132.0220153640914, -578.1188327594974, -620.8134862977453, -366.149279861936, -570.6305756042201, -911.0378748433524, -124.15881152160898, -672.5491459676844, -435.83020472784955, -1175.2701796783954, -113.2870428823499, -758.052584489439, -793.1003032762826, -126.09573543352327, -875.5291124838092, -305.54287806036905, -844.2791381474595, -171.49903858499388, -663.5245974930115, -857.974488582355, -997.7032446796403, -404.5420986309465, -747.1522598465732, -662.521101981632, -767.283225298787, -1134.3755303370185, -903.7167080587009, -1005.7487762448716, -567.3544696993415, -912.6943348180383, -590.9191793138015, -623.6770424107726], "episode_lengths": [150, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 105, 150, 150, 46, 150, 150, 150, 150, 97, 71, 150, 104, 150, 94, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 122, 143, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 69, 116, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 61, 150, 150, 89, 150, 146, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150], "policy_policy_0_reward": [-979.506473098369, -523.0657167316735, -778.7033942086604, -893.9835765018546, -608.8127183597426, -775.2126450664414, -505.77704684317945, -458.47705853022677, -939.4733942369425, -1026.5657591388551, -877.2472991106418, -549.4377290340094, -619.2382785087735, -841.0068798093632, -629.8002100089099, -951.000599469137, -825.8169512294123, -442.11183279994395, -396.7811469387826, -457.9746579214979, -214.5598844160465, -686.4854265647901, -414.075903054557, -858.5212719925105, -822.509476169525, -10.213555227146633, -840.7153435021585, -680.5874284493167, -957.006483130353, -472.17533564378544, -176.75978399077775, -116.05614630177, -370.03531878551115, -332.0481821415669, -1059.0430392382264, -275.6094605084761, -748.6003485262065, -1142.4564000505686, -931.3130711672704, -765.5906228192729, -899.2746337214401, -835.311396723032, -281.58459468602024, -672.1607583237143, -305.494548163797, -766.9438803627945, -775.3247730379202, -531.6428761647826, -420.6659201946082, -1011.8244624264569, -802.3983643383668, -1111.0988322000028, -202.75030910699854, -533.1665803904536, -1047.3874243343892, -450.43853669654277, -390.31180330205643, -1319.1283892770102, -1036.8364894355473, -732.612726189141, -541.7067714878708, -921.732427278347, -94.61905485858985, -256.78121619113006, -503.176116099778, -76.14293576924939, -694.0785033971287, -899.4640872471394, -1132.0220153640914, -578.1188327594974, -620.8134862977453, -366.149279861936, -570.6305756042201, -911.0378748433524, -124.15881152160898, -672.5491459676844, -435.83020472784955, -1175.2701796783954, -113.2870428823499, -758.052584489439, -793.1003032762826, -126.09573543352327, -875.5291124838092, -305.54287806036905, -844.2791381474595, -171.49903858499388, -663.5245974930115, -857.974488582355, -997.7032446796403, -404.5420986309465, -747.1522598465732, -662.521101981632, -767.283225298787, -1134.3755303370185, -903.7167080587009, -1005.7487762448716, -567.3544696993415, -912.6943348180383, -590.9191793138015, -623.6770424107726]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5642695890048048, "mean_inference_ms": 1.6745561709149086, "mean_action_processing_ms": 0.2845278817507387, "mean_env_wait_ms": 2.977975268239989, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01386570930480957, "StateBufferConnector_ms": 0.008309602737426758, "ViewRequirementAgentConnector_ms": 0.1846926212310791}, "num_episodes": 28, "episode_return_max": -10.213555227146633, "episode_return_min": -1319.1283892770102, "episode_return_mean": -654.8156755801066, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.357038731048, "num_env_steps_trained_throughput_per_sec": 312.357038731048, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 11611.161, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11611.089, "sample_time_ms": 1038.272, "learn_time_ms": 10507.043, "learn_throughput": 380.697, "synch_weights_time_ms": 65.054}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00009", "date": "2024-08-03_03-58-26", "timestamp": 1722637706, "time_this_iter_s": 12.818577527999878, "time_total_s": 46.491787910461426, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8d80280>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 46.491787910461426, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 16.88947368421053, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.50361828505993, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.627218095461528, "policy_loss": -0.011362490682707478, "vf_loss": 6.6353620072205866, "vf_explained_var": 0.7346900752435128, "kl": 0.0161658867643079, "entropy": 1.45966313307484, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -76.14293576924939, "episode_reward_min": -1319.1283892770102, "episode_reward_mean": -675.4178497536301, "episode_len_mean": 139.45, "episode_media": {}, "episodes_timesteps_total": 13945, "policy_reward_min": {"policy_0": -1319.1283892770102}, "policy_reward_max": {"policy_0": -76.14293576924939}, "policy_reward_mean": {"policy_0": -675.4178497536301}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-957.006483130353, -472.17533564378544, -176.75978399077775, -116.05614630177, -370.03531878551115, -332.0481821415669, -1059.0430392382264, -275.6094605084761, -748.6003485262065, -1142.4564000505686, -931.3130711672704, -765.5906228192729, -899.2746337214401, -835.311396723032, -281.58459468602024, -672.1607583237143, -305.494548163797, -766.9438803627945, -775.3247730379202, -531.6428761647826, -420.6659201946082, -1011.8244624264569, -802.3983643383668, -1111.0988322000028, -202.75030910699854, -533.1665803904536, -1047.3874243343892, -450.43853669654277, -390.31180330205643, -1319.1283892770102, -1036.8364894355473, -732.612726189141, -541.7067714878708, -921.732427278347, -94.61905485858985, -256.78121619113006, -503.176116099778, -76.14293576924939, -694.0785033971287, -899.4640872471394, -1132.0220153640914, -578.1188327594974, -620.8134862977453, -366.149279861936, -570.6305756042201, -911.0378748433524, -124.15881152160898, -672.5491459676844, -435.83020472784955, -1175.2701796783954, -113.2870428823499, -758.052584489439, -793.1003032762826, -126.09573543352327, -875.5291124838092, -305.54287806036905, -844.2791381474595, -171.49903858499388, -663.5245974930115, -857.974488582355, -997.7032446796403, -404.5420986309465, -747.1522598465732, -662.521101981632, -767.283225298787, -1134.3755303370185, -903.7167080587009, -1005.7487762448716, -567.3544696993415, -912.6943348180383, -590.9191793138015, -623.6770424107726, -991.3807713173302, -89.85043942160995, -483.2780515399829, -412.6075431461371, -465.8444157958114, -721.0085100332972, -1071.704173107502, -588.6637209063392, -1008.1503363010866, -888.6166619652912, -540.3614510406873, -906.6474762254762, -633.3646118890447, -931.3452418795708, -868.8893578839867, -1013.8541488309874, -276.13900651151243, -1030.553020755747, -1052.8115968150753, -1192.967141739135, -412.6826829660179, -284.31457352116485, -817.6033620944348, -623.7135763075025, -1026.4274999318197, -662.1111847025288, -971.0435442381048, -701.944973407642], "episode_lengths": [150, 150, 97, 71, 150, 104, 150, 94, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 122, 143, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 69, 116, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 61, 150, 150, 89, 150, 146, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 86, 109, 150, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-957.006483130353, -472.17533564378544, -176.75978399077775, -116.05614630177, -370.03531878551115, -332.0481821415669, -1059.0430392382264, -275.6094605084761, -748.6003485262065, -1142.4564000505686, -931.3130711672704, -765.5906228192729, -899.2746337214401, -835.311396723032, -281.58459468602024, -672.1607583237143, -305.494548163797, -766.9438803627945, -775.3247730379202, -531.6428761647826, -420.6659201946082, -1011.8244624264569, -802.3983643383668, -1111.0988322000028, -202.75030910699854, -533.1665803904536, -1047.3874243343892, -450.43853669654277, -390.31180330205643, -1319.1283892770102, -1036.8364894355473, -732.612726189141, -541.7067714878708, -921.732427278347, -94.61905485858985, -256.78121619113006, -503.176116099778, -76.14293576924939, -694.0785033971287, -899.4640872471394, -1132.0220153640914, -578.1188327594974, -620.8134862977453, -366.149279861936, -570.6305756042201, -911.0378748433524, -124.15881152160898, -672.5491459676844, -435.83020472784955, -1175.2701796783954, -113.2870428823499, -758.052584489439, -793.1003032762826, -126.09573543352327, -875.5291124838092, -305.54287806036905, -844.2791381474595, -171.49903858499388, -663.5245974930115, -857.974488582355, -997.7032446796403, -404.5420986309465, -747.1522598465732, -662.521101981632, -767.283225298787, -1134.3755303370185, -903.7167080587009, -1005.7487762448716, -567.3544696993415, -912.6943348180383, -590.9191793138015, -623.6770424107726, -991.3807713173302, -89.85043942160995, -483.2780515399829, -412.6075431461371, -465.8444157958114, -721.0085100332972, -1071.704173107502, -588.6637209063392, -1008.1503363010866, -888.6166619652912, -540.3614510406873, -906.6474762254762, -633.3646118890447, -931.3452418795708, -868.8893578839867, -1013.8541488309874, -276.13900651151243, -1030.553020755747, -1052.8115968150753, -1192.967141739135, -412.6826829660179, -284.31457352116485, -817.6033620944348, -623.7135763075025, -1026.4274999318197, -662.1111847025288, -971.0435442381048, -701.944973407642]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5619025672726243, "mean_inference_ms": 1.6807836874528743, "mean_action_processing_ms": 0.28480716723240285, "mean_env_wait_ms": 2.987100374589487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014025449752807617, "StateBufferConnector_ms": 0.008528709411621094, "ViewRequirementAgentConnector_ms": 0.18768978118896484}, "num_episodes": 28, "episode_return_max": -76.14293576924939, "episode_return_min": -1319.1283892770102, "episode_return_mean": -675.4178497536301, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.06346365717894, "num_env_steps_trained_throughput_per_sec": 311.06346365717894, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 11860.754, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11860.681, "sample_time_ms": 1036.025, "learn_time_ms": 10762.339, "learn_throughput": 371.666, "synch_weights_time_ms": 61.592}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00009", "date": "2024-08-03_03-58-39", "timestamp": 1722637719, "time_this_iter_s": 12.872020959854126, "time_total_s": 59.36380887031555, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8e0eb90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 59.36380887031555, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.26111111111111, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.83808802465598, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.500760701050361, "policy_loss": -0.01311202925668719, "vf_loss": 6.510329746206602, "vf_explained_var": 0.8142462069168687, "kl": 0.017790486318942082, "entropy": 1.5108459010720252, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -53.307566954753696, "episode_reward_min": -1192.967141739135, "episode_reward_mean": -687.8207883437045, "episode_len_mean": 139.55, "episode_media": {}, "episodes_timesteps_total": 13955, "policy_reward_min": {"policy_0": -1192.967141739135}, "policy_reward_max": {"policy_0": -53.307566954753696}, "policy_reward_mean": {"policy_0": -687.8207883437045}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-732.612726189141, -541.7067714878708, -921.732427278347, -94.61905485858985, -256.78121619113006, -503.176116099778, -76.14293576924939, -694.0785033971287, -899.4640872471394, -1132.0220153640914, -578.1188327594974, -620.8134862977453, -366.149279861936, -570.6305756042201, -911.0378748433524, -124.15881152160898, -672.5491459676844, -435.83020472784955, -1175.2701796783954, -113.2870428823499, -758.052584489439, -793.1003032762826, -126.09573543352327, -875.5291124838092, -305.54287806036905, -844.2791381474595, -171.49903858499388, -663.5245974930115, -857.974488582355, -997.7032446796403, -404.5420986309465, -747.1522598465732, -662.521101981632, -767.283225298787, -1134.3755303370185, -903.7167080587009, -1005.7487762448716, -567.3544696993415, -912.6943348180383, -590.9191793138015, -623.6770424107726, -991.3807713173302, -89.85043942160995, -483.2780515399829, -412.6075431461371, -465.8444157958114, -721.0085100332972, -1071.704173107502, -588.6637209063392, -1008.1503363010866, -888.6166619652912, -540.3614510406873, -906.6474762254762, -633.3646118890447, -931.3452418795708, -868.8893578839867, -1013.8541488309874, -276.13900651151243, -1030.553020755747, -1052.8115968150753, -1192.967141739135, -412.6826829660179, -284.31457352116485, -817.6033620944348, -623.7135763075025, -1026.4274999318197, -662.1111847025288, -971.0435442381048, -701.944973407642, -1116.5561882860945, -53.307566954753696, -612.7560248083736, -985.5375654812779, -638.7051203997269, -1169.6379780627005, -1034.8205542162325, -1007.4677814147907, -54.136641477887835, -683.5808359910254, -1042.4727567264392, -500.6122697531425, -617.2602121281174, -1172.821149060751, -418.13733701326834, -457.91464538176336, -1057.793087192982, -1097.6478740610962, -278.24351970453665, -276.44271988372674, -1073.0036520122308, -229.6299788484988, -455.34101131790214, -793.2512349630044, -932.2401180260622, -810.2794024529936, -877.1422049883448, -520.6986327939742, -837.8383369796237, -731.5561542835078, -443.9000695323074], "episode_lengths": [150, 150, 150, 69, 116, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 150, 61, 150, 150, 89, 150, 146, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 86, 109, 150, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 122, 150, 103, 150, 150, 150, 150, 150, 112, 150, 150, 113], "policy_policy_0_reward": [-732.612726189141, -541.7067714878708, -921.732427278347, -94.61905485858985, -256.78121619113006, -503.176116099778, -76.14293576924939, -694.0785033971287, -899.4640872471394, -1132.0220153640914, -578.1188327594974, -620.8134862977453, -366.149279861936, -570.6305756042201, -911.0378748433524, -124.15881152160898, -672.5491459676844, -435.83020472784955, -1175.2701796783954, -113.2870428823499, -758.052584489439, -793.1003032762826, -126.09573543352327, -875.5291124838092, -305.54287806036905, -844.2791381474595, -171.49903858499388, -663.5245974930115, -857.974488582355, -997.7032446796403, -404.5420986309465, -747.1522598465732, -662.521101981632, -767.283225298787, -1134.3755303370185, -903.7167080587009, -1005.7487762448716, -567.3544696993415, -912.6943348180383, -590.9191793138015, -623.6770424107726, -991.3807713173302, -89.85043942160995, -483.2780515399829, -412.6075431461371, -465.8444157958114, -721.0085100332972, -1071.704173107502, -588.6637209063392, -1008.1503363010866, -888.6166619652912, -540.3614510406873, -906.6474762254762, -633.3646118890447, -931.3452418795708, -868.8893578839867, -1013.8541488309874, -276.13900651151243, -1030.553020755747, -1052.8115968150753, -1192.967141739135, -412.6826829660179, -284.31457352116485, -817.6033620944348, -623.7135763075025, -1026.4274999318197, -662.1111847025288, -971.0435442381048, -701.944973407642, -1116.5561882860945, -53.307566954753696, -612.7560248083736, -985.5375654812779, -638.7051203997269, -1169.6379780627005, -1034.8205542162325, -1007.4677814147907, -54.136641477887835, -683.5808359910254, -1042.4727567264392, -500.6122697531425, -617.2602121281174, -1172.821149060751, -418.13733701326834, -457.91464538176336, -1057.793087192982, -1097.6478740610962, -278.24351970453665, -276.44271988372674, -1073.0036520122308, -229.6299788484988, -455.34101131790214, -793.2512349630044, -932.2401180260622, -810.2794024529936, -877.1422049883448, -520.6986327939742, -837.8383369796237, -731.5561542835078, -443.9000695323074]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5620232332039694, "mean_inference_ms": 1.6845197345687521, "mean_action_processing_ms": 0.28444022373356737, "mean_env_wait_ms": 2.9920237128810583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013951539993286133, "StateBufferConnector_ms": 0.008664846420288086, "ViewRequirementAgentConnector_ms": 0.18884944915771484}, "num_episodes": 31, "episode_return_max": -53.307566954753696, "episode_return_min": -1192.967141739135, "episode_return_mean": -687.8207883437045, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.5981498285016, "num_env_steps_trained_throughput_per_sec": 300.5981498285016, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12101.764, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12101.689, "sample_time_ms": 1035.891, "learn_time_ms": 11000.525, "learn_throughput": 363.619, "synch_weights_time_ms": 64.481}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00009", "date": "2024-08-03_03-58-53", "timestamp": 1722637733, "time_this_iter_s": 13.31899619102478, "time_total_s": 72.68280506134033, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b18820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 72.68280506134033, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.094736842105263, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.05748472114404, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.576289382080237, "policy_loss": -0.010327041009441018, "vf_loss": 5.583832622816165, "vf_explained_var": 0.9219873449454705, "kl": 0.013983062763387965, "entropy": 1.2812072303146125, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -16.935977856167565, "episode_reward_min": -1240.5969258845155, "episode_reward_mean": -705.2610075976779, "episode_len_mean": 138.51, "episode_media": {}, "episodes_timesteps_total": 13851, "policy_reward_min": {"policy_0": -1240.5969258845155}, "policy_reward_max": {"policy_0": -16.935977856167565}, "policy_reward_mean": {"policy_0": -705.2610075976779}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-747.1522598465732, -662.521101981632, -767.283225298787, -1134.3755303370185, -903.7167080587009, -1005.7487762448716, -567.3544696993415, -912.6943348180383, -590.9191793138015, -623.6770424107726, -991.3807713173302, -89.85043942160995, -483.2780515399829, -412.6075431461371, -465.8444157958114, -721.0085100332972, -1071.704173107502, -588.6637209063392, -1008.1503363010866, -888.6166619652912, -540.3614510406873, -906.6474762254762, -633.3646118890447, -931.3452418795708, -868.8893578839867, -1013.8541488309874, -276.13900651151243, -1030.553020755747, -1052.8115968150753, -1192.967141739135, -412.6826829660179, -284.31457352116485, -817.6033620944348, -623.7135763075025, -1026.4274999318197, -662.1111847025288, -971.0435442381048, -701.944973407642, -1116.5561882860945, -53.307566954753696, -612.7560248083736, -985.5375654812779, -638.7051203997269, -1169.6379780627005, -1034.8205542162325, -1007.4677814147907, -54.136641477887835, -683.5808359910254, -1042.4727567264392, -500.6122697531425, -617.2602121281174, -1172.821149060751, -418.13733701326834, -457.91464538176336, -1057.793087192982, -1097.6478740610962, -278.24351970453665, -276.44271988372674, -1073.0036520122308, -229.6299788484988, -455.34101131790214, -793.2512349630044, -932.2401180260622, -810.2794024529936, -877.1422049883448, -520.6986327939742, -837.8383369796237, -731.5561542835078, -443.9000695323074, -1206.5781415464824, -165.77129655625535, -58.77473377829784, -211.53758331613966, -1147.1321143618943, -142.4256639832301, -282.7855498262023, -996.4830574620845, -813.4585509706471, -668.048791363528, -451.7312993610882, -751.5103381386963, -801.9462493011622, -16.935977856167565, -1029.0181018211717, -764.0983048516132, -584.1596948712282, -149.2832820076839, -990.6985233853178, -826.4336534736182, -809.6612841135, -1240.5969258845155, -1051.4460381006254, -673.6590702280525, -992.53484021424, -1005.3515052455834, -75.99844728024989, -693.6818075649597, -264.860652342124, -795.1860904722442, -300.258863607677], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 86, 109, 150, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 124, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 122, 150, 103, 150, 150, 150, 150, 150, 112, 150, 150, 113, 150, 91, 85, 118, 150, 66, 84, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 119, 150, 100], "policy_policy_0_reward": [-747.1522598465732, -662.521101981632, -767.283225298787, -1134.3755303370185, -903.7167080587009, -1005.7487762448716, -567.3544696993415, -912.6943348180383, -590.9191793138015, -623.6770424107726, -991.3807713173302, -89.85043942160995, -483.2780515399829, -412.6075431461371, -465.8444157958114, -721.0085100332972, -1071.704173107502, -588.6637209063392, -1008.1503363010866, -888.6166619652912, -540.3614510406873, -906.6474762254762, -633.3646118890447, -931.3452418795708, -868.8893578839867, -1013.8541488309874, -276.13900651151243, -1030.553020755747, -1052.8115968150753, -1192.967141739135, -412.6826829660179, -284.31457352116485, -817.6033620944348, -623.7135763075025, -1026.4274999318197, -662.1111847025288, -971.0435442381048, -701.944973407642, -1116.5561882860945, -53.307566954753696, -612.7560248083736, -985.5375654812779, -638.7051203997269, -1169.6379780627005, -1034.8205542162325, -1007.4677814147907, -54.136641477887835, -683.5808359910254, -1042.4727567264392, -500.6122697531425, -617.2602121281174, -1172.821149060751, -418.13733701326834, -457.91464538176336, -1057.793087192982, -1097.6478740610962, -278.24351970453665, -276.44271988372674, -1073.0036520122308, -229.6299788484988, -455.34101131790214, -793.2512349630044, -932.2401180260622, -810.2794024529936, -877.1422049883448, -520.6986327939742, -837.8383369796237, -731.5561542835078, -443.9000695323074, -1206.5781415464824, -165.77129655625535, -58.77473377829784, -211.53758331613966, -1147.1321143618943, -142.4256639832301, -282.7855498262023, -996.4830574620845, -813.4585509706471, -668.048791363528, -451.7312993610882, -751.5103381386963, -801.9462493011622, -16.935977856167565, -1029.0181018211717, -764.0983048516132, -584.1596948712282, -149.2832820076839, -990.6985233853178, -826.4336534736182, -809.6612841135, -1240.5969258845155, -1051.4460381006254, -673.6590702280525, -992.53484021424, -1005.3515052455834, -75.99844728024989, -693.6818075649597, -264.860652342124, -795.1860904722442, -300.258863607677]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5609380965097294, "mean_inference_ms": 1.683899565420308, "mean_action_processing_ms": 0.28342465211670725, "mean_env_wait_ms": 2.9945562036407942, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013943672180175781, "StateBufferConnector_ms": 0.00862264633178711, "ViewRequirementAgentConnector_ms": 0.19351434707641602}, "num_episodes": 31, "episode_return_max": -16.935977856167565, "episode_return_min": -1240.5969258845155, "episode_return_mean": -705.2610075976779, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.1050698880711, "num_env_steps_trained_throughput_per_sec": 320.1050698880711, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12158.071, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12157.994, "sample_time_ms": 1037.815, "learn_time_ms": 11055.091, "learn_throughput": 361.824, "synch_weights_time_ms": 64.301}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00009", "date": "2024-08-03_03-59-05", "timestamp": 1722637745, "time_this_iter_s": 12.507872819900513, "time_total_s": 85.19067788124084, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b19cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 85.19067788124084, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.3, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 77.66980483333269, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.441741071641445, "policy_loss": -0.018747056011246363, "vf_loss": 5.456137285629908, "vf_explained_var": 0.9076770006368557, "kl": 0.02182134635195326, "entropy": 1.3425211135298014, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -16.935977856167565, "episode_reward_min": -1240.5969258845155, "episode_reward_mean": -666.7745157716039, "episode_len_mean": 135.45, "episode_media": {}, "episodes_timesteps_total": 13545, "policy_reward_min": {"policy_0": -1240.5969258845155}, "policy_reward_max": {"policy_0": -16.935977856167565}, "policy_reward_mean": {"policy_0": -666.7745157716039}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-284.31457352116485, -817.6033620944348, -623.7135763075025, -1026.4274999318197, -662.1111847025288, -971.0435442381048, -701.944973407642, -1116.5561882860945, -53.307566954753696, -612.7560248083736, -985.5375654812779, -638.7051203997269, -1169.6379780627005, -1034.8205542162325, -1007.4677814147907, -54.136641477887835, -683.5808359910254, -1042.4727567264392, -500.6122697531425, -617.2602121281174, -1172.821149060751, -418.13733701326834, -457.91464538176336, -1057.793087192982, -1097.6478740610962, -278.24351970453665, -276.44271988372674, -1073.0036520122308, -229.6299788484988, -455.34101131790214, -793.2512349630044, -932.2401180260622, -810.2794024529936, -877.1422049883448, -520.6986327939742, -837.8383369796237, -731.5561542835078, -443.9000695323074, -1206.5781415464824, -165.77129655625535, -58.77473377829784, -211.53758331613966, -1147.1321143618943, -142.4256639832301, -282.7855498262023, -996.4830574620845, -813.4585509706471, -668.048791363528, -451.7312993610882, -751.5103381386963, -801.9462493011622, -16.935977856167565, -1029.0181018211717, -764.0983048516132, -584.1596948712282, -149.2832820076839, -990.6985233853178, -826.4336534736182, -809.6612841135, -1240.5969258845155, -1051.4460381006254, -673.6590702280525, -992.53484021424, -1005.3515052455834, -75.99844728024989, -693.6818075649597, -264.860652342124, -795.1860904722442, -300.258863607677, -901.6814671450733, -121.91420967702807, -854.8824362894551, -819.4066493818049, -1001.123382204733, -1115.0093364513873, -1065.5796083243436, -378.41653547938586, -336.8658658103095, -1003.2636671278558, -142.1995735153313, -525.5414239566276, -876.4941502979264, -431.2171218523773, -667.3327363785305, -201.46188303981017, -839.318170393377, -579.0744329416331, -724.9014029168757, -925.9532899025287, -548.907799556035, -515.3980031101934, -598.4737199406434, -772.7101714580908, -190.31147290696492, -391.97764265397797, -1033.7673356290193, -625.5783574798751, -912.6149388586903, -125.970503428115, -420.16651736576966], "episode_lengths": [124, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 122, 150, 103, 150, 150, 150, 150, 150, 112, 150, 150, 113, 150, 91, 85, 118, 150, 66, 84, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 119, 150, 100, 150, 68, 150, 150, 150, 150, 150, 150, 102, 150, 66, 118, 150, 150, 150, 75, 150, 150, 150, 150, 132, 150, 150, 150, 120, 150, 150, 150, 150, 66, 150], "policy_policy_0_reward": [-284.31457352116485, -817.6033620944348, -623.7135763075025, -1026.4274999318197, -662.1111847025288, -971.0435442381048, -701.944973407642, -1116.5561882860945, -53.307566954753696, -612.7560248083736, -985.5375654812779, -638.7051203997269, -1169.6379780627005, -1034.8205542162325, -1007.4677814147907, -54.136641477887835, -683.5808359910254, -1042.4727567264392, -500.6122697531425, -617.2602121281174, -1172.821149060751, -418.13733701326834, -457.91464538176336, -1057.793087192982, -1097.6478740610962, -278.24351970453665, -276.44271988372674, -1073.0036520122308, -229.6299788484988, -455.34101131790214, -793.2512349630044, -932.2401180260622, -810.2794024529936, -877.1422049883448, -520.6986327939742, -837.8383369796237, -731.5561542835078, -443.9000695323074, -1206.5781415464824, -165.77129655625535, -58.77473377829784, -211.53758331613966, -1147.1321143618943, -142.4256639832301, -282.7855498262023, -996.4830574620845, -813.4585509706471, -668.048791363528, -451.7312993610882, -751.5103381386963, -801.9462493011622, -16.935977856167565, -1029.0181018211717, -764.0983048516132, -584.1596948712282, -149.2832820076839, -990.6985233853178, -826.4336534736182, -809.6612841135, -1240.5969258845155, -1051.4460381006254, -673.6590702280525, -992.53484021424, -1005.3515052455834, -75.99844728024989, -693.6818075649597, -264.860652342124, -795.1860904722442, -300.258863607677, -901.6814671450733, -121.91420967702807, -854.8824362894551, -819.4066493818049, -1001.123382204733, -1115.0093364513873, -1065.5796083243436, -378.41653547938586, -336.8658658103095, -1003.2636671278558, -142.1995735153313, -525.5414239566276, -876.4941502979264, -431.2171218523773, -667.3327363785305, -201.46188303981017, -839.318170393377, -579.0744329416331, -724.9014029168757, -925.9532899025287, -548.907799556035, -515.3980031101934, -598.4737199406434, -772.7101714580908, -190.31147290696492, -391.97764265397797, -1033.7673356290193, -625.5783574798751, -912.6149388586903, -125.970503428115, -420.16651736576966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5602641335978857, "mean_inference_ms": 1.6826601302924604, "mean_action_processing_ms": 0.2825334947872986, "mean_env_wait_ms": 2.996860143375412, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013095855712890625, "StateBufferConnector_ms": 0.00835728645324707, "ViewRequirementAgentConnector_ms": 0.19250893592834473}, "num_episodes": 31, "episode_return_max": -16.935977856167565, "episode_return_min": -1240.5969258845155, "episode_return_mean": -666.7745157716039, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.60053986889517, "num_env_steps_trained_throughput_per_sec": 303.60053986889517, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12285.215, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12285.138, "sample_time_ms": 1039.262, "learn_time_ms": 11180.72, "learn_throughput": 357.759, "synch_weights_time_ms": 64.314}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00009", "date": "2024-08-03_03-59-18", "timestamp": 1722637758, "time_this_iter_s": 13.187811613082886, "time_total_s": 98.37848949432373, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8c360e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 98.37848949432373, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.073684210526313, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 77.40034032166004, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.465344459066788, "policy_loss": -0.010813750722445548, "vf_loss": 5.4720374556879205, "vf_explained_var": 0.9455338843166828, "kl": 0.013777538149436932, "entropy": 1.2512583247075477, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -5.371978826467378, "episode_reward_min": -1275.8477284565142, "episode_reward_mean": -638.7749473696721, "episode_len_mean": 134.86, "episode_media": {}, "episodes_timesteps_total": 13486, "policy_reward_min": {"policy_0": -1275.8477284565142}, "policy_reward_max": {"policy_0": -5.371978826467378}, "policy_reward_mean": {"policy_0": -638.7749473696721}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-229.6299788484988, -455.34101131790214, -793.2512349630044, -932.2401180260622, -810.2794024529936, -877.1422049883448, -520.6986327939742, -837.8383369796237, -731.5561542835078, -443.9000695323074, -1206.5781415464824, -165.77129655625535, -58.77473377829784, -211.53758331613966, -1147.1321143618943, -142.4256639832301, -282.7855498262023, -996.4830574620845, -813.4585509706471, -668.048791363528, -451.7312993610882, -751.5103381386963, -801.9462493011622, -16.935977856167565, -1029.0181018211717, -764.0983048516132, -584.1596948712282, -149.2832820076839, -990.6985233853178, -826.4336534736182, -809.6612841135, -1240.5969258845155, -1051.4460381006254, -673.6590702280525, -992.53484021424, -1005.3515052455834, -75.99844728024989, -693.6818075649597, -264.860652342124, -795.1860904722442, -300.258863607677, -901.6814671450733, -121.91420967702807, -854.8824362894551, -819.4066493818049, -1001.123382204733, -1115.0093364513873, -1065.5796083243436, -378.41653547938586, -336.8658658103095, -1003.2636671278558, -142.1995735153313, -525.5414239566276, -876.4941502979264, -431.2171218523773, -667.3327363785305, -201.46188303981017, -839.318170393377, -579.0744329416331, -724.9014029168757, -925.9532899025287, -548.907799556035, -515.3980031101934, -598.4737199406434, -772.7101714580908, -190.31147290696492, -391.97764265397797, -1033.7673356290193, -625.5783574798751, -912.6149388586903, -125.970503428115, -420.16651736576966, -556.492051816076, -563.6880229624533, -632.7761886262316, -1006.583312909946, -520.2938552779876, -5.371978826467378, -1275.8477284565142, -78.71682855421743, -445.9509745651687, -667.5090032576514, -760.8811096898705, -651.725262653487, -347.8619740749731, -579.0022239051452, -285.5421323420708, -367.9473343032234, -478.83915414106866, -1007.2170610494297, -1069.6348933152187, -729.3385079895976, -956.1422607547437, -939.0863252789168, -730.4433930295266, -896.0650952312324, -400.8312555854338, -798.3669367192921, -399.05784546403413, -484.84464324096547], "episode_lengths": [103, 150, 150, 150, 150, 150, 112, 150, 150, 113, 150, 91, 85, 118, 150, 66, 84, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 119, 150, 100, 150, 68, 150, 150, 150, 150, 150, 150, 102, 150, 66, 118, 150, 150, 150, 75, 150, 150, 150, 150, 132, 150, 150, 150, 120, 150, 150, 150, 150, 66, 150, 135, 150, 150, 150, 150, 41, 150, 56, 150, 150, 150, 150, 101, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150], "policy_policy_0_reward": [-229.6299788484988, -455.34101131790214, -793.2512349630044, -932.2401180260622, -810.2794024529936, -877.1422049883448, -520.6986327939742, -837.8383369796237, -731.5561542835078, -443.9000695323074, -1206.5781415464824, -165.77129655625535, -58.77473377829784, -211.53758331613966, -1147.1321143618943, -142.4256639832301, -282.7855498262023, -996.4830574620845, -813.4585509706471, -668.048791363528, -451.7312993610882, -751.5103381386963, -801.9462493011622, -16.935977856167565, -1029.0181018211717, -764.0983048516132, -584.1596948712282, -149.2832820076839, -990.6985233853178, -826.4336534736182, -809.6612841135, -1240.5969258845155, -1051.4460381006254, -673.6590702280525, -992.53484021424, -1005.3515052455834, -75.99844728024989, -693.6818075649597, -264.860652342124, -795.1860904722442, -300.258863607677, -901.6814671450733, -121.91420967702807, -854.8824362894551, -819.4066493818049, -1001.123382204733, -1115.0093364513873, -1065.5796083243436, -378.41653547938586, -336.8658658103095, -1003.2636671278558, -142.1995735153313, -525.5414239566276, -876.4941502979264, -431.2171218523773, -667.3327363785305, -201.46188303981017, -839.318170393377, -579.0744329416331, -724.9014029168757, -925.9532899025287, -548.907799556035, -515.3980031101934, -598.4737199406434, -772.7101714580908, -190.31147290696492, -391.97764265397797, -1033.7673356290193, -625.5783574798751, -912.6149388586903, -125.970503428115, -420.16651736576966, -556.492051816076, -563.6880229624533, -632.7761886262316, -1006.583312909946, -520.2938552779876, -5.371978826467378, -1275.8477284565142, -78.71682855421743, -445.9509745651687, -667.5090032576514, -760.8811096898705, -651.725262653487, -347.8619740749731, -579.0022239051452, -285.5421323420708, -367.9473343032234, -478.83915414106866, -1007.2170610494297, -1069.6348933152187, -729.3385079895976, -956.1422607547437, -939.0863252789168, -730.4433930295266, -896.0650952312324, -400.8312555854338, -798.3669367192921, -399.05784546403413, -484.84464324096547]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5591143186487113, "mean_inference_ms": 1.6836788903016227, "mean_action_processing_ms": 0.2821678250089624, "mean_env_wait_ms": 2.9999556347185923, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012415647506713867, "StateBufferConnector_ms": 0.008070707321166992, "ViewRequirementAgentConnector_ms": 0.190293550491333}, "num_episodes": 28, "episode_return_max": -5.371978826467378, "episode_return_min": -1275.8477284565142, "episode_return_mean": -638.7749473696721, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.57149083290955, "num_env_steps_trained_throughput_per_sec": 305.57149083290955, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12374.662, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12374.586, "sample_time_ms": 1037.868, "learn_time_ms": 11271.193, "learn_throughput": 354.887, "synch_weights_time_ms": 64.693}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00009", "date": "2024-08-03_03-59-32", "timestamp": 1722637772, "time_this_iter_s": 13.10373044013977, "time_total_s": 111.4822199344635, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8d80280>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 111.4822199344635, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.28888888888889, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 85.89346959888935, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.463422899444898, "policy_loss": -0.013242767216676535, "vf_loss": 5.471658588200808, "vf_explained_var": 0.9420699924851458, "kl": 0.016737247847671218, "entropy": 1.410319081818064, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -5.371978826467378, "episode_reward_min": -1312.1219641003393, "episode_reward_mean": -668.9643939422932, "episode_len_mean": 136.1, "episode_media": {}, "episodes_timesteps_total": 13610, "policy_reward_min": {"policy_0": -1312.1219641003393}, "policy_reward_max": {"policy_0": -5.371978826467378}, "policy_reward_mean": {"policy_0": -668.9643939422932}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-149.2832820076839, -990.6985233853178, -826.4336534736182, -809.6612841135, -1240.5969258845155, -1051.4460381006254, -673.6590702280525, -992.53484021424, -1005.3515052455834, -75.99844728024989, -693.6818075649597, -264.860652342124, -795.1860904722442, -300.258863607677, -901.6814671450733, -121.91420967702807, -854.8824362894551, -819.4066493818049, -1001.123382204733, -1115.0093364513873, -1065.5796083243436, -378.41653547938586, -336.8658658103095, -1003.2636671278558, -142.1995735153313, -525.5414239566276, -876.4941502979264, -431.2171218523773, -667.3327363785305, -201.46188303981017, -839.318170393377, -579.0744329416331, -724.9014029168757, -925.9532899025287, -548.907799556035, -515.3980031101934, -598.4737199406434, -772.7101714580908, -190.31147290696492, -391.97764265397797, -1033.7673356290193, -625.5783574798751, -912.6149388586903, -125.970503428115, -420.16651736576966, -556.492051816076, -563.6880229624533, -632.7761886262316, -1006.583312909946, -520.2938552779876, -5.371978826467378, -1275.8477284565142, -78.71682855421743, -445.9509745651687, -667.5090032576514, -760.8811096898705, -651.725262653487, -347.8619740749731, -579.0022239051452, -285.5421323420708, -367.9473343032234, -478.83915414106866, -1007.2170610494297, -1069.6348933152187, -729.3385079895976, -956.1422607547437, -939.0863252789168, -730.4433930295266, -896.0650952312324, -400.8312555854338, -798.3669367192921, -399.05784546403413, -484.84464324096547, -798.1603493314559, -1312.1219641003393, -331.19090667596424, -1062.6425657877219, -119.20492113692487, -1028.7142710162489, -475.02644307260806, -166.46853195045352, -982.8930464812264, -1186.474562308887, -958.759989996142, -965.2282160320352, -905.5578337249427, -1038.2038121689052, -691.908359361158, -903.031711060113, -867.8335742640159, -986.5919822943414, -610.1166154309258, -785.7171066357492, -96.40187453121649, -805.2790130930227, -764.852252504469, -1001.5124406755863, -240.0290103131123, -605.0326540408404, -54.26324282580497], "episode_lengths": [86, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 119, 150, 100, 150, 68, 150, 150, 150, 150, 150, 150, 102, 150, 66, 118, 150, 150, 150, 75, 150, 150, 150, 150, 132, 150, 150, 150, 120, 150, 150, 150, 150, 66, 150, 135, 150, 150, 150, 150, 41, 150, 56, 150, 150, 150, 150, 101, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 87, 150, 52], "policy_policy_0_reward": [-149.2832820076839, -990.6985233853178, -826.4336534736182, -809.6612841135, -1240.5969258845155, -1051.4460381006254, -673.6590702280525, -992.53484021424, -1005.3515052455834, -75.99844728024989, -693.6818075649597, -264.860652342124, -795.1860904722442, -300.258863607677, -901.6814671450733, -121.91420967702807, -854.8824362894551, -819.4066493818049, -1001.123382204733, -1115.0093364513873, -1065.5796083243436, -378.41653547938586, -336.8658658103095, -1003.2636671278558, -142.1995735153313, -525.5414239566276, -876.4941502979264, -431.2171218523773, -667.3327363785305, -201.46188303981017, -839.318170393377, -579.0744329416331, -724.9014029168757, -925.9532899025287, -548.907799556035, -515.3980031101934, -598.4737199406434, -772.7101714580908, -190.31147290696492, -391.97764265397797, -1033.7673356290193, -625.5783574798751, -912.6149388586903, -125.970503428115, -420.16651736576966, -556.492051816076, -563.6880229624533, -632.7761886262316, -1006.583312909946, -520.2938552779876, -5.371978826467378, -1275.8477284565142, -78.71682855421743, -445.9509745651687, -667.5090032576514, -760.8811096898705, -651.725262653487, -347.8619740749731, -579.0022239051452, -285.5421323420708, -367.9473343032234, -478.83915414106866, -1007.2170610494297, -1069.6348933152187, -729.3385079895976, -956.1422607547437, -939.0863252789168, -730.4433930295266, -896.0650952312324, -400.8312555854338, -798.3669367192921, -399.05784546403413, -484.84464324096547, -798.1603493314559, -1312.1219641003393, -331.19090667596424, -1062.6425657877219, -119.20492113692487, -1028.7142710162489, -475.02644307260806, -166.46853195045352, -982.8930464812264, -1186.474562308887, -958.759989996142, -965.2282160320352, -905.5578337249427, -1038.2038121689052, -691.908359361158, -903.031711060113, -867.8335742640159, -986.5919822943414, -610.1166154309258, -785.7171066357492, -96.40187453121649, -805.2790130930227, -764.852252504469, -1001.5124406755863, -240.0290103131123, -605.0326540408404, -54.26324282580497]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5584891560895691, "mean_inference_ms": 1.6829076094475517, "mean_action_processing_ms": 0.28192561990015147, "mean_env_wait_ms": 3.0009730922883655, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011889457702636719, "StateBufferConnector_ms": 0.007900476455688477, "ViewRequirementAgentConnector_ms": 0.1893606185913086}, "num_episodes": 27, "episode_return_max": -5.371978826467378, "episode_return_min": -1312.1219641003393, "episode_return_mean": -668.9643939422932, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 341.14432693865575, "num_env_steps_trained_throughput_per_sec": 341.14432693865575, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12309.722, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12309.646, "sample_time_ms": 1035.482, "learn_time_ms": 11208.923, "learn_throughput": 356.859, "synch_weights_time_ms": 64.411}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00009", "date": "2024-08-03_03-59-43", "timestamp": 1722637783, "time_this_iter_s": 11.737651586532593, "time_total_s": 123.2198715209961, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b19480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 123.2198715209961, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.694117647058825, "ram_util_percent": 27.6}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 105.79358948469162, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.745251704007387, "policy_loss": -0.012868084159951347, "vf_loss": 4.753586163868507, "vf_explained_var": 0.9540608593573173, "kl": 0.015157891707682817, "entropy": 1.3723814144730568, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -5.371978826467378, "episode_reward_min": -1312.1219641003393, "episode_reward_mean": -675.6080601403283, "episode_len_mean": 139.63, "episode_media": {}, "episodes_timesteps_total": 13963, "policy_reward_min": {"policy_0": -1312.1219641003393}, "policy_reward_max": {"policy_0": -5.371978826467378}, "policy_reward_mean": {"policy_0": -675.6080601403283}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-431.2171218523773, -667.3327363785305, -201.46188303981017, -839.318170393377, -579.0744329416331, -724.9014029168757, -925.9532899025287, -548.907799556035, -515.3980031101934, -598.4737199406434, -772.7101714580908, -190.31147290696492, -391.97764265397797, -1033.7673356290193, -625.5783574798751, -912.6149388586903, -125.970503428115, -420.16651736576966, -556.492051816076, -563.6880229624533, -632.7761886262316, -1006.583312909946, -520.2938552779876, -5.371978826467378, -1275.8477284565142, -78.71682855421743, -445.9509745651687, -667.5090032576514, -760.8811096898705, -651.725262653487, -347.8619740749731, -579.0022239051452, -285.5421323420708, -367.9473343032234, -478.83915414106866, -1007.2170610494297, -1069.6348933152187, -729.3385079895976, -956.1422607547437, -939.0863252789168, -730.4433930295266, -896.0650952312324, -400.8312555854338, -798.3669367192921, -399.05784546403413, -484.84464324096547, -798.1603493314559, -1312.1219641003393, -331.19090667596424, -1062.6425657877219, -119.20492113692487, -1028.7142710162489, -475.02644307260806, -166.46853195045352, -982.8930464812264, -1186.474562308887, -958.759989996142, -965.2282160320352, -905.5578337249427, -1038.2038121689052, -691.908359361158, -903.031711060113, -867.8335742640159, -986.5919822943414, -610.1166154309258, -785.7171066357492, -96.40187453121649, -805.2790130930227, -764.852252504469, -1001.5124406755863, -240.0290103131123, -605.0326540408404, -54.26324282580497, -532.5265189717209, -884.6391600447389, -507.49644584737905, -459.1945609612906, -711.1706823650035, -759.1026149124077, -515.914522820109, -928.9266070437908, -490.19570864161057, -296.85022229359544, -819.6735177634451, -886.7026926081029, -942.9680311859229, -431.77961696785644, -530.9502060523639, -206.6639121327595, -906.5434571106795, -906.1495946912555, -498.7544585328608, -803.0494013803711, -1107.3280996908418, -1013.1344477531851, -700.4418908227826, -1184.2077192955412, -513.9194915542538, -1048.8546991277133, -1089.2576288135892], "episode_lengths": [150, 150, 75, 150, 150, 150, 150, 132, 150, 150, 150, 120, 150, 150, 150, 150, 66, 150, 135, 150, 150, 150, 150, 41, 150, 56, 150, 150, 150, 150, 101, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 87, 150, 52, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-431.2171218523773, -667.3327363785305, -201.46188303981017, -839.318170393377, -579.0744329416331, -724.9014029168757, -925.9532899025287, -548.907799556035, -515.3980031101934, -598.4737199406434, -772.7101714580908, -190.31147290696492, -391.97764265397797, -1033.7673356290193, -625.5783574798751, -912.6149388586903, -125.970503428115, -420.16651736576966, -556.492051816076, -563.6880229624533, -632.7761886262316, -1006.583312909946, -520.2938552779876, -5.371978826467378, -1275.8477284565142, -78.71682855421743, -445.9509745651687, -667.5090032576514, -760.8811096898705, -651.725262653487, -347.8619740749731, -579.0022239051452, -285.5421323420708, -367.9473343032234, -478.83915414106866, -1007.2170610494297, -1069.6348933152187, -729.3385079895976, -956.1422607547437, -939.0863252789168, -730.4433930295266, -896.0650952312324, -400.8312555854338, -798.3669367192921, -399.05784546403413, -484.84464324096547, -798.1603493314559, -1312.1219641003393, -331.19090667596424, -1062.6425657877219, -119.20492113692487, -1028.7142710162489, -475.02644307260806, -166.46853195045352, -982.8930464812264, -1186.474562308887, -958.759989996142, -965.2282160320352, -905.5578337249427, -1038.2038121689052, -691.908359361158, -903.031711060113, -867.8335742640159, -986.5919822943414, -610.1166154309258, -785.7171066357492, -96.40187453121649, -805.2790130930227, -764.852252504469, -1001.5124406755863, -240.0290103131123, -605.0326540408404, -54.26324282580497, -532.5265189717209, -884.6391600447389, -507.49644584737905, -459.1945609612906, -711.1706823650035, -759.1026149124077, -515.914522820109, -928.9266070437908, -490.19570864161057, -296.85022229359544, -819.6735177634451, -886.7026926081029, -942.9680311859229, -431.77961696785644, -530.9502060523639, -206.6639121327595, -906.5434571106795, -906.1495946912555, -498.7544585328608, -803.0494013803711, -1107.3280996908418, -1013.1344477531851, -700.4418908227826, -1184.2077192955412, -513.9194915542538, -1048.8546991277133, -1089.2576288135892]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5574825662401228, "mean_inference_ms": 1.6826373434651665, "mean_action_processing_ms": 0.2817461071829477, "mean_env_wait_ms": 3.0006240687742194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011416435241699219, "StateBufferConnector_ms": 0.007843971252441406, "ViewRequirementAgentConnector_ms": 0.18791747093200684}, "num_episodes": 27, "episode_return_max": -5.371978826467378, "episode_return_min": -1312.1219641003393, "episode_return_mean": -675.6080601403283, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 559.587944182013, "num_env_steps_trained_throughput_per_sec": 559.587944182013, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 11709.021, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11708.945, "sample_time_ms": 1033.23, "learn_time_ms": 10612.604, "learn_throughput": 376.91, "synch_weights_time_ms": 62.283}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00009", "date": "2024-08-03_03-59-51", "timestamp": 1722637791, "time_this_iter_s": 7.1604163646698, "time_total_s": 130.3802878856659, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b18550>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 130.3802878856659, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 22.830000000000002, "ram_util_percent": 27.689999999999998}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.26794710854689, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.214359779904286, "policy_loss": -0.016478136747415797, "vf_loss": 4.225901388252775, "vf_explained_var": 0.9724305699268977, "kl": 0.016499156033751204, "entropy": 1.322366502135992, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -28.39012254201492, "episode_reward_min": -1312.1219641003393, "episode_reward_mean": -679.44417083473, "episode_len_mean": 140.01, "episode_media": {}, "episodes_timesteps_total": 14001, "policy_reward_min": {"policy_0": -1312.1219641003393}, "policy_reward_max": {"policy_0": -28.39012254201492}, "policy_reward_mean": {"policy_0": -679.44417083473}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-579.0022239051452, -285.5421323420708, -367.9473343032234, -478.83915414106866, -1007.2170610494297, -1069.6348933152187, -729.3385079895976, -956.1422607547437, -939.0863252789168, -730.4433930295266, -896.0650952312324, -400.8312555854338, -798.3669367192921, -399.05784546403413, -484.84464324096547, -798.1603493314559, -1312.1219641003393, -331.19090667596424, -1062.6425657877219, -119.20492113692487, -1028.7142710162489, -475.02644307260806, -166.46853195045352, -982.8930464812264, -1186.474562308887, -958.759989996142, -965.2282160320352, -905.5578337249427, -1038.2038121689052, -691.908359361158, -903.031711060113, -867.8335742640159, -986.5919822943414, -610.1166154309258, -785.7171066357492, -96.40187453121649, -805.2790130930227, -764.852252504469, -1001.5124406755863, -240.0290103131123, -605.0326540408404, -54.26324282580497, -532.5265189717209, -884.6391600447389, -507.49644584737905, -459.1945609612906, -711.1706823650035, -759.1026149124077, -515.914522820109, -928.9266070437908, -490.19570864161057, -296.85022229359544, -819.6735177634451, -886.7026926081029, -942.9680311859229, -431.77961696785644, -530.9502060523639, -206.6639121327595, -906.5434571106795, -906.1495946912555, -498.7544585328608, -803.0494013803711, -1107.3280996908418, -1013.1344477531851, -700.4418908227826, -1184.2077192955412, -513.9194915542538, -1048.8546991277133, -1089.2576288135892, -861.6552111923376, -91.5177790282407, -946.8449053510637, -685.954965248435, -712.7013212348959, -427.39102196013283, -521.1279379591042, -386.48979701037194, -727.11644962193, -722.9924430358114, -784.7746888192727, -1071.2638814505367, -508.63304691871167, -980.0797283466478, -522.6409354250159, -681.3181402473011, -119.69843793689466, -967.7151131084405, -284.1009526623152, -552.9368253068983, -908.4100992638301, -28.39012254201492, -593.0115903514219, -425.2985643705189, -808.6007098398431, -310.789908563892, -52.359793400259406, -708.208441287612, -424.90328853306045, -964.4258495797894, -621.0929113271231], "episode_lengths": [150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 87, 150, 52, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 68, 150, 150, 150, 150, 52, 150, 150, 150, 102, 56, 150, 148, 150, 150], "policy_policy_0_reward": [-579.0022239051452, -285.5421323420708, -367.9473343032234, -478.83915414106866, -1007.2170610494297, -1069.6348933152187, -729.3385079895976, -956.1422607547437, -939.0863252789168, -730.4433930295266, -896.0650952312324, -400.8312555854338, -798.3669367192921, -399.05784546403413, -484.84464324096547, -798.1603493314559, -1312.1219641003393, -331.19090667596424, -1062.6425657877219, -119.20492113692487, -1028.7142710162489, -475.02644307260806, -166.46853195045352, -982.8930464812264, -1186.474562308887, -958.759989996142, -965.2282160320352, -905.5578337249427, -1038.2038121689052, -691.908359361158, -903.031711060113, -867.8335742640159, -986.5919822943414, -610.1166154309258, -785.7171066357492, -96.40187453121649, -805.2790130930227, -764.852252504469, -1001.5124406755863, -240.0290103131123, -605.0326540408404, -54.26324282580497, -532.5265189717209, -884.6391600447389, -507.49644584737905, -459.1945609612906, -711.1706823650035, -759.1026149124077, -515.914522820109, -928.9266070437908, -490.19570864161057, -296.85022229359544, -819.6735177634451, -886.7026926081029, -942.9680311859229, -431.77961696785644, -530.9502060523639, -206.6639121327595, -906.5434571106795, -906.1495946912555, -498.7544585328608, -803.0494013803711, -1107.3280996908418, -1013.1344477531851, -700.4418908227826, -1184.2077192955412, -513.9194915542538, -1048.8546991277133, -1089.2576288135892, -861.6552111923376, -91.5177790282407, -946.8449053510637, -685.954965248435, -712.7013212348959, -427.39102196013283, -521.1279379591042, -386.48979701037194, -727.11644962193, -722.9924430358114, -784.7746888192727, -1071.2638814505367, -508.63304691871167, -980.0797283466478, -522.6409354250159, -681.3181402473011, -119.69843793689466, -967.7151131084405, -284.1009526623152, -552.9368253068983, -908.4100992638301, -28.39012254201492, -593.0115903514219, -425.2985643705189, -808.6007098398431, -310.789908563892, -52.359793400259406, -708.208441287612, -424.90328853306045, -964.4258495797894, -621.0929113271231]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564475668118336, "mean_inference_ms": 1.679973383239284, "mean_action_processing_ms": 0.28075234596753323, "mean_env_wait_ms": 2.9984666273721583, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011645793914794922, "StateBufferConnector_ms": 0.007929563522338867, "ViewRequirementAgentConnector_ms": 0.19272422790527344}, "num_episodes": 31, "episode_return_max": -28.39012254201492, "episode_return_min": -1312.1219641003393, "episode_return_mean": -679.44417083473, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.0315390824763, "num_env_steps_trained_throughput_per_sec": 315.0315390824763, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 11688.161, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11688.086, "sample_time_ms": 1035.407, "learn_time_ms": 10588.609, "learn_throughput": 377.764, "synch_weights_time_ms": 63.227}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00009", "date": "2024-08-03_04-00-03", "timestamp": 1722637803, "time_this_iter_s": 12.711008310317993, "time_total_s": 143.0912961959839, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b19ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 143.0912961959839, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.01052631578947, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 116.12469191253186, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.3633853495121, "policy_loss": -0.011127651411031062, "vf_loss": 4.369999693334103, "vf_explained_var": 0.9619012386227648, "kl": 0.015092910339869089, "entropy": 1.4561416337887445, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -28.39012254201492, "episode_reward_min": -1184.2077192955412, "episode_reward_mean": -692.2678996849314, "episode_len_mean": 139.61, "episode_media": {}, "episodes_timesteps_total": 13961, "policy_reward_min": {"policy_0": -1184.2077192955412}, "policy_reward_max": {"policy_0": -28.39012254201492}, "policy_reward_mean": {"policy_0": -692.2678996849314}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1038.2038121689052, -691.908359361158, -903.031711060113, -867.8335742640159, -986.5919822943414, -610.1166154309258, -785.7171066357492, -96.40187453121649, -805.2790130930227, -764.852252504469, -1001.5124406755863, -240.0290103131123, -605.0326540408404, -54.26324282580497, -532.5265189717209, -884.6391600447389, -507.49644584737905, -459.1945609612906, -711.1706823650035, -759.1026149124077, -515.914522820109, -928.9266070437908, -490.19570864161057, -296.85022229359544, -819.6735177634451, -886.7026926081029, -942.9680311859229, -431.77961696785644, -530.9502060523639, -206.6639121327595, -906.5434571106795, -906.1495946912555, -498.7544585328608, -803.0494013803711, -1107.3280996908418, -1013.1344477531851, -700.4418908227826, -1184.2077192955412, -513.9194915542538, -1048.8546991277133, -1089.2576288135892, -861.6552111923376, -91.5177790282407, -946.8449053510637, -685.954965248435, -712.7013212348959, -427.39102196013283, -521.1279379591042, -386.48979701037194, -727.11644962193, -722.9924430358114, -784.7746888192727, -1071.2638814505367, -508.63304691871167, -980.0797283466478, -522.6409354250159, -681.3181402473011, -119.69843793689466, -967.7151131084405, -284.1009526623152, -552.9368253068983, -908.4100992638301, -28.39012254201492, -593.0115903514219, -425.2985643705189, -808.6007098398431, -310.789908563892, -52.359793400259406, -708.208441287612, -424.90328853306045, -964.4258495797894, -621.0929113271231, -546.8737095172532, -911.6526249349196, -665.910321185022, -892.7537161746427, -633.0193027052946, -706.0277869376637, -681.2154049780937, -955.2555691109677, -51.218572034154334, -981.4145627657732, -365.7003797511173, -1089.4250390533084, -1123.5733510647485, -805.745365947415, -260.75436685956373, -1142.698393608871, -958.7606489126538, -811.8105206721272, -607.2280059824357, -1179.721520701827, -914.8074283883462, -825.8329149934619, -878.6375656803195, -987.2162955655407, -516.1468523937016, -590.1982373122607, -866.1975363267685, -747.3795554267357], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 87, 150, 52, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 68, 150, 150, 150, 150, 52, 150, 150, 150, 102, 56, 150, 148, 150, 150, 150, 150, 150, 150, 137, 150, 132, 150, 49, 150, 103, 150, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1038.2038121689052, -691.908359361158, -903.031711060113, -867.8335742640159, -986.5919822943414, -610.1166154309258, -785.7171066357492, -96.40187453121649, -805.2790130930227, -764.852252504469, -1001.5124406755863, -240.0290103131123, -605.0326540408404, -54.26324282580497, -532.5265189717209, -884.6391600447389, -507.49644584737905, -459.1945609612906, -711.1706823650035, -759.1026149124077, -515.914522820109, -928.9266070437908, -490.19570864161057, -296.85022229359544, -819.6735177634451, -886.7026926081029, -942.9680311859229, -431.77961696785644, -530.9502060523639, -206.6639121327595, -906.5434571106795, -906.1495946912555, -498.7544585328608, -803.0494013803711, -1107.3280996908418, -1013.1344477531851, -700.4418908227826, -1184.2077192955412, -513.9194915542538, -1048.8546991277133, -1089.2576288135892, -861.6552111923376, -91.5177790282407, -946.8449053510637, -685.954965248435, -712.7013212348959, -427.39102196013283, -521.1279379591042, -386.48979701037194, -727.11644962193, -722.9924430358114, -784.7746888192727, -1071.2638814505367, -508.63304691871167, -980.0797283466478, -522.6409354250159, -681.3181402473011, -119.69843793689466, -967.7151131084405, -284.1009526623152, -552.9368253068983, -908.4100992638301, -28.39012254201492, -593.0115903514219, -425.2985643705189, -808.6007098398431, -310.789908563892, -52.359793400259406, -708.208441287612, -424.90328853306045, -964.4258495797894, -621.0929113271231, -546.8737095172532, -911.6526249349196, -665.910321185022, -892.7537161746427, -633.0193027052946, -706.0277869376637, -681.2154049780937, -955.2555691109677, -51.218572034154334, -981.4145627657732, -365.7003797511173, -1089.4250390533084, -1123.5733510647485, -805.745365947415, -260.75436685956373, -1142.698393608871, -958.7606489126538, -811.8105206721272, -607.2280059824357, -1179.721520701827, -914.8074283883462, -825.8329149934619, -878.6375656803195, -987.2162955655407, -516.1468523937016, -590.1982373122607, -866.1975363267685, -747.3795554267357]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558715326563228, "mean_inference_ms": 1.6793659254961049, "mean_action_processing_ms": 0.2805642136160185, "mean_env_wait_ms": 3.00137101328571, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01157236099243164, "StateBufferConnector_ms": 0.008080720901489258, "ViewRequirementAgentConnector_ms": 0.1952195167541504}, "num_episodes": 28, "episode_return_max": -28.39012254201492, "episode_return_min": -1184.2077192955412, "episode_return_mean": -692.2678996849314, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.77951638809805, "num_env_steps_trained_throughput_per_sec": 347.77951638809805, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12080.528, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12080.452, "sample_time_ms": 1035.356, "learn_time_ms": 10980.217, "learn_throughput": 364.292, "synch_weights_time_ms": 63.983}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00009", "date": "2024-08-03_04-00-15", "timestamp": 1722637815, "time_this_iter_s": 11.514239311218262, "time_total_s": 154.60553550720215, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b1b130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 154.60553550720215, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.543750000000003, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 149.9965326766173, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.625007982427875, "policy_loss": -0.009855866228463128, "vf_loss": 3.6295637701948484, "vf_explained_var": 0.9823508535822233, "kl": 0.01771863115469995, "entropy": 1.550636122499903, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -28.39012254201492, "episode_reward_min": -1184.2077192955412, "episode_reward_mean": -724.6831872844192, "episode_len_mean": 140.06, "episode_media": {}, "episodes_timesteps_total": 14006, "policy_reward_min": {"policy_0": -1184.2077192955412}, "policy_reward_max": {"policy_0": -28.39012254201492}, "policy_reward_mean": {"policy_0": -724.6831872844192}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-906.5434571106795, -906.1495946912555, -498.7544585328608, -803.0494013803711, -1107.3280996908418, -1013.1344477531851, -700.4418908227826, -1184.2077192955412, -513.9194915542538, -1048.8546991277133, -1089.2576288135892, -861.6552111923376, -91.5177790282407, -946.8449053510637, -685.954965248435, -712.7013212348959, -427.39102196013283, -521.1279379591042, -386.48979701037194, -727.11644962193, -722.9924430358114, -784.7746888192727, -1071.2638814505367, -508.63304691871167, -980.0797283466478, -522.6409354250159, -681.3181402473011, -119.69843793689466, -967.7151131084405, -284.1009526623152, -552.9368253068983, -908.4100992638301, -28.39012254201492, -593.0115903514219, -425.2985643705189, -808.6007098398431, -310.789908563892, -52.359793400259406, -708.208441287612, -424.90328853306045, -964.4258495797894, -621.0929113271231, -546.8737095172532, -911.6526249349196, -665.910321185022, -892.7537161746427, -633.0193027052946, -706.0277869376637, -681.2154049780937, -955.2555691109677, -51.218572034154334, -981.4145627657732, -365.7003797511173, -1089.4250390533084, -1123.5733510647485, -805.745365947415, -260.75436685956373, -1142.698393608871, -958.7606489126538, -811.8105206721272, -607.2280059824357, -1179.721520701827, -914.8074283883462, -825.8329149934619, -878.6375656803195, -987.2162955655407, -516.1468523937016, -590.1982373122607, -866.1975363267685, -747.3795554267357, -797.5053775393478, -1037.2829256138264, -958.1041256724689, -82.47210562342977, -864.8000760477688, -1151.6570296040466, -799.4932048318194, -560.1241106235793, -1023.6074536059475, -744.0453391967868, -194.02777927126007, -1003.8884011512278, -1174.1848073215558, -253.473424736688, -831.0895392187113, -324.8293451220839, -1034.4578452054704, -524.3722611737868, -951.5680716027518, -928.6879318313496, -1016.0558016737288, -878.7723427565321, -881.5891599302464, -1139.4656362334874, -138.03536032279607, -930.0817773280718, -176.53366201761116, -829.0884337352338, -660.2698382519532, -707.4942625165694], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 68, 150, 150, 150, 150, 52, 150, 150, 150, 102, 56, 150, 148, 150, 150, 150, 150, 150, 150, 137, 150, 132, 150, 49, 150, 103, 150, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 73, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 103, 150, 150, 150], "policy_policy_0_reward": [-906.5434571106795, -906.1495946912555, -498.7544585328608, -803.0494013803711, -1107.3280996908418, -1013.1344477531851, -700.4418908227826, -1184.2077192955412, -513.9194915542538, -1048.8546991277133, -1089.2576288135892, -861.6552111923376, -91.5177790282407, -946.8449053510637, -685.954965248435, -712.7013212348959, -427.39102196013283, -521.1279379591042, -386.48979701037194, -727.11644962193, -722.9924430358114, -784.7746888192727, -1071.2638814505367, -508.63304691871167, -980.0797283466478, -522.6409354250159, -681.3181402473011, -119.69843793689466, -967.7151131084405, -284.1009526623152, -552.9368253068983, -908.4100992638301, -28.39012254201492, -593.0115903514219, -425.2985643705189, -808.6007098398431, -310.789908563892, -52.359793400259406, -708.208441287612, -424.90328853306045, -964.4258495797894, -621.0929113271231, -546.8737095172532, -911.6526249349196, -665.910321185022, -892.7537161746427, -633.0193027052946, -706.0277869376637, -681.2154049780937, -955.2555691109677, -51.218572034154334, -981.4145627657732, -365.7003797511173, -1089.4250390533084, -1123.5733510647485, -805.745365947415, -260.75436685956373, -1142.698393608871, -958.7606489126538, -811.8105206721272, -607.2280059824357, -1179.721520701827, -914.8074283883462, -825.8329149934619, -878.6375656803195, -987.2162955655407, -516.1468523937016, -590.1982373122607, -866.1975363267685, -747.3795554267357, -797.5053775393478, -1037.2829256138264, -958.1041256724689, -82.47210562342977, -864.8000760477688, -1151.6570296040466, -799.4932048318194, -560.1241106235793, -1023.6074536059475, -744.0453391967868, -194.02777927126007, -1003.8884011512278, -1174.1848073215558, -253.473424736688, -831.0895392187113, -324.8293451220839, -1034.4578452054704, -524.3722611737868, -951.5680716027518, -928.6879318313496, -1016.0558016737288, -878.7723427565321, -881.5891599302464, -1139.4656362334874, -138.03536032279607, -930.0817773280718, -176.53366201761116, -829.0884337352338, -660.2698382519532, -707.4942625165694]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548979951809669, "mean_inference_ms": 1.677669242446174, "mean_action_processing_ms": 0.28007570566146095, "mean_env_wait_ms": 3.003402104831918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011566638946533203, "StateBufferConnector_ms": 0.008028984069824219, "ViewRequirementAgentConnector_ms": 0.1946117877960205}, "num_episodes": 30, "episode_return_max": -28.39012254201492, "episode_return_min": -1184.2077192955412, "episode_return_mean": -724.6831872844192, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 373.47790291240005, "num_env_steps_trained_throughput_per_sec": 373.47790291240005, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 11870.956, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11870.88, "sample_time_ms": 1037.338, "learn_time_ms": 10770.832, "learn_throughput": 371.373, "synch_weights_time_ms": 61.813}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00009", "date": "2024-08-03_04-00-26", "timestamp": 1722637826, "time_this_iter_s": 10.722652435302734, "time_total_s": 165.32818794250488, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b1b9a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 165.32818794250488, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.44, "ram_util_percent": 27.699999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 140.354573092858, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.085876041154067, "policy_loss": -0.008789532698089412, "vf_loss": 4.089857273548842, "vf_explained_var": 0.9789913938070337, "kl": 0.01607761062047454, "entropy": 1.4985069364309311, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -28.39012254201492, "episode_reward_min": -1369.9867102288154, "episode_reward_mean": -747.553965477617, "episode_len_mean": 140.44, "episode_media": {}, "episodes_timesteps_total": 14044, "policy_reward_min": {"policy_0": -1369.9867102288154}, "policy_reward_max": {"policy_0": -28.39012254201492}, "policy_reward_mean": {"policy_0": -747.553965477617}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-119.69843793689466, -967.7151131084405, -284.1009526623152, -552.9368253068983, -908.4100992638301, -28.39012254201492, -593.0115903514219, -425.2985643705189, -808.6007098398431, -310.789908563892, -52.359793400259406, -708.208441287612, -424.90328853306045, -964.4258495797894, -621.0929113271231, -546.8737095172532, -911.6526249349196, -665.910321185022, -892.7537161746427, -633.0193027052946, -706.0277869376637, -681.2154049780937, -955.2555691109677, -51.218572034154334, -981.4145627657732, -365.7003797511173, -1089.4250390533084, -1123.5733510647485, -805.745365947415, -260.75436685956373, -1142.698393608871, -958.7606489126538, -811.8105206721272, -607.2280059824357, -1179.721520701827, -914.8074283883462, -825.8329149934619, -878.6375656803195, -987.2162955655407, -516.1468523937016, -590.1982373122607, -866.1975363267685, -747.3795554267357, -797.5053775393478, -1037.2829256138264, -958.1041256724689, -82.47210562342977, -864.8000760477688, -1151.6570296040466, -799.4932048318194, -560.1241106235793, -1023.6074536059475, -744.0453391967868, -194.02777927126007, -1003.8884011512278, -1174.1848073215558, -253.473424736688, -831.0895392187113, -324.8293451220839, -1034.4578452054704, -524.3722611737868, -951.5680716027518, -928.6879318313496, -1016.0558016737288, -878.7723427565321, -881.5891599302464, -1139.4656362334874, -138.03536032279607, -930.0817773280718, -176.53366201761116, -829.0884337352338, -660.2698382519532, -707.4942625165694, -1369.9867102288154, -667.5413880203472, -1153.1729683996612, -1156.7424831255162, -1162.5472782068416, -1233.9113744014562, -812.2177751822969, -420.4126354075006, -705.2462250833445, -419.5847261927581, -549.4135659529745, -769.472534246145, -809.7275393628645, -989.2574162895961, -1000.4081304862045, -1064.6553944049067, -767.3760738610572, -1216.9540513825439, -840.5303443443955, -742.3499649972084, -1054.9538589350898, -1074.9586372317615, -701.6111247780685, -546.2070612155371, -622.0290944443475, -148.19240674047754, -691.7601980209569], "episode_lengths": [68, 150, 150, 150, 150, 52, 150, 150, 150, 102, 56, 150, 148, 150, 150, 150, 150, 150, 150, 137, 150, 132, 150, 49, 150, 103, 150, 150, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 73, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150], "policy_policy_0_reward": [-119.69843793689466, -967.7151131084405, -284.1009526623152, -552.9368253068983, -908.4100992638301, -28.39012254201492, -593.0115903514219, -425.2985643705189, -808.6007098398431, -310.789908563892, -52.359793400259406, -708.208441287612, -424.90328853306045, -964.4258495797894, -621.0929113271231, -546.8737095172532, -911.6526249349196, -665.910321185022, -892.7537161746427, -633.0193027052946, -706.0277869376637, -681.2154049780937, -955.2555691109677, -51.218572034154334, -981.4145627657732, -365.7003797511173, -1089.4250390533084, -1123.5733510647485, -805.745365947415, -260.75436685956373, -1142.698393608871, -958.7606489126538, -811.8105206721272, -607.2280059824357, -1179.721520701827, -914.8074283883462, -825.8329149934619, -878.6375656803195, -987.2162955655407, -516.1468523937016, -590.1982373122607, -866.1975363267685, -747.3795554267357, -797.5053775393478, -1037.2829256138264, -958.1041256724689, -82.47210562342977, -864.8000760477688, -1151.6570296040466, -799.4932048318194, -560.1241106235793, -1023.6074536059475, -744.0453391967868, -194.02777927126007, -1003.8884011512278, -1174.1848073215558, -253.473424736688, -831.0895392187113, -324.8293451220839, -1034.4578452054704, -524.3722611737868, -951.5680716027518, -928.6879318313496, -1016.0558016737288, -878.7723427565321, -881.5891599302464, -1139.4656362334874, -138.03536032279607, -930.0817773280718, -176.53366201761116, -829.0884337352338, -660.2698382519532, -707.4942625165694, -1369.9867102288154, -667.5413880203472, -1153.1729683996612, -1156.7424831255162, -1162.5472782068416, -1233.9113744014562, -812.2177751822969, -420.4126354075006, -705.2462250833445, -419.5847261927581, -549.4135659529745, -769.472534246145, -809.7275393628645, -989.2574162895961, -1000.4081304862045, -1064.6553944049067, -767.3760738610572, -1216.9540513825439, -840.5303443443955, -742.3499649972084, -1054.9538589350898, -1074.9586372317615, -701.6111247780685, -546.2070612155371, -622.0290944443475, -148.19240674047754, -691.7601980209569]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.55455905721948, "mean_inference_ms": 1.6786281117119717, "mean_action_processing_ms": 0.28005714902522616, "mean_env_wait_ms": 3.0077199477877823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011918067932128906, "StateBufferConnector_ms": 0.008007049560546875, "ViewRequirementAgentConnector_ms": 0.19515013694763184}, "num_episodes": 27, "episode_return_max": -28.39012254201492, "episode_return_min": -1369.9867102288154, "episode_return_mean": -747.553965477617, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 550.6227188071914, "num_env_steps_trained_throughput_per_sec": 550.6227188071914, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 11311.495, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11311.42, "sample_time_ms": 1038.892, "learn_time_ms": 10210.16, "learn_throughput": 391.767, "synch_weights_time_ms": 61.472}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00009", "date": "2024-08-03_04-00-33", "timestamp": 1722637833, "time_this_iter_s": 7.278102874755859, "time_total_s": 172.60629081726074, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad0b80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 172.60629081726074, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 23.03, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 161.74887749354045, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.9186636875073115, "policy_loss": -0.0020976077585752742, "vf_loss": 3.9172327200571697, "vf_explained_var": 0.9854544876764219, "kl": 0.011811632627601909, "entropy": 1.4920338117827971, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -4.033906735724216, "episode_reward_min": -1379.5548547040894, "episode_reward_mean": -780.0596047092783, "episode_len_mean": 141.21, "episode_media": {}, "episodes_timesteps_total": 14121, "policy_reward_min": {"policy_0": -1379.5548547040894}, "policy_reward_max": {"policy_0": -4.033906735724216}, "policy_reward_mean": {"policy_0": -780.0596047092783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-958.7606489126538, -811.8105206721272, -607.2280059824357, -1179.721520701827, -914.8074283883462, -825.8329149934619, -878.6375656803195, -987.2162955655407, -516.1468523937016, -590.1982373122607, -866.1975363267685, -747.3795554267357, -797.5053775393478, -1037.2829256138264, -958.1041256724689, -82.47210562342977, -864.8000760477688, -1151.6570296040466, -799.4932048318194, -560.1241106235793, -1023.6074536059475, -744.0453391967868, -194.02777927126007, -1003.8884011512278, -1174.1848073215558, -253.473424736688, -831.0895392187113, -324.8293451220839, -1034.4578452054704, -524.3722611737868, -951.5680716027518, -928.6879318313496, -1016.0558016737288, -878.7723427565321, -881.5891599302464, -1139.4656362334874, -138.03536032279607, -930.0817773280718, -176.53366201761116, -829.0884337352338, -660.2698382519532, -707.4942625165694, -1369.9867102288154, -667.5413880203472, -1153.1729683996612, -1156.7424831255162, -1162.5472782068416, -1233.9113744014562, -812.2177751822969, -420.4126354075006, -705.2462250833445, -419.5847261927581, -549.4135659529745, -769.472534246145, -809.7275393628645, -989.2574162895961, -1000.4081304862045, -1064.6553944049067, -767.3760738610572, -1216.9540513825439, -840.5303443443955, -742.3499649972084, -1054.9538589350898, -1074.9586372317615, -701.6111247780685, -546.2070612155371, -622.0290944443475, -148.19240674047754, -691.7601980209569, -1074.951521613717, -48.17293499555465, -1006.2907409566751, -641.7699252388318, -919.8683741968969, -928.8767509032988, -596.2333192938514, -1111.2448102639987, -13.138187520723843, -1096.6332014655654, -879.6234820021749, -842.8651490239237, -4.033906735724216, -830.6549286212031, -1024.2377238347872, -207.1740227883455, -952.8370021662179, -1379.5548547040894, -949.026586390953, -276.69358055062725, -712.1882568700152, -757.34161722531, -1252.7568915070974, -227.78413311964877, -641.4790120836104, -59.126663201150215, -515.6646579375138, -791.9598698159306, -1348.0753190938192, -1116.1469109105635, -627.3406628370365], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 73, 150, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 62, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 46, 150, 150, 109, 150, 150, 150, 136, 150, 150, 150, 105, 150, 62, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-958.7606489126538, -811.8105206721272, -607.2280059824357, -1179.721520701827, -914.8074283883462, -825.8329149934619, -878.6375656803195, -987.2162955655407, -516.1468523937016, -590.1982373122607, -866.1975363267685, -747.3795554267357, -797.5053775393478, -1037.2829256138264, -958.1041256724689, -82.47210562342977, -864.8000760477688, -1151.6570296040466, -799.4932048318194, -560.1241106235793, -1023.6074536059475, -744.0453391967868, -194.02777927126007, -1003.8884011512278, -1174.1848073215558, -253.473424736688, -831.0895392187113, -324.8293451220839, -1034.4578452054704, -524.3722611737868, -951.5680716027518, -928.6879318313496, -1016.0558016737288, -878.7723427565321, -881.5891599302464, -1139.4656362334874, -138.03536032279607, -930.0817773280718, -176.53366201761116, -829.0884337352338, -660.2698382519532, -707.4942625165694, -1369.9867102288154, -667.5413880203472, -1153.1729683996612, -1156.7424831255162, -1162.5472782068416, -1233.9113744014562, -812.2177751822969, -420.4126354075006, -705.2462250833445, -419.5847261927581, -549.4135659529745, -769.472534246145, -809.7275393628645, -989.2574162895961, -1000.4081304862045, -1064.6553944049067, -767.3760738610572, -1216.9540513825439, -840.5303443443955, -742.3499649972084, -1054.9538589350898, -1074.9586372317615, -701.6111247780685, -546.2070612155371, -622.0290944443475, -148.19240674047754, -691.7601980209569, -1074.951521613717, -48.17293499555465, -1006.2907409566751, -641.7699252388318, -919.8683741968969, -928.8767509032988, -596.2333192938514, -1111.2448102639987, -13.138187520723843, -1096.6332014655654, -879.6234820021749, -842.8651490239237, -4.033906735724216, -830.6549286212031, -1024.2377238347872, -207.1740227883455, -952.8370021662179, -1379.5548547040894, -949.026586390953, -276.69358055062725, -712.1882568700152, -757.34161722531, -1252.7568915070974, -227.78413311964877, -641.4790120836104, -59.126663201150215, -515.6646579375138, -791.9598698159306, -1348.0753190938192, -1116.1469109105635, -627.3406628370365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543917738057518, "mean_inference_ms": 1.6780127037008672, "mean_action_processing_ms": 0.2795878348151748, "mean_env_wait_ms": 3.0124501483727637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011920928955078125, "StateBufferConnector_ms": 0.008178472518920898, "ViewRequirementAgentConnector_ms": 0.20844197273254395}, "num_episodes": 31, "episode_return_max": -4.033906735724216, "episode_return_min": -1379.5548547040894, "episode_return_mean": -780.0596047092783, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.28832461190115, "num_env_steps_trained_throughput_per_sec": 355.28832461190115, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 11106.66, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11106.589, "sample_time_ms": 1044.042, "learn_time_ms": 10002.627, "learn_throughput": 399.895, "synch_weights_time_ms": 59.063}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00009", "date": "2024-08-03_04-00-44", "timestamp": 1722637844, "time_this_iter_s": 11.270394563674927, "time_total_s": 183.87668538093567, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b1ad40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 183.87668538093567, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.26875, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 198.74000216325123, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.7928613564620415, "policy_loss": -0.007325458307847536, "vf_loss": 3.7961616605520248, "vf_explained_var": 0.9673344532648722, "kl": 0.013466069625671177, "entropy": 1.4653080674509207, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -4.033906735724216, "episode_reward_min": -1379.5548547040894, "episode_reward_mean": -772.5765626132737, "episode_len_mean": 142.17, "episode_media": {}, "episodes_timesteps_total": 14217, "policy_reward_min": {"policy_0": -1379.5548547040894}, "policy_reward_max": {"policy_0": -4.033906735724216}, "policy_reward_mean": {"policy_0": -772.5765626132737}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-831.0895392187113, -324.8293451220839, -1034.4578452054704, -524.3722611737868, -951.5680716027518, -928.6879318313496, -1016.0558016737288, -878.7723427565321, -881.5891599302464, -1139.4656362334874, -138.03536032279607, -930.0817773280718, -176.53366201761116, -829.0884337352338, -660.2698382519532, -707.4942625165694, -1369.9867102288154, -667.5413880203472, -1153.1729683996612, -1156.7424831255162, -1162.5472782068416, -1233.9113744014562, -812.2177751822969, -420.4126354075006, -705.2462250833445, -419.5847261927581, -549.4135659529745, -769.472534246145, -809.7275393628645, -989.2574162895961, -1000.4081304862045, -1064.6553944049067, -767.3760738610572, -1216.9540513825439, -840.5303443443955, -742.3499649972084, -1054.9538589350898, -1074.9586372317615, -701.6111247780685, -546.2070612155371, -622.0290944443475, -148.19240674047754, -691.7601980209569, -1074.951521613717, -48.17293499555465, -1006.2907409566751, -641.7699252388318, -919.8683741968969, -928.8767509032988, -596.2333192938514, -1111.2448102639987, -13.138187520723843, -1096.6332014655654, -879.6234820021749, -842.8651490239237, -4.033906735724216, -830.6549286212031, -1024.2377238347872, -207.1740227883455, -952.8370021662179, -1379.5548547040894, -949.026586390953, -276.69358055062725, -712.1882568700152, -757.34161722531, -1252.7568915070974, -227.78413311964877, -641.4790120836104, -59.126663201150215, -515.6646579375138, -791.9598698159306, -1348.0753190938192, -1116.1469109105635, -627.3406628370365, -643.3294081651572, -435.1134927641227, -452.3477576394825, -975.203904549802, -466.38039583964144, -814.0971977335907, -702.8165877861838, -930.0969066281989, -762.3872335844337, -587.4724001173506, -971.1321829962723, -762.8144857853697, -921.2905102098267, -768.1607577516124, -1014.1937986635664, -470.3246573218792, -277.7763955636616, -1069.1855522961364, -607.2065565938093, -667.229314703733, -920.9426319066974, -605.1381879763147, -1143.9109865826013, -1167.75846790497, -1125.3820223871971, -518.6072401438296], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 62, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 46, 150, 150, 109, 150, 150, 150, 136, 150, 150, 150, 105, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122], "policy_policy_0_reward": [-831.0895392187113, -324.8293451220839, -1034.4578452054704, -524.3722611737868, -951.5680716027518, -928.6879318313496, -1016.0558016737288, -878.7723427565321, -881.5891599302464, -1139.4656362334874, -138.03536032279607, -930.0817773280718, -176.53366201761116, -829.0884337352338, -660.2698382519532, -707.4942625165694, -1369.9867102288154, -667.5413880203472, -1153.1729683996612, -1156.7424831255162, -1162.5472782068416, -1233.9113744014562, -812.2177751822969, -420.4126354075006, -705.2462250833445, -419.5847261927581, -549.4135659529745, -769.472534246145, -809.7275393628645, -989.2574162895961, -1000.4081304862045, -1064.6553944049067, -767.3760738610572, -1216.9540513825439, -840.5303443443955, -742.3499649972084, -1054.9538589350898, -1074.9586372317615, -701.6111247780685, -546.2070612155371, -622.0290944443475, -148.19240674047754, -691.7601980209569, -1074.951521613717, -48.17293499555465, -1006.2907409566751, -641.7699252388318, -919.8683741968969, -928.8767509032988, -596.2333192938514, -1111.2448102639987, -13.138187520723843, -1096.6332014655654, -879.6234820021749, -842.8651490239237, -4.033906735724216, -830.6549286212031, -1024.2377238347872, -207.1740227883455, -952.8370021662179, -1379.5548547040894, -949.026586390953, -276.69358055062725, -712.1882568700152, -757.34161722531, -1252.7568915070974, -227.78413311964877, -641.4790120836104, -59.126663201150215, -515.6646579375138, -791.9598698159306, -1348.0753190938192, -1116.1469109105635, -627.3406628370365, -643.3294081651572, -435.1134927641227, -452.3477576394825, -975.203904549802, -466.38039583964144, -814.0971977335907, -702.8165877861838, -930.0969066281989, -762.3872335844337, -587.4724001173506, -971.1321829962723, -762.8144857853697, -921.2905102098267, -768.1607577516124, -1014.1937986635664, -470.3246573218792, -277.7763955636616, -1069.1855522961364, -607.2065565938093, -667.229314703733, -920.9426319066974, -605.1381879763147, -1143.9109865826013, -1167.75846790497, -1125.3820223871971, -518.6072401438296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5544138759553946, "mean_inference_ms": 1.6798136598674813, "mean_action_processing_ms": 0.2794685457971514, "mean_env_wait_ms": 3.0180660604984424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011995315551757812, "StateBufferConnector_ms": 0.008121728897094727, "ViewRequirementAgentConnector_ms": 0.2062995433807373}, "num_episodes": 26, "episode_return_max": -4.033906735724216, "episode_return_min": -1379.5548547040894, "episode_return_mean": -772.5765626132737, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.3285802446519, "num_env_steps_trained_throughput_per_sec": 301.3285802446519, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 11184.525, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11184.454, "sample_time_ms": 1055.103, "learn_time_ms": 10067.722, "learn_throughput": 397.309, "synch_weights_time_ms": 60.755}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00009", "date": "2024-08-03_04-00-58", "timestamp": 1722637858, "time_this_iter_s": 13.28724217414856, "time_total_s": 197.16392755508423, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b1ac20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 197.16392755508423, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.15263157894737, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 186.54194470643998, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.698189949989319, "policy_loss": -0.008526336719902853, "vf_loss": 3.7023985487719377, "vf_explained_var": 0.9777966250355045, "kl": 0.01443875132099495, "entropy": 1.3896490140507618, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -4.033906735724216, "episode_reward_min": -1379.5548547040894, "episode_reward_mean": -737.9515845082046, "episode_len_mean": 139.26, "episode_media": {}, "episodes_timesteps_total": 13926, "policy_reward_min": {"policy_0": -1379.5548547040894}, "policy_reward_max": {"policy_0": -4.033906735724216}, "policy_reward_mean": {"policy_0": -737.9515845082046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1000.4081304862045, -1064.6553944049067, -767.3760738610572, -1216.9540513825439, -840.5303443443955, -742.3499649972084, -1054.9538589350898, -1074.9586372317615, -701.6111247780685, -546.2070612155371, -622.0290944443475, -148.19240674047754, -691.7601980209569, -1074.951521613717, -48.17293499555465, -1006.2907409566751, -641.7699252388318, -919.8683741968969, -928.8767509032988, -596.2333192938514, -1111.2448102639987, -13.138187520723843, -1096.6332014655654, -879.6234820021749, -842.8651490239237, -4.033906735724216, -830.6549286212031, -1024.2377238347872, -207.1740227883455, -952.8370021662179, -1379.5548547040894, -949.026586390953, -276.69358055062725, -712.1882568700152, -757.34161722531, -1252.7568915070974, -227.78413311964877, -641.4790120836104, -59.126663201150215, -515.6646579375138, -791.9598698159306, -1348.0753190938192, -1116.1469109105635, -627.3406628370365, -643.3294081651572, -435.1134927641227, -452.3477576394825, -975.203904549802, -466.38039583964144, -814.0971977335907, -702.8165877861838, -930.0969066281989, -762.3872335844337, -587.4724001173506, -971.1321829962723, -762.8144857853697, -921.2905102098267, -768.1607577516124, -1014.1937986635664, -470.3246573218792, -277.7763955636616, -1069.1855522961364, -607.2065565938093, -667.229314703733, -920.9426319066974, -605.1381879763147, -1143.9109865826013, -1167.75846790497, -1125.3820223871971, -518.6072401438296, -734.288874412853, -474.03282020246456, -732.5976976049471, -1010.3813374537214, -94.94391046279284, -828.4081752467246, -670.999893905502, -162.85148165128476, -741.7537807777337, -1038.785718693155, -842.5420238586406, -132.5776200043915, -649.4402902451887, -808.2388668186273, -897.3086840580922, -402.40113439915007, -793.5515475292459, -632.9075006379682, -1002.1474472229906, -1163.2189681705204, -78.01434069319545, -974.1815220795888, -772.4590559885893, -272.84082297853087, -625.4267488518144, -455.54215219261044, -1171.048886391886, -1170.1425438653646, -752.9286848594227, -623.1655472566254], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 62, 150, 150, 150, 150, 150, 150, 45, 150, 150, 150, 46, 150, 150, 109, 150, 150, 150, 136, 150, 150, 150, 105, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 117, 150, 150, 80, 150, 150, 99, 150, 150, 150, 58, 143, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 102, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1000.4081304862045, -1064.6553944049067, -767.3760738610572, -1216.9540513825439, -840.5303443443955, -742.3499649972084, -1054.9538589350898, -1074.9586372317615, -701.6111247780685, -546.2070612155371, -622.0290944443475, -148.19240674047754, -691.7601980209569, -1074.951521613717, -48.17293499555465, -1006.2907409566751, -641.7699252388318, -919.8683741968969, -928.8767509032988, -596.2333192938514, -1111.2448102639987, -13.138187520723843, -1096.6332014655654, -879.6234820021749, -842.8651490239237, -4.033906735724216, -830.6549286212031, -1024.2377238347872, -207.1740227883455, -952.8370021662179, -1379.5548547040894, -949.026586390953, -276.69358055062725, -712.1882568700152, -757.34161722531, -1252.7568915070974, -227.78413311964877, -641.4790120836104, -59.126663201150215, -515.6646579375138, -791.9598698159306, -1348.0753190938192, -1116.1469109105635, -627.3406628370365, -643.3294081651572, -435.1134927641227, -452.3477576394825, -975.203904549802, -466.38039583964144, -814.0971977335907, -702.8165877861838, -930.0969066281989, -762.3872335844337, -587.4724001173506, -971.1321829962723, -762.8144857853697, -921.2905102098267, -768.1607577516124, -1014.1937986635664, -470.3246573218792, -277.7763955636616, -1069.1855522961364, -607.2065565938093, -667.229314703733, -920.9426319066974, -605.1381879763147, -1143.9109865826013, -1167.75846790497, -1125.3820223871971, -518.6072401438296, -734.288874412853, -474.03282020246456, -732.5976976049471, -1010.3813374537214, -94.94391046279284, -828.4081752467246, -670.999893905502, -162.85148165128476, -741.7537807777337, -1038.785718693155, -842.5420238586406, -132.5776200043915, -649.4402902451887, -808.2388668186273, -897.3086840580922, -402.40113439915007, -793.5515475292459, -632.9075006379682, -1002.1474472229906, -1163.2189681705204, -78.01434069319545, -974.1815220795888, -772.4590559885893, -272.84082297853087, -625.4267488518144, -455.54215219261044, -1171.048886391886, -1170.1425438653646, -752.9286848594227, -623.1655472566254]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548424365185286, "mean_inference_ms": 1.6788891959948713, "mean_action_processing_ms": 0.27903354157651483, "mean_env_wait_ms": 3.022019846133075, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01200413703918457, "StateBufferConnector_ms": 0.008155345916748047, "ViewRequirementAgentConnector_ms": 0.20734477043151855}, "num_episodes": 30, "episode_return_max": -4.033906735724216, "episode_return_min": -1379.5548547040894, "episode_return_mean": -737.9515845082046, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.7619006657237, "num_env_steps_trained_throughput_per_sec": 303.7619006657237, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 11183.825, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11183.754, "sample_time_ms": 1058.339, "learn_time_ms": 10064.037, "learn_throughput": 397.455, "synch_weights_time_ms": 60.54}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00009", "date": "2024-08-03_04-01-11", "timestamp": 1722637871, "time_this_iter_s": 13.181169509887695, "time_total_s": 210.34509706497192, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b1aa70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 210.34509706497192, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 16.97894736842105, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 231.33186998764674, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.861362385004759, "policy_loss": -0.01107882699240387, "vf_loss": 3.8678247717519603, "vf_explained_var": 0.9840547402699789, "kl": 0.01543215598385359, "entropy": 1.3191737214724222, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -59.126663201150215, "episode_reward_min": -1379.5548547040894, "episode_reward_mean": -734.3429942373382, "episode_len_mean": 141.49, "episode_media": {}, "episodes_timesteps_total": 14149, "policy_reward_min": {"policy_0": -1379.5548547040894}, "policy_reward_max": {"policy_0": -59.126663201150215}, "policy_reward_mean": {"policy_0": -734.3429942373382}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-952.8370021662179, -1379.5548547040894, -949.026586390953, -276.69358055062725, -712.1882568700152, -757.34161722531, -1252.7568915070974, -227.78413311964877, -641.4790120836104, -59.126663201150215, -515.6646579375138, -791.9598698159306, -1348.0753190938192, -1116.1469109105635, -627.3406628370365, -643.3294081651572, -435.1134927641227, -452.3477576394825, -975.203904549802, -466.38039583964144, -814.0971977335907, -702.8165877861838, -930.0969066281989, -762.3872335844337, -587.4724001173506, -971.1321829962723, -762.8144857853697, -921.2905102098267, -768.1607577516124, -1014.1937986635664, -470.3246573218792, -277.7763955636616, -1069.1855522961364, -607.2065565938093, -667.229314703733, -920.9426319066974, -605.1381879763147, -1143.9109865826013, -1167.75846790497, -1125.3820223871971, -518.6072401438296, -734.288874412853, -474.03282020246456, -732.5976976049471, -1010.3813374537214, -94.94391046279284, -828.4081752467246, -670.999893905502, -162.85148165128476, -741.7537807777337, -1038.785718693155, -842.5420238586406, -132.5776200043915, -649.4402902451887, -808.2388668186273, -897.3086840580922, -402.40113439915007, -793.5515475292459, -632.9075006379682, -1002.1474472229906, -1163.2189681705204, -78.01434069319545, -974.1815220795888, -772.4590559885893, -272.84082297853087, -625.4267488518144, -455.54215219261044, -1171.048886391886, -1170.1425438653646, -752.9286848594227, -623.1655472566254, -589.1870248491277, -818.4013431907894, -973.7035743972858, -787.248818806616, -1036.0840687398145, -576.7574176275244, -921.6724222703891, -821.1248648903749, -360.96182044126516, -775.2213716422377, -736.9203063334861, -560.9829749843545, -960.3702297630673, -237.66533128427403, -757.1773149191358, -618.5005336670753, -730.2956755744322, -1260.9120378088019, -1000.9956015228789, -794.1994228598891, -226.97159977108896, -456.2532182052078, -94.35244849796148, -1287.9415546983598, -932.5734755485464, -638.2459992961029, -678.8984629742279, -948.7753639992169, -754.5020146476292], "episode_lengths": [150, 150, 150, 136, 150, 150, 150, 105, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 117, 150, 150, 80, 150, 150, 99, 150, 150, 150, 58, 143, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 100, 150, 75, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-952.8370021662179, -1379.5548547040894, -949.026586390953, -276.69358055062725, -712.1882568700152, -757.34161722531, -1252.7568915070974, -227.78413311964877, -641.4790120836104, -59.126663201150215, -515.6646579375138, -791.9598698159306, -1348.0753190938192, -1116.1469109105635, -627.3406628370365, -643.3294081651572, -435.1134927641227, -452.3477576394825, -975.203904549802, -466.38039583964144, -814.0971977335907, -702.8165877861838, -930.0969066281989, -762.3872335844337, -587.4724001173506, -971.1321829962723, -762.8144857853697, -921.2905102098267, -768.1607577516124, -1014.1937986635664, -470.3246573218792, -277.7763955636616, -1069.1855522961364, -607.2065565938093, -667.229314703733, -920.9426319066974, -605.1381879763147, -1143.9109865826013, -1167.75846790497, -1125.3820223871971, -518.6072401438296, -734.288874412853, -474.03282020246456, -732.5976976049471, -1010.3813374537214, -94.94391046279284, -828.4081752467246, -670.999893905502, -162.85148165128476, -741.7537807777337, -1038.785718693155, -842.5420238586406, -132.5776200043915, -649.4402902451887, -808.2388668186273, -897.3086840580922, -402.40113439915007, -793.5515475292459, -632.9075006379682, -1002.1474472229906, -1163.2189681705204, -78.01434069319545, -974.1815220795888, -772.4590559885893, -272.84082297853087, -625.4267488518144, -455.54215219261044, -1171.048886391886, -1170.1425438653646, -752.9286848594227, -623.1655472566254, -589.1870248491277, -818.4013431907894, -973.7035743972858, -787.248818806616, -1036.0840687398145, -576.7574176275244, -921.6724222703891, -821.1248648903749, -360.96182044126516, -775.2213716422377, -736.9203063334861, -560.9829749843545, -960.3702297630673, -237.66533128427403, -757.1773149191358, -618.5005336670753, -730.2956755744322, -1260.9120378088019, -1000.9956015228789, -794.1994228598891, -226.97159977108896, -456.2532182052078, -94.35244849796148, -1287.9415546983598, -932.5734755485464, -638.2459992961029, -678.8984629742279, -948.7753639992169, -754.5020146476292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549015242742649, "mean_inference_ms": 1.6804090105132594, "mean_action_processing_ms": 0.2792149347644762, "mean_env_wait_ms": 3.025545330671182, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012194156646728516, "StateBufferConnector_ms": 0.008145332336425781, "ViewRequirementAgentConnector_ms": 0.19415521621704102}, "num_episodes": 29, "episode_return_max": -59.126663201150215, "episode_return_min": -1379.5548547040894, "episode_return_mean": -734.3429942373382, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.3804328699567, "num_env_steps_trained_throughput_per_sec": 304.3804328699567, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 11188.947, "restore_workers_time_ms": 0.029, "training_step_time_ms": 11188.876, "sample_time_ms": 1058.753, "learn_time_ms": 10067.979, "learn_throughput": 397.299, "synch_weights_time_ms": 61.294}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00009", "date": "2024-08-03_04-01-24", "timestamp": 1722637884, "time_this_iter_s": 13.155665874481201, "time_total_s": 223.50076293945312, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b19090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 223.50076293945312, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.021052631578947, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 177.6772887210051, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.6372265034665663, "policy_loss": -0.011476722981024068, "vf_loss": 3.643411538749933, "vf_explained_var": 0.975924777177473, "kl": 0.01768303739451466, "entropy": 1.322334956067304, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -56.87417355129816, "episode_reward_min": -1287.9415546983598, "episode_reward_mean": -728.9786181001193, "episode_len_mean": 139.64, "episode_media": {}, "episodes_timesteps_total": 13964, "policy_reward_min": {"policy_0": -1287.9415546983598}, "policy_reward_max": {"policy_0": -56.87417355129816}, "policy_reward_mean": {"policy_0": -728.9786181001193}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1014.1937986635664, -470.3246573218792, -277.7763955636616, -1069.1855522961364, -607.2065565938093, -667.229314703733, -920.9426319066974, -605.1381879763147, -1143.9109865826013, -1167.75846790497, -1125.3820223871971, -518.6072401438296, -734.288874412853, -474.03282020246456, -732.5976976049471, -1010.3813374537214, -94.94391046279284, -828.4081752467246, -670.999893905502, -162.85148165128476, -741.7537807777337, -1038.785718693155, -842.5420238586406, -132.5776200043915, -649.4402902451887, -808.2388668186273, -897.3086840580922, -402.40113439915007, -793.5515475292459, -632.9075006379682, -1002.1474472229906, -1163.2189681705204, -78.01434069319545, -974.1815220795888, -772.4590559885893, -272.84082297853087, -625.4267488518144, -455.54215219261044, -1171.048886391886, -1170.1425438653646, -752.9286848594227, -623.1655472566254, -589.1870248491277, -818.4013431907894, -973.7035743972858, -787.248818806616, -1036.0840687398145, -576.7574176275244, -921.6724222703891, -821.1248648903749, -360.96182044126516, -775.2213716422377, -736.9203063334861, -560.9829749843545, -960.3702297630673, -237.66533128427403, -757.1773149191358, -618.5005336670753, -730.2956755744322, -1260.9120378088019, -1000.9956015228789, -794.1994228598891, -226.97159977108896, -456.2532182052078, -94.35244849796148, -1287.9415546983598, -932.5734755485464, -638.2459992961029, -678.8984629742279, -948.7753639992169, -754.5020146476292, -953.8641698403065, -681.7291562510726, -885.4163649803238, -121.91342278694499, -568.7334262856735, -329.9548129414004, -725.6575596039518, -468.85440282056294, -925.2465394123642, -71.12228861466922, -893.1671862926568, -634.867437773776, -866.3672716389158, -394.6688214214797, -965.686356722115, -56.87417355129816, -707.4612617269739, -1066.6806449065637, -566.946256240626, -809.200744237473, -1224.4129877232454, -1066.3817389240314, -916.2430773946556, -1087.1205827241668, -710.3275181332202, -1030.7310051267395, -738.8069998544757, -967.0389336100782, -828.7064847029798], "episode_lengths": [150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 117, 150, 150, 80, 150, 150, 99, 150, 150, 150, 58, 143, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 100, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 133, 117, 150, 150, 150, 61, 150, 150, 150, 102, 150, 73, 147, 150, 145, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150], "policy_policy_0_reward": [-1014.1937986635664, -470.3246573218792, -277.7763955636616, -1069.1855522961364, -607.2065565938093, -667.229314703733, -920.9426319066974, -605.1381879763147, -1143.9109865826013, -1167.75846790497, -1125.3820223871971, -518.6072401438296, -734.288874412853, -474.03282020246456, -732.5976976049471, -1010.3813374537214, -94.94391046279284, -828.4081752467246, -670.999893905502, -162.85148165128476, -741.7537807777337, -1038.785718693155, -842.5420238586406, -132.5776200043915, -649.4402902451887, -808.2388668186273, -897.3086840580922, -402.40113439915007, -793.5515475292459, -632.9075006379682, -1002.1474472229906, -1163.2189681705204, -78.01434069319545, -974.1815220795888, -772.4590559885893, -272.84082297853087, -625.4267488518144, -455.54215219261044, -1171.048886391886, -1170.1425438653646, -752.9286848594227, -623.1655472566254, -589.1870248491277, -818.4013431907894, -973.7035743972858, -787.248818806616, -1036.0840687398145, -576.7574176275244, -921.6724222703891, -821.1248648903749, -360.96182044126516, -775.2213716422377, -736.9203063334861, -560.9829749843545, -960.3702297630673, -237.66533128427403, -757.1773149191358, -618.5005336670753, -730.2956755744322, -1260.9120378088019, -1000.9956015228789, -794.1994228598891, -226.97159977108896, -456.2532182052078, -94.35244849796148, -1287.9415546983598, -932.5734755485464, -638.2459992961029, -678.8984629742279, -948.7753639992169, -754.5020146476292, -953.8641698403065, -681.7291562510726, -885.4163649803238, -121.91342278694499, -568.7334262856735, -329.9548129414004, -725.6575596039518, -468.85440282056294, -925.2465394123642, -71.12228861466922, -893.1671862926568, -634.867437773776, -866.3672716389158, -394.6688214214797, -965.686356722115, -56.87417355129816, -707.4612617269739, -1066.6806449065637, -566.946256240626, -809.200744237473, -1224.4129877232454, -1066.3817389240314, -916.2430773946556, -1087.1205827241668, -710.3275181332202, -1030.7310051267395, -738.8069998544757, -967.0389336100782, -828.7064847029798]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5544377502625322, "mean_inference_ms": 1.67948654244572, "mean_action_processing_ms": 0.27905961937807694, "mean_env_wait_ms": 3.0269954946596913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011961936950683594, "StateBufferConnector_ms": 0.007945775985717773, "ViewRequirementAgentConnector_ms": 0.19188523292541504}, "num_episodes": 29, "episode_return_max": -56.87417355129816, "episode_return_min": -1287.9415546983598, "episode_return_mean": -728.9786181001193, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.223166795051, "num_env_steps_trained_throughput_per_sec": 310.223166795051, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 11305.817, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11305.746, "sample_time_ms": 1060.12, "learn_time_ms": 10183.297, "learn_throughput": 392.8, "synch_weights_time_ms": 61.487}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00009", "date": "2024-08-03_04-01-37", "timestamp": 1722637897, "time_this_iter_s": 12.907286405563354, "time_total_s": 236.40804934501648, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b1beb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 236.40804934501648, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.244444444444447, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 209.45956825415294, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.836230752368768, "policy_loss": -0.007195034607624014, "vf_loss": 3.8385990276932715, "vf_explained_var": 0.9709391432503859, "kl": 0.016133548263436163, "entropy": 1.3309756509959698, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -9.004718802740406, "episode_reward_min": -1435.914797952983, "episode_reward_mean": -720.7861300993926, "episode_len_mean": 137.77, "episode_media": {}, "episodes_timesteps_total": 13777, "policy_reward_min": {"policy_0": -1435.914797952983}, "policy_reward_max": {"policy_0": -9.004718802740406}, "policy_reward_mean": {"policy_0": -720.7861300993926}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-402.40113439915007, -793.5515475292459, -632.9075006379682, -1002.1474472229906, -1163.2189681705204, -78.01434069319545, -974.1815220795888, -772.4590559885893, -272.84082297853087, -625.4267488518144, -455.54215219261044, -1171.048886391886, -1170.1425438653646, -752.9286848594227, -623.1655472566254, -589.1870248491277, -818.4013431907894, -973.7035743972858, -787.248818806616, -1036.0840687398145, -576.7574176275244, -921.6724222703891, -821.1248648903749, -360.96182044126516, -775.2213716422377, -736.9203063334861, -560.9829749843545, -960.3702297630673, -237.66533128427403, -757.1773149191358, -618.5005336670753, -730.2956755744322, -1260.9120378088019, -1000.9956015228789, -794.1994228598891, -226.97159977108896, -456.2532182052078, -94.35244849796148, -1287.9415546983598, -932.5734755485464, -638.2459992961029, -678.8984629742279, -948.7753639992169, -754.5020146476292, -953.8641698403065, -681.7291562510726, -885.4163649803238, -121.91342278694499, -568.7334262856735, -329.9548129414004, -725.6575596039518, -468.85440282056294, -925.2465394123642, -71.12228861466922, -893.1671862926568, -634.867437773776, -866.3672716389158, -394.6688214214797, -965.686356722115, -56.87417355129816, -707.4612617269739, -1066.6806449065637, -566.946256240626, -809.200744237473, -1224.4129877232454, -1066.3817389240314, -916.2430773946556, -1087.1205827241668, -710.3275181332202, -1030.7310051267395, -738.8069998544757, -967.0389336100782, -828.7064847029798, -1099.013982598612, -757.9413402814965, -596.6367024546178, -911.3382909024174, -544.5553787573641, -976.8653819708892, -566.5656965927603, -113.5104053105536, -807.7836381871242, -18.600455737580724, -864.2445595158365, -781.3507618739885, -450.8307685322184, -676.1074023499767, -966.3086390203614, -138.2974790145412, -906.1722271134947, -564.7831960333835, -863.1328537902409, -9.004718802740406, -186.69731613141772, -964.5650593117658, -773.3751522782048, -1011.8002145352673, -908.7379127548265, -693.4238555631913, -1435.914797952983], "episode_lengths": [150, 150, 150, 150, 150, 43, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 150, 150, 150, 150, 150, 100, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 133, 117, 150, 150, 150, 61, 150, 150, 150, 102, 150, 73, 147, 150, 145, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 117, 62, 150, 41, 150, 150, 103, 150, 150, 92, 150, 150, 150, 48, 79, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-402.40113439915007, -793.5515475292459, -632.9075006379682, -1002.1474472229906, -1163.2189681705204, -78.01434069319545, -974.1815220795888, -772.4590559885893, -272.84082297853087, -625.4267488518144, -455.54215219261044, -1171.048886391886, -1170.1425438653646, -752.9286848594227, -623.1655472566254, -589.1870248491277, -818.4013431907894, -973.7035743972858, -787.248818806616, -1036.0840687398145, -576.7574176275244, -921.6724222703891, -821.1248648903749, -360.96182044126516, -775.2213716422377, -736.9203063334861, -560.9829749843545, -960.3702297630673, -237.66533128427403, -757.1773149191358, -618.5005336670753, -730.2956755744322, -1260.9120378088019, -1000.9956015228789, -794.1994228598891, -226.97159977108896, -456.2532182052078, -94.35244849796148, -1287.9415546983598, -932.5734755485464, -638.2459992961029, -678.8984629742279, -948.7753639992169, -754.5020146476292, -953.8641698403065, -681.7291562510726, -885.4163649803238, -121.91342278694499, -568.7334262856735, -329.9548129414004, -725.6575596039518, -468.85440282056294, -925.2465394123642, -71.12228861466922, -893.1671862926568, -634.867437773776, -866.3672716389158, -394.6688214214797, -965.686356722115, -56.87417355129816, -707.4612617269739, -1066.6806449065637, -566.946256240626, -809.200744237473, -1224.4129877232454, -1066.3817389240314, -916.2430773946556, -1087.1205827241668, -710.3275181332202, -1030.7310051267395, -738.8069998544757, -967.0389336100782, -828.7064847029798, -1099.013982598612, -757.9413402814965, -596.6367024546178, -911.3382909024174, -544.5553787573641, -976.8653819708892, -566.5656965927603, -113.5104053105536, -807.7836381871242, -18.600455737580724, -864.2445595158365, -781.3507618739885, -450.8307685322184, -676.1074023499767, -966.3086390203614, -138.2974790145412, -906.1722271134947, -564.7831960333835, -863.1328537902409, -9.004718802740406, -186.69731613141772, -964.5650593117658, -773.3751522782048, -1011.8002145352673, -908.7379127548265, -693.4238555631913, -1435.914797952983]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542537955868336, "mean_inference_ms": 1.678873743344302, "mean_action_processing_ms": 0.2789304718711288, "mean_env_wait_ms": 3.025306738470908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011814594268798828, "StateBufferConnector_ms": 0.007925033569335938, "ViewRequirementAgentConnector_ms": 0.19199633598327637}, "num_episodes": 27, "episode_return_max": -9.004718802740406, "episode_return_min": -1435.914797952983, "episode_return_mean": -720.7861300993926, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.05427092232435, "num_env_steps_trained_throughput_per_sec": 309.05427092232435, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 11885.276, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11885.206, "sample_time_ms": 1063.006, "learn_time_ms": 10758.021, "learn_throughput": 371.816, "synch_weights_time_ms": 63.332}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00009", "date": "2024-08-03_04-01-50", "timestamp": 1722637910, "time_this_iter_s": 12.956171989440918, "time_total_s": 249.3642213344574, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b19b40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 249.3642213344574, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.021052631578947, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 166.48282669583958, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.5719037618488074, "policy_loss": -0.011005032955047985, "vf_loss": 3.5774292471508184, "vf_explained_var": 0.9879815892626842, "kl": 0.018304817975210122, "entropy": 1.1895201318586865, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -9.004718802740406, "episode_reward_min": -1435.914797952983, "episode_reward_mean": -730.339592914739, "episode_len_mean": 137.13, "episode_media": {}, "episodes_timesteps_total": 13713, "policy_reward_min": {"policy_0": -1435.914797952983}, "policy_reward_max": {"policy_0": -9.004718802740406}, "policy_reward_mean": {"policy_0": -730.339592914739}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-757.1773149191358, -618.5005336670753, -730.2956755744322, -1260.9120378088019, -1000.9956015228789, -794.1994228598891, -226.97159977108896, -456.2532182052078, -94.35244849796148, -1287.9415546983598, -932.5734755485464, -638.2459992961029, -678.8984629742279, -948.7753639992169, -754.5020146476292, -953.8641698403065, -681.7291562510726, -885.4163649803238, -121.91342278694499, -568.7334262856735, -329.9548129414004, -725.6575596039518, -468.85440282056294, -925.2465394123642, -71.12228861466922, -893.1671862926568, -634.867437773776, -866.3672716389158, -394.6688214214797, -965.686356722115, -56.87417355129816, -707.4612617269739, -1066.6806449065637, -566.946256240626, -809.200744237473, -1224.4129877232454, -1066.3817389240314, -916.2430773946556, -1087.1205827241668, -710.3275181332202, -1030.7310051267395, -738.8069998544757, -967.0389336100782, -828.7064847029798, -1099.013982598612, -757.9413402814965, -596.6367024546178, -911.3382909024174, -544.5553787573641, -976.8653819708892, -566.5656965927603, -113.5104053105536, -807.7836381871242, -18.600455737580724, -864.2445595158365, -781.3507618739885, -450.8307685322184, -676.1074023499767, -966.3086390203614, -138.2974790145412, -906.1722271134947, -564.7831960333835, -863.1328537902409, -9.004718802740406, -186.69731613141772, -964.5650593117658, -773.3751522782048, -1011.8002145352673, -908.7379127548265, -693.4238555631913, -1435.914797952983, -620.3730920838351, -1162.9909004790366, -973.3697156788069, -767.7580138270021, -1270.0296414217505, -635.327013073016, -751.2558677511003, -902.0612672911801, -912.7411611109065, -102.77689679586537, -530.5292749875239, -783.8451633735732, -614.4836367017165, -902.7702832914783, -883.9001028162842, -1198.6279570585396, -977.9045467653706, -666.4178671810723, -1033.1503532755942, -1017.2413392320705, -1204.839445146295, -792.4074775324141, -691.2063716472599, -270.9813465517068, -719.8267697073219, -342.5203733199645, -762.6325973625154, -360.32512282256573, -149.3311555869822], "episode_lengths": [150, 150, 150, 150, 150, 150, 100, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 133, 117, 150, 150, 150, 61, 150, 150, 150, 102, 150, 73, 147, 150, 145, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 117, 62, 150, 41, 150, 150, 103, 150, 150, 92, 150, 150, 150, 48, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 107, 150, 119, 72], "policy_policy_0_reward": [-757.1773149191358, -618.5005336670753, -730.2956755744322, -1260.9120378088019, -1000.9956015228789, -794.1994228598891, -226.97159977108896, -456.2532182052078, -94.35244849796148, -1287.9415546983598, -932.5734755485464, -638.2459992961029, -678.8984629742279, -948.7753639992169, -754.5020146476292, -953.8641698403065, -681.7291562510726, -885.4163649803238, -121.91342278694499, -568.7334262856735, -329.9548129414004, -725.6575596039518, -468.85440282056294, -925.2465394123642, -71.12228861466922, -893.1671862926568, -634.867437773776, -866.3672716389158, -394.6688214214797, -965.686356722115, -56.87417355129816, -707.4612617269739, -1066.6806449065637, -566.946256240626, -809.200744237473, -1224.4129877232454, -1066.3817389240314, -916.2430773946556, -1087.1205827241668, -710.3275181332202, -1030.7310051267395, -738.8069998544757, -967.0389336100782, -828.7064847029798, -1099.013982598612, -757.9413402814965, -596.6367024546178, -911.3382909024174, -544.5553787573641, -976.8653819708892, -566.5656965927603, -113.5104053105536, -807.7836381871242, -18.600455737580724, -864.2445595158365, -781.3507618739885, -450.8307685322184, -676.1074023499767, -966.3086390203614, -138.2974790145412, -906.1722271134947, -564.7831960333835, -863.1328537902409, -9.004718802740406, -186.69731613141772, -964.5650593117658, -773.3751522782048, -1011.8002145352673, -908.7379127548265, -693.4238555631913, -1435.914797952983, -620.3730920838351, -1162.9909004790366, -973.3697156788069, -767.7580138270021, -1270.0296414217505, -635.327013073016, -751.2558677511003, -902.0612672911801, -912.7411611109065, -102.77689679586537, -530.5292749875239, -783.8451633735732, -614.4836367017165, -902.7702832914783, -883.9001028162842, -1198.6279570585396, -977.9045467653706, -666.4178671810723, -1033.1503532755942, -1017.2413392320705, -1204.839445146295, -792.4074775324141, -691.2063716472599, -270.9813465517068, -719.8267697073219, -342.5203733199645, -762.6325973625154, -360.32512282256573, -149.3311555869822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554303262077887, "mean_inference_ms": 1.6780054490743346, "mean_action_processing_ms": 0.27868904518818916, "mean_env_wait_ms": 3.024306965213644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011452674865722656, "StateBufferConnector_ms": 0.007849931716918945, "ViewRequirementAgentConnector_ms": 0.19167590141296387}, "num_episodes": 29, "episode_return_max": -9.004718802740406, "episode_return_min": -1435.914797952983, "episode_return_mean": -730.339592914739, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.6923549343371, "num_env_steps_trained_throughput_per_sec": 305.6923549343371, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 11924.067, "restore_workers_time_ms": 0.028, "training_step_time_ms": 11923.997, "sample_time_ms": 1070.69, "learn_time_ms": 10790.344, "learn_throughput": 370.702, "synch_weights_time_ms": 62.09}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00009", "date": "2024-08-03_04-02-03", "timestamp": 1722637923, "time_this_iter_s": 13.096924304962158, "time_total_s": 262.46114563941956, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b1ad40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 262.46114563941956, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.27777777777778, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 202.83569650650026, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.7564103161295255, "policy_loss": -0.005743898059396694, "vf_loss": 3.7577641027669113, "vf_explained_var": 0.9837366892024875, "kl": 0.01467205725474137, "entropy": 1.1494304823999604, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -9.004718802740406, "episode_reward_min": -1435.914797952983, "episode_reward_mean": -725.2098424917687, "episode_len_mean": 137.43, "episode_media": {}, "episodes_timesteps_total": 13743, "policy_reward_min": {"policy_0": -1435.914797952983}, "policy_reward_max": {"policy_0": -9.004718802740406}, "policy_reward_mean": {"policy_0": -725.2098424917687}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-56.87417355129816, -707.4612617269739, -1066.6806449065637, -566.946256240626, -809.200744237473, -1224.4129877232454, -1066.3817389240314, -916.2430773946556, -1087.1205827241668, -710.3275181332202, -1030.7310051267395, -738.8069998544757, -967.0389336100782, -828.7064847029798, -1099.013982598612, -757.9413402814965, -596.6367024546178, -911.3382909024174, -544.5553787573641, -976.8653819708892, -566.5656965927603, -113.5104053105536, -807.7836381871242, -18.600455737580724, -864.2445595158365, -781.3507618739885, -450.8307685322184, -676.1074023499767, -966.3086390203614, -138.2974790145412, -906.1722271134947, -564.7831960333835, -863.1328537902409, -9.004718802740406, -186.69731613141772, -964.5650593117658, -773.3751522782048, -1011.8002145352673, -908.7379127548265, -693.4238555631913, -1435.914797952983, -620.3730920838351, -1162.9909004790366, -973.3697156788069, -767.7580138270021, -1270.0296414217505, -635.327013073016, -751.2558677511003, -902.0612672911801, -912.7411611109065, -102.77689679586537, -530.5292749875239, -783.8451633735732, -614.4836367017165, -902.7702832914783, -883.9001028162842, -1198.6279570585396, -977.9045467653706, -666.4178671810723, -1033.1503532755942, -1017.2413392320705, -1204.839445146295, -792.4074775324141, -691.2063716472599, -270.9813465517068, -719.8267697073219, -342.5203733199645, -762.6325973625154, -360.32512282256573, -149.3311555869822, -892.3884725979508, -148.36663146347198, -1056.1321182862641, -555.8936046203861, -1316.7028105431214, -836.5374390673443, -987.4971276820562, -144.89441775406422, -861.6325778355492, -117.49931740275122, -938.7248478685019, -789.1684277058229, -734.1286770173615, -691.1282817355483, -177.0293587799165, -1082.3811377920958, -678.7680274242966, -782.1941160525454, -227.3965886153079, -417.2518438849481, -989.590691552649, -264.18863925203055, -764.7379077278051, -534.0864047430349, -808.7357268850185, -681.4462717185665, -1027.6065391134948, -496.62890349921383, -560.8718581611865, -591.2601322974417], "episode_lengths": [73, 147, 150, 145, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 150, 150, 150, 150, 150, 150, 117, 62, 150, 41, 150, 150, 103, 150, 150, 92, 150, 150, 150, 48, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 107, 150, 119, 72, 150, 66, 150, 150, 150, 150, 150, 93, 150, 70, 150, 150, 150, 150, 70, 150, 150, 150, 93, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 142], "policy_policy_0_reward": [-56.87417355129816, -707.4612617269739, -1066.6806449065637, -566.946256240626, -809.200744237473, -1224.4129877232454, -1066.3817389240314, -916.2430773946556, -1087.1205827241668, -710.3275181332202, -1030.7310051267395, -738.8069998544757, -967.0389336100782, -828.7064847029798, -1099.013982598612, -757.9413402814965, -596.6367024546178, -911.3382909024174, -544.5553787573641, -976.8653819708892, -566.5656965927603, -113.5104053105536, -807.7836381871242, -18.600455737580724, -864.2445595158365, -781.3507618739885, -450.8307685322184, -676.1074023499767, -966.3086390203614, -138.2974790145412, -906.1722271134947, -564.7831960333835, -863.1328537902409, -9.004718802740406, -186.69731613141772, -964.5650593117658, -773.3751522782048, -1011.8002145352673, -908.7379127548265, -693.4238555631913, -1435.914797952983, -620.3730920838351, -1162.9909004790366, -973.3697156788069, -767.7580138270021, -1270.0296414217505, -635.327013073016, -751.2558677511003, -902.0612672911801, -912.7411611109065, -102.77689679586537, -530.5292749875239, -783.8451633735732, -614.4836367017165, -902.7702832914783, -883.9001028162842, -1198.6279570585396, -977.9045467653706, -666.4178671810723, -1033.1503532755942, -1017.2413392320705, -1204.839445146295, -792.4074775324141, -691.2063716472599, -270.9813465517068, -719.8267697073219, -342.5203733199645, -762.6325973625154, -360.32512282256573, -149.3311555869822, -892.3884725979508, -148.36663146347198, -1056.1321182862641, -555.8936046203861, -1316.7028105431214, -836.5374390673443, -987.4971276820562, -144.89441775406422, -861.6325778355492, -117.49931740275122, -938.7248478685019, -789.1684277058229, -734.1286770173615, -691.1282817355483, -177.0293587799165, -1082.3811377920958, -678.7680274242966, -782.1941160525454, -227.3965886153079, -417.2518438849481, -989.590691552649, -264.18863925203055, -764.7379077278051, -534.0864047430349, -808.7357268850185, -681.4462717185665, -1027.6065391134948, -496.62890349921383, -560.8718581611865, -591.2601322974417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539925600509625, "mean_inference_ms": 1.6778119119494355, "mean_action_processing_ms": 0.2784020599763027, "mean_env_wait_ms": 3.0232702861573966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011597394943237305, "StateBufferConnector_ms": 0.007877111434936523, "ViewRequirementAgentConnector_ms": 0.19258546829223633}, "num_episodes": 30, "episode_return_max": -9.004718802740406, "episode_return_min": -1435.914797952983, "episode_return_mean": -725.2098424917687, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.5872297326832, "num_env_steps_trained_throughput_per_sec": 306.5872297326832, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12078.599, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12078.53, "sample_time_ms": 1062.686, "learn_time_ms": 10949.669, "learn_throughput": 365.308, "synch_weights_time_ms": 65.34}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00009", "date": "2024-08-03_04-02-16", "timestamp": 1722637936, "time_this_iter_s": 13.059422969818115, "time_total_s": 275.52056860923767, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b1b010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 275.52056860923767, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 16.705263157894734, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.95835753480594, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.6942952862630287, "policy_loss": -0.010146059873416864, "vf_loss": 3.700001180917025, "vf_explained_var": 0.9751717223475377, "kl": 0.014839288327372439, "entropy": 1.1618612542127569, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -9.004718802740406, "episode_reward_min": -1435.914797952983, "episode_reward_mean": -695.036878949134, "episode_len_mean": 137.17, "episode_media": {}, "episodes_timesteps_total": 13717, "policy_reward_min": {"policy_0": -1435.914797952983}, "policy_reward_max": {"policy_0": -9.004718802740406}, "policy_reward_mean": {"policy_0": -695.036878949134}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-138.2974790145412, -906.1722271134947, -564.7831960333835, -863.1328537902409, -9.004718802740406, -186.69731613141772, -964.5650593117658, -773.3751522782048, -1011.8002145352673, -908.7379127548265, -693.4238555631913, -1435.914797952983, -620.3730920838351, -1162.9909004790366, -973.3697156788069, -767.7580138270021, -1270.0296414217505, -635.327013073016, -751.2558677511003, -902.0612672911801, -912.7411611109065, -102.77689679586537, -530.5292749875239, -783.8451633735732, -614.4836367017165, -902.7702832914783, -883.9001028162842, -1198.6279570585396, -977.9045467653706, -666.4178671810723, -1033.1503532755942, -1017.2413392320705, -1204.839445146295, -792.4074775324141, -691.2063716472599, -270.9813465517068, -719.8267697073219, -342.5203733199645, -762.6325973625154, -360.32512282256573, -149.3311555869822, -892.3884725979508, -148.36663146347198, -1056.1321182862641, -555.8936046203861, -1316.7028105431214, -836.5374390673443, -987.4971276820562, -144.89441775406422, -861.6325778355492, -117.49931740275122, -938.7248478685019, -789.1684277058229, -734.1286770173615, -691.1282817355483, -177.0293587799165, -1082.3811377920958, -678.7680274242966, -782.1941160525454, -227.3965886153079, -417.2518438849481, -989.590691552649, -264.18863925203055, -764.7379077278051, -534.0864047430349, -808.7357268850185, -681.4462717185665, -1027.6065391134948, -496.62890349921383, -560.8718581611865, -591.2601322974417, -746.2858512924345, -848.1656858208768, -68.958197712985, -176.58113782731598, -673.129012606352, -694.2288583510104, -522.5698531552536, -704.3008411135914, -329.8173295282598, -40.12626633184511, -594.1786059213441, -808.1726171243832, -1065.3146501556641, -1008.4631158361698, -1005.2033276266927, -1061.4910518449974, -755.2365047602779, -745.5920315661356, -773.4106910592566, -1025.279047024186, -841.3185553760446, -533.3679285347987, -519.9508536245568, -649.2654199996261, -502.804549847063, -868.3156469078419, -25.509262969192786, -536.5487364571601, -767.7038283035267], "episode_lengths": [92, 150, 150, 150, 48, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 107, 150, 119, 72, 150, 66, 150, 150, 150, 150, 150, 93, 150, 70, 150, 150, 150, 150, 70, 150, 150, 150, 93, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 142, 150, 150, 72, 81, 150, 150, 150, 150, 128, 57, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 47, 142, 150], "policy_policy_0_reward": [-138.2974790145412, -906.1722271134947, -564.7831960333835, -863.1328537902409, -9.004718802740406, -186.69731613141772, -964.5650593117658, -773.3751522782048, -1011.8002145352673, -908.7379127548265, -693.4238555631913, -1435.914797952983, -620.3730920838351, -1162.9909004790366, -973.3697156788069, -767.7580138270021, -1270.0296414217505, -635.327013073016, -751.2558677511003, -902.0612672911801, -912.7411611109065, -102.77689679586537, -530.5292749875239, -783.8451633735732, -614.4836367017165, -902.7702832914783, -883.9001028162842, -1198.6279570585396, -977.9045467653706, -666.4178671810723, -1033.1503532755942, -1017.2413392320705, -1204.839445146295, -792.4074775324141, -691.2063716472599, -270.9813465517068, -719.8267697073219, -342.5203733199645, -762.6325973625154, -360.32512282256573, -149.3311555869822, -892.3884725979508, -148.36663146347198, -1056.1321182862641, -555.8936046203861, -1316.7028105431214, -836.5374390673443, -987.4971276820562, -144.89441775406422, -861.6325778355492, -117.49931740275122, -938.7248478685019, -789.1684277058229, -734.1286770173615, -691.1282817355483, -177.0293587799165, -1082.3811377920958, -678.7680274242966, -782.1941160525454, -227.3965886153079, -417.2518438849481, -989.590691552649, -264.18863925203055, -764.7379077278051, -534.0864047430349, -808.7357268850185, -681.4462717185665, -1027.6065391134948, -496.62890349921383, -560.8718581611865, -591.2601322974417, -746.2858512924345, -848.1656858208768, -68.958197712985, -176.58113782731598, -673.129012606352, -694.2288583510104, -522.5698531552536, -704.3008411135914, -329.8173295282598, -40.12626633184511, -594.1786059213441, -808.1726171243832, -1065.3146501556641, -1008.4631158361698, -1005.2033276266927, -1061.4910518449974, -755.2365047602779, -745.5920315661356, -773.4106910592566, -1025.279047024186, -841.3185553760446, -533.3679285347987, -519.9508536245568, -649.2654199996261, -502.804549847063, -868.3156469078419, -25.509262969192786, -536.5487364571601, -767.7038283035267]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540352532714994, "mean_inference_ms": 1.6764661909283118, "mean_action_processing_ms": 0.27799470643593865, "mean_env_wait_ms": 3.0209808763716426, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011730432510375977, "StateBufferConnector_ms": 0.007875680923461914, "ViewRequirementAgentConnector_ms": 0.19354009628295898}, "num_episodes": 29, "episode_return_max": -9.004718802740406, "episode_return_min": -1435.914797952983, "episode_return_mean": -695.036878949134, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 478.0697821301315, "num_env_steps_trained_throughput_per_sec": 478.0697821301315, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 11844.283, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11844.215, "sample_time_ms": 1061.099, "learn_time_ms": 10718.12, "learn_throughput": 373.2, "synch_weights_time_ms": 64.167}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00009", "date": "2024-08-03_04-02-25", "timestamp": 1722637945, "time_this_iter_s": 8.380493879318237, "time_total_s": 283.9010624885559, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8b1bb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.9010624885559, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 20.766666666666666, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 207.85642463167508, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.477249259253343, "policy_loss": -0.010777976163080894, "vf_loss": 3.4829644934584696, "vf_explained_var": 0.9866958640515804, "kl": 0.01691796789139822, "entropy": 1.265046779687206, "entropy_coeff": 1e-05}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -25.509262969192786, "episode_reward_min": -1316.7028105431214, "episode_reward_mean": -650.7894577466304, "episode_len_mean": 133.45, "episode_media": {}, "episodes_timesteps_total": 13345, "policy_reward_min": {"policy_0": -1316.7028105431214}, "policy_reward_max": {"policy_0": -25.509262969192786}, "policy_reward_mean": {"policy_0": -650.7894577466304}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1204.839445146295, -792.4074775324141, -691.2063716472599, -270.9813465517068, -719.8267697073219, -342.5203733199645, -762.6325973625154, -360.32512282256573, -149.3311555869822, -892.3884725979508, -148.36663146347198, -1056.1321182862641, -555.8936046203861, -1316.7028105431214, -836.5374390673443, -987.4971276820562, -144.89441775406422, -861.6325778355492, -117.49931740275122, -938.7248478685019, -789.1684277058229, -734.1286770173615, -691.1282817355483, -177.0293587799165, -1082.3811377920958, -678.7680274242966, -782.1941160525454, -227.3965886153079, -417.2518438849481, -989.590691552649, -264.18863925203055, -764.7379077278051, -534.0864047430349, -808.7357268850185, -681.4462717185665, -1027.6065391134948, -496.62890349921383, -560.8718581611865, -591.2601322974417, -746.2858512924345, -848.1656858208768, -68.958197712985, -176.58113782731598, -673.129012606352, -694.2288583510104, -522.5698531552536, -704.3008411135914, -329.8173295282598, -40.12626633184511, -594.1786059213441, -808.1726171243832, -1065.3146501556641, -1008.4631158361698, -1005.2033276266927, -1061.4910518449974, -755.2365047602779, -745.5920315661356, -773.4106910592566, -1025.279047024186, -841.3185553760446, -533.3679285347987, -519.9508536245568, -649.2654199996261, -502.804549847063, -868.3156469078419, -25.509262969192786, -536.5487364571601, -767.7038283035267, -90.44802200990905, -919.7350377788197, -822.5311732266317, -100.66460511166282, -732.3881181980628, -33.972090136844564, -539.81380300936, -836.9280669741601, -1058.417681100623, -383.6688851183452, -1073.1855541679588, -124.0591822684371, -743.3213507313171, -488.694115211437, -775.7659941819597, -884.8134528752067, -783.444986015042, -922.420283182722, -57.20771653967067, -1313.8273866880784, -661.4610137673053, -568.2263581032774, -48.62539522535508, -1092.3766177126624, -748.7631358176945, -964.3164599999593, -769.2797526884989, -909.2187952676945, -525.0442400568612, -621.268379936693, -75.76415209559893, -1069.0649520295706], "episode_lengths": [150, 150, 150, 108, 150, 107, 150, 119, 72, 150, 66, 150, 150, 150, 150, 150, 93, 150, 70, 150, 150, 150, 150, 70, 150, 150, 150, 93, 150, 150, 150, 150, 147, 150, 150, 150, 150, 150, 142, 150, 150, 72, 81, 150, 150, 150, 150, 128, 57, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 123, 150, 150, 150, 150, 47, 142, 150, 87, 150, 150, 83, 150, 48, 129, 150, 150, 100, 150, 61, 150, 122, 150, 150, 150, 150, 49, 150, 150, 150, 48, 150, 150, 150, 150, 150, 150, 150, 81, 150], "policy_policy_0_reward": [-1204.839445146295, -792.4074775324141, -691.2063716472599, -270.9813465517068, -719.8267697073219, -342.5203733199645, -762.6325973625154, -360.32512282256573, -149.3311555869822, -892.3884725979508, -148.36663146347198, -1056.1321182862641, -555.8936046203861, -1316.7028105431214, -836.5374390673443, -987.4971276820562, -144.89441775406422, -861.6325778355492, -117.49931740275122, -938.7248478685019, -789.1684277058229, -734.1286770173615, -691.1282817355483, -177.0293587799165, -1082.3811377920958, -678.7680274242966, -782.1941160525454, -227.3965886153079, -417.2518438849481, -989.590691552649, -264.18863925203055, -764.7379077278051, -534.0864047430349, -808.7357268850185, -681.4462717185665, -1027.6065391134948, -496.62890349921383, -560.8718581611865, -591.2601322974417, -746.2858512924345, -848.1656858208768, -68.958197712985, -176.58113782731598, -673.129012606352, -694.2288583510104, -522.5698531552536, -704.3008411135914, -329.8173295282598, -40.12626633184511, -594.1786059213441, -808.1726171243832, -1065.3146501556641, -1008.4631158361698, -1005.2033276266927, -1061.4910518449974, -755.2365047602779, -745.5920315661356, -773.4106910592566, -1025.279047024186, -841.3185553760446, -533.3679285347987, -519.9508536245568, -649.2654199996261, -502.804549847063, -868.3156469078419, -25.509262969192786, -536.5487364571601, -767.7038283035267, -90.44802200990905, -919.7350377788197, -822.5311732266317, -100.66460511166282, -732.3881181980628, -33.972090136844564, -539.81380300936, -836.9280669741601, -1058.417681100623, -383.6688851183452, -1073.1855541679588, -124.0591822684371, -743.3213507313171, -488.694115211437, -775.7659941819597, -884.8134528752067, -783.444986015042, -922.420283182722, -57.20771653967067, -1313.8273866880784, -661.4610137673053, -568.2263581032774, -48.62539522535508, -1092.3766177126624, -748.7631358176945, -964.3164599999593, -769.2797526884989, -909.2187952676945, -525.0442400568612, -621.268379936693, -75.76415209559893, -1069.0649520295706]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538083427547024, "mean_inference_ms": 1.674900618608676, "mean_action_processing_ms": 0.2776407459277681, "mean_env_wait_ms": 3.0185105052638175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012118816375732422, "StateBufferConnector_ms": 0.008096933364868164, "ViewRequirementAgentConnector_ms": 0.1944122314453125}, "num_episodes": 32, "episode_return_max": -25.509262969192786, "episode_return_min": -1316.7028105431214, "episode_return_mean": -650.7894577466304, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 449.47157429618295, "num_env_steps_trained_throughput_per_sec": 449.47157429618295, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12007.767, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12007.699, "sample_time_ms": 1059.36, "learn_time_ms": 10882.576, "learn_throughput": 367.56, "synch_weights_time_ms": 64.933}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00009", "date": "2024-08-03_04-02-34", "timestamp": 1722637954, "time_this_iter_s": 8.910541772842407, "time_total_s": 292.8116042613983, "pid": 467529, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7361a8ad36d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 1e-05, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 292.8116042613983, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 19.853846153846156, "ram_util_percent": 27.699999999999996}}
