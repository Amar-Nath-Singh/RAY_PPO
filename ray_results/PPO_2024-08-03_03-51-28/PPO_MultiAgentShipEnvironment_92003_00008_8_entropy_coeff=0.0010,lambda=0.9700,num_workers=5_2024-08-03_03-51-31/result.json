{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8085911738065382, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.780377115805944, "policy_loss": -0.0013976981911885862, "vf_loss": 9.782247750957806, "vf_explained_var": 0.005216749136646589, "kl": 0.00463503035055813, "entropy": 1.3999752675493558, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -117.18488798166541, "episode_reward_min": -1245.8369164193396, "episode_reward_mean": -760.766386516517, "episode_len_mean": 137.19230769230768, "episode_media": {}, "episodes_timesteps_total": 3567, "policy_reward_min": {"policy_0": -1245.8369164193396}, "policy_reward_max": {"policy_0": -117.18488798166541}, "policy_reward_mean": {"policy_0": -760.766386516517}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-127.66683586872915, -997.3186215231708, -798.6756577134119, -1080.9559367391073, -776.7954344983781, -665.8256877386204, -1010.1008760914519, -696.8441732744452, -828.6965367071397, -889.8107950012925, -271.7798963148089, -1000.1702956861333, -932.2231671326958, -926.8632271506815, -628.4140559040087, -1029.3767694702744, -916.0532910695326, -117.18488798166541, -1245.8369164193396, -199.8581452441293, -938.5652537432142, -758.4536182778648, -599.3947751999144, -1051.9486094229997, -946.2708095516208, -344.8417757048108], "episode_lengths": [54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 63, 150, 87, 150, 150, 150, 150, 150, 91], "policy_policy_0_reward": [-127.66683586872915, -997.3186215231708, -798.6756577134119, -1080.9559367391073, -776.7954344983781, -665.8256877386204, -1010.1008760914519, -696.8441732744452, -828.6965367071397, -889.8107950012925, -271.7798963148089, -1000.1702956861333, -932.2231671326958, -926.8632271506815, -628.4140559040087, -1029.3767694702744, -916.0532910695326, -117.18488798166541, -1245.8369164193396, -199.8581452441293, -938.5652537432142, -758.4536182778648, -599.3947751999144, -1051.9486094229997, -946.2708095516208, -344.8417757048108]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2814424744282448, "mean_inference_ms": 0.8687703075755127, "mean_action_processing_ms": 0.15895835812721704, "mean_env_wait_ms": 1.5210847191539059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006285997537466196, "StateBufferConnector_ms": 0.004264941582312951, "ViewRequirementAgentConnector_ms": 0.09289338038517879}, "num_episodes": 26, "episode_return_max": -117.18488798166541, "episode_return_min": -1245.8369164193396, "episode_return_mean": -760.766386516517, "episodes_this_iter": 26}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 264.3819810769107, "num_env_steps_trained_throughput_per_sec": 264.3819810769107, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 15129.634, "restore_workers_time_ms": 0.02, "training_step_time_ms": 15129.576, "sample_time_ms": 2350.885, "learn_time_ms": 12759.642, "learn_throughput": 313.488, "synch_weights_time_ms": 18.229}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "92003_00008", "date": "2024-08-03_05-31-30", "timestamp": 1722643290, "time_this_iter_s": 15.135881185531616, "time_total_s": 15.135881185531616, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12e82d40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 15.135881185531616, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 12.431818181818182, "ram_util_percent": 19.17272727272727}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9129942822270095, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 9.710442262887955, "policy_loss": -0.009903508623635086, "vf_loss": 9.720249802867572, "vf_explained_var": 0.028615143212179343, "kl": 0.014913038529251329, "entropy": 1.3953693442046642, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -29.381281006983777, "episode_reward_min": -1245.8369164193396, "episode_reward_mean": -738.333382347466, "episode_len_mean": 138.6909090909091, "episode_media": {}, "episodes_timesteps_total": 7628, "policy_reward_min": {"policy_0": -1245.8369164193396}, "policy_reward_max": {"policy_0": -29.381281006983777}, "policy_reward_mean": {"policy_0": -738.333382347466}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-127.66683586872915, -997.3186215231708, -798.6756577134119, -1080.9559367391073, -776.7954344983781, -665.8256877386204, -1010.1008760914519, -696.8441732744452, -828.6965367071397, -889.8107950012925, -271.7798963148089, -1000.1702956861333, -932.2231671326958, -926.8632271506815, -628.4140559040087, -1029.3767694702744, -916.0532910695326, -117.18488798166541, -1245.8369164193396, -199.8581452441293, -938.5652537432142, -758.4536182778648, -599.3947751999144, -1051.9486094229997, -946.2708095516208, -344.8417757048108, -997.1579152822331, -383.31364970239594, -946.192355659967, -1114.9923368920386, -796.0026728301799, -766.1532585055622, -320.267229832415, -29.381281006983777, -727.4696751841528, -976.3081237570717, -67.75902996089046, -184.51875196807177, -738.6588266957569, -808.0097591009852, -1085.9783371374845, -848.3984935264695, -751.0505132417097, -551.7342874452722, -1095.8798945854585, -749.8199309441121, -966.4417991826645, -475.5610155444607, -697.1113220765156, -974.0997320965412, -784.7869168381908, -715.3507392210711, -528.3399095473596, -1031.1559256366222, -716.5162962785457], "episode_lengths": [54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 63, 150, 87, 150, 150, 150, 150, 150, 91, 150, 109, 150, 150, 150, 150, 119, 53, 150, 150, 71, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-127.66683586872915, -997.3186215231708, -798.6756577134119, -1080.9559367391073, -776.7954344983781, -665.8256877386204, -1010.1008760914519, -696.8441732744452, -828.6965367071397, -889.8107950012925, -271.7798963148089, -1000.1702956861333, -932.2231671326958, -926.8632271506815, -628.4140559040087, -1029.3767694702744, -916.0532910695326, -117.18488798166541, -1245.8369164193396, -199.8581452441293, -938.5652537432142, -758.4536182778648, -599.3947751999144, -1051.9486094229997, -946.2708095516208, -344.8417757048108, -997.1579152822331, -383.31364970239594, -946.192355659967, -1114.9923368920386, -796.0026728301799, -766.1532585055622, -320.267229832415, -29.381281006983777, -727.4696751841528, -976.3081237570717, -67.75902996089046, -184.51875196807177, -738.6588266957569, -808.0097591009852, -1085.9783371374845, -848.3984935264695, -751.0505132417097, -551.7342874452722, -1095.8798945854585, -749.8199309441121, -966.4417991826645, -475.5610155444607, -697.1113220765156, -974.0997320965412, -784.7869168381908, -715.3507392210711, -528.3399095473596, -1031.1559256366222, -716.5162962785457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2809688865364681, "mean_inference_ms": 0.8696479464430716, "mean_action_processing_ms": 0.15839592828325924, "mean_env_wait_ms": 1.5149613817798595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.006057999350807883, "StateBufferConnector_ms": 0.0042733279141512785, "ViewRequirementAgentConnector_ms": 0.09620839899236505}, "num_episodes": 29, "episode_return_max": -29.381281006983777, "episode_return_min": -1245.8369164193396, "episode_return_mean": -738.333382347466, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 261.2059319528463, "num_env_steps_trained_throughput_per_sec": 261.2059319528463, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 15221.618, "restore_workers_time_ms": 0.022, "training_step_time_ms": 15221.546, "sample_time_ms": 2332.921, "learn_time_ms": 12870.417, "learn_throughput": 310.79, "synch_weights_time_ms": 17.243}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "92003_00008", "date": "2024-08-03_05-31-46", "timestamp": 1722643306, "time_this_iter_s": 15.320743083953857, "time_total_s": 30.456624269485474, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12f8f760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 30.456624269485474, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 12.931818181818182, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3558111400653918, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 9.578982723752658, "policy_loss": -0.0028773117111995814, "vf_loss": 9.582154871026676, "vf_explained_var": 0.03191186326245467, "kl": 0.010877355211331029, "entropy": 1.382571113606294, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -29.381281006983777, "episode_reward_min": -1245.8369164193396, "episode_reward_mean": -722.7513690258073, "episode_len_mean": 138.33333333333334, "episode_media": {}, "episodes_timesteps_total": 11620, "policy_reward_min": {"policy_0": -1245.8369164193396}, "policy_reward_max": {"policy_0": -29.381281006983777}, "policy_reward_mean": {"policy_0": -722.7513690258073}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-127.66683586872915, -997.3186215231708, -798.6756577134119, -1080.9559367391073, -776.7954344983781, -665.8256877386204, -1010.1008760914519, -696.8441732744452, -828.6965367071397, -889.8107950012925, -271.7798963148089, -1000.1702956861333, -932.2231671326958, -926.8632271506815, -628.4140559040087, -1029.3767694702744, -916.0532910695326, -117.18488798166541, -1245.8369164193396, -199.8581452441293, -938.5652537432142, -758.4536182778648, -599.3947751999144, -1051.9486094229997, -946.2708095516208, -344.8417757048108, -997.1579152822331, -383.31364970239594, -946.192355659967, -1114.9923368920386, -796.0026728301799, -766.1532585055622, -320.267229832415, -29.381281006983777, -727.4696751841528, -976.3081237570717, -67.75902996089046, -184.51875196807177, -738.6588266957569, -808.0097591009852, -1085.9783371374845, -848.3984935264695, -751.0505132417097, -551.7342874452722, -1095.8798945854585, -749.8199309441121, -966.4417991826645, -475.5610155444607, -697.1113220765156, -974.0997320965412, -784.7869168381908, -715.3507392210711, -528.3399095473596, -1031.1559256366222, -716.5162962785457, -558.6612756693007, -1043.0156699632207, -829.3505643052746, -248.83308457499973, -731.1668621649202, -97.34729467698791, -571.276984938128, -1107.6057190961264, -407.1169374451689, -872.4565782502297, -553.2172591362981, -997.3418281320323, -930.6910891128892, -234.4431453394399, -177.10010700393744, -1212.8111479943107, -807.7866044600095, -608.6930100524431, -774.0079073217736, -649.503837911497, -738.52377078342, -819.1869187447759, -821.9537696868199, -1011.625084139271, -1014.8896033298726, -459.00240278385485, -592.1214822254278, -43.168274290356074, -1189.880755524402], "episode_lengths": [54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 63, 150, 87, 150, 150, 150, 150, 150, 91, 150, 109, 150, 150, 150, 150, 119, 53, 150, 150, 71, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 70, 150, 150, 119, 150, 150, 150, 150, 123, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150], "policy_policy_0_reward": [-127.66683586872915, -997.3186215231708, -798.6756577134119, -1080.9559367391073, -776.7954344983781, -665.8256877386204, -1010.1008760914519, -696.8441732744452, -828.6965367071397, -889.8107950012925, -271.7798963148089, -1000.1702956861333, -932.2231671326958, -926.8632271506815, -628.4140559040087, -1029.3767694702744, -916.0532910695326, -117.18488798166541, -1245.8369164193396, -199.8581452441293, -938.5652537432142, -758.4536182778648, -599.3947751999144, -1051.9486094229997, -946.2708095516208, -344.8417757048108, -997.1579152822331, -383.31364970239594, -946.192355659967, -1114.9923368920386, -796.0026728301799, -766.1532585055622, -320.267229832415, -29.381281006983777, -727.4696751841528, -976.3081237570717, -67.75902996089046, -184.51875196807177, -738.6588266957569, -808.0097591009852, -1085.9783371374845, -848.3984935264695, -751.0505132417097, -551.7342874452722, -1095.8798945854585, -749.8199309441121, -966.4417991826645, -475.5610155444607, -697.1113220765156, -974.0997320965412, -784.7869168381908, -715.3507392210711, -528.3399095473596, -1031.1559256366222, -716.5162962785457, -558.6612756693007, -1043.0156699632207, -829.3505643052746, -248.83308457499973, -731.1668621649202, -97.34729467698791, -571.276984938128, -1107.6057190961264, -407.1169374451689, -872.4565782502297, -553.2172591362981, -997.3418281320323, -930.6910891128892, -234.4431453394399, -177.10010700393744, -1212.8111479943107, -807.7866044600095, -608.6930100524431, -774.0079073217736, -649.503837911497, -738.52377078342, -819.1869187447759, -821.9537696868199, -1011.625084139271, -1014.8896033298726, -459.00240278385485, -592.1214822254278, -43.168274290356074, -1189.880755524402]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28069191868352955, "mean_inference_ms": 0.8720744911821716, "mean_action_processing_ms": 0.15842612782795612, "mean_env_wait_ms": 1.515602425819554, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0059150514148530505, "StateBufferConnector_ms": 0.004151321592785064, "ViewRequirementAgentConnector_ms": 0.09631457782927014}, "num_episodes": 29, "episode_return_max": -29.381281006983777, "episode_return_min": -1245.8369164193396, "episode_return_mean": -722.7513690258073, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.0490211039397, "num_env_steps_trained_throughput_per_sec": 256.0490211039397, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 15355.086, "restore_workers_time_ms": 0.023, "training_step_time_ms": 15355.013, "sample_time_ms": 2342.248, "learn_time_ms": 12994.846, "learn_throughput": 307.814, "synch_weights_time_ms": 16.854}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "92003_00008", "date": "2024-08-03_05-32-01", "timestamp": 1722643321, "time_this_iter_s": 15.627487182617188, "time_total_s": 46.08411145210266, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12e81f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 46.08411145210266, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 12.786363636363637, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6416567948025962, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 9.531464699904124, "policy_loss": -0.007234838151392372, "vf_loss": 9.538825861612956, "vf_explained_var": 0.0038321854546666144, "kl": 0.013391937672455853, "entropy": 1.4655422620475291, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -29.381281006983777, "episode_reward_min": -1317.365825854179, "episode_reward_mean": -731.8469195185443, "episode_len_mean": 140.31, "episode_media": {}, "episodes_timesteps_total": 14031, "policy_reward_min": {"policy_0": -1317.365825854179}, "policy_reward_max": {"policy_0": -29.381281006983777}, "policy_reward_mean": {"policy_0": -731.8469195185443}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-926.8632271506815, -628.4140559040087, -1029.3767694702744, -916.0532910695326, -117.18488798166541, -1245.8369164193396, -199.8581452441293, -938.5652537432142, -758.4536182778648, -599.3947751999144, -1051.9486094229997, -946.2708095516208, -344.8417757048108, -997.1579152822331, -383.31364970239594, -946.192355659967, -1114.9923368920386, -796.0026728301799, -766.1532585055622, -320.267229832415, -29.381281006983777, -727.4696751841528, -976.3081237570717, -67.75902996089046, -184.51875196807177, -738.6588266957569, -808.0097591009852, -1085.9783371374845, -848.3984935264695, -751.0505132417097, -551.7342874452722, -1095.8798945854585, -749.8199309441121, -966.4417991826645, -475.5610155444607, -697.1113220765156, -974.0997320965412, -784.7869168381908, -715.3507392210711, -528.3399095473596, -1031.1559256366222, -716.5162962785457, -558.6612756693007, -1043.0156699632207, -829.3505643052746, -248.83308457499973, -731.1668621649202, -97.34729467698791, -571.276984938128, -1107.6057190961264, -407.1169374451689, -872.4565782502297, -553.2172591362981, -997.3418281320323, -930.6910891128892, -234.4431453394399, -177.10010700393744, -1212.8111479943107, -807.7866044600095, -608.6930100524431, -774.0079073217736, -649.503837911497, -738.52377078342, -819.1869187447759, -821.9537696868199, -1011.625084139271, -1014.8896033298726, -459.00240278385485, -592.1214822254278, -43.168274290356074, -1189.880755524402, -700.5927646827433, -724.8398634517558, -487.4742747085271, -762.7150011511686, -1144.9676241497834, -440.31498683231524, -401.92438115293106, -837.6279340135088, -1175.1109642193405, -1152.5000555036208, -939.0341567781196, -771.3851789126084, -696.5068585629042, -913.4476793329593, -1317.365825854179, -443.02049256337045, -932.9395521722676, -965.8997848950796, -829.7134809657665, -1275.197001636898, -883.5557814752926, -934.7960552098198, -391.65592190865675, -710.2478347550805, -403.46560206024594, -530.2511556371622, -660.7000633660897, -849.9901979888605, -273.2003940349391], "episode_lengths": [150, 150, 150, 150, 63, 150, 87, 150, 150, 150, 150, 150, 91, 150, 109, 150, 150, 150, 150, 119, 53, 150, 150, 71, 109, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 70, 150, 150, 119, 150, 150, 150, 150, 123, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 96], "policy_policy_0_reward": [-926.8632271506815, -628.4140559040087, -1029.3767694702744, -916.0532910695326, -117.18488798166541, -1245.8369164193396, -199.8581452441293, -938.5652537432142, -758.4536182778648, -599.3947751999144, -1051.9486094229997, -946.2708095516208, -344.8417757048108, -997.1579152822331, -383.31364970239594, -946.192355659967, -1114.9923368920386, -796.0026728301799, -766.1532585055622, -320.267229832415, -29.381281006983777, -727.4696751841528, -976.3081237570717, -67.75902996089046, -184.51875196807177, -738.6588266957569, -808.0097591009852, -1085.9783371374845, -848.3984935264695, -751.0505132417097, -551.7342874452722, -1095.8798945854585, -749.8199309441121, -966.4417991826645, -475.5610155444607, -697.1113220765156, -974.0997320965412, -784.7869168381908, -715.3507392210711, -528.3399095473596, -1031.1559256366222, -716.5162962785457, -558.6612756693007, -1043.0156699632207, -829.3505643052746, -248.83308457499973, -731.1668621649202, -97.34729467698791, -571.276984938128, -1107.6057190961264, -407.1169374451689, -872.4565782502297, -553.2172591362981, -997.3418281320323, -930.6910891128892, -234.4431453394399, -177.10010700393744, -1212.8111479943107, -807.7866044600095, -608.6930100524431, -774.0079073217736, -649.503837911497, -738.52377078342, -819.1869187447759, -821.9537696868199, -1011.625084139271, -1014.8896033298726, -459.00240278385485, -592.1214822254278, -43.168274290356074, -1189.880755524402, -700.5927646827433, -724.8398634517558, -487.4742747085271, -762.7150011511686, -1144.9676241497834, -440.31498683231524, -401.92438115293106, -837.6279340135088, -1175.1109642193405, -1152.5000555036208, -939.0341567781196, -771.3851789126084, -696.5068585629042, -913.4476793329593, -1317.365825854179, -443.02049256337045, -932.9395521722676, -965.8997848950796, -829.7134809657665, -1275.197001636898, -883.5557814752926, -934.7960552098198, -391.65592190865675, -710.2478347550805, -403.46560206024594, -530.2511556371622, -660.7000633660897, -849.9901979888605, -273.2003940349391]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2804587190720773, "mean_inference_ms": 0.8750964014329661, "mean_action_processing_ms": 0.15875848971525586, "mean_env_wait_ms": 1.5211165236295716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005685329437255859, "StateBufferConnector_ms": 0.0041391849517822266, "ViewRequirementAgentConnector_ms": 0.0975501537322998}, "num_episodes": 29, "episode_return_max": -29.381281006983777, "episode_return_min": -1317.365825854179, "episode_return_mean": -731.8469195185443, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.0148267244768, "num_env_steps_trained_throughput_per_sec": 270.0148267244768, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 15219.819, "restore_workers_time_ms": 0.024, "training_step_time_ms": 15219.745, "sample_time_ms": 2337.89, "learn_time_ms": 12864.393, "learn_throughput": 310.936, "synch_weights_time_ms": 16.458}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "92003_00008", "date": "2024-08-03_05-32-16", "timestamp": 1722643336, "time_this_iter_s": 14.822487115859985, "time_total_s": 60.90659856796265, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12eb0c10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 60.90659856796265, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 13.109523809523811, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.8209804822380344, "cur_kl_coeff": 0.10000000000000002, "cur_lr": 0.0010000000000000005, "total_loss": 9.573398889104526, "policy_loss": -0.011574963991976498, "vf_loss": 9.58428560992082, "vf_explained_var": 0.13535611548771462, "kl": 0.02151252498824761, "entropy": 1.463028081258138, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -43.168274290356074, "episode_reward_min": -1317.365825854179, "episode_reward_mean": -757.2083530284159, "episode_len_mean": 143.01, "episode_media": {}, "episodes_timesteps_total": 14301, "policy_reward_min": {"policy_0": -1317.365825854179}, "policy_reward_max": {"policy_0": -43.168274290356074}, "policy_reward_mean": {"policy_0": -757.2083530284159}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1085.9783371374845, -848.3984935264695, -751.0505132417097, -551.7342874452722, -1095.8798945854585, -749.8199309441121, -966.4417991826645, -475.5610155444607, -697.1113220765156, -974.0997320965412, -784.7869168381908, -715.3507392210711, -528.3399095473596, -1031.1559256366222, -716.5162962785457, -558.6612756693007, -1043.0156699632207, -829.3505643052746, -248.83308457499973, -731.1668621649202, -97.34729467698791, -571.276984938128, -1107.6057190961264, -407.1169374451689, -872.4565782502297, -553.2172591362981, -997.3418281320323, -930.6910891128892, -234.4431453394399, -177.10010700393744, -1212.8111479943107, -807.7866044600095, -608.6930100524431, -774.0079073217736, -649.503837911497, -738.52377078342, -819.1869187447759, -821.9537696868199, -1011.625084139271, -1014.8896033298726, -459.00240278385485, -592.1214822254278, -43.168274290356074, -1189.880755524402, -700.5927646827433, -724.8398634517558, -487.4742747085271, -762.7150011511686, -1144.9676241497834, -440.31498683231524, -401.92438115293106, -837.6279340135088, -1175.1109642193405, -1152.5000555036208, -939.0341567781196, -771.3851789126084, -696.5068585629042, -913.4476793329593, -1317.365825854179, -443.02049256337045, -932.9395521722676, -965.8997848950796, -829.7134809657665, -1275.197001636898, -883.5557814752926, -934.7960552098198, -391.65592190865675, -710.2478347550805, -403.46560206024594, -530.2511556371622, -660.7000633660897, -849.9901979888605, -273.2003940349391, -1200.5088831332885, -462.7140518706304, -240.3113180895966, -876.0977231564518, -933.0266864100846, -1240.0202742531503, -117.22362666782139, -637.480219912015, -1004.1584560505181, -783.8830828005792, -1197.358687875104, -683.8773119982433, -986.3405243040235, -650.7514859787043, -483.0666295101757, -758.5084365650678, -821.0118667178341, -768.4900245953982, -842.4585633922574, -590.2113547916971, -82.93809058561162, -921.047870491804, -729.4987004692539, -1203.5026794654664, -1167.3692211592715, -754.1204164113219, -959.4141658505608], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 70, 150, 150, 119, 150, 150, 150, 150, 123, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 96, 150, 121, 102, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1085.9783371374845, -848.3984935264695, -751.0505132417097, -551.7342874452722, -1095.8798945854585, -749.8199309441121, -966.4417991826645, -475.5610155444607, -697.1113220765156, -974.0997320965412, -784.7869168381908, -715.3507392210711, -528.3399095473596, -1031.1559256366222, -716.5162962785457, -558.6612756693007, -1043.0156699632207, -829.3505643052746, -248.83308457499973, -731.1668621649202, -97.34729467698791, -571.276984938128, -1107.6057190961264, -407.1169374451689, -872.4565782502297, -553.2172591362981, -997.3418281320323, -930.6910891128892, -234.4431453394399, -177.10010700393744, -1212.8111479943107, -807.7866044600095, -608.6930100524431, -774.0079073217736, -649.503837911497, -738.52377078342, -819.1869187447759, -821.9537696868199, -1011.625084139271, -1014.8896033298726, -459.00240278385485, -592.1214822254278, -43.168274290356074, -1189.880755524402, -700.5927646827433, -724.8398634517558, -487.4742747085271, -762.7150011511686, -1144.9676241497834, -440.31498683231524, -401.92438115293106, -837.6279340135088, -1175.1109642193405, -1152.5000555036208, -939.0341567781196, -771.3851789126084, -696.5068585629042, -913.4476793329593, -1317.365825854179, -443.02049256337045, -932.9395521722676, -965.8997848950796, -829.7134809657665, -1275.197001636898, -883.5557814752926, -934.7960552098198, -391.65592190865675, -710.2478347550805, -403.46560206024594, -530.2511556371622, -660.7000633660897, -849.9901979888605, -273.2003940349391, -1200.5088831332885, -462.7140518706304, -240.3113180895966, -876.0977231564518, -933.0266864100846, -1240.0202742531503, -117.22362666782139, -637.480219912015, -1004.1584560505181, -783.8830828005792, -1197.358687875104, -683.8773119982433, -986.3405243040235, -650.7514859787043, -483.0666295101757, -758.5084365650678, -821.0118667178341, -768.4900245953982, -842.4585633922574, -590.2113547916971, -82.93809058561162, -921.047870491804, -729.4987004692539, -1203.5026794654664, -1167.3692211592715, -754.1204164113219, -959.4141658505608]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.28001059488620045, "mean_inference_ms": 0.8778341017149728, "mean_action_processing_ms": 0.15876786602975912, "mean_env_wait_ms": 1.5221024096676496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005315303802490234, "StateBufferConnector_ms": 0.004006147384643555, "ViewRequirementAgentConnector_ms": 0.09730815887451172}, "num_episodes": 27, "episode_return_max": -43.168274290356074, "episode_return_min": -1317.365825854179, "episode_return_mean": -757.2083530284159, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 270.15059240346056, "num_env_steps_trained_throughput_per_sec": 270.15059240346056, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 15137.17, "restore_workers_time_ms": 0.024, "training_step_time_ms": 15137.095, "sample_time_ms": 2348.527, "learn_time_ms": 12771.21, "learn_throughput": 313.204, "synch_weights_time_ms": 16.379}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "92003_00008", "date": "2024-08-03_05-32-31", "timestamp": 1722643351, "time_this_iter_s": 14.813396215438843, "time_total_s": 75.71999478340149, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12e83c70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 75.71999478340149, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 12.861904761904762, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5764224623640377, "cur_kl_coeff": 0.14999999999999997, "cur_lr": 0.0010000000000000005, "total_loss": 9.210718707243602, "policy_loss": -0.017288309983268847, "vf_loss": 9.226295919219654, "vf_explained_var": 0.14161996953189374, "kl": 0.02110437431753478, "entropy": 1.454580240448316, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -43.168274290356074, "episode_reward_min": -1359.9047782127989, "episode_reward_mean": -769.7798623725689, "episode_len_mean": 142.49, "episode_media": {}, "episodes_timesteps_total": 14249, "policy_reward_min": {"policy_0": -1359.9047782127989}, "policy_reward_max": {"policy_0": -43.168274290356074}, "policy_reward_mean": {"policy_0": -769.7798623725689}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-234.4431453394399, -177.10010700393744, -1212.8111479943107, -807.7866044600095, -608.6930100524431, -774.0079073217736, -649.503837911497, -738.52377078342, -819.1869187447759, -821.9537696868199, -1011.625084139271, -1014.8896033298726, -459.00240278385485, -592.1214822254278, -43.168274290356074, -1189.880755524402, -700.5927646827433, -724.8398634517558, -487.4742747085271, -762.7150011511686, -1144.9676241497834, -440.31498683231524, -401.92438115293106, -837.6279340135088, -1175.1109642193405, -1152.5000555036208, -939.0341567781196, -771.3851789126084, -696.5068585629042, -913.4476793329593, -1317.365825854179, -443.02049256337045, -932.9395521722676, -965.8997848950796, -829.7134809657665, -1275.197001636898, -883.5557814752926, -934.7960552098198, -391.65592190865675, -710.2478347550805, -403.46560206024594, -530.2511556371622, -660.7000633660897, -849.9901979888605, -273.2003940349391, -1200.5088831332885, -462.7140518706304, -240.3113180895966, -876.0977231564518, -933.0266864100846, -1240.0202742531503, -117.22362666782139, -637.480219912015, -1004.1584560505181, -783.8830828005792, -1197.358687875104, -683.8773119982433, -986.3405243040235, -650.7514859787043, -483.0666295101757, -758.5084365650678, -821.0118667178341, -768.4900245953982, -842.4585633922574, -590.2113547916971, -82.93809058561162, -921.047870491804, -729.4987004692539, -1203.5026794654664, -1167.3692211592715, -754.1204164113219, -959.4141658505608, -1237.7232227615016, -700.900735356009, -570.297314956089, -511.16784032611577, -532.5919124518483, -1140.0973707782919, -445.3633031251653, -941.444303255895, -1209.307666848872, -713.6682545784566, -366.38768956519453, -1126.747535418291, -167.3326256961747, -612.37255364109, -1122.7129862243412, -689.592170452214, -900.6428528737717, -840.743908565113, -937.6481903614616, -1213.547732920507, -571.7982627893626, -1199.7687204581168, -1359.9047782127989, -563.9772270111031, -54.275292221255626, -679.7889001444092, -689.7009667578958, -1077.9528774320063], "episode_lengths": [123, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 96, 150, 121, 102, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150], "policy_policy_0_reward": [-234.4431453394399, -177.10010700393744, -1212.8111479943107, -807.7866044600095, -608.6930100524431, -774.0079073217736, -649.503837911497, -738.52377078342, -819.1869187447759, -821.9537696868199, -1011.625084139271, -1014.8896033298726, -459.00240278385485, -592.1214822254278, -43.168274290356074, -1189.880755524402, -700.5927646827433, -724.8398634517558, -487.4742747085271, -762.7150011511686, -1144.9676241497834, -440.31498683231524, -401.92438115293106, -837.6279340135088, -1175.1109642193405, -1152.5000555036208, -939.0341567781196, -771.3851789126084, -696.5068585629042, -913.4476793329593, -1317.365825854179, -443.02049256337045, -932.9395521722676, -965.8997848950796, -829.7134809657665, -1275.197001636898, -883.5557814752926, -934.7960552098198, -391.65592190865675, -710.2478347550805, -403.46560206024594, -530.2511556371622, -660.7000633660897, -849.9901979888605, -273.2003940349391, -1200.5088831332885, -462.7140518706304, -240.3113180895966, -876.0977231564518, -933.0266864100846, -1240.0202742531503, -117.22362666782139, -637.480219912015, -1004.1584560505181, -783.8830828005792, -1197.358687875104, -683.8773119982433, -986.3405243040235, -650.7514859787043, -483.0666295101757, -758.5084365650678, -821.0118667178341, -768.4900245953982, -842.4585633922574, -590.2113547916971, -82.93809058561162, -921.047870491804, -729.4987004692539, -1203.5026794654664, -1167.3692211592715, -754.1204164113219, -959.4141658505608, -1237.7232227615016, -700.900735356009, -570.297314956089, -511.16784032611577, -532.5919124518483, -1140.0973707782919, -445.3633031251653, -941.444303255895, -1209.307666848872, -713.6682545784566, -366.38768956519453, -1126.747535418291, -167.3326256961747, -612.37255364109, -1122.7129862243412, -689.592170452214, -900.6428528737717, -840.743908565113, -937.6481903614616, -1213.547732920507, -571.7982627893626, -1199.7687204581168, -1359.9047782127989, -563.9772270111031, -54.275292221255626, -679.7889001444092, -689.7009667578958, -1077.9528774320063]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2798241554531274, "mean_inference_ms": 0.8784291973384292, "mean_action_processing_ms": 0.15853712284446633, "mean_env_wait_ms": 1.5233512905040145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0051326751708984375, "StateBufferConnector_ms": 0.0039691925048828125, "ViewRequirementAgentConnector_ms": 0.09767651557922363}, "num_episodes": 28, "episode_return_max": -43.168274290356074, "episode_return_min": -1359.9047782127989, "episode_return_mean": -769.7798623725689, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 267.8016060195701, "num_env_steps_trained_throughput_per_sec": 267.8016060195701, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 15103.716, "restore_workers_time_ms": 0.025, "training_step_time_ms": 15103.64, "sample_time_ms": 2341.139, "learn_time_ms": 12744.71, "learn_throughput": 313.856, "synch_weights_time_ms": 16.828}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "92003_00008", "date": "2024-08-03_05-32-46", "timestamp": 1722643366, "time_this_iter_s": 14.945488214492798, "time_total_s": 90.66548299789429, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12eb1f30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 90.66548299789429, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 12.768181818181818, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.442095440315703, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 9.052669629951318, "policy_loss": -0.01255141243163962, "vf_loss": 9.063247911135356, "vf_explained_var": 0.3268847135206064, "kl": 0.015521924192580635, "entropy": 1.5192937947809697, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -54.275292221255626, "episode_reward_min": -1359.9047782127989, "episode_reward_mean": -758.8260820468914, "episode_len_mean": 140.58, "episode_media": {}, "episodes_timesteps_total": 14058, "policy_reward_min": {"policy_0": -1359.9047782127989}, "policy_reward_max": {"policy_0": -54.275292221255626}, "policy_reward_mean": {"policy_0": -758.8260820468914}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-696.5068585629042, -913.4476793329593, -1317.365825854179, -443.02049256337045, -932.9395521722676, -965.8997848950796, -829.7134809657665, -1275.197001636898, -883.5557814752926, -934.7960552098198, -391.65592190865675, -710.2478347550805, -403.46560206024594, -530.2511556371622, -660.7000633660897, -849.9901979888605, -273.2003940349391, -1200.5088831332885, -462.7140518706304, -240.3113180895966, -876.0977231564518, -933.0266864100846, -1240.0202742531503, -117.22362666782139, -637.480219912015, -1004.1584560505181, -783.8830828005792, -1197.358687875104, -683.8773119982433, -986.3405243040235, -650.7514859787043, -483.0666295101757, -758.5084365650678, -821.0118667178341, -768.4900245953982, -842.4585633922574, -590.2113547916971, -82.93809058561162, -921.047870491804, -729.4987004692539, -1203.5026794654664, -1167.3692211592715, -754.1204164113219, -959.4141658505608, -1237.7232227615016, -700.900735356009, -570.297314956089, -511.16784032611577, -532.5919124518483, -1140.0973707782919, -445.3633031251653, -941.444303255895, -1209.307666848872, -713.6682545784566, -366.38768956519453, -1126.747535418291, -167.3326256961747, -612.37255364109, -1122.7129862243412, -689.592170452214, -900.6428528737717, -840.743908565113, -937.6481903614616, -1213.547732920507, -571.7982627893626, -1199.7687204581168, -1359.9047782127989, -563.9772270111031, -54.275292221255626, -679.7889001444092, -689.7009667578958, -1077.9528774320063, -413.5002773633863, -974.74410649414, -408.379481915799, -1097.525268890807, -279.29787187347796, -108.56178923370797, -566.332729148191, -699.5771770819878, -814.8339387337736, -1100.1848448083724, -959.3202510461118, -103.51636630717792, -916.7301402727942, -750.7628395141485, -523.9358224249144, -423.44414811297423, -454.07803440206305, -806.0336659909054, -173.34904111987763, -1181.6822404959478, -719.2047701777697, -811.7116764431877, -195.6933365061774, -1189.638490709977, -1029.4041169625295, -1212.807015457557, -817.2629439232621, -866.2945891692846], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 96, 150, 121, 102, 150, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 114, 150, 81, 86, 150, 150, 150, 150, 150, 73, 150, 150, 150, 109, 150, 150, 98, 150, 150, 150, 73, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-696.5068585629042, -913.4476793329593, -1317.365825854179, -443.02049256337045, -932.9395521722676, -965.8997848950796, -829.7134809657665, -1275.197001636898, -883.5557814752926, -934.7960552098198, -391.65592190865675, -710.2478347550805, -403.46560206024594, -530.2511556371622, -660.7000633660897, -849.9901979888605, -273.2003940349391, -1200.5088831332885, -462.7140518706304, -240.3113180895966, -876.0977231564518, -933.0266864100846, -1240.0202742531503, -117.22362666782139, -637.480219912015, -1004.1584560505181, -783.8830828005792, -1197.358687875104, -683.8773119982433, -986.3405243040235, -650.7514859787043, -483.0666295101757, -758.5084365650678, -821.0118667178341, -768.4900245953982, -842.4585633922574, -590.2113547916971, -82.93809058561162, -921.047870491804, -729.4987004692539, -1203.5026794654664, -1167.3692211592715, -754.1204164113219, -959.4141658505608, -1237.7232227615016, -700.900735356009, -570.297314956089, -511.16784032611577, -532.5919124518483, -1140.0973707782919, -445.3633031251653, -941.444303255895, -1209.307666848872, -713.6682545784566, -366.38768956519453, -1126.747535418291, -167.3326256961747, -612.37255364109, -1122.7129862243412, -689.592170452214, -900.6428528737717, -840.743908565113, -937.6481903614616, -1213.547732920507, -571.7982627893626, -1199.7687204581168, -1359.9047782127989, -563.9772270111031, -54.275292221255626, -679.7889001444092, -689.7009667578958, -1077.9528774320063, -413.5002773633863, -974.74410649414, -408.379481915799, -1097.525268890807, -279.29787187347796, -108.56178923370797, -566.332729148191, -699.5771770819878, -814.8339387337736, -1100.1848448083724, -959.3202510461118, -103.51636630717792, -916.7301402727942, -750.7628395141485, -523.9358224249144, -423.44414811297423, -454.07803440206305, -806.0336659909054, -173.34904111987763, -1181.6822404959478, -719.2047701777697, -811.7116764431877, -195.6933365061774, -1189.638490709977, -1029.4041169625295, -1212.807015457557, -817.2629439232621, -866.2945891692846]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.279536386013799, "mean_inference_ms": 0.8805502898641078, "mean_action_processing_ms": 0.1583880833816114, "mean_env_wait_ms": 1.524789446398477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004864931106567383, "StateBufferConnector_ms": 0.003927946090698242, "ViewRequirementAgentConnector_ms": 0.09761571884155273}, "num_episodes": 28, "episode_return_max": -54.275292221255626, "episode_return_min": -1359.9047782127989, "episode_return_mean": -758.8260820468914, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.7654127179232, "num_env_steps_trained_throughput_per_sec": 272.7654127179232, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 15040.989, "restore_workers_time_ms": 0.025, "training_step_time_ms": 15040.914, "sample_time_ms": 2362.184, "learn_time_ms": 12661.156, "learn_throughput": 315.927, "synch_weights_time_ms": 16.632}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "92003_00008", "date": "2024-08-03_05-33-01", "timestamp": 1722643381, "time_this_iter_s": 14.672658920288086, "time_total_s": 105.33814191818237, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12e81fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 105.33814191818237, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 13.12, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.503722370415925, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 7.912353503207366, "policy_loss": -0.0143357928522164, "vf_loss": 7.924793821573258, "vf_explained_var": 0.3058465007071694, "kl": 0.015063744956963394, "entropy": 1.493888436506192, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -54.275292221255626, "episode_reward_min": -1359.9047782127989, "episode_reward_mean": -756.1006132294003, "episode_len_mean": 142.54, "episode_media": {}, "episodes_timesteps_total": 14254, "policy_reward_min": {"policy_0": -1359.9047782127989}, "policy_reward_max": {"policy_0": -54.275292221255626}, "policy_reward_mean": {"policy_0": -756.1006132294003}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-986.3405243040235, -650.7514859787043, -483.0666295101757, -758.5084365650678, -821.0118667178341, -768.4900245953982, -842.4585633922574, -590.2113547916971, -82.93809058561162, -921.047870491804, -729.4987004692539, -1203.5026794654664, -1167.3692211592715, -754.1204164113219, -959.4141658505608, -1237.7232227615016, -700.900735356009, -570.297314956089, -511.16784032611577, -532.5919124518483, -1140.0973707782919, -445.3633031251653, -941.444303255895, -1209.307666848872, -713.6682545784566, -366.38768956519453, -1126.747535418291, -167.3326256961747, -612.37255364109, -1122.7129862243412, -689.592170452214, -900.6428528737717, -840.743908565113, -937.6481903614616, -1213.547732920507, -571.7982627893626, -1199.7687204581168, -1359.9047782127989, -563.9772270111031, -54.275292221255626, -679.7889001444092, -689.7009667578958, -1077.9528774320063, -413.5002773633863, -974.74410649414, -408.379481915799, -1097.525268890807, -279.29787187347796, -108.56178923370797, -566.332729148191, -699.5771770819878, -814.8339387337736, -1100.1848448083724, -959.3202510461118, -103.51636630717792, -916.7301402727942, -750.7628395141485, -523.9358224249144, -423.44414811297423, -454.07803440206305, -806.0336659909054, -173.34904111987763, -1181.6822404959478, -719.2047701777697, -811.7116764431877, -195.6933365061774, -1189.638490709977, -1029.4041169625295, -1212.807015457557, -817.2629439232621, -866.2945891692846, -856.528160109019, -710.4241410596643, -1179.0105884640118, -769.663055725256, -570.5261562190744, -1338.894051810088, -645.6412657326455, -357.67051152099805, -1296.818559820516, -308.8209240926016, -1112.0832059356103, -1124.7249186027886, -604.0605199370856, -529.4968358386692, -314.1977788075344, -531.245663028511, -956.195277499688, -1298.5330955054098, -298.2341944982017, -576.37873084697, -998.8777271985716, -656.0144786502477, -786.7951417419723, -970.8723928490218, -558.6918030242473, -490.38809397645116, -698.7567749557057, -657.8920752275076, -918.6310002098821], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 114, 150, 81, 86, 150, 150, 150, 150, 150, 73, 150, 150, 150, 109, 150, 150, 98, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150], "policy_policy_0_reward": [-986.3405243040235, -650.7514859787043, -483.0666295101757, -758.5084365650678, -821.0118667178341, -768.4900245953982, -842.4585633922574, -590.2113547916971, -82.93809058561162, -921.047870491804, -729.4987004692539, -1203.5026794654664, -1167.3692211592715, -754.1204164113219, -959.4141658505608, -1237.7232227615016, -700.900735356009, -570.297314956089, -511.16784032611577, -532.5919124518483, -1140.0973707782919, -445.3633031251653, -941.444303255895, -1209.307666848872, -713.6682545784566, -366.38768956519453, -1126.747535418291, -167.3326256961747, -612.37255364109, -1122.7129862243412, -689.592170452214, -900.6428528737717, -840.743908565113, -937.6481903614616, -1213.547732920507, -571.7982627893626, -1199.7687204581168, -1359.9047782127989, -563.9772270111031, -54.275292221255626, -679.7889001444092, -689.7009667578958, -1077.9528774320063, -413.5002773633863, -974.74410649414, -408.379481915799, -1097.525268890807, -279.29787187347796, -108.56178923370797, -566.332729148191, -699.5771770819878, -814.8339387337736, -1100.1848448083724, -959.3202510461118, -103.51636630717792, -916.7301402727942, -750.7628395141485, -523.9358224249144, -423.44414811297423, -454.07803440206305, -806.0336659909054, -173.34904111987763, -1181.6822404959478, -719.2047701777697, -811.7116764431877, -195.6933365061774, -1189.638490709977, -1029.4041169625295, -1212.807015457557, -817.2629439232621, -866.2945891692846, -856.528160109019, -710.4241410596643, -1179.0105884640118, -769.663055725256, -570.5261562190744, -1338.894051810088, -645.6412657326455, -357.67051152099805, -1296.818559820516, -308.8209240926016, -1112.0832059356103, -1124.7249186027886, -604.0605199370856, -529.4968358386692, -314.1977788075344, -531.245663028511, -956.195277499688, -1298.5330955054098, -298.2341944982017, -576.37873084697, -998.8777271985716, -656.0144786502477, -786.7951417419723, -970.8723928490218, -558.6918030242473, -490.38809397645116, -698.7567749557057, -657.8920752275076, -918.6310002098821]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2792966425657576, "mean_inference_ms": 0.8890095381046931, "mean_action_processing_ms": 0.15828823185255414, "mean_env_wait_ms": 1.5266212096922347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004800319671630859, "StateBufferConnector_ms": 0.003932476043701172, "ViewRequirementAgentConnector_ms": 0.0978400707244873}, "num_episodes": 29, "episode_return_max": -54.275292221255626, "episode_return_min": -1359.9047782127989, "episode_return_mean": -756.1006132294003, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.8771477975824, "num_env_steps_trained_throughput_per_sec": 265.8771477975824, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 15041.435, "restore_workers_time_ms": 0.025, "training_step_time_ms": 15041.36, "sample_time_ms": 2386.846, "learn_time_ms": 12637.076, "learn_throughput": 316.529, "synch_weights_time_ms": 16.512}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "92003_00008", "date": "2024-08-03_05-33-16", "timestamp": 1722643396, "time_this_iter_s": 15.05255675315857, "time_total_s": 120.39069867134094, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12eb2290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 120.39069867134094, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 13.27272727272727, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 24.95187881886959, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 7.6509494925538695, "policy_loss": -0.014438739466034653, "vf_loss": 7.662590371568998, "vf_explained_var": 0.5201365641007821, "kl": 0.019055492208281066, "entropy": 1.4896206894268593, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -54.275292221255626, "episode_reward_min": -1359.9047782127989, "episode_reward_mean": -745.2815767571708, "episode_len_mean": 141.53, "episode_media": {}, "episodes_timesteps_total": 14153, "policy_reward_min": {"policy_0": -1359.9047782127989}, "policy_reward_max": {"policy_0": -54.275292221255626}, "policy_reward_mean": {"policy_0": -745.2815767571708}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.3326256961747, -612.37255364109, -1122.7129862243412, -689.592170452214, -900.6428528737717, -840.743908565113, -937.6481903614616, -1213.547732920507, -571.7982627893626, -1199.7687204581168, -1359.9047782127989, -563.9772270111031, -54.275292221255626, -679.7889001444092, -689.7009667578958, -1077.9528774320063, -413.5002773633863, -974.74410649414, -408.379481915799, -1097.525268890807, -279.29787187347796, -108.56178923370797, -566.332729148191, -699.5771770819878, -814.8339387337736, -1100.1848448083724, -959.3202510461118, -103.51636630717792, -916.7301402727942, -750.7628395141485, -523.9358224249144, -423.44414811297423, -454.07803440206305, -806.0336659909054, -173.34904111987763, -1181.6822404959478, -719.2047701777697, -811.7116764431877, -195.6933365061774, -1189.638490709977, -1029.4041169625295, -1212.807015457557, -817.2629439232621, -866.2945891692846, -856.528160109019, -710.4241410596643, -1179.0105884640118, -769.663055725256, -570.5261562190744, -1338.894051810088, -645.6412657326455, -357.67051152099805, -1296.818559820516, -308.8209240926016, -1112.0832059356103, -1124.7249186027886, -604.0605199370856, -529.4968358386692, -314.1977788075344, -531.245663028511, -956.195277499688, -1298.5330955054098, -298.2341944982017, -576.37873084697, -998.8777271985716, -656.0144786502477, -786.7951417419723, -970.8723928490218, -558.6918030242473, -490.38809397645116, -698.7567749557057, -657.8920752275076, -918.6310002098821, -360.88250095723595, -1118.7200440333118, -692.6559799728759, -937.0930866487395, -980.6291089402649, -1030.2296878453767, -819.2833967971419, -1082.0214031601768, -660.1538414236821, -940.7511347073823, -309.2549978846495, -912.2836498932998, -1127.302197194355, -359.64601277201996, -166.37903954559417, -685.4444964206948, -474.42616981503016, -507.6188134513553, -853.284380059178, -343.2602635142387, -579.2568210882991, -936.3833423468639, -716.4184805927825, -606.8417972899366, -1354.7050448527382, -793.956713465084, -783.6411278149085], "episode_lengths": [92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 114, 150, 81, 86, 150, 150, 150, 150, 150, 73, 150, 150, 150, 109, 150, 150, 98, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 144, 89, 150, 110, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-167.3326256961747, -612.37255364109, -1122.7129862243412, -689.592170452214, -900.6428528737717, -840.743908565113, -937.6481903614616, -1213.547732920507, -571.7982627893626, -1199.7687204581168, -1359.9047782127989, -563.9772270111031, -54.275292221255626, -679.7889001444092, -689.7009667578958, -1077.9528774320063, -413.5002773633863, -974.74410649414, -408.379481915799, -1097.525268890807, -279.29787187347796, -108.56178923370797, -566.332729148191, -699.5771770819878, -814.8339387337736, -1100.1848448083724, -959.3202510461118, -103.51636630717792, -916.7301402727942, -750.7628395141485, -523.9358224249144, -423.44414811297423, -454.07803440206305, -806.0336659909054, -173.34904111987763, -1181.6822404959478, -719.2047701777697, -811.7116764431877, -195.6933365061774, -1189.638490709977, -1029.4041169625295, -1212.807015457557, -817.2629439232621, -866.2945891692846, -856.528160109019, -710.4241410596643, -1179.0105884640118, -769.663055725256, -570.5261562190744, -1338.894051810088, -645.6412657326455, -357.67051152099805, -1296.818559820516, -308.8209240926016, -1112.0832059356103, -1124.7249186027886, -604.0605199370856, -529.4968358386692, -314.1977788075344, -531.245663028511, -956.195277499688, -1298.5330955054098, -298.2341944982017, -576.37873084697, -998.8777271985716, -656.0144786502477, -786.7951417419723, -970.8723928490218, -558.6918030242473, -490.38809397645116, -698.7567749557057, -657.8920752275076, -918.6310002098821, -360.88250095723595, -1118.7200440333118, -692.6559799728759, -937.0930866487395, -980.6291089402649, -1030.2296878453767, -819.2833967971419, -1082.0214031601768, -660.1538414236821, -940.7511347073823, -309.2549978846495, -912.2836498932998, -1127.302197194355, -359.64601277201996, -166.37903954559417, -685.4444964206948, -474.42616981503016, -507.6188134513553, -853.284380059178, -343.2602635142387, -579.2568210882991, -936.3833423468639, -716.4184805927825, -606.8417972899366, -1354.7050448527382, -793.956713465084, -783.6411278149085]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27913911934416225, "mean_inference_ms": 0.8968140992977607, "mean_action_processing_ms": 0.15821070200884177, "mean_env_wait_ms": 1.5298801310259114, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0047931671142578125, "StateBufferConnector_ms": 0.0039174556732177734, "ViewRequirementAgentConnector_ms": 0.09689164161682129}, "num_episodes": 27, "episode_return_max": -54.275292221255626, "episode_return_min": -1359.9047782127989, "episode_return_mean": -745.2815767571708, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.90756544861983, "num_env_steps_trained_throughput_per_sec": 311.90756544861983, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 14795.09, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14795.015, "sample_time_ms": 2387.775, "learn_time_ms": 12390.401, "learn_throughput": 322.831, "synch_weights_time_ms": 15.939}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "92003_00008", "date": "2024-08-03_05-33-29", "timestamp": 1722643409, "time_this_iter_s": 12.830241680145264, "time_total_s": 133.2209403514862, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12e82b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 133.2209403514862, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 13.433333333333332, "ram_util_percent": 19.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.73724103073279, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 7.428231952587764, "policy_loss": -0.012682759906359328, "vf_loss": 7.4384037534395855, "vf_explained_var": 0.5894354670618971, "kl": 0.018441210421739622, "entropy": 1.6383166003972292, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -103.51636630717792, "episode_reward_min": -1375.8679180769136, "episode_reward_mean": -763.738173626531, "episode_len_mean": 144.09, "episode_media": {}, "episodes_timesteps_total": 14409, "policy_reward_min": {"policy_0": -1375.8679180769136}, "policy_reward_max": {"policy_0": -103.51636630717792}, "policy_reward_mean": {"policy_0": -763.738173626531}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-103.51636630717792, -916.7301402727942, -750.7628395141485, -523.9358224249144, -423.44414811297423, -454.07803440206305, -806.0336659909054, -173.34904111987763, -1181.6822404959478, -719.2047701777697, -811.7116764431877, -195.6933365061774, -1189.638490709977, -1029.4041169625295, -1212.807015457557, -817.2629439232621, -866.2945891692846, -856.528160109019, -710.4241410596643, -1179.0105884640118, -769.663055725256, -570.5261562190744, -1338.894051810088, -645.6412657326455, -357.67051152099805, -1296.818559820516, -308.8209240926016, -1112.0832059356103, -1124.7249186027886, -604.0605199370856, -529.4968358386692, -314.1977788075344, -531.245663028511, -956.195277499688, -1298.5330955054098, -298.2341944982017, -576.37873084697, -998.8777271985716, -656.0144786502477, -786.7951417419723, -970.8723928490218, -558.6918030242473, -490.38809397645116, -698.7567749557057, -657.8920752275076, -918.6310002098821, -360.88250095723595, -1118.7200440333118, -692.6559799728759, -937.0930866487395, -980.6291089402649, -1030.2296878453767, -819.2833967971419, -1082.0214031601768, -660.1538414236821, -940.7511347073823, -309.2549978846495, -912.2836498932998, -1127.302197194355, -359.64601277201996, -166.37903954559417, -685.4444964206948, -474.42616981503016, -507.6188134513553, -853.284380059178, -343.2602635142387, -579.2568210882991, -936.3833423468639, -716.4184805927825, -606.8417972899366, -1354.7050448527382, -793.956713465084, -783.6411278149085, -718.1118776977821, -907.5331374781786, -828.3113036260721, -1156.231398052732, -390.82939750759067, -863.370738573918, -712.0899737115074, -329.35785188345596, -235.23420734544482, -1375.8679180769136, -695.8272906016331, -532.7234835801605, -918.1289710525552, -955.9444343684096, -863.3646043235926, -767.8154361542126, -701.005387637698, -1121.9843749674953, -407.1600833338874, -961.3661361048414, -691.2134976116822, -957.700611963095, -1351.0298709775188, -880.1998350345897, -1093.6086292796535, -1116.9151496127433, -416.7518687300014], "episode_lengths": [73, 150, 150, 150, 109, 150, 150, 98, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 144, 89, 150, 110, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-103.51636630717792, -916.7301402727942, -750.7628395141485, -523.9358224249144, -423.44414811297423, -454.07803440206305, -806.0336659909054, -173.34904111987763, -1181.6822404959478, -719.2047701777697, -811.7116764431877, -195.6933365061774, -1189.638490709977, -1029.4041169625295, -1212.807015457557, -817.2629439232621, -866.2945891692846, -856.528160109019, -710.4241410596643, -1179.0105884640118, -769.663055725256, -570.5261562190744, -1338.894051810088, -645.6412657326455, -357.67051152099805, -1296.818559820516, -308.8209240926016, -1112.0832059356103, -1124.7249186027886, -604.0605199370856, -529.4968358386692, -314.1977788075344, -531.245663028511, -956.195277499688, -1298.5330955054098, -298.2341944982017, -576.37873084697, -998.8777271985716, -656.0144786502477, -786.7951417419723, -970.8723928490218, -558.6918030242473, -490.38809397645116, -698.7567749557057, -657.8920752275076, -918.6310002098821, -360.88250095723595, -1118.7200440333118, -692.6559799728759, -937.0930866487395, -980.6291089402649, -1030.2296878453767, -819.2833967971419, -1082.0214031601768, -660.1538414236821, -940.7511347073823, -309.2549978846495, -912.2836498932998, -1127.302197194355, -359.64601277201996, -166.37903954559417, -685.4444964206948, -474.42616981503016, -507.6188134513553, -853.284380059178, -343.2602635142387, -579.2568210882991, -936.3833423468639, -716.4184805927825, -606.8417972899366, -1354.7050448527382, -793.956713465084, -783.6411278149085, -718.1118776977821, -907.5331374781786, -828.3113036260721, -1156.231398052732, -390.82939750759067, -863.370738573918, -712.0899737115074, -329.35785188345596, -235.23420734544482, -1375.8679180769136, -695.8272906016331, -532.7234835801605, -918.1289710525552, -955.9444343684096, -863.3646043235926, -767.8154361542126, -701.005387637698, -1121.9843749674953, -407.1600833338874, -961.3661361048414, -691.2134976116822, -957.700611963095, -1351.0298709775188, -880.1998350345897, -1093.6086292796535, -1116.9151496127433, -416.7518687300014]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27921151881068607, "mean_inference_ms": 0.9021727147129601, "mean_action_processing_ms": 0.15821177491809021, "mean_env_wait_ms": 1.5353515833443532, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005004405975341797, "StateBufferConnector_ms": 0.004036664962768555, "ViewRequirementAgentConnector_ms": 0.09900069236755371}, "num_episodes": 27, "episode_return_max": -103.51636630717792, "episode_return_min": -1375.8679180769136, "episode_return_mean": -763.738173626531, "episodes_this_iter": 27}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 256.9012948534438, "num_env_steps_trained_throughput_per_sec": 256.9012948534438, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 14872.6, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14872.528, "sample_time_ms": 2387.839, "learn_time_ms": 12468.044, "learn_throughput": 320.82, "synch_weights_time_ms": 15.763}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "92003_00008", "date": "2024-08-03_05-33-44", "timestamp": 1722643424, "time_this_iter_s": 15.575754404067993, "time_total_s": 148.7966947555542, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12eb2680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 148.7966947555542, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 13.027272727272726, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.23065513422092, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 6.977690410614014, "policy_loss": -0.00980433782193965, "vf_loss": 6.985467873016993, "vf_explained_var": 0.7402844296147426, "kl": 0.015524163357561837, "entropy": 1.466054959098498, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -86.39144337506325, "episode_reward_min": -1399.6009660884727, "episode_reward_mean": -768.1741841884356, "episode_len_mean": 144.68, "episode_media": {}, "episodes_timesteps_total": 14468, "policy_reward_min": {"policy_0": -1399.6009660884727}, "policy_reward_max": {"policy_0": -86.39144337506325}, "policy_reward_mean": {"policy_0": -768.1741841884356}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-604.0605199370856, -529.4968358386692, -314.1977788075344, -531.245663028511, -956.195277499688, -1298.5330955054098, -298.2341944982017, -576.37873084697, -998.8777271985716, -656.0144786502477, -786.7951417419723, -970.8723928490218, -558.6918030242473, -490.38809397645116, -698.7567749557057, -657.8920752275076, -918.6310002098821, -360.88250095723595, -1118.7200440333118, -692.6559799728759, -937.0930866487395, -980.6291089402649, -1030.2296878453767, -819.2833967971419, -1082.0214031601768, -660.1538414236821, -940.7511347073823, -309.2549978846495, -912.2836498932998, -1127.302197194355, -359.64601277201996, -166.37903954559417, -685.4444964206948, -474.42616981503016, -507.6188134513553, -853.284380059178, -343.2602635142387, -579.2568210882991, -936.3833423468639, -716.4184805927825, -606.8417972899366, -1354.7050448527382, -793.956713465084, -783.6411278149085, -718.1118776977821, -907.5331374781786, -828.3113036260721, -1156.231398052732, -390.82939750759067, -863.370738573918, -712.0899737115074, -329.35785188345596, -235.23420734544482, -1375.8679180769136, -695.8272906016331, -532.7234835801605, -918.1289710525552, -955.9444343684096, -863.3646043235926, -767.8154361542126, -701.005387637698, -1121.9843749674953, -407.1600833338874, -961.3661361048414, -691.2134976116822, -957.700611963095, -1351.0298709775188, -880.1998350345897, -1093.6086292796535, -1116.9151496127433, -416.7518687300014, -744.9147248896159, -86.39144337506325, -608.4491250182766, -993.5555230776595, -627.8574127712944, -1105.9471287054707, -1173.1116966334823, -987.2704577133819, -482.62640735379375, -488.00833140673353, -909.8591976053058, -1086.569752847052, -508.29410784086014, -431.8343738701876, -108.36906537997832, -961.8715612179224, -273.3596877371126, -1204.9171648167905, -864.1269629155418, -714.6405101592834, -1399.6009660884727, -777.5907441602074, -757.693117835433, -1088.3902881013107, -860.3374222151626, -1332.6583667693824, -380.1717998414824, -968.9768770678676, -962.5616158591787], "episode_lengths": [150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 144, 89, 150, 110, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150], "policy_policy_0_reward": [-604.0605199370856, -529.4968358386692, -314.1977788075344, -531.245663028511, -956.195277499688, -1298.5330955054098, -298.2341944982017, -576.37873084697, -998.8777271985716, -656.0144786502477, -786.7951417419723, -970.8723928490218, -558.6918030242473, -490.38809397645116, -698.7567749557057, -657.8920752275076, -918.6310002098821, -360.88250095723595, -1118.7200440333118, -692.6559799728759, -937.0930866487395, -980.6291089402649, -1030.2296878453767, -819.2833967971419, -1082.0214031601768, -660.1538414236821, -940.7511347073823, -309.2549978846495, -912.2836498932998, -1127.302197194355, -359.64601277201996, -166.37903954559417, -685.4444964206948, -474.42616981503016, -507.6188134513553, -853.284380059178, -343.2602635142387, -579.2568210882991, -936.3833423468639, -716.4184805927825, -606.8417972899366, -1354.7050448527382, -793.956713465084, -783.6411278149085, -718.1118776977821, -907.5331374781786, -828.3113036260721, -1156.231398052732, -390.82939750759067, -863.370738573918, -712.0899737115074, -329.35785188345596, -235.23420734544482, -1375.8679180769136, -695.8272906016331, -532.7234835801605, -918.1289710525552, -955.9444343684096, -863.3646043235926, -767.8154361542126, -701.005387637698, -1121.9843749674953, -407.1600833338874, -961.3661361048414, -691.2134976116822, -957.700611963095, -1351.0298709775188, -880.1998350345897, -1093.6086292796535, -1116.9151496127433, -416.7518687300014, -744.9147248896159, -86.39144337506325, -608.4491250182766, -993.5555230776595, -627.8574127712944, -1105.9471287054707, -1173.1116966334823, -987.2704577133819, -482.62640735379375, -488.00833140673353, -909.8591976053058, -1086.569752847052, -508.29410784086014, -431.8343738701876, -108.36906537997832, -961.8715612179224, -273.3596877371126, -1204.9171648167905, -864.1269629155418, -714.6405101592834, -1399.6009660884727, -777.5907441602074, -757.693117835433, -1088.3902881013107, -860.3374222151626, -1332.6583667693824, -380.1717998414824, -968.9768770678676, -962.5616158591787]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2792387887508505, "mean_inference_ms": 0.9050757532256446, "mean_action_processing_ms": 0.15823208219134657, "mean_env_wait_ms": 1.539603265139309, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005220890045166016, "StateBufferConnector_ms": 0.004047870635986328, "ViewRequirementAgentConnector_ms": 0.09832596778869629}, "num_episodes": 29, "episode_return_max": -86.39144337506325, "episode_return_min": -1399.6009660884727, "episode_return_mean": -768.1741841884356, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 269.1837739708177, "num_env_steps_trained_throughput_per_sec": 269.1837739708177, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 14845.612, "restore_workers_time_ms": 0.025, "training_step_time_ms": 14845.539, "sample_time_ms": 2390.024, "learn_time_ms": 12439.201, "learn_throughput": 321.564, "synch_weights_time_ms": 15.432}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "92003_00008", "date": "2024-08-03_05-33-59", "timestamp": 1722643439, "time_this_iter_s": 14.86793851852417, "time_total_s": 163.66463327407837, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12eb3250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 163.66463327407837, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 12.804545454545455, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 56.12369300027688, "cur_kl_coeff": 0.22500000000000006, "cur_lr": 0.0010000000000000005, "total_loss": 7.049033352235953, "policy_loss": -0.018437456861526393, "vf_loss": 7.0639925102392835, "vf_explained_var": 0.7622211563711365, "kl": 0.02278983448547177, "entropy": 1.6494093783199788, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -72.01594053159756, "episode_reward_min": -1399.6009660884727, "episode_reward_mean": -770.1980070395871, "episode_len_mean": 143.32, "episode_media": {}, "episodes_timesteps_total": 14332, "policy_reward_min": {"policy_0": -1399.6009660884727}, "policy_reward_max": {"policy_0": -72.01594053159756}, "policy_reward_mean": {"policy_0": -770.1980070395871}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-912.2836498932998, -1127.302197194355, -359.64601277201996, -166.37903954559417, -685.4444964206948, -474.42616981503016, -507.6188134513553, -853.284380059178, -343.2602635142387, -579.2568210882991, -936.3833423468639, -716.4184805927825, -606.8417972899366, -1354.7050448527382, -793.956713465084, -783.6411278149085, -718.1118776977821, -907.5331374781786, -828.3113036260721, -1156.231398052732, -390.82939750759067, -863.370738573918, -712.0899737115074, -329.35785188345596, -235.23420734544482, -1375.8679180769136, -695.8272906016331, -532.7234835801605, -918.1289710525552, -955.9444343684096, -863.3646043235926, -767.8154361542126, -701.005387637698, -1121.9843749674953, -407.1600833338874, -961.3661361048414, -691.2134976116822, -957.700611963095, -1351.0298709775188, -880.1998350345897, -1093.6086292796535, -1116.9151496127433, -416.7518687300014, -744.9147248896159, -86.39144337506325, -608.4491250182766, -993.5555230776595, -627.8574127712944, -1105.9471287054707, -1173.1116966334823, -987.2704577133819, -482.62640735379375, -488.00833140673353, -909.8591976053058, -1086.569752847052, -508.29410784086014, -431.8343738701876, -108.36906537997832, -961.8715612179224, -273.3596877371126, -1204.9171648167905, -864.1269629155418, -714.6405101592834, -1399.6009660884727, -777.5907441602074, -757.693117835433, -1088.3902881013107, -860.3374222151626, -1332.6583667693824, -380.1717998414824, -968.9768770678676, -962.5616158591787, -1022.6643457510027, -867.5639294117062, -728.4993482443285, -678.7785195966436, -730.4475692168867, -306.88036606265604, -880.3705558510761, -585.8905889186098, -72.01594053159756, -792.6534298358158, -944.7723268790082, -284.2597199624206, -1251.8685656612504, -1141.563826411962, -805.882799947004, -792.6718505524547, -1254.9767054681702, -1197.813663677529, -942.145495981317, -409.88066467795034, -131.0521943392808, -860.9859515279733, -1013.4138590544378, -590.6371307549897, -591.3599616202466, -746.6290562434051, -499.82842759668506, -853.8122575052686], "episode_lengths": [150, 150, 144, 89, 150, 110, 150, 150, 150, 123, 150, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 72, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 132, 150], "policy_policy_0_reward": [-912.2836498932998, -1127.302197194355, -359.64601277201996, -166.37903954559417, -685.4444964206948, -474.42616981503016, -507.6188134513553, -853.284380059178, -343.2602635142387, -579.2568210882991, -936.3833423468639, -716.4184805927825, -606.8417972899366, -1354.7050448527382, -793.956713465084, -783.6411278149085, -718.1118776977821, -907.5331374781786, -828.3113036260721, -1156.231398052732, -390.82939750759067, -863.370738573918, -712.0899737115074, -329.35785188345596, -235.23420734544482, -1375.8679180769136, -695.8272906016331, -532.7234835801605, -918.1289710525552, -955.9444343684096, -863.3646043235926, -767.8154361542126, -701.005387637698, -1121.9843749674953, -407.1600833338874, -961.3661361048414, -691.2134976116822, -957.700611963095, -1351.0298709775188, -880.1998350345897, -1093.6086292796535, -1116.9151496127433, -416.7518687300014, -744.9147248896159, -86.39144337506325, -608.4491250182766, -993.5555230776595, -627.8574127712944, -1105.9471287054707, -1173.1116966334823, -987.2704577133819, -482.62640735379375, -488.00833140673353, -909.8591976053058, -1086.569752847052, -508.29410784086014, -431.8343738701876, -108.36906537997832, -961.8715612179224, -273.3596877371126, -1204.9171648167905, -864.1269629155418, -714.6405101592834, -1399.6009660884727, -777.5907441602074, -757.693117835433, -1088.3902881013107, -860.3374222151626, -1332.6583667693824, -380.1717998414824, -968.9768770678676, -962.5616158591787, -1022.6643457510027, -867.5639294117062, -728.4993482443285, -678.7785195966436, -730.4475692168867, -306.88036606265604, -880.3705558510761, -585.8905889186098, -72.01594053159756, -792.6534298358158, -944.7723268790082, -284.2597199624206, -1251.8685656612504, -1141.563826411962, -805.882799947004, -792.6718505524547, -1254.9767054681702, -1197.813663677529, -942.145495981317, -409.88066467795034, -131.0521943392808, -860.9859515279733, -1013.4138590544378, -590.6371307549897, -591.3599616202466, -746.6290562434051, -499.82842759668506, -853.8122575052686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27915705641768385, "mean_inference_ms": 0.9020043887432772, "mean_action_processing_ms": 0.15805741879781846, "mean_env_wait_ms": 1.542757319093738, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005333423614501953, "StateBufferConnector_ms": 0.0041539669036865234, "ViewRequirementAgentConnector_ms": 0.1005241870880127}, "num_episodes": 28, "episode_return_max": -72.01594053159756, "episode_return_min": -1399.6009660884727, "episode_return_mean": -770.1980070395871, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.0433042211867, "num_env_steps_trained_throughput_per_sec": 273.0433042211867, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 14779.222, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14779.149, "sample_time_ms": 2397.541, "learn_time_ms": 12365.312, "learn_throughput": 323.486, "synch_weights_time_ms": 15.437}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "92003_00008", "date": "2024-08-03_05-34-14", "timestamp": 1722643454, "time_this_iter_s": 14.657003402709961, "time_total_s": 178.32163667678833, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12eb3ac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 178.32163667678833, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 13.1047619047619, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 81.77357487181823, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.255114527046681, "policy_loss": -0.01245185944523352, "vf_loss": 6.264016745487849, "vf_explained_var": 0.8326294506589572, "kl": 0.015177589532261978, "entropy": 1.5727842015524705, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -1.1554123704782489, "episode_reward_min": -1399.6009660884727, "episode_reward_mean": -796.3720407906945, "episode_len_mean": 142.49, "episode_media": {}, "episodes_timesteps_total": 14249, "policy_reward_min": {"policy_0": -1399.6009660884727}, "policy_reward_max": {"policy_0": -1.1554123704782489}, "policy_reward_mean": {"policy_0": -796.3720407906945}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-918.1289710525552, -955.9444343684096, -863.3646043235926, -767.8154361542126, -701.005387637698, -1121.9843749674953, -407.1600833338874, -961.3661361048414, -691.2134976116822, -957.700611963095, -1351.0298709775188, -880.1998350345897, -1093.6086292796535, -1116.9151496127433, -416.7518687300014, -744.9147248896159, -86.39144337506325, -608.4491250182766, -993.5555230776595, -627.8574127712944, -1105.9471287054707, -1173.1116966334823, -987.2704577133819, -482.62640735379375, -488.00833140673353, -909.8591976053058, -1086.569752847052, -508.29410784086014, -431.8343738701876, -108.36906537997832, -961.8715612179224, -273.3596877371126, -1204.9171648167905, -864.1269629155418, -714.6405101592834, -1399.6009660884727, -777.5907441602074, -757.693117835433, -1088.3902881013107, -860.3374222151626, -1332.6583667693824, -380.1717998414824, -968.9768770678676, -962.5616158591787, -1022.6643457510027, -867.5639294117062, -728.4993482443285, -678.7785195966436, -730.4475692168867, -306.88036606265604, -880.3705558510761, -585.8905889186098, -72.01594053159756, -792.6534298358158, -944.7723268790082, -284.2597199624206, -1251.8685656612504, -1141.563826411962, -805.882799947004, -792.6718505524547, -1254.9767054681702, -1197.813663677529, -942.145495981317, -409.88066467795034, -131.0521943392808, -860.9859515279733, -1013.4138590544378, -590.6371307549897, -591.3599616202466, -746.6290562434051, -499.82842759668506, -853.8122575052686, -971.1443420492049, -28.46711789189675, -826.4655456455464, -424.60771301100186, -826.210945716125, -934.6608762173561, -449.15819679035644, -1092.1771262718794, -908.4467380368238, -1381.571607318158, -458.36745725130385, -910.7037761164424, -758.249643281029, -923.3907758578825, -975.3622813648027, -967.0467051728134, -1297.2233856689338, -686.613802338112, -173.214517986283, -780.3749356334635, -1321.4665093763676, -1260.160691525886, -1277.7737967960609, -656.2043086963477, -380.03554229535746, -1.1554123704782489, -994.8852545849717, -898.6012980976177], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 72, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 132, 150, 150, 48, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 120, 38, 150, 150], "policy_policy_0_reward": [-918.1289710525552, -955.9444343684096, -863.3646043235926, -767.8154361542126, -701.005387637698, -1121.9843749674953, -407.1600833338874, -961.3661361048414, -691.2134976116822, -957.700611963095, -1351.0298709775188, -880.1998350345897, -1093.6086292796535, -1116.9151496127433, -416.7518687300014, -744.9147248896159, -86.39144337506325, -608.4491250182766, -993.5555230776595, -627.8574127712944, -1105.9471287054707, -1173.1116966334823, -987.2704577133819, -482.62640735379375, -488.00833140673353, -909.8591976053058, -1086.569752847052, -508.29410784086014, -431.8343738701876, -108.36906537997832, -961.8715612179224, -273.3596877371126, -1204.9171648167905, -864.1269629155418, -714.6405101592834, -1399.6009660884727, -777.5907441602074, -757.693117835433, -1088.3902881013107, -860.3374222151626, -1332.6583667693824, -380.1717998414824, -968.9768770678676, -962.5616158591787, -1022.6643457510027, -867.5639294117062, -728.4993482443285, -678.7785195966436, -730.4475692168867, -306.88036606265604, -880.3705558510761, -585.8905889186098, -72.01594053159756, -792.6534298358158, -944.7723268790082, -284.2597199624206, -1251.8685656612504, -1141.563826411962, -805.882799947004, -792.6718505524547, -1254.9767054681702, -1197.813663677529, -942.145495981317, -409.88066467795034, -131.0521943392808, -860.9859515279733, -1013.4138590544378, -590.6371307549897, -591.3599616202466, -746.6290562434051, -499.82842759668506, -853.8122575052686, -971.1443420492049, -28.46711789189675, -826.4655456455464, -424.60771301100186, -826.210945716125, -934.6608762173561, -449.15819679035644, -1092.1771262718794, -908.4467380368238, -1381.571607318158, -458.36745725130385, -910.7037761164424, -758.249643281029, -923.3907758578825, -975.3622813648027, -967.0467051728134, -1297.2233856689338, -686.613802338112, -173.214517986283, -780.3749356334635, -1321.4665093763676, -1260.160691525886, -1277.7737967960609, -656.2043086963477, -380.03554229535746, -1.1554123704782489, -994.8852545849717, -898.6012980976177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2790868863305271, "mean_inference_ms": 0.8994676086792301, "mean_action_processing_ms": 0.15800918895632704, "mean_env_wait_ms": 1.5455792361054954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0055387020111083984, "StateBufferConnector_ms": 0.004133939743041992, "ViewRequirementAgentConnector_ms": 0.09957194328308105}, "num_episodes": 28, "episode_return_max": -1.1554123704782489, "episode_return_min": -1399.6009660884727, "episode_return_mean": -796.3720407906945, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.1295009341101, "num_env_steps_trained_throughput_per_sec": 268.1295009341101, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 14708.838, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14708.763, "sample_time_ms": 2397.842, "learn_time_ms": 12294.746, "learn_throughput": 325.342, "synch_weights_time_ms": 15.359}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "92003_00008", "date": "2024-08-03_05-34-29", "timestamp": 1722643469, "time_this_iter_s": 14.927001476287842, "time_total_s": 193.24863815307617, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fdb7f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 193.24863815307617, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 13.05238095238095, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 76.38575082123279, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.230571995675564, "policy_loss": -0.008811728832370136, "vf_loss": 6.2352085500955585, "vf_explained_var": 0.8283450694133838, "kl": 0.01675171101525545, "entropy": 1.478525689120094, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -1.1554123704782489, "episode_reward_min": -1399.6009660884727, "episode_reward_mean": -780.1104787553439, "episode_len_mean": 140.69, "episode_media": {}, "episodes_timesteps_total": 14069, "policy_reward_min": {"policy_0": -1399.6009660884727}, "policy_reward_max": {"policy_0": -1.1554123704782489}, "policy_reward_mean": {"policy_0": -780.1104787553439}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-961.8715612179224, -273.3596877371126, -1204.9171648167905, -864.1269629155418, -714.6405101592834, -1399.6009660884727, -777.5907441602074, -757.693117835433, -1088.3902881013107, -860.3374222151626, -1332.6583667693824, -380.1717998414824, -968.9768770678676, -962.5616158591787, -1022.6643457510027, -867.5639294117062, -728.4993482443285, -678.7785195966436, -730.4475692168867, -306.88036606265604, -880.3705558510761, -585.8905889186098, -72.01594053159756, -792.6534298358158, -944.7723268790082, -284.2597199624206, -1251.8685656612504, -1141.563826411962, -805.882799947004, -792.6718505524547, -1254.9767054681702, -1197.813663677529, -942.145495981317, -409.88066467795034, -131.0521943392808, -860.9859515279733, -1013.4138590544378, -590.6371307549897, -591.3599616202466, -746.6290562434051, -499.82842759668506, -853.8122575052686, -971.1443420492049, -28.46711789189675, -826.4655456455464, -424.60771301100186, -826.210945716125, -934.6608762173561, -449.15819679035644, -1092.1771262718794, -908.4467380368238, -1381.571607318158, -458.36745725130385, -910.7037761164424, -758.249643281029, -923.3907758578825, -975.3622813648027, -967.0467051728134, -1297.2233856689338, -686.613802338112, -173.214517986283, -780.3749356334635, -1321.4665093763676, -1260.160691525886, -1277.7737967960609, -656.2043086963477, -380.03554229535746, -1.1554123704782489, -994.8852545849717, -898.6012980976177, -205.53532336101375, -569.0185833104496, -975.0797736993906, -939.1242651540424, -881.1607210429565, -946.9234066035718, -479.2628421033105, -1065.8404611748367, -430.5978614506201, -548.3473257134401, -654.57987268861, -1115.4182696005976, -1248.864772333933, -1127.1264488134393, -658.8433613181155, -367.266404329412, -339.56063762333673, -546.0507237298847, -107.80257489737933, -632.9284685450131, -728.1412832819664, -1193.4178908841952, -752.0793986424494, -175.5524078851079, -741.9145788727806, -1057.2606165559325, -894.908588693703, -1029.841651775139, -675.5805149777236, -833.062407042712], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 72, 150, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 132, 150, 150, 48, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 120, 38, 150, 150, 107, 150, 150, 150, 150, 150, 119, 150, 150, 121, 150, 150, 150, 150, 150, 132, 88, 150, 62, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-961.8715612179224, -273.3596877371126, -1204.9171648167905, -864.1269629155418, -714.6405101592834, -1399.6009660884727, -777.5907441602074, -757.693117835433, -1088.3902881013107, -860.3374222151626, -1332.6583667693824, -380.1717998414824, -968.9768770678676, -962.5616158591787, -1022.6643457510027, -867.5639294117062, -728.4993482443285, -678.7785195966436, -730.4475692168867, -306.88036606265604, -880.3705558510761, -585.8905889186098, -72.01594053159756, -792.6534298358158, -944.7723268790082, -284.2597199624206, -1251.8685656612504, -1141.563826411962, -805.882799947004, -792.6718505524547, -1254.9767054681702, -1197.813663677529, -942.145495981317, -409.88066467795034, -131.0521943392808, -860.9859515279733, -1013.4138590544378, -590.6371307549897, -591.3599616202466, -746.6290562434051, -499.82842759668506, -853.8122575052686, -971.1443420492049, -28.46711789189675, -826.4655456455464, -424.60771301100186, -826.210945716125, -934.6608762173561, -449.15819679035644, -1092.1771262718794, -908.4467380368238, -1381.571607318158, -458.36745725130385, -910.7037761164424, -758.249643281029, -923.3907758578825, -975.3622813648027, -967.0467051728134, -1297.2233856689338, -686.613802338112, -173.214517986283, -780.3749356334635, -1321.4665093763676, -1260.160691525886, -1277.7737967960609, -656.2043086963477, -380.03554229535746, -1.1554123704782489, -994.8852545849717, -898.6012980976177, -205.53532336101375, -569.0185833104496, -975.0797736993906, -939.1242651540424, -881.1607210429565, -946.9234066035718, -479.2628421033105, -1065.8404611748367, -430.5978614506201, -548.3473257134401, -654.57987268861, -1115.4182696005976, -1248.864772333933, -1127.1264488134393, -658.8433613181155, -367.266404329412, -339.56063762333673, -546.0507237298847, -107.80257489737933, -632.9284685450131, -728.1412832819664, -1193.4178908841952, -752.0793986424494, -175.5524078851079, -741.9145788727806, -1057.2606165559325, -894.908588693703, -1029.841651775139, -675.5805149777236, -833.062407042712]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2793068489509528, "mean_inference_ms": 0.897546323013591, "mean_action_processing_ms": 0.1581421138829752, "mean_env_wait_ms": 1.5485427763954922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005482673645019531, "StateBufferConnector_ms": 0.004144906997680664, "ViewRequirementAgentConnector_ms": 0.10124468803405762}, "num_episodes": 30, "episode_return_max": -1.1554123704782489, "episode_return_min": -1399.6009660884727, "episode_return_mean": -780.1104787553439, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 262.95015999598894, "num_env_steps_trained_throughput_per_sec": 262.95015999598894, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 14748.639, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14748.564, "sample_time_ms": 2402.995, "learn_time_ms": 12329.426, "learn_throughput": 324.427, "synch_weights_time_ms": 15.325}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "92003_00008", "date": "2024-08-03_05-34-44", "timestamp": 1722643484, "time_this_iter_s": 15.221247434616089, "time_total_s": 208.46988558769226, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12eb2c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 208.46988558769226, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 12.90952380952381, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 79.04242702225844, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.089605704446634, "policy_loss": -0.011647321537990744, "vf_loss": 6.097609483699004, "vf_explained_var": 0.8759839175269007, "kl": 0.014839826732107531, "entropy": 1.3649004372457663, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -1.1554123704782489, "episode_reward_min": -1433.5289387079586, "episode_reward_mean": -738.735971275214, "episode_len_mean": 137.31, "episode_media": {}, "episodes_timesteps_total": 13731, "policy_reward_min": {"policy_0": -1433.5289387079586}, "policy_reward_max": {"policy_0": -1.1554123704782489}, "policy_reward_mean": {"policy_0": -738.735971275214}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1254.9767054681702, -1197.813663677529, -942.145495981317, -409.88066467795034, -131.0521943392808, -860.9859515279733, -1013.4138590544378, -590.6371307549897, -591.3599616202466, -746.6290562434051, -499.82842759668506, -853.8122575052686, -971.1443420492049, -28.46711789189675, -826.4655456455464, -424.60771301100186, -826.210945716125, -934.6608762173561, -449.15819679035644, -1092.1771262718794, -908.4467380368238, -1381.571607318158, -458.36745725130385, -910.7037761164424, -758.249643281029, -923.3907758578825, -975.3622813648027, -967.0467051728134, -1297.2233856689338, -686.613802338112, -173.214517986283, -780.3749356334635, -1321.4665093763676, -1260.160691525886, -1277.7737967960609, -656.2043086963477, -380.03554229535746, -1.1554123704782489, -994.8852545849717, -898.6012980976177, -205.53532336101375, -569.0185833104496, -975.0797736993906, -939.1242651540424, -881.1607210429565, -946.9234066035718, -479.2628421033105, -1065.8404611748367, -430.5978614506201, -548.3473257134401, -654.57987268861, -1115.4182696005976, -1248.864772333933, -1127.1264488134393, -658.8433613181155, -367.266404329412, -339.56063762333673, -546.0507237298847, -107.80257489737933, -632.9284685450131, -728.1412832819664, -1193.4178908841952, -752.0793986424494, -175.5524078851079, -741.9145788727806, -1057.2606165559325, -894.908588693703, -1029.841651775139, -675.5805149777236, -833.062407042712, -478.1452574974888, -559.4041187149047, -1433.5289387079586, -780.5618985934151, -782.9799566841752, -1089.2813862333203, -162.98415750785634, -732.3222174789273, -900.1288123705139, -900.882303780732, -215.33778803712616, -47.79159160335317, -609.4293799225974, -1138.7347097824384, -799.4387961107036, -886.0110974738736, -257.6403622161453, -738.5392135372686, -932.373976153599, -991.1480243241098, -362.8319887320309, -1226.2298249239507, -844.9587183977189, -471.16916749538666, -1224.96691743908, -473.87419014178187, -74.96078057030489, -697.35772033911, -275.75365457689344, -207.4630702598269], "episode_lengths": [150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 132, 150, 150, 48, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 120, 38, 150, 150, 107, 150, 150, 150, 150, 150, 119, 150, 150, 121, 150, 150, 150, 150, 150, 132, 88, 150, 62, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 63, 150, 150, 150, 85, 39, 138, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 107, 150, 150, 69, 150, 88, 98], "policy_policy_0_reward": [-1254.9767054681702, -1197.813663677529, -942.145495981317, -409.88066467795034, -131.0521943392808, -860.9859515279733, -1013.4138590544378, -590.6371307549897, -591.3599616202466, -746.6290562434051, -499.82842759668506, -853.8122575052686, -971.1443420492049, -28.46711789189675, -826.4655456455464, -424.60771301100186, -826.210945716125, -934.6608762173561, -449.15819679035644, -1092.1771262718794, -908.4467380368238, -1381.571607318158, -458.36745725130385, -910.7037761164424, -758.249643281029, -923.3907758578825, -975.3622813648027, -967.0467051728134, -1297.2233856689338, -686.613802338112, -173.214517986283, -780.3749356334635, -1321.4665093763676, -1260.160691525886, -1277.7737967960609, -656.2043086963477, -380.03554229535746, -1.1554123704782489, -994.8852545849717, -898.6012980976177, -205.53532336101375, -569.0185833104496, -975.0797736993906, -939.1242651540424, -881.1607210429565, -946.9234066035718, -479.2628421033105, -1065.8404611748367, -430.5978614506201, -548.3473257134401, -654.57987268861, -1115.4182696005976, -1248.864772333933, -1127.1264488134393, -658.8433613181155, -367.266404329412, -339.56063762333673, -546.0507237298847, -107.80257489737933, -632.9284685450131, -728.1412832819664, -1193.4178908841952, -752.0793986424494, -175.5524078851079, -741.9145788727806, -1057.2606165559325, -894.908588693703, -1029.841651775139, -675.5805149777236, -833.062407042712, -478.1452574974888, -559.4041187149047, -1433.5289387079586, -780.5618985934151, -782.9799566841752, -1089.2813862333203, -162.98415750785634, -732.3222174789273, -900.1288123705139, -900.882303780732, -215.33778803712616, -47.79159160335317, -609.4293799225974, -1138.7347097824384, -799.4387961107036, -886.0110974738736, -257.6403622161453, -738.5392135372686, -932.373976153599, -991.1480243241098, -362.8319887320309, -1226.2298249239507, -844.9587183977189, -471.16916749538666, -1224.96691743908, -473.87419014178187, -74.96078057030489, -697.35772033911, -275.75365457689344, -207.4630702598269]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2793021450060364, "mean_inference_ms": 0.8963164396159459, "mean_action_processing_ms": 0.15813269832159974, "mean_env_wait_ms": 1.5502945600094058, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005280494689941406, "StateBufferConnector_ms": 0.004097700119018555, "ViewRequirementAgentConnector_ms": 0.09884333610534668}, "num_episodes": 30, "episode_return_max": -1.1554123704782489, "episode_return_min": -1433.5289387079586, "episode_return_mean": -738.735971275214, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.1548063182057, "num_env_steps_trained_throughput_per_sec": 272.1548063182057, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 14737.735, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14737.659, "sample_time_ms": 2409.673, "learn_time_ms": 12311.908, "learn_throughput": 324.889, "synch_weights_time_ms": 15.261}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "92003_00008", "date": "2024-08-03_05-34-59", "timestamp": 1722643499, "time_this_iter_s": 14.705092668533325, "time_total_s": 223.1749782562256, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fdb760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 223.1749782562256, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 12.90952380952381, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 108.32965621054173, "cur_kl_coeff": 0.3375000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 5.608831952015559, "policy_loss": -0.013115340481939105, "vf_loss": 5.616492894788583, "vf_explained_var": 0.9260998403032621, "kl": 0.02019648010894648, "entropy": 1.3619073260575534, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -1.1554123704782489, "episode_reward_min": -1433.5289387079586, "episode_reward_mean": -722.4613452507126, "episode_len_mean": 136.65, "episode_media": {}, "episodes_timesteps_total": 13665, "policy_reward_min": {"policy_0": -1433.5289387079586}, "policy_reward_max": {"policy_0": -1.1554123704782489}, "policy_reward_mean": {"policy_0": -722.4613452507126}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1297.2233856689338, -686.613802338112, -173.214517986283, -780.3749356334635, -1321.4665093763676, -1260.160691525886, -1277.7737967960609, -656.2043086963477, -380.03554229535746, -1.1554123704782489, -994.8852545849717, -898.6012980976177, -205.53532336101375, -569.0185833104496, -975.0797736993906, -939.1242651540424, -881.1607210429565, -946.9234066035718, -479.2628421033105, -1065.8404611748367, -430.5978614506201, -548.3473257134401, -654.57987268861, -1115.4182696005976, -1248.864772333933, -1127.1264488134393, -658.8433613181155, -367.266404329412, -339.56063762333673, -546.0507237298847, -107.80257489737933, -632.9284685450131, -728.1412832819664, -1193.4178908841952, -752.0793986424494, -175.5524078851079, -741.9145788727806, -1057.2606165559325, -894.908588693703, -1029.841651775139, -675.5805149777236, -833.062407042712, -478.1452574974888, -559.4041187149047, -1433.5289387079586, -780.5618985934151, -782.9799566841752, -1089.2813862333203, -162.98415750785634, -732.3222174789273, -900.1288123705139, -900.882303780732, -215.33778803712616, -47.79159160335317, -609.4293799225974, -1138.7347097824384, -799.4387961107036, -886.0110974738736, -257.6403622161453, -738.5392135372686, -932.373976153599, -991.1480243241098, -362.8319887320309, -1226.2298249239507, -844.9587183977189, -471.16916749538666, -1224.96691743908, -473.87419014178187, -74.96078057030489, -697.35772033911, -275.75365457689344, -207.4630702598269, -376.3797029058436, -823.0344642810072, -721.5794209567807, -1179.0375514490734, -872.0029270678086, -1145.7508298680882, -19.67504927423259, -610.2603712370504, -916.0341532411812, -129.35266447441217, -832.2896727342347, -890.2649280737701, -566.3369480270893, -1026.776310048279, -852.2567951855312, -610.1547567100231, -942.7471158166528, -484.0606312471472, -796.3189613543506, -871.5460600520171, -192.18701617630407, -803.0312042363455, -708.1991208218184, -411.6253382973818, -833.5428987777318, -980.7830453555365, -620.0697150257015, -1085.8059612943457], "episode_lengths": [150, 150, 108, 150, 150, 150, 150, 150, 120, 38, 150, 150, 107, 150, 150, 150, 150, 150, 119, 150, 150, 121, 150, 150, 150, 150, 150, 132, 88, 150, 62, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 63, 150, 150, 150, 85, 39, 138, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 107, 150, 150, 69, 150, 88, 98, 150, 150, 150, 150, 150, 150, 49, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 98, 150, 150, 150, 150], "policy_policy_0_reward": [-1297.2233856689338, -686.613802338112, -173.214517986283, -780.3749356334635, -1321.4665093763676, -1260.160691525886, -1277.7737967960609, -656.2043086963477, -380.03554229535746, -1.1554123704782489, -994.8852545849717, -898.6012980976177, -205.53532336101375, -569.0185833104496, -975.0797736993906, -939.1242651540424, -881.1607210429565, -946.9234066035718, -479.2628421033105, -1065.8404611748367, -430.5978614506201, -548.3473257134401, -654.57987268861, -1115.4182696005976, -1248.864772333933, -1127.1264488134393, -658.8433613181155, -367.266404329412, -339.56063762333673, -546.0507237298847, -107.80257489737933, -632.9284685450131, -728.1412832819664, -1193.4178908841952, -752.0793986424494, -175.5524078851079, -741.9145788727806, -1057.2606165559325, -894.908588693703, -1029.841651775139, -675.5805149777236, -833.062407042712, -478.1452574974888, -559.4041187149047, -1433.5289387079586, -780.5618985934151, -782.9799566841752, -1089.2813862333203, -162.98415750785634, -732.3222174789273, -900.1288123705139, -900.882303780732, -215.33778803712616, -47.79159160335317, -609.4293799225974, -1138.7347097824384, -799.4387961107036, -886.0110974738736, -257.6403622161453, -738.5392135372686, -932.373976153599, -991.1480243241098, -362.8319887320309, -1226.2298249239507, -844.9587183977189, -471.16916749538666, -1224.96691743908, -473.87419014178187, -74.96078057030489, -697.35772033911, -275.75365457689344, -207.4630702598269, -376.3797029058436, -823.0344642810072, -721.5794209567807, -1179.0375514490734, -872.0029270678086, -1145.7508298680882, -19.67504927423259, -610.2603712370504, -916.0341532411812, -129.35266447441217, -832.2896727342347, -890.2649280737701, -566.3369480270893, -1026.776310048279, -852.2567951855312, -610.1547567100231, -942.7471158166528, -484.0606312471472, -796.3189613543506, -871.5460600520171, -192.18701617630407, -803.0312042363455, -708.1991208218184, -411.6253382973818, -833.5428987777318, -980.7830453555365, -620.0697150257015, -1085.8059612943457]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27921688476621204, "mean_inference_ms": 0.8948362789778773, "mean_action_processing_ms": 0.15803130603476975, "mean_env_wait_ms": 1.5509207324888223, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0053005218505859375, "StateBufferConnector_ms": 0.004057168960571289, "ViewRequirementAgentConnector_ms": 0.09912753105163574}, "num_episodes": 28, "episode_return_max": -1.1554123704782489, "episode_return_min": -1433.5289387079586, "episode_return_mean": -722.4613452507126, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.8756310347912, "num_env_steps_trained_throughput_per_sec": 271.8756310347912, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 14715.353, "restore_workers_time_ms": 0.026, "training_step_time_ms": 14715.278, "sample_time_ms": 2416.612, "learn_time_ms": 12283.003, "learn_throughput": 325.653, "synch_weights_time_ms": 14.848}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "92003_00008", "date": "2024-08-03_05-35-14", "timestamp": 1722643514, "time_this_iter_s": 14.719342708587646, "time_total_s": 237.89432096481323, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12eb27a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 237.89432096481323, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 12.923809523809522, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 89.84060558875402, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 5.8429917688171065, "policy_loss": -0.009922806935113234, "vf_loss": 5.849490547428529, "vf_explained_var": 0.8919651739299297, "kl": 0.009905205091187497, "entropy": 1.5904927297184865, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -19.67504927423259, "episode_reward_min": -1433.5289387079586, "episode_reward_mean": -718.7756263222681, "episode_len_mean": 138.55, "episode_media": {}, "episodes_timesteps_total": 13855, "policy_reward_min": {"policy_0": -1433.5289387079586}, "policy_reward_max": {"policy_0": -19.67504927423259}, "policy_reward_mean": {"policy_0": -718.7756263222681}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-339.56063762333673, -546.0507237298847, -107.80257489737933, -632.9284685450131, -728.1412832819664, -1193.4178908841952, -752.0793986424494, -175.5524078851079, -741.9145788727806, -1057.2606165559325, -894.908588693703, -1029.841651775139, -675.5805149777236, -833.062407042712, -478.1452574974888, -559.4041187149047, -1433.5289387079586, -780.5618985934151, -782.9799566841752, -1089.2813862333203, -162.98415750785634, -732.3222174789273, -900.1288123705139, -900.882303780732, -215.33778803712616, -47.79159160335317, -609.4293799225974, -1138.7347097824384, -799.4387961107036, -886.0110974738736, -257.6403622161453, -738.5392135372686, -932.373976153599, -991.1480243241098, -362.8319887320309, -1226.2298249239507, -844.9587183977189, -471.16916749538666, -1224.96691743908, -473.87419014178187, -74.96078057030489, -697.35772033911, -275.75365457689344, -207.4630702598269, -376.3797029058436, -823.0344642810072, -721.5794209567807, -1179.0375514490734, -872.0029270678086, -1145.7508298680882, -19.67504927423259, -610.2603712370504, -916.0341532411812, -129.35266447441217, -832.2896727342347, -890.2649280737701, -566.3369480270893, -1026.776310048279, -852.2567951855312, -610.1547567100231, -942.7471158166528, -484.0606312471472, -796.3189613543506, -871.5460600520171, -192.18701617630407, -803.0312042363455, -708.1991208218184, -411.6253382973818, -833.5428987777318, -980.7830453555365, -620.0697150257015, -1085.8059612943457, -292.89287978674326, -587.1135372190732, -499.3836054429098, -509.4665167633271, -1104.3369837745781, -1022.0692875878293, -1065.3914586910798, -774.1951920872527, -980.2349601821217, -263.81795005019967, -643.4017802575876, -909.5152788772585, -906.3522805253106, -1311.0128632648332, -644.7246578682015, -1000.2990069472736, -694.0794776869141, -953.2343533118176, -934.4593223224523, -256.1180615892738, -598.0053875633623, -899.2442060999442, -1242.4235922008825, -1025.7875350909455, -436.9013945431882, -427.95320280649645, -727.1891180103997, -862.5233646718843], "episode_lengths": [88, 150, 62, 150, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 63, 150, 150, 150, 85, 39, 138, 150, 150, 150, 150, 150, 150, 150, 148, 150, 150, 107, 150, 150, 69, 150, 88, 98, 150, 150, 150, 150, 150, 150, 49, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 98, 150, 150, 150, 150, 150, 127, 150, 117, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-339.56063762333673, -546.0507237298847, -107.80257489737933, -632.9284685450131, -728.1412832819664, -1193.4178908841952, -752.0793986424494, -175.5524078851079, -741.9145788727806, -1057.2606165559325, -894.908588693703, -1029.841651775139, -675.5805149777236, -833.062407042712, -478.1452574974888, -559.4041187149047, -1433.5289387079586, -780.5618985934151, -782.9799566841752, -1089.2813862333203, -162.98415750785634, -732.3222174789273, -900.1288123705139, -900.882303780732, -215.33778803712616, -47.79159160335317, -609.4293799225974, -1138.7347097824384, -799.4387961107036, -886.0110974738736, -257.6403622161453, -738.5392135372686, -932.373976153599, -991.1480243241098, -362.8319887320309, -1226.2298249239507, -844.9587183977189, -471.16916749538666, -1224.96691743908, -473.87419014178187, -74.96078057030489, -697.35772033911, -275.75365457689344, -207.4630702598269, -376.3797029058436, -823.0344642810072, -721.5794209567807, -1179.0375514490734, -872.0029270678086, -1145.7508298680882, -19.67504927423259, -610.2603712370504, -916.0341532411812, -129.35266447441217, -832.2896727342347, -890.2649280737701, -566.3369480270893, -1026.776310048279, -852.2567951855312, -610.1547567100231, -942.7471158166528, -484.0606312471472, -796.3189613543506, -871.5460600520171, -192.18701617630407, -803.0312042363455, -708.1991208218184, -411.6253382973818, -833.5428987777318, -980.7830453555365, -620.0697150257015, -1085.8059612943457, -292.89287978674326, -587.1135372190732, -499.3836054429098, -509.4665167633271, -1104.3369837745781, -1022.0692875878293, -1065.3914586910798, -774.1951920872527, -980.2349601821217, -263.81795005019967, -643.4017802575876, -909.5152788772585, -906.3522805253106, -1311.0128632648332, -644.7246578682015, -1000.2990069472736, -694.0794776869141, -953.2343533118176, -934.4593223224523, -256.1180615892738, -598.0053875633623, -899.2442060999442, -1242.4235922008825, -1025.7875350909455, -436.9013945431882, -427.95320280649645, -727.1891180103997, -862.5233646718843]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27935874505872255, "mean_inference_ms": 0.8937509572831543, "mean_action_processing_ms": 0.1579860497166514, "mean_env_wait_ms": 1.5523337803428887, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005610466003417969, "StateBufferConnector_ms": 0.00419163703918457, "ViewRequirementAgentConnector_ms": 0.10129618644714355}, "num_episodes": 28, "episode_return_max": -19.67504927423259, "episode_return_min": -1433.5289387079586, "episode_return_mean": -718.7756263222681, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 271.2578000973295, "num_env_steps_trained_throughput_per_sec": 271.2578000973295, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 14723.504, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14723.427, "sample_time_ms": 2421.861, "learn_time_ms": 12285.665, "learn_throughput": 325.583, "synch_weights_time_ms": 15.089}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "92003_00008", "date": "2024-08-03_05-35-28", "timestamp": 1722643528, "time_this_iter_s": 14.75369644165039, "time_total_s": 252.64801740646362, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12eb2200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 252.64801740646362, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 12.904545454545454, "ram_util_percent": 19.272727272727273}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 136.39937879045803, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 5.181088987241188, "policy_loss": -0.009220123320604519, "vf_loss": 5.186379868288835, "vf_explained_var": 0.8966782454401254, "kl": 0.010912179828937971, "entropy": 1.59506381675601, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -19.67504927423259, "episode_reward_min": -1311.0128632648332, "episode_reward_mean": -738.7569919998814, "episode_len_mean": 141.2, "episode_media": {}, "episodes_timesteps_total": 14120, "policy_reward_min": {"policy_0": -1311.0128632648332}, "policy_reward_max": {"policy_0": -19.67504927423259}, "policy_reward_mean": {"policy_0": -738.7569919998814}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-886.0110974738736, -257.6403622161453, -738.5392135372686, -932.373976153599, -991.1480243241098, -362.8319887320309, -1226.2298249239507, -844.9587183977189, -471.16916749538666, -1224.96691743908, -473.87419014178187, -74.96078057030489, -697.35772033911, -275.75365457689344, -207.4630702598269, -376.3797029058436, -823.0344642810072, -721.5794209567807, -1179.0375514490734, -872.0029270678086, -1145.7508298680882, -19.67504927423259, -610.2603712370504, -916.0341532411812, -129.35266447441217, -832.2896727342347, -890.2649280737701, -566.3369480270893, -1026.776310048279, -852.2567951855312, -610.1547567100231, -942.7471158166528, -484.0606312471472, -796.3189613543506, -871.5460600520171, -192.18701617630407, -803.0312042363455, -708.1991208218184, -411.6253382973818, -833.5428987777318, -980.7830453555365, -620.0697150257015, -1085.8059612943457, -292.89287978674326, -587.1135372190732, -499.3836054429098, -509.4665167633271, -1104.3369837745781, -1022.0692875878293, -1065.3914586910798, -774.1951920872527, -980.2349601821217, -263.81795005019967, -643.4017802575876, -909.5152788772585, -906.3522805253106, -1311.0128632648332, -644.7246578682015, -1000.2990069472736, -694.0794776869141, -953.2343533118176, -934.4593223224523, -256.1180615892738, -598.0053875633623, -899.2442060999442, -1242.4235922008825, -1025.7875350909455, -436.9013945431882, -427.95320280649645, -727.1891180103997, -862.5233646718843, -750.1424020902175, -1233.428399817734, -487.0512008731888, -354.70252686797005, -171.88468135619516, -532.8555772736604, -1189.9935820608048, -971.5624112630945, -1055.2214652613914, -367.76760065535086, -945.2064938985926, -855.7466667153701, -1051.8477082052877, -554.8383098771673, -932.0225826403605, -313.4958173680102, -813.9330395186024, -713.2520166890952, -1197.3508968286008, -975.4367097581221, -789.3373262735412, -669.7516088752732, -780.4823387457566, -1156.8437502099662, -882.6287981328161, -831.9711155532062, -575.0004406141442, -347.306914361141, -836.1272424095336], "episode_lengths": [150, 150, 150, 150, 150, 148, 150, 150, 107, 150, 150, 69, 150, 88, 98, 150, 150, 150, 150, 150, 150, 49, 150, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 98, 150, 150, 150, 150, 150, 127, 150, 117, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 96, 86, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 116, 150], "policy_policy_0_reward": [-886.0110974738736, -257.6403622161453, -738.5392135372686, -932.373976153599, -991.1480243241098, -362.8319887320309, -1226.2298249239507, -844.9587183977189, -471.16916749538666, -1224.96691743908, -473.87419014178187, -74.96078057030489, -697.35772033911, -275.75365457689344, -207.4630702598269, -376.3797029058436, -823.0344642810072, -721.5794209567807, -1179.0375514490734, -872.0029270678086, -1145.7508298680882, -19.67504927423259, -610.2603712370504, -916.0341532411812, -129.35266447441217, -832.2896727342347, -890.2649280737701, -566.3369480270893, -1026.776310048279, -852.2567951855312, -610.1547567100231, -942.7471158166528, -484.0606312471472, -796.3189613543506, -871.5460600520171, -192.18701617630407, -803.0312042363455, -708.1991208218184, -411.6253382973818, -833.5428987777318, -980.7830453555365, -620.0697150257015, -1085.8059612943457, -292.89287978674326, -587.1135372190732, -499.3836054429098, -509.4665167633271, -1104.3369837745781, -1022.0692875878293, -1065.3914586910798, -774.1951920872527, -980.2349601821217, -263.81795005019967, -643.4017802575876, -909.5152788772585, -906.3522805253106, -1311.0128632648332, -644.7246578682015, -1000.2990069472736, -694.0794776869141, -953.2343533118176, -934.4593223224523, -256.1180615892738, -598.0053875633623, -899.2442060999442, -1242.4235922008825, -1025.7875350909455, -436.9013945431882, -427.95320280649645, -727.1891180103997, -862.5233646718843, -750.1424020902175, -1233.428399817734, -487.0512008731888, -354.70252686797005, -171.88468135619516, -532.8555772736604, -1189.9935820608048, -971.5624112630945, -1055.2214652613914, -367.76760065535086, -945.2064938985926, -855.7466667153701, -1051.8477082052877, -554.8383098771673, -932.0225826403605, -313.4958173680102, -813.9330395186024, -713.2520166890952, -1197.3508968286008, -975.4367097581221, -789.3373262735412, -669.7516088752732, -780.4823387457566, -1156.8437502099662, -882.6287981328161, -831.9711155532062, -575.0004406141442, -347.306914361141, -836.1272424095336]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2793032124378049, "mean_inference_ms": 0.8927595698683413, "mean_action_processing_ms": 0.15791416744419987, "mean_env_wait_ms": 1.5542199543753947, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0054972171783447266, "StateBufferConnector_ms": 0.004046916961669922, "ViewRequirementAgentConnector_ms": 0.0985727310180664}, "num_episodes": 29, "episode_return_max": -19.67504927423259, "episode_return_min": -1311.0128632648332, "episode_return_mean": -738.7569919998814, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 268.47442559982466, "num_env_steps_trained_throughput_per_sec": 268.47442559982466, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 14708.95, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14708.872, "sample_time_ms": 2402.256, "learn_time_ms": 12290.688, "learn_throughput": 325.45, "synch_weights_time_ms": 15.112}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "92003_00008", "date": "2024-08-03_05-35-43", "timestamp": 1722643543, "time_this_iter_s": 14.906013011932373, "time_total_s": 267.554030418396, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12eb11b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 267.554030418396, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 12.957142857142856, "ram_util_percent": 19.238095238095234}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 115.97425813873609, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 5.5515511577328045, "policy_loss": -0.013271772743610199, "vf_loss": 5.558915263414383, "vf_explained_var": 0.935890917852521, "kl": 0.01442526747772113, "entropy": 1.395130888869365, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -33.66928878547246, "episode_reward_min": -1311.0128632648332, "episode_reward_mean": -718.3927681017501, "episode_len_mean": 137.24, "episode_media": {}, "episodes_timesteps_total": 13724, "policy_reward_min": {"policy_0": -1311.0128632648332}, "policy_reward_max": {"policy_0": -33.66928878547246}, "policy_reward_mean": {"policy_0": -718.3927681017501}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-942.7471158166528, -484.0606312471472, -796.3189613543506, -871.5460600520171, -192.18701617630407, -803.0312042363455, -708.1991208218184, -411.6253382973818, -833.5428987777318, -980.7830453555365, -620.0697150257015, -1085.8059612943457, -292.89287978674326, -587.1135372190732, -499.3836054429098, -509.4665167633271, -1104.3369837745781, -1022.0692875878293, -1065.3914586910798, -774.1951920872527, -980.2349601821217, -263.81795005019967, -643.4017802575876, -909.5152788772585, -906.3522805253106, -1311.0128632648332, -644.7246578682015, -1000.2990069472736, -694.0794776869141, -953.2343533118176, -934.4593223224523, -256.1180615892738, -598.0053875633623, -899.2442060999442, -1242.4235922008825, -1025.7875350909455, -436.9013945431882, -427.95320280649645, -727.1891180103997, -862.5233646718843, -750.1424020902175, -1233.428399817734, -487.0512008731888, -354.70252686797005, -171.88468135619516, -532.8555772736604, -1189.9935820608048, -971.5624112630945, -1055.2214652613914, -367.76760065535086, -945.2064938985926, -855.7466667153701, -1051.8477082052877, -554.8383098771673, -932.0225826403605, -313.4958173680102, -813.9330395186024, -713.2520166890952, -1197.3508968286008, -975.4367097581221, -789.3373262735412, -669.7516088752732, -780.4823387457566, -1156.8437502099662, -882.6287981328161, -831.9711155532062, -575.0004406141442, -347.306914361141, -836.1272424095336, -571.8581709398628, -384.79443979924025, -926.2503976020224, -125.10212967290526, -1009.0892171956727, -998.2641216810283, -346.5900155770292, -51.88496433826933, -684.8043696306044, -468.74629755215125, -1041.0340697467304, -33.66928878547246, -116.89016824985072, -782.8158059644553, -1014.4822771956073, -1044.8014393719577, -1204.3674816462415, -173.02354478057066, -101.66795191551047, -411.4123129721761, -362.6256642363191, -1198.9235424213384, -977.3764841673328, -884.5580827394587, -115.0177184857137, -608.1536218920756, -378.94883813445244, -750.5645453223085, -1029.6250768138016, -609.8312273331907, -792.8695961389836], "episode_lengths": [150, 150, 150, 150, 96, 150, 150, 98, 150, 150, 150, 150, 150, 127, 150, 117, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 96, 86, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 116, 150, 150, 150, 150, 72, 150, 150, 104, 57, 150, 150, 150, 47, 75, 150, 150, 150, 150, 62, 63, 109, 100, 150, 150, 150, 76, 150, 109, 150, 150, 131, 150], "policy_policy_0_reward": [-942.7471158166528, -484.0606312471472, -796.3189613543506, -871.5460600520171, -192.18701617630407, -803.0312042363455, -708.1991208218184, -411.6253382973818, -833.5428987777318, -980.7830453555365, -620.0697150257015, -1085.8059612943457, -292.89287978674326, -587.1135372190732, -499.3836054429098, -509.4665167633271, -1104.3369837745781, -1022.0692875878293, -1065.3914586910798, -774.1951920872527, -980.2349601821217, -263.81795005019967, -643.4017802575876, -909.5152788772585, -906.3522805253106, -1311.0128632648332, -644.7246578682015, -1000.2990069472736, -694.0794776869141, -953.2343533118176, -934.4593223224523, -256.1180615892738, -598.0053875633623, -899.2442060999442, -1242.4235922008825, -1025.7875350909455, -436.9013945431882, -427.95320280649645, -727.1891180103997, -862.5233646718843, -750.1424020902175, -1233.428399817734, -487.0512008731888, -354.70252686797005, -171.88468135619516, -532.8555772736604, -1189.9935820608048, -971.5624112630945, -1055.2214652613914, -367.76760065535086, -945.2064938985926, -855.7466667153701, -1051.8477082052877, -554.8383098771673, -932.0225826403605, -313.4958173680102, -813.9330395186024, -713.2520166890952, -1197.3508968286008, -975.4367097581221, -789.3373262735412, -669.7516088752732, -780.4823387457566, -1156.8437502099662, -882.6287981328161, -831.9711155532062, -575.0004406141442, -347.306914361141, -836.1272424095336, -571.8581709398628, -384.79443979924025, -926.2503976020224, -125.10212967290526, -1009.0892171956727, -998.2641216810283, -346.5900155770292, -51.88496433826933, -684.8043696306044, -468.74629755215125, -1041.0340697467304, -33.66928878547246, -116.89016824985072, -782.8158059644553, -1014.4822771956073, -1044.8014393719577, -1204.3674816462415, -173.02354478057066, -101.66795191551047, -411.4123129721761, -362.6256642363191, -1198.9235424213384, -977.3764841673328, -884.5580827394587, -115.0177184857137, -608.1536218920756, -378.94883813445244, -750.5645453223085, -1029.6250768138016, -609.8312273331907, -792.8695961389836]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27949164460277454, "mean_inference_ms": 0.8918099517428172, "mean_action_processing_ms": 0.15794027385156006, "mean_env_wait_ms": 1.556079082062039, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005606651306152344, "StateBufferConnector_ms": 0.004040241241455078, "ViewRequirementAgentConnector_ms": 0.09921932220458984}, "num_episodes": 31, "episode_return_max": -33.66928878547246, "episode_return_min": -1311.0128632648332, "episode_return_mean": -718.3927681017501, "episodes_this_iter": 31}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 272.0933130681539, "num_env_steps_trained_throughput_per_sec": 272.0933130681539, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 14896.602, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14896.525, "sample_time_ms": 2404.518, "learn_time_ms": 12475.719, "learn_throughput": 320.623, "synch_weights_time_ms": 15.458}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "92003_00008", "date": "2024-08-03_05-35-58", "timestamp": 1722643558, "time_this_iter_s": 14.708786725997925, "time_total_s": 282.2628171443939, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12eb3130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 282.2628171443939, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 13.099999999999998, "ram_util_percent": 19.199999999999996}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 128.74251361489297, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 5.326020139455795, "policy_loss": -0.008988274382621361, "vf_loss": 5.330943805724383, "vf_explained_var": 0.9327231949816147, "kl": 0.011427325174099697, "entropy": 1.7204777717590332, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -31.79373210302712, "episode_reward_min": -1287.113409897258, "episode_reward_mean": -742.069317121658, "episode_len_mean": 137.62, "episode_media": {}, "episodes_timesteps_total": 13762, "policy_reward_min": {"policy_0": -1287.113409897258}, "policy_reward_max": {"policy_0": -31.79373210302712}, "policy_reward_mean": {"policy_0": -742.069317121658}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-694.0794776869141, -953.2343533118176, -934.4593223224523, -256.1180615892738, -598.0053875633623, -899.2442060999442, -1242.4235922008825, -1025.7875350909455, -436.9013945431882, -427.95320280649645, -727.1891180103997, -862.5233646718843, -750.1424020902175, -1233.428399817734, -487.0512008731888, -354.70252686797005, -171.88468135619516, -532.8555772736604, -1189.9935820608048, -971.5624112630945, -1055.2214652613914, -367.76760065535086, -945.2064938985926, -855.7466667153701, -1051.8477082052877, -554.8383098771673, -932.0225826403605, -313.4958173680102, -813.9330395186024, -713.2520166890952, -1197.3508968286008, -975.4367097581221, -789.3373262735412, -669.7516088752732, -780.4823387457566, -1156.8437502099662, -882.6287981328161, -831.9711155532062, -575.0004406141442, -347.306914361141, -836.1272424095336, -571.8581709398628, -384.79443979924025, -926.2503976020224, -125.10212967290526, -1009.0892171956727, -998.2641216810283, -346.5900155770292, -51.88496433826933, -684.8043696306044, -468.74629755215125, -1041.0340697467304, -33.66928878547246, -116.89016824985072, -782.8158059644553, -1014.4822771956073, -1044.8014393719577, -1204.3674816462415, -173.02354478057066, -101.66795191551047, -411.4123129721761, -362.6256642363191, -1198.9235424213384, -977.3764841673328, -884.5580827394587, -115.0177184857137, -608.1536218920756, -378.94883813445244, -750.5645453223085, -1029.6250768138016, -609.8312273331907, -792.8695961389836, -501.0513295521149, -653.2425216077387, -1055.921767151059, -407.7610579287831, -710.8539448126559, -694.6538218618625, -1163.3165014878657, -626.9070049042066, -683.9276407734397, -876.4558547811007, -510.86116754228505, -1183.3598665657928, -1066.8436795134762, -803.4572753053789, -730.157523931684, -560.9000380006622, -1071.522858822641, -1182.420290010151, -976.9103475914742, -655.3820489673185, -1088.8244271253704, -1051.024801433195, -1130.2879037492532, -31.79373210302712, -1287.113409897258, -1123.7569240297594, -847.5118234983047, -935.5606468238516], "episode_lengths": [150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 129, 96, 86, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 116, 150, 150, 150, 150, 72, 150, 150, 104, 57, 150, 150, 150, 47, 75, 150, 150, 150, 150, 62, 63, 109, 100, 150, 150, 150, 76, 150, 109, 150, 150, 131, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 150, 150], "policy_policy_0_reward": [-694.0794776869141, -953.2343533118176, -934.4593223224523, -256.1180615892738, -598.0053875633623, -899.2442060999442, -1242.4235922008825, -1025.7875350909455, -436.9013945431882, -427.95320280649645, -727.1891180103997, -862.5233646718843, -750.1424020902175, -1233.428399817734, -487.0512008731888, -354.70252686797005, -171.88468135619516, -532.8555772736604, -1189.9935820608048, -971.5624112630945, -1055.2214652613914, -367.76760065535086, -945.2064938985926, -855.7466667153701, -1051.8477082052877, -554.8383098771673, -932.0225826403605, -313.4958173680102, -813.9330395186024, -713.2520166890952, -1197.3508968286008, -975.4367097581221, -789.3373262735412, -669.7516088752732, -780.4823387457566, -1156.8437502099662, -882.6287981328161, -831.9711155532062, -575.0004406141442, -347.306914361141, -836.1272424095336, -571.8581709398628, -384.79443979924025, -926.2503976020224, -125.10212967290526, -1009.0892171956727, -998.2641216810283, -346.5900155770292, -51.88496433826933, -684.8043696306044, -468.74629755215125, -1041.0340697467304, -33.66928878547246, -116.89016824985072, -782.8158059644553, -1014.4822771956073, -1044.8014393719577, -1204.3674816462415, -173.02354478057066, -101.66795191551047, -411.4123129721761, -362.6256642363191, -1198.9235424213384, -977.3764841673328, -884.5580827394587, -115.0177184857137, -608.1536218920756, -378.94883813445244, -750.5645453223085, -1029.6250768138016, -609.8312273331907, -792.8695961389836, -501.0513295521149, -653.2425216077387, -1055.921767151059, -407.7610579287831, -710.8539448126559, -694.6538218618625, -1163.3165014878657, -626.9070049042066, -683.9276407734397, -876.4558547811007, -510.86116754228505, -1183.3598665657928, -1066.8436795134762, -803.4572753053789, -730.157523931684, -560.9000380006622, -1071.522858822641, -1182.420290010151, -976.9103475914742, -655.3820489673185, -1088.8244271253704, -1051.024801433195, -1130.2879037492532, -31.79373210302712, -1287.113409897258, -1123.7569240297594, -847.5118234983047, -935.5606468238516]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27937508123882615, "mean_inference_ms": 0.8909719997534046, "mean_action_processing_ms": 0.15788615371530884, "mean_env_wait_ms": 1.5577289195070194, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005273580551147461, "StateBufferConnector_ms": 0.003936290740966797, "ViewRequirementAgentConnector_ms": 0.0977780818939209}, "num_episodes": 28, "episode_return_max": -31.79373210302712, "episode_return_min": -1287.113409897258, "episode_return_mean": -742.069317121658, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 290.626772383443, "num_env_steps_trained_throughput_per_sec": 290.626772383443, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 14715.921, "restore_workers_time_ms": 0.029, "training_step_time_ms": 14715.839, "sample_time_ms": 2408.229, "learn_time_ms": 12290.96, "learn_throughput": 325.442, "synch_weights_time_ms": 15.803}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "92003_00008", "date": "2024-08-03_05-36-12", "timestamp": 1722643572, "time_this_iter_s": 13.771793842315674, "time_total_s": 296.0346109867096, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12eb3010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 296.0346109867096, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 13.315789473684209, "ram_util_percent": 19.2}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 149.1994640827179, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 5.23636069993178, "policy_loss": -0.015547192863596137, "vf_loss": 5.246394965300957, "vf_explained_var": 0.9514808900654316, "kl": 0.013998160226280278, "entropy": 1.5736285833021004, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -27.998637087044436, "episode_reward_min": -1287.113409897258, "episode_reward_mean": -737.5515835138822, "episode_len_mean": 135.3, "episode_media": {}, "episodes_timesteps_total": 13530, "policy_reward_min": {"policy_0": -1287.113409897258}, "policy_reward_max": {"policy_0": -27.998637087044436}, "policy_reward_mean": {"policy_0": -737.5515835138822}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-713.2520166890952, -1197.3508968286008, -975.4367097581221, -789.3373262735412, -669.7516088752732, -780.4823387457566, -1156.8437502099662, -882.6287981328161, -831.9711155532062, -575.0004406141442, -347.306914361141, -836.1272424095336, -571.8581709398628, -384.79443979924025, -926.2503976020224, -125.10212967290526, -1009.0892171956727, -998.2641216810283, -346.5900155770292, -51.88496433826933, -684.8043696306044, -468.74629755215125, -1041.0340697467304, -33.66928878547246, -116.89016824985072, -782.8158059644553, -1014.4822771956073, -1044.8014393719577, -1204.3674816462415, -173.02354478057066, -101.66795191551047, -411.4123129721761, -362.6256642363191, -1198.9235424213384, -977.3764841673328, -884.5580827394587, -115.0177184857137, -608.1536218920756, -378.94883813445244, -750.5645453223085, -1029.6250768138016, -609.8312273331907, -792.8695961389836, -501.0513295521149, -653.2425216077387, -1055.921767151059, -407.7610579287831, -710.8539448126559, -694.6538218618625, -1163.3165014878657, -626.9070049042066, -683.9276407734397, -876.4558547811007, -510.86116754228505, -1183.3598665657928, -1066.8436795134762, -803.4572753053789, -730.157523931684, -560.9000380006622, -1071.522858822641, -1182.420290010151, -976.9103475914742, -655.3820489673185, -1088.8244271253704, -1051.024801433195, -1130.2879037492532, -31.79373210302712, -1287.113409897258, -1123.7569240297594, -847.5118234983047, -935.5606468238516, -536.4222470824648, -582.4730845676497, -847.6767945863129, -821.2247626912269, -1004.5479313525386, -1040.5689228288563, -1027.2090596297508, -1190.2283270019527, -979.563717110118, -1083.4742162151551, -144.7491258678799, -163.81794644691834, -1073.3664205622435, -978.353905771746, -27.998637087044436, -1175.300978278322, -74.61392894797486, -1109.7952968423115, -628.7229948355877, -1092.3306686905744, -746.8506766183207, -1211.2614263967166, -183.26719108837128, -346.33163957114925, -519.7332155466831, -280.08914951683687, -460.6843857210193, -832.7430376103786, -1024.4464323968796], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 116, 150, 150, 150, 150, 72, 150, 150, 104, 57, 150, 150, 150, 47, 75, 150, 150, 150, 150, 62, 63, 109, 100, 150, 150, 150, 76, 150, 109, 150, 150, 131, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 73, 150, 150, 50, 150, 73, 150, 150, 150, 150, 150, 89, 150, 150, 119, 119, 150, 150], "policy_policy_0_reward": [-713.2520166890952, -1197.3508968286008, -975.4367097581221, -789.3373262735412, -669.7516088752732, -780.4823387457566, -1156.8437502099662, -882.6287981328161, -831.9711155532062, -575.0004406141442, -347.306914361141, -836.1272424095336, -571.8581709398628, -384.79443979924025, -926.2503976020224, -125.10212967290526, -1009.0892171956727, -998.2641216810283, -346.5900155770292, -51.88496433826933, -684.8043696306044, -468.74629755215125, -1041.0340697467304, -33.66928878547246, -116.89016824985072, -782.8158059644553, -1014.4822771956073, -1044.8014393719577, -1204.3674816462415, -173.02354478057066, -101.66795191551047, -411.4123129721761, -362.6256642363191, -1198.9235424213384, -977.3764841673328, -884.5580827394587, -115.0177184857137, -608.1536218920756, -378.94883813445244, -750.5645453223085, -1029.6250768138016, -609.8312273331907, -792.8695961389836, -501.0513295521149, -653.2425216077387, -1055.921767151059, -407.7610579287831, -710.8539448126559, -694.6538218618625, -1163.3165014878657, -626.9070049042066, -683.9276407734397, -876.4558547811007, -510.86116754228505, -1183.3598665657928, -1066.8436795134762, -803.4572753053789, -730.157523931684, -560.9000380006622, -1071.522858822641, -1182.420290010151, -976.9103475914742, -655.3820489673185, -1088.8244271253704, -1051.024801433195, -1130.2879037492532, -31.79373210302712, -1287.113409897258, -1123.7569240297594, -847.5118234983047, -935.5606468238516, -536.4222470824648, -582.4730845676497, -847.6767945863129, -821.2247626912269, -1004.5479313525386, -1040.5689228288563, -1027.2090596297508, -1190.2283270019527, -979.563717110118, -1083.4742162151551, -144.7491258678799, -163.81794644691834, -1073.3664205622435, -978.353905771746, -27.998637087044436, -1175.300978278322, -74.61392894797486, -1109.7952968423115, -628.7229948355877, -1092.3306686905744, -746.8506766183207, -1211.2614263967166, -183.26719108837128, -346.33163957114925, -519.7332155466831, -280.08914951683687, -460.6843857210193, -832.7430376103786, -1024.4464323968796]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27935534164645764, "mean_inference_ms": 0.8901325793011263, "mean_action_processing_ms": 0.157827718693387, "mean_env_wait_ms": 1.559171215987148, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0052073001861572266, "StateBufferConnector_ms": 0.0039730072021484375, "ViewRequirementAgentConnector_ms": 0.09882664680480957}, "num_episodes": 29, "episode_return_max": -27.998637087044436, "episode_return_min": -1287.113409897258, "episode_return_mean": -737.5515835138822, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 265.6463100061867, "num_env_steps_trained_throughput_per_sec": 265.6463100061867, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 14735.709, "restore_workers_time_ms": 0.03, "training_step_time_ms": 14735.625, "sample_time_ms": 2418.871, "learn_time_ms": 12299.871, "learn_throughput": 325.207, "synch_weights_time_ms": 16.045}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "92003_00008", "date": "2024-08-03_05-36-27", "timestamp": 1722643587, "time_this_iter_s": 15.064546346664429, "time_total_s": 311.099157333374, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12fda5f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 311.099157333374, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 12.909090909090908, "ram_util_percent": 19.204545454545453}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 180.0698210855325, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.2312311622003715, "policy_loss": -0.00976145469127611, "vf_loss": 4.235403330127398, "vf_explained_var": 0.9492337016388774, "kl": 0.013853046292782308, "entropy": 1.4238200002660355, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -18.402198504276416, "episode_reward_min": -1287.113409897258, "episode_reward_mean": -731.7782900747039, "episode_len_mean": 136.89, "episode_media": {}, "episodes_timesteps_total": 13689, "policy_reward_min": {"policy_0": -1287.113409897258}, "policy_reward_max": {"policy_0": -18.402198504276416}, "policy_reward_mean": {"policy_0": -731.7782900747039}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-101.66795191551047, -411.4123129721761, -362.6256642363191, -1198.9235424213384, -977.3764841673328, -884.5580827394587, -115.0177184857137, -608.1536218920756, -378.94883813445244, -750.5645453223085, -1029.6250768138016, -609.8312273331907, -792.8695961389836, -501.0513295521149, -653.2425216077387, -1055.921767151059, -407.7610579287831, -710.8539448126559, -694.6538218618625, -1163.3165014878657, -626.9070049042066, -683.9276407734397, -876.4558547811007, -510.86116754228505, -1183.3598665657928, -1066.8436795134762, -803.4572753053789, -730.157523931684, -560.9000380006622, -1071.522858822641, -1182.420290010151, -976.9103475914742, -655.3820489673185, -1088.8244271253704, -1051.024801433195, -1130.2879037492532, -31.79373210302712, -1287.113409897258, -1123.7569240297594, -847.5118234983047, -935.5606468238516, -536.4222470824648, -582.4730845676497, -847.6767945863129, -821.2247626912269, -1004.5479313525386, -1040.5689228288563, -1027.2090596297508, -1190.2283270019527, -979.563717110118, -1083.4742162151551, -144.7491258678799, -163.81794644691834, -1073.3664205622435, -978.353905771746, -27.998637087044436, -1175.300978278322, -74.61392894797486, -1109.7952968423115, -628.7229948355877, -1092.3306686905744, -746.8506766183207, -1211.2614263967166, -183.26719108837128, -346.33163957114925, -519.7332155466831, -280.08914951683687, -460.6843857210193, -832.7430376103786, -1024.4464323968796, -915.8976406031719, -855.5938290560458, -270.2604429188587, -727.4591657768809, -595.1522901568968, -603.9412935542953, -456.1703317449207, -791.3711625755144, -366.0024970631106, -992.1821972944692, -779.039613156584, -884.0673227131248, -684.4811549539422, -18.402198504276416, -643.1257230569961, -670.0598115947205, -984.597089330671, -909.2619751006016, -195.7186137306321, -652.6941236532222, -403.1650979101246, -725.2531600712558, -909.3253383126878, -933.9863004169304, -917.5593368083014, -884.3027517751572, -67.32672219427228, -842.0853547369892, -494.8781214824656, -983.2673540159151], "episode_lengths": [63, 109, 100, 150, 150, 150, 76, 150, 109, 150, 150, 131, 150, 150, 150, 150, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 73, 150, 150, 50, 150, 73, 150, 150, 150, 150, 150, 89, 150, 150, 119, 119, 150, 150, 150, 150, 101, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 50, 130, 150, 150, 150, 102, 150, 99, 150, 150, 150, 150, 150, 61, 150, 150, 150], "policy_policy_0_reward": [-101.66795191551047, -411.4123129721761, -362.6256642363191, -1198.9235424213384, -977.3764841673328, -884.5580827394587, -115.0177184857137, -608.1536218920756, -378.94883813445244, -750.5645453223085, -1029.6250768138016, -609.8312273331907, -792.8695961389836, -501.0513295521149, -653.2425216077387, -1055.921767151059, -407.7610579287831, -710.8539448126559, -694.6538218618625, -1163.3165014878657, -626.9070049042066, -683.9276407734397, -876.4558547811007, -510.86116754228505, -1183.3598665657928, -1066.8436795134762, -803.4572753053789, -730.157523931684, -560.9000380006622, -1071.522858822641, -1182.420290010151, -976.9103475914742, -655.3820489673185, -1088.8244271253704, -1051.024801433195, -1130.2879037492532, -31.79373210302712, -1287.113409897258, -1123.7569240297594, -847.5118234983047, -935.5606468238516, -536.4222470824648, -582.4730845676497, -847.6767945863129, -821.2247626912269, -1004.5479313525386, -1040.5689228288563, -1027.2090596297508, -1190.2283270019527, -979.563717110118, -1083.4742162151551, -144.7491258678799, -163.81794644691834, -1073.3664205622435, -978.353905771746, -27.998637087044436, -1175.300978278322, -74.61392894797486, -1109.7952968423115, -628.7229948355877, -1092.3306686905744, -746.8506766183207, -1211.2614263967166, -183.26719108837128, -346.33163957114925, -519.7332155466831, -280.08914951683687, -460.6843857210193, -832.7430376103786, -1024.4464323968796, -915.8976406031719, -855.5938290560458, -270.2604429188587, -727.4591657768809, -595.1522901568968, -603.9412935542953, -456.1703317449207, -791.3711625755144, -366.0024970631106, -992.1821972944692, -779.039613156584, -884.0673227131248, -684.4811549539422, -18.402198504276416, -643.1257230569961, -670.0598115947205, -984.597089330671, -909.2619751006016, -195.7186137306321, -652.6941236532222, -403.1650979101246, -725.2531600712558, -909.3253383126878, -933.9863004169304, -917.5593368083014, -884.3027517751572, -67.32672219427228, -842.0853547369892, -494.8781214824656, -983.2673540159151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2793840997343074, "mean_inference_ms": 0.8894779967264433, "mean_action_processing_ms": 0.15783699308682053, "mean_env_wait_ms": 1.5605723345614069, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005171775817871094, "StateBufferConnector_ms": 0.0040760040283203125, "ViewRequirementAgentConnector_ms": 0.10094904899597168}, "num_episodes": 30, "episode_return_max": -18.402198504276416, "episode_return_min": -1287.113409897258, "episode_return_mean": -731.7782900747039, "episodes_this_iter": 30}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 281.3974415889363, "num_env_steps_trained_throughput_per_sec": 281.3974415889363, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 14692.217, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14692.135, "sample_time_ms": 2411.597, "learn_time_ms": 12263.835, "learn_throughput": 326.162, "synch_weights_time_ms": 15.874}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "92003_00008", "date": "2024-08-03_05-36-41", "timestamp": 1722643601, "time_this_iter_s": 14.22045087814331, "time_total_s": 325.31960821151733, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12eb0280>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 325.31960821151733, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 10.525000000000002, "ram_util_percent": 16.680000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 143.10769279201824, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 5.051096288363139, "policy_loss": -0.013476551218385186, "vf_loss": 5.059291095783313, "vf_explained_var": 0.9514910961811741, "kl": 0.013582313002886318, "entropy": 1.5943111726393302, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -18.402198504276416, "episode_reward_min": -1506.206319775008, "episode_reward_mean": -757.1054505389411, "episode_len_mean": 137.6, "episode_media": {}, "episodes_timesteps_total": 13760, "policy_reward_min": {"policy_0": -1506.206319775008}, "policy_reward_max": {"policy_0": -18.402198504276416}, "policy_reward_mean": {"policy_0": -757.1054505389411}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-560.9000380006622, -1071.522858822641, -1182.420290010151, -976.9103475914742, -655.3820489673185, -1088.8244271253704, -1051.024801433195, -1130.2879037492532, -31.79373210302712, -1287.113409897258, -1123.7569240297594, -847.5118234983047, -935.5606468238516, -536.4222470824648, -582.4730845676497, -847.6767945863129, -821.2247626912269, -1004.5479313525386, -1040.5689228288563, -1027.2090596297508, -1190.2283270019527, -979.563717110118, -1083.4742162151551, -144.7491258678799, -163.81794644691834, -1073.3664205622435, -978.353905771746, -27.998637087044436, -1175.300978278322, -74.61392894797486, -1109.7952968423115, -628.7229948355877, -1092.3306686905744, -746.8506766183207, -1211.2614263967166, -183.26719108837128, -346.33163957114925, -519.7332155466831, -280.08914951683687, -460.6843857210193, -832.7430376103786, -1024.4464323968796, -915.8976406031719, -855.5938290560458, -270.2604429188587, -727.4591657768809, -595.1522901568968, -603.9412935542953, -456.1703317449207, -791.3711625755144, -366.0024970631106, -992.1821972944692, -779.039613156584, -884.0673227131248, -684.4811549539422, -18.402198504276416, -643.1257230569961, -670.0598115947205, -984.597089330671, -909.2619751006016, -195.7186137306321, -652.6941236532222, -403.1650979101246, -725.2531600712558, -909.3253383126878, -933.9863004169304, -917.5593368083014, -884.3027517751572, -67.32672219427228, -842.0853547369892, -494.8781214824656, -983.2673540159151, -987.2790940714884, -506.938690019191, -862.6409669048977, -455.7394045860651, -631.6679589504059, -658.4995603790784, -526.9307260716106, -940.3271407989035, -1288.8528659584465, -1074.1933033584128, -111.32951103091547, -122.8239398760865, -803.0254559867016, -1196.257756227403, -680.9719778679863, -902.9989154048968, -1506.206319775008, -1183.3878471479957, -687.7281843460394, -1054.1927569908346, -383.3494317955808, -322.62041865928705, -314.2284700364548, -1290.125049830972, -1020.9834838331265, -1025.5212827398582, -1156.9077237267334, -727.3334303414491], "episode_lengths": [121, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 73, 150, 150, 50, 150, 73, 150, 150, 150, 150, 150, 89, 150, 150, 119, 119, 150, 150, 150, 150, 101, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 50, 130, 150, 150, 150, 102, 150, 99, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 57, 150, 150, 150, 150, 150, 150, 150, 150, 141, 95, 127, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-560.9000380006622, -1071.522858822641, -1182.420290010151, -976.9103475914742, -655.3820489673185, -1088.8244271253704, -1051.024801433195, -1130.2879037492532, -31.79373210302712, -1287.113409897258, -1123.7569240297594, -847.5118234983047, -935.5606468238516, -536.4222470824648, -582.4730845676497, -847.6767945863129, -821.2247626912269, -1004.5479313525386, -1040.5689228288563, -1027.2090596297508, -1190.2283270019527, -979.563717110118, -1083.4742162151551, -144.7491258678799, -163.81794644691834, -1073.3664205622435, -978.353905771746, -27.998637087044436, -1175.300978278322, -74.61392894797486, -1109.7952968423115, -628.7229948355877, -1092.3306686905744, -746.8506766183207, -1211.2614263967166, -183.26719108837128, -346.33163957114925, -519.7332155466831, -280.08914951683687, -460.6843857210193, -832.7430376103786, -1024.4464323968796, -915.8976406031719, -855.5938290560458, -270.2604429188587, -727.4591657768809, -595.1522901568968, -603.9412935542953, -456.1703317449207, -791.3711625755144, -366.0024970631106, -992.1821972944692, -779.039613156584, -884.0673227131248, -684.4811549539422, -18.402198504276416, -643.1257230569961, -670.0598115947205, -984.597089330671, -909.2619751006016, -195.7186137306321, -652.6941236532222, -403.1650979101246, -725.2531600712558, -909.3253383126878, -933.9863004169304, -917.5593368083014, -884.3027517751572, -67.32672219427228, -842.0853547369892, -494.8781214824656, -983.2673540159151, -987.2790940714884, -506.938690019191, -862.6409669048977, -455.7394045860651, -631.6679589504059, -658.4995603790784, -526.9307260716106, -940.3271407989035, -1288.8528659584465, -1074.1933033584128, -111.32951103091547, -122.8239398760865, -803.0254559867016, -1196.257756227403, -680.9719778679863, -902.9989154048968, -1506.206319775008, -1183.3878471479957, -687.7281843460394, -1054.1927569908346, -383.3494317955808, -322.62041865928705, -314.2284700364548, -1290.125049830972, -1020.9834838331265, -1025.5212827398582, -1156.9077237267334, -727.3334303414491]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2790529176710478, "mean_inference_ms": 0.8881315968618076, "mean_action_processing_ms": 0.15754813129812675, "mean_env_wait_ms": 1.5605158101667433, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005082845687866211, "StateBufferConnector_ms": 0.004003763198852539, "ViewRequirementAgentConnector_ms": 0.09860658645629883}, "num_episodes": 28, "episode_return_max": -18.402198504276416, "episode_return_min": -1506.206319775008, "episode_return_mean": -757.1054505389411, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 280.1169934625573, "num_env_steps_trained_throughput_per_sec": 280.1169934625573, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 14628.375, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14628.294, "sample_time_ms": 2410.478, "learn_time_ms": 12201.024, "learn_throughput": 327.841, "synch_weights_time_ms": 15.968}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "92003_00008", "date": "2024-08-03_05-36-56", "timestamp": 1722643616, "time_this_iter_s": 14.286147832870483, "time_total_s": 339.6057560443878, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12ef11b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 339.6057560443878, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 8.870000000000001, "ram_util_percent": 15.600000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 166.94726048310596, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.816398156434298, "policy_loss": -0.012278724286685853, "vf_loss": 4.823021079103152, "vf_explained_var": 0.9615493878101309, "kl": 0.014492701579865772, "entropy": 1.6811304565519094, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -15.955676231387685, "episode_reward_min": -1506.206319775008, "episode_reward_mean": -739.4069419129186, "episode_len_mean": 139.06, "episode_media": {}, "episodes_timesteps_total": 13906, "policy_reward_min": {"policy_0": -1506.206319775008}, "policy_reward_max": {"policy_0": -15.955676231387685}, "policy_reward_mean": {"policy_0": -739.4069419129186}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-74.61392894797486, -1109.7952968423115, -628.7229948355877, -1092.3306686905744, -746.8506766183207, -1211.2614263967166, -183.26719108837128, -346.33163957114925, -519.7332155466831, -280.08914951683687, -460.6843857210193, -832.7430376103786, -1024.4464323968796, -915.8976406031719, -855.5938290560458, -270.2604429188587, -727.4591657768809, -595.1522901568968, -603.9412935542953, -456.1703317449207, -791.3711625755144, -366.0024970631106, -992.1821972944692, -779.039613156584, -884.0673227131248, -684.4811549539422, -18.402198504276416, -643.1257230569961, -670.0598115947205, -984.597089330671, -909.2619751006016, -195.7186137306321, -652.6941236532222, -403.1650979101246, -725.2531600712558, -909.3253383126878, -933.9863004169304, -917.5593368083014, -884.3027517751572, -67.32672219427228, -842.0853547369892, -494.8781214824656, -983.2673540159151, -987.2790940714884, -506.938690019191, -862.6409669048977, -455.7394045860651, -631.6679589504059, -658.4995603790784, -526.9307260716106, -940.3271407989035, -1288.8528659584465, -1074.1933033584128, -111.32951103091547, -122.8239398760865, -803.0254559867016, -1196.257756227403, -680.9719778679863, -902.9989154048968, -1506.206319775008, -1183.3878471479957, -687.7281843460394, -1054.1927569908346, -383.3494317955808, -322.62041865928705, -314.2284700364548, -1290.125049830972, -1020.9834838331265, -1025.5212827398582, -1156.9077237267334, -727.3334303414491, -276.9096562394859, -811.8683063840044, -228.89077652904425, -929.6321353877046, -15.955676231387685, -892.8065599101216, -720.6460370391441, -385.90665689530334, -1014.1757715835518, -764.3393474855757, -572.1521858927181, -1061.6555999184934, -1171.981131673439, -1128.4745909680344, -765.4603622825404, -1087.0465249751303, -721.7766904475574, -504.61560547837644, -1014.4034822710146, -650.5659193749198, -927.9330001912878, -810.129341493352, -1216.4525633455557, -1294.9827851340326, -988.1812337955314, -769.2575875176412, -1054.5229873636417, -73.87236879123598, -995.5395819303491], "episode_lengths": [73, 150, 150, 150, 150, 150, 89, 150, 150, 119, 119, 150, 150, 150, 150, 101, 150, 150, 139, 150, 150, 150, 150, 150, 150, 150, 50, 130, 150, 150, 150, 102, 150, 99, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 57, 150, 150, 150, 150, 150, 150, 150, 150, 141, 95, 127, 150, 150, 150, 150, 150, 150, 150, 96, 150, 42, 150, 144, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150], "policy_policy_0_reward": [-74.61392894797486, -1109.7952968423115, -628.7229948355877, -1092.3306686905744, -746.8506766183207, -1211.2614263967166, -183.26719108837128, -346.33163957114925, -519.7332155466831, -280.08914951683687, -460.6843857210193, -832.7430376103786, -1024.4464323968796, -915.8976406031719, -855.5938290560458, -270.2604429188587, -727.4591657768809, -595.1522901568968, -603.9412935542953, -456.1703317449207, -791.3711625755144, -366.0024970631106, -992.1821972944692, -779.039613156584, -884.0673227131248, -684.4811549539422, -18.402198504276416, -643.1257230569961, -670.0598115947205, -984.597089330671, -909.2619751006016, -195.7186137306321, -652.6941236532222, -403.1650979101246, -725.2531600712558, -909.3253383126878, -933.9863004169304, -917.5593368083014, -884.3027517751572, -67.32672219427228, -842.0853547369892, -494.8781214824656, -983.2673540159151, -987.2790940714884, -506.938690019191, -862.6409669048977, -455.7394045860651, -631.6679589504059, -658.4995603790784, -526.9307260716106, -940.3271407989035, -1288.8528659584465, -1074.1933033584128, -111.32951103091547, -122.8239398760865, -803.0254559867016, -1196.257756227403, -680.9719778679863, -902.9989154048968, -1506.206319775008, -1183.3878471479957, -687.7281843460394, -1054.1927569908346, -383.3494317955808, -322.62041865928705, -314.2284700364548, -1290.125049830972, -1020.9834838331265, -1025.5212827398582, -1156.9077237267334, -727.3334303414491, -276.9096562394859, -811.8683063840044, -228.89077652904425, -929.6321353877046, -15.955676231387685, -892.8065599101216, -720.6460370391441, -385.90665689530334, -1014.1757715835518, -764.3393474855757, -572.1521858927181, -1061.6555999184934, -1171.981131673439, -1128.4745909680344, -765.4603622825404, -1087.0465249751303, -721.7766904475574, -504.61560547837644, -1014.4034822710146, -650.5659193749198, -927.9330001912878, -810.129341493352, -1216.4525633455557, -1294.9827851340326, -988.1812337955314, -769.2575875176412, -1054.5229873636417, -73.87236879123598, -995.5395819303491]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.2790985814981138, "mean_inference_ms": 0.8870797951690302, "mean_action_processing_ms": 0.15760415097346178, "mean_env_wait_ms": 1.561418233793732, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.005067348480224609, "StateBufferConnector_ms": 0.004019260406494141, "ViewRequirementAgentConnector_ms": 0.09925317764282227}, "num_episodes": 29, "episode_return_max": -15.955676231387685, "episode_return_min": -1506.206319775008, "episode_return_mean": -739.4069419129186, "episodes_this_iter": 29}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 273.4887313562783, "num_env_steps_trained_throughput_per_sec": 273.4887313562783, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 14569.757, "restore_workers_time_ms": 0.028, "training_step_time_ms": 14569.677, "sample_time_ms": 2418.858, "learn_time_ms": 12134.048, "learn_throughput": 329.651, "synch_weights_time_ms": 15.951}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "92003_00008", "date": "2024-08-03_05-37-10", "timestamp": 1722643630, "time_this_iter_s": 14.633074522018433, "time_total_s": 354.23883056640625, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12ef1d80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 354.23883056640625, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 8.819047619047618, "ram_util_percent": 15.600000000000003}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 193.47010037700335, "cur_kl_coeff": 0.5062499999999999, "cur_lr": 0.0010000000000000005, "total_loss": 4.664627876132727, "policy_loss": -0.01801356625316354, "vf_loss": 4.6758437221248945, "vf_explained_var": 0.9694805443286896, "kl": 0.016233695606479182, "entropy": 1.420590161283811, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -15.955676231387685, "episode_reward_min": -1506.206319775008, "episode_reward_mean": -751.1331669532644, "episode_len_mean": 139.47, "episode_media": {}, "episodes_timesteps_total": 13947, "policy_reward_min": {"policy_0": -1506.206319775008}, "policy_reward_max": {"policy_0": -15.955676231387685}, "policy_reward_mean": {"policy_0": -751.1331669532644}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-670.0598115947205, -984.597089330671, -909.2619751006016, -195.7186137306321, -652.6941236532222, -403.1650979101246, -725.2531600712558, -909.3253383126878, -933.9863004169304, -917.5593368083014, -884.3027517751572, -67.32672219427228, -842.0853547369892, -494.8781214824656, -983.2673540159151, -987.2790940714884, -506.938690019191, -862.6409669048977, -455.7394045860651, -631.6679589504059, -658.4995603790784, -526.9307260716106, -940.3271407989035, -1288.8528659584465, -1074.1933033584128, -111.32951103091547, -122.8239398760865, -803.0254559867016, -1196.257756227403, -680.9719778679863, -902.9989154048968, -1506.206319775008, -1183.3878471479957, -687.7281843460394, -1054.1927569908346, -383.3494317955808, -322.62041865928705, -314.2284700364548, -1290.125049830972, -1020.9834838331265, -1025.5212827398582, -1156.9077237267334, -727.3334303414491, -276.9096562394859, -811.8683063840044, -228.89077652904425, -929.6321353877046, -15.955676231387685, -892.8065599101216, -720.6460370391441, -385.90665689530334, -1014.1757715835518, -764.3393474855757, -572.1521858927181, -1061.6555999184934, -1171.981131673439, -1128.4745909680344, -765.4603622825404, -1087.0465249751303, -721.7766904475574, -504.61560547837644, -1014.4034822710146, -650.5659193749198, -927.9330001912878, -810.129341493352, -1216.4525633455557, -1294.9827851340326, -988.1812337955314, -769.2575875176412, -1054.5229873636417, -73.87236879123598, -995.5395819303491, -429.86926160457847, -113.8574762147575, -1140.7612555270698, -287.66852235721245, -885.0545808123438, -629.0848347334021, -635.2167855248011, -688.6514564183584, -980.8290655363468, -736.9562909745584, -967.814193985323, -1022.1527065679144, -751.992749680416, -1189.4053387415934, -717.3292626086492, -477.17748752899524, -926.6482628376085, -935.6439137354512, -103.36281933262093, -197.81682407120684, -1201.7326903573748, -1242.8104851729115, -352.6450005313551, -233.76538395673302, -256.04870758592887, -748.9667816804198, -592.0835399491372, -821.293732919444], "episode_lengths": [150, 150, 150, 102, 150, 99, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 57, 150, 150, 150, 150, 150, 150, 150, 150, 141, 95, 127, 150, 150, 150, 150, 150, 150, 150, 96, 150, 42, 150, 144, 138, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 65, 92, 150, 150, 92, 114, 117, 150, 150, 150], "policy_policy_0_reward": [-670.0598115947205, -984.597089330671, -909.2619751006016, -195.7186137306321, -652.6941236532222, -403.1650979101246, -725.2531600712558, -909.3253383126878, -933.9863004169304, -917.5593368083014, -884.3027517751572, -67.32672219427228, -842.0853547369892, -494.8781214824656, -983.2673540159151, -987.2790940714884, -506.938690019191, -862.6409669048977, -455.7394045860651, -631.6679589504059, -658.4995603790784, -526.9307260716106, -940.3271407989035, -1288.8528659584465, -1074.1933033584128, -111.32951103091547, -122.8239398760865, -803.0254559867016, -1196.257756227403, -680.9719778679863, -902.9989154048968, -1506.206319775008, -1183.3878471479957, -687.7281843460394, -1054.1927569908346, -383.3494317955808, -322.62041865928705, -314.2284700364548, -1290.125049830972, -1020.9834838331265, -1025.5212827398582, -1156.9077237267334, -727.3334303414491, -276.9096562394859, -811.8683063840044, -228.89077652904425, -929.6321353877046, -15.955676231387685, -892.8065599101216, -720.6460370391441, -385.90665689530334, -1014.1757715835518, -764.3393474855757, -572.1521858927181, -1061.6555999184934, -1171.981131673439, -1128.4745909680344, -765.4603622825404, -1087.0465249751303, -721.7766904475574, -504.61560547837644, -1014.4034822710146, -650.5659193749198, -927.9330001912878, -810.129341493352, -1216.4525633455557, -1294.9827851340326, -988.1812337955314, -769.2575875176412, -1054.5229873636417, -73.87236879123598, -995.5395819303491, -429.86926160457847, -113.8574762147575, -1140.7612555270698, -287.66852235721245, -885.0545808123438, -629.0848347334021, -635.2167855248011, -688.6514564183584, -980.8290655363468, -736.9562909745584, -967.814193985323, -1022.1527065679144, -751.992749680416, -1189.4053387415934, -717.3292626086492, -477.17748752899524, -926.6482628376085, -935.6439137354512, -103.36281933262093, -197.81682407120684, -1201.7326903573748, -1242.8104851729115, -352.6450005313551, -233.76538395673302, -256.04870758592887, -748.9667816804198, -592.0835399491372, -821.293732919444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.27884653392723896, "mean_inference_ms": 0.8856645612314642, "mean_action_processing_ms": 0.15746261314827248, "mean_env_wait_ms": 1.5615429413688378, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.004899024963378906, "StateBufferConnector_ms": 0.003915071487426758, "ViewRequirementAgentConnector_ms": 0.09687614440917969}, "num_episodes": 28, "episode_return_max": -15.955676231387685, "episode_return_min": -1506.206319775008, "episode_return_mean": -751.1331669532644, "episodes_this_iter": 28}, "num_healthy_workers": 5, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 291.46753796681935, "num_env_steps_trained_throughput_per_sec": 291.46753796681935, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 14472.371, "restore_workers_time_ms": 0.027, "training_step_time_ms": 14472.292, "sample_time_ms": 2404.933, "learn_time_ms": 12050.713, "learn_throughput": 331.931, "synch_weights_time_ms": 15.835}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "92003_00008", "date": "2024-08-03_05-37-24", "timestamp": 1722643644, "time_this_iter_s": 13.731338262557983, "time_total_s": 367.97016882896423, "pid": 489379, "hostname": "mav-lab-invento", "node_ip": "10.21.139.236", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.95, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x735b12eb3d00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 5, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 367.97016882896423, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 8.844999999999999, "ram_util_percent": 15.600000000000003}}
