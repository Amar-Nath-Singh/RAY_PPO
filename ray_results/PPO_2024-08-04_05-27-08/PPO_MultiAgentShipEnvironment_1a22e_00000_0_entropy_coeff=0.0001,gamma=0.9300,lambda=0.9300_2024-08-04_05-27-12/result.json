{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.3805490529164672, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.331631994247436, "policy_loss": -0.0018514275827328675, "vf_loss": 9.33225532968839, "vf_explained_var": 0.04676192433883746, "kl": 0.006851615471214245, "entropy": 1.4223789927860102, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -26.925962808161678, "episode_reward_min": -1362.7642263246585, "episode_reward_mean": -584.6847807997776, "episode_len_mean": 114.70833333333333, "episode_media": {}, "episodes_timesteps_total": 2753, "policy_reward_min": {"policy_0": -1362.7642263246585}, "policy_reward_max": {"policy_0": -26.925962808161678}, "policy_reward_mean": {"policy_0": -584.6847807997776}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.37572699380866, -647.6047455424593, -186.94472153729066, -912.981218734388, -546.1424723584963, -250.6829092944998, -674.3030418490337, -86.09568047730708, -1362.7642263246585, -526.9398732954631, -622.4408238066375, -1353.357190468162, -196.02020395153733, -103.60376311617232, -844.0356948102652, -1081.298804481842, -897.7582374949247, -555.0242018107482, -758.0002171659173, -1003.4071068116938, -361.3145815016075, -26.925962808161678, -188.63831181293227, -806.7750227466565], "episode_lengths": [44, 150, 64, 150, 114, 72, 150, 71, 150, 108, 150, 150, 70, 52, 150, 150, 150, 112, 150, 150, 113, 43, 90, 150], "policy_policy_0_reward": [-39.37572699380866, -647.6047455424593, -186.94472153729066, -912.981218734388, -546.1424723584963, -250.6829092944998, -674.3030418490337, -86.09568047730708, -1362.7642263246585, -526.9398732954631, -622.4408238066375, -1353.357190468162, -196.02020395153733, -103.60376311617232, -844.0356948102652, -1081.298804481842, -897.7582374949247, -555.0242018107482, -758.0002171659173, -1003.4071068116938, -361.3145815016075, -26.925962808161678, -188.63831181293227, -806.7750227466565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553544943099082, "mean_inference_ms": 1.6342113996113206, "mean_action_processing_ms": 0.27649003296650104, "mean_env_wait_ms": 3.3518828087056605, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011909008026123047, "StateBufferConnector_ms": 0.008207559585571289, "ViewRequirementAgentConnector_ms": 0.18636882305145264}, "num_episodes": 24, "episode_return_max": -26.925962808161678, "episode_return_min": -1362.7642263246585, "episode_return_mean": -584.6847807997776, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.36309853874155, "num_env_steps_trained_throughput_per_sec": 312.36309853874155, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12805.621, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12805.545, "sample_time_ms": 1099.78, "learn_time_ms": 11633.941, "learn_throughput": 343.822, "synch_weights_time_ms": 71.057}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00000", "date": "2024-08-04_05-27-41", "timestamp": 1722729461, "time_this_iter_s": 12.81596851348877, "time_total_s": 12.81596851348877, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a1739c1f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.81596851348877, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.678947368421053, "ram_util_percent": 27.5}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.934189457260072, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.87472467770179, "policy_loss": -0.0078109607459433995, "vf_loss": 8.880554268757502, "vf_explained_var": 0.23766752816736697, "kl": 0.010635710115699722, "entropy": 1.457687042405208, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -9.492033267178217, "episode_reward_min": -1362.7642263246585, "episode_reward_mean": -694.3212919382131, "episode_len_mean": 123.42307692307692, "episode_media": {}, "episodes_timesteps_total": 6418, "policy_reward_min": {"policy_0": -1362.7642263246585}, "policy_reward_max": {"policy_0": -9.492033267178217}, "policy_reward_mean": {"policy_0": -694.3212919382131}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.37572699380866, -647.6047455424593, -186.94472153729066, -912.981218734388, -546.1424723584963, -250.6829092944998, -674.3030418490337, -86.09568047730708, -1362.7642263246585, -526.9398732954631, -622.4408238066375, -1353.357190468162, -196.02020395153733, -103.60376311617232, -844.0356948102652, -1081.298804481842, -897.7582374949247, -555.0242018107482, -758.0002171659173, -1003.4071068116938, -361.3145815016075, -26.925962808161678, -188.63831181293227, -806.7750227466565, -1017.5318097532224, -963.983626092617, -956.7395672360753, -1257.0872031690544, -227.1718919514955, -530.6734787451505, -456.7358441839734, -1094.143327038422, -802.8470475960314, -886.4808550201847, -923.2601177088321, -1140.834382522844, -1198.7011471495307, -311.2869756138449, -830.9909692141048, -811.3816189689793, -1057.5006549809098, -244.9607687688194, -1168.9612246373501, -9.492033267178217, -19.367391693895335, -304.30425472171817, -1081.9904173736584, -910.384315791063, -1197.5485740155652, -1015.7574458706591, -980.6176515287804, -671.5378469784605], "episode_lengths": [44, 150, 64, 150, 114, 72, 150, 71, 150, 108, 150, 150, 70, 52, 150, 150, 150, 112, 150, 150, 113, 43, 90, 150, 150, 150, 150, 150, 68, 150, 105, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 101, 150, 30, 39, 113, 150, 150, 150, 150, 150, 131], "policy_policy_0_reward": [-39.37572699380866, -647.6047455424593, -186.94472153729066, -912.981218734388, -546.1424723584963, -250.6829092944998, -674.3030418490337, -86.09568047730708, -1362.7642263246585, -526.9398732954631, -622.4408238066375, -1353.357190468162, -196.02020395153733, -103.60376311617232, -844.0356948102652, -1081.298804481842, -897.7582374949247, -555.0242018107482, -758.0002171659173, -1003.4071068116938, -361.3145815016075, -26.925962808161678, -188.63831181293227, -806.7750227466565, -1017.5318097532224, -963.983626092617, -956.7395672360753, -1257.0872031690544, -227.1718919514955, -530.6734787451505, -456.7358441839734, -1094.143327038422, -802.8470475960314, -886.4808550201847, -923.2601177088321, -1140.834382522844, -1198.7011471495307, -311.2869756138449, -830.9909692141048, -811.3816189689793, -1057.5006549809098, -244.9607687688194, -1168.9612246373501, -9.492033267178217, -19.367391693895335, -304.30425472171817, -1081.9904173736584, -910.384315791063, -1197.5485740155652, -1015.7574458706591, -980.6176515287804, -671.5378469784605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5544624163222092, "mean_inference_ms": 1.6384408832451325, "mean_action_processing_ms": 0.275977438765986, "mean_env_wait_ms": 3.377343946422199, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012746224036583534, "StateBufferConnector_ms": 0.008301551525409404, "ViewRequirementAgentConnector_ms": 0.18511552077073318}, "num_episodes": 28, "episode_return_max": -9.492033267178217, "episode_return_min": -1362.7642263246585, "episode_return_mean": -694.3212919382131, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.3262842519142, "num_env_steps_trained_throughput_per_sec": 313.3262842519142, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12785.939, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12785.86, "sample_time_ms": 1106.11, "learn_time_ms": 11603.486, "learn_throughput": 344.724, "synch_weights_time_ms": 75.418}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00000", "date": "2024-08-04_05-27-54", "timestamp": 1722729474, "time_this_iter_s": 12.777472972869873, "time_total_s": 25.593441486358643, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a1719ed40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.593441486358643, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.744444444444444, "ram_util_percent": 27.59444444444445}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.422309559832016, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.54790321290493, "policy_loss": -0.009638782688610566, "vf_loss": 7.5551754603783285, "vf_explained_var": 0.5164417139564951, "kl": 0.012573414415843828, "entropy": 1.4814940868566433, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -4.652629329336695, "episode_reward_min": -1362.7642263246585, "episode_reward_mean": -711.9100135559322, "episode_len_mean": 123.4, "episode_media": {}, "episodes_timesteps_total": 10489, "policy_reward_min": {"policy_0": -1362.7642263246585}, "policy_reward_max": {"policy_0": -4.652629329336695}, "policy_reward_mean": {"policy_0": -711.9100135559322}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-39.37572699380866, -647.6047455424593, -186.94472153729066, -912.981218734388, -546.1424723584963, -250.6829092944998, -674.3030418490337, -86.09568047730708, -1362.7642263246585, -526.9398732954631, -622.4408238066375, -1353.357190468162, -196.02020395153733, -103.60376311617232, -844.0356948102652, -1081.298804481842, -897.7582374949247, -555.0242018107482, -758.0002171659173, -1003.4071068116938, -361.3145815016075, -26.925962808161678, -188.63831181293227, -806.7750227466565, -1017.5318097532224, -963.983626092617, -956.7395672360753, -1257.0872031690544, -227.1718919514955, -530.6734787451505, -456.7358441839734, -1094.143327038422, -802.8470475960314, -886.4808550201847, -923.2601177088321, -1140.834382522844, -1198.7011471495307, -311.2869756138449, -830.9909692141048, -811.3816189689793, -1057.5006549809098, -244.9607687688194, -1168.9612246373501, -9.492033267178217, -19.367391693895335, -304.30425472171817, -1081.9904173736584, -910.384315791063, -1197.5485740155652, -1015.7574458706591, -980.6176515287804, -671.5378469784605, -938.444778506445, -882.142811024531, -4.652629329336695, -840.6537561446495, -1083.1714398141087, -938.0421836677796, -215.93100810414674, -1331.7071586160152, -459.1770670478794, -1107.9413337452024, -1185.9528634511134, -43.39740848104374, -681.9404725094117, -496.97940871034143, -1023.9342206565304, -871.8575017844198, -121.02776700600799, -160.7188704429351, -963.0307617164732, -1215.455619080543, -1172.9238359682067, -38.708144782363355, -819.7222171822942, -242.63273375515448, -1328.4285303476397, -957.1393427889861, -1239.815341890102, -1267.2017268537766, -448.0615745696942, -1246.2350384563583, -39.61019486340277, -681.4104885845707, -359.5957415856876], "episode_lengths": [44, 150, 64, 150, 114, 72, 150, 71, 150, 108, 150, 150, 70, 52, 150, 150, 150, 112, 150, 150, 113, 43, 90, 150, 150, 150, 150, 150, 68, 150, 105, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 101, 150, 30, 39, 113, 150, 150, 150, 150, 150, 131, 150, 150, 34, 150, 150, 150, 78, 150, 101, 150, 150, 60, 150, 130, 150, 150, 49, 76, 150, 150, 150, 47, 150, 72, 150, 150, 150, 150, 108, 150, 51, 150, 115], "policy_policy_0_reward": [-39.37572699380866, -647.6047455424593, -186.94472153729066, -912.981218734388, -546.1424723584963, -250.6829092944998, -674.3030418490337, -86.09568047730708, -1362.7642263246585, -526.9398732954631, -622.4408238066375, -1353.357190468162, -196.02020395153733, -103.60376311617232, -844.0356948102652, -1081.298804481842, -897.7582374949247, -555.0242018107482, -758.0002171659173, -1003.4071068116938, -361.3145815016075, -26.925962808161678, -188.63831181293227, -806.7750227466565, -1017.5318097532224, -963.983626092617, -956.7395672360753, -1257.0872031690544, -227.1718919514955, -530.6734787451505, -456.7358441839734, -1094.143327038422, -802.8470475960314, -886.4808550201847, -923.2601177088321, -1140.834382522844, -1198.7011471495307, -311.2869756138449, -830.9909692141048, -811.3816189689793, -1057.5006549809098, -244.9607687688194, -1168.9612246373501, -9.492033267178217, -19.367391693895335, -304.30425472171817, -1081.9904173736584, -910.384315791063, -1197.5485740155652, -1015.7574458706591, -980.6176515287804, -671.5378469784605, -938.444778506445, -882.142811024531, -4.652629329336695, -840.6537561446495, -1083.1714398141087, -938.0421836677796, -215.93100810414674, -1331.7071586160152, -459.1770670478794, -1107.9413337452024, -1185.9528634511134, -43.39740848104374, -681.9404725094117, -496.97940871034143, -1023.9342206565304, -871.8575017844198, -121.02776700600799, -160.7188704429351, -963.0307617164732, -1215.455619080543, -1172.9238359682067, -38.708144782363355, -819.7222171822942, -242.63273375515448, -1328.4285303476397, -957.1393427889861, -1239.815341890102, -1267.2017268537766, -448.0615745696942, -1246.2350384563583, -39.61019486340277, -681.4104885845707, -359.5957415856876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560222368715457, "mean_inference_ms": 1.6433322750603956, "mean_action_processing_ms": 0.2762345057568289, "mean_env_wait_ms": 3.389261545516694, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012748101178337546, "StateBufferConnector_ms": 0.008444786071777344, "ViewRequirementAgentConnector_ms": 0.18628428964053884}, "num_episodes": 33, "episode_return_max": -4.652629329336695, "episode_return_min": -1362.7642263246585, "episode_return_mean": -711.9100135559322, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 316.45762756334784, "num_env_steps_trained_throughput_per_sec": 316.45762756334784, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12737.272, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12737.195, "sample_time_ms": 1108.661, "learn_time_ms": 11555.911, "learn_throughput": 346.143, "synch_weights_time_ms": 71.803}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00000", "date": "2024-08-04_05-28-07", "timestamp": 1722729487, "time_this_iter_s": 12.65258264541626, "time_total_s": 38.2460241317749, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a1719edd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.2460241317749, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.455555555555552, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 63.14758826692899, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.590267853687207, "policy_loss": -0.020549442731620123, "vf_loss": 5.606198937942584, "vf_explained_var": 0.8233137848476569, "kl": 0.02383791229491787, "entropy": 1.4921012514581282, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -4.652629329336695, "episode_reward_min": -1399.2691597624964, "episode_reward_mean": -766.0673894048132, "episode_len_mean": 127.98, "episode_media": {}, "episodes_timesteps_total": 12798, "policy_reward_min": {"policy_0": -1399.2691597624964}, "policy_reward_max": {"policy_0": -4.652629329336695}, "policy_reward_mean": {"policy_0": -766.0673894048132}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-897.7582374949247, -555.0242018107482, -758.0002171659173, -1003.4071068116938, -361.3145815016075, -26.925962808161678, -188.63831181293227, -806.7750227466565, -1017.5318097532224, -963.983626092617, -956.7395672360753, -1257.0872031690544, -227.1718919514955, -530.6734787451505, -456.7358441839734, -1094.143327038422, -802.8470475960314, -886.4808550201847, -923.2601177088321, -1140.834382522844, -1198.7011471495307, -311.2869756138449, -830.9909692141048, -811.3816189689793, -1057.5006549809098, -244.9607687688194, -1168.9612246373501, -9.492033267178217, -19.367391693895335, -304.30425472171817, -1081.9904173736584, -910.384315791063, -1197.5485740155652, -1015.7574458706591, -980.6176515287804, -671.5378469784605, -938.444778506445, -882.142811024531, -4.652629329336695, -840.6537561446495, -1083.1714398141087, -938.0421836677796, -215.93100810414674, -1331.7071586160152, -459.1770670478794, -1107.9413337452024, -1185.9528634511134, -43.39740848104374, -681.9404725094117, -496.97940871034143, -1023.9342206565304, -871.8575017844198, -121.02776700600799, -160.7188704429351, -963.0307617164732, -1215.455619080543, -1172.9238359682067, -38.708144782363355, -819.7222171822942, -242.63273375515448, -1328.4285303476397, -957.1393427889861, -1239.815341890102, -1267.2017268537766, -448.0615745696942, -1246.2350384563583, -39.61019486340277, -681.4104885845707, -359.5957415856876, -945.1731479206419, -1002.3421311450902, -1027.9300777135604, -402.62989652073003, -1220.772159740952, -1121.6434377785934, -1254.1376286387613, -697.2682139420443, -475.9173427873707, -450.87946698463963, -443.50483578443533, -986.2522327681099, -102.12215216230948, -185.69198855438648, -1013.2943559368124, -963.1407592181151, -1091.401988260585, -858.6142114473375, -1170.1991257517298, -1399.2691597624964, -554.1090902934124, -1060.1858390266036, -835.9355444242584, -298.4704632662763, -213.32461334450176, -1122.5747961108675, -1186.9096653501913, -1100.289282376143, -915.1459191209963, -1216.402715772796, -213.44664336435272], "episode_lengths": [150, 112, 150, 150, 113, 43, 90, 150, 150, 150, 150, 150, 68, 150, 105, 150, 150, 150, 150, 150, 150, 78, 150, 150, 150, 101, 150, 30, 39, 113, 150, 150, 150, 150, 150, 131, 150, 150, 34, 150, 150, 150, 78, 150, 101, 150, 150, 60, 150, 130, 150, 150, 49, 76, 150, 150, 150, 47, 150, 72, 150, 150, 150, 150, 108, 150, 51, 150, 115, 150, 150, 150, 103, 150, 150, 150, 127, 135, 104, 121, 150, 74, 63, 150, 150, 150, 150, 150, 150, 140, 150, 150, 81, 84, 150, 150, 150, 150, 150, 72], "policy_policy_0_reward": [-897.7582374949247, -555.0242018107482, -758.0002171659173, -1003.4071068116938, -361.3145815016075, -26.925962808161678, -188.63831181293227, -806.7750227466565, -1017.5318097532224, -963.983626092617, -956.7395672360753, -1257.0872031690544, -227.1718919514955, -530.6734787451505, -456.7358441839734, -1094.143327038422, -802.8470475960314, -886.4808550201847, -923.2601177088321, -1140.834382522844, -1198.7011471495307, -311.2869756138449, -830.9909692141048, -811.3816189689793, -1057.5006549809098, -244.9607687688194, -1168.9612246373501, -9.492033267178217, -19.367391693895335, -304.30425472171817, -1081.9904173736584, -910.384315791063, -1197.5485740155652, -1015.7574458706591, -980.6176515287804, -671.5378469784605, -938.444778506445, -882.142811024531, -4.652629329336695, -840.6537561446495, -1083.1714398141087, -938.0421836677796, -215.93100810414674, -1331.7071586160152, -459.1770670478794, -1107.9413337452024, -1185.9528634511134, -43.39740848104374, -681.9404725094117, -496.97940871034143, -1023.9342206565304, -871.8575017844198, -121.02776700600799, -160.7188704429351, -963.0307617164732, -1215.455619080543, -1172.9238359682067, -38.708144782363355, -819.7222171822942, -242.63273375515448, -1328.4285303476397, -957.1393427889861, -1239.815341890102, -1267.2017268537766, -448.0615745696942, -1246.2350384563583, -39.61019486340277, -681.4104885845707, -359.5957415856876, -945.1731479206419, -1002.3421311450902, -1027.9300777135604, -402.62989652073003, -1220.772159740952, -1121.6434377785934, -1254.1376286387613, -697.2682139420443, -475.9173427873707, -450.87946698463963, -443.50483578443533, -986.2522327681099, -102.12215216230948, -185.69198855438648, -1013.2943559368124, -963.1407592181151, -1091.401988260585, -858.6142114473375, -1170.1991257517298, -1399.2691597624964, -554.1090902934124, -1060.1858390266036, -835.9355444242584, -298.4704632662763, -213.32461334450176, -1122.5747961108675, -1186.9096653501913, -1100.289282376143, -915.1459191209963, -1216.402715772796, -213.44664336435272]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5566530601571723, "mean_inference_ms": 1.6460426476814325, "mean_action_processing_ms": 0.2766533325979693, "mean_env_wait_ms": 3.396817794324511, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013077020645141602, "StateBufferConnector_ms": 0.008584976196289062, "ViewRequirementAgentConnector_ms": 0.1880331039428711}, "num_episodes": 31, "episode_return_max": -4.652629329336695, "episode_return_min": -1399.2691597624964, "episode_return_mean": -766.0673894048132, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.4196030656052, "num_env_steps_trained_throughput_per_sec": 315.4196030656052, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12723.337, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12723.264, "sample_time_ms": 1105.247, "learn_time_ms": 11545.727, "learn_throughput": 346.449, "synch_weights_time_ms": 71.485}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00000", "date": "2024-08-04_05-28-19", "timestamp": 1722729499, "time_this_iter_s": 12.693780422210693, "time_total_s": 50.939804553985596, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a1725a3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.939804553985596, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.8, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 66.56835842927298, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.144207367300988, "policy_loss": -0.018206131727977967, "vf_loss": 5.157312712321679, "vf_explained_var": 0.8571515476331115, "kl": 0.017494649534273776, "entropy": 1.476189617191752, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -4.652629329336695, "episode_reward_min": -1417.9892417157807, "episode_reward_mean": -754.3958130838078, "episode_len_mean": 128.89, "episode_media": {}, "episodes_timesteps_total": 12889, "policy_reward_min": {"policy_0": -1417.9892417157807}, "policy_reward_max": {"policy_0": -4.652629329336695}, "policy_reward_mean": {"policy_0": -754.3958130838078}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1197.5485740155652, -1015.7574458706591, -980.6176515287804, -671.5378469784605, -938.444778506445, -882.142811024531, -4.652629329336695, -840.6537561446495, -1083.1714398141087, -938.0421836677796, -215.93100810414674, -1331.7071586160152, -459.1770670478794, -1107.9413337452024, -1185.9528634511134, -43.39740848104374, -681.9404725094117, -496.97940871034143, -1023.9342206565304, -871.8575017844198, -121.02776700600799, -160.7188704429351, -963.0307617164732, -1215.455619080543, -1172.9238359682067, -38.708144782363355, -819.7222171822942, -242.63273375515448, -1328.4285303476397, -957.1393427889861, -1239.815341890102, -1267.2017268537766, -448.0615745696942, -1246.2350384563583, -39.61019486340277, -681.4104885845707, -359.5957415856876, -945.1731479206419, -1002.3421311450902, -1027.9300777135604, -402.62989652073003, -1220.772159740952, -1121.6434377785934, -1254.1376286387613, -697.2682139420443, -475.9173427873707, -450.87946698463963, -443.50483578443533, -986.2522327681099, -102.12215216230948, -185.69198855438648, -1013.2943559368124, -963.1407592181151, -1091.401988260585, -858.6142114473375, -1170.1991257517298, -1399.2691597624964, -554.1090902934124, -1060.1858390266036, -835.9355444242584, -298.4704632662763, -213.32461334450176, -1122.5747961108675, -1186.9096653501913, -1100.289282376143, -915.1459191209963, -1216.402715772796, -213.44664336435272, -225.2546414495467, -328.0295306802025, -766.488277514756, -1135.7969194756627, -1417.9892417157807, -828.1534783438829, -26.77253011354723, -897.9669936531386, -503.97911739728517, -881.8799076647026, -515.4613269781152, -172.61795925763036, -117.66889405151524, -915.5882522578399, -1220.1113753404793, -958.1412796948065, -1222.500263062231, -644.171495101224, -175.37778463144983, -145.00074813562753, -1059.2527832499984, -1039.4661530069811, -602.1903334172315, -405.24618456899833, -353.47834406629426, -96.52951819131833, -707.1576872372164, -359.73608076473596, -1182.8883667180776, -687.4043790408341, -957.9841261077723, -1087.2129603621681], "episode_lengths": [150, 150, 150, 131, 150, 150, 34, 150, 150, 150, 78, 150, 101, 150, 150, 60, 150, 130, 150, 150, 49, 76, 150, 150, 150, 47, 150, 72, 150, 150, 150, 150, 108, 150, 51, 150, 115, 150, 150, 150, 103, 150, 150, 150, 127, 135, 104, 121, 150, 74, 63, 150, 150, 150, 150, 150, 150, 140, 150, 150, 81, 84, 150, 150, 150, 150, 150, 72, 76, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 61, 83, 150, 150, 150, 150, 121, 64, 71, 150, 150, 150, 150, 150, 54, 150, 111, 150, 150, 150, 150], "policy_policy_0_reward": [-1197.5485740155652, -1015.7574458706591, -980.6176515287804, -671.5378469784605, -938.444778506445, -882.142811024531, -4.652629329336695, -840.6537561446495, -1083.1714398141087, -938.0421836677796, -215.93100810414674, -1331.7071586160152, -459.1770670478794, -1107.9413337452024, -1185.9528634511134, -43.39740848104374, -681.9404725094117, -496.97940871034143, -1023.9342206565304, -871.8575017844198, -121.02776700600799, -160.7188704429351, -963.0307617164732, -1215.455619080543, -1172.9238359682067, -38.708144782363355, -819.7222171822942, -242.63273375515448, -1328.4285303476397, -957.1393427889861, -1239.815341890102, -1267.2017268537766, -448.0615745696942, -1246.2350384563583, -39.61019486340277, -681.4104885845707, -359.5957415856876, -945.1731479206419, -1002.3421311450902, -1027.9300777135604, -402.62989652073003, -1220.772159740952, -1121.6434377785934, -1254.1376286387613, -697.2682139420443, -475.9173427873707, -450.87946698463963, -443.50483578443533, -986.2522327681099, -102.12215216230948, -185.69198855438648, -1013.2943559368124, -963.1407592181151, -1091.401988260585, -858.6142114473375, -1170.1991257517298, -1399.2691597624964, -554.1090902934124, -1060.1858390266036, -835.9355444242584, -298.4704632662763, -213.32461334450176, -1122.5747961108675, -1186.9096653501913, -1100.289282376143, -915.1459191209963, -1216.402715772796, -213.44664336435272, -225.2546414495467, -328.0295306802025, -766.488277514756, -1135.7969194756627, -1417.9892417157807, -828.1534783438829, -26.77253011354723, -897.9669936531386, -503.97911739728517, -881.8799076647026, -515.4613269781152, -172.61795925763036, -117.66889405151524, -915.5882522578399, -1220.1113753404793, -958.1412796948065, -1222.500263062231, -644.171495101224, -175.37778463144983, -145.00074813562753, -1059.2527832499984, -1039.4661530069811, -602.1903334172315, -405.24618456899833, -353.47834406629426, -96.52951819131833, -707.1576872372164, -359.73608076473596, -1182.8883667180776, -687.4043790408341, -957.9841261077723, -1087.2129603621681]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578604936971191, "mean_inference_ms": 1.655330872131941, "mean_action_processing_ms": 0.27746207656509414, "mean_env_wait_ms": 3.4142657675617287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012923479080200195, "StateBufferConnector_ms": 0.008754253387451172, "ViewRequirementAgentConnector_ms": 0.19143080711364746}, "num_episodes": 32, "episode_return_max": -4.652629329336695, "episode_return_min": -1417.9892417157807, "episode_return_mean": -754.3958130838078, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.4582311095106, "num_env_steps_trained_throughput_per_sec": 312.4582311095106, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12739.014, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12738.942, "sample_time_ms": 1108.135, "learn_time_ms": 11556.002, "learn_throughput": 346.14, "synch_weights_time_ms": 73.999}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00000", "date": "2024-08-04_05-28-32", "timestamp": 1722729512, "time_this_iter_s": 12.815421104431152, "time_total_s": 63.75522565841675, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a1739c1f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 63.75522565841675, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.805555555555557, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 93.25211303532123, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.281130060553551, "policy_loss": -0.009307341244614993, "vf_loss": 5.285759168118238, "vf_explained_var": 0.8628382487843435, "kl": 0.016084935319842474, "entropy": 1.4725765729943912, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -26.77253011354723, "episode_reward_min": -1417.9892417157807, "episode_reward_mean": -758.314951732002, "episode_len_mean": 130.14, "episode_media": {}, "episodes_timesteps_total": 13014, "policy_reward_min": {"policy_0": -1417.9892417157807}, "policy_reward_max": {"policy_0": -26.77253011354723}, "policy_reward_mean": {"policy_0": -758.314951732002}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1328.4285303476397, -957.1393427889861, -1239.815341890102, -1267.2017268537766, -448.0615745696942, -1246.2350384563583, -39.61019486340277, -681.4104885845707, -359.5957415856876, -945.1731479206419, -1002.3421311450902, -1027.9300777135604, -402.62989652073003, -1220.772159740952, -1121.6434377785934, -1254.1376286387613, -697.2682139420443, -475.9173427873707, -450.87946698463963, -443.50483578443533, -986.2522327681099, -102.12215216230948, -185.69198855438648, -1013.2943559368124, -963.1407592181151, -1091.401988260585, -858.6142114473375, -1170.1991257517298, -1399.2691597624964, -554.1090902934124, -1060.1858390266036, -835.9355444242584, -298.4704632662763, -213.32461334450176, -1122.5747961108675, -1186.9096653501913, -1100.289282376143, -915.1459191209963, -1216.402715772796, -213.44664336435272, -225.2546414495467, -328.0295306802025, -766.488277514756, -1135.7969194756627, -1417.9892417157807, -828.1534783438829, -26.77253011354723, -897.9669936531386, -503.97911739728517, -881.8799076647026, -515.4613269781152, -172.61795925763036, -117.66889405151524, -915.5882522578399, -1220.1113753404793, -958.1412796948065, -1222.500263062231, -644.171495101224, -175.37778463144983, -145.00074813562753, -1059.2527832499984, -1039.4661530069811, -602.1903334172315, -405.24618456899833, -353.47834406629426, -96.52951819131833, -707.1576872372164, -359.73608076473596, -1182.8883667180776, -687.4043790408341, -957.9841261077723, -1087.2129603621681, -1017.2443032526389, -1019.8932641695322, -318.1250410884345, -760.2755935105349, -301.01263260836043, -1020.2024066301893, -1185.009124479966, -1189.646920284952, -724.713426814071, -1292.6860050580237, -1191.1768995757657, -595.7315362860487, -792.5293517039655, -983.1035007482259, -364.1878141238609, -1254.9983852781613, -168.76839219327113, -879.4648665399703, -992.966702249798, -251.46708070915795, -90.36857825943017, -54.06851064371353, -988.1157244839412, -228.12436484446792, -194.56316237345123, -1129.9399758486175, -810.0674937589754, -1299.0703172222957], "episode_lengths": [150, 150, 150, 150, 108, 150, 51, 150, 115, 150, 150, 150, 103, 150, 150, 150, 127, 135, 104, 121, 150, 74, 63, 150, 150, 150, 150, 150, 150, 140, 150, 150, 81, 84, 150, 150, 150, 150, 150, 72, 76, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 61, 83, 150, 150, 150, 150, 121, 64, 71, 150, 150, 150, 150, 150, 54, 150, 111, 150, 150, 150, 150, 150, 150, 95, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 70, 150, 150, 109, 64, 51, 150, 68, 68, 150, 150, 150], "policy_policy_0_reward": [-1328.4285303476397, -957.1393427889861, -1239.815341890102, -1267.2017268537766, -448.0615745696942, -1246.2350384563583, -39.61019486340277, -681.4104885845707, -359.5957415856876, -945.1731479206419, -1002.3421311450902, -1027.9300777135604, -402.62989652073003, -1220.772159740952, -1121.6434377785934, -1254.1376286387613, -697.2682139420443, -475.9173427873707, -450.87946698463963, -443.50483578443533, -986.2522327681099, -102.12215216230948, -185.69198855438648, -1013.2943559368124, -963.1407592181151, -1091.401988260585, -858.6142114473375, -1170.1991257517298, -1399.2691597624964, -554.1090902934124, -1060.1858390266036, -835.9355444242584, -298.4704632662763, -213.32461334450176, -1122.5747961108675, -1186.9096653501913, -1100.289282376143, -915.1459191209963, -1216.402715772796, -213.44664336435272, -225.2546414495467, -328.0295306802025, -766.488277514756, -1135.7969194756627, -1417.9892417157807, -828.1534783438829, -26.77253011354723, -897.9669936531386, -503.97911739728517, -881.8799076647026, -515.4613269781152, -172.61795925763036, -117.66889405151524, -915.5882522578399, -1220.1113753404793, -958.1412796948065, -1222.500263062231, -644.171495101224, -175.37778463144983, -145.00074813562753, -1059.2527832499984, -1039.4661530069811, -602.1903334172315, -405.24618456899833, -353.47834406629426, -96.52951819131833, -707.1576872372164, -359.73608076473596, -1182.8883667180776, -687.4043790408341, -957.9841261077723, -1087.2129603621681, -1017.2443032526389, -1019.8932641695322, -318.1250410884345, -760.2755935105349, -301.01263260836043, -1020.2024066301893, -1185.009124479966, -1189.646920284952, -724.713426814071, -1292.6860050580237, -1191.1768995757657, -595.7315362860487, -792.5293517039655, -983.1035007482259, -364.1878141238609, -1254.9983852781613, -168.76839219327113, -879.4648665399703, -992.966702249798, -251.46708070915795, -90.36857825943017, -54.06851064371353, -988.1157244839412, -228.12436484446792, -194.56316237345123, -1129.9399758486175, -810.0674937589754, -1299.0703172222957]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5570132678786123, "mean_inference_ms": 1.6583020853225119, "mean_action_processing_ms": 0.2778308881328872, "mean_env_wait_ms": 3.418941260796706, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013121843338012695, "StateBufferConnector_ms": 0.008818864822387695, "ViewRequirementAgentConnector_ms": 0.19390535354614258}, "num_episodes": 28, "episode_return_max": -26.77253011354723, "episode_return_min": -1417.9892417157807, "episode_return_mean": -758.314951732002, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.2779263367159, "num_env_steps_trained_throughput_per_sec": 303.2779263367159, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12814.051, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12813.98, "sample_time_ms": 1113.631, "learn_time_ms": 11625.87, "learn_throughput": 344.06, "synch_weights_time_ms": 73.622}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00000", "date": "2024-08-04_05-28-45", "timestamp": 1722729525, "time_this_iter_s": 13.203377962112427, "time_total_s": 76.95860362052917, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a17259480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76.95860362052917, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.58421052631579, "ram_util_percent": 27.600000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 129.3683012286822, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.312439915289482, "policy_loss": -0.010856258996257868, "vf_loss": 4.319538407524427, "vf_explained_var": 0.8902161876360576, "kl": 0.013018109970789737, "entropy": 1.4767497318486373, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -26.77253011354723, "episode_reward_min": -1494.8519388103578, "episode_reward_mean": -758.1509241328829, "episode_len_mean": 131.82, "episode_media": {}, "episodes_timesteps_total": 13182, "policy_reward_min": {"policy_0": -1494.8519388103578}, "policy_reward_max": {"policy_0": -26.77253011354723}, "policy_reward_mean": {"policy_0": -758.1509241328829}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1399.2691597624964, -554.1090902934124, -1060.1858390266036, -835.9355444242584, -298.4704632662763, -213.32461334450176, -1122.5747961108675, -1186.9096653501913, -1100.289282376143, -915.1459191209963, -1216.402715772796, -213.44664336435272, -225.2546414495467, -328.0295306802025, -766.488277514756, -1135.7969194756627, -1417.9892417157807, -828.1534783438829, -26.77253011354723, -897.9669936531386, -503.97911739728517, -881.8799076647026, -515.4613269781152, -172.61795925763036, -117.66889405151524, -915.5882522578399, -1220.1113753404793, -958.1412796948065, -1222.500263062231, -644.171495101224, -175.37778463144983, -145.00074813562753, -1059.2527832499984, -1039.4661530069811, -602.1903334172315, -405.24618456899833, -353.47834406629426, -96.52951819131833, -707.1576872372164, -359.73608076473596, -1182.8883667180776, -687.4043790408341, -957.9841261077723, -1087.2129603621681, -1017.2443032526389, -1019.8932641695322, -318.1250410884345, -760.2755935105349, -301.01263260836043, -1020.2024066301893, -1185.009124479966, -1189.646920284952, -724.713426814071, -1292.6860050580237, -1191.1768995757657, -595.7315362860487, -792.5293517039655, -983.1035007482259, -364.1878141238609, -1254.9983852781613, -168.76839219327113, -879.4648665399703, -992.966702249798, -251.46708070915795, -90.36857825943017, -54.06851064371353, -988.1157244839412, -228.12436484446792, -194.56316237345123, -1129.9399758486175, -810.0674937589754, -1299.0703172222957, -802.1121673764309, -378.1685270765871, -1031.3206052693474, -677.5580410849458, -1188.0761605586704, -801.2475591920091, -1064.4340285314872, -1006.6656796519678, -830.007840673324, -891.801201920485, -1121.0414428547117, -263.5073700888397, -497.0528448092143, -873.5710054877076, -351.6296525447146, -147.76233102517645, -1494.8519388103578, -811.4508556283114, -697.4873801225887, -621.4506628981406, -1167.3584994797054, -1121.9915526995585, -1239.696196034017, -1133.9665494228668, -699.1178582651739, -217.16758933997124, -1246.9532849597308, -586.5615472784848], "episode_lengths": [150, 140, 150, 150, 81, 84, 150, 150, 150, 150, 150, 72, 76, 150, 150, 150, 150, 150, 42, 150, 150, 150, 150, 61, 83, 150, 150, 150, 150, 121, 64, 71, 150, 150, 150, 150, 150, 54, 150, 111, 150, 150, 150, 150, 150, 150, 95, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 70, 150, 150, 109, 64, 51, 150, 68, 68, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 138, 150, 82, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150], "policy_policy_0_reward": [-1399.2691597624964, -554.1090902934124, -1060.1858390266036, -835.9355444242584, -298.4704632662763, -213.32461334450176, -1122.5747961108675, -1186.9096653501913, -1100.289282376143, -915.1459191209963, -1216.402715772796, -213.44664336435272, -225.2546414495467, -328.0295306802025, -766.488277514756, -1135.7969194756627, -1417.9892417157807, -828.1534783438829, -26.77253011354723, -897.9669936531386, -503.97911739728517, -881.8799076647026, -515.4613269781152, -172.61795925763036, -117.66889405151524, -915.5882522578399, -1220.1113753404793, -958.1412796948065, -1222.500263062231, -644.171495101224, -175.37778463144983, -145.00074813562753, -1059.2527832499984, -1039.4661530069811, -602.1903334172315, -405.24618456899833, -353.47834406629426, -96.52951819131833, -707.1576872372164, -359.73608076473596, -1182.8883667180776, -687.4043790408341, -957.9841261077723, -1087.2129603621681, -1017.2443032526389, -1019.8932641695322, -318.1250410884345, -760.2755935105349, -301.01263260836043, -1020.2024066301893, -1185.009124479966, -1189.646920284952, -724.713426814071, -1292.6860050580237, -1191.1768995757657, -595.7315362860487, -792.5293517039655, -983.1035007482259, -364.1878141238609, -1254.9983852781613, -168.76839219327113, -879.4648665399703, -992.966702249798, -251.46708070915795, -90.36857825943017, -54.06851064371353, -988.1157244839412, -228.12436484446792, -194.56316237345123, -1129.9399758486175, -810.0674937589754, -1299.0703172222957, -802.1121673764309, -378.1685270765871, -1031.3206052693474, -677.5580410849458, -1188.0761605586704, -801.2475591920091, -1064.4340285314872, -1006.6656796519678, -830.007840673324, -891.801201920485, -1121.0414428547117, -263.5073700888397, -497.0528448092143, -873.5710054877076, -351.6296525447146, -147.76233102517645, -1494.8519388103578, -811.4508556283114, -697.4873801225887, -621.4506628981406, -1167.3584994797054, -1121.9915526995585, -1239.696196034017, -1133.9665494228668, -699.1178582651739, -217.16758933997124, -1246.9532849597308, -586.5615472784848]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569689366626529, "mean_inference_ms": 1.659071086263301, "mean_action_processing_ms": 0.2778283337480375, "mean_env_wait_ms": 3.4210267981982283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012513160705566406, "StateBufferConnector_ms": 0.012457609176635742, "ViewRequirementAgentConnector_ms": 0.19281673431396484}, "num_episodes": 28, "episode_return_max": -26.77253011354723, "episode_return_min": -1494.8519388103578, "episode_return_mean": -758.1509241328829, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.4394960431566, "num_env_steps_trained_throughput_per_sec": 308.4394960431566, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12836.118, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12836.046, "sample_time_ms": 1113.942, "learn_time_ms": 11648.287, "learn_throughput": 343.398, "synch_weights_time_ms": 72.966}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00000", "date": "2024-08-04_05-28-59", "timestamp": 1722729539, "time_this_iter_s": 12.980801105499268, "time_total_s": 89.93940472602844, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a1719f0a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 89.93940472602844, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.821052631578947, "ram_util_percent": 27.615789473684213}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 147.05634164015453, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.635641720145941, "policy_loss": -0.010582052683457733, "vf_loss": 3.6424528395136195, "vf_explained_var": 0.951595731265843, "kl": 0.01305826108708364, "entropy": 1.4654228013008832, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -54.06851064371353, "episode_reward_min": -1494.8519388103578, "episode_reward_mean": -773.5069928818314, "episode_len_mean": 132.68, "episode_media": {}, "episodes_timesteps_total": 13268, "policy_reward_min": {"policy_0": -1494.8519388103578}, "policy_reward_max": {"policy_0": -54.06851064371353}, "policy_reward_mean": {"policy_0": -773.5069928818314}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-644.171495101224, -175.37778463144983, -145.00074813562753, -1059.2527832499984, -1039.4661530069811, -602.1903334172315, -405.24618456899833, -353.47834406629426, -96.52951819131833, -707.1576872372164, -359.73608076473596, -1182.8883667180776, -687.4043790408341, -957.9841261077723, -1087.2129603621681, -1017.2443032526389, -1019.8932641695322, -318.1250410884345, -760.2755935105349, -301.01263260836043, -1020.2024066301893, -1185.009124479966, -1189.646920284952, -724.713426814071, -1292.6860050580237, -1191.1768995757657, -595.7315362860487, -792.5293517039655, -983.1035007482259, -364.1878141238609, -1254.9983852781613, -168.76839219327113, -879.4648665399703, -992.966702249798, -251.46708070915795, -90.36857825943017, -54.06851064371353, -988.1157244839412, -228.12436484446792, -194.56316237345123, -1129.9399758486175, -810.0674937589754, -1299.0703172222957, -802.1121673764309, -378.1685270765871, -1031.3206052693474, -677.5580410849458, -1188.0761605586704, -801.2475591920091, -1064.4340285314872, -1006.6656796519678, -830.007840673324, -891.801201920485, -1121.0414428547117, -263.5073700888397, -497.0528448092143, -873.5710054877076, -351.6296525447146, -147.76233102517645, -1494.8519388103578, -811.4508556283114, -697.4873801225887, -621.4506628981406, -1167.3584994797054, -1121.9915526995585, -1239.696196034017, -1133.9665494228668, -699.1178582651739, -217.16758933997124, -1246.9532849597308, -586.5615472784848, -979.4453102364376, -286.0454290389204, -288.4654105297666, -1048.9788714276299, -1137.5661386282352, -826.6270516145548, -734.5027872100679, -1023.2130457948646, -1342.9713708520885, -836.8156779041399, -1043.1176423651762, -147.69117654213525, -1114.4556499258501, -613.5486322863226, -394.6611101641849, -1082.0861772098392, -1262.831477684278, -728.2695696351635, -871.6059305682336, -1085.138657629026, -1321.620817331913, -1214.095713526563, -951.366132602278, -178.5899665277236, -513.0085753761844, -1143.8800181095062, -54.20063634681122, -1016.8337727180333, -544.4378459729455], "episode_lengths": [121, 64, 71, 150, 150, 150, 150, 150, 54, 150, 111, 150, 150, 150, 150, 150, 150, 95, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 70, 150, 150, 109, 64, 51, 150, 68, 68, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 138, 150, 82, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 81, 102, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 66, 123, 150, 47, 150, 146], "policy_policy_0_reward": [-644.171495101224, -175.37778463144983, -145.00074813562753, -1059.2527832499984, -1039.4661530069811, -602.1903334172315, -405.24618456899833, -353.47834406629426, -96.52951819131833, -707.1576872372164, -359.73608076473596, -1182.8883667180776, -687.4043790408341, -957.9841261077723, -1087.2129603621681, -1017.2443032526389, -1019.8932641695322, -318.1250410884345, -760.2755935105349, -301.01263260836043, -1020.2024066301893, -1185.009124479966, -1189.646920284952, -724.713426814071, -1292.6860050580237, -1191.1768995757657, -595.7315362860487, -792.5293517039655, -983.1035007482259, -364.1878141238609, -1254.9983852781613, -168.76839219327113, -879.4648665399703, -992.966702249798, -251.46708070915795, -90.36857825943017, -54.06851064371353, -988.1157244839412, -228.12436484446792, -194.56316237345123, -1129.9399758486175, -810.0674937589754, -1299.0703172222957, -802.1121673764309, -378.1685270765871, -1031.3206052693474, -677.5580410849458, -1188.0761605586704, -801.2475591920091, -1064.4340285314872, -1006.6656796519678, -830.007840673324, -891.801201920485, -1121.0414428547117, -263.5073700888397, -497.0528448092143, -873.5710054877076, -351.6296525447146, -147.76233102517645, -1494.8519388103578, -811.4508556283114, -697.4873801225887, -621.4506628981406, -1167.3584994797054, -1121.9915526995585, -1239.696196034017, -1133.9665494228668, -699.1178582651739, -217.16758933997124, -1246.9532849597308, -586.5615472784848, -979.4453102364376, -286.0454290389204, -288.4654105297666, -1048.9788714276299, -1137.5661386282352, -826.6270516145548, -734.5027872100679, -1023.2130457948646, -1342.9713708520885, -836.8156779041399, -1043.1176423651762, -147.69117654213525, -1114.4556499258501, -613.5486322863226, -394.6611101641849, -1082.0861772098392, -1262.831477684278, -728.2695696351635, -871.6059305682336, -1085.138657629026, -1321.620817331913, -1214.095713526563, -951.366132602278, -178.5899665277236, -513.0085753761844, -1143.8800181095062, -54.20063634681122, -1016.8337727180333, -544.4378459729455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5568119281716282, "mean_inference_ms": 1.6621254566949708, "mean_action_processing_ms": 0.2782626178455929, "mean_env_wait_ms": 3.43412151683175, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01262211799621582, "StateBufferConnector_ms": 0.012408018112182617, "ViewRequirementAgentConnector_ms": 0.19570016860961914}, "num_episodes": 29, "episode_return_max": -54.06851064371353, "episode_return_min": -1494.8519388103578, "episode_return_mean": -773.5069928818314, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.06657545782497, "num_env_steps_trained_throughput_per_sec": 326.06657545782497, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12765.034, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12764.962, "sample_time_ms": 1115.665, "learn_time_ms": 11577.17, "learn_throughput": 345.508, "synch_weights_time_ms": 71.285}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00000", "date": "2024-08-04_05-29-11", "timestamp": 1722729551, "time_this_iter_s": 12.280282974243164, "time_total_s": 102.2196877002716, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a1725ab00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.2196877002716, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.582352941176474, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 149.6772717177868, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.6339649277428787, "policy_loss": -0.012173431312354903, "vf_loss": 3.6418044947087767, "vf_explained_var": 0.9579900451004505, "kl": 0.014925171855490298, "entropy": 1.437006586541732, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -54.06851064371353, "episode_reward_min": -1494.8519388103578, "episode_reward_mean": -781.2902094539512, "episode_len_mean": 131.89, "episode_media": {}, "episodes_timesteps_total": 13189, "policy_reward_min": {"policy_0": -1494.8519388103578}, "policy_reward_max": {"policy_0": -54.06851064371353}, "policy_reward_mean": {"policy_0": -781.2902094539512}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-879.4648665399703, -992.966702249798, -251.46708070915795, -90.36857825943017, -54.06851064371353, -988.1157244839412, -228.12436484446792, -194.56316237345123, -1129.9399758486175, -810.0674937589754, -1299.0703172222957, -802.1121673764309, -378.1685270765871, -1031.3206052693474, -677.5580410849458, -1188.0761605586704, -801.2475591920091, -1064.4340285314872, -1006.6656796519678, -830.007840673324, -891.801201920485, -1121.0414428547117, -263.5073700888397, -497.0528448092143, -873.5710054877076, -351.6296525447146, -147.76233102517645, -1494.8519388103578, -811.4508556283114, -697.4873801225887, -621.4506628981406, -1167.3584994797054, -1121.9915526995585, -1239.696196034017, -1133.9665494228668, -699.1178582651739, -217.16758933997124, -1246.9532849597308, -586.5615472784848, -979.4453102364376, -286.0454290389204, -288.4654105297666, -1048.9788714276299, -1137.5661386282352, -826.6270516145548, -734.5027872100679, -1023.2130457948646, -1342.9713708520885, -836.8156779041399, -1043.1176423651762, -147.69117654213525, -1114.4556499258501, -613.5486322863226, -394.6611101641849, -1082.0861772098392, -1262.831477684278, -728.2695696351635, -871.6059305682336, -1085.138657629026, -1321.620817331913, -1214.095713526563, -951.366132602278, -178.5899665277236, -513.0085753761844, -1143.8800181095062, -54.20063634681122, -1016.8337727180333, -544.4378459729455, -1107.0606437147462, -559.8681241246767, -968.8779368691129, -297.4118271404783, -1242.556155685094, -343.7909931778873, -921.9034145282376, -575.1455600935393, -1236.9166491715464, -191.35605989656102, -1027.5264742753066, -239.97173944203834, -1221.4171030791254, -353.43190420767473, -1421.711201741263, -728.2055392011821, -59.77652728041343, -749.2216143697674, -65.09953905751495, -623.0023668214687, -972.1879360988303, -661.9605211295418, -1056.6526371429804, -915.8342530004828, -513.3141989829319, -323.951114011616, -1431.9044007935374, -462.2163112975893, -958.6682562326436, -688.0152235835598, -1231.809477856636, -1309.9574956099307], "episode_lengths": [150, 150, 109, 64, 51, 150, 68, 68, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 138, 150, 82, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 81, 102, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 66, 123, 150, 47, 150, 146, 150, 112, 150, 83, 150, 108, 150, 118, 150, 88, 150, 98, 150, 126, 150, 143, 57, 150, 55, 150, 150, 131, 150, 150, 107, 150, 150, 109, 150, 150, 150, 150], "policy_policy_0_reward": [-879.4648665399703, -992.966702249798, -251.46708070915795, -90.36857825943017, -54.06851064371353, -988.1157244839412, -228.12436484446792, -194.56316237345123, -1129.9399758486175, -810.0674937589754, -1299.0703172222957, -802.1121673764309, -378.1685270765871, -1031.3206052693474, -677.5580410849458, -1188.0761605586704, -801.2475591920091, -1064.4340285314872, -1006.6656796519678, -830.007840673324, -891.801201920485, -1121.0414428547117, -263.5073700888397, -497.0528448092143, -873.5710054877076, -351.6296525447146, -147.76233102517645, -1494.8519388103578, -811.4508556283114, -697.4873801225887, -621.4506628981406, -1167.3584994797054, -1121.9915526995585, -1239.696196034017, -1133.9665494228668, -699.1178582651739, -217.16758933997124, -1246.9532849597308, -586.5615472784848, -979.4453102364376, -286.0454290389204, -288.4654105297666, -1048.9788714276299, -1137.5661386282352, -826.6270516145548, -734.5027872100679, -1023.2130457948646, -1342.9713708520885, -836.8156779041399, -1043.1176423651762, -147.69117654213525, -1114.4556499258501, -613.5486322863226, -394.6611101641849, -1082.0861772098392, -1262.831477684278, -728.2695696351635, -871.6059305682336, -1085.138657629026, -1321.620817331913, -1214.095713526563, -951.366132602278, -178.5899665277236, -513.0085753761844, -1143.8800181095062, -54.20063634681122, -1016.8337727180333, -544.4378459729455, -1107.0606437147462, -559.8681241246767, -968.8779368691129, -297.4118271404783, -1242.556155685094, -343.7909931778873, -921.9034145282376, -575.1455600935393, -1236.9166491715464, -191.35605989656102, -1027.5264742753066, -239.97173944203834, -1221.4171030791254, -353.43190420767473, -1421.711201741263, -728.2055392011821, -59.77652728041343, -749.2216143697674, -65.09953905751495, -623.0023668214687, -972.1879360988303, -661.9605211295418, -1056.6526371429804, -915.8342530004828, -513.3141989829319, -323.951114011616, -1431.9044007935374, -462.2163112975893, -958.6682562326436, -688.0152235835598, -1231.809477856636, -1309.9574956099307]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555056004334435, "mean_inference_ms": 1.663114690337349, "mean_action_processing_ms": 0.27802021999458204, "mean_env_wait_ms": 3.439373429815002, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012359380722045898, "StateBufferConnector_ms": 0.012068986892700195, "ViewRequirementAgentConnector_ms": 0.19695472717285156}, "num_episodes": 32, "episode_return_max": -54.06851064371353, "episode_return_min": -1494.8519388103578, "episode_return_mean": -781.2902094539512, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.0747336004949, "num_env_steps_trained_throughput_per_sec": 307.0747336004949, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12794.048, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12793.977, "sample_time_ms": 1120.542, "learn_time_ms": 11601.372, "learn_throughput": 344.787, "synch_weights_time_ms": 71.223}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00000", "date": "2024-08-04_05-29-24", "timestamp": 1722729564, "time_this_iter_s": 13.038345098495483, "time_total_s": 115.25803279876709, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16ee81f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.25803279876709, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.105263157894736, "ram_util_percent": 27.7}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 182.5819176097711, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.1401329956327877, "policy_loss": -0.008516564182840133, "vf_loss": 3.1444561103979747, "vf_explained_var": 0.9804901798566182, "kl": 0.014428401651972926, "entropy": 1.3506688838203749, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -54.20063634681122, "episode_reward_min": -1431.9044007935374, "episode_reward_mean": -773.8508706105501, "episode_len_mean": 132.14, "episode_media": {}, "episodes_timesteps_total": 13214, "policy_reward_min": {"policy_0": -1431.9044007935374}, "policy_reward_max": {"policy_0": -54.20063634681122}, "policy_reward_mean": {"policy_0": -773.8508706105501}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1167.3584994797054, -1121.9915526995585, -1239.696196034017, -1133.9665494228668, -699.1178582651739, -217.16758933997124, -1246.9532849597308, -586.5615472784848, -979.4453102364376, -286.0454290389204, -288.4654105297666, -1048.9788714276299, -1137.5661386282352, -826.6270516145548, -734.5027872100679, -1023.2130457948646, -1342.9713708520885, -836.8156779041399, -1043.1176423651762, -147.69117654213525, -1114.4556499258501, -613.5486322863226, -394.6611101641849, -1082.0861772098392, -1262.831477684278, -728.2695696351635, -871.6059305682336, -1085.138657629026, -1321.620817331913, -1214.095713526563, -951.366132602278, -178.5899665277236, -513.0085753761844, -1143.8800181095062, -54.20063634681122, -1016.8337727180333, -544.4378459729455, -1107.0606437147462, -559.8681241246767, -968.8779368691129, -297.4118271404783, -1242.556155685094, -343.7909931778873, -921.9034145282376, -575.1455600935393, -1236.9166491715464, -191.35605989656102, -1027.5264742753066, -239.97173944203834, -1221.4171030791254, -353.43190420767473, -1421.711201741263, -728.2055392011821, -59.77652728041343, -749.2216143697674, -65.09953905751495, -623.0023668214687, -972.1879360988303, -661.9605211295418, -1056.6526371429804, -915.8342530004828, -513.3141989829319, -323.951114011616, -1431.9044007935374, -462.2163112975893, -958.6682562326436, -688.0152235835598, -1231.809477856636, -1309.9574956099307, -570.2981678522814, -70.3307511018222, -1114.8592351301902, -1097.8608530465433, -873.4526279833511, -1097.9547879776442, -702.7803280031677, -689.0564948840894, -943.0057163605991, -1089.9520777457333, -591.3448000717375, -973.2032421923127, -1373.8219232308556, -189.22818110905158, -202.4742440915941, -1269.7982311651426, -1030.1198960181796, -461.55486042318927, -615.07259997205, -951.4031456750636, -347.6013425012528, -92.16202960018573, -962.7849570658001, -129.78173061782388, -861.7654837793393, -1013.0315823565581, -683.8966744317249, -84.72892643089834, -1233.9772908782932, -103.11027030689857, -305.0677361953444], "episode_lengths": [150, 150, 150, 150, 150, 67, 150, 150, 150, 81, 102, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 66, 123, 150, 47, 150, 146, 150, 112, 150, 83, 150, 108, 150, 118, 150, 88, 150, 98, 150, 126, 150, 143, 57, 150, 55, 150, 150, 131, 150, 150, 107, 150, 150, 109, 150, 150, 150, 150, 124, 62, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 63, 93, 150, 150, 150, 150, 150, 150, 62, 150, 93, 150, 150, 150, 57, 150, 63, 150], "policy_policy_0_reward": [-1167.3584994797054, -1121.9915526995585, -1239.696196034017, -1133.9665494228668, -699.1178582651739, -217.16758933997124, -1246.9532849597308, -586.5615472784848, -979.4453102364376, -286.0454290389204, -288.4654105297666, -1048.9788714276299, -1137.5661386282352, -826.6270516145548, -734.5027872100679, -1023.2130457948646, -1342.9713708520885, -836.8156779041399, -1043.1176423651762, -147.69117654213525, -1114.4556499258501, -613.5486322863226, -394.6611101641849, -1082.0861772098392, -1262.831477684278, -728.2695696351635, -871.6059305682336, -1085.138657629026, -1321.620817331913, -1214.095713526563, -951.366132602278, -178.5899665277236, -513.0085753761844, -1143.8800181095062, -54.20063634681122, -1016.8337727180333, -544.4378459729455, -1107.0606437147462, -559.8681241246767, -968.8779368691129, -297.4118271404783, -1242.556155685094, -343.7909931778873, -921.9034145282376, -575.1455600935393, -1236.9166491715464, -191.35605989656102, -1027.5264742753066, -239.97173944203834, -1221.4171030791254, -353.43190420767473, -1421.711201741263, -728.2055392011821, -59.77652728041343, -749.2216143697674, -65.09953905751495, -623.0023668214687, -972.1879360988303, -661.9605211295418, -1056.6526371429804, -915.8342530004828, -513.3141989829319, -323.951114011616, -1431.9044007935374, -462.2163112975893, -958.6682562326436, -688.0152235835598, -1231.809477856636, -1309.9574956099307, -570.2981678522814, -70.3307511018222, -1114.8592351301902, -1097.8608530465433, -873.4526279833511, -1097.9547879776442, -702.7803280031677, -689.0564948840894, -943.0057163605991, -1089.9520777457333, -591.3448000717375, -973.2032421923127, -1373.8219232308556, -189.22818110905158, -202.4742440915941, -1269.7982311651426, -1030.1198960181796, -461.55486042318927, -615.07259997205, -951.4031456750636, -347.6013425012528, -92.16202960018573, -962.7849570658001, -129.78173061782388, -861.7654837793393, -1013.0315823565581, -683.8966744317249, -84.72892643089834, -1233.9772908782932, -103.11027030689857, -305.0677361953444]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5570802294133193, "mean_inference_ms": 1.6660043844170533, "mean_action_processing_ms": 0.27783404718549326, "mean_env_wait_ms": 3.4495396948535664, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012210845947265625, "StateBufferConnector_ms": 0.011836528778076172, "ViewRequirementAgentConnector_ms": 0.20628952980041504}, "num_episodes": 31, "episode_return_max": -54.20063634681122, "episode_return_min": -1431.9044007935374, "episode_return_mean": -773.8508706105501, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.4370609155029, "num_env_steps_trained_throughput_per_sec": 311.4370609155029, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12799.013, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12798.941, "sample_time_ms": 1127.412, "learn_time_ms": 11600.683, "learn_throughput": 344.807, "synch_weights_time_ms": 70.015}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00000", "date": "2024-08-04_05-29-37", "timestamp": 1722729577, "time_this_iter_s": 12.856173276901245, "time_total_s": 128.11420607566833, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16ee83a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 128.11420607566833, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.033333333333335, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 177.65936995148658, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.8235529234011967, "policy_loss": -0.00853752891998738, "vf_loss": 2.82813519363602, "vf_explained_var": 0.9844365458314618, "kl": 0.013613765354087566, "entropy": 1.2886503741145134, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -2.2574233568929047, "episode_reward_min": -1431.9044007935374, "episode_reward_mean": -681.5807630891937, "episode_len_mean": 127.68, "episode_media": {}, "episodes_timesteps_total": 12768, "policy_reward_min": {"policy_0": -1431.9044007935374}, "policy_reward_max": {"policy_0": -2.2574233568929047}, "policy_reward_mean": {"policy_0": -681.5807630891937}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-54.20063634681122, -1016.8337727180333, -544.4378459729455, -1107.0606437147462, -559.8681241246767, -968.8779368691129, -297.4118271404783, -1242.556155685094, -343.7909931778873, -921.9034145282376, -575.1455600935393, -1236.9166491715464, -191.35605989656102, -1027.5264742753066, -239.97173944203834, -1221.4171030791254, -353.43190420767473, -1421.711201741263, -728.2055392011821, -59.77652728041343, -749.2216143697674, -65.09953905751495, -623.0023668214687, -972.1879360988303, -661.9605211295418, -1056.6526371429804, -915.8342530004828, -513.3141989829319, -323.951114011616, -1431.9044007935374, -462.2163112975893, -958.6682562326436, -688.0152235835598, -1231.809477856636, -1309.9574956099307, -570.2981678522814, -70.3307511018222, -1114.8592351301902, -1097.8608530465433, -873.4526279833511, -1097.9547879776442, -702.7803280031677, -689.0564948840894, -943.0057163605991, -1089.9520777457333, -591.3448000717375, -973.2032421923127, -1373.8219232308556, -189.22818110905158, -202.4742440915941, -1269.7982311651426, -1030.1198960181796, -461.55486042318927, -615.07259997205, -951.4031456750636, -347.6013425012528, -92.16202960018573, -962.7849570658001, -129.78173061782388, -861.7654837793393, -1013.0315823565581, -683.8966744317249, -84.72892643089834, -1233.9772908782932, -103.11027030689857, -305.0677361953444, -684.3962023248903, -1130.8454164632224, -286.5183821937011, -933.9915454038936, -73.88262844915754, -1002.976220764501, -682.8340473863184, -540.1027450262986, -18.343204492138263, -307.1150907269075, -611.3011361638983, -1121.411688380292, -9.57510652999953, -759.266995727546, -784.301754187589, -681.7696984120644, -1174.5588569548906, -1018.8117485495201, -49.23165940566911, -825.1194792502832, -786.1049423560928, -203.25922934329472, -2.2574233568929047, -55.20533101176213, -1069.9593721041751, -261.5450827940613, -1058.4383388500348, -321.58716409397147, -266.8780793941509, -412.53420644171933, -587.4476014338921, -999.708245467366, -870.9037878890122, -764.2182547357302], "episode_lengths": [47, 150, 146, 150, 112, 150, 83, 150, 108, 150, 118, 150, 88, 150, 98, 150, 126, 150, 143, 57, 150, 55, 150, 150, 131, 150, 150, 107, 150, 150, 109, 150, 150, 150, 150, 124, 62, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 63, 93, 150, 150, 150, 150, 150, 150, 62, 150, 93, 150, 150, 150, 57, 150, 63, 150, 150, 150, 108, 150, 58, 150, 150, 150, 39, 93, 150, 150, 41, 150, 150, 124, 150, 150, 56, 150, 150, 91, 34, 49, 150, 112, 150, 99, 149, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-54.20063634681122, -1016.8337727180333, -544.4378459729455, -1107.0606437147462, -559.8681241246767, -968.8779368691129, -297.4118271404783, -1242.556155685094, -343.7909931778873, -921.9034145282376, -575.1455600935393, -1236.9166491715464, -191.35605989656102, -1027.5264742753066, -239.97173944203834, -1221.4171030791254, -353.43190420767473, -1421.711201741263, -728.2055392011821, -59.77652728041343, -749.2216143697674, -65.09953905751495, -623.0023668214687, -972.1879360988303, -661.9605211295418, -1056.6526371429804, -915.8342530004828, -513.3141989829319, -323.951114011616, -1431.9044007935374, -462.2163112975893, -958.6682562326436, -688.0152235835598, -1231.809477856636, -1309.9574956099307, -570.2981678522814, -70.3307511018222, -1114.8592351301902, -1097.8608530465433, -873.4526279833511, -1097.9547879776442, -702.7803280031677, -689.0564948840894, -943.0057163605991, -1089.9520777457333, -591.3448000717375, -973.2032421923127, -1373.8219232308556, -189.22818110905158, -202.4742440915941, -1269.7982311651426, -1030.1198960181796, -461.55486042318927, -615.07259997205, -951.4031456750636, -347.6013425012528, -92.16202960018573, -962.7849570658001, -129.78173061782388, -861.7654837793393, -1013.0315823565581, -683.8966744317249, -84.72892643089834, -1233.9772908782932, -103.11027030689857, -305.0677361953444, -684.3962023248903, -1130.8454164632224, -286.5183821937011, -933.9915454038936, -73.88262844915754, -1002.976220764501, -682.8340473863184, -540.1027450262986, -18.343204492138263, -307.1150907269075, -611.3011361638983, -1121.411688380292, -9.57510652999953, -759.266995727546, -784.301754187589, -681.7696984120644, -1174.5588569548906, -1018.8117485495201, -49.23165940566911, -825.1194792502832, -786.1049423560928, -203.25922934329472, -2.2574233568929047, -55.20533101176213, -1069.9593721041751, -261.5450827940613, -1058.4383388500348, -321.58716409397147, -266.8780793941509, -412.53420644171933, -587.4476014338921, -999.708245467366, -870.9037878890122, -764.2182547357302]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5585229078535925, "mean_inference_ms": 1.668801598116081, "mean_action_processing_ms": 0.2772194097695517, "mean_env_wait_ms": 3.456463497637208, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012162208557128906, "StateBufferConnector_ms": 0.007974386215209961, "ViewRequirementAgentConnector_ms": 0.20404362678527832}, "num_episodes": 34, "episode_return_max": -2.2574233568929047, "episode_return_min": -1431.9044007935374, "episode_return_mean": -681.5807630891937, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.359161529308, "num_env_steps_trained_throughput_per_sec": 306.359161529308, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12824.109, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12824.037, "sample_time_ms": 1127.905, "learn_time_ms": 11624.491, "learn_throughput": 344.101, "synch_weights_time_ms": 70.798}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00000", "date": "2024-08-04_05-29-50", "timestamp": 1722729590, "time_this_iter_s": 13.069819927215576, "time_total_s": 141.1840260028839, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16ee8f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 141.1840260028839, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.13157894736842, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 182.06746544142564, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.791854497790337, "policy_loss": -0.016195160674396903, "vf_loss": 2.8033674068748953, "vf_explained_var": 0.9797555924703677, "kl": 0.016034486898115576, "entropy": 1.2810114464412132, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -2.2574233568929047, "episode_reward_min": -1373.8219232308556, "episode_reward_mean": -682.0234476723521, "episode_len_mean": 129.24, "episode_media": {}, "episodes_timesteps_total": 12924, "policy_reward_min": {"policy_0": -1373.8219232308556}, "policy_reward_max": {"policy_0": -2.2574233568929047}, "policy_reward_mean": {"policy_0": -682.0234476723521}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-462.2163112975893, -958.6682562326436, -688.0152235835598, -1231.809477856636, -1309.9574956099307, -570.2981678522814, -70.3307511018222, -1114.8592351301902, -1097.8608530465433, -873.4526279833511, -1097.9547879776442, -702.7803280031677, -689.0564948840894, -943.0057163605991, -1089.9520777457333, -591.3448000717375, -973.2032421923127, -1373.8219232308556, -189.22818110905158, -202.4742440915941, -1269.7982311651426, -1030.1198960181796, -461.55486042318927, -615.07259997205, -951.4031456750636, -347.6013425012528, -92.16202960018573, -962.7849570658001, -129.78173061782388, -861.7654837793393, -1013.0315823565581, -683.8966744317249, -84.72892643089834, -1233.9772908782932, -103.11027030689857, -305.0677361953444, -684.3962023248903, -1130.8454164632224, -286.5183821937011, -933.9915454038936, -73.88262844915754, -1002.976220764501, -682.8340473863184, -540.1027450262986, -18.343204492138263, -307.1150907269075, -611.3011361638983, -1121.411688380292, -9.57510652999953, -759.266995727546, -784.301754187589, -681.7696984120644, -1174.5588569548906, -1018.8117485495201, -49.23165940566911, -825.1194792502832, -786.1049423560928, -203.25922934329472, -2.2574233568929047, -55.20533101176213, -1069.9593721041751, -261.5450827940613, -1058.4383388500348, -321.58716409397147, -266.8780793941509, -412.53420644171933, -587.4476014338921, -999.708245467366, -870.9037878890122, -764.2182547357302, -1334.002615396506, -698.1467548883866, -1259.0596848306636, -1061.2307623689446, -1032.4098691641907, -424.1459812960116, -503.7452330236552, -758.9668074178314, -968.5880365362196, -860.1978690163452, -957.61480607193, -469.68774128761004, -178.53294120673525, -559.1962606622089, -1267.6016691056918, -741.352586658011, -842.2075253141647, -945.6962352777191, -1012.9134731829691, -64.04788874575573, -780.0734408706505, -440.0252289891546, -587.8121397498703, -1214.5149722805156, -102.95157405343714, -155.14146367011867, -1071.4223073694236, -128.37622532425917, -269.4802137234881, -780.6548409087053], "episode_lengths": [109, 150, 150, 150, 150, 124, 62, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 63, 93, 150, 150, 150, 150, 150, 150, 62, 150, 93, 150, 150, 150, 57, 150, 63, 150, 150, 150, 108, 150, 58, 150, 150, 150, 39, 93, 150, 150, 41, 150, 150, 124, 150, 150, 56, 150, 150, 91, 34, 49, 150, 112, 150, 99, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 126, 79, 150, 150, 150, 150, 148, 150, 49, 150, 150, 150, 150, 74, 69, 150, 69, 75, 150], "policy_policy_0_reward": [-462.2163112975893, -958.6682562326436, -688.0152235835598, -1231.809477856636, -1309.9574956099307, -570.2981678522814, -70.3307511018222, -1114.8592351301902, -1097.8608530465433, -873.4526279833511, -1097.9547879776442, -702.7803280031677, -689.0564948840894, -943.0057163605991, -1089.9520777457333, -591.3448000717375, -973.2032421923127, -1373.8219232308556, -189.22818110905158, -202.4742440915941, -1269.7982311651426, -1030.1198960181796, -461.55486042318927, -615.07259997205, -951.4031456750636, -347.6013425012528, -92.16202960018573, -962.7849570658001, -129.78173061782388, -861.7654837793393, -1013.0315823565581, -683.8966744317249, -84.72892643089834, -1233.9772908782932, -103.11027030689857, -305.0677361953444, -684.3962023248903, -1130.8454164632224, -286.5183821937011, -933.9915454038936, -73.88262844915754, -1002.976220764501, -682.8340473863184, -540.1027450262986, -18.343204492138263, -307.1150907269075, -611.3011361638983, -1121.411688380292, -9.57510652999953, -759.266995727546, -784.301754187589, -681.7696984120644, -1174.5588569548906, -1018.8117485495201, -49.23165940566911, -825.1194792502832, -786.1049423560928, -203.25922934329472, -2.2574233568929047, -55.20533101176213, -1069.9593721041751, -261.5450827940613, -1058.4383388500348, -321.58716409397147, -266.8780793941509, -412.53420644171933, -587.4476014338921, -999.708245467366, -870.9037878890122, -764.2182547357302, -1334.002615396506, -698.1467548883866, -1259.0596848306636, -1061.2307623689446, -1032.4098691641907, -424.1459812960116, -503.7452330236552, -758.9668074178314, -968.5880365362196, -860.1978690163452, -957.61480607193, -469.68774128761004, -178.53294120673525, -559.1962606622089, -1267.6016691056918, -741.352586658011, -842.2075253141647, -945.6962352777191, -1012.9134731829691, -64.04788874575573, -780.0734408706505, -440.0252289891546, -587.8121397498703, -1214.5149722805156, -102.95157405343714, -155.14146367011867, -1071.4223073694236, -128.37622532425917, -269.4802137234881, -780.6548409087053]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5598471377537373, "mean_inference_ms": 1.6694509133267121, "mean_action_processing_ms": 0.2768975540798234, "mean_env_wait_ms": 3.454576455808385, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012335538864135742, "StateBufferConnector_ms": 0.00797414779663086, "ViewRequirementAgentConnector_ms": 0.2053360939025879}, "num_episodes": 30, "episode_return_max": -2.2574233568929047, "episode_return_min": -1373.8219232308556, "episode_return_mean": -682.0234476723521, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.3185386717426, "num_env_steps_trained_throughput_per_sec": 311.3185386717426, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12832.343, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12832.269, "sample_time_ms": 1140.328, "learn_time_ms": 11621.797, "learn_throughput": 344.181, "synch_weights_time_ms": 69.315}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00000", "date": "2024-08-04_05-30-03", "timestamp": 1722729603, "time_this_iter_s": 12.86050295829773, "time_total_s": 154.04452896118164, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16eea4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 154.04452896118164, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.227777777777774, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 185.6294215619564, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.8142226237803696, "policy_loss": -0.005812147810744742, "vf_loss": 2.8162051708747944, "vf_explained_var": 0.9638083464776476, "kl": 0.013184160758040282, "entropy": 1.256467584023873, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -2.2574233568929047, "episode_reward_min": -1334.002615396506, "episode_reward_mean": -638.9194798267207, "episode_len_mean": 128.57, "episode_media": {}, "episodes_timesteps_total": 12857, "policy_reward_min": {"policy_0": -1334.002615396506}, "policy_reward_max": {"policy_0": -2.2574233568929047}, "policy_reward_mean": {"policy_0": -638.9194798267207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-129.78173061782388, -861.7654837793393, -1013.0315823565581, -683.8966744317249, -84.72892643089834, -1233.9772908782932, -103.11027030689857, -305.0677361953444, -684.3962023248903, -1130.8454164632224, -286.5183821937011, -933.9915454038936, -73.88262844915754, -1002.976220764501, -682.8340473863184, -540.1027450262986, -18.343204492138263, -307.1150907269075, -611.3011361638983, -1121.411688380292, -9.57510652999953, -759.266995727546, -784.301754187589, -681.7696984120644, -1174.5588569548906, -1018.8117485495201, -49.23165940566911, -825.1194792502832, -786.1049423560928, -203.25922934329472, -2.2574233568929047, -55.20533101176213, -1069.9593721041751, -261.5450827940613, -1058.4383388500348, -321.58716409397147, -266.8780793941509, -412.53420644171933, -587.4476014338921, -999.708245467366, -870.9037878890122, -764.2182547357302, -1334.002615396506, -698.1467548883866, -1259.0596848306636, -1061.2307623689446, -1032.4098691641907, -424.1459812960116, -503.7452330236552, -758.9668074178314, -968.5880365362196, -860.1978690163452, -957.61480607193, -469.68774128761004, -178.53294120673525, -559.1962606622089, -1267.6016691056918, -741.352586658011, -842.2075253141647, -945.6962352777191, -1012.9134731829691, -64.04788874575573, -780.0734408706505, -440.0252289891546, -587.8121397498703, -1214.5149722805156, -102.95157405343714, -155.14146367011867, -1071.4223073694236, -128.37622532425917, -269.4802137234881, -780.6548409087053, -462.770169755936, -354.1953069724457, -597.3200036760911, -694.9467229590144, -543.8061230220254, -972.0891716513743, -533.3092570405074, -1019.9718909295236, -538.3845239491782, -1114.9510546110948, -1097.100015848477, -701.8591718962064, -1103.8714201298508, -392.51121822325797, -101.97967672075596, -1125.4141430289567, -651.0740150928317, -719.1889997987984, -658.4625089499181, -622.4760793417943, -138.013760759345, -704.1663494288114, -606.9234323875057, -528.4189056850511, -187.8601340830249, -1222.6211761853576, -68.97845988160765, -187.72678121033184], "episode_lengths": [93, 150, 150, 150, 57, 150, 63, 150, 150, 150, 108, 150, 58, 150, 150, 150, 39, 93, 150, 150, 41, 150, 150, 124, 150, 150, 56, 150, 150, 91, 34, 49, 150, 112, 150, 99, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 126, 79, 150, 150, 150, 150, 148, 150, 49, 150, 150, 150, 150, 74, 69, 150, 69, 75, 150, 150, 150, 138, 150, 122, 150, 150, 150, 119, 150, 150, 140, 150, 150, 77, 150, 150, 150, 150, 150, 55, 150, 131, 119, 64, 150, 51, 150], "policy_policy_0_reward": [-129.78173061782388, -861.7654837793393, -1013.0315823565581, -683.8966744317249, -84.72892643089834, -1233.9772908782932, -103.11027030689857, -305.0677361953444, -684.3962023248903, -1130.8454164632224, -286.5183821937011, -933.9915454038936, -73.88262844915754, -1002.976220764501, -682.8340473863184, -540.1027450262986, -18.343204492138263, -307.1150907269075, -611.3011361638983, -1121.411688380292, -9.57510652999953, -759.266995727546, -784.301754187589, -681.7696984120644, -1174.5588569548906, -1018.8117485495201, -49.23165940566911, -825.1194792502832, -786.1049423560928, -203.25922934329472, -2.2574233568929047, -55.20533101176213, -1069.9593721041751, -261.5450827940613, -1058.4383388500348, -321.58716409397147, -266.8780793941509, -412.53420644171933, -587.4476014338921, -999.708245467366, -870.9037878890122, -764.2182547357302, -1334.002615396506, -698.1467548883866, -1259.0596848306636, -1061.2307623689446, -1032.4098691641907, -424.1459812960116, -503.7452330236552, -758.9668074178314, -968.5880365362196, -860.1978690163452, -957.61480607193, -469.68774128761004, -178.53294120673525, -559.1962606622089, -1267.6016691056918, -741.352586658011, -842.2075253141647, -945.6962352777191, -1012.9134731829691, -64.04788874575573, -780.0734408706505, -440.0252289891546, -587.8121397498703, -1214.5149722805156, -102.95157405343714, -155.14146367011867, -1071.4223073694236, -128.37622532425917, -269.4802137234881, -780.6548409087053, -462.770169755936, -354.1953069724457, -597.3200036760911, -694.9467229590144, -543.8061230220254, -972.0891716513743, -533.3092570405074, -1019.9718909295236, -538.3845239491782, -1114.9510546110948, -1097.100015848477, -701.8591718962064, -1103.8714201298508, -392.51121822325797, -101.97967672075596, -1125.4141430289567, -651.0740150928317, -719.1889997987984, -658.4625089499181, -622.4760793417943, -138.013760759345, -704.1663494288114, -606.9234323875057, -528.4189056850511, -187.8601340830249, -1222.6211761853576, -68.97845988160765, -187.72678121033184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5587644891528443, "mean_inference_ms": 1.6696486172531977, "mean_action_processing_ms": 0.27706774220147473, "mean_env_wait_ms": 3.4537194701041187, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012228012084960938, "StateBufferConnector_ms": 0.007990598678588867, "ViewRequirementAgentConnector_ms": 0.19462919235229492}, "num_episodes": 28, "episode_return_max": -2.2574233568929047, "episode_return_min": -1334.002615396506, "episode_return_mean": -638.9194798267207, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 381.0785239701597, "num_env_steps_trained_throughput_per_sec": 381.0785239701597, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12618.003, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12617.929, "sample_time_ms": 1138.404, "learn_time_ms": 11409.566, "learn_throughput": 350.583, "synch_weights_time_ms": 69.123}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00000", "date": "2024-08-04_05-30-13", "timestamp": 1722729613, "time_this_iter_s": 10.507584571838379, "time_total_s": 164.55211353302002, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a1725a560>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 164.55211353302002, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.233333333333334, "ram_util_percent": 27.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 190.4484043518702, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.1626621281728147, "policy_loss": -0.011879282047933279, "vf_loss": 2.1701815887043874, "vf_explained_var": 0.9789858141293128, "kl": 0.015007007370862387, "entropy": 1.4228405017405747, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -2.2574233568929047, "episode_reward_min": -1334.002615396506, "episode_reward_mean": -663.0079299284386, "episode_len_mean": 131.33, "episode_media": {}, "episodes_timesteps_total": 13133, "policy_reward_min": {"policy_0": -1334.002615396506}, "policy_reward_max": {"policy_0": -2.2574233568929047}, "policy_reward_mean": {"policy_0": -663.0079299284386}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.2574233568929047, -55.20533101176213, -1069.9593721041751, -261.5450827940613, -1058.4383388500348, -321.58716409397147, -266.8780793941509, -412.53420644171933, -587.4476014338921, -999.708245467366, -870.9037878890122, -764.2182547357302, -1334.002615396506, -698.1467548883866, -1259.0596848306636, -1061.2307623689446, -1032.4098691641907, -424.1459812960116, -503.7452330236552, -758.9668074178314, -968.5880365362196, -860.1978690163452, -957.61480607193, -469.68774128761004, -178.53294120673525, -559.1962606622089, -1267.6016691056918, -741.352586658011, -842.2075253141647, -945.6962352777191, -1012.9134731829691, -64.04788874575573, -780.0734408706505, -440.0252289891546, -587.8121397498703, -1214.5149722805156, -102.95157405343714, -155.14146367011867, -1071.4223073694236, -128.37622532425917, -269.4802137234881, -780.6548409087053, -462.770169755936, -354.1953069724457, -597.3200036760911, -694.9467229590144, -543.8061230220254, -972.0891716513743, -533.3092570405074, -1019.9718909295236, -538.3845239491782, -1114.9510546110948, -1097.100015848477, -701.8591718962064, -1103.8714201298508, -392.51121822325797, -101.97967672075596, -1125.4141430289567, -651.0740150928317, -719.1889997987984, -658.4625089499181, -622.4760793417943, -138.013760759345, -704.1663494288114, -606.9234323875057, -528.4189056850511, -187.8601340830249, -1222.6211761853576, -68.97845988160765, -187.72678121033184, -34.15724180869417, -285.09814875121486, -996.1664992928146, -633.7339608849148, -170.38315062080324, -948.4599521193064, -927.2034773570282, -246.7336453355105, -715.5746767982029, -967.3593728005918, -759.7858906537133, -897.0183624705824, -752.2814054644278, -542.3933391750882, -245.2683813291127, -335.2115187131378, -498.1158782601403, -1104.6209157406383, -645.7559941003985, -1238.8905826243072, -1035.1179275688976, -766.5752162095881, -1086.0503191739322, -1333.3600453321867, -158.06411674847834, -629.8748549409622, -291.8107956097696, -475.9694365635261, -740.0682440392779, -1048.8191331735884], "episode_lengths": [34, 49, 150, 112, 150, 99, 149, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 136, 150, 150, 150, 150, 126, 79, 150, 150, 150, 150, 148, 150, 49, 150, 150, 150, 150, 74, 69, 150, 69, 75, 150, 150, 150, 138, 150, 122, 150, 150, 150, 119, 150, 150, 140, 150, 150, 77, 150, 150, 150, 150, 150, 55, 150, 131, 119, 64, 150, 51, 150, 59, 77, 150, 150, 93, 150, 150, 85, 149, 150, 150, 150, 150, 150, 86, 95, 108, 150, 150, 150, 150, 150, 150, 150, 74, 150, 123, 150, 150, 150], "policy_policy_0_reward": [-2.2574233568929047, -55.20533101176213, -1069.9593721041751, -261.5450827940613, -1058.4383388500348, -321.58716409397147, -266.8780793941509, -412.53420644171933, -587.4476014338921, -999.708245467366, -870.9037878890122, -764.2182547357302, -1334.002615396506, -698.1467548883866, -1259.0596848306636, -1061.2307623689446, -1032.4098691641907, -424.1459812960116, -503.7452330236552, -758.9668074178314, -968.5880365362196, -860.1978690163452, -957.61480607193, -469.68774128761004, -178.53294120673525, -559.1962606622089, -1267.6016691056918, -741.352586658011, -842.2075253141647, -945.6962352777191, -1012.9134731829691, -64.04788874575573, -780.0734408706505, -440.0252289891546, -587.8121397498703, -1214.5149722805156, -102.95157405343714, -155.14146367011867, -1071.4223073694236, -128.37622532425917, -269.4802137234881, -780.6548409087053, -462.770169755936, -354.1953069724457, -597.3200036760911, -694.9467229590144, -543.8061230220254, -972.0891716513743, -533.3092570405074, -1019.9718909295236, -538.3845239491782, -1114.9510546110948, -1097.100015848477, -701.8591718962064, -1103.8714201298508, -392.51121822325797, -101.97967672075596, -1125.4141430289567, -651.0740150928317, -719.1889997987984, -658.4625089499181, -622.4760793417943, -138.013760759345, -704.1663494288114, -606.9234323875057, -528.4189056850511, -187.8601340830249, -1222.6211761853576, -68.97845988160765, -187.72678121033184, -34.15724180869417, -285.09814875121486, -996.1664992928146, -633.7339608849148, -170.38315062080324, -948.4599521193064, -927.2034773570282, -246.7336453355105, -715.5746767982029, -967.3593728005918, -759.7858906537133, -897.0183624705824, -752.2814054644278, -542.3933391750882, -245.2683813291127, -335.2115187131378, -498.1158782601403, -1104.6209157406383, -645.7559941003985, -1238.8905826243072, -1035.1179275688976, -766.5752162095881, -1086.0503191739322, -1333.3600453321867, -158.06411674847834, -629.8748549409622, -291.8107956097696, -475.9694365635261, -740.0682440392779, -1048.8191331735884]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5597083238812853, "mean_inference_ms": 1.667513924087527, "mean_action_processing_ms": 0.27669209659003174, "mean_env_wait_ms": 3.4484560177029016, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011888980865478516, "StateBufferConnector_ms": 0.007978677749633789, "ViewRequirementAgentConnector_ms": 0.1947009563446045}, "num_episodes": 30, "episode_return_max": -2.2574233568929047, "episode_return_min": -1334.002615396506, "episode_return_mean": -663.0079299284386, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.37712103793166, "num_env_steps_trained_throughput_per_sec": 311.37712103793166, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12634.467, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12634.393, "sample_time_ms": 1139.709, "learn_time_ms": 11424.963, "learn_throughput": 350.111, "synch_weights_time_ms": 68.846}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00000", "date": "2024-08-04_05-30-26", "timestamp": 1722729626, "time_this_iter_s": 12.857588529586792, "time_total_s": 177.4097020626068, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a172d13f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 177.4097020626068, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.633333333333336, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 182.63728133042653, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.496324786171317, "policy_loss": -0.008396688721162112, "vf_loss": 2.5006292443722486, "vf_explained_var": 0.9912340216959517, "kl": 0.014135421686478366, "entropy": 1.483918968960643, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -34.15724180869417, "episode_reward_min": -1397.8389610194838, "episode_reward_mean": -683.7090363764054, "episode_len_mean": 132.7, "episode_media": {}, "episodes_timesteps_total": 13270, "policy_reward_min": {"policy_0": -1397.8389610194838}, "policy_reward_max": {"policy_0": -34.15724180869417}, "policy_reward_mean": {"policy_0": -683.7090363764054}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-780.0734408706505, -440.0252289891546, -587.8121397498703, -1214.5149722805156, -102.95157405343714, -155.14146367011867, -1071.4223073694236, -128.37622532425917, -269.4802137234881, -780.6548409087053, -462.770169755936, -354.1953069724457, -597.3200036760911, -694.9467229590144, -543.8061230220254, -972.0891716513743, -533.3092570405074, -1019.9718909295236, -538.3845239491782, -1114.9510546110948, -1097.100015848477, -701.8591718962064, -1103.8714201298508, -392.51121822325797, -101.97967672075596, -1125.4141430289567, -651.0740150928317, -719.1889997987984, -658.4625089499181, -622.4760793417943, -138.013760759345, -704.1663494288114, -606.9234323875057, -528.4189056850511, -187.8601340830249, -1222.6211761853576, -68.97845988160765, -187.72678121033184, -34.15724180869417, -285.09814875121486, -996.1664992928146, -633.7339608849148, -170.38315062080324, -948.4599521193064, -927.2034773570282, -246.7336453355105, -715.5746767982029, -967.3593728005918, -759.7858906537133, -897.0183624705824, -752.2814054644278, -542.3933391750882, -245.2683813291127, -335.2115187131378, -498.1158782601403, -1104.6209157406383, -645.7559941003985, -1238.8905826243072, -1035.1179275688976, -766.5752162095881, -1086.0503191739322, -1333.3600453321867, -158.06411674847834, -629.8748549409622, -291.8107956097696, -475.9694365635261, -740.0682440392779, -1048.8191331735884, -532.4027395624801, -568.7565888176024, -1170.5764868849278, -904.6288362701455, -613.2013328832406, -347.3216806831016, -906.8454898042959, -1007.830536138784, -1397.8389610194838, -1114.3737682764947, -461.7834355525159, -839.8099980645003, -430.32595443544625, -1295.3170508848868, -58.40641814356648, -862.5822031249972, -740.1774833179022, -146.03433883288577, -848.3183741522342, -982.2173449705933, -296.92387194910003, -1121.9624767090713, -986.9025291486845, -558.5975111587411, -944.8827103602757, -850.4433967134877, -1263.4891086382192, -55.07649323066347, -1236.1339417898685, -949.9395270671356, -936.3103296939973, -250.72735554166945], "episode_lengths": [150, 150, 150, 150, 74, 69, 150, 69, 75, 150, 150, 150, 138, 150, 122, 150, 150, 150, 119, 150, 150, 140, 150, 150, 77, 150, 150, 150, 150, 150, 55, 150, 131, 119, 64, 150, 51, 150, 59, 77, 150, 150, 93, 150, 150, 85, 149, 150, 150, 150, 150, 150, 86, 95, 108, 150, 150, 150, 150, 150, 150, 150, 74, 150, 123, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 84, 150, 150, 100, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 114], "policy_policy_0_reward": [-780.0734408706505, -440.0252289891546, -587.8121397498703, -1214.5149722805156, -102.95157405343714, -155.14146367011867, -1071.4223073694236, -128.37622532425917, -269.4802137234881, -780.6548409087053, -462.770169755936, -354.1953069724457, -597.3200036760911, -694.9467229590144, -543.8061230220254, -972.0891716513743, -533.3092570405074, -1019.9718909295236, -538.3845239491782, -1114.9510546110948, -1097.100015848477, -701.8591718962064, -1103.8714201298508, -392.51121822325797, -101.97967672075596, -1125.4141430289567, -651.0740150928317, -719.1889997987984, -658.4625089499181, -622.4760793417943, -138.013760759345, -704.1663494288114, -606.9234323875057, -528.4189056850511, -187.8601340830249, -1222.6211761853576, -68.97845988160765, -187.72678121033184, -34.15724180869417, -285.09814875121486, -996.1664992928146, -633.7339608849148, -170.38315062080324, -948.4599521193064, -927.2034773570282, -246.7336453355105, -715.5746767982029, -967.3593728005918, -759.7858906537133, -897.0183624705824, -752.2814054644278, -542.3933391750882, -245.2683813291127, -335.2115187131378, -498.1158782601403, -1104.6209157406383, -645.7559941003985, -1238.8905826243072, -1035.1179275688976, -766.5752162095881, -1086.0503191739322, -1333.3600453321867, -158.06411674847834, -629.8748549409622, -291.8107956097696, -475.9694365635261, -740.0682440392779, -1048.8191331735884, -532.4027395624801, -568.7565888176024, -1170.5764868849278, -904.6288362701455, -613.2013328832406, -347.3216806831016, -906.8454898042959, -1007.830536138784, -1397.8389610194838, -1114.3737682764947, -461.7834355525159, -839.8099980645003, -430.32595443544625, -1295.3170508848868, -58.40641814356648, -862.5822031249972, -740.1774833179022, -146.03433883288577, -848.3183741522342, -982.2173449705933, -296.92387194910003, -1121.9624767090713, -986.9025291486845, -558.5975111587411, -944.8827103602757, -850.4433967134877, -1263.4891086382192, -55.07649323066347, -1236.1339417898685, -949.9395270671356, -936.3103296939973, -250.72735554166945]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.560328907986675, "mean_inference_ms": 1.6677960694413076, "mean_action_processing_ms": 0.27690479935193557, "mean_env_wait_ms": 3.4536472302365455, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013143539428710938, "StateBufferConnector_ms": 0.008017778396606445, "ViewRequirementAgentConnector_ms": 0.201798677444458}, "num_episodes": 32, "episode_return_max": -34.15724180869417, "episode_return_min": -1397.8389610194838, "episode_return_mean": -683.7090363764054, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.9963626352191, "num_env_steps_trained_throughput_per_sec": 305.9963626352191, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12661.501, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12661.426, "sample_time_ms": 1140.994, "learn_time_ms": 11452.135, "learn_throughput": 349.28, "synch_weights_time_ms": 67.415}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00000", "date": "2024-08-04_05-30-39", "timestamp": 1722729639, "time_this_iter_s": 13.08483099937439, "time_total_s": 190.4945330619812, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a1719feb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 190.4945330619812, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.88421052631579, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 176.0040551086267, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.450695588936408, "policy_loss": -0.013194391485012603, "vf_loss": 2.459043640891711, "vf_explained_var": 0.9936157384887337, "kl": 0.01659697618554978, "entropy": 1.3276003246506056, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -34.15724180869417, "episode_reward_min": -1397.8389610194838, "episode_reward_mean": -670.8451340725861, "episode_len_mean": 130.28, "episode_media": {}, "episodes_timesteps_total": 13028, "policy_reward_min": {"policy_0": -1397.8389610194838}, "policy_reward_max": {"policy_0": -34.15724180869417}, "policy_reward_mean": {"policy_0": -670.8451340725861}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-622.4760793417943, -138.013760759345, -704.1663494288114, -606.9234323875057, -528.4189056850511, -187.8601340830249, -1222.6211761853576, -68.97845988160765, -187.72678121033184, -34.15724180869417, -285.09814875121486, -996.1664992928146, -633.7339608849148, -170.38315062080324, -948.4599521193064, -927.2034773570282, -246.7336453355105, -715.5746767982029, -967.3593728005918, -759.7858906537133, -897.0183624705824, -752.2814054644278, -542.3933391750882, -245.2683813291127, -335.2115187131378, -498.1158782601403, -1104.6209157406383, -645.7559941003985, -1238.8905826243072, -1035.1179275688976, -766.5752162095881, -1086.0503191739322, -1333.3600453321867, -158.06411674847834, -629.8748549409622, -291.8107956097696, -475.9694365635261, -740.0682440392779, -1048.8191331735884, -532.4027395624801, -568.7565888176024, -1170.5764868849278, -904.6288362701455, -613.2013328832406, -347.3216806831016, -906.8454898042959, -1007.830536138784, -1397.8389610194838, -1114.3737682764947, -461.7834355525159, -839.8099980645003, -430.32595443544625, -1295.3170508848868, -58.40641814356648, -862.5822031249972, -740.1774833179022, -146.03433883288577, -848.3183741522342, -982.2173449705933, -296.92387194910003, -1121.9624767090713, -986.9025291486845, -558.5975111587411, -944.8827103602757, -850.4433967134877, -1263.4891086382192, -55.07649323066347, -1236.1339417898685, -949.9395270671356, -936.3103296939973, -250.72735554166945, -882.8444365668703, -1009.1007018152519, -865.9744761817012, -190.6503464365411, -442.06571902315494, -99.01521848227682, -89.19737834108298, -136.902040008278, -53.70852098630632, -812.395871577747, -627.4023357538186, -155.32238701200924, -730.7817113465861, -1197.6591908024752, -850.7179032243664, -193.64431836328674, -379.06808885480626, -489.8532151479791, -1239.6646168654463, -415.5060041836252, -247.74878429009559, -887.5406985061416, -910.7388466555018, -1130.3082055822458, -1240.1321150531535, -984.5699711939483, -842.6731938913425, -89.84229535930031, -432.23897930859954], "episode_lengths": [150, 55, 150, 131, 119, 64, 150, 51, 150, 59, 77, 150, 150, 93, 150, 150, 85, 149, 150, 150, 150, 150, 150, 86, 95, 108, 150, 150, 150, 150, 150, 150, 150, 74, 150, 123, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 84, 150, 150, 100, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 114, 150, 150, 150, 103, 150, 66, 69, 67, 56, 150, 150, 56, 150, 150, 150, 61, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 56, 127], "policy_policy_0_reward": [-622.4760793417943, -138.013760759345, -704.1663494288114, -606.9234323875057, -528.4189056850511, -187.8601340830249, -1222.6211761853576, -68.97845988160765, -187.72678121033184, -34.15724180869417, -285.09814875121486, -996.1664992928146, -633.7339608849148, -170.38315062080324, -948.4599521193064, -927.2034773570282, -246.7336453355105, -715.5746767982029, -967.3593728005918, -759.7858906537133, -897.0183624705824, -752.2814054644278, -542.3933391750882, -245.2683813291127, -335.2115187131378, -498.1158782601403, -1104.6209157406383, -645.7559941003985, -1238.8905826243072, -1035.1179275688976, -766.5752162095881, -1086.0503191739322, -1333.3600453321867, -158.06411674847834, -629.8748549409622, -291.8107956097696, -475.9694365635261, -740.0682440392779, -1048.8191331735884, -532.4027395624801, -568.7565888176024, -1170.5764868849278, -904.6288362701455, -613.2013328832406, -347.3216806831016, -906.8454898042959, -1007.830536138784, -1397.8389610194838, -1114.3737682764947, -461.7834355525159, -839.8099980645003, -430.32595443544625, -1295.3170508848868, -58.40641814356648, -862.5822031249972, -740.1774833179022, -146.03433883288577, -848.3183741522342, -982.2173449705933, -296.92387194910003, -1121.9624767090713, -986.9025291486845, -558.5975111587411, -944.8827103602757, -850.4433967134877, -1263.4891086382192, -55.07649323066347, -1236.1339417898685, -949.9395270671356, -936.3103296939973, -250.72735554166945, -882.8444365668703, -1009.1007018152519, -865.9744761817012, -190.6503464365411, -442.06571902315494, -99.01521848227682, -89.19737834108298, -136.902040008278, -53.70852098630632, -812.395871577747, -627.4023357538186, -155.32238701200924, -730.7817113465861, -1197.6591908024752, -850.7179032243664, -193.64431836328674, -379.06808885480626, -489.8532151479791, -1239.6646168654463, -415.5060041836252, -247.74878429009559, -887.5406985061416, -910.7388466555018, -1130.3082055822458, -1240.1321150531535, -984.5699711939483, -842.6731938913425, -89.84229535930031, -432.23897930859954]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5611467203597879, "mean_inference_ms": 1.6723114908561545, "mean_action_processing_ms": 0.27716096906969756, "mean_env_wait_ms": 3.4618722556308708, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013197898864746094, "StateBufferConnector_ms": 0.008187055587768555, "ViewRequirementAgentConnector_ms": 0.22225594520568848}, "num_episodes": 29, "episode_return_max": -34.15724180869417, "episode_return_min": -1397.8389610194838, "episode_return_mean": -670.8451340725861, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 422.64188663982134, "num_env_steps_trained_throughput_per_sec": 422.64188663982134, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12289.006, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12288.93, "sample_time_ms": 1153.949, "learn_time_ms": 11067.801, "learn_throughput": 361.409, "synch_weights_time_ms": 66.329}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00000", "date": "2024-08-04_05-30-49", "timestamp": 1722729649, "time_this_iter_s": 9.475972175598145, "time_total_s": 199.97050523757935, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16ee9fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 199.97050523757935, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 22.22307692307692, "ram_util_percent": 27.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 184.42463814616204, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 1.8014421936745444, "policy_loss": -0.008026318534393794, "vf_loss": 1.8048637259130678, "vf_explained_var": 0.9873150429377954, "kl": 0.015838750185897272, "entropy": 1.4683959574749073, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -18.907069449403323, "episode_reward_min": -1397.8389610194838, "episode_reward_mean": -682.1840195976343, "episode_len_mean": 133.3, "episode_media": {}, "episodes_timesteps_total": 13330, "policy_reward_min": {"policy_0": -1397.8389610194838}, "policy_reward_max": {"policy_0": -18.907069449403323}, "policy_reward_mean": {"policy_0": -682.1840195976343}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-158.06411674847834, -629.8748549409622, -291.8107956097696, -475.9694365635261, -740.0682440392779, -1048.8191331735884, -532.4027395624801, -568.7565888176024, -1170.5764868849278, -904.6288362701455, -613.2013328832406, -347.3216806831016, -906.8454898042959, -1007.830536138784, -1397.8389610194838, -1114.3737682764947, -461.7834355525159, -839.8099980645003, -430.32595443544625, -1295.3170508848868, -58.40641814356648, -862.5822031249972, -740.1774833179022, -146.03433883288577, -848.3183741522342, -982.2173449705933, -296.92387194910003, -1121.9624767090713, -986.9025291486845, -558.5975111587411, -944.8827103602757, -850.4433967134877, -1263.4891086382192, -55.07649323066347, -1236.1339417898685, -949.9395270671356, -936.3103296939973, -250.72735554166945, -882.8444365668703, -1009.1007018152519, -865.9744761817012, -190.6503464365411, -442.06571902315494, -99.01521848227682, -89.19737834108298, -136.902040008278, -53.70852098630632, -812.395871577747, -627.4023357538186, -155.32238701200924, -730.7817113465861, -1197.6591908024752, -850.7179032243664, -193.64431836328674, -379.06808885480626, -489.8532151479791, -1239.6646168654463, -415.5060041836252, -247.74878429009559, -887.5406985061416, -910.7388466555018, -1130.3082055822458, -1240.1321150531535, -984.5699711939483, -842.6731938913425, -89.84229535930031, -432.23897930859954, -217.83007363748646, -904.8054491429241, -1070.7576305595376, -1077.636934239426, -930.1121245174032, -478.0925166147383, -1173.0611790308956, -1228.6579659707406, -791.701799071168, -923.4796713401132, -232.39455369092605, -109.40660981921641, -18.907069449403323, -483.0181036811566, -755.3814419256555, -859.4625589123015, -219.05316419278762, -349.7448312815179, -880.9598768454957, -1144.384513808234, -808.3944378155131, -846.1287544264204, -920.2095865300074, -698.5985900496319, -1277.1092979125824, -441.1911674077856, -810.8540856570421, -416.5112985056602, -246.36861116081195, -918.2000168370602, -57.862410365649474, -483.52739595342877, -792.5858137001914], "episode_lengths": [74, 150, 123, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 150, 150, 43, 150, 150, 84, 150, 150, 100, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 114, 150, 150, 150, 103, 150, 66, 69, 67, 56, 150, 150, 56, 150, 150, 150, 61, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 56, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 45, 105, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 94, 150, 47, 150, 150], "policy_policy_0_reward": [-158.06411674847834, -629.8748549409622, -291.8107956097696, -475.9694365635261, -740.0682440392779, -1048.8191331735884, -532.4027395624801, -568.7565888176024, -1170.5764868849278, -904.6288362701455, -613.2013328832406, -347.3216806831016, -906.8454898042959, -1007.830536138784, -1397.8389610194838, -1114.3737682764947, -461.7834355525159, -839.8099980645003, -430.32595443544625, -1295.3170508848868, -58.40641814356648, -862.5822031249972, -740.1774833179022, -146.03433883288577, -848.3183741522342, -982.2173449705933, -296.92387194910003, -1121.9624767090713, -986.9025291486845, -558.5975111587411, -944.8827103602757, -850.4433967134877, -1263.4891086382192, -55.07649323066347, -1236.1339417898685, -949.9395270671356, -936.3103296939973, -250.72735554166945, -882.8444365668703, -1009.1007018152519, -865.9744761817012, -190.6503464365411, -442.06571902315494, -99.01521848227682, -89.19737834108298, -136.902040008278, -53.70852098630632, -812.395871577747, -627.4023357538186, -155.32238701200924, -730.7817113465861, -1197.6591908024752, -850.7179032243664, -193.64431836328674, -379.06808885480626, -489.8532151479791, -1239.6646168654463, -415.5060041836252, -247.74878429009559, -887.5406985061416, -910.7388466555018, -1130.3082055822458, -1240.1321150531535, -984.5699711939483, -842.6731938913425, -89.84229535930031, -432.23897930859954, -217.83007363748646, -904.8054491429241, -1070.7576305595376, -1077.636934239426, -930.1121245174032, -478.0925166147383, -1173.0611790308956, -1228.6579659707406, -791.701799071168, -923.4796713401132, -232.39455369092605, -109.40660981921641, -18.907069449403323, -483.0181036811566, -755.3814419256555, -859.4625589123015, -219.05316419278762, -349.7448312815179, -880.9598768454957, -1144.384513808234, -808.3944378155131, -846.1287544264204, -920.2095865300074, -698.5985900496319, -1277.1092979125824, -441.1911674077856, -810.8540856570421, -416.5112985056602, -246.36861116081195, -918.2000168370602, -57.862410365649474, -483.52739595342877, -792.5858137001914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5605177089858944, "mean_inference_ms": 1.6737965404172699, "mean_action_processing_ms": 0.27743526347600644, "mean_env_wait_ms": 3.4649774345228086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013010740280151367, "StateBufferConnector_ms": 0.008269548416137695, "ViewRequirementAgentConnector_ms": 0.2229163646697998}, "num_episodes": 33, "episode_return_max": -18.907069449403323, "episode_return_min": -1397.8389610194838, "episode_return_mean": -682.1840195976343, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.84642416552833, "num_env_steps_trained_throughput_per_sec": 311.84642416552833, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12274.838, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12274.761, "sample_time_ms": 1153.166, "learn_time_ms": 11054.127, "learn_throughput": 361.856, "synch_weights_time_ms": 66.622}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00000", "date": "2024-08-04_05-31-02", "timestamp": 1722729662, "time_this_iter_s": 12.838792324066162, "time_total_s": 212.8092975616455, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16ee80d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 212.8092975616455, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.238888888888887, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 163.55458112160366, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.4930325052390496, "policy_loss": -0.010484593278670217, "vf_loss": 2.4993458778907853, "vf_explained_var": 0.9874077050636212, "kl": 0.014342676411160956, "entropy": 1.3157639057685933, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -18.907069449403323, "episode_reward_min": -1277.1092979125824, "episode_reward_mean": -624.4138178019996, "episode_len_mean": 128.57, "episode_media": {}, "episodes_timesteps_total": 12857, "policy_reward_min": {"policy_0": -1277.1092979125824}, "policy_reward_max": {"policy_0": -18.907069449403323}, "policy_reward_mean": {"policy_0": -624.4138178019996}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-558.5975111587411, -944.8827103602757, -850.4433967134877, -1263.4891086382192, -55.07649323066347, -1236.1339417898685, -949.9395270671356, -936.3103296939973, -250.72735554166945, -882.8444365668703, -1009.1007018152519, -865.9744761817012, -190.6503464365411, -442.06571902315494, -99.01521848227682, -89.19737834108298, -136.902040008278, -53.70852098630632, -812.395871577747, -627.4023357538186, -155.32238701200924, -730.7817113465861, -1197.6591908024752, -850.7179032243664, -193.64431836328674, -379.06808885480626, -489.8532151479791, -1239.6646168654463, -415.5060041836252, -247.74878429009559, -887.5406985061416, -910.7388466555018, -1130.3082055822458, -1240.1321150531535, -984.5699711939483, -842.6731938913425, -89.84229535930031, -432.23897930859954, -217.83007363748646, -904.8054491429241, -1070.7576305595376, -1077.636934239426, -930.1121245174032, -478.0925166147383, -1173.0611790308956, -1228.6579659707406, -791.701799071168, -923.4796713401132, -232.39455369092605, -109.40660981921641, -18.907069449403323, -483.0181036811566, -755.3814419256555, -859.4625589123015, -219.05316419278762, -349.7448312815179, -880.9598768454957, -1144.384513808234, -808.3944378155131, -846.1287544264204, -920.2095865300074, -698.5985900496319, -1277.1092979125824, -441.1911674077856, -810.8540856570421, -416.5112985056602, -246.36861116081195, -918.2000168370602, -57.862410365649474, -483.52739595342877, -792.5858137001914, -859.1480212155637, -643.9652814649417, -1271.8262756995405, -293.5927813582747, -616.8659898788486, -33.852765979713425, -313.57946994596625, -56.852439471236586, -793.7456017502311, -473.6915990143385, -1006.7828360996024, -215.57926694276716, -1066.4359399655743, -264.5918708431259, -192.77395207353334, -323.9945743308027, -388.8509946627647, -1059.5804042808977, -99.42382239076011, -435.5102157650309, -268.07482027569984, -212.1067028438756, -618.1707844443833, -1213.2212759910012, -155.40058041959344, -450.3224281922528, -1102.0520424565545, -364.77769529731444, -407.3538680848493], "episode_lengths": [150, 150, 150, 150, 49, 150, 150, 150, 114, 150, 150, 150, 103, 150, 66, 69, 67, 56, 150, 150, 56, 150, 150, 150, 61, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 150, 56, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 45, 105, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 94, 150, 47, 150, 150, 150, 150, 150, 94, 150, 42, 150, 58, 150, 150, 150, 81, 150, 79, 80, 127, 109, 150, 72, 150, 107, 73, 150, 150, 57, 150, 150, 150, 150], "policy_policy_0_reward": [-558.5975111587411, -944.8827103602757, -850.4433967134877, -1263.4891086382192, -55.07649323066347, -1236.1339417898685, -949.9395270671356, -936.3103296939973, -250.72735554166945, -882.8444365668703, -1009.1007018152519, -865.9744761817012, -190.6503464365411, -442.06571902315494, -99.01521848227682, -89.19737834108298, -136.902040008278, -53.70852098630632, -812.395871577747, -627.4023357538186, -155.32238701200924, -730.7817113465861, -1197.6591908024752, -850.7179032243664, -193.64431836328674, -379.06808885480626, -489.8532151479791, -1239.6646168654463, -415.5060041836252, -247.74878429009559, -887.5406985061416, -910.7388466555018, -1130.3082055822458, -1240.1321150531535, -984.5699711939483, -842.6731938913425, -89.84229535930031, -432.23897930859954, -217.83007363748646, -904.8054491429241, -1070.7576305595376, -1077.636934239426, -930.1121245174032, -478.0925166147383, -1173.0611790308956, -1228.6579659707406, -791.701799071168, -923.4796713401132, -232.39455369092605, -109.40660981921641, -18.907069449403323, -483.0181036811566, -755.3814419256555, -859.4625589123015, -219.05316419278762, -349.7448312815179, -880.9598768454957, -1144.384513808234, -808.3944378155131, -846.1287544264204, -920.2095865300074, -698.5985900496319, -1277.1092979125824, -441.1911674077856, -810.8540856570421, -416.5112985056602, -246.36861116081195, -918.2000168370602, -57.862410365649474, -483.52739595342877, -792.5858137001914, -859.1480212155637, -643.9652814649417, -1271.8262756995405, -293.5927813582747, -616.8659898788486, -33.852765979713425, -313.57946994596625, -56.852439471236586, -793.7456017502311, -473.6915990143385, -1006.7828360996024, -215.57926694276716, -1066.4359399655743, -264.5918708431259, -192.77395207353334, -323.9945743308027, -388.8509946627647, -1059.5804042808977, -99.42382239076011, -435.5102157650309, -268.07482027569984, -212.1067028438756, -618.1707844443833, -1213.2212759910012, -155.40058041959344, -450.3224281922528, -1102.0520424565545, -364.77769529731444, -407.3538680848493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5613553952957759, "mean_inference_ms": 1.6758684873264331, "mean_action_processing_ms": 0.2777887005030025, "mean_env_wait_ms": 3.468578601255404, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011962890625, "StateBufferConnector_ms": 0.008255958557128906, "ViewRequirementAgentConnector_ms": 0.2183835506439209}, "num_episodes": 29, "episode_return_max": -18.907069449403323, "episode_return_min": -1277.1092979125824, "episode_return_mean": -624.4138178019996, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.4587668393648, "num_env_steps_trained_throughput_per_sec": 302.4587668393648, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12370.589, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12370.513, "sample_time_ms": 1160.514, "learn_time_ms": 11141.232, "learn_throughput": 359.027, "synch_weights_time_ms": 67.909}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00000", "date": "2024-08-04_05-31-15", "timestamp": 1722729675, "time_this_iter_s": 13.237898349761963, "time_total_s": 226.04719591140747, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16eeadd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 226.04719591140747, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.884210526315787, "ram_util_percent": 27.889473684210525}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 172.92448544899622, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.571696052017311, "policy_loss": -0.00554657951045859, "vf_loss": 2.572754183039069, "vf_explained_var": 0.9828807578111688, "kl": 0.015405438996291801, "entropy": 1.3317757831265529, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -17.423378267041304, "episode_reward_min": -1311.4222584834918, "episode_reward_mean": -620.330249756557, "episode_len_mean": 130.19, "episode_media": {}, "episodes_timesteps_total": 13019, "policy_reward_min": {"policy_0": -1311.4222584834918}, "policy_reward_max": {"policy_0": -17.423378267041304}, "policy_reward_mean": {"policy_0": -620.330249756557}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1240.1321150531535, -984.5699711939483, -842.6731938913425, -89.84229535930031, -432.23897930859954, -217.83007363748646, -904.8054491429241, -1070.7576305595376, -1077.636934239426, -930.1121245174032, -478.0925166147383, -1173.0611790308956, -1228.6579659707406, -791.701799071168, -923.4796713401132, -232.39455369092605, -109.40660981921641, -18.907069449403323, -483.0181036811566, -755.3814419256555, -859.4625589123015, -219.05316419278762, -349.7448312815179, -880.9598768454957, -1144.384513808234, -808.3944378155131, -846.1287544264204, -920.2095865300074, -698.5985900496319, -1277.1092979125824, -441.1911674077856, -810.8540856570421, -416.5112985056602, -246.36861116081195, -918.2000168370602, -57.862410365649474, -483.52739595342877, -792.5858137001914, -859.1480212155637, -643.9652814649417, -1271.8262756995405, -293.5927813582747, -616.8659898788486, -33.852765979713425, -313.57946994596625, -56.852439471236586, -793.7456017502311, -473.6915990143385, -1006.7828360996024, -215.57926694276716, -1066.4359399655743, -264.5918708431259, -192.77395207353334, -323.9945743308027, -388.8509946627647, -1059.5804042808977, -99.42382239076011, -435.5102157650309, -268.07482027569984, -212.1067028438756, -618.1707844443833, -1213.2212759910012, -155.40058041959344, -450.3224281922528, -1102.0520424565545, -364.77769529731444, -407.3538680848493, -828.483972762725, -673.6652788415352, -924.793472514341, -121.2032395039792, -413.27157339307314, -393.7182446286018, -1163.3480332342365, -1302.4434842012663, -1036.5400184342236, -692.0238558712427, -1078.9616440355564, -805.5634579702182, -268.26448626623466, -342.6402362419793, -933.2715103898523, -190.79789919763962, -472.43606548627565, -652.9439553615941, -865.371126579104, -1244.5216112434935, -561.6763794321245, -65.21477633843284, -180.28226874475286, -349.3403998388747, -17.423378267041304, -540.5088611529875, -399.71022820139177, -186.18855774468673, -1311.4222584834918, -1294.9814319575678, -542.0041367479099, -98.74411537694648, -723.2946272140255], "episode_lengths": [150, 150, 150, 56, 127, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 78, 45, 105, 150, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 94, 150, 47, 150, 150, 150, 150, 150, 94, 150, 42, 150, 58, 150, 150, 150, 81, 150, 79, 80, 127, 109, 150, 72, 150, 107, 73, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 94, 149, 150, 79, 150, 150, 149, 150, 150, 61, 150, 150, 40, 150, 96, 60, 150, 150, 150, 129, 150], "policy_policy_0_reward": [-1240.1321150531535, -984.5699711939483, -842.6731938913425, -89.84229535930031, -432.23897930859954, -217.83007363748646, -904.8054491429241, -1070.7576305595376, -1077.636934239426, -930.1121245174032, -478.0925166147383, -1173.0611790308956, -1228.6579659707406, -791.701799071168, -923.4796713401132, -232.39455369092605, -109.40660981921641, -18.907069449403323, -483.0181036811566, -755.3814419256555, -859.4625589123015, -219.05316419278762, -349.7448312815179, -880.9598768454957, -1144.384513808234, -808.3944378155131, -846.1287544264204, -920.2095865300074, -698.5985900496319, -1277.1092979125824, -441.1911674077856, -810.8540856570421, -416.5112985056602, -246.36861116081195, -918.2000168370602, -57.862410365649474, -483.52739595342877, -792.5858137001914, -859.1480212155637, -643.9652814649417, -1271.8262756995405, -293.5927813582747, -616.8659898788486, -33.852765979713425, -313.57946994596625, -56.852439471236586, -793.7456017502311, -473.6915990143385, -1006.7828360996024, -215.57926694276716, -1066.4359399655743, -264.5918708431259, -192.77395207353334, -323.9945743308027, -388.8509946627647, -1059.5804042808977, -99.42382239076011, -435.5102157650309, -268.07482027569984, -212.1067028438756, -618.1707844443833, -1213.2212759910012, -155.40058041959344, -450.3224281922528, -1102.0520424565545, -364.77769529731444, -407.3538680848493, -828.483972762725, -673.6652788415352, -924.793472514341, -121.2032395039792, -413.27157339307314, -393.7182446286018, -1163.3480332342365, -1302.4434842012663, -1036.5400184342236, -692.0238558712427, -1078.9616440355564, -805.5634579702182, -268.26448626623466, -342.6402362419793, -933.2715103898523, -190.79789919763962, -472.43606548627565, -652.9439553615941, -865.371126579104, -1244.5216112434935, -561.6763794321245, -65.21477633843284, -180.28226874475286, -349.3403998388747, -17.423378267041304, -540.5088611529875, -399.71022820139177, -186.18855774468673, -1311.4222584834918, -1294.9814319575678, -542.0041367479099, -98.74411537694648, -723.2946272140255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5611286119841771, "mean_inference_ms": 1.6752613275906534, "mean_action_processing_ms": 0.2776013308057475, "mean_env_wait_ms": 3.469315604931152, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012178897857666016, "StateBufferConnector_ms": 0.008132457733154297, "ViewRequirementAgentConnector_ms": 0.20157957077026367}, "num_episodes": 33, "episode_return_max": -17.423378267041304, "episode_return_min": -1311.4222584834918, "episode_return_mean": -620.330249756557, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.7828105903449, "num_env_steps_trained_throughput_per_sec": 313.7828105903449, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12342.742, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12342.664, "sample_time_ms": 1154.374, "learn_time_ms": 11120.563, "learn_throughput": 359.694, "synch_weights_time_ms": 66.875}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00000", "date": "2024-08-04_05-31-28", "timestamp": 1722729688, "time_this_iter_s": 12.761468887329102, "time_total_s": 238.80866479873657, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a1719dfc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 238.80866479873657, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.744444444444444, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 204.85149497389793, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.606622727836172, "policy_loss": -0.013161082465861304, "vf_loss": 2.6147983260452747, "vf_explained_var": 0.9888478049387535, "kl": 0.017031443522804102, "entropy": 1.239511289757987, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -16.47062865444439, "episode_reward_min": -1423.3905451262167, "episode_reward_mean": -588.0288017183217, "episode_len_mean": 127.21, "episode_media": {}, "episodes_timesteps_total": 12721, "policy_reward_min": {"policy_0": -1423.3905451262167}, "policy_reward_max": {"policy_0": -16.47062865444439}, "policy_reward_mean": {"policy_0": -588.0288017183217}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-810.8540856570421, -416.5112985056602, -246.36861116081195, -918.2000168370602, -57.862410365649474, -483.52739595342877, -792.5858137001914, -859.1480212155637, -643.9652814649417, -1271.8262756995405, -293.5927813582747, -616.8659898788486, -33.852765979713425, -313.57946994596625, -56.852439471236586, -793.7456017502311, -473.6915990143385, -1006.7828360996024, -215.57926694276716, -1066.4359399655743, -264.5918708431259, -192.77395207353334, -323.9945743308027, -388.8509946627647, -1059.5804042808977, -99.42382239076011, -435.5102157650309, -268.07482027569984, -212.1067028438756, -618.1707844443833, -1213.2212759910012, -155.40058041959344, -450.3224281922528, -1102.0520424565545, -364.77769529731444, -407.3538680848493, -828.483972762725, -673.6652788415352, -924.793472514341, -121.2032395039792, -413.27157339307314, -393.7182446286018, -1163.3480332342365, -1302.4434842012663, -1036.5400184342236, -692.0238558712427, -1078.9616440355564, -805.5634579702182, -268.26448626623466, -342.6402362419793, -933.2715103898523, -190.79789919763962, -472.43606548627565, -652.9439553615941, -865.371126579104, -1244.5216112434935, -561.6763794321245, -65.21477633843284, -180.28226874475286, -349.3403998388747, -17.423378267041304, -540.5088611529875, -399.71022820139177, -186.18855774468673, -1311.4222584834918, -1294.9814319575678, -542.0041367479099, -98.74411537694648, -723.2946272140255, -658.2485537581883, -700.0270084324902, -1038.0327594848502, -1039.2002224429239, -1043.2288790510315, -1423.3905451262167, -216.42542892728198, -879.4001347570171, -400.88451817579255, -575.9626948792761, -16.47062865444439, -45.61016286892209, -536.2598526014165, -48.95144877678702, -939.4887375891783, -514.2208329432092, -967.7144062754822, -100.22477852424986, -901.2189571272489, -233.36027767860364, -424.39980189921954, -65.6559793017812, -713.2959224929444, -1230.9036553889293, -436.1037170803597, -1089.0401767079402, -710.0362699851798, -1089.9705342742075, -95.31132934624075, -743.4014990741842, -323.3519392302839], "episode_lengths": [150, 150, 94, 150, 47, 150, 150, 150, 150, 150, 94, 150, 42, 150, 58, 150, 150, 150, 81, 150, 79, 80, 127, 109, 150, 72, 150, 107, 73, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 94, 149, 150, 79, 150, 150, 149, 150, 150, 61, 150, 150, 40, 150, 96, 60, 150, 150, 150, 129, 150, 150, 148, 150, 150, 150, 150, 95, 150, 150, 150, 41, 60, 150, 51, 150, 150, 150, 68, 150, 97, 104, 41, 150, 150, 150, 150, 150, 150, 63, 150, 150], "policy_policy_0_reward": [-810.8540856570421, -416.5112985056602, -246.36861116081195, -918.2000168370602, -57.862410365649474, -483.52739595342877, -792.5858137001914, -859.1480212155637, -643.9652814649417, -1271.8262756995405, -293.5927813582747, -616.8659898788486, -33.852765979713425, -313.57946994596625, -56.852439471236586, -793.7456017502311, -473.6915990143385, -1006.7828360996024, -215.57926694276716, -1066.4359399655743, -264.5918708431259, -192.77395207353334, -323.9945743308027, -388.8509946627647, -1059.5804042808977, -99.42382239076011, -435.5102157650309, -268.07482027569984, -212.1067028438756, -618.1707844443833, -1213.2212759910012, -155.40058041959344, -450.3224281922528, -1102.0520424565545, -364.77769529731444, -407.3538680848493, -828.483972762725, -673.6652788415352, -924.793472514341, -121.2032395039792, -413.27157339307314, -393.7182446286018, -1163.3480332342365, -1302.4434842012663, -1036.5400184342236, -692.0238558712427, -1078.9616440355564, -805.5634579702182, -268.26448626623466, -342.6402362419793, -933.2715103898523, -190.79789919763962, -472.43606548627565, -652.9439553615941, -865.371126579104, -1244.5216112434935, -561.6763794321245, -65.21477633843284, -180.28226874475286, -349.3403998388747, -17.423378267041304, -540.5088611529875, -399.71022820139177, -186.18855774468673, -1311.4222584834918, -1294.9814319575678, -542.0041367479099, -98.74411537694648, -723.2946272140255, -658.2485537581883, -700.0270084324902, -1038.0327594848502, -1039.2002224429239, -1043.2288790510315, -1423.3905451262167, -216.42542892728198, -879.4001347570171, -400.88451817579255, -575.9626948792761, -16.47062865444439, -45.61016286892209, -536.2598526014165, -48.95144877678702, -939.4887375891783, -514.2208329432092, -967.7144062754822, -100.22477852424986, -901.2189571272489, -233.36027767860364, -424.39980189921954, -65.6559793017812, -713.2959224929444, -1230.9036553889293, -436.1037170803597, -1089.0401767079402, -710.0362699851798, -1089.9705342742075, -95.31132934624075, -743.4014990741842, -323.3519392302839]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5607729573072416, "mean_inference_ms": 1.6752807424451326, "mean_action_processing_ms": 0.2773827357565341, "mean_env_wait_ms": 3.471214195788495, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012294769287109375, "StateBufferConnector_ms": 0.008177518844604492, "ViewRequirementAgentConnector_ms": 0.1931438446044922}, "num_episodes": 31, "episode_return_max": -16.47062865444439, "episode_return_min": -1423.3905451262167, "episode_return_mean": -588.0288017183217, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.87465218152414, "num_env_steps_trained_throughput_per_sec": 301.87465218152414, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12383.427, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12383.347, "sample_time_ms": 1145.999, "learn_time_ms": 11169.029, "learn_throughput": 358.133, "synch_weights_time_ms": 67.461}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00000", "date": "2024-08-04_05-31-41", "timestamp": 1722729701, "time_this_iter_s": 13.261754512786865, "time_total_s": 252.07041931152344, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16eea830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 252.07041931152344, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.41052631578948, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 150.37721432050068, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.9329852145165205, "policy_loss": -0.00734496201427343, "vf_loss": 2.936210190753142, "vf_explained_var": 0.9746898327643673, "kl": 0.014091669082457276, "entropy": 1.0750338240216175, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -16.47062865444439, "episode_reward_min": -1423.3905451262167, "episode_reward_mean": -592.9759731009511, "episode_len_mean": 127.92, "episode_media": {}, "episodes_timesteps_total": 12792, "policy_reward_min": {"policy_0": -1423.3905451262167}, "policy_reward_max": {"policy_0": -16.47062865444439}, "policy_reward_mean": {"policy_0": -592.9759731009511}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1102.0520424565545, -364.77769529731444, -407.3538680848493, -828.483972762725, -673.6652788415352, -924.793472514341, -121.2032395039792, -413.27157339307314, -393.7182446286018, -1163.3480332342365, -1302.4434842012663, -1036.5400184342236, -692.0238558712427, -1078.9616440355564, -805.5634579702182, -268.26448626623466, -342.6402362419793, -933.2715103898523, -190.79789919763962, -472.43606548627565, -652.9439553615941, -865.371126579104, -1244.5216112434935, -561.6763794321245, -65.21477633843284, -180.28226874475286, -349.3403998388747, -17.423378267041304, -540.5088611529875, -399.71022820139177, -186.18855774468673, -1311.4222584834918, -1294.9814319575678, -542.0041367479099, -98.74411537694648, -723.2946272140255, -658.2485537581883, -700.0270084324902, -1038.0327594848502, -1039.2002224429239, -1043.2288790510315, -1423.3905451262167, -216.42542892728198, -879.4001347570171, -400.88451817579255, -575.9626948792761, -16.47062865444439, -45.61016286892209, -536.2598526014165, -48.95144877678702, -939.4887375891783, -514.2208329432092, -967.7144062754822, -100.22477852424986, -901.2189571272489, -233.36027767860364, -424.39980189921954, -65.6559793017812, -713.2959224929444, -1230.9036553889293, -436.1037170803597, -1089.0401767079402, -710.0362699851798, -1089.9705342742075, -95.31132934624075, -743.4014990741842, -323.3519392302839, -315.2396869099611, -508.99564495676435, -617.714835973472, -1011.7694479963542, -306.705499335908, -265.0909770345152, -515.4663224448424, -242.9914185681495, -700.6787000508546, -1110.500616349708, -1083.370197892328, -382.421982508231, -492.9893135211728, -127.4249509938959, -821.3746400053171, -92.94759724246998, -1049.8359604344157, -758.4546660177684, -676.376610595457, -859.2331579125168, -447.3286783435668, -451.6140253572567, -820.2127086023238, -576.4425915375475, -156.34850681151585, -442.04028416947256, -483.7353118336679, -343.4878594927819, -73.05493455118977, -569.2430305972571, -1112.8174104842162, -43.11648659066638, -89.54341062753333], "episode_lengths": [150, 150, 150, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 94, 149, 150, 79, 150, 150, 149, 150, 150, 61, 150, 150, 40, 150, 96, 60, 150, 150, 150, 129, 150, 150, 148, 150, 150, 150, 150, 95, 150, 150, 150, 41, 60, 150, 51, 150, 150, 150, 68, 150, 97, 104, 41, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 88, 150, 134, 74, 150, 150, 150, 96, 150, 55, 150, 70, 150, 150, 134, 150, 126, 150, 150, 150, 58, 150, 106, 83, 68, 150, 150, 57, 42], "policy_policy_0_reward": [-1102.0520424565545, -364.77769529731444, -407.3538680848493, -828.483972762725, -673.6652788415352, -924.793472514341, -121.2032395039792, -413.27157339307314, -393.7182446286018, -1163.3480332342365, -1302.4434842012663, -1036.5400184342236, -692.0238558712427, -1078.9616440355564, -805.5634579702182, -268.26448626623466, -342.6402362419793, -933.2715103898523, -190.79789919763962, -472.43606548627565, -652.9439553615941, -865.371126579104, -1244.5216112434935, -561.6763794321245, -65.21477633843284, -180.28226874475286, -349.3403998388747, -17.423378267041304, -540.5088611529875, -399.71022820139177, -186.18855774468673, -1311.4222584834918, -1294.9814319575678, -542.0041367479099, -98.74411537694648, -723.2946272140255, -658.2485537581883, -700.0270084324902, -1038.0327594848502, -1039.2002224429239, -1043.2288790510315, -1423.3905451262167, -216.42542892728198, -879.4001347570171, -400.88451817579255, -575.9626948792761, -16.47062865444439, -45.61016286892209, -536.2598526014165, -48.95144877678702, -939.4887375891783, -514.2208329432092, -967.7144062754822, -100.22477852424986, -901.2189571272489, -233.36027767860364, -424.39980189921954, -65.6559793017812, -713.2959224929444, -1230.9036553889293, -436.1037170803597, -1089.0401767079402, -710.0362699851798, -1089.9705342742075, -95.31132934624075, -743.4014990741842, -323.3519392302839, -315.2396869099611, -508.99564495676435, -617.714835973472, -1011.7694479963542, -306.705499335908, -265.0909770345152, -515.4663224448424, -242.9914185681495, -700.6787000508546, -1110.500616349708, -1083.370197892328, -382.421982508231, -492.9893135211728, -127.4249509938959, -821.3746400053171, -92.94759724246998, -1049.8359604344157, -758.4546660177684, -676.376610595457, -859.2331579125168, -447.3286783435668, -451.6140253572567, -820.2127086023238, -576.4425915375475, -156.34850681151585, -442.04028416947256, -483.7353118336679, -343.4878594927819, -73.05493455118977, -569.2430305972571, -1112.8174104842162, -43.11648659066638, -89.54341062753333]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5597933222590553, "mean_inference_ms": 1.6747145987106575, "mean_action_processing_ms": 0.27743328691148, "mean_env_wait_ms": 3.467541002760315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012013912200927734, "StateBufferConnector_ms": 0.008112192153930664, "ViewRequirementAgentConnector_ms": 0.1919538974761963}, "num_episodes": 33, "episode_return_max": -16.47062865444439, "episode_return_min": -1423.3905451262167, "episode_return_mean": -592.9759731009511, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.4473014218737, "num_env_steps_trained_throughput_per_sec": 307.4473014218737, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12378.806, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12378.728, "sample_time_ms": 1143.304, "learn_time_ms": 11168.133, "learn_throughput": 358.162, "synch_weights_time_ms": 66.435}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00000", "date": "2024-08-04_05-31-54", "timestamp": 1722729714, "time_this_iter_s": 13.024895668029785, "time_total_s": 265.0953149795532, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16ee8310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 265.0953149795532, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.226315789473684, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 176.6327349980672, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.539929945766926, "policy_loss": -0.011524071819439995, "vf_loss": 2.547016220043103, "vf_explained_var": 0.9867729893575112, "kl": 0.015169963624248353, "entropy": 1.1318759301677346, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -8.960253048109449, "episode_reward_min": -1423.3905451262167, "episode_reward_mean": -597.2594213449288, "episode_len_mean": 127.71, "episode_media": {}, "episodes_timesteps_total": 12771, "policy_reward_min": {"policy_0": -1423.3905451262167}, "policy_reward_max": {"policy_0": -8.960253048109449}, "policy_reward_mean": {"policy_0": -597.2594213449288}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-186.18855774468673, -1311.4222584834918, -1294.9814319575678, -542.0041367479099, -98.74411537694648, -723.2946272140255, -658.2485537581883, -700.0270084324902, -1038.0327594848502, -1039.2002224429239, -1043.2288790510315, -1423.3905451262167, -216.42542892728198, -879.4001347570171, -400.88451817579255, -575.9626948792761, -16.47062865444439, -45.61016286892209, -536.2598526014165, -48.95144877678702, -939.4887375891783, -514.2208329432092, -967.7144062754822, -100.22477852424986, -901.2189571272489, -233.36027767860364, -424.39980189921954, -65.6559793017812, -713.2959224929444, -1230.9036553889293, -436.1037170803597, -1089.0401767079402, -710.0362699851798, -1089.9705342742075, -95.31132934624075, -743.4014990741842, -323.3519392302839, -315.2396869099611, -508.99564495676435, -617.714835973472, -1011.7694479963542, -306.705499335908, -265.0909770345152, -515.4663224448424, -242.9914185681495, -700.6787000508546, -1110.500616349708, -1083.370197892328, -382.421982508231, -492.9893135211728, -127.4249509938959, -821.3746400053171, -92.94759724246998, -1049.8359604344157, -758.4546660177684, -676.376610595457, -859.2331579125168, -447.3286783435668, -451.6140253572567, -820.2127086023238, -576.4425915375475, -156.34850681151585, -442.04028416947256, -483.7353118336679, -343.4878594927819, -73.05493455118977, -569.2430305972571, -1112.8174104842162, -43.11648659066638, -89.54341062753333, -854.2487351459316, -588.8515019347093, -1023.0721816510329, -421.9096675547415, -247.91523573545916, -668.4866238203725, -1086.7035866624815, -737.415010364471, -1113.8643552905883, -90.5886042426053, -462.5536253276874, -614.2243532372066, -844.1562128037941, -405.23935749397504, -8.960253048109449, -959.345280587077, -299.53710152252654, -406.3032000839651, -653.5344761229086, -614.2572384909386, -882.5894263223217, -1354.6363286235521, -550.0237691875925, -671.1483663515054, -1173.5934309348231, -110.47139650648231, -406.90575796443807, -301.6644156605487, -495.7036293870942, -773.0447663103331], "episode_lengths": [60, 150, 150, 150, 129, 150, 150, 148, 150, 150, 150, 150, 95, 150, 150, 150, 41, 60, 150, 51, 150, 150, 150, 68, 150, 97, 104, 41, 150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 88, 150, 134, 74, 150, 150, 150, 96, 150, 55, 150, 70, 150, 150, 134, 150, 126, 150, 150, 150, 58, 150, 106, 83, 68, 150, 150, 57, 42, 150, 150, 150, 150, 90, 150, 150, 140, 150, 68, 150, 150, 150, 96, 36, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 66, 150, 79, 150, 150], "policy_policy_0_reward": [-186.18855774468673, -1311.4222584834918, -1294.9814319575678, -542.0041367479099, -98.74411537694648, -723.2946272140255, -658.2485537581883, -700.0270084324902, -1038.0327594848502, -1039.2002224429239, -1043.2288790510315, -1423.3905451262167, -216.42542892728198, -879.4001347570171, -400.88451817579255, -575.9626948792761, -16.47062865444439, -45.61016286892209, -536.2598526014165, -48.95144877678702, -939.4887375891783, -514.2208329432092, -967.7144062754822, -100.22477852424986, -901.2189571272489, -233.36027767860364, -424.39980189921954, -65.6559793017812, -713.2959224929444, -1230.9036553889293, -436.1037170803597, -1089.0401767079402, -710.0362699851798, -1089.9705342742075, -95.31132934624075, -743.4014990741842, -323.3519392302839, -315.2396869099611, -508.99564495676435, -617.714835973472, -1011.7694479963542, -306.705499335908, -265.0909770345152, -515.4663224448424, -242.9914185681495, -700.6787000508546, -1110.500616349708, -1083.370197892328, -382.421982508231, -492.9893135211728, -127.4249509938959, -821.3746400053171, -92.94759724246998, -1049.8359604344157, -758.4546660177684, -676.376610595457, -859.2331579125168, -447.3286783435668, -451.6140253572567, -820.2127086023238, -576.4425915375475, -156.34850681151585, -442.04028416947256, -483.7353118336679, -343.4878594927819, -73.05493455118977, -569.2430305972571, -1112.8174104842162, -43.11648659066638, -89.54341062753333, -854.2487351459316, -588.8515019347093, -1023.0721816510329, -421.9096675547415, -247.91523573545916, -668.4866238203725, -1086.7035866624815, -737.415010364471, -1113.8643552905883, -90.5886042426053, -462.5536253276874, -614.2243532372066, -844.1562128037941, -405.23935749397504, -8.960253048109449, -959.345280587077, -299.53710152252654, -406.3032000839651, -653.5344761229086, -614.2572384909386, -882.5894263223217, -1354.6363286235521, -550.0237691875925, -671.1483663515054, -1173.5934309348231, -110.47139650648231, -406.90575796443807, -301.6644156605487, -495.7036293870942, -773.0447663103331]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5600210491184918, "mean_inference_ms": 1.673715107679004, "mean_action_processing_ms": 0.2773897831641481, "mean_env_wait_ms": 3.4632366380929698, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011959075927734375, "StateBufferConnector_ms": 0.00795125961303711, "ViewRequirementAgentConnector_ms": 0.18985319137573242}, "num_episodes": 30, "episode_return_max": -8.960253048109449, "episode_return_min": -1423.3905451262167, "episode_return_mean": -597.2594213449288, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.91996655400754, "num_env_steps_trained_throughput_per_sec": 305.91996655400754, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12401.479, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12401.404, "sample_time_ms": 1131.852, "learn_time_ms": 11201.547, "learn_throughput": 357.094, "synch_weights_time_ms": 67.153}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00000", "date": "2024-08-04_05-32-07", "timestamp": 1722729727, "time_this_iter_s": 13.087162017822266, "time_total_s": 278.1824769973755, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16ee9870>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 278.1824769973755, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.373684210526314, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 178.13918488224348, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.4678944578083852, "policy_loss": -0.006071159625328922, "vf_loss": 2.469090127448241, "vf_explained_var": 0.9901031973461311, "kl": 0.01663220346648209, "entropy": 1.1416898447399337, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -8.960253048109449, "episode_reward_min": -1354.6363286235521, "episode_reward_mean": -600.7572034203683, "episode_len_mean": 130.55, "episode_media": {}, "episodes_timesteps_total": 13055, "policy_reward_min": {"policy_0": -1354.6363286235521}, "policy_reward_max": {"policy_0": -8.960253048109449}, "policy_reward_mean": {"policy_0": -600.7572034203683}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-713.2959224929444, -1230.9036553889293, -436.1037170803597, -1089.0401767079402, -710.0362699851798, -1089.9705342742075, -95.31132934624075, -743.4014990741842, -323.3519392302839, -315.2396869099611, -508.99564495676435, -617.714835973472, -1011.7694479963542, -306.705499335908, -265.0909770345152, -515.4663224448424, -242.9914185681495, -700.6787000508546, -1110.500616349708, -1083.370197892328, -382.421982508231, -492.9893135211728, -127.4249509938959, -821.3746400053171, -92.94759724246998, -1049.8359604344157, -758.4546660177684, -676.376610595457, -859.2331579125168, -447.3286783435668, -451.6140253572567, -820.2127086023238, -576.4425915375475, -156.34850681151585, -442.04028416947256, -483.7353118336679, -343.4878594927819, -73.05493455118977, -569.2430305972571, -1112.8174104842162, -43.11648659066638, -89.54341062753333, -854.2487351459316, -588.8515019347093, -1023.0721816510329, -421.9096675547415, -247.91523573545916, -668.4866238203725, -1086.7035866624815, -737.415010364471, -1113.8643552905883, -90.5886042426053, -462.5536253276874, -614.2243532372066, -844.1562128037941, -405.23935749397504, -8.960253048109449, -959.345280587077, -299.53710152252654, -406.3032000839651, -653.5344761229086, -614.2572384909386, -882.5894263223217, -1354.6363286235521, -550.0237691875925, -671.1483663515054, -1173.5934309348231, -110.47139650648231, -406.90575796443807, -301.6644156605487, -495.7036293870942, -773.0447663103331, -1139.1121334535394, -430.8430685921732, -203.1495022906641, -476.13486671508593, -171.60436758961407, -723.6909050787581, -1036.363200995552, -853.3129480297384, -1025.9393329820682, -1021.938080544349, -1122.2890705077798, -308.70228611449477, -612.4128271123723, -928.0705886266301, -1103.7887692904085, -660.4520582857881, -692.8230218077525, -18.178485524941046, -305.03715101741307, -590.3621513549792, -276.36198792804794, -1100.601787296719, -661.4924744258642, -772.784549803715, -314.5716735810111, -288.2365988518563, -193.11994641874992, -243.41611012411573], "episode_lengths": [150, 150, 150, 150, 150, 150, 63, 150, 150, 150, 150, 150, 150, 88, 150, 134, 74, 150, 150, 150, 96, 150, 55, 150, 70, 150, 150, 134, 150, 126, 150, 150, 150, 58, 150, 106, 83, 68, 150, 150, 57, 42, 150, 150, 150, 150, 90, 150, 150, 140, 150, 68, 150, 150, 150, 96, 36, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 66, 150, 79, 150, 150, 150, 150, 101, 150, 86, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 39, 150, 150, 150, 150, 150, 150, 81, 97, 64, 148], "policy_policy_0_reward": [-713.2959224929444, -1230.9036553889293, -436.1037170803597, -1089.0401767079402, -710.0362699851798, -1089.9705342742075, -95.31132934624075, -743.4014990741842, -323.3519392302839, -315.2396869099611, -508.99564495676435, -617.714835973472, -1011.7694479963542, -306.705499335908, -265.0909770345152, -515.4663224448424, -242.9914185681495, -700.6787000508546, -1110.500616349708, -1083.370197892328, -382.421982508231, -492.9893135211728, -127.4249509938959, -821.3746400053171, -92.94759724246998, -1049.8359604344157, -758.4546660177684, -676.376610595457, -859.2331579125168, -447.3286783435668, -451.6140253572567, -820.2127086023238, -576.4425915375475, -156.34850681151585, -442.04028416947256, -483.7353118336679, -343.4878594927819, -73.05493455118977, -569.2430305972571, -1112.8174104842162, -43.11648659066638, -89.54341062753333, -854.2487351459316, -588.8515019347093, -1023.0721816510329, -421.9096675547415, -247.91523573545916, -668.4866238203725, -1086.7035866624815, -737.415010364471, -1113.8643552905883, -90.5886042426053, -462.5536253276874, -614.2243532372066, -844.1562128037941, -405.23935749397504, -8.960253048109449, -959.345280587077, -299.53710152252654, -406.3032000839651, -653.5344761229086, -614.2572384909386, -882.5894263223217, -1354.6363286235521, -550.0237691875925, -671.1483663515054, -1173.5934309348231, -110.47139650648231, -406.90575796443807, -301.6644156605487, -495.7036293870942, -773.0447663103331, -1139.1121334535394, -430.8430685921732, -203.1495022906641, -476.13486671508593, -171.60436758961407, -723.6909050787581, -1036.363200995552, -853.3129480297384, -1025.9393329820682, -1021.938080544349, -1122.2890705077798, -308.70228611449477, -612.4128271123723, -928.0705886266301, -1103.7887692904085, -660.4520582857881, -692.8230218077525, -18.178485524941046, -305.03715101741307, -590.3621513549792, -276.36198792804794, -1100.601787296719, -661.4924744258642, -772.784549803715, -314.5716735810111, -288.2365988518563, -193.11994641874992, -243.41611012411573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5599775894647536, "mean_inference_ms": 1.672866095214162, "mean_action_processing_ms": 0.277208232963579, "mean_env_wait_ms": 3.4583087596965782, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0119171142578125, "StateBufferConnector_ms": 0.00782155990600586, "ViewRequirementAgentConnector_ms": 0.1907651424407959}, "num_episodes": 28, "episode_return_max": -8.960253048109449, "episode_return_min": -1354.6363286235521, "episode_return_mean": -600.7572034203683, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 323.9586202595208, "num_env_steps_trained_throughput_per_sec": 323.9586202595208, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12586.552, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12586.476, "sample_time_ms": 1147.466, "learn_time_ms": 11371.933, "learn_throughput": 351.743, "synch_weights_time_ms": 66.234}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00000", "date": "2024-08-04_05-32-20", "timestamp": 1722729740, "time_this_iter_s": 12.35992980003357, "time_total_s": 290.54240679740906, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16ee9240>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 290.54240679740906, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.26470588235294, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 196.7154531121254, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.2624087181563177, "policy_loss": -0.0157481149159139, "vf_loss": 2.2729094026610257, "vf_explained_var": 0.9927716208000977, "kl": 0.01783182946261756, "entropy": 1.0212589659417668, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -8.960253048109449, "episode_reward_min": -1354.6363286235521, "episode_reward_mean": -568.0830505612919, "episode_len_mean": 126.87, "episode_media": {}, "episodes_timesteps_total": 12687, "policy_reward_min": {"policy_0": -1354.6363286235521}, "policy_reward_max": {"policy_0": -8.960253048109449}, "policy_reward_mean": {"policy_0": -568.0830505612919}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-576.4425915375475, -156.34850681151585, -442.04028416947256, -483.7353118336679, -343.4878594927819, -73.05493455118977, -569.2430305972571, -1112.8174104842162, -43.11648659066638, -89.54341062753333, -854.2487351459316, -588.8515019347093, -1023.0721816510329, -421.9096675547415, -247.91523573545916, -668.4866238203725, -1086.7035866624815, -737.415010364471, -1113.8643552905883, -90.5886042426053, -462.5536253276874, -614.2243532372066, -844.1562128037941, -405.23935749397504, -8.960253048109449, -959.345280587077, -299.53710152252654, -406.3032000839651, -653.5344761229086, -614.2572384909386, -882.5894263223217, -1354.6363286235521, -550.0237691875925, -671.1483663515054, -1173.5934309348231, -110.47139650648231, -406.90575796443807, -301.6644156605487, -495.7036293870942, -773.0447663103331, -1139.1121334535394, -430.8430685921732, -203.1495022906641, -476.13486671508593, -171.60436758961407, -723.6909050787581, -1036.363200995552, -853.3129480297384, -1025.9393329820682, -1021.938080544349, -1122.2890705077798, -308.70228611449477, -612.4128271123723, -928.0705886266301, -1103.7887692904085, -660.4520582857881, -692.8230218077525, -18.178485524941046, -305.03715101741307, -590.3621513549792, -276.36198792804794, -1100.601787296719, -661.4924744258642, -772.784549803715, -314.5716735810111, -288.2365988518563, -193.11994641874992, -243.41611012411573, -720.8987198125774, -12.982742777599299, -987.7464883107457, -322.78305991857593, -22.291934347573388, -414.58525230072695, -504.81496230360955, -145.05009325002052, -87.71673909365308, -280.6695377596978, -130.4550394174071, -969.2594439694107, -381.2195716136895, -367.99827509229027, -1209.364959751554, -482.880673745439, -417.04493020432517, -851.8484372926243, -163.9060903543186, -967.3392887619016, -461.47526548785413, -365.4141048396233, -735.9885878962543, -1199.6467328893223, -862.6228437611079, -632.140227982027, -996.2420243620106, -187.14673951803442, -803.6371995446591, -997.2362394504339, -30.2676274108274, -110.06356349998946], "episode_lengths": [150, 58, 150, 106, 83, 68, 150, 150, 57, 42, 150, 150, 150, 150, 90, 150, 150, 140, 150, 68, 150, 150, 150, 96, 36, 150, 150, 150, 150, 148, 150, 150, 150, 150, 150, 66, 150, 79, 150, 150, 150, 150, 101, 150, 86, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 39, 150, 150, 150, 150, 150, 150, 81, 97, 64, 148, 150, 44, 150, 106, 49, 150, 112, 128, 77, 150, 78, 150, 96, 150, 150, 150, 150, 150, 81, 150, 150, 112, 150, 150, 150, 150, 150, 88, 150, 150, 38, 63], "policy_policy_0_reward": [-576.4425915375475, -156.34850681151585, -442.04028416947256, -483.7353118336679, -343.4878594927819, -73.05493455118977, -569.2430305972571, -1112.8174104842162, -43.11648659066638, -89.54341062753333, -854.2487351459316, -588.8515019347093, -1023.0721816510329, -421.9096675547415, -247.91523573545916, -668.4866238203725, -1086.7035866624815, -737.415010364471, -1113.8643552905883, -90.5886042426053, -462.5536253276874, -614.2243532372066, -844.1562128037941, -405.23935749397504, -8.960253048109449, -959.345280587077, -299.53710152252654, -406.3032000839651, -653.5344761229086, -614.2572384909386, -882.5894263223217, -1354.6363286235521, -550.0237691875925, -671.1483663515054, -1173.5934309348231, -110.47139650648231, -406.90575796443807, -301.6644156605487, -495.7036293870942, -773.0447663103331, -1139.1121334535394, -430.8430685921732, -203.1495022906641, -476.13486671508593, -171.60436758961407, -723.6909050787581, -1036.363200995552, -853.3129480297384, -1025.9393329820682, -1021.938080544349, -1122.2890705077798, -308.70228611449477, -612.4128271123723, -928.0705886266301, -1103.7887692904085, -660.4520582857881, -692.8230218077525, -18.178485524941046, -305.03715101741307, -590.3621513549792, -276.36198792804794, -1100.601787296719, -661.4924744258642, -772.784549803715, -314.5716735810111, -288.2365988518563, -193.11994641874992, -243.41611012411573, -720.8987198125774, -12.982742777599299, -987.7464883107457, -322.78305991857593, -22.291934347573388, -414.58525230072695, -504.81496230360955, -145.05009325002052, -87.71673909365308, -280.6695377596978, -130.4550394174071, -969.2594439694107, -381.2195716136895, -367.99827509229027, -1209.364959751554, -482.880673745439, -417.04493020432517, -851.8484372926243, -163.9060903543186, -967.3392887619016, -461.47526548785413, -365.4141048396233, -735.9885878962543, -1199.6467328893223, -862.6228437611079, -632.140227982027, -996.2420243620106, -187.14673951803442, -803.6371995446591, -997.2362394504339, -30.2676274108274, -110.06356349998946]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5594230126830336, "mean_inference_ms": 1.6739466961947762, "mean_action_processing_ms": 0.2772052217409313, "mean_env_wait_ms": 3.4605871660971856, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01231241226196289, "StateBufferConnector_ms": 0.007934093475341797, "ViewRequirementAgentConnector_ms": 0.19434165954589844}, "num_episodes": 32, "episode_return_max": -8.960253048109449, "episode_return_min": -1354.6363286235521, "episode_return_mean": -568.0830505612919, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 335.97127902080524, "num_env_steps_trained_throughput_per_sec": 335.97127902080524, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12492.514, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12492.437, "sample_time_ms": 1147.38, "learn_time_ms": 11278.222, "learn_throughput": 354.666, "synch_weights_time_ms": 66.033}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00000", "date": "2024-08-04_05-32-32", "timestamp": 1722729752, "time_this_iter_s": 11.917476654052734, "time_total_s": 302.4598834514618, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16eebf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 302.4598834514618, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.28235294117647, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 138.06363740960757, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.6072272417445976, "policy_loss": -0.002884978615717652, "vf_loss": 2.6059039642413455, "vf_explained_var": 0.9704783123607437, "kl": 0.014355732881858785, "entropy": 0.9846715246637662, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -12.982742777599299, "episode_reward_min": -1329.9337521165655, "episode_reward_mean": -569.1420995375719, "episode_len_mean": 129.15, "episode_media": {}, "episodes_timesteps_total": 12915, "policy_reward_min": {"policy_0": -1329.9337521165655}, "policy_reward_max": {"policy_0": -12.982742777599299}, "policy_reward_mean": {"policy_0": -569.1420995375719}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-671.1483663515054, -1173.5934309348231, -110.47139650648231, -406.90575796443807, -301.6644156605487, -495.7036293870942, -773.0447663103331, -1139.1121334535394, -430.8430685921732, -203.1495022906641, -476.13486671508593, -171.60436758961407, -723.6909050787581, -1036.363200995552, -853.3129480297384, -1025.9393329820682, -1021.938080544349, -1122.2890705077798, -308.70228611449477, -612.4128271123723, -928.0705886266301, -1103.7887692904085, -660.4520582857881, -692.8230218077525, -18.178485524941046, -305.03715101741307, -590.3621513549792, -276.36198792804794, -1100.601787296719, -661.4924744258642, -772.784549803715, -314.5716735810111, -288.2365988518563, -193.11994641874992, -243.41611012411573, -720.8987198125774, -12.982742777599299, -987.7464883107457, -322.78305991857593, -22.291934347573388, -414.58525230072695, -504.81496230360955, -145.05009325002052, -87.71673909365308, -280.6695377596978, -130.4550394174071, -969.2594439694107, -381.2195716136895, -367.99827509229027, -1209.364959751554, -482.880673745439, -417.04493020432517, -851.8484372926243, -163.9060903543186, -967.3392887619016, -461.47526548785413, -365.4141048396233, -735.9885878962543, -1199.6467328893223, -862.6228437611079, -632.140227982027, -996.2420243620106, -187.14673951803442, -803.6371995446591, -997.2362394504339, -30.2676274108274, -110.06356349998946, -390.53261457380995, -453.6457675631291, -253.65490586109857, -911.9320093451863, -14.028092617490914, -901.9999141626512, -403.91127428984123, -1306.9096093676765, -120.20440405457721, -105.88501847348685, -954.5272791411014, -579.0794358342422, -1329.9337521165655, -573.9810935766794, -171.6104181397661, -487.3872092445781, -843.0150238336337, -227.75935509010378, -944.7630673898748, -753.7749555823937, -840.547851614022, -862.7927242054311, -619.1072598865903, -310.5086763809226, -476.87078350910645, -835.0562726654841, -314.2056598202607, -373.11500024867206, -651.9788683470082, -696.0858106130306, -629.4240305013453, -277.80544149758845, -268.1172700305593], "episode_lengths": [150, 150, 66, 150, 79, 150, 150, 150, 150, 101, 150, 86, 150, 150, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 39, 150, 150, 150, 150, 150, 150, 81, 97, 64, 148, 150, 44, 150, 106, 49, 150, 112, 128, 77, 150, 78, 150, 96, 150, 150, 150, 150, 150, 81, 150, 150, 112, 150, 150, 150, 150, 150, 88, 150, 150, 38, 63, 150, 150, 150, 150, 34, 150, 150, 150, 70, 75, 150, 121, 150, 150, 84, 150, 150, 95, 150, 150, 150, 150, 143, 150, 99, 150, 150, 97, 150, 150, 150, 150, 102], "policy_policy_0_reward": [-671.1483663515054, -1173.5934309348231, -110.47139650648231, -406.90575796443807, -301.6644156605487, -495.7036293870942, -773.0447663103331, -1139.1121334535394, -430.8430685921732, -203.1495022906641, -476.13486671508593, -171.60436758961407, -723.6909050787581, -1036.363200995552, -853.3129480297384, -1025.9393329820682, -1021.938080544349, -1122.2890705077798, -308.70228611449477, -612.4128271123723, -928.0705886266301, -1103.7887692904085, -660.4520582857881, -692.8230218077525, -18.178485524941046, -305.03715101741307, -590.3621513549792, -276.36198792804794, -1100.601787296719, -661.4924744258642, -772.784549803715, -314.5716735810111, -288.2365988518563, -193.11994641874992, -243.41611012411573, -720.8987198125774, -12.982742777599299, -987.7464883107457, -322.78305991857593, -22.291934347573388, -414.58525230072695, -504.81496230360955, -145.05009325002052, -87.71673909365308, -280.6695377596978, -130.4550394174071, -969.2594439694107, -381.2195716136895, -367.99827509229027, -1209.364959751554, -482.880673745439, -417.04493020432517, -851.8484372926243, -163.9060903543186, -967.3392887619016, -461.47526548785413, -365.4141048396233, -735.9885878962543, -1199.6467328893223, -862.6228437611079, -632.140227982027, -996.2420243620106, -187.14673951803442, -803.6371995446591, -997.2362394504339, -30.2676274108274, -110.06356349998946, -390.53261457380995, -453.6457675631291, -253.65490586109857, -911.9320093451863, -14.028092617490914, -901.9999141626512, -403.91127428984123, -1306.9096093676765, -120.20440405457721, -105.88501847348685, -954.5272791411014, -579.0794358342422, -1329.9337521165655, -573.9810935766794, -171.6104181397661, -487.3872092445781, -843.0150238336337, -227.75935509010378, -944.7630673898748, -753.7749555823937, -840.547851614022, -862.7927242054311, -619.1072598865903, -310.5086763809226, -476.87078350910645, -835.0562726654841, -314.2056598202607, -373.11500024867206, -651.9788683470082, -696.0858106130306, -629.4240305013453, -277.80544149758845, -268.1172700305593]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5596006842601624, "mean_inference_ms": 1.6743852643081507, "mean_action_processing_ms": 0.2770696547572489, "mean_env_wait_ms": 3.4602090452569896, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012088537216186523, "StateBufferConnector_ms": 0.007971525192260742, "ViewRequirementAgentConnector_ms": 0.19529342651367188}, "num_episodes": 33, "episode_return_max": -12.982742777599299, "episode_return_min": -1329.9337521165655, "episode_return_mean": -569.1420995375719, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.5834683020293, "num_env_steps_trained_throughput_per_sec": 305.5834683020293, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12494.281, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12494.203, "sample_time_ms": 1142.742, "learn_time_ms": 11283.96, "learn_throughput": 354.485, "synch_weights_time_ms": 66.689}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00000", "date": "2024-08-04_05-32-45", "timestamp": 1722729765, "time_this_iter_s": 13.104545593261719, "time_total_s": 315.5644290447235, "pid": 567014, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16eea4d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 315.5644290447235, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.342105263157894, "ram_util_percent": 27.899999999999995}}
