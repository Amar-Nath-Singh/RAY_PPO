{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0040970640877882, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.537668908635775, "policy_loss": -0.0021808249439345673, "vf_loss": 9.552948906024296, "vf_explained_var": 0.015177663353582223, "kl": 0.005932811766767069, "entropy": 1.428571666032076, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -30.08308364254422, "episode_reward_min": -1420.847981685196, "episode_reward_mean": -882.1027730701908, "episode_len_mean": 139.52173913043478, "episode_media": {}, "episodes_timesteps_total": 3209, "policy_reward_min": {"policy_0": -1420.847981685196}, "policy_reward_max": {"policy_0": -30.08308364254422}, "policy_reward_mean": {"policy_0": -882.1027730701908}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-705.0060333768, -680.2149238851018, -1420.847981685196, -1019.2997968283591, -1175.9698590453345, -471.2855487544055, -1005.5685739362086, -1131.7886487718658, -560.1885270262644, -857.6848521574182, -752.7359013123946, -788.8155291154641, -1350.1985517607473, -326.19057147884155, -1131.1762293603265, -1219.088854673331, -1180.151486065, -974.1029173376585, -1242.4990269137334, -817.8504437434793, -270.56937404607413, -1177.04706569784, -30.08308364254422], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 81, 150, 44], "policy_policy_0_reward": [-705.0060333768, -680.2149238851018, -1420.847981685196, -1019.2997968283591, -1175.9698590453345, -471.2855487544055, -1005.5685739362086, -1131.7886487718658, -560.1885270262644, -857.6848521574182, -752.7359013123946, -788.8155291154641, -1350.1985517607473, -326.19057147884155, -1131.1762293603265, -1219.088854673331, -1180.151486065, -974.1029173376585, -1242.4990269137334, -817.8504437434793, -270.56937404607413, -1177.04706569784, -30.08308364254422]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5662284595617232, "mean_inference_ms": 1.657766892770939, "mean_action_processing_ms": 0.27921037312415914, "mean_env_wait_ms": 3.394417428115864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011687693388565727, "StateBufferConnector_ms": 0.00842446866242782, "ViewRequirementAgentConnector_ms": 0.1836351726366126}, "num_episodes": 23, "episode_return_max": -30.08308364254422, "episode_return_min": -1420.847981685196, "episode_return_mean": -882.1027730701908, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.1897076712343, "num_env_steps_trained_throughput_per_sec": 312.1897076712343, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12812.733, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12812.668, "sample_time_ms": 1132.698, "learn_time_ms": 11610.932, "learn_throughput": 344.503, "synch_weights_time_ms": 68.28}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00002", "date": "2024-08-04_05-38-55", "timestamp": 1722730135, "time_this_iter_s": 12.824714183807373, "time_total_s": 12.824714183807373, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16eea950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.824714183807373, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.015789473684208, "ram_util_percent": 27.757894736842104}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5900305828079582, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.489798226952553, "policy_loss": -0.005336199383600615, "vf_loss": 9.508136488993962, "vf_explained_var": 0.06116727739572525, "kl": 0.008260648395419897, "entropy": 1.4654175975670418, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -3.546291002070808, "episode_reward_min": -1420.847981685196, "episode_reward_mean": -814.4640196100485, "episode_len_mean": 134.38, "episode_media": {}, "episodes_timesteps_total": 6719, "policy_reward_min": {"policy_0": -1420.847981685196}, "policy_reward_max": {"policy_0": -3.546291002070808}, "policy_reward_mean": {"policy_0": -814.4640196100485}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-705.0060333768, -680.2149238851018, -1420.847981685196, -1019.2997968283591, -1175.9698590453345, -471.2855487544055, -1005.5685739362086, -1131.7886487718658, -560.1885270262644, -857.6848521574182, -752.7359013123946, -788.8155291154641, -1350.1985517607473, -326.19057147884155, -1131.1762293603265, -1219.088854673331, -1180.151486065, -974.1029173376585, -1242.4990269137334, -817.8504437434793, -270.56937404607413, -1177.04706569784, -30.08308364254422, -1064.8109731111688, -1124.1973732616418, -1109.3732862100628, -190.21582015844695, -1055.5920583148868, -994.8398897559863, -493.33438312874034, -1039.972054548235, -836.7015828876192, -563.9600486094619, -856.3965119210767, -251.91309076895502, -3.546291002070808, -75.67213753495153, -1295.8688037146349, -1206.6677452330227, -356.4472907572852, -1004.9777363062638, -902.880114216412, -789.7739066601868, -749.8110315208439, -1149.8573596458607, -82.84900340431568, -850.9576470275426, -775.1816335258812, -500.3489776931638, -1108.6904489693134], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 81, 150, 44, 150, 150, 150, 69, 150, 150, 150, 150, 150, 111, 150, 86, 35, 60, 150, 150, 93, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150], "policy_policy_0_reward": [-705.0060333768, -680.2149238851018, -1420.847981685196, -1019.2997968283591, -1175.9698590453345, -471.2855487544055, -1005.5685739362086, -1131.7886487718658, -560.1885270262644, -857.6848521574182, -752.7359013123946, -788.8155291154641, -1350.1985517607473, -326.19057147884155, -1131.1762293603265, -1219.088854673331, -1180.151486065, -974.1029173376585, -1242.4990269137334, -817.8504437434793, -270.56937404607413, -1177.04706569784, -30.08308364254422, -1064.8109731111688, -1124.1973732616418, -1109.3732862100628, -190.21582015844695, -1055.5920583148868, -994.8398897559863, -493.33438312874034, -1039.972054548235, -836.7015828876192, -563.9600486094619, -856.3965119210767, -251.91309076895502, -3.546291002070808, -75.67213753495153, -1295.8688037146349, -1206.6677452330227, -356.4472907572852, -1004.9777363062638, -902.880114216412, -789.7739066601868, -749.8110315208439, -1149.8573596458607, -82.84900340431568, -850.9576470275426, -775.1816335258812, -500.3489776931638, -1108.6904489693134]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5665495876502444, "mean_inference_ms": 1.6603979378260396, "mean_action_processing_ms": 0.2790645187867674, "mean_env_wait_ms": 3.414326358068913, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014166831970214844, "StateBufferConnector_ms": 0.008765220642089844, "ViewRequirementAgentConnector_ms": 0.18498516082763672}, "num_episodes": 27, "episode_return_max": -3.546291002070808, "episode_return_min": -1420.847981685196, "episode_return_mean": -814.4640196100485, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.13787978146183, "num_env_steps_trained_throughput_per_sec": 309.13787978146183, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12875.977, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12875.914, "sample_time_ms": 1137.098, "learn_time_ms": 11675.953, "learn_throughput": 342.584, "synch_weights_time_ms": 62.115}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00002", "date": "2024-08-04_05-39-08", "timestamp": 1722730148, "time_this_iter_s": 12.950541973114014, "time_total_s": 25.775256156921387, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16eebbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.775256156921387, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.13888888888889, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.155040606980522, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.796818523605665, "policy_loss": -0.0134742120601004, "vf_loss": 7.822040612002214, "vf_explained_var": 0.445758956981202, "kl": 0.01720559453168183, "entropy": 1.518900204077363, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -3.546291002070808, "episode_reward_min": -1463.3740527197779, "episode_reward_mean": -779.8414810494322, "episode_len_mean": 132.62820512820514, "episode_media": {}, "episodes_timesteps_total": 10345, "policy_reward_min": {"policy_0": -1463.3740527197779}, "policy_reward_max": {"policy_0": -3.546291002070808}, "policy_reward_mean": {"policy_0": -779.8414810494322}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-705.0060333768, -680.2149238851018, -1420.847981685196, -1019.2997968283591, -1175.9698590453345, -471.2855487544055, -1005.5685739362086, -1131.7886487718658, -560.1885270262644, -857.6848521574182, -752.7359013123946, -788.8155291154641, -1350.1985517607473, -326.19057147884155, -1131.1762293603265, -1219.088854673331, -1180.151486065, -974.1029173376585, -1242.4990269137334, -817.8504437434793, -270.56937404607413, -1177.04706569784, -30.08308364254422, -1064.8109731111688, -1124.1973732616418, -1109.3732862100628, -190.21582015844695, -1055.5920583148868, -994.8398897559863, -493.33438312874034, -1039.972054548235, -836.7015828876192, -563.9600486094619, -856.3965119210767, -251.91309076895502, -3.546291002070808, -75.67213753495153, -1295.8688037146349, -1206.6677452330227, -356.4472907572852, -1004.9777363062638, -902.880114216412, -789.7739066601868, -749.8110315208439, -1149.8573596458607, -82.84900340431568, -850.9576470275426, -775.1816335258812, -500.3489776931638, -1108.6904489693134, -714.2325043519189, -1029.353453487086, -318.710931735265, -914.1111318903066, -1228.6862668745534, -510.3234264482617, -393.240370132826, -1169.8599441129338, -856.0018971969321, -1193.221218450544, -792.4105171721543, -321.3066892340486, -951.808387337883, -497.5882861860732, -44.28377660519021, -601.321840856159, -1132.093794407999, -1064.032725786181, -408.9535269339857, -270.6230412384113, -1463.3740527197779, -56.94233449592721, -1370.1918175949377, -836.8122659133765, -750.8490459628096, -751.8029254173684, -301.50970575521904, -160.78866305516482], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 81, 150, 44, 150, 150, 150, 69, 150, 150, 150, 150, 150, 111, 150, 86, 35, 60, 150, 150, 93, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 103, 150, 150, 150, 150, 80, 150, 150, 44, 150, 150, 150, 130, 91, 150, 49, 150, 150, 136, 150, 117, 65], "policy_policy_0_reward": [-705.0060333768, -680.2149238851018, -1420.847981685196, -1019.2997968283591, -1175.9698590453345, -471.2855487544055, -1005.5685739362086, -1131.7886487718658, -560.1885270262644, -857.6848521574182, -752.7359013123946, -788.8155291154641, -1350.1985517607473, -326.19057147884155, -1131.1762293603265, -1219.088854673331, -1180.151486065, -974.1029173376585, -1242.4990269137334, -817.8504437434793, -270.56937404607413, -1177.04706569784, -30.08308364254422, -1064.8109731111688, -1124.1973732616418, -1109.3732862100628, -190.21582015844695, -1055.5920583148868, -994.8398897559863, -493.33438312874034, -1039.972054548235, -836.7015828876192, -563.9600486094619, -856.3965119210767, -251.91309076895502, -3.546291002070808, -75.67213753495153, -1295.8688037146349, -1206.6677452330227, -356.4472907572852, -1004.9777363062638, -902.880114216412, -789.7739066601868, -749.8110315208439, -1149.8573596458607, -82.84900340431568, -850.9576470275426, -775.1816335258812, -500.3489776931638, -1108.6904489693134, -714.2325043519189, -1029.353453487086, -318.710931735265, -914.1111318903066, -1228.6862668745534, -510.3234264482617, -393.240370132826, -1169.8599441129338, -856.0018971969321, -1193.221218450544, -792.4105171721543, -321.3066892340486, -951.808387337883, -497.5882861860732, -44.28377660519021, -601.321840856159, -1132.093794407999, -1064.032725786181, -408.9535269339857, -270.6230412384113, -1463.3740527197779, -56.94233449592721, -1370.1918175949377, -836.8122659133765, -750.8490459628096, -751.8029254173684, -301.50970575521904, -160.78866305516482]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5653024074550509, "mean_inference_ms": 1.6633860349004452, "mean_action_processing_ms": 0.27920697163181163, "mean_env_wait_ms": 3.4249071578202823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01369775869907477, "StateBufferConnector_ms": 0.008919300177158454, "ViewRequirementAgentConnector_ms": 0.18822596623347357}, "num_episodes": 28, "episode_return_max": -3.546291002070808, "episode_return_min": -1463.3740527197779, "episode_return_mean": -779.8414810494322, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.34004157713224, "num_env_steps_trained_throughput_per_sec": 306.34004157713224, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12936.45, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12936.388, "sample_time_ms": 1140.244, "learn_time_ms": 11731.241, "learn_throughput": 340.97, "synch_weights_time_ms": 64.162}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00002", "date": "2024-08-04_05-39-21", "timestamp": 1722730161, "time_this_iter_s": 13.068639993667603, "time_total_s": 38.84389615058899, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5f6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.84389615058899, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.963157894736838, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.605332438151045, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.917682184278965, "policy_loss": -0.00939634973280287, "vf_loss": 6.938439651330312, "vf_explained_var": 0.6971684930225214, "kl": 0.01588445074370005, "entropy": 1.453800732890765, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -3.546291002070808, "episode_reward_min": -1463.3740527197779, "episode_reward_mean": -771.8187537891531, "episode_len_mean": 129.46, "episode_media": {}, "episodes_timesteps_total": 12946, "policy_reward_min": {"policy_0": -1463.3740527197779}, "policy_reward_max": {"policy_0": -3.546291002070808}, "policy_reward_mean": {"policy_0": -771.8187537891531}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-857.6848521574182, -752.7359013123946, -788.8155291154641, -1350.1985517607473, -326.19057147884155, -1131.1762293603265, -1219.088854673331, -1180.151486065, -974.1029173376585, -1242.4990269137334, -817.8504437434793, -270.56937404607413, -1177.04706569784, -30.08308364254422, -1064.8109731111688, -1124.1973732616418, -1109.3732862100628, -190.21582015844695, -1055.5920583148868, -994.8398897559863, -493.33438312874034, -1039.972054548235, -836.7015828876192, -563.9600486094619, -856.3965119210767, -251.91309076895502, -3.546291002070808, -75.67213753495153, -1295.8688037146349, -1206.6677452330227, -356.4472907572852, -1004.9777363062638, -902.880114216412, -789.7739066601868, -749.8110315208439, -1149.8573596458607, -82.84900340431568, -850.9576470275426, -775.1816335258812, -500.3489776931638, -1108.6904489693134, -714.2325043519189, -1029.353453487086, -318.710931735265, -914.1111318903066, -1228.6862668745534, -510.3234264482617, -393.240370132826, -1169.8599441129338, -856.0018971969321, -1193.221218450544, -792.4105171721543, -321.3066892340486, -951.808387337883, -497.5882861860732, -44.28377660519021, -601.321840856159, -1132.093794407999, -1064.032725786181, -408.9535269339857, -270.6230412384113, -1463.3740527197779, -56.94233449592721, -1370.1918175949377, -836.8122659133765, -750.8490459628096, -751.8029254173684, -301.50970575521904, -160.78866305516482, -286.32588293459906, -260.23475478551285, -1208.6458016351767, -119.54863825969557, -787.3117731382848, -357.16943654047077, -1207.6142937890322, -965.1058972214691, -986.2399087965879, -350.68070595779903, -378.82756768597227, -1030.4810311092829, -982.1713852428795, -72.66568401435617, -985.4129740182265, -1121.7163278613696, -1199.3129046535737, -7.42095966077999, -1124.4563528262752, -591.2361268161866, -110.38928078859112, -1080.7198201977938, -1005.6534262939492, -1128.9448408663861, -1030.2297604013372, -1080.9319570655855, -1277.3421179029876, -82.29591214511741, -1271.6593148755899, -1128.7390192544697, -1304.925893629818], "episode_lengths": [147, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 81, 150, 44, 150, 150, 150, 69, 150, 150, 150, 150, 150, 111, 150, 86, 35, 60, 150, 150, 93, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 103, 150, 150, 150, 150, 80, 150, 150, 44, 150, 150, 150, 130, 91, 150, 49, 150, 150, 136, 150, 117, 65, 104, 75, 150, 77, 148, 150, 150, 150, 150, 96, 100, 150, 150, 46, 150, 150, 150, 39, 150, 150, 65, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150], "policy_policy_0_reward": [-857.6848521574182, -752.7359013123946, -788.8155291154641, -1350.1985517607473, -326.19057147884155, -1131.1762293603265, -1219.088854673331, -1180.151486065, -974.1029173376585, -1242.4990269137334, -817.8504437434793, -270.56937404607413, -1177.04706569784, -30.08308364254422, -1064.8109731111688, -1124.1973732616418, -1109.3732862100628, -190.21582015844695, -1055.5920583148868, -994.8398897559863, -493.33438312874034, -1039.972054548235, -836.7015828876192, -563.9600486094619, -856.3965119210767, -251.91309076895502, -3.546291002070808, -75.67213753495153, -1295.8688037146349, -1206.6677452330227, -356.4472907572852, -1004.9777363062638, -902.880114216412, -789.7739066601868, -749.8110315208439, -1149.8573596458607, -82.84900340431568, -850.9576470275426, -775.1816335258812, -500.3489776931638, -1108.6904489693134, -714.2325043519189, -1029.353453487086, -318.710931735265, -914.1111318903066, -1228.6862668745534, -510.3234264482617, -393.240370132826, -1169.8599441129338, -856.0018971969321, -1193.221218450544, -792.4105171721543, -321.3066892340486, -951.808387337883, -497.5882861860732, -44.28377660519021, -601.321840856159, -1132.093794407999, -1064.032725786181, -408.9535269339857, -270.6230412384113, -1463.3740527197779, -56.94233449592721, -1370.1918175949377, -836.8122659133765, -750.8490459628096, -751.8029254173684, -301.50970575521904, -160.78866305516482, -286.32588293459906, -260.23475478551285, -1208.6458016351767, -119.54863825969557, -787.3117731382848, -357.16943654047077, -1207.6142937890322, -965.1058972214691, -986.2399087965879, -350.68070595779903, -378.82756768597227, -1030.4810311092829, -982.1713852428795, -72.66568401435617, -985.4129740182265, -1121.7163278613696, -1199.3129046535737, -7.42095966077999, -1124.4563528262752, -591.2361268161866, -110.38928078859112, -1080.7198201977938, -1005.6534262939492, -1128.9448408663861, -1030.2297604013372, -1080.9319570655855, -1277.3421179029876, -82.29591214511741, -1271.6593148755899, -1128.7390192544697, -1304.925893629818]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5642619838712187, "mean_inference_ms": 1.6649524567653358, "mean_action_processing_ms": 0.27945833267826986, "mean_env_wait_ms": 3.4294729239755246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014144182205200195, "StateBufferConnector_ms": 0.00895547866821289, "ViewRequirementAgentConnector_ms": 0.18960070610046387}, "num_episodes": 31, "episode_return_max": -3.546291002070808, "episode_return_min": -1463.3740527197779, "episode_return_mean": -771.8187537891531, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.78150812252005, "num_env_steps_trained_throughput_per_sec": 312.78150812252005, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12899.461, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12899.393, "sample_time_ms": 1131.637, "learn_time_ms": 11700.666, "learn_throughput": 341.861, "synch_weights_time_ms": 66.333}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00002", "date": "2024-08-04_05-39-34", "timestamp": 1722730174, "time_this_iter_s": 12.800748586654663, "time_total_s": 51.64464473724365, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16eea950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.64464473724365, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.01666666666667, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 49.56583169102669, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.927712631722291, "policy_loss": -0.015118113259086385, "vf_loss": 5.95380795498689, "vf_explained_var": 0.7781116725876928, "kl": 0.019894264046494452, "entropy": 1.495606569200754, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -7.42095966077999, "episode_reward_min": -1463.3740527197779, "episode_reward_mean": -739.1104116514399, "episode_len_mean": 130.34, "episode_media": {}, "episodes_timesteps_total": 13034, "policy_reward_min": {"policy_0": -1463.3740527197779}, "policy_reward_max": {"policy_0": -7.42095966077999}, "policy_reward_mean": {"policy_0": -739.1104116514399}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-902.880114216412, -789.7739066601868, -749.8110315208439, -1149.8573596458607, -82.84900340431568, -850.9576470275426, -775.1816335258812, -500.3489776931638, -1108.6904489693134, -714.2325043519189, -1029.353453487086, -318.710931735265, -914.1111318903066, -1228.6862668745534, -510.3234264482617, -393.240370132826, -1169.8599441129338, -856.0018971969321, -1193.221218450544, -792.4105171721543, -321.3066892340486, -951.808387337883, -497.5882861860732, -44.28377660519021, -601.321840856159, -1132.093794407999, -1064.032725786181, -408.9535269339857, -270.6230412384113, -1463.3740527197779, -56.94233449592721, -1370.1918175949377, -836.8122659133765, -750.8490459628096, -751.8029254173684, -301.50970575521904, -160.78866305516482, -286.32588293459906, -260.23475478551285, -1208.6458016351767, -119.54863825969557, -787.3117731382848, -357.16943654047077, -1207.6142937890322, -965.1058972214691, -986.2399087965879, -350.68070595779903, -378.82756768597227, -1030.4810311092829, -982.1713852428795, -72.66568401435617, -985.4129740182265, -1121.7163278613696, -1199.3129046535737, -7.42095966077999, -1124.4563528262752, -591.2361268161866, -110.38928078859112, -1080.7198201977938, -1005.6534262939492, -1128.9448408663861, -1030.2297604013372, -1080.9319570655855, -1277.3421179029876, -82.29591214511741, -1271.6593148755899, -1128.7390192544697, -1304.925893629818, -1047.2158350075347, -202.07762276107928, -1018.5030180163358, -594.8395642750557, -623.3560182662275, -369.7480082442304, -250.07551521627602, -916.5143659085371, -1119.6113158124638, -1215.8076972103836, -914.5622174754436, -495.18111862963167, -510.0024546595044, -975.8505135015135, -664.7459344951453, -999.9217225392197, -824.0632932015177, -104.92889183208345, -1016.6683959971192, -953.6350123641896, -560.9989466715533, -212.06031744636752, -1152.0393981399957, -1155.065377539978, -29.1405726211118, -1085.7706467366313, -758.2656700108888, -801.0235528793029, -10.37439096034601, -511.12250604629014, -1106.6717105486043, -172.00514574345766], "episode_lengths": [150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 111, 150, 150, 150, 103, 150, 150, 150, 150, 80, 150, 150, 44, 150, 150, 150, 130, 91, 150, 49, 150, 150, 136, 150, 117, 65, 104, 75, 150, 77, 148, 150, 150, 150, 150, 96, 100, 150, 150, 46, 150, 150, 150, 39, 150, 150, 65, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 104, 150, 150, 150, 123, 70, 150, 150, 150, 150, 125, 131, 150, 150, 150, 150, 87, 150, 150, 150, 105, 150, 150, 37, 150, 150, 144, 38, 150, 150, 87], "policy_policy_0_reward": [-902.880114216412, -789.7739066601868, -749.8110315208439, -1149.8573596458607, -82.84900340431568, -850.9576470275426, -775.1816335258812, -500.3489776931638, -1108.6904489693134, -714.2325043519189, -1029.353453487086, -318.710931735265, -914.1111318903066, -1228.6862668745534, -510.3234264482617, -393.240370132826, -1169.8599441129338, -856.0018971969321, -1193.221218450544, -792.4105171721543, -321.3066892340486, -951.808387337883, -497.5882861860732, -44.28377660519021, -601.321840856159, -1132.093794407999, -1064.032725786181, -408.9535269339857, -270.6230412384113, -1463.3740527197779, -56.94233449592721, -1370.1918175949377, -836.8122659133765, -750.8490459628096, -751.8029254173684, -301.50970575521904, -160.78866305516482, -286.32588293459906, -260.23475478551285, -1208.6458016351767, -119.54863825969557, -787.3117731382848, -357.16943654047077, -1207.6142937890322, -965.1058972214691, -986.2399087965879, -350.68070595779903, -378.82756768597227, -1030.4810311092829, -982.1713852428795, -72.66568401435617, -985.4129740182265, -1121.7163278613696, -1199.3129046535737, -7.42095966077999, -1124.4563528262752, -591.2361268161866, -110.38928078859112, -1080.7198201977938, -1005.6534262939492, -1128.9448408663861, -1030.2297604013372, -1080.9319570655855, -1277.3421179029876, -82.29591214511741, -1271.6593148755899, -1128.7390192544697, -1304.925893629818, -1047.2158350075347, -202.07762276107928, -1018.5030180163358, -594.8395642750557, -623.3560182662275, -369.7480082442304, -250.07551521627602, -916.5143659085371, -1119.6113158124638, -1215.8076972103836, -914.5622174754436, -495.18111862963167, -510.0024546595044, -975.8505135015135, -664.7459344951453, -999.9217225392197, -824.0632932015177, -104.92889183208345, -1016.6683959971192, -953.6350123641896, -560.9989466715533, -212.06031744636752, -1152.0393981399957, -1155.065377539978, -29.1405726211118, -1085.7706467366313, -758.2656700108888, -801.0235528793029, -10.37439096034601, -511.12250604629014, -1106.6717105486043, -172.00514574345766]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5616527648622334, "mean_inference_ms": 1.6676812941420422, "mean_action_processing_ms": 0.2800195842319818, "mean_env_wait_ms": 3.437290448904955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013827085494995117, "StateBufferConnector_ms": 0.009087324142456055, "ViewRequirementAgentConnector_ms": 0.19100666046142578}, "num_episodes": 32, "episode_return_max": -7.42095966077999, "episode_return_min": -1463.3740527197779, "episode_return_mean": -739.1104116514399, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.534837874431, "num_env_steps_trained_throughput_per_sec": 345.534837874431, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12634.823, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12634.755, "sample_time_ms": 1126.453, "learn_time_ms": 11441.819, "learn_throughput": 349.595, "synch_weights_time_ms": 65.722}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00002", "date": "2024-08-04_05-39-46", "timestamp": 1722730186, "time_this_iter_s": 11.589870691299438, "time_total_s": 63.23451542854309, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f65cf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 63.23451542854309, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.605882352941173, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 80.24625043173631, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.559635341912508, "policy_loss": -0.011224205723071161, "vf_loss": 5.58403946235776, "vf_explained_var": 0.8309769586970409, "kl": 0.018137948738149137, "entropy": 1.680751581862569, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -7.42095966077999, "episode_reward_min": -1463.3740527197779, "episode_reward_mean": -793.3907515744788, "episode_len_mean": 131.63, "episode_media": {}, "episodes_timesteps_total": 13163, "policy_reward_min": {"policy_0": -1463.3740527197779}, "policy_reward_max": {"policy_0": -7.42095966077999}, "policy_reward_mean": {"policy_0": -793.3907515744788}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-408.9535269339857, -270.6230412384113, -1463.3740527197779, -56.94233449592721, -1370.1918175949377, -836.8122659133765, -750.8490459628096, -751.8029254173684, -301.50970575521904, -160.78866305516482, -286.32588293459906, -260.23475478551285, -1208.6458016351767, -119.54863825969557, -787.3117731382848, -357.16943654047077, -1207.6142937890322, -965.1058972214691, -986.2399087965879, -350.68070595779903, -378.82756768597227, -1030.4810311092829, -982.1713852428795, -72.66568401435617, -985.4129740182265, -1121.7163278613696, -1199.3129046535737, -7.42095966077999, -1124.4563528262752, -591.2361268161866, -110.38928078859112, -1080.7198201977938, -1005.6534262939492, -1128.9448408663861, -1030.2297604013372, -1080.9319570655855, -1277.3421179029876, -82.29591214511741, -1271.6593148755899, -1128.7390192544697, -1304.925893629818, -1047.2158350075347, -202.07762276107928, -1018.5030180163358, -594.8395642750557, -623.3560182662275, -369.7480082442304, -250.07551521627602, -916.5143659085371, -1119.6113158124638, -1215.8076972103836, -914.5622174754436, -495.18111862963167, -510.0024546595044, -975.8505135015135, -664.7459344951453, -999.9217225392197, -824.0632932015177, -104.92889183208345, -1016.6683959971192, -953.6350123641896, -560.9989466715533, -212.06031744636752, -1152.0393981399957, -1155.065377539978, -29.1405726211118, -1085.7706467366313, -758.2656700108888, -801.0235528793029, -10.37439096034601, -511.12250604629014, -1106.6717105486043, -172.00514574345766, -795.7791976703605, -1065.7720519789111, -1155.0354423905876, -1346.011656232986, -1085.3884612555094, -771.1241322848385, -1045.1230811997639, -1047.2150890514865, -160.27818915944894, -1324.2428161622715, -844.1964577996673, -1246.1853691602305, -1405.8904694219552, -1220.0927389900564, -456.11921713174695, -1018.0263903184609, -1123.1382839049988, -1086.6555425496515, -1431.8492171202365, -473.7259145384595, -57.03094510460842, -798.1703537619375, -849.2963084242203, -966.5387921942398, -1165.3023639549867, -1403.091729984989, -729.6910654871177], "episode_lengths": [130, 91, 150, 49, 150, 150, 136, 150, 117, 65, 104, 75, 150, 77, 148, 150, 150, 150, 150, 96, 100, 150, 150, 46, 150, 150, 150, 39, 150, 150, 65, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 104, 150, 150, 150, 123, 70, 150, 150, 150, 150, 125, 131, 150, 150, 150, 150, 87, 150, 150, 150, 105, 150, 150, 37, 150, 150, 144, 38, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 108, 58, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-408.9535269339857, -270.6230412384113, -1463.3740527197779, -56.94233449592721, -1370.1918175949377, -836.8122659133765, -750.8490459628096, -751.8029254173684, -301.50970575521904, -160.78866305516482, -286.32588293459906, -260.23475478551285, -1208.6458016351767, -119.54863825969557, -787.3117731382848, -357.16943654047077, -1207.6142937890322, -965.1058972214691, -986.2399087965879, -350.68070595779903, -378.82756768597227, -1030.4810311092829, -982.1713852428795, -72.66568401435617, -985.4129740182265, -1121.7163278613696, -1199.3129046535737, -7.42095966077999, -1124.4563528262752, -591.2361268161866, -110.38928078859112, -1080.7198201977938, -1005.6534262939492, -1128.9448408663861, -1030.2297604013372, -1080.9319570655855, -1277.3421179029876, -82.29591214511741, -1271.6593148755899, -1128.7390192544697, -1304.925893629818, -1047.2158350075347, -202.07762276107928, -1018.5030180163358, -594.8395642750557, -623.3560182662275, -369.7480082442304, -250.07551521627602, -916.5143659085371, -1119.6113158124638, -1215.8076972103836, -914.5622174754436, -495.18111862963167, -510.0024546595044, -975.8505135015135, -664.7459344951453, -999.9217225392197, -824.0632932015177, -104.92889183208345, -1016.6683959971192, -953.6350123641896, -560.9989466715533, -212.06031744636752, -1152.0393981399957, -1155.065377539978, -29.1405726211118, -1085.7706467366313, -758.2656700108888, -801.0235528793029, -10.37439096034601, -511.12250604629014, -1106.6717105486043, -172.00514574345766, -795.7791976703605, -1065.7720519789111, -1155.0354423905876, -1346.011656232986, -1085.3884612555094, -771.1241322848385, -1045.1230811997639, -1047.2150890514865, -160.27818915944894, -1324.2428161622715, -844.1964577996673, -1246.1853691602305, -1405.8904694219552, -1220.0927389900564, -456.11921713174695, -1018.0263903184609, -1123.1382839049988, -1086.6555425496515, -1431.8492171202365, -473.7259145384595, -57.03094510460842, -798.1703537619375, -849.2963084242203, -966.5387921942398, -1165.3023639549867, -1403.091729984989, -729.6910654871177]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5603247898144821, "mean_inference_ms": 1.6696003620954487, "mean_action_processing_ms": 0.2808356399468145, "mean_env_wait_ms": 3.4449205847750597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013672590255737305, "StateBufferConnector_ms": 0.00872349739074707, "ViewRequirementAgentConnector_ms": 0.19005751609802246}, "num_episodes": 27, "episode_return_max": -7.42095966077999, "episode_return_min": -1463.3740527197779, "episode_return_mean": -793.3907515744788, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.72601865534205, "num_env_steps_trained_throughput_per_sec": 304.72601865534205, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12716.778, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12716.711, "sample_time_ms": 1127.751, "learn_time_ms": 11520.612, "learn_throughput": 347.204, "synch_weights_time_ms": 67.586}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00002", "date": "2024-08-04_05-39-59", "timestamp": 1722730199, "time_this_iter_s": 13.139227867126465, "time_total_s": 76.37374329566956, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5f6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76.37374329566956, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.166666666666668, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 123.47300863265991, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.644185914347569, "policy_loss": -0.014254323202476372, "vf_loss": 4.670701449116071, "vf_explained_var": 0.9384347297251224, "kl": 0.022260205887990506, "entropy": 1.671325830121835, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -10.37439096034601, "episode_reward_min": -1431.8492171202365, "episode_reward_mean": -824.1866928091126, "episode_len_mean": 132.15, "episode_media": {}, "episodes_timesteps_total": 13215, "policy_reward_min": {"policy_0": -1431.8492171202365}, "policy_reward_max": {"policy_0": -10.37439096034601}, "policy_reward_mean": {"policy_0": -824.1866928091126}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1128.9448408663861, -1030.2297604013372, -1080.9319570655855, -1277.3421179029876, -82.29591214511741, -1271.6593148755899, -1128.7390192544697, -1304.925893629818, -1047.2158350075347, -202.07762276107928, -1018.5030180163358, -594.8395642750557, -623.3560182662275, -369.7480082442304, -250.07551521627602, -916.5143659085371, -1119.6113158124638, -1215.8076972103836, -914.5622174754436, -495.18111862963167, -510.0024546595044, -975.8505135015135, -664.7459344951453, -999.9217225392197, -824.0632932015177, -104.92889183208345, -1016.6683959971192, -953.6350123641896, -560.9989466715533, -212.06031744636752, -1152.0393981399957, -1155.065377539978, -29.1405726211118, -1085.7706467366313, -758.2656700108888, -801.0235528793029, -10.37439096034601, -511.12250604629014, -1106.6717105486043, -172.00514574345766, -795.7791976703605, -1065.7720519789111, -1155.0354423905876, -1346.011656232986, -1085.3884612555094, -771.1241322848385, -1045.1230811997639, -1047.2150890514865, -160.27818915944894, -1324.2428161622715, -844.1964577996673, -1246.1853691602305, -1405.8904694219552, -1220.0927389900564, -456.11921713174695, -1018.0263903184609, -1123.1382839049988, -1086.6555425496515, -1431.8492171202365, -473.7259145384595, -57.03094510460842, -798.1703537619375, -849.2963084242203, -966.5387921942398, -1165.3023639549867, -1403.091729984989, -729.6910654871177, -1031.8277855124509, -211.450356835416, -1182.7236639116027, -306.98753622907157, -1080.9688794289461, -604.6955783015559, -281.62144475812676, -610.7557675344099, -107.81269722599106, -347.0308016910929, -1326.4131330593648, -1321.258769011673, -18.426820305625554, -1375.0554240403324, -1274.4275492744564, -548.5060816314252, -940.9779758152505, -1125.7234895304541, -932.6632615094854, -1367.542832141159, -867.419791121168, -336.81416779587613, -1150.780986561436, -239.9767211049403, -77.69954002012075, -636.6693679538811, -1249.6157902586972, -90.27490570656724, -1084.9547612195004, -1097.2024581957296, -643.4758316381209, -1089.9795938847883, -1109.0486735695088], "episode_lengths": [150, 150, 150, 150, 51, 150, 150, 150, 150, 104, 150, 150, 150, 123, 70, 150, 150, 150, 150, 125, 131, 150, 150, 150, 150, 87, 150, 150, 150, 105, 150, 150, 37, 150, 150, 144, 38, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 108, 58, 150, 150, 150, 150, 150, 150, 150, 72, 150, 83, 150, 138, 83, 119, 52, 82, 150, 150, 38, 150, 150, 138, 150, 150, 150, 150, 150, 107, 150, 85, 62, 139, 150, 54, 150, 150, 138, 150, 150], "policy_policy_0_reward": [-1128.9448408663861, -1030.2297604013372, -1080.9319570655855, -1277.3421179029876, -82.29591214511741, -1271.6593148755899, -1128.7390192544697, -1304.925893629818, -1047.2158350075347, -202.07762276107928, -1018.5030180163358, -594.8395642750557, -623.3560182662275, -369.7480082442304, -250.07551521627602, -916.5143659085371, -1119.6113158124638, -1215.8076972103836, -914.5622174754436, -495.18111862963167, -510.0024546595044, -975.8505135015135, -664.7459344951453, -999.9217225392197, -824.0632932015177, -104.92889183208345, -1016.6683959971192, -953.6350123641896, -560.9989466715533, -212.06031744636752, -1152.0393981399957, -1155.065377539978, -29.1405726211118, -1085.7706467366313, -758.2656700108888, -801.0235528793029, -10.37439096034601, -511.12250604629014, -1106.6717105486043, -172.00514574345766, -795.7791976703605, -1065.7720519789111, -1155.0354423905876, -1346.011656232986, -1085.3884612555094, -771.1241322848385, -1045.1230811997639, -1047.2150890514865, -160.27818915944894, -1324.2428161622715, -844.1964577996673, -1246.1853691602305, -1405.8904694219552, -1220.0927389900564, -456.11921713174695, -1018.0263903184609, -1123.1382839049988, -1086.6555425496515, -1431.8492171202365, -473.7259145384595, -57.03094510460842, -798.1703537619375, -849.2963084242203, -966.5387921942398, -1165.3023639549867, -1403.091729984989, -729.6910654871177, -1031.8277855124509, -211.450356835416, -1182.7236639116027, -306.98753622907157, -1080.9688794289461, -604.6955783015559, -281.62144475812676, -610.7557675344099, -107.81269722599106, -347.0308016910929, -1326.4131330593648, -1321.258769011673, -18.426820305625554, -1375.0554240403324, -1274.4275492744564, -548.5060816314252, -940.9779758152505, -1125.7234895304541, -932.6632615094854, -1367.542832141159, -867.419791121168, -336.81416779587613, -1150.780986561436, -239.9767211049403, -77.69954002012075, -636.6693679538811, -1249.6157902586972, -90.27490570656724, -1084.9547612195004, -1097.2024581957296, -643.4758316381209, -1089.9795938847883, -1109.0486735695088]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.558601632566174, "mean_inference_ms": 1.6713873474863303, "mean_action_processing_ms": 0.2807761160959631, "mean_env_wait_ms": 3.45387966789584, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012862443923950195, "StateBufferConnector_ms": 0.008497953414916992, "ViewRequirementAgentConnector_ms": 0.1900331974029541}, "num_episodes": 33, "episode_return_max": -10.37439096034601, "episode_return_min": -1431.8492171202365, "episode_return_mean": -824.1866928091126, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.00844210395087, "num_env_steps_trained_throughput_per_sec": 338.00844210395087, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12590.672, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12590.605, "sample_time_ms": 1124.777, "learn_time_ms": 11396.524, "learn_throughput": 350.984, "synch_weights_time_ms": 68.502}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00002", "date": "2024-08-04_05-40-11", "timestamp": 1722730211, "time_this_iter_s": 11.845765829086304, "time_total_s": 88.21950912475586, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5ed40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 88.21950912475586, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.023529411764706, "ram_util_percent": 27.811764705882354}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 158.25412201583384, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.128682060043017, "policy_loss": -0.011224545722749705, "vf_loss": 4.151822063451012, "vf_explained_var": 0.9560907548914354, "kl": 0.015493685938721085, "entropy": 1.6563561509052913, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -10.37439096034601, "episode_reward_min": -1431.8492171202365, "episode_reward_mean": -804.5927229189319, "episode_len_mean": 128.98, "episode_media": {}, "episodes_timesteps_total": 12898, "policy_reward_min": {"policy_0": -1431.8492171202365}, "policy_reward_max": {"policy_0": -10.37439096034601}, "policy_reward_mean": {"policy_0": -804.5927229189319}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-29.1405726211118, -1085.7706467366313, -758.2656700108888, -801.0235528793029, -10.37439096034601, -511.12250604629014, -1106.6717105486043, -172.00514574345766, -795.7791976703605, -1065.7720519789111, -1155.0354423905876, -1346.011656232986, -1085.3884612555094, -771.1241322848385, -1045.1230811997639, -1047.2150890514865, -160.27818915944894, -1324.2428161622715, -844.1964577996673, -1246.1853691602305, -1405.8904694219552, -1220.0927389900564, -456.11921713174695, -1018.0263903184609, -1123.1382839049988, -1086.6555425496515, -1431.8492171202365, -473.7259145384595, -57.03094510460842, -798.1703537619375, -849.2963084242203, -966.5387921942398, -1165.3023639549867, -1403.091729984989, -729.6910654871177, -1031.8277855124509, -211.450356835416, -1182.7236639116027, -306.98753622907157, -1080.9688794289461, -604.6955783015559, -281.62144475812676, -610.7557675344099, -107.81269722599106, -347.0308016910929, -1326.4131330593648, -1321.258769011673, -18.426820305625554, -1375.0554240403324, -1274.4275492744564, -548.5060816314252, -940.9779758152505, -1125.7234895304541, -932.6632615094854, -1367.542832141159, -867.419791121168, -336.81416779587613, -1150.780986561436, -239.9767211049403, -77.69954002012075, -636.6693679538811, -1249.6157902586972, -90.27490570656724, -1084.9547612195004, -1097.2024581957296, -643.4758316381209, -1089.9795938847883, -1109.0486735695088, -1312.4486978871716, -1316.8045845991048, -44.56681999084866, -682.8416253743678, -280.4192436467683, -490.00033093786595, -104.13424456556352, -1299.5340539, -721.0550818943178, -1118.2921724108692, -815.7944716120202, -59.763023774383285, -1093.842558853433, -916.4976775300047, -355.1844895856426, -807.1174555166994, -1131.462338361005, -1206.6109406022417, -234.2194661473617, -976.4685756625164, -680.2128638554445, -1400.8367381612718, -1055.0116806787512, -133.35350657984358, -1205.8472833044552, -134.14168474608132, -191.6074242149907, -1142.8850384725101, -671.1528168103056, -1043.402938919162, -436.6831730640151, -1180.9513806755936], "episode_lengths": [37, 150, 150, 144, 38, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 150, 150, 150, 148, 150, 150, 150, 150, 108, 58, 150, 150, 150, 150, 150, 150, 150, 72, 150, 83, 150, 138, 83, 119, 52, 82, 150, 150, 38, 150, 150, 138, 150, 150, 150, 150, 150, 107, 150, 85, 62, 139, 150, 54, 150, 150, 138, 150, 150, 150, 150, 39, 125, 109, 131, 81, 150, 150, 150, 150, 40, 150, 150, 92, 150, 150, 150, 97, 150, 150, 150, 150, 82, 150, 84, 71, 150, 128, 150, 150, 150], "policy_policy_0_reward": [-29.1405726211118, -1085.7706467366313, -758.2656700108888, -801.0235528793029, -10.37439096034601, -511.12250604629014, -1106.6717105486043, -172.00514574345766, -795.7791976703605, -1065.7720519789111, -1155.0354423905876, -1346.011656232986, -1085.3884612555094, -771.1241322848385, -1045.1230811997639, -1047.2150890514865, -160.27818915944894, -1324.2428161622715, -844.1964577996673, -1246.1853691602305, -1405.8904694219552, -1220.0927389900564, -456.11921713174695, -1018.0263903184609, -1123.1382839049988, -1086.6555425496515, -1431.8492171202365, -473.7259145384595, -57.03094510460842, -798.1703537619375, -849.2963084242203, -966.5387921942398, -1165.3023639549867, -1403.091729984989, -729.6910654871177, -1031.8277855124509, -211.450356835416, -1182.7236639116027, -306.98753622907157, -1080.9688794289461, -604.6955783015559, -281.62144475812676, -610.7557675344099, -107.81269722599106, -347.0308016910929, -1326.4131330593648, -1321.258769011673, -18.426820305625554, -1375.0554240403324, -1274.4275492744564, -548.5060816314252, -940.9779758152505, -1125.7234895304541, -932.6632615094854, -1367.542832141159, -867.419791121168, -336.81416779587613, -1150.780986561436, -239.9767211049403, -77.69954002012075, -636.6693679538811, -1249.6157902586972, -90.27490570656724, -1084.9547612195004, -1097.2024581957296, -643.4758316381209, -1089.9795938847883, -1109.0486735695088, -1312.4486978871716, -1316.8045845991048, -44.56681999084866, -682.8416253743678, -280.4192436467683, -490.00033093786595, -104.13424456556352, -1299.5340539, -721.0550818943178, -1118.2921724108692, -815.7944716120202, -59.763023774383285, -1093.842558853433, -916.4976775300047, -355.1844895856426, -807.1174555166994, -1131.462338361005, -1206.6109406022417, -234.2194661473617, -976.4685756625164, -680.2128638554445, -1400.8367381612718, -1055.0116806787512, -133.35350657984358, -1205.8472833044552, -134.14168474608132, -191.6074242149907, -1142.8850384725101, -671.1528168103056, -1043.402938919162, -436.6831730640151, -1180.9513806755936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5576735560750611, "mean_inference_ms": 1.6707214197725586, "mean_action_processing_ms": 0.2804790237810328, "mean_env_wait_ms": 3.4642570966748822, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012599706649780273, "StateBufferConnector_ms": 0.008395195007324219, "ViewRequirementAgentConnector_ms": 0.19193410873413086}, "num_episodes": 32, "episode_return_max": -10.37439096034601, "episode_return_min": -1431.8492171202365, "episode_return_mean": -804.5927229189319, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.20244455327827, "num_env_steps_trained_throughput_per_sec": 321.20244455327827, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12573.49, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12573.423, "sample_time_ms": 1128.416, "learn_time_ms": 11373.126, "learn_throughput": 351.706, "synch_weights_time_ms": 71.067}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00002", "date": "2024-08-04_05-40-23", "timestamp": 1722730223, "time_this_iter_s": 12.466086626052856, "time_total_s": 100.68559575080872, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16ee9090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 100.68559575080872, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.444444444444446, "ram_util_percent": 27.89444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 194.24364165266354, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.5654026011625928, "policy_loss": -0.008024779385596047, "vf_loss": 3.5844130113720896, "vf_explained_var": 0.9657336639240384, "kl": 0.014477116773923627, "entropy": 1.5328771552691858, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -18.426820305625554, "episode_reward_min": -1400.8367381612718, "episode_reward_mean": -725.6777705894311, "episode_len_mean": 124.28, "episode_media": {}, "episodes_timesteps_total": 12428, "policy_reward_min": {"policy_0": -1400.8367381612718}, "policy_reward_max": {"policy_0": -18.426820305625554}, "policy_reward_mean": {"policy_0": -725.6777705894311}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-729.6910654871177, -1031.8277855124509, -211.450356835416, -1182.7236639116027, -306.98753622907157, -1080.9688794289461, -604.6955783015559, -281.62144475812676, -610.7557675344099, -107.81269722599106, -347.0308016910929, -1326.4131330593648, -1321.258769011673, -18.426820305625554, -1375.0554240403324, -1274.4275492744564, -548.5060816314252, -940.9779758152505, -1125.7234895304541, -932.6632615094854, -1367.542832141159, -867.419791121168, -336.81416779587613, -1150.780986561436, -239.9767211049403, -77.69954002012075, -636.6693679538811, -1249.6157902586972, -90.27490570656724, -1084.9547612195004, -1097.2024581957296, -643.4758316381209, -1089.9795938847883, -1109.0486735695088, -1312.4486978871716, -1316.8045845991048, -44.56681999084866, -682.8416253743678, -280.4192436467683, -490.00033093786595, -104.13424456556352, -1299.5340539, -721.0550818943178, -1118.2921724108692, -815.7944716120202, -59.763023774383285, -1093.842558853433, -916.4976775300047, -355.1844895856426, -807.1174555166994, -1131.462338361005, -1206.6109406022417, -234.2194661473617, -976.4685756625164, -680.2128638554445, -1400.8367381612718, -1055.0116806787512, -133.35350657984358, -1205.8472833044552, -134.14168474608132, -191.6074242149907, -1142.8850384725101, -671.1528168103056, -1043.402938919162, -436.6831730640151, -1180.9513806755936, -841.4730914938558, -67.0870720889322, -1196.36278726076, -902.3920533858219, -366.83210367735717, -719.5707602345321, -1109.5155599714901, -200.8822030159526, -170.4422607482119, -39.677094541644706, -840.1527288098731, -445.0248420318188, -802.1687341215409, -168.59073051185243, -88.82880801657356, -317.32679139345646, -646.1813904017156, -1258.0012996376347, -152.15338922322044, -618.55537857715, -447.8648038936802, -683.5074435976242, -1248.0551071011544, -902.4735365999459, -1033.8480836341755, -1196.3477724567565, -317.3177942313604, -1054.8386988215607, -283.85361043082827, -1056.6542256832895, -289.56823945615866, -647.1732527389678, -1030.0344690629304, -781.4030574913369], "episode_lengths": [150, 150, 72, 150, 83, 150, 138, 83, 119, 52, 82, 150, 150, 38, 150, 150, 138, 150, 150, 150, 150, 150, 107, 150, 85, 62, 139, 150, 54, 150, 150, 138, 150, 150, 150, 150, 39, 125, 109, 131, 81, 150, 150, 150, 150, 40, 150, 150, 92, 150, 150, 150, 97, 150, 150, 150, 150, 82, 150, 84, 71, 150, 128, 150, 150, 150, 150, 62, 150, 150, 96, 132, 150, 71, 73, 59, 150, 116, 138, 56, 53, 97, 150, 150, 73, 150, 150, 123, 150, 150, 150, 150, 78, 150, 121, 150, 85, 126, 150, 150], "policy_policy_0_reward": [-729.6910654871177, -1031.8277855124509, -211.450356835416, -1182.7236639116027, -306.98753622907157, -1080.9688794289461, -604.6955783015559, -281.62144475812676, -610.7557675344099, -107.81269722599106, -347.0308016910929, -1326.4131330593648, -1321.258769011673, -18.426820305625554, -1375.0554240403324, -1274.4275492744564, -548.5060816314252, -940.9779758152505, -1125.7234895304541, -932.6632615094854, -1367.542832141159, -867.419791121168, -336.81416779587613, -1150.780986561436, -239.9767211049403, -77.69954002012075, -636.6693679538811, -1249.6157902586972, -90.27490570656724, -1084.9547612195004, -1097.2024581957296, -643.4758316381209, -1089.9795938847883, -1109.0486735695088, -1312.4486978871716, -1316.8045845991048, -44.56681999084866, -682.8416253743678, -280.4192436467683, -490.00033093786595, -104.13424456556352, -1299.5340539, -721.0550818943178, -1118.2921724108692, -815.7944716120202, -59.763023774383285, -1093.842558853433, -916.4976775300047, -355.1844895856426, -807.1174555166994, -1131.462338361005, -1206.6109406022417, -234.2194661473617, -976.4685756625164, -680.2128638554445, -1400.8367381612718, -1055.0116806787512, -133.35350657984358, -1205.8472833044552, -134.14168474608132, -191.6074242149907, -1142.8850384725101, -671.1528168103056, -1043.402938919162, -436.6831730640151, -1180.9513806755936, -841.4730914938558, -67.0870720889322, -1196.36278726076, -902.3920533858219, -366.83210367735717, -719.5707602345321, -1109.5155599714901, -200.8822030159526, -170.4422607482119, -39.677094541644706, -840.1527288098731, -445.0248420318188, -802.1687341215409, -168.59073051185243, -88.82880801657356, -317.32679139345646, -646.1813904017156, -1258.0012996376347, -152.15338922322044, -618.55537857715, -447.8648038936802, -683.5074435976242, -1248.0551071011544, -902.4735365999459, -1033.8480836341755, -1196.3477724567565, -317.3177942313604, -1054.8386988215607, -283.85361043082827, -1056.6542256832895, -289.56823945615866, -647.1732527389678, -1030.0344690629304, -781.4030574913369]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5576686383171855, "mean_inference_ms": 1.6712188781346706, "mean_action_processing_ms": 0.2798715461199402, "mean_env_wait_ms": 3.473883151554472, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011987686157226562, "StateBufferConnector_ms": 0.008126974105834961, "ViewRequirementAgentConnector_ms": 0.1904590129852295}, "num_episodes": 34, "episode_return_max": -18.426820305625554, "episode_return_min": -1400.8367381612718, "episode_return_mean": -725.6777705894311, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.0731539663657, "num_env_steps_trained_throughput_per_sec": 301.0731539663657, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12652.638, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12652.57, "sample_time_ms": 1125.29, "learn_time_ms": 11456.167, "learn_throughput": 349.157, "synch_weights_time_ms": 70.303}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00002", "date": "2024-08-04_05-40-37", "timestamp": 1722730237, "time_this_iter_s": 13.29830527305603, "time_total_s": 113.98390102386475, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5f370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 113.98390102386475, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.647368421052636, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 214.04567725459734, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.741703009294967, "policy_loss": -0.011628585411138677, "vf_loss": 2.7661888701841235, "vf_explained_var": 0.9806959756339589, "kl": 0.01313341578958596, "entropy": 1.6797302549084028, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -4.520090761933366, "episode_reward_min": -1400.8367381612718, "episode_reward_mean": -707.9989463472832, "episode_len_mean": 127.09, "episode_media": {}, "episodes_timesteps_total": 12709, "policy_reward_min": {"policy_0": -1400.8367381612718}, "policy_reward_max": {"policy_0": -4.520090761933366}, "policy_reward_mean": {"policy_0": -707.9989463472832}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1097.2024581957296, -643.4758316381209, -1089.9795938847883, -1109.0486735695088, -1312.4486978871716, -1316.8045845991048, -44.56681999084866, -682.8416253743678, -280.4192436467683, -490.00033093786595, -104.13424456556352, -1299.5340539, -721.0550818943178, -1118.2921724108692, -815.7944716120202, -59.763023774383285, -1093.842558853433, -916.4976775300047, -355.1844895856426, -807.1174555166994, -1131.462338361005, -1206.6109406022417, -234.2194661473617, -976.4685756625164, -680.2128638554445, -1400.8367381612718, -1055.0116806787512, -133.35350657984358, -1205.8472833044552, -134.14168474608132, -191.6074242149907, -1142.8850384725101, -671.1528168103056, -1043.402938919162, -436.6831730640151, -1180.9513806755936, -841.4730914938558, -67.0870720889322, -1196.36278726076, -902.3920533858219, -366.83210367735717, -719.5707602345321, -1109.5155599714901, -200.8822030159526, -170.4422607482119, -39.677094541644706, -840.1527288098731, -445.0248420318188, -802.1687341215409, -168.59073051185243, -88.82880801657356, -317.32679139345646, -646.1813904017156, -1258.0012996376347, -152.15338922322044, -618.55537857715, -447.8648038936802, -683.5074435976242, -1248.0551071011544, -902.4735365999459, -1033.8480836341755, -1196.3477724567565, -317.3177942313604, -1054.8386988215607, -283.85361043082827, -1056.6542256832895, -289.56823945615866, -647.1732527389678, -1030.0344690629304, -781.4030574913369, -545.3612573247947, -4.520090761933366, -161.44038233241804, -147.92884062693355, -1075.8689039564028, -1197.2238212598013, -317.7184560832245, -334.1211822863878, -881.7450461297681, -468.3352428722994, -33.39673970260341, -764.0109543862336, -476.4927351508211, -477.1082619988078, -529.1462985051988, -698.7946706922337, -911.5838159292001, -1324.585721921872, -709.8122676666317, -909.9050796197482, -1076.0169338590306, -645.5142415086806, -409.45659803164176, -907.784567320008, -858.4148980437915, -1142.0878537594183, -1348.9316194360485, -1166.5291655764968, -653.684113243066, -515.3647607768949], "episode_lengths": [150, 138, 150, 150, 150, 150, 39, 125, 109, 131, 81, 150, 150, 150, 150, 40, 150, 150, 92, 150, 150, 150, 97, 150, 150, 150, 150, 82, 150, 84, 71, 150, 128, 150, 150, 150, 150, 62, 150, 150, 96, 132, 150, 71, 73, 59, 150, 116, 138, 56, 53, 97, 150, 150, 73, 150, 150, 123, 150, 150, 150, 150, 78, 150, 121, 150, 85, 126, 150, 150, 121, 36, 67, 92, 150, 150, 150, 150, 150, 111, 48, 150, 150, 128, 119, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 115], "policy_policy_0_reward": [-1097.2024581957296, -643.4758316381209, -1089.9795938847883, -1109.0486735695088, -1312.4486978871716, -1316.8045845991048, -44.56681999084866, -682.8416253743678, -280.4192436467683, -490.00033093786595, -104.13424456556352, -1299.5340539, -721.0550818943178, -1118.2921724108692, -815.7944716120202, -59.763023774383285, -1093.842558853433, -916.4976775300047, -355.1844895856426, -807.1174555166994, -1131.462338361005, -1206.6109406022417, -234.2194661473617, -976.4685756625164, -680.2128638554445, -1400.8367381612718, -1055.0116806787512, -133.35350657984358, -1205.8472833044552, -134.14168474608132, -191.6074242149907, -1142.8850384725101, -671.1528168103056, -1043.402938919162, -436.6831730640151, -1180.9513806755936, -841.4730914938558, -67.0870720889322, -1196.36278726076, -902.3920533858219, -366.83210367735717, -719.5707602345321, -1109.5155599714901, -200.8822030159526, -170.4422607482119, -39.677094541644706, -840.1527288098731, -445.0248420318188, -802.1687341215409, -168.59073051185243, -88.82880801657356, -317.32679139345646, -646.1813904017156, -1258.0012996376347, -152.15338922322044, -618.55537857715, -447.8648038936802, -683.5074435976242, -1248.0551071011544, -902.4735365999459, -1033.8480836341755, -1196.3477724567565, -317.3177942313604, -1054.8386988215607, -283.85361043082827, -1056.6542256832895, -289.56823945615866, -647.1732527389678, -1030.0344690629304, -781.4030574913369, -545.3612573247947, -4.520090761933366, -161.44038233241804, -147.92884062693355, -1075.8689039564028, -1197.2238212598013, -317.7184560832245, -334.1211822863878, -881.7450461297681, -468.3352428722994, -33.39673970260341, -764.0109543862336, -476.4927351508211, -477.1082619988078, -529.1462985051988, -698.7946706922337, -911.5838159292001, -1324.585721921872, -709.8122676666317, -909.9050796197482, -1076.0169338590306, -645.5142415086806, -409.45659803164176, -907.784567320008, -858.4148980437915, -1142.0878537594183, -1348.9316194360485, -1166.5291655764968, -653.684113243066, -515.3647607768949]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5571530266650857, "mean_inference_ms": 1.6704547030569794, "mean_action_processing_ms": 0.2793322494580029, "mean_env_wait_ms": 3.479777115202145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011817216873168945, "StateBufferConnector_ms": 0.008026838302612305, "ViewRequirementAgentConnector_ms": 0.1899583339691162}, "num_episodes": 30, "episode_return_max": -4.520090761933366, "episode_return_min": -1400.8367381612718, "episode_return_mean": -707.9989463472832, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 434.1216069791427, "num_env_steps_trained_throughput_per_sec": 434.1216069791427, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12308.776, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12308.708, "sample_time_ms": 1133.763, "learn_time_ms": 11104.474, "learn_throughput": 360.215, "synch_weights_time_ms": 69.616}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00002", "date": "2024-08-04_05-40-46", "timestamp": 1722730246, "time_this_iter_s": 9.226362943649292, "time_total_s": 123.21026396751404, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f67400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 123.21026396751404, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 21.246153846153845, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 204.79110795458158, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.01681203742822, "policy_loss": -0.008977719366763873, "vf_loss": 3.0394032418727877, "vf_explained_var": 0.985734578842918, "kl": 0.014737431560934067, "entropy": 1.8034721209357183, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -4.520090761933366, "episode_reward_min": -1441.6854749714057, "episode_reward_mean": -731.8658722794279, "episode_len_mean": 128.36, "episode_media": {}, "episodes_timesteps_total": 12836, "policy_reward_min": {"policy_0": -1441.6854749714057}, "policy_reward_max": {"policy_0": -4.520090761933366}, "policy_reward_mean": {"policy_0": -731.8658722794279}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-134.14168474608132, -191.6074242149907, -1142.8850384725101, -671.1528168103056, -1043.402938919162, -436.6831730640151, -1180.9513806755936, -841.4730914938558, -67.0870720889322, -1196.36278726076, -902.3920533858219, -366.83210367735717, -719.5707602345321, -1109.5155599714901, -200.8822030159526, -170.4422607482119, -39.677094541644706, -840.1527288098731, -445.0248420318188, -802.1687341215409, -168.59073051185243, -88.82880801657356, -317.32679139345646, -646.1813904017156, -1258.0012996376347, -152.15338922322044, -618.55537857715, -447.8648038936802, -683.5074435976242, -1248.0551071011544, -902.4735365999459, -1033.8480836341755, -1196.3477724567565, -317.3177942313604, -1054.8386988215607, -283.85361043082827, -1056.6542256832895, -289.56823945615866, -647.1732527389678, -1030.0344690629304, -781.4030574913369, -545.3612573247947, -4.520090761933366, -161.44038233241804, -147.92884062693355, -1075.8689039564028, -1197.2238212598013, -317.7184560832245, -334.1211822863878, -881.7450461297681, -468.3352428722994, -33.39673970260341, -764.0109543862336, -476.4927351508211, -477.1082619988078, -529.1462985051988, -698.7946706922337, -911.5838159292001, -1324.585721921872, -709.8122676666317, -909.9050796197482, -1076.0169338590306, -645.5142415086806, -409.45659803164176, -907.784567320008, -858.4148980437915, -1142.0878537594183, -1348.9316194360485, -1166.5291655764968, -653.684113243066, -515.3647607768949, -1210.7506729541947, -905.6917029508612, -1329.3897007099422, -1235.7430751692218, -1195.9097852379828, -1176.5006870698828, -967.4571294316117, -1247.102319571711, -1180.6863556397434, -308.5370503191259, -1067.5272122555384, -1015.7001779240089, -1174.7125915641327, -332.36501398458427, -1212.403128071436, -604.9705427322543, -217.22472077406155, -1441.6854749714057, -711.2202988826596, -1096.453622684461, -930.8058576201798, -508.61387129745503, -1095.0044313634419, -1044.977108454115, -106.34028548549763, -963.81912252795, -186.21428735948743, -284.4566530338215, -1016.4561958938324], "episode_lengths": [84, 71, 150, 128, 150, 150, 150, 150, 62, 150, 150, 96, 132, 150, 71, 73, 59, 150, 116, 138, 56, 53, 97, 150, 150, 73, 150, 150, 123, 150, 150, 150, 150, 78, 150, 121, 150, 85, 126, 150, 150, 121, 36, 67, 92, 150, 150, 150, 150, 150, 111, 48, 150, 150, 128, 119, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 67, 150, 150, 150, 150, 105, 150, 150, 64, 150, 61, 81, 150], "policy_policy_0_reward": [-134.14168474608132, -191.6074242149907, -1142.8850384725101, -671.1528168103056, -1043.402938919162, -436.6831730640151, -1180.9513806755936, -841.4730914938558, -67.0870720889322, -1196.36278726076, -902.3920533858219, -366.83210367735717, -719.5707602345321, -1109.5155599714901, -200.8822030159526, -170.4422607482119, -39.677094541644706, -840.1527288098731, -445.0248420318188, -802.1687341215409, -168.59073051185243, -88.82880801657356, -317.32679139345646, -646.1813904017156, -1258.0012996376347, -152.15338922322044, -618.55537857715, -447.8648038936802, -683.5074435976242, -1248.0551071011544, -902.4735365999459, -1033.8480836341755, -1196.3477724567565, -317.3177942313604, -1054.8386988215607, -283.85361043082827, -1056.6542256832895, -289.56823945615866, -647.1732527389678, -1030.0344690629304, -781.4030574913369, -545.3612573247947, -4.520090761933366, -161.44038233241804, -147.92884062693355, -1075.8689039564028, -1197.2238212598013, -317.7184560832245, -334.1211822863878, -881.7450461297681, -468.3352428722994, -33.39673970260341, -764.0109543862336, -476.4927351508211, -477.1082619988078, -529.1462985051988, -698.7946706922337, -911.5838159292001, -1324.585721921872, -709.8122676666317, -909.9050796197482, -1076.0169338590306, -645.5142415086806, -409.45659803164176, -907.784567320008, -858.4148980437915, -1142.0878537594183, -1348.9316194360485, -1166.5291655764968, -653.684113243066, -515.3647607768949, -1210.7506729541947, -905.6917029508612, -1329.3897007099422, -1235.7430751692218, -1195.9097852379828, -1176.5006870698828, -967.4571294316117, -1247.102319571711, -1180.6863556397434, -308.5370503191259, -1067.5272122555384, -1015.7001779240089, -1174.7125915641327, -332.36501398458427, -1212.403128071436, -604.9705427322543, -217.22472077406155, -1441.6854749714057, -711.2202988826596, -1096.453622684461, -930.8058576201798, -508.61387129745503, -1095.0044313634419, -1044.977108454115, -106.34028548549763, -963.81912252795, -186.21428735948743, -284.4566530338215, -1016.4561958938324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565347881500037, "mean_inference_ms": 1.6700424661252438, "mean_action_processing_ms": 0.2791648930142214, "mean_env_wait_ms": 3.483656050238425, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011633634567260742, "StateBufferConnector_ms": 0.00788259506225586, "ViewRequirementAgentConnector_ms": 0.18604755401611328}, "num_episodes": 29, "episode_return_max": -4.520090761933366, "episode_return_min": -1441.6854749714057, "episode_return_mean": -731.8658722794279, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.5794195166475, "num_env_steps_trained_throughput_per_sec": 311.5794195166475, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12311.286, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12311.218, "sample_time_ms": 1135.247, "learn_time_ms": 11106.461, "learn_throughput": 360.151, "synch_weights_time_ms": 68.653}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00002", "date": "2024-08-04_05-40-59", "timestamp": 1722730259, "time_this_iter_s": 12.850541591644287, "time_total_s": 136.06080555915833, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16ee9090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 136.06080555915833, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.211111111111112, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 191.0755090365807, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.363151926298936, "policy_loss": -0.00899292235893275, "vf_loss": 2.3853642883400124, "vf_explained_var": 0.9650160407026609, "kl": 0.012382348405678097, "entropy": 1.6934148704012235, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -4.520090761933366, "episode_reward_min": -1441.6854749714057, "episode_reward_mean": -747.8683062360401, "episode_len_mean": 132.38, "episode_media": {}, "episodes_timesteps_total": 13238, "policy_reward_min": {"policy_0": -1441.6854749714057}, "policy_reward_max": {"policy_0": -4.520090761933366}, "policy_reward_mean": {"policy_0": -747.8683062360401}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1248.0551071011544, -902.4735365999459, -1033.8480836341755, -1196.3477724567565, -317.3177942313604, -1054.8386988215607, -283.85361043082827, -1056.6542256832895, -289.56823945615866, -647.1732527389678, -1030.0344690629304, -781.4030574913369, -545.3612573247947, -4.520090761933366, -161.44038233241804, -147.92884062693355, -1075.8689039564028, -1197.2238212598013, -317.7184560832245, -334.1211822863878, -881.7450461297681, -468.3352428722994, -33.39673970260341, -764.0109543862336, -476.4927351508211, -477.1082619988078, -529.1462985051988, -698.7946706922337, -911.5838159292001, -1324.585721921872, -709.8122676666317, -909.9050796197482, -1076.0169338590306, -645.5142415086806, -409.45659803164176, -907.784567320008, -858.4148980437915, -1142.0878537594183, -1348.9316194360485, -1166.5291655764968, -653.684113243066, -515.3647607768949, -1210.7506729541947, -905.6917029508612, -1329.3897007099422, -1235.7430751692218, -1195.9097852379828, -1176.5006870698828, -967.4571294316117, -1247.102319571711, -1180.6863556397434, -308.5370503191259, -1067.5272122555384, -1015.7001779240089, -1174.7125915641327, -332.36501398458427, -1212.403128071436, -604.9705427322543, -217.22472077406155, -1441.6854749714057, -711.2202988826596, -1096.453622684461, -930.8058576201798, -508.61387129745503, -1095.0044313634419, -1044.977108454115, -106.34028548549763, -963.81912252795, -186.21428735948743, -284.4566530338215, -1016.4561958938324, -237.4905028305662, -810.4312343161222, -41.55616041928096, -514.7317470443352, -1054.6687373942102, -854.8894337630309, -551.500230144445, -394.775332956055, -479.9041466183548, -749.9817086013206, -652.8452571167917, -1146.3141771620026, -477.5973825351935, -243.2827743145039, -822.006519764413, -557.3026687442584, -83.4170824630047, -318.43046212540537, -803.3919906956284, -504.9887874390286, -840.25370533422, -775.1512464276224, -817.8548516713714, -1301.3980930640514, -1049.626737854133, -215.04288831320497, -291.2440957518672, -867.7356172387509, -1025.8456070953687], "episode_lengths": [150, 150, 150, 150, 78, 150, 121, 150, 85, 126, 150, 150, 121, 36, 67, 92, 150, 150, 150, 150, 150, 111, 48, 150, 150, 128, 119, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 67, 150, 150, 150, 150, 105, 150, 150, 64, 150, 61, 81, 150, 150, 150, 42, 150, 150, 150, 150, 150, 117, 142, 150, 150, 99, 71, 149, 125, 62, 123, 150, 106, 150, 150, 150, 150, 150, 99, 99, 150, 150], "policy_policy_0_reward": [-1248.0551071011544, -902.4735365999459, -1033.8480836341755, -1196.3477724567565, -317.3177942313604, -1054.8386988215607, -283.85361043082827, -1056.6542256832895, -289.56823945615866, -647.1732527389678, -1030.0344690629304, -781.4030574913369, -545.3612573247947, -4.520090761933366, -161.44038233241804, -147.92884062693355, -1075.8689039564028, -1197.2238212598013, -317.7184560832245, -334.1211822863878, -881.7450461297681, -468.3352428722994, -33.39673970260341, -764.0109543862336, -476.4927351508211, -477.1082619988078, -529.1462985051988, -698.7946706922337, -911.5838159292001, -1324.585721921872, -709.8122676666317, -909.9050796197482, -1076.0169338590306, -645.5142415086806, -409.45659803164176, -907.784567320008, -858.4148980437915, -1142.0878537594183, -1348.9316194360485, -1166.5291655764968, -653.684113243066, -515.3647607768949, -1210.7506729541947, -905.6917029508612, -1329.3897007099422, -1235.7430751692218, -1195.9097852379828, -1176.5006870698828, -967.4571294316117, -1247.102319571711, -1180.6863556397434, -308.5370503191259, -1067.5272122555384, -1015.7001779240089, -1174.7125915641327, -332.36501398458427, -1212.403128071436, -604.9705427322543, -217.22472077406155, -1441.6854749714057, -711.2202988826596, -1096.453622684461, -930.8058576201798, -508.61387129745503, -1095.0044313634419, -1044.977108454115, -106.34028548549763, -963.81912252795, -186.21428735948743, -284.4566530338215, -1016.4561958938324, -237.4905028305662, -810.4312343161222, -41.55616041928096, -514.7317470443352, -1054.6687373942102, -854.8894337630309, -551.500230144445, -394.775332956055, -479.9041466183548, -749.9817086013206, -652.8452571167917, -1146.3141771620026, -477.5973825351935, -243.2827743145039, -822.006519764413, -557.3026687442584, -83.4170824630047, -318.43046212540537, -803.3919906956284, -504.9887874390286, -840.25370533422, -775.1512464276224, -817.8548516713714, -1301.3980930640514, -1049.626737854133, -215.04288831320497, -291.2440957518672, -867.7356172387509, -1025.8456070953687]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552481869875749, "mean_inference_ms": 1.6704289907720438, "mean_action_processing_ms": 0.27865924374598194, "mean_env_wait_ms": 3.488139377684685, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011669397354125977, "StateBufferConnector_ms": 0.007808685302734375, "ViewRequirementAgentConnector_ms": 0.1882781982421875}, "num_episodes": 29, "episode_return_max": -4.520090761933366, "episode_return_min": -1441.6854749714057, "episode_return_mean": -747.8683062360401, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.4090408414221, "num_env_steps_trained_throughput_per_sec": 302.4090408414221, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12340.077, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12340.008, "sample_time_ms": 1138.511, "learn_time_ms": 11129.563, "learn_throughput": 359.403, "synch_weights_time_ms": 71.056}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00002", "date": "2024-08-04_05-41-12", "timestamp": 1722730272, "time_this_iter_s": 13.240289211273193, "time_total_s": 149.30109477043152, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0ac940>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 149.30109477043152, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.900000000000002, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 206.4699437936147, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.891856100286047, "policy_loss": -0.005026964038067187, "vf_loss": 2.9097148393591246, "vf_explained_var": 0.9884617198258638, "kl": 0.019293090250736594, "entropy": 1.861970961963137, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -32.666852219931265, "episode_reward_min": -1484.607097877159, "episode_reward_mean": -735.9948773972319, "episode_len_mean": 130.11, "episode_media": {}, "episodes_timesteps_total": 13011, "policy_reward_min": {"policy_0": -1484.607097877159}, "policy_reward_max": {"policy_0": -32.666852219931265}, "policy_reward_mean": {"policy_0": -735.9948773972319}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-909.9050796197482, -1076.0169338590306, -645.5142415086806, -409.45659803164176, -907.784567320008, -858.4148980437915, -1142.0878537594183, -1348.9316194360485, -1166.5291655764968, -653.684113243066, -515.3647607768949, -1210.7506729541947, -905.6917029508612, -1329.3897007099422, -1235.7430751692218, -1195.9097852379828, -1176.5006870698828, -967.4571294316117, -1247.102319571711, -1180.6863556397434, -308.5370503191259, -1067.5272122555384, -1015.7001779240089, -1174.7125915641327, -332.36501398458427, -1212.403128071436, -604.9705427322543, -217.22472077406155, -1441.6854749714057, -711.2202988826596, -1096.453622684461, -930.8058576201798, -508.61387129745503, -1095.0044313634419, -1044.977108454115, -106.34028548549763, -963.81912252795, -186.21428735948743, -284.4566530338215, -1016.4561958938324, -237.4905028305662, -810.4312343161222, -41.55616041928096, -514.7317470443352, -1054.6687373942102, -854.8894337630309, -551.500230144445, -394.775332956055, -479.9041466183548, -749.9817086013206, -652.8452571167917, -1146.3141771620026, -477.5973825351935, -243.2827743145039, -822.006519764413, -557.3026687442584, -83.4170824630047, -318.43046212540537, -803.3919906956284, -504.9887874390286, -840.25370533422, -775.1512464276224, -817.8548516713714, -1301.3980930640514, -1049.626737854133, -215.04288831320497, -291.2440957518672, -867.7356172387509, -1025.8456070953687, -1033.3306131375791, -552.4651779282655, -1421.5475331637688, -1278.7435571260262, -227.9780724300939, -1360.8038475319408, -769.3717369863216, -788.9861546156877, -249.57801299075197, -354.7244758308369, -819.9122823455486, -78.08216572917327, -1097.5854545131106, -33.21968446030692, -212.82558544002322, -971.5060361885296, -1484.607097877159, -100.73882042472432, -266.54975349399007, -157.10458232059483, -863.0449426004095, -32.666852219931265, -509.3489403043565, -717.8665196705225, -559.658563926156, -45.95436082386643, -457.2207881067693, -865.2633887864702, -984.5535022651416, -687.5159277094398, -730.6652224677277], "episode_lengths": [150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 115, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 67, 150, 150, 150, 150, 105, 150, 150, 64, 150, 61, 81, 150, 150, 150, 42, 150, 150, 150, 150, 150, 117, 142, 150, 150, 99, 71, 149, 125, 62, 123, 150, 106, 150, 150, 150, 150, 150, 99, 99, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 70, 150, 150, 46, 150, 47, 66, 150, 150, 71, 104, 61, 150, 46, 128, 150, 108, 51, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-909.9050796197482, -1076.0169338590306, -645.5142415086806, -409.45659803164176, -907.784567320008, -858.4148980437915, -1142.0878537594183, -1348.9316194360485, -1166.5291655764968, -653.684113243066, -515.3647607768949, -1210.7506729541947, -905.6917029508612, -1329.3897007099422, -1235.7430751692218, -1195.9097852379828, -1176.5006870698828, -967.4571294316117, -1247.102319571711, -1180.6863556397434, -308.5370503191259, -1067.5272122555384, -1015.7001779240089, -1174.7125915641327, -332.36501398458427, -1212.403128071436, -604.9705427322543, -217.22472077406155, -1441.6854749714057, -711.2202988826596, -1096.453622684461, -930.8058576201798, -508.61387129745503, -1095.0044313634419, -1044.977108454115, -106.34028548549763, -963.81912252795, -186.21428735948743, -284.4566530338215, -1016.4561958938324, -237.4905028305662, -810.4312343161222, -41.55616041928096, -514.7317470443352, -1054.6687373942102, -854.8894337630309, -551.500230144445, -394.775332956055, -479.9041466183548, -749.9817086013206, -652.8452571167917, -1146.3141771620026, -477.5973825351935, -243.2827743145039, -822.006519764413, -557.3026687442584, -83.4170824630047, -318.43046212540537, -803.3919906956284, -504.9887874390286, -840.25370533422, -775.1512464276224, -817.8548516713714, -1301.3980930640514, -1049.626737854133, -215.04288831320497, -291.2440957518672, -867.7356172387509, -1025.8456070953687, -1033.3306131375791, -552.4651779282655, -1421.5475331637688, -1278.7435571260262, -227.9780724300939, -1360.8038475319408, -769.3717369863216, -788.9861546156877, -249.57801299075197, -354.7244758308369, -819.9122823455486, -78.08216572917327, -1097.5854545131106, -33.21968446030692, -212.82558544002322, -971.5060361885296, -1484.607097877159, -100.73882042472432, -266.54975349399007, -157.10458232059483, -863.0449426004095, -32.666852219931265, -509.3489403043565, -717.8665196705225, -559.658563926156, -45.95436082386643, -457.2207881067693, -865.2633887864702, -984.5535022651416, -687.5159277094398, -730.6652224677277]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542591994379245, "mean_inference_ms": 1.6717082661601128, "mean_action_processing_ms": 0.27867143994025656, "mean_env_wait_ms": 3.4985854556188922, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011904001235961914, "StateBufferConnector_ms": 0.007892131805419922, "ViewRequirementAgentConnector_ms": 0.1908268928527832}, "num_episodes": 31, "episode_return_max": -32.666852219931265, "episode_return_min": -1484.607097877159, "episode_return_mean": -735.9948773972319, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.43156195186566, "num_env_steps_trained_throughput_per_sec": 298.43156195186566, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12374.679, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12374.608, "sample_time_ms": 1139.828, "learn_time_ms": 11162.927, "learn_throughput": 358.329, "synch_weights_time_ms": 70.976}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00002", "date": "2024-08-04_05-41-26", "timestamp": 1722730286, "time_this_iter_s": 13.415763139724731, "time_total_s": 162.71685791015625, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f67010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 162.71685791015625, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.757894736842104, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 188.45319839517276, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.5388418699925146, "policy_loss": -0.011401025222342771, "vf_loss": 2.5601736923058827, "vf_explained_var": 0.9900847325101495, "kl": 0.01725373066304505, "entropy": 1.5106908338765304, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -32.666852219931265, "episode_reward_min": -1484.607097877159, "episode_reward_mean": -672.475252689806, "episode_len_mean": 129.07, "episode_media": {}, "episodes_timesteps_total": 12907, "policy_reward_min": {"policy_0": -1484.607097877159}, "policy_reward_max": {"policy_0": -32.666852219931265}, "policy_reward_mean": {"policy_0": -672.475252689806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1044.977108454115, -106.34028548549763, -963.81912252795, -186.21428735948743, -284.4566530338215, -1016.4561958938324, -237.4905028305662, -810.4312343161222, -41.55616041928096, -514.7317470443352, -1054.6687373942102, -854.8894337630309, -551.500230144445, -394.775332956055, -479.9041466183548, -749.9817086013206, -652.8452571167917, -1146.3141771620026, -477.5973825351935, -243.2827743145039, -822.006519764413, -557.3026687442584, -83.4170824630047, -318.43046212540537, -803.3919906956284, -504.9887874390286, -840.25370533422, -775.1512464276224, -817.8548516713714, -1301.3980930640514, -1049.626737854133, -215.04288831320497, -291.2440957518672, -867.7356172387509, -1025.8456070953687, -1033.3306131375791, -552.4651779282655, -1421.5475331637688, -1278.7435571260262, -227.9780724300939, -1360.8038475319408, -769.3717369863216, -788.9861546156877, -249.57801299075197, -354.7244758308369, -819.9122823455486, -78.08216572917327, -1097.5854545131106, -33.21968446030692, -212.82558544002322, -971.5060361885296, -1484.607097877159, -100.73882042472432, -266.54975349399007, -157.10458232059483, -863.0449426004095, -32.666852219931265, -509.3489403043565, -717.8665196705225, -559.658563926156, -45.95436082386643, -457.2207881067693, -865.2633887864702, -984.5535022651416, -687.5159277094398, -730.6652224677277, -1193.081861832415, -615.780285262025, -723.3822303672217, -499.52760460489174, -1443.4627104637273, -457.91978468111455, -833.2581238918428, -930.1030625870485, -1056.9716860681037, -985.7578941984622, -980.1173360061866, -381.31662389534694, -469.75077773838706, -1334.7887992533374, -69.99296541640257, -1217.3972769027582, -289.9721894724157, -399.7929537657501, -1083.8602466757225, -1173.6520447298067, -536.108154909854, -169.60186356455574, -917.6311671840624, -185.04692563076094, -309.4005912634213, -752.1424624398145, -1100.1315338210454, -550.5007787537303, -569.2740519053586, -714.6674124189011, -945.5866062794298, -1081.9962649420856, -354.3686097757218, -1121.839902910417], "episode_lengths": [150, 64, 150, 61, 81, 150, 150, 150, 42, 150, 150, 150, 150, 150, 117, 142, 150, 150, 99, 71, 149, 125, 62, 123, 150, 106, 150, 150, 150, 150, 150, 99, 99, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 70, 150, 150, 46, 150, 47, 66, 150, 150, 71, 104, 61, 150, 46, 128, 150, 108, 51, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 90, 125, 150, 54, 150, 125, 150, 150, 150, 150, 73, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150], "policy_policy_0_reward": [-1044.977108454115, -106.34028548549763, -963.81912252795, -186.21428735948743, -284.4566530338215, -1016.4561958938324, -237.4905028305662, -810.4312343161222, -41.55616041928096, -514.7317470443352, -1054.6687373942102, -854.8894337630309, -551.500230144445, -394.775332956055, -479.9041466183548, -749.9817086013206, -652.8452571167917, -1146.3141771620026, -477.5973825351935, -243.2827743145039, -822.006519764413, -557.3026687442584, -83.4170824630047, -318.43046212540537, -803.3919906956284, -504.9887874390286, -840.25370533422, -775.1512464276224, -817.8548516713714, -1301.3980930640514, -1049.626737854133, -215.04288831320497, -291.2440957518672, -867.7356172387509, -1025.8456070953687, -1033.3306131375791, -552.4651779282655, -1421.5475331637688, -1278.7435571260262, -227.9780724300939, -1360.8038475319408, -769.3717369863216, -788.9861546156877, -249.57801299075197, -354.7244758308369, -819.9122823455486, -78.08216572917327, -1097.5854545131106, -33.21968446030692, -212.82558544002322, -971.5060361885296, -1484.607097877159, -100.73882042472432, -266.54975349399007, -157.10458232059483, -863.0449426004095, -32.666852219931265, -509.3489403043565, -717.8665196705225, -559.658563926156, -45.95436082386643, -457.2207881067693, -865.2633887864702, -984.5535022651416, -687.5159277094398, -730.6652224677277, -1193.081861832415, -615.780285262025, -723.3822303672217, -499.52760460489174, -1443.4627104637273, -457.91978468111455, -833.2581238918428, -930.1030625870485, -1056.9716860681037, -985.7578941984622, -980.1173360061866, -381.31662389534694, -469.75077773838706, -1334.7887992533374, -69.99296541640257, -1217.3972769027582, -289.9721894724157, -399.7929537657501, -1083.8602466757225, -1173.6520447298067, -536.108154909854, -169.60186356455574, -917.6311671840624, -185.04692563076094, -309.4005912634213, -752.1424624398145, -1100.1315338210454, -550.5007787537303, -569.2740519053586, -714.6674124189011, -945.5866062794298, -1081.9962649420856, -354.3686097757218, -1121.839902910417]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538214138022612, "mean_inference_ms": 1.673643736439372, "mean_action_processing_ms": 0.2786629586603632, "mean_env_wait_ms": 3.50331806019055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011948347091674805, "StateBufferConnector_ms": 0.007962226867675781, "ViewRequirementAgentConnector_ms": 0.19233918190002441}, "num_episodes": 34, "episode_return_max": -32.666852219931265, "episode_return_min": -1484.607097877159, "episode_return_mean": -672.475252689806, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.4798375813983, "num_env_steps_trained_throughput_per_sec": 302.4798375813983, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12418.233, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12418.164, "sample_time_ms": 1144.714, "learn_time_ms": 11201.153, "learn_throughput": 357.106, "synch_weights_time_ms": 71.426}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00002", "date": "2024-08-04_05-41-39", "timestamp": 1722730299, "time_this_iter_s": 13.236429929733276, "time_total_s": 175.95328783988953, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a172d1360>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 175.95328783988953, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.900000000000002, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 232.44402819275857, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.7846089801440637, "policy_loss": -0.011861843640023533, "vf_loss": 2.8060149129480125, "vf_explained_var": 0.9765855445836981, "kl": 0.01651522565546961, "entropy": 1.4498648207634688, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -32.666852219931265, "episode_reward_min": -1484.607097877159, "episode_reward_mean": -699.1763683423785, "episode_len_mean": 130.46, "episode_media": {}, "episodes_timesteps_total": 13046, "policy_reward_min": {"policy_0": -1484.607097877159}, "policy_reward_max": {"policy_0": -32.666852219931265}, "policy_reward_mean": {"policy_0": -699.1763683423785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1301.3980930640514, -1049.626737854133, -215.04288831320497, -291.2440957518672, -867.7356172387509, -1025.8456070953687, -1033.3306131375791, -552.4651779282655, -1421.5475331637688, -1278.7435571260262, -227.9780724300939, -1360.8038475319408, -769.3717369863216, -788.9861546156877, -249.57801299075197, -354.7244758308369, -819.9122823455486, -78.08216572917327, -1097.5854545131106, -33.21968446030692, -212.82558544002322, -971.5060361885296, -1484.607097877159, -100.73882042472432, -266.54975349399007, -157.10458232059483, -863.0449426004095, -32.666852219931265, -509.3489403043565, -717.8665196705225, -559.658563926156, -45.95436082386643, -457.2207881067693, -865.2633887864702, -984.5535022651416, -687.5159277094398, -730.6652224677277, -1193.081861832415, -615.780285262025, -723.3822303672217, -499.52760460489174, -1443.4627104637273, -457.91978468111455, -833.2581238918428, -930.1030625870485, -1056.9716860681037, -985.7578941984622, -980.1173360061866, -381.31662389534694, -469.75077773838706, -1334.7887992533374, -69.99296541640257, -1217.3972769027582, -289.9721894724157, -399.7929537657501, -1083.8602466757225, -1173.6520447298067, -536.108154909854, -169.60186356455574, -917.6311671840624, -185.04692563076094, -309.4005912634213, -752.1424624398145, -1100.1315338210454, -550.5007787537303, -569.2740519053586, -714.6674124189011, -945.5866062794298, -1081.9962649420856, -354.3686097757218, -1121.839902910417, -803.5094167393321, -674.1365502894151, -851.1235158515027, -293.2383940379087, -1367.9570199407035, -479.5151152001733, -228.6842327820896, -1029.9754467754312, -305.3413351763325, -181.36971125195188, -331.2524015906673, -1266.121829766908, -587.6678353620765, -232.14255942886928, -1093.7025241782962, -122.04460403627616, -845.5088853475968, -683.2936023569075, -765.0309457855972, -1061.1706573678978, -1252.7460859017913, -554.3371596276827, -1165.2726686254443, -890.7872276526488, -838.4653885416585, -650.4464699299479, -154.88672939468307, -291.0637175368184, -1004.3493274165261], "episode_lengths": [150, 150, 99, 99, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 70, 150, 150, 46, 150, 47, 66, 150, 150, 71, 104, 61, 150, 46, 128, 150, 108, 51, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 90, 125, 150, 54, 150, 125, 150, 150, 150, 150, 73, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 108, 78, 150, 78, 74, 142, 150, 150, 69, 150, 70, 150, 150, 135, 150, 150, 138, 150, 150, 150, 150, 110, 79, 150], "policy_policy_0_reward": [-1301.3980930640514, -1049.626737854133, -215.04288831320497, -291.2440957518672, -867.7356172387509, -1025.8456070953687, -1033.3306131375791, -552.4651779282655, -1421.5475331637688, -1278.7435571260262, -227.9780724300939, -1360.8038475319408, -769.3717369863216, -788.9861546156877, -249.57801299075197, -354.7244758308369, -819.9122823455486, -78.08216572917327, -1097.5854545131106, -33.21968446030692, -212.82558544002322, -971.5060361885296, -1484.607097877159, -100.73882042472432, -266.54975349399007, -157.10458232059483, -863.0449426004095, -32.666852219931265, -509.3489403043565, -717.8665196705225, -559.658563926156, -45.95436082386643, -457.2207881067693, -865.2633887864702, -984.5535022651416, -687.5159277094398, -730.6652224677277, -1193.081861832415, -615.780285262025, -723.3822303672217, -499.52760460489174, -1443.4627104637273, -457.91978468111455, -833.2581238918428, -930.1030625870485, -1056.9716860681037, -985.7578941984622, -980.1173360061866, -381.31662389534694, -469.75077773838706, -1334.7887992533374, -69.99296541640257, -1217.3972769027582, -289.9721894724157, -399.7929537657501, -1083.8602466757225, -1173.6520447298067, -536.108154909854, -169.60186356455574, -917.6311671840624, -185.04692563076094, -309.4005912634213, -752.1424624398145, -1100.1315338210454, -550.5007787537303, -569.2740519053586, -714.6674124189011, -945.5866062794298, -1081.9962649420856, -354.3686097757218, -1121.839902910417, -803.5094167393321, -674.1365502894151, -851.1235158515027, -293.2383940379087, -1367.9570199407035, -479.5151152001733, -228.6842327820896, -1029.9754467754312, -305.3413351763325, -181.36971125195188, -331.2524015906673, -1266.121829766908, -587.6678353620765, -232.14255942886928, -1093.7025241782962, -122.04460403627616, -845.5088853475968, -683.2936023569075, -765.0309457855972, -1061.1706573678978, -1252.7460859017913, -554.3371596276827, -1165.2726686254443, -890.7872276526488, -838.4653885416585, -650.4464699299479, -154.88672939468307, -291.0637175368184, -1004.3493274165261]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532627286598919, "mean_inference_ms": 1.6730173348378556, "mean_action_processing_ms": 0.27804728191952355, "mean_env_wait_ms": 3.5071832927107316, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011957168579101562, "StateBufferConnector_ms": 0.0079803466796875, "ViewRequirementAgentConnector_ms": 0.1925063133239746}, "num_episodes": 29, "episode_return_max": -32.666852219931265, "episode_return_min": -1484.607097877159, "episode_return_mean": -699.1763683423785, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.1851522871895, "num_env_steps_trained_throughput_per_sec": 308.1851522871895, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12558.529, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12558.458, "sample_time_ms": 1145.823, "learn_time_ms": 11339.781, "learn_throughput": 352.74, "synch_weights_time_ms": 71.973}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00002", "date": "2024-08-04_05-41-52", "timestamp": 1722730312, "time_this_iter_s": 12.992190837860107, "time_total_s": 188.94547867774963, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f645e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 188.94547867774963, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.805263157894736, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 223.64187275568645, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.2219129519537093, "policy_loss": -0.010561991617820846, "vf_loss": 2.2445875147978467, "vf_explained_var": 0.9869966610645254, "kl": 0.01324260592155044, "entropy": 1.608535030980905, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -45.95436082386643, "episode_reward_min": -1443.4627104637273, "episode_reward_mean": -711.2811632974461, "episode_len_mean": 134.37, "episode_media": {}, "episodes_timesteps_total": 13437, "policy_reward_min": {"policy_0": -1443.4627104637273}, "policy_reward_max": {"policy_0": -45.95436082386643}, "policy_reward_mean": {"policy_0": -711.2811632974461}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-509.3489403043565, -717.8665196705225, -559.658563926156, -45.95436082386643, -457.2207881067693, -865.2633887864702, -984.5535022651416, -687.5159277094398, -730.6652224677277, -1193.081861832415, -615.780285262025, -723.3822303672217, -499.52760460489174, -1443.4627104637273, -457.91978468111455, -833.2581238918428, -930.1030625870485, -1056.9716860681037, -985.7578941984622, -980.1173360061866, -381.31662389534694, -469.75077773838706, -1334.7887992533374, -69.99296541640257, -1217.3972769027582, -289.9721894724157, -399.7929537657501, -1083.8602466757225, -1173.6520447298067, -536.108154909854, -169.60186356455574, -917.6311671840624, -185.04692563076094, -309.4005912634213, -752.1424624398145, -1100.1315338210454, -550.5007787537303, -569.2740519053586, -714.6674124189011, -945.5866062794298, -1081.9962649420856, -354.3686097757218, -1121.839902910417, -803.5094167393321, -674.1365502894151, -851.1235158515027, -293.2383940379087, -1367.9570199407035, -479.5151152001733, -228.6842327820896, -1029.9754467754312, -305.3413351763325, -181.36971125195188, -331.2524015906673, -1266.121829766908, -587.6678353620765, -232.14255942886928, -1093.7025241782962, -122.04460403627616, -845.5088853475968, -683.2936023569075, -765.0309457855972, -1061.1706573678978, -1252.7460859017913, -554.3371596276827, -1165.2726686254443, -890.7872276526488, -838.4653885416585, -650.4464699299479, -154.88672939468307, -291.0637175368184, -1004.3493274165261, -331.9195384914565, -95.77374660983456, -594.5272621462999, -853.9886511205101, -649.763783328289, -927.355299807877, -171.0406078273646, -603.3029433067665, -927.2265480531854, -878.7733755993219, -449.8811319321424, -1090.636563639418, -221.04390555540164, -760.2539318994798, -365.33446639307647, -802.7453610002588, -1184.7939315739645, -164.7263016931703, -1186.5940327867727, -351.5443723816167, -1194.392007006109, -840.2723778729938, -884.3332589684716, -760.1222290773964, -1122.2448018133405, -635.5230571738623, -1196.0144828494738, -872.6170042710553], "episode_lengths": [128, 150, 108, 51, 150, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 90, 125, 150, 54, 150, 125, 150, 150, 150, 150, 73, 150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 108, 78, 150, 78, 74, 142, 150, 150, 69, 150, 70, 150, 150, 135, 150, 150, 138, 150, 150, 150, 150, 110, 79, 150, 100, 52, 140, 150, 136, 150, 71, 150, 150, 150, 150, 150, 100, 150, 96, 150, 150, 79, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-509.3489403043565, -717.8665196705225, -559.658563926156, -45.95436082386643, -457.2207881067693, -865.2633887864702, -984.5535022651416, -687.5159277094398, -730.6652224677277, -1193.081861832415, -615.780285262025, -723.3822303672217, -499.52760460489174, -1443.4627104637273, -457.91978468111455, -833.2581238918428, -930.1030625870485, -1056.9716860681037, -985.7578941984622, -980.1173360061866, -381.31662389534694, -469.75077773838706, -1334.7887992533374, -69.99296541640257, -1217.3972769027582, -289.9721894724157, -399.7929537657501, -1083.8602466757225, -1173.6520447298067, -536.108154909854, -169.60186356455574, -917.6311671840624, -185.04692563076094, -309.4005912634213, -752.1424624398145, -1100.1315338210454, -550.5007787537303, -569.2740519053586, -714.6674124189011, -945.5866062794298, -1081.9962649420856, -354.3686097757218, -1121.839902910417, -803.5094167393321, -674.1365502894151, -851.1235158515027, -293.2383940379087, -1367.9570199407035, -479.5151152001733, -228.6842327820896, -1029.9754467754312, -305.3413351763325, -181.36971125195188, -331.2524015906673, -1266.121829766908, -587.6678353620765, -232.14255942886928, -1093.7025241782962, -122.04460403627616, -845.5088853475968, -683.2936023569075, -765.0309457855972, -1061.1706573678978, -1252.7460859017913, -554.3371596276827, -1165.2726686254443, -890.7872276526488, -838.4653885416585, -650.4464699299479, -154.88672939468307, -291.0637175368184, -1004.3493274165261, -331.9195384914565, -95.77374660983456, -594.5272621462999, -853.9886511205101, -649.763783328289, -927.355299807877, -171.0406078273646, -603.3029433067665, -927.2265480531854, -878.7733755993219, -449.8811319321424, -1090.636563639418, -221.04390555540164, -760.2539318994798, -365.33446639307647, -802.7453610002588, -1184.7939315739645, -164.7263016931703, -1186.5940327867727, -351.5443723816167, -1194.392007006109, -840.2723778729938, -884.3332589684716, -760.1222290773964, -1122.2448018133405, -635.5230571738623, -1196.0144828494738, -872.6170042710553]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5529564630342478, "mean_inference_ms": 1.673699700639185, "mean_action_processing_ms": 0.2780504894363164, "mean_env_wait_ms": 3.5081115135227816, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011659860610961914, "StateBufferConnector_ms": 0.008031845092773438, "ViewRequirementAgentConnector_ms": 0.1922461986541748}, "num_episodes": 28, "episode_return_max": -45.95436082386643, "episode_return_min": -1443.4627104637273, "episode_return_mean": -711.2811632974461, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 317.69464629776036, "num_env_steps_trained_throughput_per_sec": 317.69464629776036, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12504.945, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12504.873, "sample_time_ms": 1146.649, "learn_time_ms": 11287.341, "learn_throughput": 354.379, "synch_weights_time_ms": 69.998}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00002", "date": "2024-08-04_05-42-05", "timestamp": 1722730325, "time_this_iter_s": 12.603780031204224, "time_total_s": 201.54925870895386, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f671c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 201.54925870895386, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.016666666666666, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 252.02271200021107, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.30737230454882, "policy_loss": -0.0025774943433740797, "vf_loss": 2.3221790766964356, "vf_explained_var": 0.9884555216257771, "kl": 0.015174675990435104, "entropy": 1.6781675862769285, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -64.521036296512, "episode_reward_min": -1367.9570199407035, "episode_reward_mean": -710.4219027988161, "episode_len_mean": 134.79, "episode_media": {}, "episodes_timesteps_total": 13479, "policy_reward_min": {"policy_0": -1367.9570199407035}, "policy_reward_max": {"policy_0": -64.521036296512}, "policy_reward_mean": {"policy_0": -710.4219027988161}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-917.6311671840624, -185.04692563076094, -309.4005912634213, -752.1424624398145, -1100.1315338210454, -550.5007787537303, -569.2740519053586, -714.6674124189011, -945.5866062794298, -1081.9962649420856, -354.3686097757218, -1121.839902910417, -803.5094167393321, -674.1365502894151, -851.1235158515027, -293.2383940379087, -1367.9570199407035, -479.5151152001733, -228.6842327820896, -1029.9754467754312, -305.3413351763325, -181.36971125195188, -331.2524015906673, -1266.121829766908, -587.6678353620765, -232.14255942886928, -1093.7025241782962, -122.04460403627616, -845.5088853475968, -683.2936023569075, -765.0309457855972, -1061.1706573678978, -1252.7460859017913, -554.3371596276827, -1165.2726686254443, -890.7872276526488, -838.4653885416585, -650.4464699299479, -154.88672939468307, -291.0637175368184, -1004.3493274165261, -331.9195384914565, -95.77374660983456, -594.5272621462999, -853.9886511205101, -649.763783328289, -927.355299807877, -171.0406078273646, -603.3029433067665, -927.2265480531854, -878.7733755993219, -449.8811319321424, -1090.636563639418, -221.04390555540164, -760.2539318994798, -365.33446639307647, -802.7453610002588, -1184.7939315739645, -164.7263016931703, -1186.5940327867727, -351.5443723816167, -1194.392007006109, -840.2723778729938, -884.3332589684716, -760.1222290773964, -1122.2448018133405, -635.5230571738623, -1196.0144828494738, -872.6170042710553, -1099.1964800463495, -424.82031511653446, -1190.9045709043758, -120.30862444079574, -1245.2796163366352, -1171.9991022184279, -605.0767447651336, -1163.0183724681906, -566.8310733114242, -808.1940830709526, -1162.32404718315, -342.81203444407873, -420.91276860665886, -469.37015900581235, -803.2665006781526, -533.2659529991109, -1181.023061293374, -148.43934985254268, -560.5445088129901, -137.40180521133232, -844.8639301816395, -1279.9991544831896, -526.7422300444867, -421.4368174794258, -755.4859174518681, -861.5438703121551, -845.8676774797085, -1056.114161852268, -650.6594003993604, -855.4942737381695, -64.521036296512], "episode_lengths": [150, 59, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 150, 150, 150, 150, 108, 78, 150, 78, 74, 142, 150, 150, 69, 150, 70, 150, 150, 135, 150, 150, 138, 150, 150, 150, 150, 110, 79, 150, 100, 52, 140, 150, 136, 150, 71, 150, 150, 150, 150, 150, 100, 150, 96, 150, 150, 79, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 77, 150, 88, 150, 150, 117, 112, 134, 150, 150, 150, 150, 150, 53], "policy_policy_0_reward": [-917.6311671840624, -185.04692563076094, -309.4005912634213, -752.1424624398145, -1100.1315338210454, -550.5007787537303, -569.2740519053586, -714.6674124189011, -945.5866062794298, -1081.9962649420856, -354.3686097757218, -1121.839902910417, -803.5094167393321, -674.1365502894151, -851.1235158515027, -293.2383940379087, -1367.9570199407035, -479.5151152001733, -228.6842327820896, -1029.9754467754312, -305.3413351763325, -181.36971125195188, -331.2524015906673, -1266.121829766908, -587.6678353620765, -232.14255942886928, -1093.7025241782962, -122.04460403627616, -845.5088853475968, -683.2936023569075, -765.0309457855972, -1061.1706573678978, -1252.7460859017913, -554.3371596276827, -1165.2726686254443, -890.7872276526488, -838.4653885416585, -650.4464699299479, -154.88672939468307, -291.0637175368184, -1004.3493274165261, -331.9195384914565, -95.77374660983456, -594.5272621462999, -853.9886511205101, -649.763783328289, -927.355299807877, -171.0406078273646, -603.3029433067665, -927.2265480531854, -878.7733755993219, -449.8811319321424, -1090.636563639418, -221.04390555540164, -760.2539318994798, -365.33446639307647, -802.7453610002588, -1184.7939315739645, -164.7263016931703, -1186.5940327867727, -351.5443723816167, -1194.392007006109, -840.2723778729938, -884.3332589684716, -760.1222290773964, -1122.2448018133405, -635.5230571738623, -1196.0144828494738, -872.6170042710553, -1099.1964800463495, -424.82031511653446, -1190.9045709043758, -120.30862444079574, -1245.2796163366352, -1171.9991022184279, -605.0767447651336, -1163.0183724681906, -566.8310733114242, -808.1940830709526, -1162.32404718315, -342.81203444407873, -420.91276860665886, -469.37015900581235, -803.2665006781526, -533.2659529991109, -1181.023061293374, -148.43934985254268, -560.5445088129901, -137.40180521133232, -844.8639301816395, -1279.9991544831896, -526.7422300444867, -421.4368174794258, -755.4859174518681, -861.5438703121551, -845.8676774797085, -1056.114161852268, -650.6594003993604, -855.4942737381695, -64.521036296512]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537707774232101, "mean_inference_ms": 1.6738915636102476, "mean_action_processing_ms": 0.27817317375020806, "mean_env_wait_ms": 3.50910767341918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01186680793762207, "StateBufferConnector_ms": 0.008090019226074219, "ViewRequirementAgentConnector_ms": 0.2084057331085205}, "num_episodes": 31, "episode_return_max": -64.521036296512, "episode_return_min": -1367.9570199407035, "episode_return_mean": -710.4219027988161, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 470.8866571856233, "num_env_steps_trained_throughput_per_sec": 470.8866571856233, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12171.004, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12170.931, "sample_time_ms": 1162.648, "learn_time_ms": 10939.015, "learn_throughput": 365.664, "synch_weights_time_ms": 68.411}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00002", "date": "2024-08-04_05-42-13", "timestamp": 1722730333, "time_this_iter_s": 8.50653600692749, "time_total_s": 210.05579471588135, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16eeb2e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 210.05579471588135, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 22.366666666666664, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 253.66524810989696, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.3719965995599828, "policy_loss": -0.006955147598152204, "vf_loss": 2.393673211708665, "vf_explained_var": 0.9798528543983896, "kl": 0.012620231664914171, "entropy": 1.850753164291382, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -64.521036296512, "episode_reward_min": -1485.5314385336133, "episode_reward_mean": -747.3501820380137, "episode_len_mean": 136.06, "episode_media": {}, "episodes_timesteps_total": 13606, "policy_reward_min": {"policy_0": -1485.5314385336133}, "policy_reward_max": {"policy_0": -64.521036296512}, "policy_reward_mean": {"policy_0": -747.3501820380137}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-845.5088853475968, -683.2936023569075, -765.0309457855972, -1061.1706573678978, -1252.7460859017913, -554.3371596276827, -1165.2726686254443, -890.7872276526488, -838.4653885416585, -650.4464699299479, -154.88672939468307, -291.0637175368184, -1004.3493274165261, -331.9195384914565, -95.77374660983456, -594.5272621462999, -853.9886511205101, -649.763783328289, -927.355299807877, -171.0406078273646, -603.3029433067665, -927.2265480531854, -878.7733755993219, -449.8811319321424, -1090.636563639418, -221.04390555540164, -760.2539318994798, -365.33446639307647, -802.7453610002588, -1184.7939315739645, -164.7263016931703, -1186.5940327867727, -351.5443723816167, -1194.392007006109, -840.2723778729938, -884.3332589684716, -760.1222290773964, -1122.2448018133405, -635.5230571738623, -1196.0144828494738, -872.6170042710553, -1099.1964800463495, -424.82031511653446, -1190.9045709043758, -120.30862444079574, -1245.2796163366352, -1171.9991022184279, -605.0767447651336, -1163.0183724681906, -566.8310733114242, -808.1940830709526, -1162.32404718315, -342.81203444407873, -420.91276860665886, -469.37015900581235, -803.2665006781526, -533.2659529991109, -1181.023061293374, -148.43934985254268, -560.5445088129901, -137.40180521133232, -844.8639301816395, -1279.9991544831896, -526.7422300444867, -421.4368174794258, -755.4859174518681, -861.5438703121551, -845.8676774797085, -1056.114161852268, -650.6594003993604, -855.4942737381695, -64.521036296512, -389.3092155064861, -130.31128181324974, -1269.0905253830872, -1037.5646451284117, -242.31151283815322, -1485.5314385336133, -546.9975681769935, -409.20551121712145, -269.24351994525375, -648.086299034813, -1100.8268953957393, -908.2805535280036, -1289.747263465989, -1295.914676510036, -966.4067754481413, -734.1828667433699, -170.9447886331536, -358.49163320903205, -515.7490379513531, -699.6718098261314, -237.92360086805476, -761.4903925738582, -1055.0233044818704, -1280.667123806393, -1246.4834606871866, -929.3294996866039, -1231.0822892395845, -933.3292340207876], "episode_lengths": [150, 150, 135, 150, 150, 138, 150, 150, 150, 150, 110, 79, 150, 100, 52, 140, 150, 136, 150, 71, 150, 150, 150, 150, 150, 100, 150, 96, 150, 150, 79, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 77, 150, 88, 150, 150, 117, 112, 134, 150, 150, 150, 150, 150, 53, 150, 83, 150, 150, 81, 150, 118, 150, 104, 119, 150, 150, 150, 150, 150, 150, 61, 117, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-845.5088853475968, -683.2936023569075, -765.0309457855972, -1061.1706573678978, -1252.7460859017913, -554.3371596276827, -1165.2726686254443, -890.7872276526488, -838.4653885416585, -650.4464699299479, -154.88672939468307, -291.0637175368184, -1004.3493274165261, -331.9195384914565, -95.77374660983456, -594.5272621462999, -853.9886511205101, -649.763783328289, -927.355299807877, -171.0406078273646, -603.3029433067665, -927.2265480531854, -878.7733755993219, -449.8811319321424, -1090.636563639418, -221.04390555540164, -760.2539318994798, -365.33446639307647, -802.7453610002588, -1184.7939315739645, -164.7263016931703, -1186.5940327867727, -351.5443723816167, -1194.392007006109, -840.2723778729938, -884.3332589684716, -760.1222290773964, -1122.2448018133405, -635.5230571738623, -1196.0144828494738, -872.6170042710553, -1099.1964800463495, -424.82031511653446, -1190.9045709043758, -120.30862444079574, -1245.2796163366352, -1171.9991022184279, -605.0767447651336, -1163.0183724681906, -566.8310733114242, -808.1940830709526, -1162.32404718315, -342.81203444407873, -420.91276860665886, -469.37015900581235, -803.2665006781526, -533.2659529991109, -1181.023061293374, -148.43934985254268, -560.5445088129901, -137.40180521133232, -844.8639301816395, -1279.9991544831896, -526.7422300444867, -421.4368174794258, -755.4859174518681, -861.5438703121551, -845.8676774797085, -1056.114161852268, -650.6594003993604, -855.4942737381695, -64.521036296512, -389.3092155064861, -130.31128181324974, -1269.0905253830872, -1037.5646451284117, -242.31151283815322, -1485.5314385336133, -546.9975681769935, -409.20551121712145, -269.24351994525375, -648.086299034813, -1100.8268953957393, -908.2805535280036, -1289.747263465989, -1295.914676510036, -966.4067754481413, -734.1828667433699, -170.9447886331536, -358.49163320903205, -515.7490379513531, -699.6718098261314, -237.92360086805476, -761.4903925738582, -1055.0233044818704, -1280.667123806393, -1246.4834606871866, -929.3294996866039, -1231.0822892395845, -933.3292340207876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541314197262563, "mean_inference_ms": 1.6752493052613056, "mean_action_processing_ms": 0.2780735934969382, "mean_env_wait_ms": 3.5136759254206713, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011977434158325195, "StateBufferConnector_ms": 0.008174896240234375, "ViewRequirementAgentConnector_ms": 0.20856666564941406}, "num_episodes": 28, "episode_return_max": -64.521036296512, "episode_return_min": -1485.5314385336133, "episode_return_mean": -747.3501820380137, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.20165812533156, "num_env_steps_trained_throughput_per_sec": 306.20165812533156, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12232.012, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12231.939, "sample_time_ms": 1159.408, "learn_time_ms": 11005.829, "learn_throughput": 363.444, "synch_weights_time_ms": 65.857}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00002", "date": "2024-08-04_05-42-26", "timestamp": 1722730346, "time_this_iter_s": 13.076346635818481, "time_total_s": 223.13214135169983, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0acdc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 223.13214135169983, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.763157894736842, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 188.47267655332882, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.8280282627791165, "policy_loss": -0.010390417514524112, "vf_loss": 2.8500290837138893, "vf_explained_var": 0.9823788666476806, "kl": 0.01462693625941635, "entropy": 1.5998475857079029, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": 0.5813101227228545, "episode_reward_min": -1485.5314385336133, "episode_reward_mean": -702.0640935852985, "episode_len_mean": 129.99, "episode_media": {}, "episodes_timesteps_total": 12999, "policy_reward_min": {"policy_0": -1485.5314385336133}, "policy_reward_max": {"policy_0": 0.5813101227228545}, "policy_reward_mean": {"policy_0": -702.0640935852985}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1122.2448018133405, -635.5230571738623, -1196.0144828494738, -872.6170042710553, -1099.1964800463495, -424.82031511653446, -1190.9045709043758, -120.30862444079574, -1245.2796163366352, -1171.9991022184279, -605.0767447651336, -1163.0183724681906, -566.8310733114242, -808.1940830709526, -1162.32404718315, -342.81203444407873, -420.91276860665886, -469.37015900581235, -803.2665006781526, -533.2659529991109, -1181.023061293374, -148.43934985254268, -560.5445088129901, -137.40180521133232, -844.8639301816395, -1279.9991544831896, -526.7422300444867, -421.4368174794258, -755.4859174518681, -861.5438703121551, -845.8676774797085, -1056.114161852268, -650.6594003993604, -855.4942737381695, -64.521036296512, -389.3092155064861, -130.31128181324974, -1269.0905253830872, -1037.5646451284117, -242.31151283815322, -1485.5314385336133, -546.9975681769935, -409.20551121712145, -269.24351994525375, -648.086299034813, -1100.8268953957393, -908.2805535280036, -1289.747263465989, -1295.914676510036, -966.4067754481413, -734.1828667433699, -170.9447886331536, -358.49163320903205, -515.7490379513531, -699.6718098261314, -237.92360086805476, -761.4903925738582, -1055.0233044818704, -1280.667123806393, -1246.4834606871866, -929.3294996866039, -1231.0822892395845, -933.3292340207876, -1178.5421638959815, -155.03514028301186, 0.5813101227228545, -109.98096635950546, -696.3149335993404, -80.82331369864066, -1199.6931959336791, -804.9090887602185, -134.90971044695172, -714.3031548322333, -927.9659801820693, -332.142521163297, -44.18291562568155, -1230.716226739449, -219.04305524107338, -927.7961280216585, -250.88348853053066, -964.5793232428256, -1330.9886953532098, -251.3048810686106, -755.0148737404231, -993.9350730571335, -984.8812762574255, -201.26793913576688, -1122.8947875578933, -59.78179232652736, -973.4741870586136, -167.45340098339346, -893.3529204408485, -292.8101553599048, -760.7946220412817, -21.183972958343432, -166.779892545868, -1051.8047499489373, -1012.8230561829967, -432.36486511099247, -474.9445107232406], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 77, 150, 88, 150, 150, 117, 112, 134, 150, 150, 150, 150, 150, 53, 150, 83, 150, 150, 81, 150, 118, 150, 104, 119, 150, 150, 150, 150, 150, 150, 61, 117, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 75, 33, 80, 150, 45, 150, 150, 85, 150, 150, 136, 58, 150, 77, 150, 79, 150, 150, 115, 150, 150, 150, 98, 150, 61, 150, 79, 150, 118, 150, 42, 107, 150, 150, 124, 100], "policy_policy_0_reward": [-1122.2448018133405, -635.5230571738623, -1196.0144828494738, -872.6170042710553, -1099.1964800463495, -424.82031511653446, -1190.9045709043758, -120.30862444079574, -1245.2796163366352, -1171.9991022184279, -605.0767447651336, -1163.0183724681906, -566.8310733114242, -808.1940830709526, -1162.32404718315, -342.81203444407873, -420.91276860665886, -469.37015900581235, -803.2665006781526, -533.2659529991109, -1181.023061293374, -148.43934985254268, -560.5445088129901, -137.40180521133232, -844.8639301816395, -1279.9991544831896, -526.7422300444867, -421.4368174794258, -755.4859174518681, -861.5438703121551, -845.8676774797085, -1056.114161852268, -650.6594003993604, -855.4942737381695, -64.521036296512, -389.3092155064861, -130.31128181324974, -1269.0905253830872, -1037.5646451284117, -242.31151283815322, -1485.5314385336133, -546.9975681769935, -409.20551121712145, -269.24351994525375, -648.086299034813, -1100.8268953957393, -908.2805535280036, -1289.747263465989, -1295.914676510036, -966.4067754481413, -734.1828667433699, -170.9447886331536, -358.49163320903205, -515.7490379513531, -699.6718098261314, -237.92360086805476, -761.4903925738582, -1055.0233044818704, -1280.667123806393, -1246.4834606871866, -929.3294996866039, -1231.0822892395845, -933.3292340207876, -1178.5421638959815, -155.03514028301186, 0.5813101227228545, -109.98096635950546, -696.3149335993404, -80.82331369864066, -1199.6931959336791, -804.9090887602185, -134.90971044695172, -714.3031548322333, -927.9659801820693, -332.142521163297, -44.18291562568155, -1230.716226739449, -219.04305524107338, -927.7961280216585, -250.88348853053066, -964.5793232428256, -1330.9886953532098, -251.3048810686106, -755.0148737404231, -993.9350730571335, -984.8812762574255, -201.26793913576688, -1122.8947875578933, -59.78179232652736, -973.4741870586136, -167.45340098339346, -893.3529204408485, -292.8101553599048, -760.7946220412817, -21.183972958343432, -166.779892545868, -1051.8047499489373, -1012.8230561829967, -432.36486511099247, -474.9445107232406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543040370717451, "mean_inference_ms": 1.674776239789267, "mean_action_processing_ms": 0.27786293318612293, "mean_env_wait_ms": 3.517490040828004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01249837875366211, "StateBufferConnector_ms": 0.008109092712402344, "ViewRequirementAgentConnector_ms": 0.20766901969909668}, "num_episodes": 37, "episode_return_max": 0.5813101227228545, "episode_return_min": -1485.5314385336133, "episode_return_mean": -702.0640935852985, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.4691357598121, "num_env_steps_trained_throughput_per_sec": 353.4691357598121, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12035.071, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12034.999, "sample_time_ms": 1164.067, "learn_time_ms": 10803.523, "learn_throughput": 370.25, "synch_weights_time_ms": 66.56}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00002", "date": "2024-08-04_05-42-38", "timestamp": 1722730358, "time_this_iter_s": 11.328315258026123, "time_total_s": 234.46045660972595, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5caf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 234.46045660972595, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 19.08125, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 210.58501518964766, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.2715854343026876, "policy_loss": -0.009263123220201426, "vf_loss": 2.294376163184643, "vf_explained_var": 0.9829441001017888, "kl": 0.012017322239664001, "entropy": 1.713279709095756, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 0.5813101227228545, "episode_reward_min": -1485.5314385336133, "episode_reward_mean": -626.7369113288423, "episode_len_mean": 122.9, "episode_media": {}, "episodes_timesteps_total": 12290, "policy_reward_min": {"policy_0": -1485.5314385336133}, "policy_reward_max": {"policy_0": 0.5813101227228545}, "policy_reward_mean": {"policy_0": -626.7369113288423}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-64.521036296512, -389.3092155064861, -130.31128181324974, -1269.0905253830872, -1037.5646451284117, -242.31151283815322, -1485.5314385336133, -546.9975681769935, -409.20551121712145, -269.24351994525375, -648.086299034813, -1100.8268953957393, -908.2805535280036, -1289.747263465989, -1295.914676510036, -966.4067754481413, -734.1828667433699, -170.9447886331536, -358.49163320903205, -515.7490379513531, -699.6718098261314, -237.92360086805476, -761.4903925738582, -1055.0233044818704, -1280.667123806393, -1246.4834606871866, -929.3294996866039, -1231.0822892395845, -933.3292340207876, -1178.5421638959815, -155.03514028301186, 0.5813101227228545, -109.98096635950546, -696.3149335993404, -80.82331369864066, -1199.6931959336791, -804.9090887602185, -134.90971044695172, -714.3031548322333, -927.9659801820693, -332.142521163297, -44.18291562568155, -1230.716226739449, -219.04305524107338, -927.7961280216585, -250.88348853053066, -964.5793232428256, -1330.9886953532098, -251.3048810686106, -755.0148737404231, -993.9350730571335, -984.8812762574255, -201.26793913576688, -1122.8947875578933, -59.78179232652736, -973.4741870586136, -167.45340098339346, -893.3529204408485, -292.8101553599048, -760.7946220412817, -21.183972958343432, -166.779892545868, -1051.8047499489373, -1012.8230561829967, -432.36486511099247, -474.9445107232406, -881.566361421877, -315.8963580679178, -165.32497422676875, -76.84306540403385, -177.7622756101209, -186.73821271353827, -1333.7783188648866, -611.0501581536525, -236.24373454193523, -743.785413993779, -1032.8556241416052, -163.34642880420657, -12.329995285759946, -220.5296518343358, -217.13184601405527, -32.61333473408666, -902.2219136838967, -915.6104303996909, -534.1809038549839, -81.26043567184963, -1105.4361481994229, -1354.9648380787926, -592.0324403930114, -503.3407432399456, -575.7999106847824, -885.1817131625703, -140.64068319502167, -656.9534857774473, -937.6545175876532, -643.6821645452048, -393.95353266335826, -825.0268352483567, -606.9427218838988, -484.19855256796797], "episode_lengths": [53, 150, 83, 150, 150, 81, 150, 118, 150, 104, 119, 150, 150, 150, 150, 150, 150, 61, 117, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 75, 33, 80, 150, 45, 150, 150, 85, 150, 150, 136, 58, 150, 77, 150, 79, 150, 150, 115, 150, 150, 150, 98, 150, 61, 150, 79, 150, 118, 150, 42, 107, 150, 150, 124, 100, 150, 99, 73, 63, 61, 88, 150, 150, 130, 150, 150, 58, 41, 98, 94, 47, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 66, 116, 150, 150, 150, 150, 150, 133], "policy_policy_0_reward": [-64.521036296512, -389.3092155064861, -130.31128181324974, -1269.0905253830872, -1037.5646451284117, -242.31151283815322, -1485.5314385336133, -546.9975681769935, -409.20551121712145, -269.24351994525375, -648.086299034813, -1100.8268953957393, -908.2805535280036, -1289.747263465989, -1295.914676510036, -966.4067754481413, -734.1828667433699, -170.9447886331536, -358.49163320903205, -515.7490379513531, -699.6718098261314, -237.92360086805476, -761.4903925738582, -1055.0233044818704, -1280.667123806393, -1246.4834606871866, -929.3294996866039, -1231.0822892395845, -933.3292340207876, -1178.5421638959815, -155.03514028301186, 0.5813101227228545, -109.98096635950546, -696.3149335993404, -80.82331369864066, -1199.6931959336791, -804.9090887602185, -134.90971044695172, -714.3031548322333, -927.9659801820693, -332.142521163297, -44.18291562568155, -1230.716226739449, -219.04305524107338, -927.7961280216585, -250.88348853053066, -964.5793232428256, -1330.9886953532098, -251.3048810686106, -755.0148737404231, -993.9350730571335, -984.8812762574255, -201.26793913576688, -1122.8947875578933, -59.78179232652736, -973.4741870586136, -167.45340098339346, -893.3529204408485, -292.8101553599048, -760.7946220412817, -21.183972958343432, -166.779892545868, -1051.8047499489373, -1012.8230561829967, -432.36486511099247, -474.9445107232406, -881.566361421877, -315.8963580679178, -165.32497422676875, -76.84306540403385, -177.7622756101209, -186.73821271353827, -1333.7783188648866, -611.0501581536525, -236.24373454193523, -743.785413993779, -1032.8556241416052, -163.34642880420657, -12.329995285759946, -220.5296518343358, -217.13184601405527, -32.61333473408666, -902.2219136838967, -915.6104303996909, -534.1809038549839, -81.26043567184963, -1105.4361481994229, -1354.9648380787926, -592.0324403930114, -503.3407432399456, -575.7999106847824, -885.1817131625703, -140.64068319502167, -656.9534857774473, -937.6545175876532, -643.6821645452048, -393.95353266335826, -825.0268352483567, -606.9427218838988, -484.19855256796797]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549023755855478, "mean_inference_ms": 1.6762160129207266, "mean_action_processing_ms": 0.27768286564839084, "mean_env_wait_ms": 3.5243677372818394, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012218713760375977, "StateBufferConnector_ms": 0.007993698120117188, "ViewRequirementAgentConnector_ms": 0.20833659172058105}, "num_episodes": 34, "episode_return_max": 0.5813101227228545, "episode_return_min": -1485.5314385336133, "episode_return_mean": -626.7369113288423, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 375.7964740991937, "num_env_steps_trained_throughput_per_sec": 375.7964740991937, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12178.077, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12178.005, "sample_time_ms": 1170.156, "learn_time_ms": 10938.971, "learn_throughput": 365.665, "synch_weights_time_ms": 68.065}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00002", "date": "2024-08-04_05-42-48", "timestamp": 1722730368, "time_this_iter_s": 10.657881259918213, "time_total_s": 245.11833786964417, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5fbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 245.11833786964417, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 19.819999999999997, "ram_util_percent": 27.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 250.70176840225855, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.2283019740134478, "policy_loss": -0.008039332880192282, "vf_loss": 2.2506352096796034, "vf_explained_var": 0.9871874223152797, "kl": 0.013928529949680543, "entropy": 1.8472467198967935, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -12.329995285759946, "episode_reward_min": -1432.5670863829878, "episode_reward_mean": -566.4735483061277, "episode_len_mean": 117.14, "episode_media": {}, "episodes_timesteps_total": 11714, "policy_reward_min": {"policy_0": -1432.5670863829878}, "policy_reward_max": {"policy_0": -12.329995285759946}, "policy_reward_mean": {"policy_0": -566.4735483061277}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-109.98096635950546, -696.3149335993404, -80.82331369864066, -1199.6931959336791, -804.9090887602185, -134.90971044695172, -714.3031548322333, -927.9659801820693, -332.142521163297, -44.18291562568155, -1230.716226739449, -219.04305524107338, -927.7961280216585, -250.88348853053066, -964.5793232428256, -1330.9886953532098, -251.3048810686106, -755.0148737404231, -993.9350730571335, -984.8812762574255, -201.26793913576688, -1122.8947875578933, -59.78179232652736, -973.4741870586136, -167.45340098339346, -893.3529204408485, -292.8101553599048, -760.7946220412817, -21.183972958343432, -166.779892545868, -1051.8047499489373, -1012.8230561829967, -432.36486511099247, -474.9445107232406, -881.566361421877, -315.8963580679178, -165.32497422676875, -76.84306540403385, -177.7622756101209, -186.73821271353827, -1333.7783188648866, -611.0501581536525, -236.24373454193523, -743.785413993779, -1032.8556241416052, -163.34642880420657, -12.329995285759946, -220.5296518343358, -217.13184601405527, -32.61333473408666, -902.2219136838967, -915.6104303996909, -534.1809038549839, -81.26043567184963, -1105.4361481994229, -1354.9648380787926, -592.0324403930114, -503.3407432399456, -575.7999106847824, -885.1817131625703, -140.64068319502167, -656.9534857774473, -937.6545175876532, -643.6821645452048, -393.95353266335826, -825.0268352483567, -606.9427218838988, -484.19855256796797, -168.1706123633159, -761.8169560913597, -913.0938378440721, -141.04389411599178, -401.73835639430087, -35.469854243938364, -44.20548731091258, -29.367418043677855, -296.54965463670123, -714.2126535179676, -945.5304200823908, -393.81763604759567, -15.380553246552397, -1256.7119524836685, -815.981557851678, -178.9064238180154, -1171.2479744283505, -85.599838995482, -332.7162394171361, -1432.5670863829878, -726.703791447962, -201.791062912342, -35.28542628980465, -255.81765944700885, -335.6401242240209, -95.3972473303558, -1340.0622074433315, -676.1036831119118, -1078.5869952769135, -91.9642988252729, -1186.1241771618447, -1356.7723709469287], "episode_lengths": [80, 150, 45, 150, 150, 85, 150, 150, 136, 58, 150, 77, 150, 79, 150, 150, 115, 150, 150, 150, 98, 150, 61, 150, 79, 150, 118, 150, 42, 107, 150, 150, 124, 100, 150, 99, 73, 63, 61, 88, 150, 150, 130, 150, 150, 58, 41, 98, 94, 47, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 66, 116, 150, 150, 150, 150, 150, 133, 78, 150, 150, 94, 109, 42, 52, 46, 127, 150, 150, 150, 38, 150, 150, 92, 150, 54, 124, 150, 150, 96, 51, 96, 90, 71, 150, 117, 150, 59, 150, 150], "policy_policy_0_reward": [-109.98096635950546, -696.3149335993404, -80.82331369864066, -1199.6931959336791, -804.9090887602185, -134.90971044695172, -714.3031548322333, -927.9659801820693, -332.142521163297, -44.18291562568155, -1230.716226739449, -219.04305524107338, -927.7961280216585, -250.88348853053066, -964.5793232428256, -1330.9886953532098, -251.3048810686106, -755.0148737404231, -993.9350730571335, -984.8812762574255, -201.26793913576688, -1122.8947875578933, -59.78179232652736, -973.4741870586136, -167.45340098339346, -893.3529204408485, -292.8101553599048, -760.7946220412817, -21.183972958343432, -166.779892545868, -1051.8047499489373, -1012.8230561829967, -432.36486511099247, -474.9445107232406, -881.566361421877, -315.8963580679178, -165.32497422676875, -76.84306540403385, -177.7622756101209, -186.73821271353827, -1333.7783188648866, -611.0501581536525, -236.24373454193523, -743.785413993779, -1032.8556241416052, -163.34642880420657, -12.329995285759946, -220.5296518343358, -217.13184601405527, -32.61333473408666, -902.2219136838967, -915.6104303996909, -534.1809038549839, -81.26043567184963, -1105.4361481994229, -1354.9648380787926, -592.0324403930114, -503.3407432399456, -575.7999106847824, -885.1817131625703, -140.64068319502167, -656.9534857774473, -937.6545175876532, -643.6821645452048, -393.95353266335826, -825.0268352483567, -606.9427218838988, -484.19855256796797, -168.1706123633159, -761.8169560913597, -913.0938378440721, -141.04389411599178, -401.73835639430087, -35.469854243938364, -44.20548731091258, -29.367418043677855, -296.54965463670123, -714.2126535179676, -945.5304200823908, -393.81763604759567, -15.380553246552397, -1256.7119524836685, -815.981557851678, -178.9064238180154, -1171.2479744283505, -85.599838995482, -332.7162394171361, -1432.5670863829878, -726.703791447962, -201.791062912342, -35.28542628980465, -255.81765944700885, -335.6401242240209, -95.3972473303558, -1340.0622074433315, -676.1036831119118, -1078.5869952769135, -91.9642988252729, -1186.1241771618447, -1356.7723709469287]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549341180637994, "mean_inference_ms": 1.675573644709578, "mean_action_processing_ms": 0.277656379220898, "mean_env_wait_ms": 3.5260300285268578, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012199163436889648, "StateBufferConnector_ms": 0.007869720458984375, "ViewRequirementAgentConnector_ms": 0.20667529106140137}, "num_episodes": 32, "episode_return_max": -12.329995285759946, "episode_return_min": -1432.5670863829878, "episode_return_mean": -566.4735483061277, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.4582570549618, "num_env_steps_trained_throughput_per_sec": 321.4582570549618, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12138.625, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12138.551, "sample_time_ms": 1171.223, "learn_time_ms": 10898.367, "learn_throughput": 367.027, "synch_weights_time_ms": 68.148}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00002", "date": "2024-08-04_05-43-01", "timestamp": 1722730381, "time_this_iter_s": 12.453681945800781, "time_total_s": 257.57201981544495, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f67eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 257.57201981544495, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.55294117647059, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 238.190050894022, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.121820358062784, "policy_loss": -0.013009617594555796, "vf_loss": 2.1488993133728704, "vf_explained_var": 0.9924581432094176, "kl": 0.017132633400615334, "entropy": 1.920912666246295, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -9.38688301794312, "episode_reward_min": -1476.4355881665967, "episode_reward_mean": -617.3224771335391, "episode_len_mean": 118.0, "episode_media": {}, "episodes_timesteps_total": 11800, "policy_reward_min": {"policy_0": -1476.4355881665967}, "policy_reward_max": {"policy_0": -9.38688301794312}, "policy_reward_mean": {"policy_0": -617.3224771335391}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-76.84306540403385, -177.7622756101209, -186.73821271353827, -1333.7783188648866, -611.0501581536525, -236.24373454193523, -743.785413993779, -1032.8556241416052, -163.34642880420657, -12.329995285759946, -220.5296518343358, -217.13184601405527, -32.61333473408666, -902.2219136838967, -915.6104303996909, -534.1809038549839, -81.26043567184963, -1105.4361481994229, -1354.9648380787926, -592.0324403930114, -503.3407432399456, -575.7999106847824, -885.1817131625703, -140.64068319502167, -656.9534857774473, -937.6545175876532, -643.6821645452048, -393.95353266335826, -825.0268352483567, -606.9427218838988, -484.19855256796797, -168.1706123633159, -761.8169560913597, -913.0938378440721, -141.04389411599178, -401.73835639430087, -35.469854243938364, -44.20548731091258, -29.367418043677855, -296.54965463670123, -714.2126535179676, -945.5304200823908, -393.81763604759567, -15.380553246552397, -1256.7119524836685, -815.981557851678, -178.9064238180154, -1171.2479744283505, -85.599838995482, -332.7162394171361, -1432.5670863829878, -726.703791447962, -201.791062912342, -35.28542628980465, -255.81765944700885, -335.6401242240209, -95.3972473303558, -1340.0622074433315, -676.1036831119118, -1078.5869952769135, -91.9642988252729, -1186.1241771618447, -1356.7723709469287, -890.384210040992, -679.4341888365968, -470.76617062522575, -165.51025086212522, -1453.8694700971043, -1047.0075998869518, -131.48599618257768, -1115.821452360915, -1320.2847490571974, -840.135451020386, -90.18567016538965, -1024.317822371319, -667.1733317342806, -341.75236629130393, -170.45012536200548, -1331.9231014323584, -135.14280840897058, -989.7530312145374, -381.6438340226572, -1060.8338572699295, -659.4101591276637, -1048.6469610590623, -436.91927773645625, -1405.8968432766555, -974.3535044680543, -1342.9860296222855, -9.38688301794312, -395.8681333982576, -1155.1223134374688, -978.9102759352754, -1118.3142553611594, -48.4181042029766, -85.30364314695221, -1206.7368701203088, -223.33844395922165, -159.85745740711985, -1476.4355881665967], "episode_lengths": [63, 61, 88, 150, 150, 130, 150, 150, 58, 41, 98, 94, 47, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 66, 116, 150, 150, 150, 150, 150, 133, 78, 150, 150, 94, 109, 42, 52, 46, 127, 150, 150, 150, 38, 150, 150, 92, 150, 54, 124, 150, 150, 96, 51, 96, 90, 71, 150, 117, 150, 59, 150, 150, 150, 150, 111, 82, 150, 150, 55, 150, 150, 150, 66, 150, 150, 111, 58, 150, 62, 150, 103, 150, 150, 150, 95, 150, 150, 150, 35, 150, 150, 150, 150, 54, 66, 150, 103, 61, 150], "policy_policy_0_reward": [-76.84306540403385, -177.7622756101209, -186.73821271353827, -1333.7783188648866, -611.0501581536525, -236.24373454193523, -743.785413993779, -1032.8556241416052, -163.34642880420657, -12.329995285759946, -220.5296518343358, -217.13184601405527, -32.61333473408666, -902.2219136838967, -915.6104303996909, -534.1809038549839, -81.26043567184963, -1105.4361481994229, -1354.9648380787926, -592.0324403930114, -503.3407432399456, -575.7999106847824, -885.1817131625703, -140.64068319502167, -656.9534857774473, -937.6545175876532, -643.6821645452048, -393.95353266335826, -825.0268352483567, -606.9427218838988, -484.19855256796797, -168.1706123633159, -761.8169560913597, -913.0938378440721, -141.04389411599178, -401.73835639430087, -35.469854243938364, -44.20548731091258, -29.367418043677855, -296.54965463670123, -714.2126535179676, -945.5304200823908, -393.81763604759567, -15.380553246552397, -1256.7119524836685, -815.981557851678, -178.9064238180154, -1171.2479744283505, -85.599838995482, -332.7162394171361, -1432.5670863829878, -726.703791447962, -201.791062912342, -35.28542628980465, -255.81765944700885, -335.6401242240209, -95.3972473303558, -1340.0622074433315, -676.1036831119118, -1078.5869952769135, -91.9642988252729, -1186.1241771618447, -1356.7723709469287, -890.384210040992, -679.4341888365968, -470.76617062522575, -165.51025086212522, -1453.8694700971043, -1047.0075998869518, -131.48599618257768, -1115.821452360915, -1320.2847490571974, -840.135451020386, -90.18567016538965, -1024.317822371319, -667.1733317342806, -341.75236629130393, -170.45012536200548, -1331.9231014323584, -135.14280840897058, -989.7530312145374, -381.6438340226572, -1060.8338572699295, -659.4101591276637, -1048.6469610590623, -436.91927773645625, -1405.8968432766555, -974.3535044680543, -1342.9860296222855, -9.38688301794312, -395.8681333982576, -1155.1223134374688, -978.9102759352754, -1118.3142553611594, -48.4181042029766, -85.30364314695221, -1206.7368701203088, -223.33844395922165, -159.85745740711985, -1476.4355881665967]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550352140028801, "mean_inference_ms": 1.674723193593578, "mean_action_processing_ms": 0.27710142908285945, "mean_env_wait_ms": 3.5266993702519205, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011685609817504883, "StateBufferConnector_ms": 0.0077893733978271484, "ViewRequirementAgentConnector_ms": 0.19570064544677734}, "num_episodes": 37, "episode_return_max": -9.38688301794312, "episode_return_min": -1476.4355881665967, "episode_return_mean": -617.3224771335391, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.0476118804172, "num_env_steps_trained_throughput_per_sec": 307.0476118804172, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12118.642, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12118.568, "sample_time_ms": 1168.608, "learn_time_ms": 10882.188, "learn_throughput": 367.573, "synch_weights_time_ms": 66.977}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00002", "date": "2024-08-04_05-43-14", "timestamp": 1722730394, "time_this_iter_s": 13.041772842407227, "time_total_s": 270.6137926578522, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f67490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 270.6137926578522, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.773684210526316, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 195.9603478829066, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.2770377945154907, "policy_loss": -0.013928168928638721, "vf_loss": 2.3028344895690678, "vf_explained_var": 0.9781697132314245, "kl": 0.016464064440939816, "entropy": 1.6807740268607934, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -9.38688301794312, "episode_reward_min": -1476.4355881665967, "episode_reward_mean": -637.5822284034134, "episode_len_mean": 118.91, "episode_media": {}, "episodes_timesteps_total": 11891, "policy_reward_min": {"policy_0": -1476.4355881665967}, "policy_reward_max": {"policy_0": -9.38688301794312}, "policy_reward_mean": {"policy_0": -637.5822284034134}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-168.1706123633159, -761.8169560913597, -913.0938378440721, -141.04389411599178, -401.73835639430087, -35.469854243938364, -44.20548731091258, -29.367418043677855, -296.54965463670123, -714.2126535179676, -945.5304200823908, -393.81763604759567, -15.380553246552397, -1256.7119524836685, -815.981557851678, -178.9064238180154, -1171.2479744283505, -85.599838995482, -332.7162394171361, -1432.5670863829878, -726.703791447962, -201.791062912342, -35.28542628980465, -255.81765944700885, -335.6401242240209, -95.3972473303558, -1340.0622074433315, -676.1036831119118, -1078.5869952769135, -91.9642988252729, -1186.1241771618447, -1356.7723709469287, -890.384210040992, -679.4341888365968, -470.76617062522575, -165.51025086212522, -1453.8694700971043, -1047.0075998869518, -131.48599618257768, -1115.821452360915, -1320.2847490571974, -840.135451020386, -90.18567016538965, -1024.317822371319, -667.1733317342806, -341.75236629130393, -170.45012536200548, -1331.9231014323584, -135.14280840897058, -989.7530312145374, -381.6438340226572, -1060.8338572699295, -659.4101591276637, -1048.6469610590623, -436.91927773645625, -1405.8968432766555, -974.3535044680543, -1342.9860296222855, -9.38688301794312, -395.8681333982576, -1155.1223134374688, -978.9102759352754, -1118.3142553611594, -48.4181042029766, -85.30364314695221, -1206.7368701203088, -223.33844395922165, -159.85745740711985, -1476.4355881665967, -110.39880047873137, -454.8173764732723, -706.4477463398223, -477.9053563537807, -592.7739036475675, -65.7568369833536, -517.8668278655429, -236.08855485077078, -712.3347711006445, -606.8233233573941, -855.4957374896202, -934.0054409156255, -485.2082856294358, -439.1473421881043, -1114.8921035829194, -1303.2163363539512, -1188.220788134102, -1156.9550077521062, -1320.5184605012612, -521.9939621774148, -210.32094953626964, -1062.9497071357716, -1013.562812297801, -319.684457635978, -1317.7930952643665, -313.35240676304915, -329.88606116398466, -136.1501496081391, -96.88839589714826, -484.00710539384306, -124.6030550494904], "episode_lengths": [78, 150, 150, 94, 109, 42, 52, 46, 127, 150, 150, 150, 38, 150, 150, 92, 150, 54, 124, 150, 150, 96, 51, 96, 90, 71, 150, 117, 150, 59, 150, 150, 150, 150, 111, 82, 150, 150, 55, 150, 150, 150, 66, 150, 150, 111, 58, 150, 62, 150, 103, 150, 150, 150, 95, 150, 150, 150, 35, 150, 150, 150, 150, 54, 66, 150, 103, 61, 150, 81, 135, 129, 104, 150, 51, 130, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 122, 150, 121, 112, 66, 84, 104, 67], "policy_policy_0_reward": [-168.1706123633159, -761.8169560913597, -913.0938378440721, -141.04389411599178, -401.73835639430087, -35.469854243938364, -44.20548731091258, -29.367418043677855, -296.54965463670123, -714.2126535179676, -945.5304200823908, -393.81763604759567, -15.380553246552397, -1256.7119524836685, -815.981557851678, -178.9064238180154, -1171.2479744283505, -85.599838995482, -332.7162394171361, -1432.5670863829878, -726.703791447962, -201.791062912342, -35.28542628980465, -255.81765944700885, -335.6401242240209, -95.3972473303558, -1340.0622074433315, -676.1036831119118, -1078.5869952769135, -91.9642988252729, -1186.1241771618447, -1356.7723709469287, -890.384210040992, -679.4341888365968, -470.76617062522575, -165.51025086212522, -1453.8694700971043, -1047.0075998869518, -131.48599618257768, -1115.821452360915, -1320.2847490571974, -840.135451020386, -90.18567016538965, -1024.317822371319, -667.1733317342806, -341.75236629130393, -170.45012536200548, -1331.9231014323584, -135.14280840897058, -989.7530312145374, -381.6438340226572, -1060.8338572699295, -659.4101591276637, -1048.6469610590623, -436.91927773645625, -1405.8968432766555, -974.3535044680543, -1342.9860296222855, -9.38688301794312, -395.8681333982576, -1155.1223134374688, -978.9102759352754, -1118.3142553611594, -48.4181042029766, -85.30364314695221, -1206.7368701203088, -223.33844395922165, -159.85745740711985, -1476.4355881665967, -110.39880047873137, -454.8173764732723, -706.4477463398223, -477.9053563537807, -592.7739036475675, -65.7568369833536, -517.8668278655429, -236.08855485077078, -712.3347711006445, -606.8233233573941, -855.4957374896202, -934.0054409156255, -485.2082856294358, -439.1473421881043, -1114.8921035829194, -1303.2163363539512, -1188.220788134102, -1156.9550077521062, -1320.5184605012612, -521.9939621774148, -210.32094953626964, -1062.9497071357716, -1013.562812297801, -319.684457635978, -1317.7930952643665, -313.35240676304915, -329.88606116398466, -136.1501496081391, -96.88839589714826, -484.00710539384306, -124.6030550494904]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5546487406574068, "mean_inference_ms": 1.6735123950177309, "mean_action_processing_ms": 0.27676566271370534, "mean_env_wait_ms": 3.525019061174911, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011989831924438477, "StateBufferConnector_ms": 0.007863998413085938, "ViewRequirementAgentConnector_ms": 0.18855643272399902}, "num_episodes": 31, "episode_return_max": -9.38688301794312, "episode_return_min": -1476.4355881665967, "episode_return_mean": -637.5822284034134, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.96739927990603, "num_env_steps_trained_throughput_per_sec": 301.96739927990603, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12102.949, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12102.875, "sample_time_ms": 1165.193, "learn_time_ms": 10870.212, "learn_throughput": 367.978, "synch_weights_time_ms": 66.673}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00002", "date": "2024-08-04_05-43-27", "timestamp": 1722730407, "time_this_iter_s": 13.259278535842896, "time_total_s": 283.87307119369507, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5fbe0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.87307119369507, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.794736842105266, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 246.73050215244294, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.1747756070146957, "policy_loss": -0.009370223039877602, "vf_loss": 2.199360063361625, "vf_explained_var": 0.9821398670474688, "kl": 0.01236875111218678, "entropy": 1.8924855054666598, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -9.38688301794312, "episode_reward_min": -1525.0401926352586, "episode_reward_mean": -694.3155417043381, "episode_len_mean": 123.13, "episode_media": {}, "episodes_timesteps_total": 12313, "policy_reward_min": {"policy_0": -1525.0401926352586}, "policy_reward_max": {"policy_0": -9.38688301794312}, "policy_reward_mean": {"policy_0": -694.3155417043381}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1356.7723709469287, -890.384210040992, -679.4341888365968, -470.76617062522575, -165.51025086212522, -1453.8694700971043, -1047.0075998869518, -131.48599618257768, -1115.821452360915, -1320.2847490571974, -840.135451020386, -90.18567016538965, -1024.317822371319, -667.1733317342806, -341.75236629130393, -170.45012536200548, -1331.9231014323584, -135.14280840897058, -989.7530312145374, -381.6438340226572, -1060.8338572699295, -659.4101591276637, -1048.6469610590623, -436.91927773645625, -1405.8968432766555, -974.3535044680543, -1342.9860296222855, -9.38688301794312, -395.8681333982576, -1155.1223134374688, -978.9102759352754, -1118.3142553611594, -48.4181042029766, -85.30364314695221, -1206.7368701203088, -223.33844395922165, -159.85745740711985, -1476.4355881665967, -110.39880047873137, -454.8173764732723, -706.4477463398223, -477.9053563537807, -592.7739036475675, -65.7568369833536, -517.8668278655429, -236.08855485077078, -712.3347711006445, -606.8233233573941, -855.4957374896202, -934.0054409156255, -485.2082856294358, -439.1473421881043, -1114.8921035829194, -1303.2163363539512, -1188.220788134102, -1156.9550077521062, -1320.5184605012612, -521.9939621774148, -210.32094953626964, -1062.9497071357716, -1013.562812297801, -319.684457635978, -1317.7930952643665, -313.35240676304915, -329.88606116398466, -136.1501496081391, -96.88839589714826, -484.00710539384306, -124.6030550494904, -892.449103889714, -251.00413498927927, -819.9144531956878, -181.42487253862555, -188.4433332391431, -847.4886925234022, -1370.6873712990969, -1225.04388132671, -1276.8342944947299, -313.76946325048095, -756.6349786492871, -366.6508164513562, -1049.0434523098374, -419.52925889681495, -942.6459255301728, -970.1564426906582, -141.63778142965924, -172.14428048006397, -859.2827972829987, -1281.479407972125, -1087.9137907354445, -270.13213841932657, -1525.0401926352586, -712.4873718174323, -359.5582393476964, -32.111317273129735, -238.186979530555, -1104.6231564824864, -813.626652645867, -130.02657562872537, -1230.9652539235828], "episode_lengths": [150, 150, 150, 111, 82, 150, 150, 55, 150, 150, 150, 66, 150, 150, 111, 58, 150, 62, 150, 103, 150, 150, 150, 95, 150, 150, 150, 35, 150, 150, 150, 150, 54, 66, 150, 103, 61, 150, 81, 135, 129, 104, 150, 51, 130, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 122, 150, 121, 112, 66, 84, 104, 67, 150, 93, 150, 65, 61, 147, 150, 150, 150, 102, 150, 87, 150, 150, 150, 150, 76, 87, 150, 150, 150, 113, 150, 150, 105, 46, 68, 150, 134, 74, 150], "policy_policy_0_reward": [-1356.7723709469287, -890.384210040992, -679.4341888365968, -470.76617062522575, -165.51025086212522, -1453.8694700971043, -1047.0075998869518, -131.48599618257768, -1115.821452360915, -1320.2847490571974, -840.135451020386, -90.18567016538965, -1024.317822371319, -667.1733317342806, -341.75236629130393, -170.45012536200548, -1331.9231014323584, -135.14280840897058, -989.7530312145374, -381.6438340226572, -1060.8338572699295, -659.4101591276637, -1048.6469610590623, -436.91927773645625, -1405.8968432766555, -974.3535044680543, -1342.9860296222855, -9.38688301794312, -395.8681333982576, -1155.1223134374688, -978.9102759352754, -1118.3142553611594, -48.4181042029766, -85.30364314695221, -1206.7368701203088, -223.33844395922165, -159.85745740711985, -1476.4355881665967, -110.39880047873137, -454.8173764732723, -706.4477463398223, -477.9053563537807, -592.7739036475675, -65.7568369833536, -517.8668278655429, -236.08855485077078, -712.3347711006445, -606.8233233573941, -855.4957374896202, -934.0054409156255, -485.2082856294358, -439.1473421881043, -1114.8921035829194, -1303.2163363539512, -1188.220788134102, -1156.9550077521062, -1320.5184605012612, -521.9939621774148, -210.32094953626964, -1062.9497071357716, -1013.562812297801, -319.684457635978, -1317.7930952643665, -313.35240676304915, -329.88606116398466, -136.1501496081391, -96.88839589714826, -484.00710539384306, -124.6030550494904, -892.449103889714, -251.00413498927927, -819.9144531956878, -181.42487253862555, -188.4433332391431, -847.4886925234022, -1370.6873712990969, -1225.04388132671, -1276.8342944947299, -313.76946325048095, -756.6349786492871, -366.6508164513562, -1049.0434523098374, -419.52925889681495, -942.6459255301728, -970.1564426906582, -141.63778142965924, -172.14428048006397, -859.2827972829987, -1281.479407972125, -1087.9137907354445, -270.13213841932657, -1525.0401926352586, -712.4873718174323, -359.5582393476964, -32.111317273129735, -238.186979530555, -1104.6231564824864, -813.626652645867, -130.02657562872537, -1230.9652539235828]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5546885853969141, "mean_inference_ms": 1.6741624207179047, "mean_action_processing_ms": 0.2766939066599944, "mean_env_wait_ms": 3.5268449907762136, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012067317962646484, "StateBufferConnector_ms": 0.007952451705932617, "ViewRequirementAgentConnector_ms": 0.19165396690368652}, "num_episodes": 31, "episode_return_max": -9.38688301794312, "episode_return_min": -1525.0401926352586, "episode_return_mean": -694.3155417043381, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.42870479750263, "num_env_steps_trained_throughput_per_sec": 348.42870479750263, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 11928.559, "restore_workers_time_ms": 0.031, "training_step_time_ms": 11928.482, "sample_time_ms": 1179.302, "learn_time_ms": 10684.071, "learn_throughput": 374.389, "synch_weights_time_ms": 64.314}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00002", "date": "2024-08-04_05-43-39", "timestamp": 1722730419, "time_this_iter_s": 11.493109941482544, "time_total_s": 295.3661811351776, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0ad750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.3661811351776, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 19.33125, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 186.04054583907129, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.15741470195353, "policy_loss": -0.012736939326957023, "vf_loss": 2.1850421811764438, "vf_explained_var": 0.9858802000681559, "kl": 0.013014060301240252, "entropy": 1.8794756724188726, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": 1.5017833455208143, "episode_reward_min": -1525.0401926352586, "episode_reward_mean": -654.9562912576819, "episode_len_mean": 122.69, "episode_media": {}, "episodes_timesteps_total": 12269, "policy_reward_min": {"policy_0": -1525.0401926352586}, "policy_reward_max": {"policy_0": 1.5017833455208143}, "policy_reward_mean": {"policy_0": -654.9562912576819}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1206.7368701203088, -223.33844395922165, -159.85745740711985, -1476.4355881665967, -110.39880047873137, -454.8173764732723, -706.4477463398223, -477.9053563537807, -592.7739036475675, -65.7568369833536, -517.8668278655429, -236.08855485077078, -712.3347711006445, -606.8233233573941, -855.4957374896202, -934.0054409156255, -485.2082856294358, -439.1473421881043, -1114.8921035829194, -1303.2163363539512, -1188.220788134102, -1156.9550077521062, -1320.5184605012612, -521.9939621774148, -210.32094953626964, -1062.9497071357716, -1013.562812297801, -319.684457635978, -1317.7930952643665, -313.35240676304915, -329.88606116398466, -136.1501496081391, -96.88839589714826, -484.00710539384306, -124.6030550494904, -892.449103889714, -251.00413498927927, -819.9144531956878, -181.42487253862555, -188.4433332391431, -847.4886925234022, -1370.6873712990969, -1225.04388132671, -1276.8342944947299, -313.76946325048095, -756.6349786492871, -366.6508164513562, -1049.0434523098374, -419.52925889681495, -942.6459255301728, -970.1564426906582, -141.63778142965924, -172.14428048006397, -859.2827972829987, -1281.479407972125, -1087.9137907354445, -270.13213841932657, -1525.0401926352586, -712.4873718174323, -359.5582393476964, -32.111317273129735, -238.186979530555, -1104.6231564824864, -813.626652645867, -130.02657562872537, -1230.9652539235828, -848.105482514843, -1175.8631034506016, -136.49306666792194, -1022.409119472812, -135.29453069697087, -885.3731096575302, 1.5017833455208143, -112.43361737675608, -1423.4789271051782, -248.48175132918047, -660.851127093508, -775.9544563978524, -363.79697325533033, -857.6030626042641, -42.35695231617685, -1297.766606034084, -207.297097094041, -1143.2468331407854, -529.4937176902728, -641.6944301086245, -391.8146247759133, -964.8196807503274, -746.4985446531254, -182.51722866345114, -1137.9288720027362, -218.3308954587256, -1160.0015695563097, -176.7235235695271, -1030.951006826817, -399.05871623294394, -461.7778819269882, -1152.173901440288, -387.6099016398777, -471.56066915607937], "episode_lengths": [150, 103, 61, 150, 81, 135, 129, 104, 150, 51, 130, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 122, 150, 121, 112, 66, 84, 104, 67, 150, 93, 150, 65, 61, 147, 150, 150, 150, 102, 150, 87, 150, 150, 150, 150, 76, 87, 150, 150, 150, 113, 150, 150, 105, 46, 68, 150, 134, 74, 150, 140, 150, 78, 150, 74, 150, 39, 52, 150, 91, 150, 150, 109, 150, 55, 150, 96, 150, 109, 150, 129, 150, 150, 70, 150, 97, 150, 82, 150, 123, 144, 150, 132, 134], "policy_policy_0_reward": [-1206.7368701203088, -223.33844395922165, -159.85745740711985, -1476.4355881665967, -110.39880047873137, -454.8173764732723, -706.4477463398223, -477.9053563537807, -592.7739036475675, -65.7568369833536, -517.8668278655429, -236.08855485077078, -712.3347711006445, -606.8233233573941, -855.4957374896202, -934.0054409156255, -485.2082856294358, -439.1473421881043, -1114.8921035829194, -1303.2163363539512, -1188.220788134102, -1156.9550077521062, -1320.5184605012612, -521.9939621774148, -210.32094953626964, -1062.9497071357716, -1013.562812297801, -319.684457635978, -1317.7930952643665, -313.35240676304915, -329.88606116398466, -136.1501496081391, -96.88839589714826, -484.00710539384306, -124.6030550494904, -892.449103889714, -251.00413498927927, -819.9144531956878, -181.42487253862555, -188.4433332391431, -847.4886925234022, -1370.6873712990969, -1225.04388132671, -1276.8342944947299, -313.76946325048095, -756.6349786492871, -366.6508164513562, -1049.0434523098374, -419.52925889681495, -942.6459255301728, -970.1564426906582, -141.63778142965924, -172.14428048006397, -859.2827972829987, -1281.479407972125, -1087.9137907354445, -270.13213841932657, -1525.0401926352586, -712.4873718174323, -359.5582393476964, -32.111317273129735, -238.186979530555, -1104.6231564824864, -813.626652645867, -130.02657562872537, -1230.9652539235828, -848.105482514843, -1175.8631034506016, -136.49306666792194, -1022.409119472812, -135.29453069697087, -885.3731096575302, 1.5017833455208143, -112.43361737675608, -1423.4789271051782, -248.48175132918047, -660.851127093508, -775.9544563978524, -363.79697325533033, -857.6030626042641, -42.35695231617685, -1297.766606034084, -207.297097094041, -1143.2468331407854, -529.4937176902728, -641.6944301086245, -391.8146247759133, -964.8196807503274, -746.4985446531254, -182.51722866345114, -1137.9288720027362, -218.3308954587256, -1160.0015695563097, -176.7235235695271, -1030.951006826817, -399.05871623294394, -461.7778819269882, -1152.173901440288, -387.6099016398777, -471.56066915607937]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550524695005213, "mean_inference_ms": 1.6758978756552636, "mean_action_processing_ms": 0.2770022002064251, "mean_env_wait_ms": 3.534219960771159, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012136459350585938, "StateBufferConnector_ms": 0.00795888900756836, "ViewRequirementAgentConnector_ms": 0.19362235069274902}, "num_episodes": 34, "episode_return_max": 1.5017833455208143, "episode_return_min": -1525.0401926352586, "episode_return_mean": -654.9562912576819, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 458.1851801874616, "num_env_steps_trained_throughput_per_sec": 458.1851801874616, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 11503.647, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11503.573, "sample_time_ms": 1195.367, "learn_time_ms": 10244.628, "learn_throughput": 390.449, "synch_weights_time_ms": 62.791}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00002", "date": "2024-08-04_05-43-48", "timestamp": 1722730428, "time_this_iter_s": 8.743277311325073, "time_total_s": 304.1094584465027, "pid": 571086, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f645e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 304.1094584465027, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 21.353846153846156, "ram_util_percent": 27.899999999999995}}
