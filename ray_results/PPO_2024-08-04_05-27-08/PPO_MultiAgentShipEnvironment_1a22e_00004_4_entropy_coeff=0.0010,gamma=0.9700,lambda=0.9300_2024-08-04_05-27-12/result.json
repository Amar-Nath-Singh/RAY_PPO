{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2185260268859566, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.41020297507445, "policy_loss": -0.009529079459025525, "vf_loss": 9.418538988629978, "vf_explained_var": 0.038275307168563207, "kl": 0.013200161316611532, "entropy": 1.4469664392371973, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -38.00825545315404, "episode_reward_min": -1230.8230828589526, "episode_reward_mean": -596.3299190934785, "episode_len_mean": 114.96296296296296, "episode_media": {}, "episodes_timesteps_total": 3104, "policy_reward_min": {"policy_0": -1230.8230828589526}, "policy_reward_max": {"policy_0": -38.00825545315404}, "policy_reward_mean": {"policy_0": -596.3299190934785}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-851.7080968390593, -606.6661397996328, -257.02370304546326, -56.01601823247584, -1127.0756973604682, -823.6948742567009, -133.60831389364824, -1044.6659593668035, -784.3547775581317, -1085.123915851839, -91.72260898124897, -191.37572642790855, -267.9159994081314, -989.3615762206659, -223.71700329407597, -135.21873011843903, -682.5670861740356, -41.93358600763687, -38.00825545315404, -1230.8230828589526, -473.45551781792244, -998.3068250169457, -276.2997407995813, -700.5472763875126, -1036.9227034783066, -978.8455148423119, -973.9490860328651], "episode_lengths": [150, 127, 82, 53, 150, 150, 75, 150, 150, 150, 55, 77, 98, 150, 102, 71, 142, 38, 46, 150, 104, 150, 84, 150, 150, 150, 150], "policy_policy_0_reward": [-851.7080968390593, -606.6661397996328, -257.02370304546326, -56.01601823247584, -1127.0756973604682, -823.6948742567009, -133.60831389364824, -1044.6659593668035, -784.3547775581317, -1085.123915851839, -91.72260898124897, -191.37572642790855, -267.9159994081314, -989.3615762206659, -223.71700329407597, -135.21873011843903, -682.5670861740356, -41.93358600763687, -38.00825545315404, -1230.8230828589526, -473.45551781792244, -998.3068250169457, -276.2997407995813, -700.5472763875126, -1036.9227034783066, -978.8455148423119, -973.9490860328651]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5615336362994994, "mean_inference_ms": 1.6516229998040997, "mean_action_processing_ms": 0.27206322880460565, "mean_env_wait_ms": 3.3475505735131357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01170546920211227, "StateBufferConnector_ms": 0.008151266309950087, "ViewRequirementAgentConnector_ms": 0.1807115696094654}, "num_episodes": 27, "episode_return_max": -38.00825545315404, "episode_return_min": -1230.8230828589526, "episode_return_mean": -596.3299190934785, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.09121447507925, "num_env_steps_trained_throughput_per_sec": 310.09121447507925, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12899.44, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12899.376, "sample_time_ms": 1111.79, "learn_time_ms": 11730.923, "learn_throughput": 340.979, "synch_weights_time_ms": 55.894}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00004", "date": "2024-08-04_05-49-56", "timestamp": 1722730796, "time_this_iter_s": 12.910576581954956, "time_total_s": 12.910576581954956, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5edd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.910576581954956, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 16.989473684210527, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.1642629991595945, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.386299323042234, "policy_loss": -0.005926591959238673, "vf_loss": 9.391522541642189, "vf_explained_var": 0.13867775121082862, "kl": 0.01092827384454722, "entropy": 1.4822761844843626, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -31.738791283359877, "episode_reward_min": -1414.9079102224475, "episode_reward_mean": -616.0103824789594, "episode_len_mean": 112.86440677966101, "episode_media": {}, "episodes_timesteps_total": 6659, "policy_reward_min": {"policy_0": -1414.9079102224475}, "policy_reward_max": {"policy_0": -31.738791283359877}, "policy_reward_mean": {"policy_0": -616.0103824789594}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-851.7080968390593, -606.6661397996328, -257.02370304546326, -56.01601823247584, -1127.0756973604682, -823.6948742567009, -133.60831389364824, -1044.6659593668035, -784.3547775581317, -1085.123915851839, -91.72260898124897, -191.37572642790855, -267.9159994081314, -989.3615762206659, -223.71700329407597, -135.21873011843903, -682.5670861740356, -41.93358600763687, -38.00825545315404, -1230.8230828589526, -473.45551781792244, -998.3068250169457, -276.2997407995813, -700.5472763875126, -1036.9227034783066, -978.8455148423119, -973.9490860328651, -1280.2549557674556, -972.8347300193306, -151.56661912388648, -91.32541316119458, -112.69267497998509, -52.9330378401671, -1281.3723187241135, -33.274172613093185, -1011.8176491936081, -1414.9079102224475, -126.2066563235328, -1136.2110966711532, -743.1026306661203, -1064.4987320503824, -101.35729896696424, -768.1294356866827, -144.83588896636468, -1127.4360864958333, -199.46066765296376, -292.3053782718765, -920.2940279377074, -531.803371998919, -921.9327282500241, -1116.1731348204612, -139.98992365107762, -260.11599009242525, -1233.464752724376, -1261.550373176167, -1083.062177821536, -346.6284960323452, -31.738791283359877, -290.4276295491371], "episode_lengths": [150, 127, 82, 53, 150, 150, 75, 150, 150, 150, 55, 77, 98, 150, 102, 71, 142, 38, 46, 150, 104, 150, 84, 150, 150, 150, 150, 150, 150, 64, 69, 65, 41, 150, 48, 150, 150, 48, 150, 150, 150, 68, 150, 77, 150, 63, 116, 150, 111, 150, 150, 73, 85, 150, 150, 150, 90, 50, 87], "policy_policy_0_reward": [-851.7080968390593, -606.6661397996328, -257.02370304546326, -56.01601823247584, -1127.0756973604682, -823.6948742567009, -133.60831389364824, -1044.6659593668035, -784.3547775581317, -1085.123915851839, -91.72260898124897, -191.37572642790855, -267.9159994081314, -989.3615762206659, -223.71700329407597, -135.21873011843903, -682.5670861740356, -41.93358600763687, -38.00825545315404, -1230.8230828589526, -473.45551781792244, -998.3068250169457, -276.2997407995813, -700.5472763875126, -1036.9227034783066, -978.8455148423119, -973.9490860328651, -1280.2549557674556, -972.8347300193306, -151.56661912388648, -91.32541316119458, -112.69267497998509, -52.9330378401671, -1281.3723187241135, -33.274172613093185, -1011.8176491936081, -1414.9079102224475, -126.2066563235328, -1136.2110966711532, -743.1026306661203, -1064.4987320503824, -101.35729896696424, -768.1294356866827, -144.83588896636468, -1127.4360864958333, -199.46066765296376, -292.3053782718765, -920.2940279377074, -531.803371998919, -921.9327282500241, -1116.1731348204612, -139.98992365107762, -260.11599009242525, -1233.464752724376, -1261.550373176167, -1083.062177821536, -346.6284960323452, -31.738791283359877, -290.4276295491371]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5626598368755171, "mean_inference_ms": 1.6592662925034778, "mean_action_processing_ms": 0.2739297278986027, "mean_env_wait_ms": 3.380159476828949, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013324365777484441, "StateBufferConnector_ms": 0.008299391148454053, "ViewRequirementAgentConnector_ms": 0.1847671250165519}, "num_episodes": 32, "episode_return_max": -31.738791283359877, "episode_return_min": -1414.9079102224475, "episode_return_mean": -616.0103824789594, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 329.61524708163023, "num_env_steps_trained_throughput_per_sec": 329.61524708163023, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12517.407, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12517.335, "sample_time_ms": 1106.292, "learn_time_ms": 11351.503, "learn_throughput": 352.376, "synch_weights_time_ms": 58.778}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00004", "date": "2024-08-04_05-50-09", "timestamp": 1722730809, "time_this_iter_s": 12.146759748458862, "time_total_s": 25.05733633041382, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0ae830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.05733633041382, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.98823529411765, "ram_util_percent": 27.89411764705882}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.2098503416093687, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.705560865004857, "policy_loss": -0.007972690556683423, "vf_loss": 9.712936042745907, "vf_explained_var": 0.16919631094982227, "kl": 0.010631369091978133, "entropy": 1.5287514075636863, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -14.481433004145995, "episode_reward_min": -1414.9079102224475, "episode_reward_mean": -662.6168711671389, "episode_len_mean": 118.73255813953489, "episode_media": {}, "episodes_timesteps_total": 10211, "policy_reward_min": {"policy_0": -1414.9079102224475}, "policy_reward_max": {"policy_0": -14.481433004145995}, "policy_reward_mean": {"policy_0": -662.6168711671389}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-851.7080968390593, -606.6661397996328, -257.02370304546326, -56.01601823247584, -1127.0756973604682, -823.6948742567009, -133.60831389364824, -1044.6659593668035, -784.3547775581317, -1085.123915851839, -91.72260898124897, -191.37572642790855, -267.9159994081314, -989.3615762206659, -223.71700329407597, -135.21873011843903, -682.5670861740356, -41.93358600763687, -38.00825545315404, -1230.8230828589526, -473.45551781792244, -998.3068250169457, -276.2997407995813, -700.5472763875126, -1036.9227034783066, -978.8455148423119, -973.9490860328651, -1280.2549557674556, -972.8347300193306, -151.56661912388648, -91.32541316119458, -112.69267497998509, -52.9330378401671, -1281.3723187241135, -33.274172613093185, -1011.8176491936081, -1414.9079102224475, -126.2066563235328, -1136.2110966711532, -743.1026306661203, -1064.4987320503824, -101.35729896696424, -768.1294356866827, -144.83588896636468, -1127.4360864958333, -199.46066765296376, -292.3053782718765, -920.2940279377074, -531.803371998919, -921.9327282500241, -1116.1731348204612, -139.98992365107762, -260.11599009242525, -1233.464752724376, -1261.550373176167, -1083.062177821536, -346.6284960323452, -31.738791283359877, -290.4276295491371, -1113.9852991242026, -1003.2433796377394, -791.6368562775796, -1180.0100505902433, -775.5939861356347, -986.467241279953, -1210.254384417909, -813.971983364554, -398.0460901601802, -254.54626829354544, -1311.1876238633552, -1025.1373817901883, -707.9263506226033, -1090.48178783688, -658.9959124987937, -1085.3314007189033, -913.1664989833967, -1106.5152557225551, -42.79088916175676, -550.0463288002585, -159.2854674051529, -944.1898324612273, -302.5120304177737, -745.2794271043215, -14.481433004145995, -978.2100020857417, -477.1451923567435], "episode_lengths": [150, 127, 82, 53, 150, 150, 75, 150, 150, 150, 55, 77, 98, 150, 102, 71, 142, 38, 46, 150, 104, 150, 84, 150, 150, 150, 150, 150, 150, 64, 69, 65, 41, 150, 48, 150, 150, 48, 150, 150, 150, 68, 150, 77, 150, 63, 116, 150, 111, 150, 150, 73, 85, 150, 150, 150, 90, 50, 87, 150, 150, 150, 150, 150, 150, 150, 150, 118, 73, 150, 150, 127, 150, 150, 150, 150, 150, 48, 129, 84, 150, 86, 150, 37, 150, 150], "policy_policy_0_reward": [-851.7080968390593, -606.6661397996328, -257.02370304546326, -56.01601823247584, -1127.0756973604682, -823.6948742567009, -133.60831389364824, -1044.6659593668035, -784.3547775581317, -1085.123915851839, -91.72260898124897, -191.37572642790855, -267.9159994081314, -989.3615762206659, -223.71700329407597, -135.21873011843903, -682.5670861740356, -41.93358600763687, -38.00825545315404, -1230.8230828589526, -473.45551781792244, -998.3068250169457, -276.2997407995813, -700.5472763875126, -1036.9227034783066, -978.8455148423119, -973.9490860328651, -1280.2549557674556, -972.8347300193306, -151.56661912388648, -91.32541316119458, -112.69267497998509, -52.9330378401671, -1281.3723187241135, -33.274172613093185, -1011.8176491936081, -1414.9079102224475, -126.2066563235328, -1136.2110966711532, -743.1026306661203, -1064.4987320503824, -101.35729896696424, -768.1294356866827, -144.83588896636468, -1127.4360864958333, -199.46066765296376, -292.3053782718765, -920.2940279377074, -531.803371998919, -921.9327282500241, -1116.1731348204612, -139.98992365107762, -260.11599009242525, -1233.464752724376, -1261.550373176167, -1083.062177821536, -346.6284960323452, -31.738791283359877, -290.4276295491371, -1113.9852991242026, -1003.2433796377394, -791.6368562775796, -1180.0100505902433, -775.5939861356347, -986.467241279953, -1210.254384417909, -813.971983364554, -398.0460901601802, -254.54626829354544, -1311.1876238633552, -1025.1373817901883, -707.9263506226033, -1090.48178783688, -658.9959124987937, -1085.3314007189033, -913.1664989833967, -1106.5152557225551, -42.79088916175676, -550.0463288002585, -159.2854674051529, -944.1898324612273, -302.5120304177737, -745.2794271043215, -14.481433004145995, -978.2100020857417, -477.1451923567435]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621393162516489, "mean_inference_ms": 1.6663236189036001, "mean_action_processing_ms": 0.2750637759210431, "mean_env_wait_ms": 3.4049790691537245, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013239993605502817, "StateBufferConnector_ms": 0.008364333662875863, "ViewRequirementAgentConnector_ms": 0.18589191658552304}, "num_episodes": 27, "episode_return_max": -14.481433004145995, "episode_return_min": -1414.9079102224475, "episode_return_mean": -662.6168711671389, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.17777535587237, "num_env_steps_trained_throughput_per_sec": 309.17777535587237, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12657.457, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12657.378, "sample_time_ms": 1131.848, "learn_time_ms": 11464.722, "learn_throughput": 348.896, "synch_weights_time_ms": 60.011}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00004", "date": "2024-08-04_05-50-22", "timestamp": 1722730822, "time_this_iter_s": 12.950637102127075, "time_total_s": 38.007973432540894, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0ae170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.007973432540894, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.015789473684208, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.411870795240005, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.430221743384998, "policy_loss": -0.006191150086427418, "vf_loss": 9.434567088385423, "vf_explained_var": 0.3285078525543213, "kl": 0.0168318579290523, "entropy": 1.5205766546229522, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -11.898946694738141, "episode_reward_min": -1414.9079102224475, "episode_reward_mean": -718.4157769024046, "episode_len_mean": 125.01, "episode_media": {}, "episodes_timesteps_total": 12501, "policy_reward_min": {"policy_0": -1414.9079102224475}, "policy_reward_max": {"policy_0": -11.898946694738141}, "policy_reward_mean": {"policy_0": -718.4157769024046}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1230.8230828589526, -473.45551781792244, -998.3068250169457, -276.2997407995813, -700.5472763875126, -1036.9227034783066, -978.8455148423119, -973.9490860328651, -1280.2549557674556, -972.8347300193306, -151.56661912388648, -91.32541316119458, -112.69267497998509, -52.9330378401671, -1281.3723187241135, -33.274172613093185, -1011.8176491936081, -1414.9079102224475, -126.2066563235328, -1136.2110966711532, -743.1026306661203, -1064.4987320503824, -101.35729896696424, -768.1294356866827, -144.83588896636468, -1127.4360864958333, -199.46066765296376, -292.3053782718765, -920.2940279377074, -531.803371998919, -921.9327282500241, -1116.1731348204612, -139.98992365107762, -260.11599009242525, -1233.464752724376, -1261.550373176167, -1083.062177821536, -346.6284960323452, -31.738791283359877, -290.4276295491371, -1113.9852991242026, -1003.2433796377394, -791.6368562775796, -1180.0100505902433, -775.5939861356347, -986.467241279953, -1210.254384417909, -813.971983364554, -398.0460901601802, -254.54626829354544, -1311.1876238633552, -1025.1373817901883, -707.9263506226033, -1090.48178783688, -658.9959124987937, -1085.3314007189033, -913.1664989833967, -1106.5152557225551, -42.79088916175676, -550.0463288002585, -159.2854674051529, -944.1898324612273, -302.5120304177737, -745.2794271043215, -14.481433004145995, -978.2100020857417, -477.1451923567435, -227.01117121200693, -493.58382424029014, -1035.2336330790658, -724.1161891195837, -140.18131847380388, -1019.3521513279229, -841.3290636022138, -1056.267806653782, -220.60565200967142, -1063.5947673323105, -988.2568375907963, -69.49262123987712, -327.8370854525426, -11.898946694738141, -642.3386510463067, -1075.444970295222, -886.3645738333371, -1144.5213476403228, -1121.9978734085712, -1070.697048839219, -286.8442962507002, -891.3984843908403, -39.88844414317872, -1228.3276829624797, -875.137748835021, -1205.6618467217254, -1046.055564665455, -1105.6787041508999, -377.96866868678507, -466.5266527903083, -1006.157086675102, -911.2771503352869, -687.2369744566605], "episode_lengths": [150, 104, 150, 84, 150, 150, 150, 150, 150, 150, 64, 69, 65, 41, 150, 48, 150, 150, 48, 150, 150, 150, 68, 150, 77, 150, 63, 116, 150, 111, 150, 150, 73, 85, 150, 150, 150, 90, 50, 87, 150, 150, 150, 150, 150, 150, 150, 150, 118, 73, 150, 150, 127, 150, 150, 150, 150, 150, 48, 129, 84, 150, 86, 150, 37, 150, 150, 97, 112, 150, 150, 88, 150, 150, 150, 67, 150, 150, 44, 150, 40, 131, 150, 150, 150, 150, 150, 79, 150, 48, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1230.8230828589526, -473.45551781792244, -998.3068250169457, -276.2997407995813, -700.5472763875126, -1036.9227034783066, -978.8455148423119, -973.9490860328651, -1280.2549557674556, -972.8347300193306, -151.56661912388648, -91.32541316119458, -112.69267497998509, -52.9330378401671, -1281.3723187241135, -33.274172613093185, -1011.8176491936081, -1414.9079102224475, -126.2066563235328, -1136.2110966711532, -743.1026306661203, -1064.4987320503824, -101.35729896696424, -768.1294356866827, -144.83588896636468, -1127.4360864958333, -199.46066765296376, -292.3053782718765, -920.2940279377074, -531.803371998919, -921.9327282500241, -1116.1731348204612, -139.98992365107762, -260.11599009242525, -1233.464752724376, -1261.550373176167, -1083.062177821536, -346.6284960323452, -31.738791283359877, -290.4276295491371, -1113.9852991242026, -1003.2433796377394, -791.6368562775796, -1180.0100505902433, -775.5939861356347, -986.467241279953, -1210.254384417909, -813.971983364554, -398.0460901601802, -254.54626829354544, -1311.1876238633552, -1025.1373817901883, -707.9263506226033, -1090.48178783688, -658.9959124987937, -1085.3314007189033, -913.1664989833967, -1106.5152557225551, -42.79088916175676, -550.0463288002585, -159.2854674051529, -944.1898324612273, -302.5120304177737, -745.2794271043215, -14.481433004145995, -978.2100020857417, -477.1451923567435, -227.01117121200693, -493.58382424029014, -1035.2336330790658, -724.1161891195837, -140.18131847380388, -1019.3521513279229, -841.3290636022138, -1056.267806653782, -220.60565200967142, -1063.5947673323105, -988.2568375907963, -69.49262123987712, -327.8370854525426, -11.898946694738141, -642.3386510463067, -1075.444970295222, -886.3645738333371, -1144.5213476403228, -1121.9978734085712, -1070.697048839219, -286.8442962507002, -891.3984843908403, -39.88844414317872, -1228.3276829624797, -875.137748835021, -1205.6618467217254, -1046.055564665455, -1105.6787041508999, -377.96866868678507, -466.5266527903083, -1006.157086675102, -911.2771503352869, -687.2369744566605]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5616877013860924, "mean_inference_ms": 1.6753208256380288, "mean_action_processing_ms": 0.27670568920744587, "mean_env_wait_ms": 3.437108401220596, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013487815856933594, "StateBufferConnector_ms": 0.008677482604980469, "ViewRequirementAgentConnector_ms": 0.19414067268371582}, "num_episodes": 33, "episode_return_max": -11.898946694738141, "episode_return_min": -1414.9079102224475, "episode_return_mean": -718.4157769024046, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.5407260369956, "num_env_steps_trained_throughput_per_sec": 309.5407260369956, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12723.688, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12723.613, "sample_time_ms": 1129.291, "learn_time_ms": 11526.798, "learn_throughput": 347.017, "synch_weights_time_ms": 66.734}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00004", "date": "2024-08-04_05-50-35", "timestamp": 1722730835, "time_this_iter_s": 12.937019109725952, "time_total_s": 50.944992542266846, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc703250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.944992542266846, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.133333333333336, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.533670806822678, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.29170779188474, "policy_loss": -0.01042050720473829, "vf_loss": 9.300691170493762, "vf_explained_var": 0.35828563030809163, "kl": 0.014979660732630387, "entropy": 1.5587748331328233, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -11.898946694738141, "episode_reward_min": -1470.038860294027, "episode_reward_mean": -732.2050879015261, "episode_len_mean": 126.91, "episode_media": {}, "episodes_timesteps_total": 12691, "policy_reward_min": {"policy_0": -1470.038860294027}, "policy_reward_max": {"policy_0": -11.898946694738141}, "policy_reward_mean": {"policy_0": -732.2050879015261}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-921.9327282500241, -1116.1731348204612, -139.98992365107762, -260.11599009242525, -1233.464752724376, -1261.550373176167, -1083.062177821536, -346.6284960323452, -31.738791283359877, -290.4276295491371, -1113.9852991242026, -1003.2433796377394, -791.6368562775796, -1180.0100505902433, -775.5939861356347, -986.467241279953, -1210.254384417909, -813.971983364554, -398.0460901601802, -254.54626829354544, -1311.1876238633552, -1025.1373817901883, -707.9263506226033, -1090.48178783688, -658.9959124987937, -1085.3314007189033, -913.1664989833967, -1106.5152557225551, -42.79088916175676, -550.0463288002585, -159.2854674051529, -944.1898324612273, -302.5120304177737, -745.2794271043215, -14.481433004145995, -978.2100020857417, -477.1451923567435, -227.01117121200693, -493.58382424029014, -1035.2336330790658, -724.1161891195837, -140.18131847380388, -1019.3521513279229, -841.3290636022138, -1056.267806653782, -220.60565200967142, -1063.5947673323105, -988.2568375907963, -69.49262123987712, -327.8370854525426, -11.898946694738141, -642.3386510463067, -1075.444970295222, -886.3645738333371, -1144.5213476403228, -1121.9978734085712, -1070.697048839219, -286.8442962507002, -891.3984843908403, -39.88844414317872, -1228.3276829624797, -875.137748835021, -1205.6618467217254, -1046.055564665455, -1105.6787041508999, -377.96866868678507, -466.5266527903083, -1006.157086675102, -911.2771503352869, -687.2369744566605, -1470.038860294027, -1029.8553935473947, -993.735590773912, -1073.1649791008902, -1130.8915023445884, -1190.898831366414, -925.1610895542683, -984.7771274907218, -1287.1349270993433, -48.652193868442865, -430.5567080537082, -1166.6187141863752, -213.51476034876183, -907.2629030777017, -94.88277321804107, -55.83490292968208, -652.7918382774886, -1158.4281982497068, -118.3543610176486, -303.4772324839324, -1381.903853681961, -686.5774706184503, -645.753784630657, -777.9677270975601, -671.6936139777042, -399.6129007664049, -737.806138376526, -296.16865378058424, -570.1357392570485, -203.04883101038686], "episode_lengths": [150, 150, 73, 85, 150, 150, 150, 90, 50, 87, 150, 150, 150, 150, 150, 150, 150, 150, 118, 73, 150, 150, 127, 150, 150, 150, 150, 150, 48, 129, 84, 150, 86, 150, 37, 150, 150, 97, 112, 150, 150, 88, 150, 150, 150, 67, 150, 150, 44, 150, 40, 131, 150, 150, 150, 150, 150, 79, 150, 48, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 37, 94, 150, 82, 150, 64, 52, 118, 150, 74, 79, 150, 150, 124, 145, 150, 150, 139, 100, 128, 62], "policy_policy_0_reward": [-921.9327282500241, -1116.1731348204612, -139.98992365107762, -260.11599009242525, -1233.464752724376, -1261.550373176167, -1083.062177821536, -346.6284960323452, -31.738791283359877, -290.4276295491371, -1113.9852991242026, -1003.2433796377394, -791.6368562775796, -1180.0100505902433, -775.5939861356347, -986.467241279953, -1210.254384417909, -813.971983364554, -398.0460901601802, -254.54626829354544, -1311.1876238633552, -1025.1373817901883, -707.9263506226033, -1090.48178783688, -658.9959124987937, -1085.3314007189033, -913.1664989833967, -1106.5152557225551, -42.79088916175676, -550.0463288002585, -159.2854674051529, -944.1898324612273, -302.5120304177737, -745.2794271043215, -14.481433004145995, -978.2100020857417, -477.1451923567435, -227.01117121200693, -493.58382424029014, -1035.2336330790658, -724.1161891195837, -140.18131847380388, -1019.3521513279229, -841.3290636022138, -1056.267806653782, -220.60565200967142, -1063.5947673323105, -988.2568375907963, -69.49262123987712, -327.8370854525426, -11.898946694738141, -642.3386510463067, -1075.444970295222, -886.3645738333371, -1144.5213476403228, -1121.9978734085712, -1070.697048839219, -286.8442962507002, -891.3984843908403, -39.88844414317872, -1228.3276829624797, -875.137748835021, -1205.6618467217254, -1046.055564665455, -1105.6787041508999, -377.96866868678507, -466.5266527903083, -1006.157086675102, -911.2771503352869, -687.2369744566605, -1470.038860294027, -1029.8553935473947, -993.735590773912, -1073.1649791008902, -1130.8915023445884, -1190.898831366414, -925.1610895542683, -984.7771274907218, -1287.1349270993433, -48.652193868442865, -430.5567080537082, -1166.6187141863752, -213.51476034876183, -907.2629030777017, -94.88277321804107, -55.83490292968208, -652.7918382774886, -1158.4281982497068, -118.3543610176486, -303.4772324839324, -1381.903853681961, -686.5774706184503, -645.753784630657, -777.9677270975601, -671.6936139777042, -399.6129007664049, -737.806138376526, -296.16865378058424, -570.1357392570485, -203.04883101038686]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.560354087211964, "mean_inference_ms": 1.677742761159699, "mean_action_processing_ms": 0.27763398517867843, "mean_env_wait_ms": 3.455306719484162, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012932777404785156, "StateBufferConnector_ms": 0.008759498596191406, "ViewRequirementAgentConnector_ms": 0.19557642936706543}, "num_episodes": 30, "episode_return_max": -11.898946694738141, "episode_return_min": -1470.038860294027, "episode_return_mean": -732.2050879015261, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.23839167231876, "num_env_steps_trained_throughput_per_sec": 307.23839167231876, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12782.795, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12782.72, "sample_time_ms": 1127.432, "learn_time_ms": 11588.532, "learn_throughput": 345.169, "synch_weights_time_ms": 65.971}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00004", "date": "2024-08-04_05-50-48", "timestamp": 1722730848, "time_this_iter_s": 13.03134560585022, "time_total_s": 63.976338148117065, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc703c70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 63.976338148117065, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.96315789473684, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.713650066653887, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.174812499682108, "policy_loss": -0.01790241745863265, "vf_loss": 9.189760357141495, "vf_explained_var": 0.3569903146475554, "kl": 0.022610614309026764, "entropy": 1.5675882016619047, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -11.898946694738141, "episode_reward_min": -1470.038860294027, "episode_reward_mean": -761.1248678025913, "episode_len_mean": 129.32, "episode_media": {}, "episodes_timesteps_total": 12932, "policy_reward_min": {"policy_0": -1470.038860294027}, "policy_reward_max": {"policy_0": -11.898946694738141}, "policy_reward_mean": {"policy_0": -761.1248678025913}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-745.2794271043215, -14.481433004145995, -978.2100020857417, -477.1451923567435, -227.01117121200693, -493.58382424029014, -1035.2336330790658, -724.1161891195837, -140.18131847380388, -1019.3521513279229, -841.3290636022138, -1056.267806653782, -220.60565200967142, -1063.5947673323105, -988.2568375907963, -69.49262123987712, -327.8370854525426, -11.898946694738141, -642.3386510463067, -1075.444970295222, -886.3645738333371, -1144.5213476403228, -1121.9978734085712, -1070.697048839219, -286.8442962507002, -891.3984843908403, -39.88844414317872, -1228.3276829624797, -875.137748835021, -1205.6618467217254, -1046.055564665455, -1105.6787041508999, -377.96866868678507, -466.5266527903083, -1006.157086675102, -911.2771503352869, -687.2369744566605, -1470.038860294027, -1029.8553935473947, -993.735590773912, -1073.1649791008902, -1130.8915023445884, -1190.898831366414, -925.1610895542683, -984.7771274907218, -1287.1349270993433, -48.652193868442865, -430.5567080537082, -1166.6187141863752, -213.51476034876183, -907.2629030777017, -94.88277321804107, -55.83490292968208, -652.7918382774886, -1158.4281982497068, -118.3543610176486, -303.4772324839324, -1381.903853681961, -686.5774706184503, -645.753784630657, -777.9677270975601, -671.6936139777042, -399.6129007664049, -737.806138376526, -296.16865378058424, -570.1357392570485, -203.04883101038686, -1116.7071062086188, -1050.2602843154832, -1118.3329599487397, -950.6338012139397, -395.157707821413, -867.852262746764, -160.94663641214677, -1111.4900005737081, -1164.0153562526648, -1034.6091795025443, -657.6661638662669, -993.270170132846, -221.3224343410771, -70.72942345934472, -1162.2178290081497, -277.97713419673056, -1248.6174154925714, -1257.129766261066, -1363.8494068919035, -1186.4320511167737, -1163.7711970141006, -57.08245626740526, -1012.3453668996398, -551.8407895238852, -383.4122716253187, -1006.9995107444099, -1066.181477645523, -333.87431075606474, -687.9861452154402, -1024.4614846138918, -1327.7662347922806, -994.0765919648409, -983.369360246276], "episode_lengths": [150, 37, 150, 150, 97, 112, 150, 150, 88, 150, 150, 150, 67, 150, 150, 44, 150, 40, 131, 150, 150, 150, 150, 150, 79, 150, 48, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 37, 94, 150, 82, 150, 64, 52, 118, 150, 74, 79, 150, 150, 124, 145, 150, 150, 139, 100, 128, 62, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 142, 150, 64, 68, 150, 105, 150, 150, 150, 150, 150, 56, 150, 150, 105, 150, 150, 83, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-745.2794271043215, -14.481433004145995, -978.2100020857417, -477.1451923567435, -227.01117121200693, -493.58382424029014, -1035.2336330790658, -724.1161891195837, -140.18131847380388, -1019.3521513279229, -841.3290636022138, -1056.267806653782, -220.60565200967142, -1063.5947673323105, -988.2568375907963, -69.49262123987712, -327.8370854525426, -11.898946694738141, -642.3386510463067, -1075.444970295222, -886.3645738333371, -1144.5213476403228, -1121.9978734085712, -1070.697048839219, -286.8442962507002, -891.3984843908403, -39.88844414317872, -1228.3276829624797, -875.137748835021, -1205.6618467217254, -1046.055564665455, -1105.6787041508999, -377.96866868678507, -466.5266527903083, -1006.157086675102, -911.2771503352869, -687.2369744566605, -1470.038860294027, -1029.8553935473947, -993.735590773912, -1073.1649791008902, -1130.8915023445884, -1190.898831366414, -925.1610895542683, -984.7771274907218, -1287.1349270993433, -48.652193868442865, -430.5567080537082, -1166.6187141863752, -213.51476034876183, -907.2629030777017, -94.88277321804107, -55.83490292968208, -652.7918382774886, -1158.4281982497068, -118.3543610176486, -303.4772324839324, -1381.903853681961, -686.5774706184503, -645.753784630657, -777.9677270975601, -671.6936139777042, -399.6129007664049, -737.806138376526, -296.16865378058424, -570.1357392570485, -203.04883101038686, -1116.7071062086188, -1050.2602843154832, -1118.3329599487397, -950.6338012139397, -395.157707821413, -867.852262746764, -160.94663641214677, -1111.4900005737081, -1164.0153562526648, -1034.6091795025443, -657.6661638662669, -993.270170132846, -221.3224343410771, -70.72942345934472, -1162.2178290081497, -277.97713419673056, -1248.6174154925714, -1257.129766261066, -1363.8494068919035, -1186.4320511167737, -1163.7711970141006, -57.08245626740526, -1012.3453668996398, -551.8407895238852, -383.4122716253187, -1006.9995107444099, -1066.181477645523, -333.87431075606474, -687.9861452154402, -1024.4614846138918, -1327.7662347922806, -994.0765919648409, -983.369360246276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5597093760613482, "mean_inference_ms": 1.6778176337792547, "mean_action_processing_ms": 0.2783409190722684, "mean_env_wait_ms": 3.4660753221099094, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012826204299926758, "StateBufferConnector_ms": 0.008766651153564453, "ViewRequirementAgentConnector_ms": 0.1963050365447998}, "num_episodes": 33, "episode_return_max": -11.898946694738141, "episode_return_min": -1470.038860294027, "episode_return_mean": -761.1248678025913, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.4190382819276, "num_env_steps_trained_throughput_per_sec": 305.4190382819276, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12835.125, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12835.05, "sample_time_ms": 1128.608, "learn_time_ms": 11640.837, "learn_throughput": 343.618, "synch_weights_time_ms": 64.823}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00004", "date": "2024-08-04_05-51-01", "timestamp": 1722730861, "time_this_iter_s": 13.110160827636719, "time_total_s": 77.08649897575378, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc703be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.08649897575378, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.099999999999998, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.131230226779978, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.968470303714275, "policy_loss": -0.011289956467226147, "vf_loss": 8.977635777493317, "vf_explained_var": 0.4142095597460866, "kl": 0.012312310209805832, "entropy": 1.5691948185364406, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -37.91765441203565, "episode_reward_min": -1470.038860294027, "episode_reward_mean": -802.0549539251207, "episode_len_mean": 131.36, "episode_media": {}, "episodes_timesteps_total": 13136, "policy_reward_min": {"policy_0": -1470.038860294027}, "policy_reward_max": {"policy_0": -37.91765441203565}, "policy_reward_mean": {"policy_0": -802.0549539251207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1046.055564665455, -1105.6787041508999, -377.96866868678507, -466.5266527903083, -1006.157086675102, -911.2771503352869, -687.2369744566605, -1470.038860294027, -1029.8553935473947, -993.735590773912, -1073.1649791008902, -1130.8915023445884, -1190.898831366414, -925.1610895542683, -984.7771274907218, -1287.1349270993433, -48.652193868442865, -430.5567080537082, -1166.6187141863752, -213.51476034876183, -907.2629030777017, -94.88277321804107, -55.83490292968208, -652.7918382774886, -1158.4281982497068, -118.3543610176486, -303.4772324839324, -1381.903853681961, -686.5774706184503, -645.753784630657, -777.9677270975601, -671.6936139777042, -399.6129007664049, -737.806138376526, -296.16865378058424, -570.1357392570485, -203.04883101038686, -1116.7071062086188, -1050.2602843154832, -1118.3329599487397, -950.6338012139397, -395.157707821413, -867.852262746764, -160.94663641214677, -1111.4900005737081, -1164.0153562526648, -1034.6091795025443, -657.6661638662669, -993.270170132846, -221.3224343410771, -70.72942345934472, -1162.2178290081497, -277.97713419673056, -1248.6174154925714, -1257.129766261066, -1363.8494068919035, -1186.4320511167737, -1163.7711970141006, -57.08245626740526, -1012.3453668996398, -551.8407895238852, -383.4122716253187, -1006.9995107444099, -1066.181477645523, -333.87431075606474, -687.9861452154402, -1024.4614846138918, -1327.7662347922806, -994.0765919648409, -983.369360246276, -966.2172327186403, -776.1733958505046, -1157.0262220294865, -1126.090961743803, -154.51755416348288, -130.07987826980676, -888.1907524371271, -1300.3527229494307, -37.91765441203565, -1010.1763361417493, -1212.36908834673, -864.3526690535177, -1358.4271163567087, -1372.1653934305823, -507.8538746524527, -577.8027199627917, -301.1683689483443, -1048.7160893614403, -597.0800408027767, -1238.615466117659, -245.74736432674266, -273.32572900803353, -1381.0352417100382, -1085.9972546564964, -1118.1527810698735, -167.75146317794454, -1113.9908835555932, -1292.242148486787, -658.9530289974989, -1033.0192704613255], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 37, 94, 150, 82, 150, 64, 52, 118, 150, 74, 79, 150, 150, 124, 145, 150, 150, 139, 100, 128, 62, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 142, 150, 64, 68, 150, 105, 150, 150, 150, 150, 150, 56, 150, 150, 105, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 79, 150, 150, 41, 150, 150, 150, 150, 150, 121, 150, 88, 150, 150, 150, 89, 76, 150, 150, 150, 85, 150, 150, 150, 150], "policy_policy_0_reward": [-1046.055564665455, -1105.6787041508999, -377.96866868678507, -466.5266527903083, -1006.157086675102, -911.2771503352869, -687.2369744566605, -1470.038860294027, -1029.8553935473947, -993.735590773912, -1073.1649791008902, -1130.8915023445884, -1190.898831366414, -925.1610895542683, -984.7771274907218, -1287.1349270993433, -48.652193868442865, -430.5567080537082, -1166.6187141863752, -213.51476034876183, -907.2629030777017, -94.88277321804107, -55.83490292968208, -652.7918382774886, -1158.4281982497068, -118.3543610176486, -303.4772324839324, -1381.903853681961, -686.5774706184503, -645.753784630657, -777.9677270975601, -671.6936139777042, -399.6129007664049, -737.806138376526, -296.16865378058424, -570.1357392570485, -203.04883101038686, -1116.7071062086188, -1050.2602843154832, -1118.3329599487397, -950.6338012139397, -395.157707821413, -867.852262746764, -160.94663641214677, -1111.4900005737081, -1164.0153562526648, -1034.6091795025443, -657.6661638662669, -993.270170132846, -221.3224343410771, -70.72942345934472, -1162.2178290081497, -277.97713419673056, -1248.6174154925714, -1257.129766261066, -1363.8494068919035, -1186.4320511167737, -1163.7711970141006, -57.08245626740526, -1012.3453668996398, -551.8407895238852, -383.4122716253187, -1006.9995107444099, -1066.181477645523, -333.87431075606474, -687.9861452154402, -1024.4614846138918, -1327.7662347922806, -994.0765919648409, -983.369360246276, -966.2172327186403, -776.1733958505046, -1157.0262220294865, -1126.090961743803, -154.51755416348288, -130.07987826980676, -888.1907524371271, -1300.3527229494307, -37.91765441203565, -1010.1763361417493, -1212.36908834673, -864.3526690535177, -1358.4271163567087, -1372.1653934305823, -507.8538746524527, -577.8027199627917, -301.1683689483443, -1048.7160893614403, -597.0800408027767, -1238.615466117659, -245.74736432674266, -273.32572900803353, -1381.0352417100382, -1085.9972546564964, -1118.1527810698735, -167.75146317794454, -1113.9908835555932, -1292.242148486787, -658.9530289974989, -1033.0192704613255]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5589434700462366, "mean_inference_ms": 1.676882105557097, "mean_action_processing_ms": 0.2782700575899853, "mean_env_wait_ms": 3.4648942213005687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01240086555480957, "StateBufferConnector_ms": 0.008381128311157227, "ViewRequirementAgentConnector_ms": 0.19159173965454102}, "num_episodes": 30, "episode_return_max": -37.91765441203565, "episode_return_min": -1470.038860294027, "episode_return_mean": -802.0549539251207, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.0417402396402, "num_env_steps_trained_throughput_per_sec": 313.0417402396402, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12826.944, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12826.87, "sample_time_ms": 1125.458, "learn_time_ms": 11633.376, "learn_throughput": 343.838, "synch_weights_time_ms": 67.245}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00004", "date": "2024-08-04_05-51-14", "timestamp": 1722730874, "time_this_iter_s": 12.78974199295044, "time_total_s": 89.87624096870422, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7035b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 89.87624096870422, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.815789473684212, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.433144354137282, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.303555357952913, "policy_loss": -0.010575359659075427, "vf_loss": 9.310936845839024, "vf_explained_var": 0.46238745556523403, "kl": 0.015959121431296807, "entropy": 1.5938713413973649, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -37.91765441203565, "episode_reward_min": -1381.0352417100382, "episode_reward_mean": -800.0536938307864, "episode_len_mean": 132.16, "episode_media": {}, "episodes_timesteps_total": 13216, "policy_reward_min": {"policy_0": -1381.0352417100382}, "policy_reward_max": {"policy_0": -37.91765441203565}, "policy_reward_mean": {"policy_0": -800.0536938307864}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-645.753784630657, -777.9677270975601, -671.6936139777042, -399.6129007664049, -737.806138376526, -296.16865378058424, -570.1357392570485, -203.04883101038686, -1116.7071062086188, -1050.2602843154832, -1118.3329599487397, -950.6338012139397, -395.157707821413, -867.852262746764, -160.94663641214677, -1111.4900005737081, -1164.0153562526648, -1034.6091795025443, -657.6661638662669, -993.270170132846, -221.3224343410771, -70.72942345934472, -1162.2178290081497, -277.97713419673056, -1248.6174154925714, -1257.129766261066, -1363.8494068919035, -1186.4320511167737, -1163.7711970141006, -57.08245626740526, -1012.3453668996398, -551.8407895238852, -383.4122716253187, -1006.9995107444099, -1066.181477645523, -333.87431075606474, -687.9861452154402, -1024.4614846138918, -1327.7662347922806, -994.0765919648409, -983.369360246276, -966.2172327186403, -776.1733958505046, -1157.0262220294865, -1126.090961743803, -154.51755416348288, -130.07987826980676, -888.1907524371271, -1300.3527229494307, -37.91765441203565, -1010.1763361417493, -1212.36908834673, -864.3526690535177, -1358.4271163567087, -1372.1653934305823, -507.8538746524527, -577.8027199627917, -301.1683689483443, -1048.7160893614403, -597.0800408027767, -1238.615466117659, -245.74736432674266, -273.32572900803353, -1381.0352417100382, -1085.9972546564964, -1118.1527810698735, -167.75146317794454, -1113.9908835555932, -1292.242148486787, -658.9530289974989, -1033.0192704613255, -353.5950869468139, -203.4642138456281, -784.4803056039067, -909.0889942873188, -967.5577406860881, -607.9447829291228, -1239.4324106040897, -1153.591276348054, -58.2917183969968, -898.2845856256317, -1112.2664285845876, -172.27470474227064, -817.9805979909092, -852.4407281105555, -1209.0618820604204, -248.2196337773056, -207.51091135900225, -872.7134035490712, -814.019669525981, -88.78052230520693, -388.78424774644685, -812.3105800334262, -709.3473914501526, -1173.4882199184767, -1164.2913484173453, -1117.4026929458316, -1071.34545665432, -1356.9436623254803, -1340.37580714009], "episode_lengths": [124, 145, 150, 150, 139, 100, 128, 62, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 142, 150, 64, 68, 150, 105, 150, 150, 150, 150, 150, 56, 150, 150, 105, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 79, 150, 150, 41, 150, 150, 150, 150, 150, 121, 150, 88, 150, 150, 150, 89, 76, 150, 150, 150, 85, 150, 150, 150, 150, 131, 63, 150, 150, 150, 150, 150, 150, 54, 150, 150, 67, 150, 150, 150, 107, 103, 150, 150, 61, 94, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-645.753784630657, -777.9677270975601, -671.6936139777042, -399.6129007664049, -737.806138376526, -296.16865378058424, -570.1357392570485, -203.04883101038686, -1116.7071062086188, -1050.2602843154832, -1118.3329599487397, -950.6338012139397, -395.157707821413, -867.852262746764, -160.94663641214677, -1111.4900005737081, -1164.0153562526648, -1034.6091795025443, -657.6661638662669, -993.270170132846, -221.3224343410771, -70.72942345934472, -1162.2178290081497, -277.97713419673056, -1248.6174154925714, -1257.129766261066, -1363.8494068919035, -1186.4320511167737, -1163.7711970141006, -57.08245626740526, -1012.3453668996398, -551.8407895238852, -383.4122716253187, -1006.9995107444099, -1066.181477645523, -333.87431075606474, -687.9861452154402, -1024.4614846138918, -1327.7662347922806, -994.0765919648409, -983.369360246276, -966.2172327186403, -776.1733958505046, -1157.0262220294865, -1126.090961743803, -154.51755416348288, -130.07987826980676, -888.1907524371271, -1300.3527229494307, -37.91765441203565, -1010.1763361417493, -1212.36908834673, -864.3526690535177, -1358.4271163567087, -1372.1653934305823, -507.8538746524527, -577.8027199627917, -301.1683689483443, -1048.7160893614403, -597.0800408027767, -1238.615466117659, -245.74736432674266, -273.32572900803353, -1381.0352417100382, -1085.9972546564964, -1118.1527810698735, -167.75146317794454, -1113.9908835555932, -1292.242148486787, -658.9530289974989, -1033.0192704613255, -353.5950869468139, -203.4642138456281, -784.4803056039067, -909.0889942873188, -967.5577406860881, -607.9447829291228, -1239.4324106040897, -1153.591276348054, -58.2917183969968, -898.2845856256317, -1112.2664285845876, -172.27470474227064, -817.9805979909092, -852.4407281105555, -1209.0618820604204, -248.2196337773056, -207.51091135900225, -872.7134035490712, -814.019669525981, -88.78052230520693, -388.78424774644685, -812.3105800334262, -709.3473914501526, -1173.4882199184767, -1164.2913484173453, -1117.4026929458316, -1071.34545665432, -1356.9436623254803, -1340.37580714009]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5590509884020674, "mean_inference_ms": 1.6768986782277144, "mean_action_processing_ms": 0.27828845656109147, "mean_env_wait_ms": 3.471866072992066, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012551307678222656, "StateBufferConnector_ms": 0.00824284553527832, "ViewRequirementAgentConnector_ms": 0.19187307357788086}, "num_episodes": 29, "episode_return_max": -37.91765441203565, "episode_return_min": -1381.0352417100382, "episode_return_mean": -800.0536938307864, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.6546597542246, "num_env_steps_trained_throughput_per_sec": 312.6546597542246, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12822.786, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12822.711, "sample_time_ms": 1131.698, "learn_time_ms": 11624.023, "learn_throughput": 344.115, "synch_weights_time_ms": 66.196}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00004", "date": "2024-08-04_05-51-27", "timestamp": 1722730887, "time_this_iter_s": 12.807092666625977, "time_total_s": 102.6833336353302, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5f5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.6833336353302, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.33888888888889, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.942484749356906, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.036593533555667, "policy_loss": -0.01249196548111892, "vf_loss": 9.045552470783393, "vf_explained_var": 0.5106588445603848, "kl": 0.017228448825032206, "entropy": 1.6355471339076757, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -21.91672655818593, "episode_reward_min": -1381.0352417100382, "episode_reward_mean": -788.4011471194832, "episode_len_mean": 132.66, "episode_media": {}, "episodes_timesteps_total": 13266, "policy_reward_min": {"policy_0": -1381.0352417100382}, "policy_reward_max": {"policy_0": -21.91672655818593}, "policy_reward_mean": {"policy_0": -788.4011471194832}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1163.7711970141006, -57.08245626740526, -1012.3453668996398, -551.8407895238852, -383.4122716253187, -1006.9995107444099, -1066.181477645523, -333.87431075606474, -687.9861452154402, -1024.4614846138918, -1327.7662347922806, -994.0765919648409, -983.369360246276, -966.2172327186403, -776.1733958505046, -1157.0262220294865, -1126.090961743803, -154.51755416348288, -130.07987826980676, -888.1907524371271, -1300.3527229494307, -37.91765441203565, -1010.1763361417493, -1212.36908834673, -864.3526690535177, -1358.4271163567087, -1372.1653934305823, -507.8538746524527, -577.8027199627917, -301.1683689483443, -1048.7160893614403, -597.0800408027767, -1238.615466117659, -245.74736432674266, -273.32572900803353, -1381.0352417100382, -1085.9972546564964, -1118.1527810698735, -167.75146317794454, -1113.9908835555932, -1292.242148486787, -658.9530289974989, -1033.0192704613255, -353.5950869468139, -203.4642138456281, -784.4803056039067, -909.0889942873188, -967.5577406860881, -607.9447829291228, -1239.4324106040897, -1153.591276348054, -58.2917183969968, -898.2845856256317, -1112.2664285845876, -172.27470474227064, -817.9805979909092, -852.4407281105555, -1209.0618820604204, -248.2196337773056, -207.51091135900225, -872.7134035490712, -814.019669525981, -88.78052230520693, -388.78424774644685, -812.3105800334262, -709.3473914501526, -1173.4882199184767, -1164.2913484173453, -1117.4026929458316, -1071.34545665432, -1356.9436623254803, -1340.37580714009, -564.4027202492534, -215.23595644804837, -483.71784270714596, -469.41302222432114, -43.356153618202356, -918.2087101661782, -1213.338433062009, -526.693819083362, -1268.8930223381878, -1223.8402823092006, -1095.9138052956846, -811.7090177726825, -1314.760035287184, -625.6850473059587, -449.7262175493925, -21.91672655818593, -454.42813807627533, -1216.233620931949, -838.8843630932643, -885.3687665935649, -1363.3708404214703, -370.4773032740371, -208.36487349263408, -862.3309248372242, -357.17040358749966, -1213.7243149907856, -562.4234036050892, -966.5620426505251], "episode_lengths": [150, 56, 150, 150, 105, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 79, 150, 150, 41, 150, 150, 150, 150, 150, 121, 150, 88, 150, 150, 150, 89, 76, 150, 150, 150, 85, 150, 150, 150, 150, 131, 63, 150, 150, 150, 150, 150, 150, 54, 150, 150, 67, 150, 150, 150, 107, 103, 150, 150, 61, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 109, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 39, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 147, 150], "policy_policy_0_reward": [-1163.7711970141006, -57.08245626740526, -1012.3453668996398, -551.8407895238852, -383.4122716253187, -1006.9995107444099, -1066.181477645523, -333.87431075606474, -687.9861452154402, -1024.4614846138918, -1327.7662347922806, -994.0765919648409, -983.369360246276, -966.2172327186403, -776.1733958505046, -1157.0262220294865, -1126.090961743803, -154.51755416348288, -130.07987826980676, -888.1907524371271, -1300.3527229494307, -37.91765441203565, -1010.1763361417493, -1212.36908834673, -864.3526690535177, -1358.4271163567087, -1372.1653934305823, -507.8538746524527, -577.8027199627917, -301.1683689483443, -1048.7160893614403, -597.0800408027767, -1238.615466117659, -245.74736432674266, -273.32572900803353, -1381.0352417100382, -1085.9972546564964, -1118.1527810698735, -167.75146317794454, -1113.9908835555932, -1292.242148486787, -658.9530289974989, -1033.0192704613255, -353.5950869468139, -203.4642138456281, -784.4803056039067, -909.0889942873188, -967.5577406860881, -607.9447829291228, -1239.4324106040897, -1153.591276348054, -58.2917183969968, -898.2845856256317, -1112.2664285845876, -172.27470474227064, -817.9805979909092, -852.4407281105555, -1209.0618820604204, -248.2196337773056, -207.51091135900225, -872.7134035490712, -814.019669525981, -88.78052230520693, -388.78424774644685, -812.3105800334262, -709.3473914501526, -1173.4882199184767, -1164.2913484173453, -1117.4026929458316, -1071.34545665432, -1356.9436623254803, -1340.37580714009, -564.4027202492534, -215.23595644804837, -483.71784270714596, -469.41302222432114, -43.356153618202356, -918.2087101661782, -1213.338433062009, -526.693819083362, -1268.8930223381878, -1223.8402823092006, -1095.9138052956846, -811.7090177726825, -1314.760035287184, -625.6850473059587, -449.7262175493925, -21.91672655818593, -454.42813807627533, -1216.233620931949, -838.8843630932643, -885.3687665935649, -1363.3708404214703, -370.4773032740371, -208.36487349263408, -862.3309248372242, -357.17040358749966, -1213.7243149907856, -562.4234036050892, -966.5620426505251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5576310511916528, "mean_inference_ms": 1.675396050584026, "mean_action_processing_ms": 0.2776412021863414, "mean_env_wait_ms": 3.4778958304774936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012621641159057617, "StateBufferConnector_ms": 0.008100032806396484, "ViewRequirementAgentConnector_ms": 0.1922605037689209}, "num_episodes": 28, "episode_return_max": -21.91672655818593, "episode_return_min": -1381.0352417100382, "episode_return_mean": -788.4011471194832, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.7895781688759, "num_env_steps_trained_throughput_per_sec": 303.7895781688759, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12861.035, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12860.959, "sample_time_ms": 1128.873, "learn_time_ms": 11665.129, "learn_throughput": 342.902, "synch_weights_time_ms": 66.166}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00004", "date": "2024-08-04_05-51-40", "timestamp": 1722730900, "time_this_iter_s": 13.179285526275635, "time_total_s": 115.86261916160583, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0ae320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.86261916160583, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.810526315789474, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.015642376368245, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.110596670210361, "policy_loss": -0.010885353429087748, "vf_loss": 9.118418429295222, "vf_explained_var": 0.4685895914832751, "kl": 0.015744500001149703, "entropy": 1.6597450509667397, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -21.91672655818593, "episode_reward_min": -1381.0352417100382, "episode_reward_mean": -790.2847344992302, "episode_len_mean": 135.53, "episode_media": {}, "episodes_timesteps_total": 13553, "policy_reward_min": {"policy_0": -1381.0352417100382}, "policy_reward_max": {"policy_0": -21.91672655818593}, "policy_reward_mean": {"policy_0": -790.2847344992302}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-507.8538746524527, -577.8027199627917, -301.1683689483443, -1048.7160893614403, -597.0800408027767, -1238.615466117659, -245.74736432674266, -273.32572900803353, -1381.0352417100382, -1085.9972546564964, -1118.1527810698735, -167.75146317794454, -1113.9908835555932, -1292.242148486787, -658.9530289974989, -1033.0192704613255, -353.5950869468139, -203.4642138456281, -784.4803056039067, -909.0889942873188, -967.5577406860881, -607.9447829291228, -1239.4324106040897, -1153.591276348054, -58.2917183969968, -898.2845856256317, -1112.2664285845876, -172.27470474227064, -817.9805979909092, -852.4407281105555, -1209.0618820604204, -248.2196337773056, -207.51091135900225, -872.7134035490712, -814.019669525981, -88.78052230520693, -388.78424774644685, -812.3105800334262, -709.3473914501526, -1173.4882199184767, -1164.2913484173453, -1117.4026929458316, -1071.34545665432, -1356.9436623254803, -1340.37580714009, -564.4027202492534, -215.23595644804837, -483.71784270714596, -469.41302222432114, -43.356153618202356, -918.2087101661782, -1213.338433062009, -526.693819083362, -1268.8930223381878, -1223.8402823092006, -1095.9138052956846, -811.7090177726825, -1314.760035287184, -625.6850473059587, -449.7262175493925, -21.91672655818593, -454.42813807627533, -1216.233620931949, -838.8843630932643, -885.3687665935649, -1363.3708404214703, -370.4773032740371, -208.36487349263408, -862.3309248372242, -357.17040358749966, -1213.7243149907856, -562.4234036050892, -966.5620426505251, -1040.6424917600707, -1297.804966038191, -905.1473122402392, -874.3138480334403, -634.2011941059599, -472.5353652704549, -859.4212142898663, -1154.3714587535412, -793.0115202781838, -814.1589138266702, -588.9328222612833, -914.1818070975646, -1192.4967321332451, -239.0224468018882, -1133.0359398721696, -282.02694034897877, -449.8833461749488, -1093.4685946890424, -825.3360777197921, -1188.1910389950467, -742.2240589848919, -1160.6864135362434, -1216.3452696936922, -1126.6451562202496, -362.9882667416205, -834.5159482503351, -939.9937690697617], "episode_lengths": [121, 150, 88, 150, 150, 150, 89, 76, 150, 150, 150, 85, 150, 150, 150, 150, 131, 63, 150, 150, 150, 150, 150, 150, 54, 150, 150, 67, 150, 150, 150, 107, 103, 150, 150, 61, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 109, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 39, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 92, 95, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150], "policy_policy_0_reward": [-507.8538746524527, -577.8027199627917, -301.1683689483443, -1048.7160893614403, -597.0800408027767, -1238.615466117659, -245.74736432674266, -273.32572900803353, -1381.0352417100382, -1085.9972546564964, -1118.1527810698735, -167.75146317794454, -1113.9908835555932, -1292.242148486787, -658.9530289974989, -1033.0192704613255, -353.5950869468139, -203.4642138456281, -784.4803056039067, -909.0889942873188, -967.5577406860881, -607.9447829291228, -1239.4324106040897, -1153.591276348054, -58.2917183969968, -898.2845856256317, -1112.2664285845876, -172.27470474227064, -817.9805979909092, -852.4407281105555, -1209.0618820604204, -248.2196337773056, -207.51091135900225, -872.7134035490712, -814.019669525981, -88.78052230520693, -388.78424774644685, -812.3105800334262, -709.3473914501526, -1173.4882199184767, -1164.2913484173453, -1117.4026929458316, -1071.34545665432, -1356.9436623254803, -1340.37580714009, -564.4027202492534, -215.23595644804837, -483.71784270714596, -469.41302222432114, -43.356153618202356, -918.2087101661782, -1213.338433062009, -526.693819083362, -1268.8930223381878, -1223.8402823092006, -1095.9138052956846, -811.7090177726825, -1314.760035287184, -625.6850473059587, -449.7262175493925, -21.91672655818593, -454.42813807627533, -1216.233620931949, -838.8843630932643, -885.3687665935649, -1363.3708404214703, -370.4773032740371, -208.36487349263408, -862.3309248372242, -357.17040358749966, -1213.7243149907856, -562.4234036050892, -966.5620426505251, -1040.6424917600707, -1297.804966038191, -905.1473122402392, -874.3138480334403, -634.2011941059599, -472.5353652704549, -859.4212142898663, -1154.3714587535412, -793.0115202781838, -814.1589138266702, -588.9328222612833, -914.1818070975646, -1192.4967321332451, -239.0224468018882, -1133.0359398721696, -282.02694034897877, -449.8833461749488, -1093.4685946890424, -825.3360777197921, -1188.1910389950467, -742.2240589848919, -1160.6864135362434, -1216.3452696936922, -1126.6451562202496, -362.9882667416205, -834.5159482503351, -939.9937690697617]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5565160415265544, "mean_inference_ms": 1.6734850532652161, "mean_action_processing_ms": 0.27698171505343067, "mean_env_wait_ms": 3.485452647407609, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012405872344970703, "StateBufferConnector_ms": 0.007959842681884766, "ViewRequirementAgentConnector_ms": 0.19114947319030762}, "num_episodes": 27, "episode_return_max": -21.91672655818593, "episode_return_min": -1381.0352417100382, "episode_return_mean": -790.2847344992302, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.01074425797697, "num_env_steps_trained_throughput_per_sec": 302.01074425797697, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12899.388, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12899.314, "sample_time_ms": 1129.606, "learn_time_ms": 11702.635, "learn_throughput": 341.803, "synch_weights_time_ms": 66.266}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00004", "date": "2024-08-04_05-51-53", "timestamp": 1722730913, "time_this_iter_s": 13.255243062973022, "time_total_s": 129.11786222457886, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f67eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 129.11786222457886, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.022222222222222, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.483284465720256, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.307663120826085, "policy_loss": -0.015760160088636135, "vf_loss": 8.318823976814747, "vf_explained_var": 0.4962772245829304, "kl": 0.020714352934373903, "entropy": 1.6150464019427697, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -21.91672655818593, "episode_reward_min": -1363.3708404214703, "episode_reward_mean": -802.4884696631879, "episode_len_mean": 138.08, "episode_media": {}, "episodes_timesteps_total": 13808, "policy_reward_min": {"policy_0": -1363.3708404214703}, "policy_reward_max": {"policy_0": -21.91672655818593}, "policy_reward_mean": {"policy_0": -802.4884696631879}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1209.0618820604204, -248.2196337773056, -207.51091135900225, -872.7134035490712, -814.019669525981, -88.78052230520693, -388.78424774644685, -812.3105800334262, -709.3473914501526, -1173.4882199184767, -1164.2913484173453, -1117.4026929458316, -1071.34545665432, -1356.9436623254803, -1340.37580714009, -564.4027202492534, -215.23595644804837, -483.71784270714596, -469.41302222432114, -43.356153618202356, -918.2087101661782, -1213.338433062009, -526.693819083362, -1268.8930223381878, -1223.8402823092006, -1095.9138052956846, -811.7090177726825, -1314.760035287184, -625.6850473059587, -449.7262175493925, -21.91672655818593, -454.42813807627533, -1216.233620931949, -838.8843630932643, -885.3687665935649, -1363.3708404214703, -370.4773032740371, -208.36487349263408, -862.3309248372242, -357.17040358749966, -1213.7243149907856, -562.4234036050892, -966.5620426505251, -1040.6424917600707, -1297.804966038191, -905.1473122402392, -874.3138480334403, -634.2011941059599, -472.5353652704549, -859.4212142898663, -1154.3714587535412, -793.0115202781838, -814.1589138266702, -588.9328222612833, -914.1818070975646, -1192.4967321332451, -239.0224468018882, -1133.0359398721696, -282.02694034897877, -449.8833461749488, -1093.4685946890424, -825.3360777197921, -1188.1910389950467, -742.2240589848919, -1160.6864135362434, -1216.3452696936922, -1126.6451562202496, -362.9882667416205, -834.5159482503351, -939.9937690697617, -711.8095253833633, -918.3834918847379, -1264.8435082085575, -1115.4400642177197, -973.5545818652716, -1139.879609077863, -886.1702322598975, -1264.3821756453256, -377.90724062283294, -940.4615003923589, -636.8110004426169, -268.62997485677386, -1280.3587093518709, -51.03025682976688, -529.6252220587332, -775.7248651616152, -1019.8138028902104, -961.9758407968909, -272.00798235079174, -537.2697137533861, -755.2966062970162, -400.1627865064076, -644.0705442596626, -1105.937868598831, -1330.6372644748913, -1171.575853765016, -1112.5363054043974, -569.0729373130577, -211.313111740126, -765.8362399835565], "episode_lengths": [150, 107, 103, 150, 150, 61, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 74, 109, 150, 47, 150, 150, 150, 150, 150, 150, 150, 150, 117, 150, 39, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 92, 95, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 137, 150, 150, 45, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150], "policy_policy_0_reward": [-1209.0618820604204, -248.2196337773056, -207.51091135900225, -872.7134035490712, -814.019669525981, -88.78052230520693, -388.78424774644685, -812.3105800334262, -709.3473914501526, -1173.4882199184767, -1164.2913484173453, -1117.4026929458316, -1071.34545665432, -1356.9436623254803, -1340.37580714009, -564.4027202492534, -215.23595644804837, -483.71784270714596, -469.41302222432114, -43.356153618202356, -918.2087101661782, -1213.338433062009, -526.693819083362, -1268.8930223381878, -1223.8402823092006, -1095.9138052956846, -811.7090177726825, -1314.760035287184, -625.6850473059587, -449.7262175493925, -21.91672655818593, -454.42813807627533, -1216.233620931949, -838.8843630932643, -885.3687665935649, -1363.3708404214703, -370.4773032740371, -208.36487349263408, -862.3309248372242, -357.17040358749966, -1213.7243149907856, -562.4234036050892, -966.5620426505251, -1040.6424917600707, -1297.804966038191, -905.1473122402392, -874.3138480334403, -634.2011941059599, -472.5353652704549, -859.4212142898663, -1154.3714587535412, -793.0115202781838, -814.1589138266702, -588.9328222612833, -914.1818070975646, -1192.4967321332451, -239.0224468018882, -1133.0359398721696, -282.02694034897877, -449.8833461749488, -1093.4685946890424, -825.3360777197921, -1188.1910389950467, -742.2240589848919, -1160.6864135362434, -1216.3452696936922, -1126.6451562202496, -362.9882667416205, -834.5159482503351, -939.9937690697617, -711.8095253833633, -918.3834918847379, -1264.8435082085575, -1115.4400642177197, -973.5545818652716, -1139.879609077863, -886.1702322598975, -1264.3821756453256, -377.90724062283294, -940.4615003923589, -636.8110004426169, -268.62997485677386, -1280.3587093518709, -51.03025682976688, -529.6252220587332, -775.7248651616152, -1019.8138028902104, -961.9758407968909, -272.00798235079174, -537.2697137533861, -755.2966062970162, -400.1627865064076, -644.0705442596626, -1105.937868598831, -1330.6372644748913, -1171.575853765016, -1112.5363054043974, -569.0729373130577, -211.313111740126, -765.8362399835565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552465693897999, "mean_inference_ms": 1.673423165872799, "mean_action_processing_ms": 0.2765333749214064, "mean_env_wait_ms": 3.4922485124144966, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01256561279296875, "StateBufferConnector_ms": 0.007903575897216797, "ViewRequirementAgentConnector_ms": 0.1888570785522461}, "num_episodes": 30, "episode_return_max": -21.91672655818593, "episode_return_min": -1363.3708404214703, "episode_return_mean": -802.4884696631879, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.62038379561466, "num_env_steps_trained_throughput_per_sec": 306.62038379561466, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12913.99, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12913.916, "sample_time_ms": 1135.027, "learn_time_ms": 11711.147, "learn_throughput": 341.555, "synch_weights_time_ms": 66.927}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00004", "date": "2024-08-04_05-52-06", "timestamp": 1722730926, "time_this_iter_s": 13.056933403015137, "time_total_s": 142.174795627594, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a5900>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 142.174795627594, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.710526315789473, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 14.295573290189107, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.649734841783841, "policy_loss": -0.01242457242818394, "vf_loss": 8.657337008913357, "vf_explained_var": 0.5993723939483364, "kl": 0.014604305047335718, "entropy": 1.7495291441679002, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -21.91672655818593, "episode_reward_min": -1363.3708404214703, "episode_reward_mean": -799.3502113766498, "episode_len_mean": 138.93, "episode_media": {}, "episodes_timesteps_total": 13893, "policy_reward_min": {"policy_0": -1363.3708404214703}, "policy_reward_max": {"policy_0": -21.91672655818593}, "policy_reward_mean": {"policy_0": -799.3502113766498}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-625.6850473059587, -449.7262175493925, -21.91672655818593, -454.42813807627533, -1216.233620931949, -838.8843630932643, -885.3687665935649, -1363.3708404214703, -370.4773032740371, -208.36487349263408, -862.3309248372242, -357.17040358749966, -1213.7243149907856, -562.4234036050892, -966.5620426505251, -1040.6424917600707, -1297.804966038191, -905.1473122402392, -874.3138480334403, -634.2011941059599, -472.5353652704549, -859.4212142898663, -1154.3714587535412, -793.0115202781838, -814.1589138266702, -588.9328222612833, -914.1818070975646, -1192.4967321332451, -239.0224468018882, -1133.0359398721696, -282.02694034897877, -449.8833461749488, -1093.4685946890424, -825.3360777197921, -1188.1910389950467, -742.2240589848919, -1160.6864135362434, -1216.3452696936922, -1126.6451562202496, -362.9882667416205, -834.5159482503351, -939.9937690697617, -711.8095253833633, -918.3834918847379, -1264.8435082085575, -1115.4400642177197, -973.5545818652716, -1139.879609077863, -886.1702322598975, -1264.3821756453256, -377.90724062283294, -940.4615003923589, -636.8110004426169, -268.62997485677386, -1280.3587093518709, -51.03025682976688, -529.6252220587332, -775.7248651616152, -1019.8138028902104, -961.9758407968909, -272.00798235079174, -537.2697137533861, -755.2966062970162, -400.1627865064076, -644.0705442596626, -1105.937868598831, -1330.6372644748913, -1171.575853765016, -1112.5363054043974, -569.0729373130577, -211.313111740126, -765.8362399835565, -1346.1924333984102, -721.7165753874153, -83.53363586962699, -993.2024242117727, -127.68496783991506, -1152.8500143650244, -1056.790254270939, -1075.4567105194935, -872.3704687144667, -375.11763909460825, -720.6861230781083, -142.11576834839565, -1182.662968411946, -938.1798191422606, -716.0837277360216, -987.909181762163, -900.7842322722174, -915.3004782515021, -261.26962859872015, -518.1889140836098, -874.7795221699113, -1029.2397211203086, -831.6096211928617, -1222.15995682239, -1277.4757431170226, -1138.0136725617824, -917.460236935086, -31.417981840215546], "episode_lengths": [117, 150, 39, 150, 150, 150, 150, 150, 150, 62, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 150, 92, 95, 150, 150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 137, 150, 150, 45, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 50, 150, 69, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51], "policy_policy_0_reward": [-625.6850473059587, -449.7262175493925, -21.91672655818593, -454.42813807627533, -1216.233620931949, -838.8843630932643, -885.3687665935649, -1363.3708404214703, -370.4773032740371, -208.36487349263408, -862.3309248372242, -357.17040358749966, -1213.7243149907856, -562.4234036050892, -966.5620426505251, -1040.6424917600707, -1297.804966038191, -905.1473122402392, -874.3138480334403, -634.2011941059599, -472.5353652704549, -859.4212142898663, -1154.3714587535412, -793.0115202781838, -814.1589138266702, -588.9328222612833, -914.1818070975646, -1192.4967321332451, -239.0224468018882, -1133.0359398721696, -282.02694034897877, -449.8833461749488, -1093.4685946890424, -825.3360777197921, -1188.1910389950467, -742.2240589848919, -1160.6864135362434, -1216.3452696936922, -1126.6451562202496, -362.9882667416205, -834.5159482503351, -939.9937690697617, -711.8095253833633, -918.3834918847379, -1264.8435082085575, -1115.4400642177197, -973.5545818652716, -1139.879609077863, -886.1702322598975, -1264.3821756453256, -377.90724062283294, -940.4615003923589, -636.8110004426169, -268.62997485677386, -1280.3587093518709, -51.03025682976688, -529.6252220587332, -775.7248651616152, -1019.8138028902104, -961.9758407968909, -272.00798235079174, -537.2697137533861, -755.2966062970162, -400.1627865064076, -644.0705442596626, -1105.937868598831, -1330.6372644748913, -1171.575853765016, -1112.5363054043974, -569.0729373130577, -211.313111740126, -765.8362399835565, -1346.1924333984102, -721.7165753874153, -83.53363586962699, -993.2024242117727, -127.68496783991506, -1152.8500143650244, -1056.790254270939, -1075.4567105194935, -872.3704687144667, -375.11763909460825, -720.6861230781083, -142.11576834839565, -1182.662968411946, -938.1798191422606, -716.0837277360216, -987.909181762163, -900.7842322722174, -915.3004782515021, -261.26962859872015, -518.1889140836098, -874.7795221699113, -1029.2397211203086, -831.6096211928617, -1222.15995682239, -1277.4757431170226, -1138.0136725617824, -917.460236935086, -31.417981840215546]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551320649095665, "mean_inference_ms": 1.6732890386158759, "mean_action_processing_ms": 0.2758849451998043, "mean_env_wait_ms": 3.4963057246451283, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01227426528930664, "StateBufferConnector_ms": 0.007962703704833984, "ViewRequirementAgentConnector_ms": 0.1904768943786621}, "num_episodes": 28, "episode_return_max": -21.91672655818593, "episode_return_min": -1363.3708404214703, "episode_return_mean": -799.3502113766498, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 337.629404407624, "num_env_steps_trained_throughput_per_sec": 337.629404407624, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12885.185, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12885.11, "sample_time_ms": 1135.854, "learn_time_ms": 11681.602, "learn_throughput": 342.419, "synch_weights_time_ms": 66.828}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00004", "date": "2024-08-04_05-52-18", "timestamp": 1722730938, "time_this_iter_s": 11.859418153762817, "time_total_s": 154.0342137813568, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a6200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 154.0342137813568, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.69411764705882, "ram_util_percent": 27.9235294117647}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.508444885412853, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.547646063566209, "policy_loss": -0.01085570339152279, "vf_loss": 8.553286748627821, "vf_explained_var": 0.6758254686370492, "kl": 0.015376678075745076, "entropy": 1.704497248803576, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -31.417981840215546, "episode_reward_min": -1368.3631722860468, "episode_reward_mean": -816.5355019343865, "episode_len_mean": 138.35, "episode_media": {}, "episodes_timesteps_total": 13835, "policy_reward_min": {"policy_0": -1368.3631722860468}, "policy_reward_max": {"policy_0": -31.417981840215546}, "policy_reward_mean": {"policy_0": -816.5355019343865}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-825.3360777197921, -1188.1910389950467, -742.2240589848919, -1160.6864135362434, -1216.3452696936922, -1126.6451562202496, -362.9882667416205, -834.5159482503351, -939.9937690697617, -711.8095253833633, -918.3834918847379, -1264.8435082085575, -1115.4400642177197, -973.5545818652716, -1139.879609077863, -886.1702322598975, -1264.3821756453256, -377.90724062283294, -940.4615003923589, -636.8110004426169, -268.62997485677386, -1280.3587093518709, -51.03025682976688, -529.6252220587332, -775.7248651616152, -1019.8138028902104, -961.9758407968909, -272.00798235079174, -537.2697137533861, -755.2966062970162, -400.1627865064076, -644.0705442596626, -1105.937868598831, -1330.6372644748913, -1171.575853765016, -1112.5363054043974, -569.0729373130577, -211.313111740126, -765.8362399835565, -1346.1924333984102, -721.7165753874153, -83.53363586962699, -993.2024242117727, -127.68496783991506, -1152.8500143650244, -1056.790254270939, -1075.4567105194935, -872.3704687144667, -375.11763909460825, -720.6861230781083, -142.11576834839565, -1182.662968411946, -938.1798191422606, -716.0837277360216, -987.909181762163, -900.7842322722174, -915.3004782515021, -261.26962859872015, -518.1889140836098, -874.7795221699113, -1029.2397211203086, -831.6096211928617, -1222.15995682239, -1277.4757431170226, -1138.0136725617824, -917.460236935086, -31.417981840215546, -551.5723010624502, -1044.7815066815076, -596.3544769319897, -1038.0296043860562, -1048.5361278005696, -835.4274997649711, -883.418009919346, -138.1341418088698, -999.9814765751507, -732.8702612648283, -873.9820297345206, -76.9020846516301, -70.1059127932577, -961.1963054737137, -1294.8525629307323, -207.1984395022197, -1122.7511148092494, -1044.2832869123613, -1184.3820452521604, -739.9812887091056, -1056.6226507469175, -294.8309298736717, -1284.4879708379644, -337.22534607621685, -807.7421692610952, -1042.2952092254234, -209.75716424267296, -1253.9763256633257, -1139.4012921911512, -1368.3631722860468, -1050.0642468497838, -1180.8132234436455, -383.5327790546795], "episode_lengths": [150, 150, 150, 150, 150, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 92, 150, 137, 150, 150, 45, 150, 150, 150, 150, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 50, 150, 69, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 150, 150, 112, 150, 150, 150, 150, 72, 150, 150, 150, 54, 44, 150, 150, 75, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144], "policy_policy_0_reward": [-825.3360777197921, -1188.1910389950467, -742.2240589848919, -1160.6864135362434, -1216.3452696936922, -1126.6451562202496, -362.9882667416205, -834.5159482503351, -939.9937690697617, -711.8095253833633, -918.3834918847379, -1264.8435082085575, -1115.4400642177197, -973.5545818652716, -1139.879609077863, -886.1702322598975, -1264.3821756453256, -377.90724062283294, -940.4615003923589, -636.8110004426169, -268.62997485677386, -1280.3587093518709, -51.03025682976688, -529.6252220587332, -775.7248651616152, -1019.8138028902104, -961.9758407968909, -272.00798235079174, -537.2697137533861, -755.2966062970162, -400.1627865064076, -644.0705442596626, -1105.937868598831, -1330.6372644748913, -1171.575853765016, -1112.5363054043974, -569.0729373130577, -211.313111740126, -765.8362399835565, -1346.1924333984102, -721.7165753874153, -83.53363586962699, -993.2024242117727, -127.68496783991506, -1152.8500143650244, -1056.790254270939, -1075.4567105194935, -872.3704687144667, -375.11763909460825, -720.6861230781083, -142.11576834839565, -1182.662968411946, -938.1798191422606, -716.0837277360216, -987.909181762163, -900.7842322722174, -915.3004782515021, -261.26962859872015, -518.1889140836098, -874.7795221699113, -1029.2397211203086, -831.6096211928617, -1222.15995682239, -1277.4757431170226, -1138.0136725617824, -917.460236935086, -31.417981840215546, -551.5723010624502, -1044.7815066815076, -596.3544769319897, -1038.0296043860562, -1048.5361278005696, -835.4274997649711, -883.418009919346, -138.1341418088698, -999.9814765751507, -732.8702612648283, -873.9820297345206, -76.9020846516301, -70.1059127932577, -961.1963054737137, -1294.8525629307323, -207.1984395022197, -1122.7511148092494, -1044.2832869123613, -1184.3820452521604, -739.9812887091056, -1056.6226507469175, -294.8309298736717, -1284.4879708379644, -337.22534607621685, -807.7421692610952, -1042.2952092254234, -209.75716424267296, -1253.9763256633257, -1139.4012921911512, -1368.3631722860468, -1050.0642468497838, -1180.8132234436455, -383.5327790546795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5546483228041675, "mean_inference_ms": 1.6745696432427304, "mean_action_processing_ms": 0.2758320839337733, "mean_env_wait_ms": 3.503226174753581, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01232147216796875, "StateBufferConnector_ms": 0.008023977279663086, "ViewRequirementAgentConnector_ms": 0.19152402877807617}, "num_episodes": 33, "episode_return_max": -31.417981840215546, "episode_return_min": -1368.3631722860468, "episode_return_mean": -816.5355019343865, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.3228927958293, "num_env_steps_trained_throughput_per_sec": 322.3228927958293, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12832.422, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12832.35, "sample_time_ms": 1128.549, "learn_time_ms": 11635.723, "learn_throughput": 343.769, "synch_weights_time_ms": 67.26}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00004", "date": "2024-08-04_05-52-31", "timestamp": 1722730951, "time_this_iter_s": 12.422036409378052, "time_total_s": 166.45625019073486, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f67eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 166.45625019073486, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.111111111111114, "ram_util_percent": 27.98888888888889}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.11435094972452, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.566007327040037, "policy_loss": -0.006753306548732022, "vf_loss": 7.568705311914285, "vf_explained_var": 0.6561709944158792, "kl": 0.01269023810770403, "entropy": 1.6553024489432573, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -31.417981840215546, "episode_reward_min": -1368.3631722860468, "episode_reward_mean": -784.7629481758028, "episode_len_mean": 136.43, "episode_media": {}, "episodes_timesteps_total": 13643, "policy_reward_min": {"policy_0": -1368.3631722860468}, "policy_reward_max": {"policy_0": -31.417981840215546}, "policy_reward_mean": {"policy_0": -784.7629481758028}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-400.1627865064076, -644.0705442596626, -1105.937868598831, -1330.6372644748913, -1171.575853765016, -1112.5363054043974, -569.0729373130577, -211.313111740126, -765.8362399835565, -1346.1924333984102, -721.7165753874153, -83.53363586962699, -993.2024242117727, -127.68496783991506, -1152.8500143650244, -1056.790254270939, -1075.4567105194935, -872.3704687144667, -375.11763909460825, -720.6861230781083, -142.11576834839565, -1182.662968411946, -938.1798191422606, -716.0837277360216, -987.909181762163, -900.7842322722174, -915.3004782515021, -261.26962859872015, -518.1889140836098, -874.7795221699113, -1029.2397211203086, -831.6096211928617, -1222.15995682239, -1277.4757431170226, -1138.0136725617824, -917.460236935086, -31.417981840215546, -551.5723010624502, -1044.7815066815076, -596.3544769319897, -1038.0296043860562, -1048.5361278005696, -835.4274997649711, -883.418009919346, -138.1341418088698, -999.9814765751507, -732.8702612648283, -873.9820297345206, -76.9020846516301, -70.1059127932577, -961.1963054737137, -1294.8525629307323, -207.1984395022197, -1122.7511148092494, -1044.2832869123613, -1184.3820452521604, -739.9812887091056, -1056.6226507469175, -294.8309298736717, -1284.4879708379644, -337.22534607621685, -807.7421692610952, -1042.2952092254234, -209.75716424267296, -1253.9763256633257, -1139.4012921911512, -1368.3631722860468, -1050.0642468497838, -1180.8132234436455, -383.5327790546795, -776.6484344912642, -1339.1700120865617, -948.3505600778441, -193.85411937998774, -1086.5004907239352, -597.4204144746456, -1265.9300055520787, -1028.9345579042692, -545.2671075486887, -249.97805959741527, -530.978854718027, -382.27282123455046, -241.39637924164066, -670.2979064831691, -1282.8852126482384, -562.1664460478621, -273.91351814191063, -944.8597701663826, -534.5516890153256, -1076.8759899801614, -1157.7189180546266, -1322.0323982105442, -297.93146389480614, -243.9364723543232, -1344.5886452245609, -816.6644060343095, -202.60900980083258, -715.7209614003774, -796.942332420704, -470.649570791806], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 50, 150, 69, 150, 150, 150, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 150, 150, 112, 150, 150, 150, 150, 72, 150, 150, 150, 54, 44, 150, 150, 75, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 73, 150, 150, 150, 150, 150, 99, 150, 150, 121, 150, 150, 150, 72, 150, 150, 150, 150, 150, 85, 88, 150, 150, 69, 150, 150, 120], "policy_policy_0_reward": [-400.1627865064076, -644.0705442596626, -1105.937868598831, -1330.6372644748913, -1171.575853765016, -1112.5363054043974, -569.0729373130577, -211.313111740126, -765.8362399835565, -1346.1924333984102, -721.7165753874153, -83.53363586962699, -993.2024242117727, -127.68496783991506, -1152.8500143650244, -1056.790254270939, -1075.4567105194935, -872.3704687144667, -375.11763909460825, -720.6861230781083, -142.11576834839565, -1182.662968411946, -938.1798191422606, -716.0837277360216, -987.909181762163, -900.7842322722174, -915.3004782515021, -261.26962859872015, -518.1889140836098, -874.7795221699113, -1029.2397211203086, -831.6096211928617, -1222.15995682239, -1277.4757431170226, -1138.0136725617824, -917.460236935086, -31.417981840215546, -551.5723010624502, -1044.7815066815076, -596.3544769319897, -1038.0296043860562, -1048.5361278005696, -835.4274997649711, -883.418009919346, -138.1341418088698, -999.9814765751507, -732.8702612648283, -873.9820297345206, -76.9020846516301, -70.1059127932577, -961.1963054737137, -1294.8525629307323, -207.1984395022197, -1122.7511148092494, -1044.2832869123613, -1184.3820452521604, -739.9812887091056, -1056.6226507469175, -294.8309298736717, -1284.4879708379644, -337.22534607621685, -807.7421692610952, -1042.2952092254234, -209.75716424267296, -1253.9763256633257, -1139.4012921911512, -1368.3631722860468, -1050.0642468497838, -1180.8132234436455, -383.5327790546795, -776.6484344912642, -1339.1700120865617, -948.3505600778441, -193.85411937998774, -1086.5004907239352, -597.4204144746456, -1265.9300055520787, -1028.9345579042692, -545.2671075486887, -249.97805959741527, -530.978854718027, -382.27282123455046, -241.39637924164066, -670.2979064831691, -1282.8852126482384, -562.1664460478621, -273.91351814191063, -944.8597701663826, -534.5516890153256, -1076.8759899801614, -1157.7189180546266, -1322.0323982105442, -297.93146389480614, -243.9364723543232, -1344.5886452245609, -816.6644060343095, -202.60900980083258, -715.7209614003774, -796.942332420704, -470.649570791806]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553852669674763, "mean_inference_ms": 1.6730119190321435, "mean_action_processing_ms": 0.2750463511852214, "mean_env_wait_ms": 3.5015270823274336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011810541152954102, "StateBufferConnector_ms": 0.007963895797729492, "ViewRequirementAgentConnector_ms": 0.19131994247436523}, "num_episodes": 30, "episode_return_max": -31.417981840215546, "episode_return_min": -1368.3631722860468, "episode_return_mean": -784.7629481758028, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.04093552100124, "num_env_steps_trained_throughput_per_sec": 310.04093552100124, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12830.337, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12830.264, "sample_time_ms": 1130.5, "learn_time_ms": 11633.081, "learn_throughput": 343.847, "synch_weights_time_ms": 65.855}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00004", "date": "2024-08-04_05-52-44", "timestamp": 1722730964, "time_this_iter_s": 12.913321018218994, "time_total_s": 179.36957120895386, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc703e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 179.36957120895386, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.127777777777776, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.546505414197842, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.097338383893172, "policy_loss": -0.007399836050656934, "vf_loss": 8.101548162599405, "vf_explained_var": 0.6942616916572054, "kl": 0.010863364250508312, "entropy": 1.69848299510777, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -1.9202383151385638, "episode_reward_min": -1398.227663864548, "episode_reward_mean": -763.5363053636216, "episode_len_mean": 131.71, "episode_media": {}, "episodes_timesteps_total": 13171, "policy_reward_min": {"policy_0": -1398.227663864548}, "policy_reward_max": {"policy_0": -1.9202383151385638}, "policy_reward_mean": {"policy_0": -763.5363053636216}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-874.7795221699113, -1029.2397211203086, -831.6096211928617, -1222.15995682239, -1277.4757431170226, -1138.0136725617824, -917.460236935086, -31.417981840215546, -551.5723010624502, -1044.7815066815076, -596.3544769319897, -1038.0296043860562, -1048.5361278005696, -835.4274997649711, -883.418009919346, -138.1341418088698, -999.9814765751507, -732.8702612648283, -873.9820297345206, -76.9020846516301, -70.1059127932577, -961.1963054737137, -1294.8525629307323, -207.1984395022197, -1122.7511148092494, -1044.2832869123613, -1184.3820452521604, -739.9812887091056, -1056.6226507469175, -294.8309298736717, -1284.4879708379644, -337.22534607621685, -807.7421692610952, -1042.2952092254234, -209.75716424267296, -1253.9763256633257, -1139.4012921911512, -1368.3631722860468, -1050.0642468497838, -1180.8132234436455, -383.5327790546795, -776.6484344912642, -1339.1700120865617, -948.3505600778441, -193.85411937998774, -1086.5004907239352, -597.4204144746456, -1265.9300055520787, -1028.9345579042692, -545.2671075486887, -249.97805959741527, -530.978854718027, -382.27282123455046, -241.39637924164066, -670.2979064831691, -1282.8852126482384, -562.1664460478621, -273.91351814191063, -944.8597701663826, -534.5516890153256, -1076.8759899801614, -1157.7189180546266, -1322.0323982105442, -297.93146389480614, -243.9364723543232, -1344.5886452245609, -816.6644060343095, -202.60900980083258, -715.7209614003774, -796.942332420704, -470.649570791806, -1144.3831942739544, -127.97981212274073, -1303.1496038681234, -16.20910249018828, -251.74881932446965, -199.32101163672218, -91.79656606447797, -562.0748336160665, -726.1524289106576, -979.7559549663844, -1197.2206952030374, -652.9629255982067, -373.83566446546723, -824.6892195735985, -1137.707576756609, -1.9202383151385638, -878.133224846277, -1398.227663864548, -600.8063806058908, -1219.660692036998, -823.4576055172565, -1078.0952480138512, -818.298024603947, -1147.3182499521454, -97.6979134653971, -352.92125122985277, -703.0777483475806, -863.9863155286481, -703.9866309862184], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 51, 150, 150, 112, 150, 150, 150, 150, 72, 150, 150, 150, 54, 44, 150, 150, 75, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 73, 150, 150, 150, 150, 150, 99, 150, 150, 121, 150, 150, 150, 72, 150, 150, 150, 150, 150, 85, 88, 150, 150, 69, 150, 150, 120, 150, 58, 150, 40, 93, 61, 52, 150, 150, 150, 150, 119, 87, 150, 150, 36, 150, 150, 150, 150, 150, 150, 143, 150, 55, 113, 150, 150, 132], "policy_policy_0_reward": [-874.7795221699113, -1029.2397211203086, -831.6096211928617, -1222.15995682239, -1277.4757431170226, -1138.0136725617824, -917.460236935086, -31.417981840215546, -551.5723010624502, -1044.7815066815076, -596.3544769319897, -1038.0296043860562, -1048.5361278005696, -835.4274997649711, -883.418009919346, -138.1341418088698, -999.9814765751507, -732.8702612648283, -873.9820297345206, -76.9020846516301, -70.1059127932577, -961.1963054737137, -1294.8525629307323, -207.1984395022197, -1122.7511148092494, -1044.2832869123613, -1184.3820452521604, -739.9812887091056, -1056.6226507469175, -294.8309298736717, -1284.4879708379644, -337.22534607621685, -807.7421692610952, -1042.2952092254234, -209.75716424267296, -1253.9763256633257, -1139.4012921911512, -1368.3631722860468, -1050.0642468497838, -1180.8132234436455, -383.5327790546795, -776.6484344912642, -1339.1700120865617, -948.3505600778441, -193.85411937998774, -1086.5004907239352, -597.4204144746456, -1265.9300055520787, -1028.9345579042692, -545.2671075486887, -249.97805959741527, -530.978854718027, -382.27282123455046, -241.39637924164066, -670.2979064831691, -1282.8852126482384, -562.1664460478621, -273.91351814191063, -944.8597701663826, -534.5516890153256, -1076.8759899801614, -1157.7189180546266, -1322.0323982105442, -297.93146389480614, -243.9364723543232, -1344.5886452245609, -816.6644060343095, -202.60900980083258, -715.7209614003774, -796.942332420704, -470.649570791806, -1144.3831942739544, -127.97981212274073, -1303.1496038681234, -16.20910249018828, -251.74881932446965, -199.32101163672218, -91.79656606447797, -562.0748336160665, -726.1524289106576, -979.7559549663844, -1197.2206952030374, -652.9629255982067, -373.83566446546723, -824.6892195735985, -1137.707576756609, -1.9202383151385638, -878.133224846277, -1398.227663864548, -600.8063806058908, -1219.660692036998, -823.4576055172565, -1078.0952480138512, -818.298024603947, -1147.3182499521454, -97.6979134653971, -352.92125122985277, -703.0777483475806, -863.9863155286481, -703.9866309862184]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5535701581341056, "mean_inference_ms": 1.6717441193697566, "mean_action_processing_ms": 0.2748308456633393, "mean_env_wait_ms": 3.50555275709056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01217341423034668, "StateBufferConnector_ms": 0.007969379425048828, "ViewRequirementAgentConnector_ms": 0.1920781135559082}, "num_episodes": 29, "episode_return_max": -1.9202383151385638, "episode_return_min": -1398.227663864548, "episode_return_mean": -763.5363053636216, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.46906261978774, "num_env_steps_trained_throughput_per_sec": 310.46906261978774, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12816.79, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12816.718, "sample_time_ms": 1131.09, "learn_time_ms": 11618.652, "learn_throughput": 344.274, "synch_weights_time_ms": 66.148}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00004", "date": "2024-08-04_05-52-56", "timestamp": 1722730976, "time_this_iter_s": 12.895907878875732, "time_total_s": 192.2654790878296, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0af880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.2654790878296, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.155555555555555, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.02118054479361, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.1991538718342785, "policy_loss": -0.008635994925862178, "vf_loss": 7.203858246902625, "vf_explained_var": 0.7551271192108592, "kl": 0.012574056081469602, "entropy": 1.726705059533318, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -1.9202383151385638, "episode_reward_min": -1398.227663864548, "episode_reward_mean": -754.7837430256794, "episode_len_mean": 131.79, "episode_media": {}, "episodes_timesteps_total": 13179, "policy_reward_min": {"policy_0": -1398.227663864548}, "policy_reward_max": {"policy_0": -1.9202383151385638}, "policy_reward_mean": {"policy_0": -754.7837430256794}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1042.2952092254234, -209.75716424267296, -1253.9763256633257, -1139.4012921911512, -1368.3631722860468, -1050.0642468497838, -1180.8132234436455, -383.5327790546795, -776.6484344912642, -1339.1700120865617, -948.3505600778441, -193.85411937998774, -1086.5004907239352, -597.4204144746456, -1265.9300055520787, -1028.9345579042692, -545.2671075486887, -249.97805959741527, -530.978854718027, -382.27282123455046, -241.39637924164066, -670.2979064831691, -1282.8852126482384, -562.1664460478621, -273.91351814191063, -944.8597701663826, -534.5516890153256, -1076.8759899801614, -1157.7189180546266, -1322.0323982105442, -297.93146389480614, -243.9364723543232, -1344.5886452245609, -816.6644060343095, -202.60900980083258, -715.7209614003774, -796.942332420704, -470.649570791806, -1144.3831942739544, -127.97981212274073, -1303.1496038681234, -16.20910249018828, -251.74881932446965, -199.32101163672218, -91.79656606447797, -562.0748336160665, -726.1524289106576, -979.7559549663844, -1197.2206952030374, -652.9629255982067, -373.83566446546723, -824.6892195735985, -1137.707576756609, -1.9202383151385638, -878.133224846277, -1398.227663864548, -600.8063806058908, -1219.660692036998, -823.4576055172565, -1078.0952480138512, -818.298024603947, -1147.3182499521454, -97.6979134653971, -352.92125122985277, -703.0777483475806, -863.9863155286481, -703.9866309862184, -861.9389575526496, -1010.9282780680638, -325.4843145271943, -225.74081051875623, -1080.7896938554327, -594.299389301985, -1265.8392537408179, -1359.2952317681613, -1038.3932552758345, -756.9888258070329, -1043.0839216361119, -762.2990840189275, -962.7922611602994, -1294.3781303055903, -1380.0497634067567, -924.7044450793243, -530.6601530389548, -389.1101768293856, -423.35590496772767, -149.14221522241368, -289.01105744683616, -705.6993436445962, -67.88878701783594, -995.4495506517519, -1004.2938257223242, -1309.5789059978665, -1347.7133186378467, -151.43655972167184, -890.582079700467, -357.91449141161087, -700.8608322733538, -1245.2477060151452, -227.59924140319526], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 150, 73, 150, 150, 150, 150, 150, 99, 150, 150, 121, 150, 150, 150, 72, 150, 150, 150, 150, 150, 85, 88, 150, 150, 69, 150, 150, 120, 150, 58, 150, 40, 93, 61, 52, 150, 150, 150, 150, 119, 87, 150, 150, 36, 150, 150, 150, 150, 150, 150, 143, 150, 55, 113, 150, 150, 132, 150, 150, 89, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 56, 121, 150, 49, 150, 150, 150, 150, 67, 150, 150, 145, 150, 93], "policy_policy_0_reward": [-1042.2952092254234, -209.75716424267296, -1253.9763256633257, -1139.4012921911512, -1368.3631722860468, -1050.0642468497838, -1180.8132234436455, -383.5327790546795, -776.6484344912642, -1339.1700120865617, -948.3505600778441, -193.85411937998774, -1086.5004907239352, -597.4204144746456, -1265.9300055520787, -1028.9345579042692, -545.2671075486887, -249.97805959741527, -530.978854718027, -382.27282123455046, -241.39637924164066, -670.2979064831691, -1282.8852126482384, -562.1664460478621, -273.91351814191063, -944.8597701663826, -534.5516890153256, -1076.8759899801614, -1157.7189180546266, -1322.0323982105442, -297.93146389480614, -243.9364723543232, -1344.5886452245609, -816.6644060343095, -202.60900980083258, -715.7209614003774, -796.942332420704, -470.649570791806, -1144.3831942739544, -127.97981212274073, -1303.1496038681234, -16.20910249018828, -251.74881932446965, -199.32101163672218, -91.79656606447797, -562.0748336160665, -726.1524289106576, -979.7559549663844, -1197.2206952030374, -652.9629255982067, -373.83566446546723, -824.6892195735985, -1137.707576756609, -1.9202383151385638, -878.133224846277, -1398.227663864548, -600.8063806058908, -1219.660692036998, -823.4576055172565, -1078.0952480138512, -818.298024603947, -1147.3182499521454, -97.6979134653971, -352.92125122985277, -703.0777483475806, -863.9863155286481, -703.9866309862184, -861.9389575526496, -1010.9282780680638, -325.4843145271943, -225.74081051875623, -1080.7896938554327, -594.299389301985, -1265.8392537408179, -1359.2952317681613, -1038.3932552758345, -756.9888258070329, -1043.0839216361119, -762.2990840189275, -962.7922611602994, -1294.3781303055903, -1380.0497634067567, -924.7044450793243, -530.6601530389548, -389.1101768293856, -423.35590496772767, -149.14221522241368, -289.01105744683616, -705.6993436445962, -67.88878701783594, -995.4495506517519, -1004.2938257223242, -1309.5789059978665, -1347.7133186378467, -151.43655972167184, -890.582079700467, -357.91449141161087, -700.8608322733538, -1245.2477060151452, -227.59924140319526]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530357594983912, "mean_inference_ms": 1.6705422639704173, "mean_action_processing_ms": 0.2745863841208134, "mean_env_wait_ms": 3.5071998335078844, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012038707733154297, "StateBufferConnector_ms": 0.007890701293945312, "ViewRequirementAgentConnector_ms": 0.19215106964111328}, "num_episodes": 33, "episode_return_max": -1.9202383151385638, "episode_return_min": -1398.227663864548, "episode_return_mean": -754.7837430256794, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.95806755235685, "num_env_steps_trained_throughput_per_sec": 303.95806755235685, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12823.085, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12823.012, "sample_time_ms": 1130.255, "learn_time_ms": 11624.963, "learn_throughput": 344.087, "synch_weights_time_ms": 66.921}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00004", "date": "2024-08-04_05-53-10", "timestamp": 1722730990, "time_this_iter_s": 13.1724534034729, "time_total_s": 205.4379324913025, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f67eb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 205.4379324913025, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.757894736842108, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 53.20300260136525, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.466968808571497, "policy_loss": -0.008806069874359916, "vf_loss": 7.4712980285286905, "vf_explained_var": 0.8764676056181391, "kl": 0.013336880399689732, "entropy": 1.5247536751131217, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -1.9202383151385638, "episode_reward_min": -1523.5814837996245, "episode_reward_mean": -736.834073620118, "episode_len_mean": 131.2, "episode_media": {}, "episodes_timesteps_total": 13120, "policy_reward_min": {"policy_0": -1523.5814837996245}, "policy_reward_max": {"policy_0": -1.9202383151385638}, "policy_reward_mean": {"policy_0": -736.834073620118}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1157.7189180546266, -1322.0323982105442, -297.93146389480614, -243.9364723543232, -1344.5886452245609, -816.6644060343095, -202.60900980083258, -715.7209614003774, -796.942332420704, -470.649570791806, -1144.3831942739544, -127.97981212274073, -1303.1496038681234, -16.20910249018828, -251.74881932446965, -199.32101163672218, -91.79656606447797, -562.0748336160665, -726.1524289106576, -979.7559549663844, -1197.2206952030374, -652.9629255982067, -373.83566446546723, -824.6892195735985, -1137.707576756609, -1.9202383151385638, -878.133224846277, -1398.227663864548, -600.8063806058908, -1219.660692036998, -823.4576055172565, -1078.0952480138512, -818.298024603947, -1147.3182499521454, -97.6979134653971, -352.92125122985277, -703.0777483475806, -863.9863155286481, -703.9866309862184, -861.9389575526496, -1010.9282780680638, -325.4843145271943, -225.74081051875623, -1080.7896938554327, -594.299389301985, -1265.8392537408179, -1359.2952317681613, -1038.3932552758345, -756.9888258070329, -1043.0839216361119, -762.2990840189275, -962.7922611602994, -1294.3781303055903, -1380.0497634067567, -924.7044450793243, -530.6601530389548, -389.1101768293856, -423.35590496772767, -149.14221522241368, -289.01105744683616, -705.6993436445962, -67.88878701783594, -995.4495506517519, -1004.2938257223242, -1309.5789059978665, -1347.7133186378467, -151.43655972167184, -890.582079700467, -357.91449141161087, -700.8608322733538, -1245.2477060151452, -227.59924140319526, -704.4318667051873, -444.0502761728479, -1117.9780288008997, -569.7021354426821, -945.8287934593609, -217.37966203836538, -990.3214940054792, -831.0531205759382, -1087.5150355770784, -1158.3473396384047, -1523.5814837996245, -346.3595928802496, -186.10598128544922, -792.5690802364256, -991.1641912220515, -589.9230098284709, -913.4617498753225, -917.2966720021766, -550.1560248963782, -624.5832198330531, -723.63702985093, -716.3294750680723, -234.89340552823074, -953.7044359088981, -541.438159223782, -1059.0995448912358, -564.2256282635009, -70.3523849044396], "episode_lengths": [150, 150, 85, 88, 150, 150, 69, 150, 150, 120, 150, 58, 150, 40, 93, 61, 52, 150, 150, 150, 150, 119, 87, 150, 150, 36, 150, 150, 150, 150, 150, 150, 143, 150, 55, 113, 150, 150, 132, 150, 150, 89, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 56, 121, 150, 49, 150, 150, 150, 150, 67, 150, 150, 145, 150, 93, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 127, 83, 150, 150, 145, 150, 150, 150, 147, 150, 150, 98, 150, 150, 150, 150, 48], "policy_policy_0_reward": [-1157.7189180546266, -1322.0323982105442, -297.93146389480614, -243.9364723543232, -1344.5886452245609, -816.6644060343095, -202.60900980083258, -715.7209614003774, -796.942332420704, -470.649570791806, -1144.3831942739544, -127.97981212274073, -1303.1496038681234, -16.20910249018828, -251.74881932446965, -199.32101163672218, -91.79656606447797, -562.0748336160665, -726.1524289106576, -979.7559549663844, -1197.2206952030374, -652.9629255982067, -373.83566446546723, -824.6892195735985, -1137.707576756609, -1.9202383151385638, -878.133224846277, -1398.227663864548, -600.8063806058908, -1219.660692036998, -823.4576055172565, -1078.0952480138512, -818.298024603947, -1147.3182499521454, -97.6979134653971, -352.92125122985277, -703.0777483475806, -863.9863155286481, -703.9866309862184, -861.9389575526496, -1010.9282780680638, -325.4843145271943, -225.74081051875623, -1080.7896938554327, -594.299389301985, -1265.8392537408179, -1359.2952317681613, -1038.3932552758345, -756.9888258070329, -1043.0839216361119, -762.2990840189275, -962.7922611602994, -1294.3781303055903, -1380.0497634067567, -924.7044450793243, -530.6601530389548, -389.1101768293856, -423.35590496772767, -149.14221522241368, -289.01105744683616, -705.6993436445962, -67.88878701783594, -995.4495506517519, -1004.2938257223242, -1309.5789059978665, -1347.7133186378467, -151.43655972167184, -890.582079700467, -357.91449141161087, -700.8608322733538, -1245.2477060151452, -227.59924140319526, -704.4318667051873, -444.0502761728479, -1117.9780288008997, -569.7021354426821, -945.8287934593609, -217.37966203836538, -990.3214940054792, -831.0531205759382, -1087.5150355770784, -1158.3473396384047, -1523.5814837996245, -346.3595928802496, -186.10598128544922, -792.5690802364256, -991.1641912220515, -589.9230098284709, -913.4617498753225, -917.2966720021766, -550.1560248963782, -624.5832198330531, -723.63702985093, -716.3294750680723, -234.89340552823074, -953.7044359088981, -541.438159223782, -1059.0995448912358, -564.2256282635009, -70.3523849044396]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536179233512075, "mean_inference_ms": 1.6712686591525454, "mean_action_processing_ms": 0.27481105715779014, "mean_env_wait_ms": 3.5105740840874375, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012134790420532227, "StateBufferConnector_ms": 0.007872819900512695, "ViewRequirementAgentConnector_ms": 0.1912076473236084}, "num_episodes": 28, "episode_return_max": -1.9202383151385638, "episode_return_min": -1523.5814837996245, "episode_return_mean": -736.834073620118, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.82087544341124, "num_env_steps_trained_throughput_per_sec": 303.82087544341124, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12861.865, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12861.793, "sample_time_ms": 1140.684, "learn_time_ms": 11654.911, "learn_throughput": 343.203, "synch_weights_time_ms": 65.335}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00004", "date": "2024-08-04_05-53-23", "timestamp": 1722731003, "time_this_iter_s": 13.178395986557007, "time_total_s": 218.6163284778595, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc703e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 218.6163284778595, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.77368421052632, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.96734331746896, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.477085729440053, "policy_loss": -0.013604874029988423, "vf_loss": 7.485450779398282, "vf_explained_var": 0.8570573943356673, "kl": 0.015110157742856265, "entropy": 1.5597590267658235, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -23.05654889555765, "episode_reward_min": -1523.5814837996245, "episode_reward_mean": -686.2934103339903, "episode_len_mean": 129.76, "episode_media": {}, "episodes_timesteps_total": 12976, "policy_reward_min": {"policy_0": -1523.5814837996245}, "policy_reward_max": {"policy_0": -23.05654889555765}, "policy_reward_mean": {"policy_0": -686.2934103339903}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1147.3182499521454, -97.6979134653971, -352.92125122985277, -703.0777483475806, -863.9863155286481, -703.9866309862184, -861.9389575526496, -1010.9282780680638, -325.4843145271943, -225.74081051875623, -1080.7896938554327, -594.299389301985, -1265.8392537408179, -1359.2952317681613, -1038.3932552758345, -756.9888258070329, -1043.0839216361119, -762.2990840189275, -962.7922611602994, -1294.3781303055903, -1380.0497634067567, -924.7044450793243, -530.6601530389548, -389.1101768293856, -423.35590496772767, -149.14221522241368, -289.01105744683616, -705.6993436445962, -67.88878701783594, -995.4495506517519, -1004.2938257223242, -1309.5789059978665, -1347.7133186378467, -151.43655972167184, -890.582079700467, -357.91449141161087, -700.8608322733538, -1245.2477060151452, -227.59924140319526, -704.4318667051873, -444.0502761728479, -1117.9780288008997, -569.7021354426821, -945.8287934593609, -217.37966203836538, -990.3214940054792, -831.0531205759382, -1087.5150355770784, -1158.3473396384047, -1523.5814837996245, -346.3595928802496, -186.10598128544922, -792.5690802364256, -991.1641912220515, -589.9230098284709, -913.4617498753225, -917.2966720021766, -550.1560248963782, -624.5832198330531, -723.63702985093, -716.3294750680723, -234.89340552823074, -953.7044359088981, -541.438159223782, -1059.0995448912358, -564.2256282635009, -70.3523849044396, -35.175011836890356, -697.7674705942065, -198.48587453732767, -1065.2964586823248, -41.22289945238094, -279.8639710713123, -1029.983040589092, -1048.6026154115261, -23.05654889555765, -411.9816481097205, -911.0398035232884, -170.52243385613144, -137.46680613606227, -120.16318661188086, -658.1206953193728, -330.8678894148231, -969.1239164676554, -441.48903746933627, -423.4224758756702, -407.0479720410443, -116.8214817302622, -735.0667743658296, -434.1497208119223, -1010.2903214237928, -1508.8011991683989, -423.5742251857084, -598.7323146443621, -53.094214083822365, -562.8447852833003, -936.9493087286137, -784.8167664333583, -1043.9100373813708, -1112.5634311123838], "episode_lengths": [150, 55, 113, 150, 150, 132, 150, 150, 89, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 56, 121, 150, 49, 150, 150, 150, 150, 67, 150, 150, 145, 150, 93, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 127, 83, 150, 150, 145, 150, 150, 150, 147, 150, 150, 98, 150, 150, 150, 150, 48, 44, 150, 70, 150, 53, 94, 150, 150, 39, 150, 150, 65, 61, 50, 150, 150, 150, 150, 150, 95, 57, 150, 143, 150, 150, 93, 150, 43, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1147.3182499521454, -97.6979134653971, -352.92125122985277, -703.0777483475806, -863.9863155286481, -703.9866309862184, -861.9389575526496, -1010.9282780680638, -325.4843145271943, -225.74081051875623, -1080.7896938554327, -594.299389301985, -1265.8392537408179, -1359.2952317681613, -1038.3932552758345, -756.9888258070329, -1043.0839216361119, -762.2990840189275, -962.7922611602994, -1294.3781303055903, -1380.0497634067567, -924.7044450793243, -530.6601530389548, -389.1101768293856, -423.35590496772767, -149.14221522241368, -289.01105744683616, -705.6993436445962, -67.88878701783594, -995.4495506517519, -1004.2938257223242, -1309.5789059978665, -1347.7133186378467, -151.43655972167184, -890.582079700467, -357.91449141161087, -700.8608322733538, -1245.2477060151452, -227.59924140319526, -704.4318667051873, -444.0502761728479, -1117.9780288008997, -569.7021354426821, -945.8287934593609, -217.37966203836538, -990.3214940054792, -831.0531205759382, -1087.5150355770784, -1158.3473396384047, -1523.5814837996245, -346.3595928802496, -186.10598128544922, -792.5690802364256, -991.1641912220515, -589.9230098284709, -913.4617498753225, -917.2966720021766, -550.1560248963782, -624.5832198330531, -723.63702985093, -716.3294750680723, -234.89340552823074, -953.7044359088981, -541.438159223782, -1059.0995448912358, -564.2256282635009, -70.3523849044396, -35.175011836890356, -697.7674705942065, -198.48587453732767, -1065.2964586823248, -41.22289945238094, -279.8639710713123, -1029.983040589092, -1048.6026154115261, -23.05654889555765, -411.9816481097205, -911.0398035232884, -170.52243385613144, -137.46680613606227, -120.16318661188086, -658.1206953193728, -330.8678894148231, -969.1239164676554, -441.48903746933627, -423.4224758756702, -407.0479720410443, -116.8214817302622, -735.0667743658296, -434.1497208119223, -1010.2903214237928, -1508.8011991683989, -423.5742251857084, -598.7323146443621, -53.094214083822365, -562.8447852833003, -936.9493087286137, -784.8167664333583, -1043.9100373813708, -1112.5634311123838]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538622916025439, "mean_inference_ms": 1.6715205489531086, "mean_action_processing_ms": 0.2748820937379551, "mean_env_wait_ms": 3.511345795550941, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012004375457763672, "StateBufferConnector_ms": 0.007935047149658203, "ViewRequirementAgentConnector_ms": 0.2014012336730957}, "num_episodes": 33, "episode_return_max": -23.05654889555765, "episode_return_min": -1523.5814837996245, "episode_return_mean": -686.2934103339903, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.9441017663926, "num_env_steps_trained_throughput_per_sec": 310.9441017663926, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12868.902, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12868.834, "sample_time_ms": 1133.498, "learn_time_ms": 11669.123, "learn_throughput": 342.785, "synch_weights_time_ms": 65.355}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00004", "date": "2024-08-04_05-53-36", "timestamp": 1722731016, "time_this_iter_s": 12.876415014266968, "time_total_s": 231.49274349212646, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a6830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 231.49274349212646, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.066666666666666, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 62.47928185164928, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.906511005759239, "policy_loss": -0.01597258364490699, "vf_loss": 6.917050472895304, "vf_explained_var": 0.8586292997623484, "kl": 0.015661047447792977, "entropy": 1.6143538874884447, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -23.05654889555765, "episode_reward_min": -1530.436858744039, "episode_reward_mean": -682.0248704687384, "episode_len_mean": 131.22, "episode_media": {}, "episodes_timesteps_total": 13122, "policy_reward_min": {"policy_0": -1530.436858744039}, "policy_reward_max": {"policy_0": -23.05654889555765}, "policy_reward_mean": {"policy_0": -682.0248704687384}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1309.5789059978665, -1347.7133186378467, -151.43655972167184, -890.582079700467, -357.91449141161087, -700.8608322733538, -1245.2477060151452, -227.59924140319526, -704.4318667051873, -444.0502761728479, -1117.9780288008997, -569.7021354426821, -945.8287934593609, -217.37966203836538, -990.3214940054792, -831.0531205759382, -1087.5150355770784, -1158.3473396384047, -1523.5814837996245, -346.3595928802496, -186.10598128544922, -792.5690802364256, -991.1641912220515, -589.9230098284709, -913.4617498753225, -917.2966720021766, -550.1560248963782, -624.5832198330531, -723.63702985093, -716.3294750680723, -234.89340552823074, -953.7044359088981, -541.438159223782, -1059.0995448912358, -564.2256282635009, -70.3523849044396, -35.175011836890356, -697.7674705942065, -198.48587453732767, -1065.2964586823248, -41.22289945238094, -279.8639710713123, -1029.983040589092, -1048.6026154115261, -23.05654889555765, -411.9816481097205, -911.0398035232884, -170.52243385613144, -137.46680613606227, -120.16318661188086, -658.1206953193728, -330.8678894148231, -969.1239164676554, -441.48903746933627, -423.4224758756702, -407.0479720410443, -116.8214817302622, -735.0667743658296, -434.1497208119223, -1010.2903214237928, -1508.8011991683989, -423.5742251857084, -598.7323146443621, -53.094214083822365, -562.8447852833003, -936.9493087286137, -784.8167664333583, -1043.9100373813708, -1112.5634311123838, -1445.733864314681, -637.0748800751779, -1048.4371444698882, -500.43830428697504, -747.5661956487222, -544.8895047654664, -915.976487966239, -998.9896606110864, -159.68239640687608, -140.4873531360843, -1091.0492703671948, -396.76436259027827, -1362.5824042224274, -797.9234186353831, -1058.9118519463318, -527.4259112391287, -1073.8094056729099, -1530.436858744039, -429.7953741201682, -311.0147136908645, -1123.4585077528839, -559.414072661917, -223.5763318450106, -1073.9326085655557, -219.02060073140083, -553.8152969674497, -756.7806506920937, -472.26026783927836, -615.8196578778214, -195.35423919675983, -1371.32915650933], "episode_lengths": [150, 150, 67, 150, 150, 145, 150, 93, 150, 150, 150, 150, 150, 102, 150, 150, 150, 150, 150, 127, 83, 150, 150, 145, 150, 150, 150, 147, 150, 150, 98, 150, 150, 150, 150, 48, 44, 150, 70, 150, 53, 94, 150, 150, 39, 150, 150, 65, 61, 50, 150, 150, 150, 150, 150, 95, 57, 150, 143, 150, 150, 93, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 119, 150, 92, 150, 150, 150, 150, 72, 150], "policy_policy_0_reward": [-1309.5789059978665, -1347.7133186378467, -151.43655972167184, -890.582079700467, -357.91449141161087, -700.8608322733538, -1245.2477060151452, -227.59924140319526, -704.4318667051873, -444.0502761728479, -1117.9780288008997, -569.7021354426821, -945.8287934593609, -217.37966203836538, -990.3214940054792, -831.0531205759382, -1087.5150355770784, -1158.3473396384047, -1523.5814837996245, -346.3595928802496, -186.10598128544922, -792.5690802364256, -991.1641912220515, -589.9230098284709, -913.4617498753225, -917.2966720021766, -550.1560248963782, -624.5832198330531, -723.63702985093, -716.3294750680723, -234.89340552823074, -953.7044359088981, -541.438159223782, -1059.0995448912358, -564.2256282635009, -70.3523849044396, -35.175011836890356, -697.7674705942065, -198.48587453732767, -1065.2964586823248, -41.22289945238094, -279.8639710713123, -1029.983040589092, -1048.6026154115261, -23.05654889555765, -411.9816481097205, -911.0398035232884, -170.52243385613144, -137.46680613606227, -120.16318661188086, -658.1206953193728, -330.8678894148231, -969.1239164676554, -441.48903746933627, -423.4224758756702, -407.0479720410443, -116.8214817302622, -735.0667743658296, -434.1497208119223, -1010.2903214237928, -1508.8011991683989, -423.5742251857084, -598.7323146443621, -53.094214083822365, -562.8447852833003, -936.9493087286137, -784.8167664333583, -1043.9100373813708, -1112.5634311123838, -1445.733864314681, -637.0748800751779, -1048.4371444698882, -500.43830428697504, -747.5661956487222, -544.8895047654664, -915.976487966239, -998.9896606110864, -159.68239640687608, -140.4873531360843, -1091.0492703671948, -396.76436259027827, -1362.5824042224274, -797.9234186353831, -1058.9118519463318, -527.4259112391287, -1073.8094056729099, -1530.436858744039, -429.7953741201682, -311.0147136908645, -1123.4585077528839, -559.414072661917, -223.5763318450106, -1073.9326085655557, -219.02060073140083, -553.8152969674497, -756.7806506920937, -472.26026783927836, -615.8196578778214, -195.35423919675983, -1371.32915650933]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543985404864523, "mean_inference_ms": 1.672680129167844, "mean_action_processing_ms": 0.2748515203270503, "mean_env_wait_ms": 3.5136888387267042, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012181520462036133, "StateBufferConnector_ms": 0.008000373840332031, "ViewRequirementAgentConnector_ms": 0.2008216381072998}, "num_episodes": 31, "episode_return_max": -23.05654889555765, "episode_return_min": -1530.436858744039, "episode_return_mean": -682.0248704687384, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.83590856839186, "num_env_steps_trained_throughput_per_sec": 309.83590856839186, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12843.208, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12843.138, "sample_time_ms": 1134.484, "learn_time_ms": 11641.389, "learn_throughput": 343.602, "synch_weights_time_ms": 66.392}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00004", "date": "2024-08-04_05-53-49", "timestamp": 1722731029, "time_this_iter_s": 12.922937870025635, "time_total_s": 244.4156813621521, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0af910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 244.4156813621521, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.91578947368421, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 65.57737765312194, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.743496968845526, "policy_loss": -0.007052365483832546, "vf_loss": 6.745548240343729, "vf_explained_var": 0.9016543762137492, "kl": 0.014705924345465391, "entropy": 1.6165764992435774, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -23.05654889555765, "episode_reward_min": -1530.436858744039, "episode_reward_mean": -659.1506805968534, "episode_len_mean": 129.0, "episode_media": {}, "episodes_timesteps_total": 12900, "policy_reward_min": {"policy_0": -1530.436858744039}, "policy_reward_max": {"policy_0": -23.05654889555765}, "policy_reward_mean": {"policy_0": -659.1506805968534}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-723.63702985093, -716.3294750680723, -234.89340552823074, -953.7044359088981, -541.438159223782, -1059.0995448912358, -564.2256282635009, -70.3523849044396, -35.175011836890356, -697.7674705942065, -198.48587453732767, -1065.2964586823248, -41.22289945238094, -279.8639710713123, -1029.983040589092, -1048.6026154115261, -23.05654889555765, -411.9816481097205, -911.0398035232884, -170.52243385613144, -137.46680613606227, -120.16318661188086, -658.1206953193728, -330.8678894148231, -969.1239164676554, -441.48903746933627, -423.4224758756702, -407.0479720410443, -116.8214817302622, -735.0667743658296, -434.1497208119223, -1010.2903214237928, -1508.8011991683989, -423.5742251857084, -598.7323146443621, -53.094214083822365, -562.8447852833003, -936.9493087286137, -784.8167664333583, -1043.9100373813708, -1112.5634311123838, -1445.733864314681, -637.0748800751779, -1048.4371444698882, -500.43830428697504, -747.5661956487222, -544.8895047654664, -915.976487966239, -998.9896606110864, -159.68239640687608, -140.4873531360843, -1091.0492703671948, -396.76436259027827, -1362.5824042224274, -797.9234186353831, -1058.9118519463318, -527.4259112391287, -1073.8094056729099, -1530.436858744039, -429.7953741201682, -311.0147136908645, -1123.4585077528839, -559.414072661917, -223.5763318450106, -1073.9326085655557, -219.02060073140083, -553.8152969674497, -756.7806506920937, -472.26026783927836, -615.8196578778214, -195.35423919675983, -1371.32915650933, -661.8791147718379, -272.873280524868, -1280.637910410729, -937.854383948764, -755.2979544291065, -382.5350286754528, -891.5157494368209, -1210.7859125866946, -999.9308256673193, -168.324061915386, -718.6012450652089, -1254.9917682786677, -888.60380162924, -714.5021139336587, -950.3750100630729, -987.7791168453373, -141.0786333512783, -315.04359387052244, -1371.486638990071, -1153.2046396365436, -112.19900439013043, -1033.107326424063, -330.58135086086287, -672.6501375208484, -512.0933212559329, -137.0135917131677, -183.75840339509583, -406.61898665741495], "episode_lengths": [150, 150, 98, 150, 150, 150, 150, 48, 44, 150, 70, 150, 53, 94, 150, 150, 39, 150, 150, 65, 61, 50, 150, 150, 150, 150, 150, 95, 57, 150, 143, 150, 150, 93, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 119, 150, 92, 150, 150, 150, 150, 72, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 63, 85, 150, 150, 60, 150, 150, 150, 150, 65, 77, 150], "policy_policy_0_reward": [-723.63702985093, -716.3294750680723, -234.89340552823074, -953.7044359088981, -541.438159223782, -1059.0995448912358, -564.2256282635009, -70.3523849044396, -35.175011836890356, -697.7674705942065, -198.48587453732767, -1065.2964586823248, -41.22289945238094, -279.8639710713123, -1029.983040589092, -1048.6026154115261, -23.05654889555765, -411.9816481097205, -911.0398035232884, -170.52243385613144, -137.46680613606227, -120.16318661188086, -658.1206953193728, -330.8678894148231, -969.1239164676554, -441.48903746933627, -423.4224758756702, -407.0479720410443, -116.8214817302622, -735.0667743658296, -434.1497208119223, -1010.2903214237928, -1508.8011991683989, -423.5742251857084, -598.7323146443621, -53.094214083822365, -562.8447852833003, -936.9493087286137, -784.8167664333583, -1043.9100373813708, -1112.5634311123838, -1445.733864314681, -637.0748800751779, -1048.4371444698882, -500.43830428697504, -747.5661956487222, -544.8895047654664, -915.976487966239, -998.9896606110864, -159.68239640687608, -140.4873531360843, -1091.0492703671948, -396.76436259027827, -1362.5824042224274, -797.9234186353831, -1058.9118519463318, -527.4259112391287, -1073.8094056729099, -1530.436858744039, -429.7953741201682, -311.0147136908645, -1123.4585077528839, -559.414072661917, -223.5763318450106, -1073.9326085655557, -219.02060073140083, -553.8152969674497, -756.7806506920937, -472.26026783927836, -615.8196578778214, -195.35423919675983, -1371.32915650933, -661.8791147718379, -272.873280524868, -1280.637910410729, -937.854383948764, -755.2979544291065, -382.5350286754528, -891.5157494368209, -1210.7859125866946, -999.9308256673193, -168.324061915386, -718.6012450652089, -1254.9917682786677, -888.60380162924, -714.5021139336587, -950.3750100630729, -987.7791168453373, -141.0786333512783, -315.04359387052244, -1371.486638990071, -1153.2046396365436, -112.19900439013043, -1033.107326424063, -330.58135086086287, -672.6501375208484, -512.0933212559329, -137.0135917131677, -183.75840339509583, -406.61898665741495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538723548870439, "mean_inference_ms": 1.6727532734044734, "mean_action_processing_ms": 0.2746993544418924, "mean_env_wait_ms": 3.51217540249466, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012170791625976562, "StateBufferConnector_ms": 0.008051156997680664, "ViewRequirementAgentConnector_ms": 0.20107126235961914}, "num_episodes": 28, "episode_return_max": -23.05654889555765, "episode_return_min": -1530.436858744039, "episode_return_mean": -659.1506805968534, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.9676173239027, "num_env_steps_trained_throughput_per_sec": 315.9676173239027, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12784.704, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12784.633, "sample_time_ms": 1134.432, "learn_time_ms": 11582.209, "learn_throughput": 345.357, "synch_weights_time_ms": 67.122}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00004", "date": "2024-08-04_05-54-01", "timestamp": 1722731041, "time_this_iter_s": 12.672817945480347, "time_total_s": 257.08849930763245, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0af880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 257.08849930763245, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.222222222222225, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 66.83127491871515, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.92815538495779, "policy_loss": -0.011777392176251547, "vf_loss": 6.9337955981493, "vf_explained_var": 0.8867985089619954, "kl": 0.017838153092679932, "entropy": 1.8899910024056832, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -25.741984595459275, "episode_reward_min": -1530.436858744039, "episode_reward_mean": -744.0285978058107, "episode_len_mean": 135.43, "episode_media": {}, "episodes_timesteps_total": 13543, "policy_reward_min": {"policy_0": -1530.436858744039}, "policy_reward_max": {"policy_0": -25.741984595459275}, "policy_reward_mean": {"policy_0": -744.0285978058107}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-735.0667743658296, -434.1497208119223, -1010.2903214237928, -1508.8011991683989, -423.5742251857084, -598.7323146443621, -53.094214083822365, -562.8447852833003, -936.9493087286137, -784.8167664333583, -1043.9100373813708, -1112.5634311123838, -1445.733864314681, -637.0748800751779, -1048.4371444698882, -500.43830428697504, -747.5661956487222, -544.8895047654664, -915.976487966239, -998.9896606110864, -159.68239640687608, -140.4873531360843, -1091.0492703671948, -396.76436259027827, -1362.5824042224274, -797.9234186353831, -1058.9118519463318, -527.4259112391287, -1073.8094056729099, -1530.436858744039, -429.7953741201682, -311.0147136908645, -1123.4585077528839, -559.414072661917, -223.5763318450106, -1073.9326085655557, -219.02060073140083, -553.8152969674497, -756.7806506920937, -472.26026783927836, -615.8196578778214, -195.35423919675983, -1371.32915650933, -661.8791147718379, -272.873280524868, -1280.637910410729, -937.854383948764, -755.2979544291065, -382.5350286754528, -891.5157494368209, -1210.7859125866946, -999.9308256673193, -168.324061915386, -718.6012450652089, -1254.9917682786677, -888.60380162924, -714.5021139336587, -950.3750100630729, -987.7791168453373, -141.0786333512783, -315.04359387052244, -1371.486638990071, -1153.2046396365436, -112.19900439013043, -1033.107326424063, -330.58135086086287, -672.6501375208484, -512.0933212559329, -137.0135917131677, -183.75840339509583, -406.61898665741495, -1163.307841466079, -490.82349746569173, -1212.016194960437, -725.7675714454166, -433.5102990818055, -1041.9289019301593, -200.5793459844884, -852.8892643881167, -1299.7786131576538, -672.6962542693537, -884.9274946263649, -1185.5682797706872, -1118.0031960812935, -976.140662288558, -1244.2275186352047, -57.8412824692189, -780.252796344698, -1045.7785579822844, -46.0259898724677, -463.24675987031355, -1459.4664441936848, -1329.4908454000772, -521.2317294111612, -25.741984595459275, -472.4661497560365, -868.2566876622695, -658.9550296432542, -674.951966952846, -963.1218624555858], "episode_lengths": [150, 143, 150, 150, 93, 150, 43, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 73, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 119, 150, 92, 150, 150, 150, 150, 72, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 63, 85, 150, 150, 60, 150, 150, 150, 150, 65, 77, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 57, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-735.0667743658296, -434.1497208119223, -1010.2903214237928, -1508.8011991683989, -423.5742251857084, -598.7323146443621, -53.094214083822365, -562.8447852833003, -936.9493087286137, -784.8167664333583, -1043.9100373813708, -1112.5634311123838, -1445.733864314681, -637.0748800751779, -1048.4371444698882, -500.43830428697504, -747.5661956487222, -544.8895047654664, -915.976487966239, -998.9896606110864, -159.68239640687608, -140.4873531360843, -1091.0492703671948, -396.76436259027827, -1362.5824042224274, -797.9234186353831, -1058.9118519463318, -527.4259112391287, -1073.8094056729099, -1530.436858744039, -429.7953741201682, -311.0147136908645, -1123.4585077528839, -559.414072661917, -223.5763318450106, -1073.9326085655557, -219.02060073140083, -553.8152969674497, -756.7806506920937, -472.26026783927836, -615.8196578778214, -195.35423919675983, -1371.32915650933, -661.8791147718379, -272.873280524868, -1280.637910410729, -937.854383948764, -755.2979544291065, -382.5350286754528, -891.5157494368209, -1210.7859125866946, -999.9308256673193, -168.324061915386, -718.6012450652089, -1254.9917682786677, -888.60380162924, -714.5021139336587, -950.3750100630729, -987.7791168453373, -141.0786333512783, -315.04359387052244, -1371.486638990071, -1153.2046396365436, -112.19900439013043, -1033.107326424063, -330.58135086086287, -672.6501375208484, -512.0933212559329, -137.0135917131677, -183.75840339509583, -406.61898665741495, -1163.307841466079, -490.82349746569173, -1212.016194960437, -725.7675714454166, -433.5102990818055, -1041.9289019301593, -200.5793459844884, -852.8892643881167, -1299.7786131576538, -672.6962542693537, -884.9274946263649, -1185.5682797706872, -1118.0031960812935, -976.140662288558, -1244.2275186352047, -57.8412824692189, -780.252796344698, -1045.7785579822844, -46.0259898724677, -463.24675987031355, -1459.4664441936848, -1329.4908454000772, -521.2317294111612, -25.741984595459275, -472.4661497560365, -868.2566876622695, -658.9550296432542, -674.951966952846, -963.1218624555858]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5535099734961948, "mean_inference_ms": 1.6713782341613916, "mean_action_processing_ms": 0.27439910520359123, "mean_env_wait_ms": 3.51261119442542, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01194620132446289, "StateBufferConnector_ms": 0.008011341094970703, "ViewRequirementAgentConnector_ms": 0.19886326789855957}, "num_episodes": 29, "episode_return_max": -25.741984595459275, "episode_return_min": -1530.436858744039, "episode_return_mean": -744.0285978058107, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.91767427806667, "num_env_steps_trained_throughput_per_sec": 303.91767427806667, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12796.306, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12796.234, "sample_time_ms": 1130.74, "learn_time_ms": 11597.558, "learn_throughput": 344.9, "synch_weights_time_ms": 67.072}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00004", "date": "2024-08-04_05-54-15", "timestamp": 1722731055, "time_this_iter_s": 13.174860715866089, "time_total_s": 270.26336002349854, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7032e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 270.26336002349854, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.144444444444442, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 74.79882551630338, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.362060555318991, "policy_loss": -0.013498776877046719, "vf_loss": 7.369505668183168, "vf_explained_var": 0.8700048593183358, "kl": 0.018157925147958547, "entropy": 2.1174020778387783, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -25.741984595459275, "episode_reward_min": -1459.4664441936848, "episode_reward_mean": -771.3241906788085, "episode_len_mean": 135.47, "episode_media": {}, "episodes_timesteps_total": 13547, "policy_reward_min": {"policy_0": -1459.4664441936848}, "policy_reward_max": {"policy_0": -25.741984595459275}, "policy_reward_mean": {"policy_0": -771.3241906788085}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-559.414072661917, -223.5763318450106, -1073.9326085655557, -219.02060073140083, -553.8152969674497, -756.7806506920937, -472.26026783927836, -615.8196578778214, -195.35423919675983, -1371.32915650933, -661.8791147718379, -272.873280524868, -1280.637910410729, -937.854383948764, -755.2979544291065, -382.5350286754528, -891.5157494368209, -1210.7859125866946, -999.9308256673193, -168.324061915386, -718.6012450652089, -1254.9917682786677, -888.60380162924, -714.5021139336587, -950.3750100630729, -987.7791168453373, -141.0786333512783, -315.04359387052244, -1371.486638990071, -1153.2046396365436, -112.19900439013043, -1033.107326424063, -330.58135086086287, -672.6501375208484, -512.0933212559329, -137.0135917131677, -183.75840339509583, -406.61898665741495, -1163.307841466079, -490.82349746569173, -1212.016194960437, -725.7675714454166, -433.5102990818055, -1041.9289019301593, -200.5793459844884, -852.8892643881167, -1299.7786131576538, -672.6962542693537, -884.9274946263649, -1185.5682797706872, -1118.0031960812935, -976.140662288558, -1244.2275186352047, -57.8412824692189, -780.252796344698, -1045.7785579822844, -46.0259898724677, -463.24675987031355, -1459.4664441936848, -1329.4908454000772, -521.2317294111612, -25.741984595459275, -472.4661497560365, -868.2566876622695, -658.9550296432542, -674.951966952846, -963.1218624555858, -439.01206089234074, -591.4299180883747, -1109.0852689040396, -1091.8145012951638, -1162.1462179138723, -74.23713800406372, -981.0205122905959, -817.7589930007432, -1113.6162419403624, -1206.5414999539864, -1313.7997761407096, -1122.2406210154802, -1353.441938296922, -1371.4177216682558, -852.1644000448847, -923.9577372477349, -1250.6227502647394, -134.89230185306698, -489.53301756194094, -1312.0303068447047, -581.5700066408954, -33.03432614058977, -693.4379012312278, -214.20228016879855, -571.0627430793855, -675.2042334408033, -1097.962720168152, -489.5889286905627, -952.5521127171961, -1020.4810245870074, -1082.2330031214174, -1381.7058663247128, -1273.0021870527437], "episode_lengths": [150, 119, 150, 92, 150, 150, 150, 150, 72, 150, 150, 106, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 63, 85, 150, 150, 60, 150, 150, 150, 150, 65, 77, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 57, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 37, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-559.414072661917, -223.5763318450106, -1073.9326085655557, -219.02060073140083, -553.8152969674497, -756.7806506920937, -472.26026783927836, -615.8196578778214, -195.35423919675983, -1371.32915650933, -661.8791147718379, -272.873280524868, -1280.637910410729, -937.854383948764, -755.2979544291065, -382.5350286754528, -891.5157494368209, -1210.7859125866946, -999.9308256673193, -168.324061915386, -718.6012450652089, -1254.9917682786677, -888.60380162924, -714.5021139336587, -950.3750100630729, -987.7791168453373, -141.0786333512783, -315.04359387052244, -1371.486638990071, -1153.2046396365436, -112.19900439013043, -1033.107326424063, -330.58135086086287, -672.6501375208484, -512.0933212559329, -137.0135917131677, -183.75840339509583, -406.61898665741495, -1163.307841466079, -490.82349746569173, -1212.016194960437, -725.7675714454166, -433.5102990818055, -1041.9289019301593, -200.5793459844884, -852.8892643881167, -1299.7786131576538, -672.6962542693537, -884.9274946263649, -1185.5682797706872, -1118.0031960812935, -976.140662288558, -1244.2275186352047, -57.8412824692189, -780.252796344698, -1045.7785579822844, -46.0259898724677, -463.24675987031355, -1459.4664441936848, -1329.4908454000772, -521.2317294111612, -25.741984595459275, -472.4661497560365, -868.2566876622695, -658.9550296432542, -674.951966952846, -963.1218624555858, -439.01206089234074, -591.4299180883747, -1109.0852689040396, -1091.8145012951638, -1162.1462179138723, -74.23713800406372, -981.0205122905959, -817.7589930007432, -1113.6162419403624, -1206.5414999539864, -1313.7997761407096, -1122.2406210154802, -1353.441938296922, -1371.4177216682558, -852.1644000448847, -923.9577372477349, -1250.6227502647394, -134.89230185306698, -489.53301756194094, -1312.0303068447047, -581.5700066408954, -33.03432614058977, -693.4379012312278, -214.20228016879855, -571.0627430793855, -675.2042334408033, -1097.962720168152, -489.5889286905627, -952.5521127171961, -1020.4810245870074, -1082.2330031214174, -1381.7058663247128, -1273.0021870527437]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534386764830268, "mean_inference_ms": 1.6718418596478797, "mean_action_processing_ms": 0.2742116235614762, "mean_env_wait_ms": 3.5136363341957666, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011852741241455078, "StateBufferConnector_ms": 0.007853031158447266, "ViewRequirementAgentConnector_ms": 0.18839097023010254}, "num_episodes": 33, "episode_return_max": -25.741984595459275, "episode_return_min": -1459.4664441936848, "episode_return_mean": -771.3241906788085, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.2581392175416, "num_env_steps_trained_throughput_per_sec": 314.2581392175416, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12884.414, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12884.341, "sample_time_ms": 1136.037, "learn_time_ms": 11680.079, "learn_throughput": 342.463, "synch_weights_time_ms": 67.366}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00004", "date": "2024-08-04_05-54-28", "timestamp": 1722731068, "time_this_iter_s": 12.741888999938965, "time_total_s": 283.0052490234375, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc702680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.0052490234375, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.08421052631579, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 103.76933323244253, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.768659809728463, "policy_loss": -0.008854698707000352, "vf_loss": 6.773632563153902, "vf_explained_var": 0.8887392622729142, "kl": 0.012737580752066909, "entropy": 1.8499608129262923, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -12.766119691614294, "episode_reward_min": -1459.4664441936848, "episode_reward_mean": -770.3394180329112, "episode_len_mean": 132.9, "episode_media": {}, "episodes_timesteps_total": 13290, "policy_reward_min": {"policy_0": -1459.4664441936848}, "policy_reward_max": {"policy_0": -12.766119691614294}, "policy_reward_mean": {"policy_0": -770.3394180329112}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1153.2046396365436, -112.19900439013043, -1033.107326424063, -330.58135086086287, -672.6501375208484, -512.0933212559329, -137.0135917131677, -183.75840339509583, -406.61898665741495, -1163.307841466079, -490.82349746569173, -1212.016194960437, -725.7675714454166, -433.5102990818055, -1041.9289019301593, -200.5793459844884, -852.8892643881167, -1299.7786131576538, -672.6962542693537, -884.9274946263649, -1185.5682797706872, -1118.0031960812935, -976.140662288558, -1244.2275186352047, -57.8412824692189, -780.252796344698, -1045.7785579822844, -46.0259898724677, -463.24675987031355, -1459.4664441936848, -1329.4908454000772, -521.2317294111612, -25.741984595459275, -472.4661497560365, -868.2566876622695, -658.9550296432542, -674.951966952846, -963.1218624555858, -439.01206089234074, -591.4299180883747, -1109.0852689040396, -1091.8145012951638, -1162.1462179138723, -74.23713800406372, -981.0205122905959, -817.7589930007432, -1113.6162419403624, -1206.5414999539864, -1313.7997761407096, -1122.2406210154802, -1353.441938296922, -1371.4177216682558, -852.1644000448847, -923.9577372477349, -1250.6227502647394, -134.89230185306698, -489.53301756194094, -1312.0303068447047, -581.5700066408954, -33.03432614058977, -693.4379012312278, -214.20228016879855, -571.0627430793855, -675.2042334408033, -1097.962720168152, -489.5889286905627, -952.5521127171961, -1020.4810245870074, -1082.2330031214174, -1381.7058663247128, -1273.0021870527437, -501.7615544983584, -325.1042643319021, -665.1013657381089, -700.3875453826153, -1078.4824664420114, -1114.87408275664, -815.5739761377037, -711.7474236618806, -210.82833533441217, -1113.5338698906853, -641.6019132081548, -100.88020252769901, -777.3282131881813, -1418.3149059304294, -73.82910137793074, -271.9281826389391, -884.5279605490138, -12.766119691614294, -1219.2422104007553, -966.4842043444118, -51.48988915874271, -1084.0273511053417, -1315.4893756304643, -1222.6978546385453, -585.265326109168, -988.491965378773, -955.4267424422221, -782.3997739200487, -257.33558627615633], "episode_lengths": [150, 60, 150, 150, 150, 150, 65, 77, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 50, 150, 150, 57, 150, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 37, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 88, 150, 150, 150, 150, 150, 150, 84, 150, 150, 52, 150, 150, 56, 73, 150, 36, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 91], "policy_policy_0_reward": [-1153.2046396365436, -112.19900439013043, -1033.107326424063, -330.58135086086287, -672.6501375208484, -512.0933212559329, -137.0135917131677, -183.75840339509583, -406.61898665741495, -1163.307841466079, -490.82349746569173, -1212.016194960437, -725.7675714454166, -433.5102990818055, -1041.9289019301593, -200.5793459844884, -852.8892643881167, -1299.7786131576538, -672.6962542693537, -884.9274946263649, -1185.5682797706872, -1118.0031960812935, -976.140662288558, -1244.2275186352047, -57.8412824692189, -780.252796344698, -1045.7785579822844, -46.0259898724677, -463.24675987031355, -1459.4664441936848, -1329.4908454000772, -521.2317294111612, -25.741984595459275, -472.4661497560365, -868.2566876622695, -658.9550296432542, -674.951966952846, -963.1218624555858, -439.01206089234074, -591.4299180883747, -1109.0852689040396, -1091.8145012951638, -1162.1462179138723, -74.23713800406372, -981.0205122905959, -817.7589930007432, -1113.6162419403624, -1206.5414999539864, -1313.7997761407096, -1122.2406210154802, -1353.441938296922, -1371.4177216682558, -852.1644000448847, -923.9577372477349, -1250.6227502647394, -134.89230185306698, -489.53301756194094, -1312.0303068447047, -581.5700066408954, -33.03432614058977, -693.4379012312278, -214.20228016879855, -571.0627430793855, -675.2042334408033, -1097.962720168152, -489.5889286905627, -952.5521127171961, -1020.4810245870074, -1082.2330031214174, -1381.7058663247128, -1273.0021870527437, -501.7615544983584, -325.1042643319021, -665.1013657381089, -700.3875453826153, -1078.4824664420114, -1114.87408275664, -815.5739761377037, -711.7474236618806, -210.82833533441217, -1113.5338698906853, -641.6019132081548, -100.88020252769901, -777.3282131881813, -1418.3149059304294, -73.82910137793074, -271.9281826389391, -884.5279605490138, -12.766119691614294, -1219.2422104007553, -966.4842043444118, -51.48988915874271, -1084.0273511053417, -1315.4893756304643, -1222.6978546385453, -585.265326109168, -988.491965378773, -955.4267424422221, -782.3997739200487, -257.33558627615633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533704133842602, "mean_inference_ms": 1.6707316518974604, "mean_action_processing_ms": 0.27407937872669375, "mean_env_wait_ms": 3.5141727488679186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011794328689575195, "StateBufferConnector_ms": 0.007887125015258789, "ViewRequirementAgentConnector_ms": 0.1900637149810791}, "num_episodes": 29, "episode_return_max": -12.766119691614294, "episode_return_min": -1459.4664441936848, "episode_return_mean": -770.3394180329112, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.01339981862327, "num_env_steps_trained_throughput_per_sec": 305.01339981862327, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12954.84, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12954.768, "sample_time_ms": 1139.969, "learn_time_ms": 11745.922, "learn_throughput": 340.544, "synch_weights_time_ms": 68.012}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00004", "date": "2024-08-04_05-54-41", "timestamp": 1722731081, "time_this_iter_s": 13.128014087677002, "time_total_s": 296.1332631111145, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0af880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 296.1332631111145, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.055555555555554, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 87.62282691200575, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.815431087712446, "policy_loss": -0.008971723836051144, "vf_loss": 6.818919757505258, "vf_explained_var": 0.8936474059397975, "kl": 0.015979054454661915, "entropy": 1.7075414666285118, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -12.766119691614294, "episode_reward_min": -1567.6653553772524, "episode_reward_mean": -768.4905873003064, "episode_len_mean": 132.83, "episode_media": {}, "episodes_timesteps_total": 13283, "policy_reward_min": {"policy_0": -1567.6653553772524}, "policy_reward_max": {"policy_0": -12.766119691614294}, "policy_reward_mean": {"policy_0": -768.4905873003064}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-521.2317294111612, -25.741984595459275, -472.4661497560365, -868.2566876622695, -658.9550296432542, -674.951966952846, -963.1218624555858, -439.01206089234074, -591.4299180883747, -1109.0852689040396, -1091.8145012951638, -1162.1462179138723, -74.23713800406372, -981.0205122905959, -817.7589930007432, -1113.6162419403624, -1206.5414999539864, -1313.7997761407096, -1122.2406210154802, -1353.441938296922, -1371.4177216682558, -852.1644000448847, -923.9577372477349, -1250.6227502647394, -134.89230185306698, -489.53301756194094, -1312.0303068447047, -581.5700066408954, -33.03432614058977, -693.4379012312278, -214.20228016879855, -571.0627430793855, -675.2042334408033, -1097.962720168152, -489.5889286905627, -952.5521127171961, -1020.4810245870074, -1082.2330031214174, -1381.7058663247128, -1273.0021870527437, -501.7615544983584, -325.1042643319021, -665.1013657381089, -700.3875453826153, -1078.4824664420114, -1114.87408275664, -815.5739761377037, -711.7474236618806, -210.82833533441217, -1113.5338698906853, -641.6019132081548, -100.88020252769901, -777.3282131881813, -1418.3149059304294, -73.82910137793074, -271.9281826389391, -884.5279605490138, -12.766119691614294, -1219.2422104007553, -966.4842043444118, -51.48988915874271, -1084.0273511053417, -1315.4893756304643, -1222.6978546385453, -585.265326109168, -988.491965378773, -955.4267424422221, -782.3997739200487, -257.33558627615633, -21.40897376880294, -61.52748127318901, -1249.7029226010588, -1113.3567141521767, -811.3139698971379, -339.9910456272671, -494.3915605886124, -60.79258966057575, -562.1839412618122, -619.8512012927592, -131.54195968617955, -104.83288333455978, -994.3075882064736, -740.9779621333087, -564.7587018087654, -1284.503337735419, -512.7409401532716, -1287.1310004711552, -506.0395068134976, -1029.2334645971687, -867.4450597217891, -1207.133391519192, -721.7166073397905, -1000.0086747955032, -621.8984504096716, -1334.1210875260717, -642.0995399592343, -634.7482309359245, -1311.4477682516422, -641.7393893783791, -1567.6653553772524], "episode_lengths": [150, 42, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 150, 150, 150, 37, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 88, 150, 150, 150, 150, 150, 150, 84, 150, 150, 52, 150, 150, 56, 73, 150, 36, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 91, 44, 52, 150, 150, 150, 86, 150, 55, 150, 150, 68, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-521.2317294111612, -25.741984595459275, -472.4661497560365, -868.2566876622695, -658.9550296432542, -674.951966952846, -963.1218624555858, -439.01206089234074, -591.4299180883747, -1109.0852689040396, -1091.8145012951638, -1162.1462179138723, -74.23713800406372, -981.0205122905959, -817.7589930007432, -1113.6162419403624, -1206.5414999539864, -1313.7997761407096, -1122.2406210154802, -1353.441938296922, -1371.4177216682558, -852.1644000448847, -923.9577372477349, -1250.6227502647394, -134.89230185306698, -489.53301756194094, -1312.0303068447047, -581.5700066408954, -33.03432614058977, -693.4379012312278, -214.20228016879855, -571.0627430793855, -675.2042334408033, -1097.962720168152, -489.5889286905627, -952.5521127171961, -1020.4810245870074, -1082.2330031214174, -1381.7058663247128, -1273.0021870527437, -501.7615544983584, -325.1042643319021, -665.1013657381089, -700.3875453826153, -1078.4824664420114, -1114.87408275664, -815.5739761377037, -711.7474236618806, -210.82833533441217, -1113.5338698906853, -641.6019132081548, -100.88020252769901, -777.3282131881813, -1418.3149059304294, -73.82910137793074, -271.9281826389391, -884.5279605490138, -12.766119691614294, -1219.2422104007553, -966.4842043444118, -51.48988915874271, -1084.0273511053417, -1315.4893756304643, -1222.6978546385453, -585.265326109168, -988.491965378773, -955.4267424422221, -782.3997739200487, -257.33558627615633, -21.40897376880294, -61.52748127318901, -1249.7029226010588, -1113.3567141521767, -811.3139698971379, -339.9910456272671, -494.3915605886124, -60.79258966057575, -562.1839412618122, -619.8512012927592, -131.54195968617955, -104.83288333455978, -994.3075882064736, -740.9779621333087, -564.7587018087654, -1284.503337735419, -512.7409401532716, -1287.1310004711552, -506.0395068134976, -1029.2334645971687, -867.4450597217891, -1207.133391519192, -721.7166073397905, -1000.0086747955032, -621.8984504096716, -1334.1210875260717, -642.0995399592343, -634.7482309359245, -1311.4477682516422, -641.7393893783791, -1567.6653553772524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533893889784044, "mean_inference_ms": 1.6708022871556119, "mean_action_processing_ms": 0.27394647502254527, "mean_env_wait_ms": 3.515422776919438, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01193547248840332, "StateBufferConnector_ms": 0.008009195327758789, "ViewRequirementAgentConnector_ms": 0.19291281700134277}, "num_episodes": 31, "episode_return_max": -12.766119691614294, "episode_return_min": -1567.6653553772524, "episode_return_mean": -768.4905873003064, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 321.00209682826954, "num_env_steps_trained_throughput_per_sec": 321.00209682826954, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12910.786, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12910.713, "sample_time_ms": 1138.921, "learn_time_ms": 11703.324, "learn_throughput": 341.783, "synch_weights_time_ms": 67.615}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00004", "date": "2024-08-04_05-54-53", "timestamp": 1722731093, "time_this_iter_s": 12.474708318710327, "time_total_s": 308.60797142982483, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a7400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.60797142982483, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.149999999999995, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 98.10892071127891, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.644753653307756, "policy_loss": -0.006450702695777484, "vf_loss": 6.6474368393421175, "vf_explained_var": 0.9193439594780405, "kl": 0.012005820240240913, "entropy": 1.635099302791059, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -12.766119691614294, "episode_reward_min": -1567.6653553772524, "episode_reward_mean": -727.1840810416354, "episode_len_mean": 131.66, "episode_media": {}, "episodes_timesteps_total": 13166, "policy_reward_min": {"policy_0": -1567.6653553772524}, "policy_reward_max": {"policy_0": -12.766119691614294}, "policy_reward_mean": {"policy_0": -727.1840810416354}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-489.53301756194094, -1312.0303068447047, -581.5700066408954, -33.03432614058977, -693.4379012312278, -214.20228016879855, -571.0627430793855, -675.2042334408033, -1097.962720168152, -489.5889286905627, -952.5521127171961, -1020.4810245870074, -1082.2330031214174, -1381.7058663247128, -1273.0021870527437, -501.7615544983584, -325.1042643319021, -665.1013657381089, -700.3875453826153, -1078.4824664420114, -1114.87408275664, -815.5739761377037, -711.7474236618806, -210.82833533441217, -1113.5338698906853, -641.6019132081548, -100.88020252769901, -777.3282131881813, -1418.3149059304294, -73.82910137793074, -271.9281826389391, -884.5279605490138, -12.766119691614294, -1219.2422104007553, -966.4842043444118, -51.48988915874271, -1084.0273511053417, -1315.4893756304643, -1222.6978546385453, -585.265326109168, -988.491965378773, -955.4267424422221, -782.3997739200487, -257.33558627615633, -21.40897376880294, -61.52748127318901, -1249.7029226010588, -1113.3567141521767, -811.3139698971379, -339.9910456272671, -494.3915605886124, -60.79258966057575, -562.1839412618122, -619.8512012927592, -131.54195968617955, -104.83288333455978, -994.3075882064736, -740.9779621333087, -564.7587018087654, -1284.503337735419, -512.7409401532716, -1287.1310004711552, -506.0395068134976, -1029.2334645971687, -867.4450597217891, -1207.133391519192, -721.7166073397905, -1000.0086747955032, -621.8984504096716, -1334.1210875260717, -642.0995399592343, -634.7482309359245, -1311.4477682516422, -641.7393893783791, -1567.6653553772524, -970.0818635697786, -648.7767818961256, -147.5751253361402, -960.6036502714752, -185.02535378857894, -568.4864048973517, -698.7687919035037, -133.30656139333908, -703.5474981851221, -944.9769948727736, -1338.903261048242, -1407.4340703576845, -980.5557137647692, -478.3526449175986, -725.0642973290865, -662.9868978811169, -415.77972272863957, -195.43503866068525, -519.9738009343905, -215.26791373567255, -854.6849791540653, -846.1494558131269, -502.6422826229364, -1172.948602632926, -685.9466757297264], "episode_lengths": [150, 150, 150, 37, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 88, 150, 150, 150, 150, 150, 150, 84, 150, 150, 52, 150, 150, 56, 73, 150, 36, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 91, 44, 52, 150, 150, 150, 86, 150, 55, 150, 150, 68, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 68, 150, 63, 150, 150, 57, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 72, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-489.53301756194094, -1312.0303068447047, -581.5700066408954, -33.03432614058977, -693.4379012312278, -214.20228016879855, -571.0627430793855, -675.2042334408033, -1097.962720168152, -489.5889286905627, -952.5521127171961, -1020.4810245870074, -1082.2330031214174, -1381.7058663247128, -1273.0021870527437, -501.7615544983584, -325.1042643319021, -665.1013657381089, -700.3875453826153, -1078.4824664420114, -1114.87408275664, -815.5739761377037, -711.7474236618806, -210.82833533441217, -1113.5338698906853, -641.6019132081548, -100.88020252769901, -777.3282131881813, -1418.3149059304294, -73.82910137793074, -271.9281826389391, -884.5279605490138, -12.766119691614294, -1219.2422104007553, -966.4842043444118, -51.48988915874271, -1084.0273511053417, -1315.4893756304643, -1222.6978546385453, -585.265326109168, -988.491965378773, -955.4267424422221, -782.3997739200487, -257.33558627615633, -21.40897376880294, -61.52748127318901, -1249.7029226010588, -1113.3567141521767, -811.3139698971379, -339.9910456272671, -494.3915605886124, -60.79258966057575, -562.1839412618122, -619.8512012927592, -131.54195968617955, -104.83288333455978, -994.3075882064736, -740.9779621333087, -564.7587018087654, -1284.503337735419, -512.7409401532716, -1287.1310004711552, -506.0395068134976, -1029.2334645971687, -867.4450597217891, -1207.133391519192, -721.7166073397905, -1000.0086747955032, -621.8984504096716, -1334.1210875260717, -642.0995399592343, -634.7482309359245, -1311.4477682516422, -641.7393893783791, -1567.6653553772524, -970.0818635697786, -648.7767818961256, -147.5751253361402, -960.6036502714752, -185.02535378857894, -568.4864048973517, -698.7687919035037, -133.30656139333908, -703.5474981851221, -944.9769948727736, -1338.903261048242, -1407.4340703576845, -980.5557137647692, -478.3526449175986, -725.0642973290865, -662.9868978811169, -415.77972272863957, -195.43503866068525, -519.9738009343905, -215.26791373567255, -854.6849791540653, -846.1494558131269, -502.6422826229364, -1172.948602632926, -685.9466757297264]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532079677459056, "mean_inference_ms": 1.6694534811732706, "mean_action_processing_ms": 0.27344632933684027, "mean_env_wait_ms": 3.5121867882872273, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01186680793762207, "StateBufferConnector_ms": 0.00798940658569336, "ViewRequirementAgentConnector_ms": 0.19399642944335938}, "num_episodes": 25, "episode_return_max": -12.766119691614294, "episode_return_min": -1567.6653553772524, "episode_return_mean": -727.1840810416354, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.101003977197, "num_env_steps_trained_throughput_per_sec": 310.101003977197, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12912.315, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12912.24, "sample_time_ms": 1139.349, "learn_time_ms": 11704.136, "learn_throughput": 341.76, "synch_weights_time_ms": 67.898}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00004", "date": "2024-08-04_05-55-06", "timestamp": 1722731106, "time_this_iter_s": 12.911420822143555, "time_total_s": 321.5193922519684, "pid": 574301, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f66200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.5193922519684, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.96315789473684, "ram_util_percent": 28.0}}
