{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.013595974445343, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.737080802520117, "policy_loss": -0.011446524031149844, "vf_loss": 9.746008855104446, "vf_explained_var": 0.029214139468967913, "kl": 0.013305176406174724, "entropy": 1.4254483222961425, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -12.636206475162977, "episode_reward_min": -1366.168986950706, "episode_reward_mean": -713.5834096237357, "episode_len_mean": 120.08, "episode_media": {}, "episodes_timesteps_total": 3002, "policy_reward_min": {"policy_0": -1366.168986950706}, "policy_reward_max": {"policy_0": -12.636206475162977}, "policy_reward_mean": {"policy_0": -713.5834096237357}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1006.436887547058, -933.9559585877291, -145.95297995531897, -326.60954154008544, -1246.6013026153203, -1005.8139145269714, -945.4896448227778, -785.0313938795575, -831.5869963039837, -383.7257435490341, -1366.168986950706, -211.2615211894976, -483.1998052923308, -1230.924846714158, -1134.0154937109842, -901.2448441639106, -189.98409120001514, -934.0517595333791, -1008.2491788368986, -1265.3019284217864, -150.67270615467726, -1017.2461798424458, -12.636206475162977, -273.3435656869107, -50.079763092694755], "episode_lengths": [150, 150, 78, 85, 150, 150, 150, 150, 150, 86, 150, 66, 105, 150, 150, 150, 86, 150, 150, 150, 59, 150, 43, 90, 54], "policy_policy_0_reward": [-1006.436887547058, -933.9559585877291, -145.95297995531897, -326.60954154008544, -1246.6013026153203, -1005.8139145269714, -945.4896448227778, -785.0313938795575, -831.5869963039837, -383.7257435490341, -1366.168986950706, -211.2615211894976, -483.1998052923308, -1230.924846714158, -1134.0154937109842, -901.2448441639106, -189.98409120001514, -934.0517595333791, -1008.2491788368986, -1265.3019284217864, -150.67270615467726, -1017.2461798424458, -12.636206475162977, -273.3435656869107, -50.079763092694755]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5670677040989568, "mean_inference_ms": 1.659243933829572, "mean_action_processing_ms": 0.27673833906552675, "mean_env_wait_ms": 3.3985128737827046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011614799499511719, "StateBufferConnector_ms": 0.008165359497070312, "ViewRequirementAgentConnector_ms": 0.1828479766845703}, "num_episodes": 25, "episode_return_max": -12.636206475162977, "episode_return_min": -1366.168986950706, "episode_return_mean": -713.5834096237357, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.61292479003356, "num_env_steps_trained_throughput_per_sec": 309.61292479003356, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12919.367, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12919.307, "sample_time_ms": 1128.74, "learn_time_ms": 11733.687, "learn_throughput": 340.899, "synch_weights_time_ms": 56.148}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00015", "date": "2024-08-04_06-51-17", "timestamp": 1722734477, "time_this_iter_s": 12.932267665863037, "time_total_s": 12.932267665863037, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237087b010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.932267665863037, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.557894736842105, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0971907255550226, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.775175267457962, "policy_loss": -0.008158736240390378, "vf_loss": 9.781433560450871, "vf_explained_var": 0.04263958328713973, "kl": 0.010230923817046763, "entropy": 1.4572406017531951, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -12.636206475162977, "episode_reward_min": -1366.168986950706, "episode_reward_mean": -752.2060340667878, "episode_len_mean": 123.98076923076923, "episode_media": {}, "episodes_timesteps_total": 6447, "policy_reward_min": {"policy_0": -1366.168986950706}, "policy_reward_max": {"policy_0": -12.636206475162977}, "policy_reward_mean": {"policy_0": -752.2060340667878}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1006.436887547058, -933.9559585877291, -145.95297995531897, -326.60954154008544, -1246.6013026153203, -1005.8139145269714, -945.4896448227778, -785.0313938795575, -831.5869963039837, -383.7257435490341, -1366.168986950706, -211.2615211894976, -483.1998052923308, -1230.924846714158, -1134.0154937109842, -901.2448441639106, -189.98409120001514, -934.0517595333791, -1008.2491788368986, -1265.3019284217864, -150.67270615467726, -1017.2461798424458, -12.636206475162977, -273.3435656869107, -50.079763092694755, -994.6523168307716, -1037.0647674660124, -1010.8366037751649, -1126.34256589782, -1110.0940144429126, -861.7562040057536, -1265.679203171469, -1137.4076078207008, -1108.4573786685962, -330.25972579112215, -197.79264354017027, -396.085799681535, -211.39854051985526, -1029.5456213955324, -1304.3431592148295, -130.86786125103592, -909.1586351051419, -934.1105378486941, -1265.643528703978, -61.907665335869154, -117.37637020928872, -539.6915378594357, -875.9504319964711, -836.7446350547219, -1356.1128020410467, -423.73905103745585, -702.1093222141897], "episode_lengths": [150, 150, 78, 85, 150, 150, 150, 150, 150, 86, 150, 66, 105, 150, 150, 150, 86, 150, 150, 150, 59, 150, 43, 90, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 70, 97, 72, 150, 150, 67, 150, 150, 150, 59, 54, 119, 150, 150, 150, 101, 150], "policy_policy_0_reward": [-1006.436887547058, -933.9559585877291, -145.95297995531897, -326.60954154008544, -1246.6013026153203, -1005.8139145269714, -945.4896448227778, -785.0313938795575, -831.5869963039837, -383.7257435490341, -1366.168986950706, -211.2615211894976, -483.1998052923308, -1230.924846714158, -1134.0154937109842, -901.2448441639106, -189.98409120001514, -934.0517595333791, -1008.2491788368986, -1265.3019284217864, -150.67270615467726, -1017.2461798424458, -12.636206475162977, -273.3435656869107, -50.079763092694755, -994.6523168307716, -1037.0647674660124, -1010.8366037751649, -1126.34256589782, -1110.0940144429126, -861.7562040057536, -1265.679203171469, -1137.4076078207008, -1108.4573786685962, -330.25972579112215, -197.79264354017027, -396.085799681535, -211.39854051985526, -1029.5456213955324, -1304.3431592148295, -130.86786125103592, -909.1586351051419, -934.1105378486941, -1265.643528703978, -61.907665335869154, -117.37637020928872, -539.6915378594357, -875.9504319964711, -836.7446350547219, -1356.1128020410467, -423.73905103745585, -702.1093222141897]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5643305177432153, "mean_inference_ms": 1.6534441477776336, "mean_action_processing_ms": 0.2763642923717003, "mean_env_wait_ms": 3.399305417528239, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013224436686589168, "StateBufferConnector_ms": 0.008305219503549429, "ViewRequirementAgentConnector_ms": 0.1841893562903771}, "num_episodes": 27, "episode_return_max": -12.636206475162977, "episode_return_min": -1366.168986950706, "episode_return_mean": -752.2060340667878, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.4861952225211, "num_env_steps_trained_throughput_per_sec": 305.4861952225211, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13006.63, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13006.568, "sample_time_ms": 1121.805, "learn_time_ms": 11827.267, "learn_throughput": 338.202, "synch_weights_time_ms": 56.763}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00015", "date": "2024-08-04_06-51-30", "timestamp": 1722734490, "time_this_iter_s": 13.106115579605103, "time_total_s": 26.03838324546814, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237087bc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.03838324546814, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.410526315789475, "ram_util_percent": 27.99473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2560668290282289, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.755551118652026, "policy_loss": -0.006863842732855119, "vf_loss": 9.759908959269524, "vf_explained_var": 0.04188992443184058, "kl": 0.013229389713266452, "entropy": 1.3985106900334359, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -12.636206475162977, "episode_reward_min": -1366.168986950706, "episode_reward_mean": -788.5288262604367, "episode_len_mean": 127.63291139240506, "episode_media": {}, "episodes_timesteps_total": 10083, "policy_reward_min": {"policy_0": -1366.168986950706}, "policy_reward_max": {"policy_0": -12.636206475162977}, "policy_reward_mean": {"policy_0": -788.5288262604367}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1006.436887547058, -933.9559585877291, -145.95297995531897, -326.60954154008544, -1246.6013026153203, -1005.8139145269714, -945.4896448227778, -785.0313938795575, -831.5869963039837, -383.7257435490341, -1366.168986950706, -211.2615211894976, -483.1998052923308, -1230.924846714158, -1134.0154937109842, -901.2448441639106, -189.98409120001514, -934.0517595333791, -1008.2491788368986, -1265.3019284217864, -150.67270615467726, -1017.2461798424458, -12.636206475162977, -273.3435656869107, -50.079763092694755, -994.6523168307716, -1037.0647674660124, -1010.8366037751649, -1126.34256589782, -1110.0940144429126, -861.7562040057536, -1265.679203171469, -1137.4076078207008, -1108.4573786685962, -330.25972579112215, -197.79264354017027, -396.085799681535, -211.39854051985526, -1029.5456213955324, -1304.3431592148295, -130.86786125103592, -909.1586351051419, -934.1105378486941, -1265.643528703978, -61.907665335869154, -117.37637020928872, -539.6915378594357, -875.9504319964711, -836.7446350547219, -1356.1128020410467, -423.73905103745585, -702.1093222141897, -1191.325018009265, -1286.5719197324966, -1206.8910293829078, -180.5754692178932, -1156.1774563236859, -674.3971467808036, -741.1303845186716, -1015.4912658402496, -640.1856926797647, -438.91203073312386, -422.64196114195516, -1111.2377343428934, -514.2552478520198, -354.35854675680673, -1038.660699593892, -1015.9114823930478, -378.0521674274577, -1205.769470939932, -1030.1606965944147, -1250.5158585132187, -780.3221038820037, -671.4808050823565, -1319.4548064080973, -1291.4871575405075, -399.19049924005094, -1282.55930069597, -581.3475514780478], "episode_lengths": [150, 150, 78, 85, 150, 150, 150, 150, 150, 86, 150, 66, 105, 150, 150, 150, 86, 150, 150, 150, 59, 150, 43, 90, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 70, 97, 72, 150, 150, 67, 150, 150, 150, 59, 54, 119, 150, 150, 150, 101, 150, 150, 150, 150, 59, 150, 125, 139, 150, 126, 120, 98, 150, 131, 87, 150, 150, 97, 150, 150, 150, 138, 150, 150, 150, 137, 150, 129], "policy_policy_0_reward": [-1006.436887547058, -933.9559585877291, -145.95297995531897, -326.60954154008544, -1246.6013026153203, -1005.8139145269714, -945.4896448227778, -785.0313938795575, -831.5869963039837, -383.7257435490341, -1366.168986950706, -211.2615211894976, -483.1998052923308, -1230.924846714158, -1134.0154937109842, -901.2448441639106, -189.98409120001514, -934.0517595333791, -1008.2491788368986, -1265.3019284217864, -150.67270615467726, -1017.2461798424458, -12.636206475162977, -273.3435656869107, -50.079763092694755, -994.6523168307716, -1037.0647674660124, -1010.8366037751649, -1126.34256589782, -1110.0940144429126, -861.7562040057536, -1265.679203171469, -1137.4076078207008, -1108.4573786685962, -330.25972579112215, -197.79264354017027, -396.085799681535, -211.39854051985526, -1029.5456213955324, -1304.3431592148295, -130.86786125103592, -909.1586351051419, -934.1105378486941, -1265.643528703978, -61.907665335869154, -117.37637020928872, -539.6915378594357, -875.9504319964711, -836.7446350547219, -1356.1128020410467, -423.73905103745585, -702.1093222141897, -1191.325018009265, -1286.5719197324966, -1206.8910293829078, -180.5754692178932, -1156.1774563236859, -674.3971467808036, -741.1303845186716, -1015.4912658402496, -640.1856926797647, -438.91203073312386, -422.64196114195516, -1111.2377343428934, -514.2552478520198, -354.35854675680673, -1038.660699593892, -1015.9114823930478, -378.0521674274577, -1205.769470939932, -1030.1606965944147, -1250.5158585132187, -780.3221038820037, -671.4808050823565, -1319.4548064080973, -1291.4871575405075, -399.19049924005094, -1282.55930069597, -581.3475514780478]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.562239309821028, "mean_inference_ms": 1.656447073717228, "mean_action_processing_ms": 0.2765259045173754, "mean_env_wait_ms": 3.4103643327206177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01304904116859919, "StateBufferConnector_ms": 0.008624716650081587, "ViewRequirementAgentConnector_ms": 0.18911361694335938}, "num_episodes": 27, "episode_return_max": -12.636206475162977, "episode_return_min": -1366.168986950706, "episode_return_mean": -788.5288262604367, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 328.0869110730479, "num_env_steps_trained_throughput_per_sec": 328.0869110730479, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12735.054, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12734.992, "sample_time_ms": 1117.862, "learn_time_ms": 11556.965, "learn_throughput": 346.112, "synch_weights_time_ms": 59.427}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00015", "date": "2024-08-04_06-51-42", "timestamp": 1722734502, "time_this_iter_s": 12.205203771591187, "time_total_s": 38.243587017059326, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370879090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 38.243587017059326, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.98235294117647, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.638628181659927, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.735118206342062, "policy_loss": -0.00809832257218659, "vf_loss": 9.74071669280529, "vf_explained_var": 0.06683810042838255, "kl": 0.013225521014161742, "entropy": 1.4526093045870463, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -12.636206475162977, "episode_reward_min": -1427.3829050533009, "episode_reward_mean": -804.2220086278047, "episode_len_mean": 130.35, "episode_media": {}, "episodes_timesteps_total": 13035, "policy_reward_min": {"policy_0": -1427.3829050533009}, "policy_reward_max": {"policy_0": -12.636206475162977}, "policy_reward_mean": {"policy_0": -804.2220086278047}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1366.168986950706, -211.2615211894976, -483.1998052923308, -1230.924846714158, -1134.0154937109842, -901.2448441639106, -189.98409120001514, -934.0517595333791, -1008.2491788368986, -1265.3019284217864, -150.67270615467726, -1017.2461798424458, -12.636206475162977, -273.3435656869107, -50.079763092694755, -994.6523168307716, -1037.0647674660124, -1010.8366037751649, -1126.34256589782, -1110.0940144429126, -861.7562040057536, -1265.679203171469, -1137.4076078207008, -1108.4573786685962, -330.25972579112215, -197.79264354017027, -396.085799681535, -211.39854051985526, -1029.5456213955324, -1304.3431592148295, -130.86786125103592, -909.1586351051419, -934.1105378486941, -1265.643528703978, -61.907665335869154, -117.37637020928872, -539.6915378594357, -875.9504319964711, -836.7446350547219, -1356.1128020410467, -423.73905103745585, -702.1093222141897, -1191.325018009265, -1286.5719197324966, -1206.8910293829078, -180.5754692178932, -1156.1774563236859, -674.3971467808036, -741.1303845186716, -1015.4912658402496, -640.1856926797647, -438.91203073312386, -422.64196114195516, -1111.2377343428934, -514.2552478520198, -354.35854675680673, -1038.660699593892, -1015.9114823930478, -378.0521674274577, -1205.769470939932, -1030.1606965944147, -1250.5158585132187, -780.3221038820037, -671.4808050823565, -1319.4548064080973, -1291.4871575405075, -399.19049924005094, -1282.55930069597, -581.3475514780478, -1173.8920787279037, -1050.0824358787258, -239.69492896974694, -856.0571055815274, -20.55181977677899, -1000.5375327203262, -958.5661322623467, -1112.8790947596706, -178.0281314318527, -553.8282216942662, -1066.7755083010047, -1274.934835523716, -1314.4002620725266, -979.6837425773002, -992.0841399098572, -694.6371277254594, -973.5110334725224, -454.8624780148563, -975.4476513194666, -605.7848133077007, -1184.2950503994064, -885.1746210404995, -801.4976928162952, -1093.1228670428375, -294.059878885515, -979.7593155647382, -681.3987146105497, -1427.3829050533009, -661.2477852216757, -796.6508760214681, -458.79917084997356], "episode_lengths": [150, 66, 105, 150, 150, 150, 86, 150, 150, 150, 59, 150, 43, 90, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 106, 70, 97, 72, 150, 150, 67, 150, 150, 150, 59, 54, 119, 150, 150, 150, 101, 150, 150, 150, 150, 59, 150, 125, 139, 150, 126, 120, 98, 150, 131, 87, 150, 150, 97, 150, 150, 150, 138, 150, 150, 150, 137, 150, 129, 150, 150, 80, 150, 35, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 127, 150, 118, 150, 140, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 99], "policy_policy_0_reward": [-1366.168986950706, -211.2615211894976, -483.1998052923308, -1230.924846714158, -1134.0154937109842, -901.2448441639106, -189.98409120001514, -934.0517595333791, -1008.2491788368986, -1265.3019284217864, -150.67270615467726, -1017.2461798424458, -12.636206475162977, -273.3435656869107, -50.079763092694755, -994.6523168307716, -1037.0647674660124, -1010.8366037751649, -1126.34256589782, -1110.0940144429126, -861.7562040057536, -1265.679203171469, -1137.4076078207008, -1108.4573786685962, -330.25972579112215, -197.79264354017027, -396.085799681535, -211.39854051985526, -1029.5456213955324, -1304.3431592148295, -130.86786125103592, -909.1586351051419, -934.1105378486941, -1265.643528703978, -61.907665335869154, -117.37637020928872, -539.6915378594357, -875.9504319964711, -836.7446350547219, -1356.1128020410467, -423.73905103745585, -702.1093222141897, -1191.325018009265, -1286.5719197324966, -1206.8910293829078, -180.5754692178932, -1156.1774563236859, -674.3971467808036, -741.1303845186716, -1015.4912658402496, -640.1856926797647, -438.91203073312386, -422.64196114195516, -1111.2377343428934, -514.2552478520198, -354.35854675680673, -1038.660699593892, -1015.9114823930478, -378.0521674274577, -1205.769470939932, -1030.1606965944147, -1250.5158585132187, -780.3221038820037, -671.4808050823565, -1319.4548064080973, -1291.4871575405075, -399.19049924005094, -1282.55930069597, -581.3475514780478, -1173.8920787279037, -1050.0824358787258, -239.69492896974694, -856.0571055815274, -20.55181977677899, -1000.5375327203262, -958.5661322623467, -1112.8790947596706, -178.0281314318527, -553.8282216942662, -1066.7755083010047, -1274.934835523716, -1314.4002620725266, -979.6837425773002, -992.0841399098572, -694.6371277254594, -973.5110334725224, -454.8624780148563, -975.4476513194666, -605.7848133077007, -1184.2950503994064, -885.1746210404995, -801.4976928162952, -1093.1228670428375, -294.059878885515, -979.7593155647382, -681.3987146105497, -1427.3829050533009, -661.2477852216757, -796.6508760214681, -458.79917084997356]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5607560583673558, "mean_inference_ms": 1.6562715597578312, "mean_action_processing_ms": 0.2762475907031103, "mean_env_wait_ms": 3.4080027668111246, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013811826705932617, "StateBufferConnector_ms": 0.009409904479980469, "ViewRequirementAgentConnector_ms": 0.195159912109375}, "num_episodes": 31, "episode_return_max": -12.636206475162977, "episode_return_min": -1427.3829050533009, "episode_return_mean": -804.2220086278047, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.5574091407357, "num_env_steps_trained_throughput_per_sec": 311.5574091407357, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12760.975, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12760.909, "sample_time_ms": 1128.214, "learn_time_ms": 11569.827, "learn_throughput": 345.727, "synch_weights_time_ms": 62.031}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00015", "date": "2024-08-04_06-51-55", "timestamp": 1722734515, "time_this_iter_s": 12.85074520111084, "time_total_s": 51.094332218170166, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370879900>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 51.094332218170166, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.5, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.6502459953228632, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.680603246887525, "policy_loss": -0.011005487735383212, "vf_loss": 9.688635324438414, "vf_explained_var": 0.07939736886570851, "kl": 0.015567012953761153, "entropy": 1.4002541912098725, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -20.55181977677899, "episode_reward_min": -1427.3829050533009, "episode_reward_mean": -812.6880439521201, "episode_len_mean": 133.95, "episode_media": {}, "episodes_timesteps_total": 13395, "policy_reward_min": {"policy_0": -1427.3829050533009}, "policy_reward_max": {"policy_0": -20.55181977677899}, "policy_reward_mean": {"policy_0": -812.6880439521201}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-130.86786125103592, -909.1586351051419, -934.1105378486941, -1265.643528703978, -61.907665335869154, -117.37637020928872, -539.6915378594357, -875.9504319964711, -836.7446350547219, -1356.1128020410467, -423.73905103745585, -702.1093222141897, -1191.325018009265, -1286.5719197324966, -1206.8910293829078, -180.5754692178932, -1156.1774563236859, -674.3971467808036, -741.1303845186716, -1015.4912658402496, -640.1856926797647, -438.91203073312386, -422.64196114195516, -1111.2377343428934, -514.2552478520198, -354.35854675680673, -1038.660699593892, -1015.9114823930478, -378.0521674274577, -1205.769470939932, -1030.1606965944147, -1250.5158585132187, -780.3221038820037, -671.4808050823565, -1319.4548064080973, -1291.4871575405075, -399.19049924005094, -1282.55930069597, -581.3475514780478, -1173.8920787279037, -1050.0824358787258, -239.69492896974694, -856.0571055815274, -20.55181977677899, -1000.5375327203262, -958.5661322623467, -1112.8790947596706, -178.0281314318527, -553.8282216942662, -1066.7755083010047, -1274.934835523716, -1314.4002620725266, -979.6837425773002, -992.0841399098572, -694.6371277254594, -973.5110334725224, -454.8624780148563, -975.4476513194666, -605.7848133077007, -1184.2950503994064, -885.1746210404995, -801.4976928162952, -1093.1228670428375, -294.059878885515, -979.7593155647382, -681.3987146105497, -1427.3829050533009, -661.2477852216757, -796.6508760214681, -458.79917084997356, -501.20589913272863, -1026.069973612874, -1177.5605741865306, -1214.4742133189288, -923.8441790886508, -819.4347070333955, -979.0028030739667, -1148.494271696562, -1120.172971194506, -865.0189780943184, -368.8677604874991, -869.5556234846251, -692.7850893010502, -22.034555379977125, -1115.3321956426496, -866.3475215162349, -884.6260313177065, -1120.775965781168, -898.5423572500641, -158.61355465242286, -1401.0842932565254, -303.49618174203573, -223.24007258635652, -805.5967184884012, -1205.6829712811739, -501.0090760197124, -974.1078759813653, -891.382771391539, -462.849164738426, -655.492211187936], "episode_lengths": [67, 150, 150, 150, 59, 54, 119, 150, 150, 150, 101, 150, 150, 150, 150, 59, 150, 125, 139, 150, 126, 120, 98, 150, 131, 87, 150, 150, 97, 150, 150, 150, 138, 150, 150, 150, 137, 150, 129, 150, 150, 80, 150, 35, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 127, 150, 118, 150, 140, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 99, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 47, 150, 150, 150, 150, 150, 61, 150, 99, 94, 150, 150, 150, 150, 150, 108, 150], "policy_policy_0_reward": [-130.86786125103592, -909.1586351051419, -934.1105378486941, -1265.643528703978, -61.907665335869154, -117.37637020928872, -539.6915378594357, -875.9504319964711, -836.7446350547219, -1356.1128020410467, -423.73905103745585, -702.1093222141897, -1191.325018009265, -1286.5719197324966, -1206.8910293829078, -180.5754692178932, -1156.1774563236859, -674.3971467808036, -741.1303845186716, -1015.4912658402496, -640.1856926797647, -438.91203073312386, -422.64196114195516, -1111.2377343428934, -514.2552478520198, -354.35854675680673, -1038.660699593892, -1015.9114823930478, -378.0521674274577, -1205.769470939932, -1030.1606965944147, -1250.5158585132187, -780.3221038820037, -671.4808050823565, -1319.4548064080973, -1291.4871575405075, -399.19049924005094, -1282.55930069597, -581.3475514780478, -1173.8920787279037, -1050.0824358787258, -239.69492896974694, -856.0571055815274, -20.55181977677899, -1000.5375327203262, -958.5661322623467, -1112.8790947596706, -178.0281314318527, -553.8282216942662, -1066.7755083010047, -1274.934835523716, -1314.4002620725266, -979.6837425773002, -992.0841399098572, -694.6371277254594, -973.5110334725224, -454.8624780148563, -975.4476513194666, -605.7848133077007, -1184.2950503994064, -885.1746210404995, -801.4976928162952, -1093.1228670428375, -294.059878885515, -979.7593155647382, -681.3987146105497, -1427.3829050533009, -661.2477852216757, -796.6508760214681, -458.79917084997356, -501.20589913272863, -1026.069973612874, -1177.5605741865306, -1214.4742133189288, -923.8441790886508, -819.4347070333955, -979.0028030739667, -1148.494271696562, -1120.172971194506, -865.0189780943184, -368.8677604874991, -869.5556234846251, -692.7850893010502, -22.034555379977125, -1115.3321956426496, -866.3475215162349, -884.6260313177065, -1120.775965781168, -898.5423572500641, -158.61355465242286, -1401.0842932565254, -303.49618174203573, -223.24007258635652, -805.5967184884012, -1205.6829712811739, -501.0090760197124, -974.1078759813653, -891.382771391539, -462.849164738426, -655.492211187936]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5594411688920574, "mean_inference_ms": 1.6635697988856424, "mean_action_processing_ms": 0.27712228146299056, "mean_env_wait_ms": 3.4248431121689347, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013413190841674805, "StateBufferConnector_ms": 0.009409666061401367, "ViewRequirementAgentConnector_ms": 0.19451022148132324}, "num_episodes": 30, "episode_return_max": -20.55181977677899, "episode_return_min": -1427.3829050533009, "episode_return_mean": -812.6880439521201, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.4517401316464, "num_env_steps_trained_throughput_per_sec": 352.4517401316464, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12478.605, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12478.524, "sample_time_ms": 1133.716, "learn_time_ms": 11282.331, "learn_throughput": 354.537, "synch_weights_time_ms": 61.653}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00015", "date": "2024-08-04_06-52-06", "timestamp": 1722734526, "time_this_iter_s": 11.361093997955322, "time_total_s": 62.45542621612549, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237087bc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.45542621612549, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.3625, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.406895164276163, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.579512097438176, "policy_loss": -0.016956645039802726, "vf_loss": 9.592842037479082, "vf_explained_var": 0.14686855748295785, "kl": 0.018824355681984654, "entropy": 1.3819341154148181, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -20.55181977677899, "episode_reward_min": -1427.3829050533009, "episode_reward_mean": -824.0697063010081, "episode_len_mean": 136.94, "episode_media": {}, "episodes_timesteps_total": 13694, "policy_reward_min": {"policy_0": -1427.3829050533009}, "policy_reward_max": {"policy_0": -20.55181977677899}, "policy_reward_mean": {"policy_0": -824.0697063010081}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1030.1606965944147, -1250.5158585132187, -780.3221038820037, -671.4808050823565, -1319.4548064080973, -1291.4871575405075, -399.19049924005094, -1282.55930069597, -581.3475514780478, -1173.8920787279037, -1050.0824358787258, -239.69492896974694, -856.0571055815274, -20.55181977677899, -1000.5375327203262, -958.5661322623467, -1112.8790947596706, -178.0281314318527, -553.8282216942662, -1066.7755083010047, -1274.934835523716, -1314.4002620725266, -979.6837425773002, -992.0841399098572, -694.6371277254594, -973.5110334725224, -454.8624780148563, -975.4476513194666, -605.7848133077007, -1184.2950503994064, -885.1746210404995, -801.4976928162952, -1093.1228670428375, -294.059878885515, -979.7593155647382, -681.3987146105497, -1427.3829050533009, -661.2477852216757, -796.6508760214681, -458.79917084997356, -501.20589913272863, -1026.069973612874, -1177.5605741865306, -1214.4742133189288, -923.8441790886508, -819.4347070333955, -979.0028030739667, -1148.494271696562, -1120.172971194506, -865.0189780943184, -368.8677604874991, -869.5556234846251, -692.7850893010502, -22.034555379977125, -1115.3321956426496, -866.3475215162349, -884.6260313177065, -1120.775965781168, -898.5423572500641, -158.61355465242286, -1401.0842932565254, -303.49618174203573, -223.24007258635652, -805.5967184884012, -1205.6829712811739, -501.0090760197124, -974.1078759813653, -891.382771391539, -462.849164738426, -655.492211187936, -888.2734966710158, -894.1126194503712, -862.1301534257482, -435.0720266255795, -1174.0508675562103, -1272.917001939632, -740.6120936832417, -392.5951891865598, -183.46676062932963, -1262.876583332573, -313.13444941260724, -791.7917971755315, -1169.033797262742, -790.637285986881, -1050.2485339829284, -873.8196342664214, -896.1476775539776, -305.37350020749557, -1156.5213281165043, -1085.1513181699565, -1029.471742235585, -1121.9124256360735, -1112.414815526328, -343.30391818154305, -404.14559840260614, -608.8152389583998, -690.6987737324797, -645.8445013447429, -1169.3521435445423, -200.1980650153852], "episode_lengths": [150, 150, 138, 150, 150, 150, 137, 150, 129, 150, 150, 80, 150, 35, 150, 150, 150, 90, 150, 150, 150, 150, 150, 150, 127, 150, 118, 150, 140, 150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 99, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 47, 150, 150, 150, 150, 150, 61, 150, 99, 94, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 108, 150, 150, 129, 129, 73, 150, 122, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 127, 99, 135, 150, 150, 150, 79], "policy_policy_0_reward": [-1030.1606965944147, -1250.5158585132187, -780.3221038820037, -671.4808050823565, -1319.4548064080973, -1291.4871575405075, -399.19049924005094, -1282.55930069597, -581.3475514780478, -1173.8920787279037, -1050.0824358787258, -239.69492896974694, -856.0571055815274, -20.55181977677899, -1000.5375327203262, -958.5661322623467, -1112.8790947596706, -178.0281314318527, -553.8282216942662, -1066.7755083010047, -1274.934835523716, -1314.4002620725266, -979.6837425773002, -992.0841399098572, -694.6371277254594, -973.5110334725224, -454.8624780148563, -975.4476513194666, -605.7848133077007, -1184.2950503994064, -885.1746210404995, -801.4976928162952, -1093.1228670428375, -294.059878885515, -979.7593155647382, -681.3987146105497, -1427.3829050533009, -661.2477852216757, -796.6508760214681, -458.79917084997356, -501.20589913272863, -1026.069973612874, -1177.5605741865306, -1214.4742133189288, -923.8441790886508, -819.4347070333955, -979.0028030739667, -1148.494271696562, -1120.172971194506, -865.0189780943184, -368.8677604874991, -869.5556234846251, -692.7850893010502, -22.034555379977125, -1115.3321956426496, -866.3475215162349, -884.6260313177065, -1120.775965781168, -898.5423572500641, -158.61355465242286, -1401.0842932565254, -303.49618174203573, -223.24007258635652, -805.5967184884012, -1205.6829712811739, -501.0090760197124, -974.1078759813653, -891.382771391539, -462.849164738426, -655.492211187936, -888.2734966710158, -894.1126194503712, -862.1301534257482, -435.0720266255795, -1174.0508675562103, -1272.917001939632, -740.6120936832417, -392.5951891865598, -183.46676062932963, -1262.876583332573, -313.13444941260724, -791.7917971755315, -1169.033797262742, -790.637285986881, -1050.2485339829284, -873.8196342664214, -896.1476775539776, -305.37350020749557, -1156.5213281165043, -1085.1513181699565, -1029.471742235585, -1121.9124256360735, -1112.414815526328, -343.30391818154305, -404.14559840260614, -608.8152389583998, -690.6987737324797, -645.8445013447429, -1169.3521435445423, -200.1980650153852]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.559427182106941, "mean_inference_ms": 1.6684260484348, "mean_action_processing_ms": 0.27782417785114083, "mean_env_wait_ms": 3.4332517488613403, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013917684555053711, "StateBufferConnector_ms": 0.009392023086547852, "ViewRequirementAgentConnector_ms": 0.19633150100708008}, "num_episodes": 30, "episode_return_max": -20.55181977677899, "episode_return_min": -1427.3829050533009, "episode_return_mean": -824.0697063010081, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 322.87590295403305, "num_env_steps_trained_throughput_per_sec": 322.87590295403305, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12463.616, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12463.537, "sample_time_ms": 1129.47, "learn_time_ms": 11267.923, "learn_throughput": 354.99, "synch_weights_time_ms": 65.318}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00015", "date": "2024-08-04_06-52-19", "timestamp": 1722734539, "time_this_iter_s": 12.401660442352295, "time_total_s": 74.85708665847778, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708e0d30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 74.85708665847778, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.877777777777776, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1590545032794277, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.521601406733195, "policy_loss": -0.010633356601465494, "vf_loss": 9.528522700071335, "vf_explained_var": 0.20344824281831583, "kl": 0.0192655072566898, "entropy": 1.4105514326443276, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -22.034555379977125, "episode_reward_min": -1427.3829050533009, "episode_reward_mean": -787.6784410582509, "episode_len_mean": 136.62, "episode_media": {}, "episodes_timesteps_total": 13662, "policy_reward_min": {"policy_0": -1427.3829050533009}, "policy_reward_max": {"policy_0": -22.034555379977125}, "policy_reward_mean": {"policy_0": -787.6784410582509}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1184.2950503994064, -885.1746210404995, -801.4976928162952, -1093.1228670428375, -294.059878885515, -979.7593155647382, -681.3987146105497, -1427.3829050533009, -661.2477852216757, -796.6508760214681, -458.79917084997356, -501.20589913272863, -1026.069973612874, -1177.5605741865306, -1214.4742133189288, -923.8441790886508, -819.4347070333955, -979.0028030739667, -1148.494271696562, -1120.172971194506, -865.0189780943184, -368.8677604874991, -869.5556234846251, -692.7850893010502, -22.034555379977125, -1115.3321956426496, -866.3475215162349, -884.6260313177065, -1120.775965781168, -898.5423572500641, -158.61355465242286, -1401.0842932565254, -303.49618174203573, -223.24007258635652, -805.5967184884012, -1205.6829712811739, -501.0090760197124, -974.1078759813653, -891.382771391539, -462.849164738426, -655.492211187936, -888.2734966710158, -894.1126194503712, -862.1301534257482, -435.0720266255795, -1174.0508675562103, -1272.917001939632, -740.6120936832417, -392.5951891865598, -183.46676062932963, -1262.876583332573, -313.13444941260724, -791.7917971755315, -1169.033797262742, -790.637285986881, -1050.2485339829284, -873.8196342664214, -896.1476775539776, -305.37350020749557, -1156.5213281165043, -1085.1513181699565, -1029.471742235585, -1121.9124256360735, -1112.414815526328, -343.30391818154305, -404.14559840260614, -608.8152389583998, -690.6987737324797, -645.8445013447429, -1169.3521435445423, -200.1980650153852, -1131.974447266479, -178.58717655373258, -874.7859434726056, -919.3830055549831, -551.3261253525845, -705.3166347319296, -925.9342392824224, -224.64834879976695, -1052.5683186602116, -414.72815051418263, -824.7413688084648, -857.2594465119167, -1217.8007903406483, -1011.8739873896903, -271.5833666571883, -513.0700087572874, -1201.5436374545293, -938.1235553334669, -1168.152592727666, -298.3913098951656, -467.22844817569217, -215.08979225060006, -366.5722415528796, -228.16772488187237, -598.5446242520486, -1091.0491157345589, -1363.8362588246218, -950.3010076769758, -881.0496617723351], "episode_lengths": [150, 150, 150, 150, 112, 150, 150, 150, 150, 150, 99, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 96, 150, 150, 47, 150, 150, 150, 150, 150, 61, 150, 99, 94, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 108, 150, 150, 129, 129, 73, 150, 122, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 127, 99, 135, 150, 150, 150, 79, 150, 57, 150, 150, 139, 150, 150, 109, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 100, 150, 85, 150, 67, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1184.2950503994064, -885.1746210404995, -801.4976928162952, -1093.1228670428375, -294.059878885515, -979.7593155647382, -681.3987146105497, -1427.3829050533009, -661.2477852216757, -796.6508760214681, -458.79917084997356, -501.20589913272863, -1026.069973612874, -1177.5605741865306, -1214.4742133189288, -923.8441790886508, -819.4347070333955, -979.0028030739667, -1148.494271696562, -1120.172971194506, -865.0189780943184, -368.8677604874991, -869.5556234846251, -692.7850893010502, -22.034555379977125, -1115.3321956426496, -866.3475215162349, -884.6260313177065, -1120.775965781168, -898.5423572500641, -158.61355465242286, -1401.0842932565254, -303.49618174203573, -223.24007258635652, -805.5967184884012, -1205.6829712811739, -501.0090760197124, -974.1078759813653, -891.382771391539, -462.849164738426, -655.492211187936, -888.2734966710158, -894.1126194503712, -862.1301534257482, -435.0720266255795, -1174.0508675562103, -1272.917001939632, -740.6120936832417, -392.5951891865598, -183.46676062932963, -1262.876583332573, -313.13444941260724, -791.7917971755315, -1169.033797262742, -790.637285986881, -1050.2485339829284, -873.8196342664214, -896.1476775539776, -305.37350020749557, -1156.5213281165043, -1085.1513181699565, -1029.471742235585, -1121.9124256360735, -1112.414815526328, -343.30391818154305, -404.14559840260614, -608.8152389583998, -690.6987737324797, -645.8445013447429, -1169.3521435445423, -200.1980650153852, -1131.974447266479, -178.58717655373258, -874.7859434726056, -919.3830055549831, -551.3261253525845, -705.3166347319296, -925.9342392824224, -224.64834879976695, -1052.5683186602116, -414.72815051418263, -824.7413688084648, -857.2594465119167, -1217.8007903406483, -1011.8739873896903, -271.5833666571883, -513.0700087572874, -1201.5436374545293, -938.1235553334669, -1168.152592727666, -298.3913098951656, -467.22844817569217, -215.08979225060006, -366.5722415528796, -228.16772488187237, -598.5446242520486, -1091.0491157345589, -1363.8362588246218, -950.3010076769758, -881.0496617723351]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5589668620358937, "mean_inference_ms": 1.6687915135341078, "mean_action_processing_ms": 0.2775453755679829, "mean_env_wait_ms": 3.4330984325356595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01306772232055664, "StateBufferConnector_ms": 0.00850224494934082, "ViewRequirementAgentConnector_ms": 0.18927407264709473}, "num_episodes": 29, "episode_return_max": -22.034555379977125, "episode_return_min": -1427.3829050533009, "episode_return_mean": -787.6784410582509, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 408.71185994828085, "num_env_steps_trained_throughput_per_sec": 408.71185994828085, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12081.223, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12081.143, "sample_time_ms": 1125.182, "learn_time_ms": 10892.865, "learn_throughput": 367.213, "synch_weights_time_ms": 62.289}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00015", "date": "2024-08-04_06-52-29", "timestamp": 1722734549, "time_this_iter_s": 9.800259113311768, "time_total_s": 84.65734577178955, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708e1900>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 84.65734577178955, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 20.999999999999996, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.849425004174312, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.283696401615938, "policy_loss": -0.011376391522450529, "vf_loss": 9.291774317622185, "vf_explained_var": 0.1724617434044679, "kl": 0.017153443917535097, "entropy": 1.322146467367808, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -27.603248615615396, "episode_reward_min": -1401.0842932565254, "episode_reward_mean": -768.4447791070961, "episode_len_mean": 135.89, "episode_media": {}, "episodes_timesteps_total": 13589, "policy_reward_min": {"policy_0": -1401.0842932565254}, "policy_reward_max": {"policy_0": -27.603248615615396}, "policy_reward_mean": {"policy_0": -768.4447791070961}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-884.6260313177065, -1120.775965781168, -898.5423572500641, -158.61355465242286, -1401.0842932565254, -303.49618174203573, -223.24007258635652, -805.5967184884012, -1205.6829712811739, -501.0090760197124, -974.1078759813653, -891.382771391539, -462.849164738426, -655.492211187936, -888.2734966710158, -894.1126194503712, -862.1301534257482, -435.0720266255795, -1174.0508675562103, -1272.917001939632, -740.6120936832417, -392.5951891865598, -183.46676062932963, -1262.876583332573, -313.13444941260724, -791.7917971755315, -1169.033797262742, -790.637285986881, -1050.2485339829284, -873.8196342664214, -896.1476775539776, -305.37350020749557, -1156.5213281165043, -1085.1513181699565, -1029.471742235585, -1121.9124256360735, -1112.414815526328, -343.30391818154305, -404.14559840260614, -608.8152389583998, -690.6987737324797, -645.8445013447429, -1169.3521435445423, -200.1980650153852, -1131.974447266479, -178.58717655373258, -874.7859434726056, -919.3830055549831, -551.3261253525845, -705.3166347319296, -925.9342392824224, -224.64834879976695, -1052.5683186602116, -414.72815051418263, -824.7413688084648, -857.2594465119167, -1217.8007903406483, -1011.8739873896903, -271.5833666571883, -513.0700087572874, -1201.5436374545293, -938.1235553334669, -1168.152592727666, -298.3913098951656, -467.22844817569217, -215.08979225060006, -366.5722415528796, -228.16772488187237, -598.5446242520486, -1091.0491157345589, -1363.8362588246218, -950.3010076769758, -881.0496617723351, -121.616882439111, -977.9544422619329, -951.4156095109053, -466.02319161784516, -186.1954703978249, -644.80158749663, -1120.894329054978, -1235.5747414454192, -266.31444913135925, -27.603248615615396, -1048.7928162124326, -906.4870697659868, -609.9651500924252, -1068.282528169842, -635.9685700184837, -933.31930809921, -898.4159420708521, -1086.5693620611423, -186.39123347926235, -1135.370953547914, -780.4219675767013, -625.8309068023806, -724.2725731078059, -1195.761359809709, -1243.8659757304406, -1266.8131635229577, -705.3011665961235], "episode_lengths": [150, 150, 150, 61, 150, 99, 94, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 108, 150, 150, 129, 129, 73, 150, 122, 150, 150, 150, 150, 150, 150, 80, 150, 150, 150, 150, 150, 127, 99, 135, 150, 150, 150, 79, 150, 57, 150, 150, 139, 150, 150, 109, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 100, 150, 85, 150, 67, 150, 150, 150, 150, 150, 55, 150, 150, 150, 91, 150, 150, 150, 111, 40, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-884.6260313177065, -1120.775965781168, -898.5423572500641, -158.61355465242286, -1401.0842932565254, -303.49618174203573, -223.24007258635652, -805.5967184884012, -1205.6829712811739, -501.0090760197124, -974.1078759813653, -891.382771391539, -462.849164738426, -655.492211187936, -888.2734966710158, -894.1126194503712, -862.1301534257482, -435.0720266255795, -1174.0508675562103, -1272.917001939632, -740.6120936832417, -392.5951891865598, -183.46676062932963, -1262.876583332573, -313.13444941260724, -791.7917971755315, -1169.033797262742, -790.637285986881, -1050.2485339829284, -873.8196342664214, -896.1476775539776, -305.37350020749557, -1156.5213281165043, -1085.1513181699565, -1029.471742235585, -1121.9124256360735, -1112.414815526328, -343.30391818154305, -404.14559840260614, -608.8152389583998, -690.6987737324797, -645.8445013447429, -1169.3521435445423, -200.1980650153852, -1131.974447266479, -178.58717655373258, -874.7859434726056, -919.3830055549831, -551.3261253525845, -705.3166347319296, -925.9342392824224, -224.64834879976695, -1052.5683186602116, -414.72815051418263, -824.7413688084648, -857.2594465119167, -1217.8007903406483, -1011.8739873896903, -271.5833666571883, -513.0700087572874, -1201.5436374545293, -938.1235553334669, -1168.152592727666, -298.3913098951656, -467.22844817569217, -215.08979225060006, -366.5722415528796, -228.16772488187237, -598.5446242520486, -1091.0491157345589, -1363.8362588246218, -950.3010076769758, -881.0496617723351, -121.616882439111, -977.9544422619329, -951.4156095109053, -466.02319161784516, -186.1954703978249, -644.80158749663, -1120.894329054978, -1235.5747414454192, -266.31444913135925, -27.603248615615396, -1048.7928162124326, -906.4870697659868, -609.9651500924252, -1068.282528169842, -635.9685700184837, -933.31930809921, -898.4159420708521, -1086.5693620611423, -186.39123347926235, -1135.370953547914, -780.4219675767013, -625.8309068023806, -724.2725731078059, -1195.761359809709, -1243.8659757304406, -1266.8131635229577, -705.3011665961235]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5582746896464257, "mean_inference_ms": 1.6715904602835538, "mean_action_processing_ms": 0.27717520978361165, "mean_env_wait_ms": 3.4391594338731846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012800216674804688, "StateBufferConnector_ms": 0.00832366943359375, "ViewRequirementAgentConnector_ms": 0.18916106224060059}, "num_episodes": 27, "episode_return_max": -27.603248615615396, "episode_return_min": -1401.0842932565254, "episode_return_mean": -768.4447791070961, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 451.2712292379107, "num_env_steps_trained_throughput_per_sec": 451.2712292379107, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 11679.053, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11678.974, "sample_time_ms": 1123.975, "learn_time_ms": 10494.079, "learn_throughput": 381.167, "synch_weights_time_ms": 60.13}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00015", "date": "2024-08-04_06-52-37", "timestamp": 1722734557, "time_this_iter_s": 8.87590765953064, "time_total_s": 93.53325343132019, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237087acb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 93.53325343132019, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 21.330769230769235, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.173764469474554, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.689355265100797, "policy_loss": -0.009024664232856593, "vf_loss": 9.695053473114967, "vf_explained_var": 0.24588012900203465, "kl": 0.017263903023285822, "entropy": 1.2631959920128186, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -2.8281098652430723, "episode_reward_min": -1363.8362588246218, "episode_reward_mean": -713.3054657930733, "episode_len_mean": 134.54, "episode_media": {}, "episodes_timesteps_total": 13454, "policy_reward_min": {"policy_0": -1363.8362588246218}, "policy_reward_max": {"policy_0": -2.8281098652430723}, "policy_reward_mean": {"policy_0": -713.3054657930733}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-305.37350020749557, -1156.5213281165043, -1085.1513181699565, -1029.471742235585, -1121.9124256360735, -1112.414815526328, -343.30391818154305, -404.14559840260614, -608.8152389583998, -690.6987737324797, -645.8445013447429, -1169.3521435445423, -200.1980650153852, -1131.974447266479, -178.58717655373258, -874.7859434726056, -919.3830055549831, -551.3261253525845, -705.3166347319296, -925.9342392824224, -224.64834879976695, -1052.5683186602116, -414.72815051418263, -824.7413688084648, -857.2594465119167, -1217.8007903406483, -1011.8739873896903, -271.5833666571883, -513.0700087572874, -1201.5436374545293, -938.1235553334669, -1168.152592727666, -298.3913098951656, -467.22844817569217, -215.08979225060006, -366.5722415528796, -228.16772488187237, -598.5446242520486, -1091.0491157345589, -1363.8362588246218, -950.3010076769758, -881.0496617723351, -121.616882439111, -977.9544422619329, -951.4156095109053, -466.02319161784516, -186.1954703978249, -644.80158749663, -1120.894329054978, -1235.5747414454192, -266.31444913135925, -27.603248615615396, -1048.7928162124326, -906.4870697659868, -609.9651500924252, -1068.282528169842, -635.9685700184837, -933.31930809921, -898.4159420708521, -1086.5693620611423, -186.39123347926235, -1135.370953547914, -780.4219675767013, -625.8309068023806, -724.2725731078059, -1195.761359809709, -1243.8659757304406, -1266.8131635229577, -705.3011665961235, -950.6999214542675, -1014.9873035566208, -633.8577160447761, -2.8281098652430723, -421.38593198270814, -947.6272471404337, -675.0273766484904, -617.6549418953663, -956.2035944822467, -220.35712931800694, -542.3915560633621, -616.8880075781353, -358.18746306087036, -595.2684267076656, -547.8989364832657, -549.1953543257179, -1340.483201598394, -925.8780035256257, -914.5586244274269, -470.5989012875354, -609.3902483312608, -903.6407531822548, -413.7173154511129, -271.2624578824185, -347.598312129389, -606.9389713742521, -1085.8628195670335, -409.0427921932025, -576.2072901653049, -322.8188166582584, -115.03035803324], "episode_lengths": [80, 150, 150, 150, 150, 150, 127, 99, 135, 150, 150, 150, 79, 150, 57, 150, 150, 139, 150, 150, 109, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 100, 150, 85, 150, 67, 150, 150, 150, 150, 150, 55, 150, 150, 150, 91, 150, 150, 150, 111, 40, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 30, 150, 150, 150, 150, 150, 70, 150, 150, 86, 150, 150, 150, 150, 150, 150, 132, 150, 150, 118, 150, 88, 150, 150, 106, 150, 85, 73], "policy_policy_0_reward": [-305.37350020749557, -1156.5213281165043, -1085.1513181699565, -1029.471742235585, -1121.9124256360735, -1112.414815526328, -343.30391818154305, -404.14559840260614, -608.8152389583998, -690.6987737324797, -645.8445013447429, -1169.3521435445423, -200.1980650153852, -1131.974447266479, -178.58717655373258, -874.7859434726056, -919.3830055549831, -551.3261253525845, -705.3166347319296, -925.9342392824224, -224.64834879976695, -1052.5683186602116, -414.72815051418263, -824.7413688084648, -857.2594465119167, -1217.8007903406483, -1011.8739873896903, -271.5833666571883, -513.0700087572874, -1201.5436374545293, -938.1235553334669, -1168.152592727666, -298.3913098951656, -467.22844817569217, -215.08979225060006, -366.5722415528796, -228.16772488187237, -598.5446242520486, -1091.0491157345589, -1363.8362588246218, -950.3010076769758, -881.0496617723351, -121.616882439111, -977.9544422619329, -951.4156095109053, -466.02319161784516, -186.1954703978249, -644.80158749663, -1120.894329054978, -1235.5747414454192, -266.31444913135925, -27.603248615615396, -1048.7928162124326, -906.4870697659868, -609.9651500924252, -1068.282528169842, -635.9685700184837, -933.31930809921, -898.4159420708521, -1086.5693620611423, -186.39123347926235, -1135.370953547914, -780.4219675767013, -625.8309068023806, -724.2725731078059, -1195.761359809709, -1243.8659757304406, -1266.8131635229577, -705.3011665961235, -950.6999214542675, -1014.9873035566208, -633.8577160447761, -2.8281098652430723, -421.38593198270814, -947.6272471404337, -675.0273766484904, -617.6549418953663, -956.2035944822467, -220.35712931800694, -542.3915560633621, -616.8880075781353, -358.18746306087036, -595.2684267076656, -547.8989364832657, -549.1953543257179, -1340.483201598394, -925.8780035256257, -914.5586244274269, -470.5989012875354, -609.3902483312608, -903.6407531822548, -413.7173154511129, -271.2624578824185, -347.598312129389, -606.9389713742521, -1085.8628195670335, -409.0427921932025, -576.2072901653049, -322.8188166582584, -115.03035803324]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5566364259691556, "mean_inference_ms": 1.6688727409342805, "mean_action_processing_ms": 0.27627480038931584, "mean_env_wait_ms": 3.4354335073913775, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012290000915527344, "StateBufferConnector_ms": 0.007999420166015625, "ViewRequirementAgentConnector_ms": 0.18634986877441406}, "num_episodes": 31, "episode_return_max": -2.8281098652430723, "episode_return_min": -1363.8362588246218, "episode_return_mean": -713.3054657930733, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.9236492971352, "num_env_steps_trained_throughput_per_sec": 304.9236492971352, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 11838.941, "restore_workers_time_ms": 0.032, "training_step_time_ms": 11838.863, "sample_time_ms": 1127.139, "learn_time_ms": 10649.542, "learn_throughput": 375.603, "synch_weights_time_ms": 61.395}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00015", "date": "2024-08-04_06-52-51", "timestamp": 1722734571, "time_this_iter_s": 13.129827499389648, "time_total_s": 106.66308093070984, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237087b880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 106.66308093070984, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.215789473684207, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.288987212317685, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.371439975500106, "policy_loss": -0.009805244080295476, "vf_loss": 9.37813083032767, "vf_explained_var": 0.26101862732321024, "kl": 0.016251118072735462, "entropy": 1.358148686711987, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -2.8281098652430723, "episode_reward_min": -1363.8362588246218, "episode_reward_mean": -727.3039417130763, "episode_len_mean": 137.19, "episode_media": {}, "episodes_timesteps_total": 13719, "policy_reward_min": {"policy_0": -1363.8362588246218}, "policy_reward_max": {"policy_0": -2.8281098652430723}, "policy_reward_mean": {"policy_0": -727.3039417130763}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-938.1235553334669, -1168.152592727666, -298.3913098951656, -467.22844817569217, -215.08979225060006, -366.5722415528796, -228.16772488187237, -598.5446242520486, -1091.0491157345589, -1363.8362588246218, -950.3010076769758, -881.0496617723351, -121.616882439111, -977.9544422619329, -951.4156095109053, -466.02319161784516, -186.1954703978249, -644.80158749663, -1120.894329054978, -1235.5747414454192, -266.31444913135925, -27.603248615615396, -1048.7928162124326, -906.4870697659868, -609.9651500924252, -1068.282528169842, -635.9685700184837, -933.31930809921, -898.4159420708521, -1086.5693620611423, -186.39123347926235, -1135.370953547914, -780.4219675767013, -625.8309068023806, -724.2725731078059, -1195.761359809709, -1243.8659757304406, -1266.8131635229577, -705.3011665961235, -950.6999214542675, -1014.9873035566208, -633.8577160447761, -2.8281098652430723, -421.38593198270814, -947.6272471404337, -675.0273766484904, -617.6549418953663, -956.2035944822467, -220.35712931800694, -542.3915560633621, -616.8880075781353, -358.18746306087036, -595.2684267076656, -547.8989364832657, -549.1953543257179, -1340.483201598394, -925.8780035256257, -914.5586244274269, -470.5989012875354, -609.3902483312608, -903.6407531822548, -413.7173154511129, -271.2624578824185, -347.598312129389, -606.9389713742521, -1085.8628195670335, -409.0427921932025, -576.2072901653049, -322.8188166582584, -115.03035803324, -484.2973680939402, -860.8300489125921, -1271.7097828684177, -1181.506110498076, -1285.5919956334199, -72.4807960416146, -655.5048705539645, -633.5686388747913, -1006.1736694648058, -196.46652966919683, -884.1521097415466, -744.8091653061592, -529.1570246682234, -1105.6954296525673, -1157.0211914941592, -784.4530156118861, -773.2992239900361, -844.8570525275777, -757.3905029313971, -926.0287729147066, -1029.414660351021, -452.09031226648347, -611.0827077234668, -938.1368949351472, -630.9064388866497, -1345.6118058363913, -518.2564681256196, -1219.3288690670604, -678.4305513935232, -571.9239491461173], "episode_lengths": [150, 150, 100, 150, 85, 150, 67, 150, 150, 150, 150, 150, 55, 150, 150, 150, 91, 150, 150, 150, 111, 40, 150, 150, 150, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 30, 150, 150, 150, 150, 150, 70, 150, 150, 86, 150, 150, 150, 150, 150, 150, 132, 150, 150, 118, 150, 88, 150, 150, 106, 150, 85, 73, 150, 150, 150, 150, 150, 49, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-938.1235553334669, -1168.152592727666, -298.3913098951656, -467.22844817569217, -215.08979225060006, -366.5722415528796, -228.16772488187237, -598.5446242520486, -1091.0491157345589, -1363.8362588246218, -950.3010076769758, -881.0496617723351, -121.616882439111, -977.9544422619329, -951.4156095109053, -466.02319161784516, -186.1954703978249, -644.80158749663, -1120.894329054978, -1235.5747414454192, -266.31444913135925, -27.603248615615396, -1048.7928162124326, -906.4870697659868, -609.9651500924252, -1068.282528169842, -635.9685700184837, -933.31930809921, -898.4159420708521, -1086.5693620611423, -186.39123347926235, -1135.370953547914, -780.4219675767013, -625.8309068023806, -724.2725731078059, -1195.761359809709, -1243.8659757304406, -1266.8131635229577, -705.3011665961235, -950.6999214542675, -1014.9873035566208, -633.8577160447761, -2.8281098652430723, -421.38593198270814, -947.6272471404337, -675.0273766484904, -617.6549418953663, -956.2035944822467, -220.35712931800694, -542.3915560633621, -616.8880075781353, -358.18746306087036, -595.2684267076656, -547.8989364832657, -549.1953543257179, -1340.483201598394, -925.8780035256257, -914.5586244274269, -470.5989012875354, -609.3902483312608, -903.6407531822548, -413.7173154511129, -271.2624578824185, -347.598312129389, -606.9389713742521, -1085.8628195670335, -409.0427921932025, -576.2072901653049, -322.8188166582584, -115.03035803324, -484.2973680939402, -860.8300489125921, -1271.7097828684177, -1181.506110498076, -1285.5919956334199, -72.4807960416146, -655.5048705539645, -633.5686388747913, -1006.1736694648058, -196.46652966919683, -884.1521097415466, -744.8091653061592, -529.1570246682234, -1105.6954296525673, -1157.0211914941592, -784.4530156118861, -773.2992239900361, -844.8570525275777, -757.3905029313971, -926.0287729147066, -1029.414660351021, -452.09031226648347, -611.0827077234668, -938.1368949351472, -630.9064388866497, -1345.6118058363913, -518.2564681256196, -1219.3288690670604, -678.4305513935232, -571.9239491461173]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560858658489566, "mean_inference_ms": 1.6685832571645958, "mean_action_processing_ms": 0.2759492181718193, "mean_env_wait_ms": 3.4357422183499606, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012044429779052734, "StateBufferConnector_ms": 0.007938146591186523, "ViewRequirementAgentConnector_ms": 0.18773245811462402}, "num_episodes": 30, "episode_return_max": -2.8281098652430723, "episode_return_min": -1363.8362588246218, "episode_return_mean": -727.3039417130763, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.90695224470846, "num_env_steps_trained_throughput_per_sec": 308.90695224470846, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 11949.937, "restore_workers_time_ms": 0.033, "training_step_time_ms": 11949.858, "sample_time_ms": 1126.342, "learn_time_ms": 10760.785, "learn_throughput": 371.72, "synch_weights_time_ms": 61.939}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00015", "date": "2024-08-04_06-53-04", "timestamp": 1722734584, "time_this_iter_s": 12.962835550308228, "time_total_s": 119.62591648101807, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237087a200>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 119.62591648101807, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.51111111111111, "ram_util_percent": 28.01111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.456238830213746, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.377710009614626, "policy_loss": -0.002201623472501524, "vf_loss": 9.376886721452077, "vf_explained_var": 0.33946755789220334, "kl": 0.01578818171540964, "entropy": 1.3275667671114206, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": 4.824373229624248, "episode_reward_min": -1367.5587924038452, "episode_reward_mean": -705.3563201830798, "episode_len_mean": 135.09, "episode_media": {}, "episodes_timesteps_total": 13509, "policy_reward_min": {"policy_0": -1367.5587924038452}, "policy_reward_max": {"policy_0": 4.824373229624248}, "policy_reward_mean": {"policy_0": -705.3563201830798}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-780.4219675767013, -625.8309068023806, -724.2725731078059, -1195.761359809709, -1243.8659757304406, -1266.8131635229577, -705.3011665961235, -950.6999214542675, -1014.9873035566208, -633.8577160447761, -2.8281098652430723, -421.38593198270814, -947.6272471404337, -675.0273766484904, -617.6549418953663, -956.2035944822467, -220.35712931800694, -542.3915560633621, -616.8880075781353, -358.18746306087036, -595.2684267076656, -547.8989364832657, -549.1953543257179, -1340.483201598394, -925.8780035256257, -914.5586244274269, -470.5989012875354, -609.3902483312608, -903.6407531822548, -413.7173154511129, -271.2624578824185, -347.598312129389, -606.9389713742521, -1085.8628195670335, -409.0427921932025, -576.2072901653049, -322.8188166582584, -115.03035803324, -484.2973680939402, -860.8300489125921, -1271.7097828684177, -1181.506110498076, -1285.5919956334199, -72.4807960416146, -655.5048705539645, -633.5686388747913, -1006.1736694648058, -196.46652966919683, -884.1521097415466, -744.8091653061592, -529.1570246682234, -1105.6954296525673, -1157.0211914941592, -784.4530156118861, -773.2992239900361, -844.8570525275777, -757.3905029313971, -926.0287729147066, -1029.414660351021, -452.09031226648347, -611.0827077234668, -938.1368949351472, -630.9064388866497, -1345.6118058363913, -518.2564681256196, -1219.3288690670604, -678.4305513935232, -571.9239491461173, -451.23847113986375, -801.6292736174634, -461.79960025453573, -324.561078268304, -564.2365905027372, -1117.9948731472637, -404.1582837822451, -900.354275331737, -881.7011828667193, -213.95976744561477, -497.0661019334339, -195.00751657416913, -323.5297332296424, -944.8554296111722, -731.7017240127684, -1225.7643838818017, -755.4687943573274, -586.219333277444, -240.21582488974045, -93.00480671731333, -678.0985041994207, -842.1307894825567, -952.6546957551864, -699.0706485991676, -537.4095294536194, 4.824373229624248, -1222.620474314628, -1184.5045178885916, -1181.5592354031014, -237.86526765714854, -266.5859387984753, -1367.5587924038452], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 30, 150, 150, 150, 150, 150, 70, 150, 150, 86, 150, 150, 150, 150, 150, 150, 132, 150, 150, 118, 150, 88, 150, 150, 106, 150, 85, 73, 150, 150, 150, 150, 150, 49, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 110, 88, 150, 150, 101, 150, 150, 73, 150, 91, 87, 150, 150, 150, 150, 150, 69, 67, 150, 150, 150, 150, 150, 30, 150, 150, 150, 94, 94, 150], "policy_policy_0_reward": [-780.4219675767013, -625.8309068023806, -724.2725731078059, -1195.761359809709, -1243.8659757304406, -1266.8131635229577, -705.3011665961235, -950.6999214542675, -1014.9873035566208, -633.8577160447761, -2.8281098652430723, -421.38593198270814, -947.6272471404337, -675.0273766484904, -617.6549418953663, -956.2035944822467, -220.35712931800694, -542.3915560633621, -616.8880075781353, -358.18746306087036, -595.2684267076656, -547.8989364832657, -549.1953543257179, -1340.483201598394, -925.8780035256257, -914.5586244274269, -470.5989012875354, -609.3902483312608, -903.6407531822548, -413.7173154511129, -271.2624578824185, -347.598312129389, -606.9389713742521, -1085.8628195670335, -409.0427921932025, -576.2072901653049, -322.8188166582584, -115.03035803324, -484.2973680939402, -860.8300489125921, -1271.7097828684177, -1181.506110498076, -1285.5919956334199, -72.4807960416146, -655.5048705539645, -633.5686388747913, -1006.1736694648058, -196.46652966919683, -884.1521097415466, -744.8091653061592, -529.1570246682234, -1105.6954296525673, -1157.0211914941592, -784.4530156118861, -773.2992239900361, -844.8570525275777, -757.3905029313971, -926.0287729147066, -1029.414660351021, -452.09031226648347, -611.0827077234668, -938.1368949351472, -630.9064388866497, -1345.6118058363913, -518.2564681256196, -1219.3288690670604, -678.4305513935232, -571.9239491461173, -451.23847113986375, -801.6292736174634, -461.79960025453573, -324.561078268304, -564.2365905027372, -1117.9948731472637, -404.1582837822451, -900.354275331737, -881.7011828667193, -213.95976744561477, -497.0661019334339, -195.00751657416913, -323.5297332296424, -944.8554296111722, -731.7017240127684, -1225.7643838818017, -755.4687943573274, -586.219333277444, -240.21582488974045, -93.00480671731333, -678.0985041994207, -842.1307894825567, -952.6546957551864, -699.0706485991676, -537.4095294536194, 4.824373229624248, -1222.620474314628, -1184.5045178885916, -1181.5592354031014, -237.86526765714854, -266.5859387984753, -1367.5587924038452]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548642858123458, "mean_inference_ms": 1.6666535131326026, "mean_action_processing_ms": 0.27553675438173025, "mean_env_wait_ms": 3.432988944406446, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011896610260009766, "StateBufferConnector_ms": 0.007794380187988281, "ViewRequirementAgentConnector_ms": 0.18772196769714355}, "num_episodes": 32, "episode_return_max": 4.824373229624248, "episode_return_min": -1367.5587924038452, "episode_return_mean": -705.3563201830798, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.58838386893297, "num_env_steps_trained_throughput_per_sec": 306.58838386893297, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 11962.682, "restore_workers_time_ms": 0.033, "training_step_time_ms": 11962.603, "sample_time_ms": 1124.873, "learn_time_ms": 10774.042, "learn_throughput": 371.263, "synch_weights_time_ms": 62.893}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00015", "date": "2024-08-04_06-53-17", "timestamp": 1722734597, "time_this_iter_s": 13.060519695281982, "time_total_s": 132.68643617630005, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237087acb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 132.68643617630005, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.378947368421056, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.085155837858717, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.25277215341727, "policy_loss": -0.005126217616877208, "vf_loss": 9.253982952237129, "vf_explained_var": 0.2846178639680147, "kl": 0.020256617602232532, "entropy": 1.3595976704731583, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": 4.824373229624248, "episode_reward_min": -1393.8257614174647, "episode_reward_mean": -719.0191012787643, "episode_len_mean": 134.91, "episode_media": {}, "episodes_timesteps_total": 13491, "policy_reward_min": {"policy_0": -1393.8257614174647}, "policy_reward_max": {"policy_0": 4.824373229624248}, "policy_reward_mean": {"policy_0": -719.0191012787643}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-470.5989012875354, -609.3902483312608, -903.6407531822548, -413.7173154511129, -271.2624578824185, -347.598312129389, -606.9389713742521, -1085.8628195670335, -409.0427921932025, -576.2072901653049, -322.8188166582584, -115.03035803324, -484.2973680939402, -860.8300489125921, -1271.7097828684177, -1181.506110498076, -1285.5919956334199, -72.4807960416146, -655.5048705539645, -633.5686388747913, -1006.1736694648058, -196.46652966919683, -884.1521097415466, -744.8091653061592, -529.1570246682234, -1105.6954296525673, -1157.0211914941592, -784.4530156118861, -773.2992239900361, -844.8570525275777, -757.3905029313971, -926.0287729147066, -1029.414660351021, -452.09031226648347, -611.0827077234668, -938.1368949351472, -630.9064388866497, -1345.6118058363913, -518.2564681256196, -1219.3288690670604, -678.4305513935232, -571.9239491461173, -451.23847113986375, -801.6292736174634, -461.79960025453573, -324.561078268304, -564.2365905027372, -1117.9948731472637, -404.1582837822451, -900.354275331737, -881.7011828667193, -213.95976744561477, -497.0661019334339, -195.00751657416913, -323.5297332296424, -944.8554296111722, -731.7017240127684, -1225.7643838818017, -755.4687943573274, -586.219333277444, -240.21582488974045, -93.00480671731333, -678.0985041994207, -842.1307894825567, -952.6546957551864, -699.0706485991676, -537.4095294536194, 4.824373229624248, -1222.620474314628, -1184.5045178885916, -1181.5592354031014, -237.86526765714854, -266.5859387984753, -1367.5587924038452, -548.4952780576117, -78.0832866938456, -1014.0455713326027, -758.6105019225995, -413.8635288663718, -665.3691983948506, -177.80549015866296, -746.5930638381229, -1240.7881012956832, -838.9386654843786, -355.14827312833665, -1393.8257614174647, -888.4012963535774, -778.1717567331402, -614.1639419899169, -201.3926055898413, -1308.4814956695134, -956.8398698583853, -1260.0345767075644, -661.9548221348819, -728.8360981719832, -1277.9027612299117, -628.5632072245943, -1147.903347234493, -746.6168011211637, -1309.094768263684], "episode_lengths": [132, 150, 150, 118, 150, 88, 150, 150, 106, 150, 85, 73, 150, 150, 150, 150, 150, 49, 150, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 110, 88, 150, 150, 101, 150, 150, 73, 150, 91, 87, 150, 150, 150, 150, 150, 69, 67, 150, 150, 150, 150, 150, 30, 150, 150, 150, 94, 94, 150, 150, 64, 150, 133, 109, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 137, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-470.5989012875354, -609.3902483312608, -903.6407531822548, -413.7173154511129, -271.2624578824185, -347.598312129389, -606.9389713742521, -1085.8628195670335, -409.0427921932025, -576.2072901653049, -322.8188166582584, -115.03035803324, -484.2973680939402, -860.8300489125921, -1271.7097828684177, -1181.506110498076, -1285.5919956334199, -72.4807960416146, -655.5048705539645, -633.5686388747913, -1006.1736694648058, -196.46652966919683, -884.1521097415466, -744.8091653061592, -529.1570246682234, -1105.6954296525673, -1157.0211914941592, -784.4530156118861, -773.2992239900361, -844.8570525275777, -757.3905029313971, -926.0287729147066, -1029.414660351021, -452.09031226648347, -611.0827077234668, -938.1368949351472, -630.9064388866497, -1345.6118058363913, -518.2564681256196, -1219.3288690670604, -678.4305513935232, -571.9239491461173, -451.23847113986375, -801.6292736174634, -461.79960025453573, -324.561078268304, -564.2365905027372, -1117.9948731472637, -404.1582837822451, -900.354275331737, -881.7011828667193, -213.95976744561477, -497.0661019334339, -195.00751657416913, -323.5297332296424, -944.8554296111722, -731.7017240127684, -1225.7643838818017, -755.4687943573274, -586.219333277444, -240.21582488974045, -93.00480671731333, -678.0985041994207, -842.1307894825567, -952.6546957551864, -699.0706485991676, -537.4095294536194, 4.824373229624248, -1222.620474314628, -1184.5045178885916, -1181.5592354031014, -237.86526765714854, -266.5859387984753, -1367.5587924038452, -548.4952780576117, -78.0832866938456, -1014.0455713326027, -758.6105019225995, -413.8635288663718, -665.3691983948506, -177.80549015866296, -746.5930638381229, -1240.7881012956832, -838.9386654843786, -355.14827312833665, -1393.8257614174647, -888.4012963535774, -778.1717567331402, -614.1639419899169, -201.3926055898413, -1308.4814956695134, -956.8398698583853, -1260.0345767075644, -661.9548221348819, -728.8360981719832, -1277.9027612299117, -628.5632072245943, -1147.903347234493, -746.6168011211637, -1309.094768263684]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539453663310178, "mean_inference_ms": 1.6665459999520291, "mean_action_processing_ms": 0.27526108515347475, "mean_env_wait_ms": 3.4329509422202533, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012331962585449219, "StateBufferConnector_ms": 0.007820606231689453, "ViewRequirementAgentConnector_ms": 0.18882226943969727}, "num_episodes": 26, "episode_return_max": 4.824373229624248, "episode_return_min": -1393.8257614174647, "episode_return_mean": -719.0191012787643, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.7773506859724, "num_env_steps_trained_throughput_per_sec": 299.7773506859724, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 11987.618, "restore_workers_time_ms": 0.035, "training_step_time_ms": 11987.536, "sample_time_ms": 1136.65, "learn_time_ms": 10786.521, "learn_throughput": 370.833, "synch_weights_time_ms": 63.571}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00015", "date": "2024-08-04_06-53-30", "timestamp": 1722734610, "time_this_iter_s": 13.355366230010986, "time_total_s": 146.04180240631104, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708e08b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 146.04180240631104, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.23684210526316, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.20910146869719, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.319734904666742, "policy_loss": -0.011172891838941722, "vf_loss": 9.326026858886083, "vf_explained_var": 0.31387259482095636, "kl": 0.016753478060430416, "entropy": 1.4511049944907426, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": 4.824373229624248, "episode_reward_min": -1393.8257614174647, "episode_reward_mean": -748.4730048786133, "episode_len_mean": 136.22, "episode_media": {}, "episodes_timesteps_total": 13622, "policy_reward_min": {"policy_0": -1393.8257614174647}, "policy_reward_max": {"policy_0": 4.824373229624248}, "policy_reward_mean": {"policy_0": -748.4730048786133}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-844.8570525275777, -757.3905029313971, -926.0287729147066, -1029.414660351021, -452.09031226648347, -611.0827077234668, -938.1368949351472, -630.9064388866497, -1345.6118058363913, -518.2564681256196, -1219.3288690670604, -678.4305513935232, -571.9239491461173, -451.23847113986375, -801.6292736174634, -461.79960025453573, -324.561078268304, -564.2365905027372, -1117.9948731472637, -404.1582837822451, -900.354275331737, -881.7011828667193, -213.95976744561477, -497.0661019334339, -195.00751657416913, -323.5297332296424, -944.8554296111722, -731.7017240127684, -1225.7643838818017, -755.4687943573274, -586.219333277444, -240.21582488974045, -93.00480671731333, -678.0985041994207, -842.1307894825567, -952.6546957551864, -699.0706485991676, -537.4095294536194, 4.824373229624248, -1222.620474314628, -1184.5045178885916, -1181.5592354031014, -237.86526765714854, -266.5859387984753, -1367.5587924038452, -548.4952780576117, -78.0832866938456, -1014.0455713326027, -758.6105019225995, -413.8635288663718, -665.3691983948506, -177.80549015866296, -746.5930638381229, -1240.7881012956832, -838.9386654843786, -355.14827312833665, -1393.8257614174647, -888.4012963535774, -778.1717567331402, -614.1639419899169, -201.3926055898413, -1308.4814956695134, -956.8398698583853, -1260.0345767075644, -661.9548221348819, -728.8360981719832, -1277.9027612299117, -628.5632072245943, -1147.903347234493, -746.6168011211637, -1309.094768263684, -951.4890559545324, -333.8030684772915, -1112.9023066795703, -205.6372822259871, -24.59865679725831, -928.680831818848, -656.1820058589815, -1051.9611268677133, -963.3377458188522, -798.1937781914531, -1285.9920565734728, -1076.8232591946744, -778.7770703966665, -892.2034754935498, -711.204495989457, -839.5709574621635, -1195.7238893557665, -521.6099689120409, -958.16483697868, -480.1971048193549, -762.906660423521, -845.7958664839031, -378.8420353579608, -682.4860935765896, -664.0569750388141, -715.1372069498613, -682.690636646917, -1168.6076858685835, -1036.6402331031195], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 122, 150, 110, 88, 150, 150, 101, 150, 150, 73, 150, 91, 87, 150, 150, 150, 150, 150, 69, 67, 150, 150, 150, 150, 150, 30, 150, 150, 150, 94, 94, 150, 150, 64, 150, 133, 109, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 106, 150, 82, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 150, 150, 105, 150, 150, 95, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-844.8570525275777, -757.3905029313971, -926.0287729147066, -1029.414660351021, -452.09031226648347, -611.0827077234668, -938.1368949351472, -630.9064388866497, -1345.6118058363913, -518.2564681256196, -1219.3288690670604, -678.4305513935232, -571.9239491461173, -451.23847113986375, -801.6292736174634, -461.79960025453573, -324.561078268304, -564.2365905027372, -1117.9948731472637, -404.1582837822451, -900.354275331737, -881.7011828667193, -213.95976744561477, -497.0661019334339, -195.00751657416913, -323.5297332296424, -944.8554296111722, -731.7017240127684, -1225.7643838818017, -755.4687943573274, -586.219333277444, -240.21582488974045, -93.00480671731333, -678.0985041994207, -842.1307894825567, -952.6546957551864, -699.0706485991676, -537.4095294536194, 4.824373229624248, -1222.620474314628, -1184.5045178885916, -1181.5592354031014, -237.86526765714854, -266.5859387984753, -1367.5587924038452, -548.4952780576117, -78.0832866938456, -1014.0455713326027, -758.6105019225995, -413.8635288663718, -665.3691983948506, -177.80549015866296, -746.5930638381229, -1240.7881012956832, -838.9386654843786, -355.14827312833665, -1393.8257614174647, -888.4012963535774, -778.1717567331402, -614.1639419899169, -201.3926055898413, -1308.4814956695134, -956.8398698583853, -1260.0345767075644, -661.9548221348819, -728.8360981719832, -1277.9027612299117, -628.5632072245943, -1147.903347234493, -746.6168011211637, -1309.094768263684, -951.4890559545324, -333.8030684772915, -1112.9023066795703, -205.6372822259871, -24.59865679725831, -928.680831818848, -656.1820058589815, -1051.9611268677133, -963.3377458188522, -798.1937781914531, -1285.9920565734728, -1076.8232591946744, -778.7770703966665, -892.2034754935498, -711.204495989457, -839.5709574621635, -1195.7238893557665, -521.6099689120409, -958.16483697868, -480.1971048193549, -762.906660423521, -845.7958664839031, -378.8420353579608, -682.4860935765896, -664.0569750388141, -715.1372069498613, -682.690636646917, -1168.6076858685835, -1036.6402331031195]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540697383094737, "mean_inference_ms": 1.667385975576851, "mean_action_processing_ms": 0.27537418916279033, "mean_env_wait_ms": 3.4365213782294406, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012102127075195312, "StateBufferConnector_ms": 0.007853269577026367, "ViewRequirementAgentConnector_ms": 0.19181489944458008}, "num_episodes": 29, "episode_return_max": 4.824373229624248, "episode_return_min": -1393.8257614174647, "episode_return_mean": -748.4730048786133, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.5792907341273, "num_env_steps_trained_throughput_per_sec": 303.5792907341273, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12086.042, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12085.959, "sample_time_ms": 1140.345, "learn_time_ms": 10880.421, "learn_throughput": 367.633, "synch_weights_time_ms": 64.396}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00015", "date": "2024-08-04_06-53-43", "timestamp": 1722734623, "time_this_iter_s": 13.189629077911377, "time_total_s": 159.2314314842224, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708e3d00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 159.2314314842224, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.52777777777778, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.511556244144836, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.145240163306395, "policy_loss": -0.013503082507910828, "vf_loss": 9.153545241057873, "vf_explained_var": 0.44013686378796896, "kl": 0.01778430474581305, "entropy": 1.3732871028284233, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": 4.824373229624248, "episode_reward_min": -1393.8257614174647, "episode_reward_mean": -750.3030934687861, "episode_len_mean": 136.14, "episode_media": {}, "episodes_timesteps_total": 13614, "policy_reward_min": {"policy_0": -1393.8257614174647}, "policy_reward_max": {"policy_0": 4.824373229624248}, "policy_reward_mean": {"policy_0": -750.3030934687861}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1225.7643838818017, -755.4687943573274, -586.219333277444, -240.21582488974045, -93.00480671731333, -678.0985041994207, -842.1307894825567, -952.6546957551864, -699.0706485991676, -537.4095294536194, 4.824373229624248, -1222.620474314628, -1184.5045178885916, -1181.5592354031014, -237.86526765714854, -266.5859387984753, -1367.5587924038452, -548.4952780576117, -78.0832866938456, -1014.0455713326027, -758.6105019225995, -413.8635288663718, -665.3691983948506, -177.80549015866296, -746.5930638381229, -1240.7881012956832, -838.9386654843786, -355.14827312833665, -1393.8257614174647, -888.4012963535774, -778.1717567331402, -614.1639419899169, -201.3926055898413, -1308.4814956695134, -956.8398698583853, -1260.0345767075644, -661.9548221348819, -728.8360981719832, -1277.9027612299117, -628.5632072245943, -1147.903347234493, -746.6168011211637, -1309.094768263684, -951.4890559545324, -333.8030684772915, -1112.9023066795703, -205.6372822259871, -24.59865679725831, -928.680831818848, -656.1820058589815, -1051.9611268677133, -963.3377458188522, -798.1937781914531, -1285.9920565734728, -1076.8232591946744, -778.7770703966665, -892.2034754935498, -711.204495989457, -839.5709574621635, -1195.7238893557665, -521.6099689120409, -958.16483697868, -480.1971048193549, -762.906660423521, -845.7958664839031, -378.8420353579608, -682.4860935765896, -664.0569750388141, -715.1372069498613, -682.690636646917, -1168.6076858685835, -1036.6402331031195, -508.0241230283274, -551.5085568942163, -788.122779674285, -722.0318456803758, -874.1822384609837, -775.6476732149114, -715.9769415203215, -773.0848726539153, -644.5334705369937, -711.417959941614, -1334.3459508053143, -25.693513957648353, -918.8116064239991, -585.6170893418539, -72.62831953181743, -1311.2266445415821, -141.59420671622792, -686.7062417575867, -486.3325803207594, -662.9729405722278, -488.09236868353906, -1178.4570130573795, -828.0181493499157, -238.2195303556192, -1073.4027152608946, -496.76240353284214, -752.9491951567511, -1173.9008158682052], "episode_lengths": [150, 150, 150, 69, 67, 150, 150, 150, 150, 150, 30, 150, 150, 150, 94, 94, 150, 150, 64, 150, 133, 109, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 106, 150, 82, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 150, 150, 105, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 32, 150, 150, 43, 150, 69, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150], "policy_policy_0_reward": [-1225.7643838818017, -755.4687943573274, -586.219333277444, -240.21582488974045, -93.00480671731333, -678.0985041994207, -842.1307894825567, -952.6546957551864, -699.0706485991676, -537.4095294536194, 4.824373229624248, -1222.620474314628, -1184.5045178885916, -1181.5592354031014, -237.86526765714854, -266.5859387984753, -1367.5587924038452, -548.4952780576117, -78.0832866938456, -1014.0455713326027, -758.6105019225995, -413.8635288663718, -665.3691983948506, -177.80549015866296, -746.5930638381229, -1240.7881012956832, -838.9386654843786, -355.14827312833665, -1393.8257614174647, -888.4012963535774, -778.1717567331402, -614.1639419899169, -201.3926055898413, -1308.4814956695134, -956.8398698583853, -1260.0345767075644, -661.9548221348819, -728.8360981719832, -1277.9027612299117, -628.5632072245943, -1147.903347234493, -746.6168011211637, -1309.094768263684, -951.4890559545324, -333.8030684772915, -1112.9023066795703, -205.6372822259871, -24.59865679725831, -928.680831818848, -656.1820058589815, -1051.9611268677133, -963.3377458188522, -798.1937781914531, -1285.9920565734728, -1076.8232591946744, -778.7770703966665, -892.2034754935498, -711.204495989457, -839.5709574621635, -1195.7238893557665, -521.6099689120409, -958.16483697868, -480.1971048193549, -762.906660423521, -845.7958664839031, -378.8420353579608, -682.4860935765896, -664.0569750388141, -715.1372069498613, -682.690636646917, -1168.6076858685835, -1036.6402331031195, -508.0241230283274, -551.5085568942163, -788.122779674285, -722.0318456803758, -874.1822384609837, -775.6476732149114, -715.9769415203215, -773.0848726539153, -644.5334705369937, -711.417959941614, -1334.3459508053143, -25.693513957648353, -918.8116064239991, -585.6170893418539, -72.62831953181743, -1311.2266445415821, -141.59420671622792, -686.7062417575867, -486.3325803207594, -662.9729405722278, -488.09236868353906, -1178.4570130573795, -828.0181493499157, -238.2195303556192, -1073.4027152608946, -496.76240353284214, -752.9491951567511, -1173.9008158682052]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536177708059734, "mean_inference_ms": 1.66823068621743, "mean_action_processing_ms": 0.2753710684485068, "mean_env_wait_ms": 3.4410330878742332, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012473344802856445, "StateBufferConnector_ms": 0.007859945297241211, "ViewRequirementAgentConnector_ms": 0.20300674438476562}, "num_episodes": 28, "episode_return_max": 4.824373229624248, "episode_return_min": -1393.8257614174647, "episode_return_mean": -750.3030934687861, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.48247673098825, "num_env_steps_trained_throughput_per_sec": 303.48247673098825, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12120.203, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12120.12, "sample_time_ms": 1142.87, "learn_time_ms": 10912.74, "learn_throughput": 366.544, "synch_weights_time_ms": 63.743}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00015", "date": "2024-08-04_06-53-57", "timestamp": 1722734637, "time_this_iter_s": 13.19324517250061, "time_total_s": 172.42467665672302, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237087a3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 172.42467665672302, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.27368421052632, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.366904159635306, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.303242758413155, "policy_loss": -0.008164635762417069, "vf_loss": 9.306389305988947, "vf_explained_var": 0.4342263016849756, "kl": 0.017248007966763148, "entropy": 1.5631247505545616, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -0.15132247352656925, "episode_reward_min": -1415.5743108798501, "episode_reward_mean": -794.7200481308208, "episode_len_mean": 138.98, "episode_media": {}, "episodes_timesteps_total": 13898, "policy_reward_min": {"policy_0": -1415.5743108798501}, "policy_reward_max": {"policy_0": -0.15132247352656925}, "policy_reward_mean": {"policy_0": -794.7200481308208}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-201.3926055898413, -1308.4814956695134, -956.8398698583853, -1260.0345767075644, -661.9548221348819, -728.8360981719832, -1277.9027612299117, -628.5632072245943, -1147.903347234493, -746.6168011211637, -1309.094768263684, -951.4890559545324, -333.8030684772915, -1112.9023066795703, -205.6372822259871, -24.59865679725831, -928.680831818848, -656.1820058589815, -1051.9611268677133, -963.3377458188522, -798.1937781914531, -1285.9920565734728, -1076.8232591946744, -778.7770703966665, -892.2034754935498, -711.204495989457, -839.5709574621635, -1195.7238893557665, -521.6099689120409, -958.16483697868, -480.1971048193549, -762.906660423521, -845.7958664839031, -378.8420353579608, -682.4860935765896, -664.0569750388141, -715.1372069498613, -682.690636646917, -1168.6076858685835, -1036.6402331031195, -508.0241230283274, -551.5085568942163, -788.122779674285, -722.0318456803758, -874.1822384609837, -775.6476732149114, -715.9769415203215, -773.0848726539153, -644.5334705369937, -711.417959941614, -1334.3459508053143, -25.693513957648353, -918.8116064239991, -585.6170893418539, -72.62831953181743, -1311.2266445415821, -141.59420671622792, -686.7062417575867, -486.3325803207594, -662.9729405722278, -488.09236868353906, -1178.4570130573795, -828.0181493499157, -238.2195303556192, -1073.4027152608946, -496.76240353284214, -752.9491951567511, -1173.9008158682052, -531.7103275159477, -106.45616819379835, -723.1081593667586, -1119.7060658021837, -480.71152789952504, -576.1636219227528, -546.7399834787996, -725.8084173192052, -810.994377452399, -680.8087698971605, -1018.9827804881373, -933.2440954915146, -0.15132247352656925, -711.465271292019, -1206.8091425854595, -731.2422718554706, -643.9896486896903, -1232.2140824969438, -808.0253165605442, -942.0043684992412, -1261.3897570479724, -1101.7296856727337, -826.1467492466986, -1244.789139156936, -1013.2753937765524, -197.78792046385212, -1104.7524544296687, -1208.428602412326, -940.497850159277, -1200.2508155521218, -1415.5743108798501, -974.9479476413159], "episode_lengths": [89, 150, 150, 150, 150, 137, 150, 150, 150, 150, 150, 150, 106, 150, 82, 47, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 143, 150, 150, 150, 105, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 32, 150, 150, 43, 150, 69, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 130, 77, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 30, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-201.3926055898413, -1308.4814956695134, -956.8398698583853, -1260.0345767075644, -661.9548221348819, -728.8360981719832, -1277.9027612299117, -628.5632072245943, -1147.903347234493, -746.6168011211637, -1309.094768263684, -951.4890559545324, -333.8030684772915, -1112.9023066795703, -205.6372822259871, -24.59865679725831, -928.680831818848, -656.1820058589815, -1051.9611268677133, -963.3377458188522, -798.1937781914531, -1285.9920565734728, -1076.8232591946744, -778.7770703966665, -892.2034754935498, -711.204495989457, -839.5709574621635, -1195.7238893557665, -521.6099689120409, -958.16483697868, -480.1971048193549, -762.906660423521, -845.7958664839031, -378.8420353579608, -682.4860935765896, -664.0569750388141, -715.1372069498613, -682.690636646917, -1168.6076858685835, -1036.6402331031195, -508.0241230283274, -551.5085568942163, -788.122779674285, -722.0318456803758, -874.1822384609837, -775.6476732149114, -715.9769415203215, -773.0848726539153, -644.5334705369937, -711.417959941614, -1334.3459508053143, -25.693513957648353, -918.8116064239991, -585.6170893418539, -72.62831953181743, -1311.2266445415821, -141.59420671622792, -686.7062417575867, -486.3325803207594, -662.9729405722278, -488.09236868353906, -1178.4570130573795, -828.0181493499157, -238.2195303556192, -1073.4027152608946, -496.76240353284214, -752.9491951567511, -1173.9008158682052, -531.7103275159477, -106.45616819379835, -723.1081593667586, -1119.7060658021837, -480.71152789952504, -576.1636219227528, -546.7399834787996, -725.8084173192052, -810.994377452399, -680.8087698971605, -1018.9827804881373, -933.2440954915146, -0.15132247352656925, -711.465271292019, -1206.8091425854595, -731.2422718554706, -643.9896486896903, -1232.2140824969438, -808.0253165605442, -942.0043684992412, -1261.3897570479724, -1101.7296856727337, -826.1467492466986, -1244.789139156936, -1013.2753937765524, -197.78792046385212, -1104.7524544296687, -1208.428602412326, -940.497850159277, -1200.2508155521218, -1415.5743108798501, -974.9479476413159]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554905952505572, "mean_inference_ms": 1.671223317677128, "mean_action_processing_ms": 0.27554093785575595, "mean_env_wait_ms": 3.4490117439738053, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012600183486938477, "StateBufferConnector_ms": 0.007861137390136719, "ViewRequirementAgentConnector_ms": 0.20377230644226074}, "num_episodes": 32, "episode_return_max": -0.15132247352656925, "episode_return_min": -1415.5743108798501, "episode_return_mean": -794.7200481308208, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.61443204750134, "num_env_steps_trained_throughput_per_sec": 297.61443204750134, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12329.313, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12329.236, "sample_time_ms": 1143.921, "learn_time_ms": 11120.057, "learn_throughput": 359.71, "synch_weights_time_ms": 64.482}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00015", "date": "2024-08-04_06-54-10", "timestamp": 1722734650, "time_this_iter_s": 13.453523635864258, "time_total_s": 185.87820029258728, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0143e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 185.87820029258728, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.49473684210526, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.233649462709824, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.894992437958717, "policy_loss": -0.006220062520393792, "vf_loss": 8.89681833088398, "vf_explained_var": 0.44354936877886453, "kl": 0.01515275845110108, "entropy": 1.5164915692061185, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -0.15132247352656925, "episode_reward_min": -1541.6489154905694, "episode_reward_mean": -768.0893822767466, "episode_len_mean": 138.3, "episode_media": {}, "episodes_timesteps_total": 13830, "policy_reward_min": {"policy_0": -1541.6489154905694}, "policy_reward_max": {"policy_0": -0.15132247352656925}, "policy_reward_mean": {"policy_0": -768.0893822767466}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-480.1971048193549, -762.906660423521, -845.7958664839031, -378.8420353579608, -682.4860935765896, -664.0569750388141, -715.1372069498613, -682.690636646917, -1168.6076858685835, -1036.6402331031195, -508.0241230283274, -551.5085568942163, -788.122779674285, -722.0318456803758, -874.1822384609837, -775.6476732149114, -715.9769415203215, -773.0848726539153, -644.5334705369937, -711.417959941614, -1334.3459508053143, -25.693513957648353, -918.8116064239991, -585.6170893418539, -72.62831953181743, -1311.2266445415821, -141.59420671622792, -686.7062417575867, -486.3325803207594, -662.9729405722278, -488.09236868353906, -1178.4570130573795, -828.0181493499157, -238.2195303556192, -1073.4027152608946, -496.76240353284214, -752.9491951567511, -1173.9008158682052, -531.7103275159477, -106.45616819379835, -723.1081593667586, -1119.7060658021837, -480.71152789952504, -576.1636219227528, -546.7399834787996, -725.8084173192052, -810.994377452399, -680.8087698971605, -1018.9827804881373, -933.2440954915146, -0.15132247352656925, -711.465271292019, -1206.8091425854595, -731.2422718554706, -643.9896486896903, -1232.2140824969438, -808.0253165605442, -942.0043684992412, -1261.3897570479724, -1101.7296856727337, -826.1467492466986, -1244.789139156936, -1013.2753937765524, -197.78792046385212, -1104.7524544296687, -1208.428602412326, -940.497850159277, -1200.2508155521218, -1415.5743108798501, -974.9479476413159, -1182.8919050480092, -1541.6489154905694, -75.02805145774312, -7.40777257001513, -744.9989410374772, -1283.0506409181257, -736.2226953048598, -920.8424753632172, -1271.5071300177542, -486.31950367239995, -591.0643565417068, -1034.3281668119346, -671.5667602404056, -996.2585706683745, -750.1989069447014, -617.3937756590366, -633.1519622460794, -1068.0419762349236, -1106.0385225815771, -169.00213758509952, -574.5472336181789, -1088.1145820602371, -627.6473775510458, -222.69059858853143, -651.5882225675905, -753.9813346818282, -613.5174762226491, -1006.2978136242261, -669.3552230273091, -756.7066085099357], "episode_lengths": [105, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 32, 150, 150, 43, 150, 69, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 130, 77, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 30, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 49, 36, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-480.1971048193549, -762.906660423521, -845.7958664839031, -378.8420353579608, -682.4860935765896, -664.0569750388141, -715.1372069498613, -682.690636646917, -1168.6076858685835, -1036.6402331031195, -508.0241230283274, -551.5085568942163, -788.122779674285, -722.0318456803758, -874.1822384609837, -775.6476732149114, -715.9769415203215, -773.0848726539153, -644.5334705369937, -711.417959941614, -1334.3459508053143, -25.693513957648353, -918.8116064239991, -585.6170893418539, -72.62831953181743, -1311.2266445415821, -141.59420671622792, -686.7062417575867, -486.3325803207594, -662.9729405722278, -488.09236868353906, -1178.4570130573795, -828.0181493499157, -238.2195303556192, -1073.4027152608946, -496.76240353284214, -752.9491951567511, -1173.9008158682052, -531.7103275159477, -106.45616819379835, -723.1081593667586, -1119.7060658021837, -480.71152789952504, -576.1636219227528, -546.7399834787996, -725.8084173192052, -810.994377452399, -680.8087698971605, -1018.9827804881373, -933.2440954915146, -0.15132247352656925, -711.465271292019, -1206.8091425854595, -731.2422718554706, -643.9896486896903, -1232.2140824969438, -808.0253165605442, -942.0043684992412, -1261.3897570479724, -1101.7296856727337, -826.1467492466986, -1244.789139156936, -1013.2753937765524, -197.78792046385212, -1104.7524544296687, -1208.428602412326, -940.497850159277, -1200.2508155521218, -1415.5743108798501, -974.9479476413159, -1182.8919050480092, -1541.6489154905694, -75.02805145774312, -7.40777257001513, -744.9989410374772, -1283.0506409181257, -736.2226953048598, -920.8424753632172, -1271.5071300177542, -486.31950367239995, -591.0643565417068, -1034.3281668119346, -671.5667602404056, -996.2585706683745, -750.1989069447014, -617.3937756590366, -633.1519622460794, -1068.0419762349236, -1106.0385225815771, -169.00213758509952, -574.5472336181789, -1088.1145820602371, -627.6473775510458, -222.69059858853143, -651.5882225675905, -753.9813346818282, -613.5174762226491, -1006.2978136242261, -669.3552230273091, -756.7066085099357]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558715389527591, "mean_inference_ms": 1.6710797948286302, "mean_action_processing_ms": 0.27554328926180083, "mean_env_wait_ms": 3.453229236241349, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01242518424987793, "StateBufferConnector_ms": 0.007817506790161133, "ViewRequirementAgentConnector_ms": 0.20152616500854492}, "num_episodes": 30, "episode_return_max": -0.15132247352656925, "episode_return_min": -1541.6489154905694, "episode_return_mean": -768.0893822767466, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.7978292762804, "num_env_steps_trained_throughput_per_sec": 307.7978292762804, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12390.001, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12389.924, "sample_time_ms": 1145.649, "learn_time_ms": 11180.568, "learn_throughput": 357.764, "synch_weights_time_ms": 62.942}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00015", "date": "2024-08-04_06-54-23", "timestamp": 1722734663, "time_this_iter_s": 13.008715391159058, "time_total_s": 198.88691568374634, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708e0b80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 198.88691568374634, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.489473684210527, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.673979368060827, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.772982970873516, "policy_loss": -0.011284748690862519, "vf_loss": 8.779166854918003, "vf_explained_var": 0.5401848231752714, "kl": 0.017489859884388656, "entropy": 1.4611436558266482, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -0.15132247352656925, "episode_reward_min": -1541.6489154905694, "episode_reward_mean": -797.4820677565303, "episode_len_mean": 140.18, "episode_media": {}, "episodes_timesteps_total": 14018, "policy_reward_min": {"policy_0": -1541.6489154905694}, "policy_reward_max": {"policy_0": -0.15132247352656925}, "policy_reward_mean": {"policy_0": -797.4820677565303}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-141.59420671622792, -686.7062417575867, -486.3325803207594, -662.9729405722278, -488.09236868353906, -1178.4570130573795, -828.0181493499157, -238.2195303556192, -1073.4027152608946, -496.76240353284214, -752.9491951567511, -1173.9008158682052, -531.7103275159477, -106.45616819379835, -723.1081593667586, -1119.7060658021837, -480.71152789952504, -576.1636219227528, -546.7399834787996, -725.8084173192052, -810.994377452399, -680.8087698971605, -1018.9827804881373, -933.2440954915146, -0.15132247352656925, -711.465271292019, -1206.8091425854595, -731.2422718554706, -643.9896486896903, -1232.2140824969438, -808.0253165605442, -942.0043684992412, -1261.3897570479724, -1101.7296856727337, -826.1467492466986, -1244.789139156936, -1013.2753937765524, -197.78792046385212, -1104.7524544296687, -1208.428602412326, -940.497850159277, -1200.2508155521218, -1415.5743108798501, -974.9479476413159, -1182.8919050480092, -1541.6489154905694, -75.02805145774312, -7.40777257001513, -744.9989410374772, -1283.0506409181257, -736.2226953048598, -920.8424753632172, -1271.5071300177542, -486.31950367239995, -591.0643565417068, -1034.3281668119346, -671.5667602404056, -996.2585706683745, -750.1989069447014, -617.3937756590366, -633.1519622460794, -1068.0419762349236, -1106.0385225815771, -169.00213758509952, -574.5472336181789, -1088.1145820602371, -627.6473775510458, -222.69059858853143, -651.5882225675905, -753.9813346818282, -613.5174762226491, -1006.2978136242261, -669.3552230273091, -756.7066085099357, -496.7510001241851, -632.6789666738179, -913.4585905386637, -728.9472580696935, -1118.629595413623, -1354.5756852927564, -934.266305929719, -647.33850980649, -655.9247315464785, -591.8973089703754, -1003.5032408471142, -713.7479617673968, -1207.8916094756303, -18.942150652235966, -566.7224402841458, -564.118066654539, -652.7555097373063, -999.1473390946941, -966.9096301354305, -802.9435331419446, -1213.4648398723373, -1252.263059868997, -474.1808549790741, -1086.4201254458353, -1056.0723064981528, -1015.9320116345128], "episode_lengths": [69, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 150, 130, 77, 150, 150, 127, 150, 150, 150, 150, 150, 150, 150, 30, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 49, 36, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-141.59420671622792, -686.7062417575867, -486.3325803207594, -662.9729405722278, -488.09236868353906, -1178.4570130573795, -828.0181493499157, -238.2195303556192, -1073.4027152608946, -496.76240353284214, -752.9491951567511, -1173.9008158682052, -531.7103275159477, -106.45616819379835, -723.1081593667586, -1119.7060658021837, -480.71152789952504, -576.1636219227528, -546.7399834787996, -725.8084173192052, -810.994377452399, -680.8087698971605, -1018.9827804881373, -933.2440954915146, -0.15132247352656925, -711.465271292019, -1206.8091425854595, -731.2422718554706, -643.9896486896903, -1232.2140824969438, -808.0253165605442, -942.0043684992412, -1261.3897570479724, -1101.7296856727337, -826.1467492466986, -1244.789139156936, -1013.2753937765524, -197.78792046385212, -1104.7524544296687, -1208.428602412326, -940.497850159277, -1200.2508155521218, -1415.5743108798501, -974.9479476413159, -1182.8919050480092, -1541.6489154905694, -75.02805145774312, -7.40777257001513, -744.9989410374772, -1283.0506409181257, -736.2226953048598, -920.8424753632172, -1271.5071300177542, -486.31950367239995, -591.0643565417068, -1034.3281668119346, -671.5667602404056, -996.2585706683745, -750.1989069447014, -617.3937756590366, -633.1519622460794, -1068.0419762349236, -1106.0385225815771, -169.00213758509952, -574.5472336181789, -1088.1145820602371, -627.6473775510458, -222.69059858853143, -651.5882225675905, -753.9813346818282, -613.5174762226491, -1006.2978136242261, -669.3552230273091, -756.7066085099357, -496.7510001241851, -632.6789666738179, -913.4585905386637, -728.9472580696935, -1118.629595413623, -1354.5756852927564, -934.266305929719, -647.33850980649, -655.9247315464785, -591.8973089703754, -1003.5032408471142, -713.7479617673968, -1207.8916094756303, -18.942150652235966, -566.7224402841458, -564.118066654539, -652.7555097373063, -999.1473390946941, -966.9096301354305, -802.9435331419446, -1213.4648398723373, -1252.263059868997, -474.1808549790741, -1086.4201254458353, -1056.0723064981528, -1015.9320116345128]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567644184715003, "mean_inference_ms": 1.6733254822194183, "mean_action_processing_ms": 0.27585878017882975, "mean_env_wait_ms": 3.4604102782007153, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012426376342773438, "StateBufferConnector_ms": 0.0077991485595703125, "ViewRequirementAgentConnector_ms": 0.19016122817993164}, "num_episodes": 26, "episode_return_max": -0.15132247352656925, "episode_return_min": -1541.6489154905694, "episode_return_mean": -797.4820677565303, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.4311329749724, "num_env_steps_trained_throughput_per_sec": 313.4311329749724, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12687.514, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12687.437, "sample_time_ms": 1164.594, "learn_time_ms": 11456.858, "learn_throughput": 349.136, "synch_weights_time_ms": 65.215}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00015", "date": "2024-08-04_06-54-36", "timestamp": 1722734676, "time_this_iter_s": 12.77433180809021, "time_total_s": 211.66124749183655, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237087a3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 211.66124749183655, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 19.055555555555557, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.929917216300964, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.22068584462007, "policy_loss": -0.007289078664325643, "vf_loss": 8.223154550294081, "vf_explained_var": 0.484148217116793, "kl": 0.016557519930514294, "entropy": 1.4689208471526702, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -7.40777257001513, "episode_reward_min": -1541.6489154905694, "episode_reward_mean": -792.3814237888823, "episode_len_mean": 137.29, "episode_media": {}, "episodes_timesteps_total": 13729, "policy_reward_min": {"policy_0": -1541.6489154905694}, "policy_reward_max": {"policy_0": -7.40777257001513}, "policy_reward_mean": {"policy_0": -792.3814237888823}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.0253165605442, -942.0043684992412, -1261.3897570479724, -1101.7296856727337, -826.1467492466986, -1244.789139156936, -1013.2753937765524, -197.78792046385212, -1104.7524544296687, -1208.428602412326, -940.497850159277, -1200.2508155521218, -1415.5743108798501, -974.9479476413159, -1182.8919050480092, -1541.6489154905694, -75.02805145774312, -7.40777257001513, -744.9989410374772, -1283.0506409181257, -736.2226953048598, -920.8424753632172, -1271.5071300177542, -486.31950367239995, -591.0643565417068, -1034.3281668119346, -671.5667602404056, -996.2585706683745, -750.1989069447014, -617.3937756590366, -633.1519622460794, -1068.0419762349236, -1106.0385225815771, -169.00213758509952, -574.5472336181789, -1088.1145820602371, -627.6473775510458, -222.69059858853143, -651.5882225675905, -753.9813346818282, -613.5174762226491, -1006.2978136242261, -669.3552230273091, -756.7066085099357, -496.7510001241851, -632.6789666738179, -913.4585905386637, -728.9472580696935, -1118.629595413623, -1354.5756852927564, -934.266305929719, -647.33850980649, -655.9247315464785, -591.8973089703754, -1003.5032408471142, -713.7479617673968, -1207.8916094756303, -18.942150652235966, -566.7224402841458, -564.118066654539, -652.7555097373063, -999.1473390946941, -966.9096301354305, -802.9435331419446, -1213.4648398723373, -1252.263059868997, -474.1808549790741, -1086.4201254458353, -1056.0723064981528, -1015.9320116345128, -663.9838332328692, -704.2245240632004, -35.125226928506095, -603.9720863507197, -837.3480224245419, -656.3779896974152, -684.5756460834166, -49.6801327440393, -1512.3915904932899, -1401.2171154221473, -555.4012532150492, -34.28993966460796, -282.90940810916305, -863.1547896548057, -55.0532401510833, -437.1974253365412, -600.3887061682524, -770.06425472441, -1433.2447705566915, -177.81300874550845, -347.55769295294346, -523.8773871045032, -1282.0132108236178, -798.6905971548174, -615.866659779566, -614.5600814427237, -771.6605428900689, -611.6463828804202, -1392.3889753783096, -1160.9753039152292], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 150, 150, 49, 36, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 37, 150, 150, 150, 50, 83, 150, 55, 96, 150, 150, 150, 60, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-808.0253165605442, -942.0043684992412, -1261.3897570479724, -1101.7296856727337, -826.1467492466986, -1244.789139156936, -1013.2753937765524, -197.78792046385212, -1104.7524544296687, -1208.428602412326, -940.497850159277, -1200.2508155521218, -1415.5743108798501, -974.9479476413159, -1182.8919050480092, -1541.6489154905694, -75.02805145774312, -7.40777257001513, -744.9989410374772, -1283.0506409181257, -736.2226953048598, -920.8424753632172, -1271.5071300177542, -486.31950367239995, -591.0643565417068, -1034.3281668119346, -671.5667602404056, -996.2585706683745, -750.1989069447014, -617.3937756590366, -633.1519622460794, -1068.0419762349236, -1106.0385225815771, -169.00213758509952, -574.5472336181789, -1088.1145820602371, -627.6473775510458, -222.69059858853143, -651.5882225675905, -753.9813346818282, -613.5174762226491, -1006.2978136242261, -669.3552230273091, -756.7066085099357, -496.7510001241851, -632.6789666738179, -913.4585905386637, -728.9472580696935, -1118.629595413623, -1354.5756852927564, -934.266305929719, -647.33850980649, -655.9247315464785, -591.8973089703754, -1003.5032408471142, -713.7479617673968, -1207.8916094756303, -18.942150652235966, -566.7224402841458, -564.118066654539, -652.7555097373063, -999.1473390946941, -966.9096301354305, -802.9435331419446, -1213.4648398723373, -1252.263059868997, -474.1808549790741, -1086.4201254458353, -1056.0723064981528, -1015.9320116345128, -663.9838332328692, -704.2245240632004, -35.125226928506095, -603.9720863507197, -837.3480224245419, -656.3779896974152, -684.5756460834166, -49.6801327440393, -1512.3915904932899, -1401.2171154221473, -555.4012532150492, -34.28993966460796, -282.90940810916305, -863.1547896548057, -55.0532401510833, -437.1974253365412, -600.3887061682524, -770.06425472441, -1433.2447705566915, -177.81300874550845, -347.55769295294346, -523.8773871045032, -1282.0132108236178, -798.6905971548174, -615.866659779566, -614.5600814427237, -771.6605428900689, -611.6463828804202, -1392.3889753783096, -1160.9753039152292]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569694142832542, "mean_inference_ms": 1.6732129141980776, "mean_action_processing_ms": 0.27583204163613895, "mean_env_wait_ms": 3.4665204150988247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0123138427734375, "StateBufferConnector_ms": 0.007824420928955078, "ViewRequirementAgentConnector_ms": 0.18970680236816406}, "num_episodes": 30, "episode_return_max": -7.40777257001513, "episode_return_min": -1541.6489154905694, "episode_return_mean": -792.3814237888823, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.52078629225304, "num_env_steps_trained_throughput_per_sec": 325.52078629225304, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13029.929, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13029.853, "sample_time_ms": 1171.203, "learn_time_ms": 11791.671, "learn_throughput": 339.222, "synch_weights_time_ms": 66.203}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00015", "date": "2024-08-04_06-54-48", "timestamp": 1722734688, "time_this_iter_s": 12.303590297698975, "time_total_s": 223.96483778953552, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0143e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 223.96483778953552, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.644444444444446, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.82903742243846, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.324714569747448, "policy_loss": -0.010506742628058419, "vf_loss": 8.329326525827248, "vf_explained_var": 0.6228351123631001, "kl": 0.020160902709903894, "entropy": 1.534884054834644, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": 4.494839448654267, "episode_reward_min": -1512.3915904932899, "episode_reward_mean": -721.134992439541, "episode_len_mean": 133.95, "episode_media": {}, "episodes_timesteps_total": 13395, "policy_reward_min": {"policy_0": -1512.3915904932899}, "policy_reward_max": {"policy_0": 4.494839448654267}, "policy_reward_mean": {"policy_0": -721.134992439541}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1068.0419762349236, -1106.0385225815771, -169.00213758509952, -574.5472336181789, -1088.1145820602371, -627.6473775510458, -222.69059858853143, -651.5882225675905, -753.9813346818282, -613.5174762226491, -1006.2978136242261, -669.3552230273091, -756.7066085099357, -496.7510001241851, -632.6789666738179, -913.4585905386637, -728.9472580696935, -1118.629595413623, -1354.5756852927564, -934.266305929719, -647.33850980649, -655.9247315464785, -591.8973089703754, -1003.5032408471142, -713.7479617673968, -1207.8916094756303, -18.942150652235966, -566.7224402841458, -564.118066654539, -652.7555097373063, -999.1473390946941, -966.9096301354305, -802.9435331419446, -1213.4648398723373, -1252.263059868997, -474.1808549790741, -1086.4201254458353, -1056.0723064981528, -1015.9320116345128, -663.9838332328692, -704.2245240632004, -35.125226928506095, -603.9720863507197, -837.3480224245419, -656.3779896974152, -684.5756460834166, -49.6801327440393, -1512.3915904932899, -1401.2171154221473, -555.4012532150492, -34.28993966460796, -282.90940810916305, -863.1547896548057, -55.0532401510833, -437.1974253365412, -600.3887061682524, -770.06425472441, -1433.2447705566915, -177.81300874550845, -347.55769295294346, -523.8773871045032, -1282.0132108236178, -798.6905971548174, -615.866659779566, -614.5600814427237, -771.6605428900689, -611.6463828804202, -1392.3889753783096, -1160.9753039152292, -697.7680047597432, -502.13356203912303, -78.37684535331489, -1116.8599889447637, -685.862856139849, -700.7188856503992, -603.9004412610914, -994.8940188707196, -877.2392167663259, -1419.7515163536777, -722.9949205829614, -152.87276860013947, -503.4760007028062, -531.9559940154685, -139.77570469937808, -727.6839956078136, -552.3083243727033, -132.75178680523317, -88.24973574583349, -1140.4671065752502, -1099.4051806678758, -588.976242445601, -1021.5567449080528, -628.2123187848983, -661.5607146947955, -163.2247153169085, -1076.0989762959916, -737.4935915400858, -1274.1837157357947, 4.494839448654267, -1042.5786717694136], "episode_lengths": [150, 150, 72, 150, 150, 150, 79, 150, 150, 150, 150, 150, 150, 125, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 37, 150, 150, 150, 50, 83, 150, 55, 96, 150, 150, 150, 60, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 76, 150, 150, 52, 53, 150, 150, 148, 150, 150, 150, 59, 150, 150, 150, 32, 150], "policy_policy_0_reward": [-1068.0419762349236, -1106.0385225815771, -169.00213758509952, -574.5472336181789, -1088.1145820602371, -627.6473775510458, -222.69059858853143, -651.5882225675905, -753.9813346818282, -613.5174762226491, -1006.2978136242261, -669.3552230273091, -756.7066085099357, -496.7510001241851, -632.6789666738179, -913.4585905386637, -728.9472580696935, -1118.629595413623, -1354.5756852927564, -934.266305929719, -647.33850980649, -655.9247315464785, -591.8973089703754, -1003.5032408471142, -713.7479617673968, -1207.8916094756303, -18.942150652235966, -566.7224402841458, -564.118066654539, -652.7555097373063, -999.1473390946941, -966.9096301354305, -802.9435331419446, -1213.4648398723373, -1252.263059868997, -474.1808549790741, -1086.4201254458353, -1056.0723064981528, -1015.9320116345128, -663.9838332328692, -704.2245240632004, -35.125226928506095, -603.9720863507197, -837.3480224245419, -656.3779896974152, -684.5756460834166, -49.6801327440393, -1512.3915904932899, -1401.2171154221473, -555.4012532150492, -34.28993966460796, -282.90940810916305, -863.1547896548057, -55.0532401510833, -437.1974253365412, -600.3887061682524, -770.06425472441, -1433.2447705566915, -177.81300874550845, -347.55769295294346, -523.8773871045032, -1282.0132108236178, -798.6905971548174, -615.866659779566, -614.5600814427237, -771.6605428900689, -611.6463828804202, -1392.3889753783096, -1160.9753039152292, -697.7680047597432, -502.13356203912303, -78.37684535331489, -1116.8599889447637, -685.862856139849, -700.7188856503992, -603.9004412610914, -994.8940188707196, -877.2392167663259, -1419.7515163536777, -722.9949205829614, -152.87276860013947, -503.4760007028062, -531.9559940154685, -139.77570469937808, -727.6839956078136, -552.3083243727033, -132.75178680523317, -88.24973574583349, -1140.4671065752502, -1099.4051806678758, -588.976242445601, -1021.5567449080528, -628.2123187848983, -661.5607146947955, -163.2247153169085, -1076.0989762959916, -737.4935915400858, -1274.1837157357947, 4.494839448654267, -1042.5786717694136]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567799961565916, "mean_inference_ms": 1.672730790682941, "mean_action_processing_ms": 0.2759741089746384, "mean_env_wait_ms": 3.4717795573789454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012463808059692383, "StateBufferConnector_ms": 0.007937908172607422, "ViewRequirementAgentConnector_ms": 0.1919846534729004}, "num_episodes": 31, "episode_return_max": 4.494839448654267, "episode_return_min": -1512.3915904932899, "episode_return_mean": -721.134992439541, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.80362221268604, "num_env_steps_trained_throughput_per_sec": 313.80362221268604, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12992.808, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12992.732, "sample_time_ms": 1167.596, "learn_time_ms": 11756.903, "learn_throughput": 340.226, "synch_weights_time_ms": 67.447}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00015", "date": "2024-08-04_06-55-01", "timestamp": 1722734701, "time_this_iter_s": 12.761130809783936, "time_total_s": 236.72596859931946, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708e2320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 236.72596859931946, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.855555555555554, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.82148095717033, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.231776882708072, "policy_loss": -0.00969404652423691, "vf_loss": 8.2347176750501, "vf_explained_var": 0.6035192289700111, "kl": 0.015366737303853977, "entropy": 1.6179322116076946, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": 4.494839448654267, "episode_reward_min": -1512.3915904932899, "episode_reward_mean": -724.6897770997332, "episode_len_mean": 131.82, "episode_media": {}, "episodes_timesteps_total": 13182, "policy_reward_min": {"policy_0": -1512.3915904932899}, "policy_reward_max": {"policy_0": 4.494839448654267}, "policy_reward_mean": {"policy_0": -724.6897770997332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-564.118066654539, -652.7555097373063, -999.1473390946941, -966.9096301354305, -802.9435331419446, -1213.4648398723373, -1252.263059868997, -474.1808549790741, -1086.4201254458353, -1056.0723064981528, -1015.9320116345128, -663.9838332328692, -704.2245240632004, -35.125226928506095, -603.9720863507197, -837.3480224245419, -656.3779896974152, -684.5756460834166, -49.6801327440393, -1512.3915904932899, -1401.2171154221473, -555.4012532150492, -34.28993966460796, -282.90940810916305, -863.1547896548057, -55.0532401510833, -437.1974253365412, -600.3887061682524, -770.06425472441, -1433.2447705566915, -177.81300874550845, -347.55769295294346, -523.8773871045032, -1282.0132108236178, -798.6905971548174, -615.866659779566, -614.5600814427237, -771.6605428900689, -611.6463828804202, -1392.3889753783096, -1160.9753039152292, -697.7680047597432, -502.13356203912303, -78.37684535331489, -1116.8599889447637, -685.862856139849, -700.7188856503992, -603.9004412610914, -994.8940188707196, -877.2392167663259, -1419.7515163536777, -722.9949205829614, -152.87276860013947, -503.4760007028062, -531.9559940154685, -139.77570469937808, -727.6839956078136, -552.3083243727033, -132.75178680523317, -88.24973574583349, -1140.4671065752502, -1099.4051806678758, -588.976242445601, -1021.5567449080528, -628.2123187848983, -661.5607146947955, -163.2247153169085, -1076.0989762959916, -737.4935915400858, -1274.1837157357947, 4.494839448654267, -1042.5786717694136, -1297.2503622936747, -1092.8323505399007, -943.1499059327995, -618.2522431131243, -722.5343540492377, -1346.5523120535404, -43.88655566397196, -262.73401422792284, -762.1538212847076, -1120.4723033716848, -1364.292433170346, -651.1690234842081, -730.2926487574673, -1360.402208328344, -1281.0297024872075, -22.960404273390765, -135.17877281878458, -970.656759725871, -1040.393150108746, -701.7979015038212, -249.0587990337784, -522.3459266258958, -766.2284985798711, -608.5678702005731, -1027.8464136915782, -893.0157758560463, -341.6847850526654, -371.54363203552316], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 150, 37, 150, 150, 150, 50, 83, 150, 55, 96, 150, 150, 150, 60, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 76, 150, 150, 52, 53, 150, 150, 148, 150, 150, 150, 59, 150, 150, 150, 32, 150, 150, 150, 150, 150, 150, 150, 50, 148, 150, 150, 150, 150, 150, 150, 150, 33, 61, 150, 150, 150, 77, 150, 150, 150, 150, 150, 82, 100], "policy_policy_0_reward": [-564.118066654539, -652.7555097373063, -999.1473390946941, -966.9096301354305, -802.9435331419446, -1213.4648398723373, -1252.263059868997, -474.1808549790741, -1086.4201254458353, -1056.0723064981528, -1015.9320116345128, -663.9838332328692, -704.2245240632004, -35.125226928506095, -603.9720863507197, -837.3480224245419, -656.3779896974152, -684.5756460834166, -49.6801327440393, -1512.3915904932899, -1401.2171154221473, -555.4012532150492, -34.28993966460796, -282.90940810916305, -863.1547896548057, -55.0532401510833, -437.1974253365412, -600.3887061682524, -770.06425472441, -1433.2447705566915, -177.81300874550845, -347.55769295294346, -523.8773871045032, -1282.0132108236178, -798.6905971548174, -615.866659779566, -614.5600814427237, -771.6605428900689, -611.6463828804202, -1392.3889753783096, -1160.9753039152292, -697.7680047597432, -502.13356203912303, -78.37684535331489, -1116.8599889447637, -685.862856139849, -700.7188856503992, -603.9004412610914, -994.8940188707196, -877.2392167663259, -1419.7515163536777, -722.9949205829614, -152.87276860013947, -503.4760007028062, -531.9559940154685, -139.77570469937808, -727.6839956078136, -552.3083243727033, -132.75178680523317, -88.24973574583349, -1140.4671065752502, -1099.4051806678758, -588.976242445601, -1021.5567449080528, -628.2123187848983, -661.5607146947955, -163.2247153169085, -1076.0989762959916, -737.4935915400858, -1274.1837157357947, 4.494839448654267, -1042.5786717694136, -1297.2503622936747, -1092.8323505399007, -943.1499059327995, -618.2522431131243, -722.5343540492377, -1346.5523120535404, -43.88655566397196, -262.73401422792284, -762.1538212847076, -1120.4723033716848, -1364.292433170346, -651.1690234842081, -730.2926487574673, -1360.402208328344, -1281.0297024872075, -22.960404273390765, -135.17877281878458, -970.656759725871, -1040.393150108746, -701.7979015038212, -249.0587990337784, -522.3459266258958, -766.2284985798711, -608.5678702005731, -1027.8464136915782, -893.0157758560463, -341.6847850526654, -371.54363203552316]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5566345654499026, "mean_inference_ms": 1.6724157631719854, "mean_action_processing_ms": 0.2759062914716063, "mean_env_wait_ms": 3.476043888579877, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012386322021484375, "StateBufferConnector_ms": 0.008032560348510742, "ViewRequirementAgentConnector_ms": 0.1947498321533203}, "num_episodes": 28, "episode_return_max": 4.494839448654267, "episode_return_min": -1512.3915904932899, "episode_return_mean": -724.6897770997332, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.29196323296145, "num_env_steps_trained_throughput_per_sec": 315.29196323296145, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12966.585, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12966.51, "sample_time_ms": 1172.293, "learn_time_ms": 11726.947, "learn_throughput": 341.095, "synch_weights_time_ms": 66.493}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00015", "date": "2024-08-04_06-55-14", "timestamp": 1722734714, "time_this_iter_s": 12.69999074935913, "time_total_s": 249.4259593486786, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708e2950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 249.4259593486786, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.96111111111111, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 47.80759483277798, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.526661856472492, "policy_loss": -0.011112424776850578, "vf_loss": 7.529704119265079, "vf_explained_var": 0.7060835167765618, "kl": 0.018188540461172426, "entropy": 1.1467989820986986, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": 4.494839448654267, "episode_reward_min": -1419.7515163536777, "episode_reward_mean": -693.8053316451342, "episode_len_mean": 131.93, "episode_media": {}, "episodes_timesteps_total": 13193, "policy_reward_min": {"policy_0": -1419.7515163536777}, "policy_reward_max": {"policy_0": 4.494839448654267}, "policy_reward_mean": {"policy_0": -693.8053316451342}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-615.866659779566, -614.5600814427237, -771.6605428900689, -611.6463828804202, -1392.3889753783096, -1160.9753039152292, -697.7680047597432, -502.13356203912303, -78.37684535331489, -1116.8599889447637, -685.862856139849, -700.7188856503992, -603.9004412610914, -994.8940188707196, -877.2392167663259, -1419.7515163536777, -722.9949205829614, -152.87276860013947, -503.4760007028062, -531.9559940154685, -139.77570469937808, -727.6839956078136, -552.3083243727033, -132.75178680523317, -88.24973574583349, -1140.4671065752502, -1099.4051806678758, -588.976242445601, -1021.5567449080528, -628.2123187848983, -661.5607146947955, -163.2247153169085, -1076.0989762959916, -737.4935915400858, -1274.1837157357947, 4.494839448654267, -1042.5786717694136, -1297.2503622936747, -1092.8323505399007, -943.1499059327995, -618.2522431131243, -722.5343540492377, -1346.5523120535404, -43.88655566397196, -262.73401422792284, -762.1538212847076, -1120.4723033716848, -1364.292433170346, -651.1690234842081, -730.2926487574673, -1360.402208328344, -1281.0297024872075, -22.960404273390765, -135.17877281878458, -970.656759725871, -1040.393150108746, -701.7979015038212, -249.0587990337784, -522.3459266258958, -766.2284985798711, -608.5678702005731, -1027.8464136915782, -893.0157758560463, -341.6847850526654, -371.54363203552316, -224.35751729712865, -190.85489378087544, -1078.141728769499, -509.9490490801886, -106.63881837920844, -1139.9863623720576, -670.5730147947484, -1120.506052159189, -163.52890995870266, -638.6111972140644, -444.2969616838217, -706.7093321639821, -1008.8807429139763, -720.176949762602, -722.5689015818308, -43.01967758285887, -652.2041035726546, -597.9018202243379, -1291.891831163437, -372.30758028158164, -953.1343578624629, -758.6945928989335, -791.0878103221601, -652.0012872957973, -992.9939152883286, -479.6197405575117, -889.777488347399, -128.3257892804121, -523.903503205287, -43.217606766189284, -1030.128557471789, -708.9582597448629, -864.631054136857, -481.1719142889435, -605.5632612013554], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 78, 150, 150, 76, 150, 150, 52, 53, 150, 150, 148, 150, 150, 150, 59, 150, 150, 150, 32, 150, 150, 150, 150, 150, 150, 150, 50, 148, 150, 150, 150, 150, 150, 150, 150, 33, 61, 150, 150, 150, 77, 150, 150, 150, 150, 150, 82, 100, 85, 84, 150, 150, 69, 150, 150, 150, 65, 150, 127, 150, 150, 150, 150, 43, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 74, 150, 56, 150, 150, 150, 108, 150], "policy_policy_0_reward": [-615.866659779566, -614.5600814427237, -771.6605428900689, -611.6463828804202, -1392.3889753783096, -1160.9753039152292, -697.7680047597432, -502.13356203912303, -78.37684535331489, -1116.8599889447637, -685.862856139849, -700.7188856503992, -603.9004412610914, -994.8940188707196, -877.2392167663259, -1419.7515163536777, -722.9949205829614, -152.87276860013947, -503.4760007028062, -531.9559940154685, -139.77570469937808, -727.6839956078136, -552.3083243727033, -132.75178680523317, -88.24973574583349, -1140.4671065752502, -1099.4051806678758, -588.976242445601, -1021.5567449080528, -628.2123187848983, -661.5607146947955, -163.2247153169085, -1076.0989762959916, -737.4935915400858, -1274.1837157357947, 4.494839448654267, -1042.5786717694136, -1297.2503622936747, -1092.8323505399007, -943.1499059327995, -618.2522431131243, -722.5343540492377, -1346.5523120535404, -43.88655566397196, -262.73401422792284, -762.1538212847076, -1120.4723033716848, -1364.292433170346, -651.1690234842081, -730.2926487574673, -1360.402208328344, -1281.0297024872075, -22.960404273390765, -135.17877281878458, -970.656759725871, -1040.393150108746, -701.7979015038212, -249.0587990337784, -522.3459266258958, -766.2284985798711, -608.5678702005731, -1027.8464136915782, -893.0157758560463, -341.6847850526654, -371.54363203552316, -224.35751729712865, -190.85489378087544, -1078.141728769499, -509.9490490801886, -106.63881837920844, -1139.9863623720576, -670.5730147947484, -1120.506052159189, -163.52890995870266, -638.6111972140644, -444.2969616838217, -706.7093321639821, -1008.8807429139763, -720.176949762602, -722.5689015818308, -43.01967758285887, -652.2041035726546, -597.9018202243379, -1291.891831163437, -372.30758028158164, -953.1343578624629, -758.6945928989335, -791.0878103221601, -652.0012872957973, -992.9939152883286, -479.6197405575117, -889.777488347399, -128.3257892804121, -523.903503205287, -43.217606766189284, -1030.128557471789, -708.9582597448629, -864.631054136857, -481.1719142889435, -605.5632612013554]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560746733081338, "mean_inference_ms": 1.6715927634710195, "mean_action_processing_ms": 0.27555718504587334, "mean_env_wait_ms": 3.478430295170328, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01241302490234375, "StateBufferConnector_ms": 0.008250713348388672, "ViewRequirementAgentConnector_ms": 0.19733262062072754}, "num_episodes": 35, "episode_return_max": 4.494839448654267, "episode_return_min": -1419.7515163536777, "episode_return_mean": -693.8053316451342, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 345.79298790232724, "num_env_steps_trained_throughput_per_sec": 345.79298790232724, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12818.666, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12818.587, "sample_time_ms": 1176.889, "learn_time_ms": 11573.716, "learn_throughput": 345.611, "synch_weights_time_ms": 67.197}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00015", "date": "2024-08-04_06-55-26", "timestamp": 1722734726, "time_this_iter_s": 11.579914331436157, "time_total_s": 261.00587368011475, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0143e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 261.00587368011475, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.95294117647059, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 44.65638767629862, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.759078020850818, "policy_loss": -0.005779442262913411, "vf_loss": 7.7582842047015825, "vf_explained_var": 0.6610784978295366, "kl": 0.01491476788154011, "entropy": 1.384021899352471, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": 4.494839448654267, "episode_reward_min": -1364.292433170346, "episode_reward_mean": -687.4061061475912, "episode_len_mean": 132.18, "episode_media": {}, "episodes_timesteps_total": 13218, "policy_reward_min": {"policy_0": -1364.292433170346}, "policy_reward_max": {"policy_0": 4.494839448654267}, "policy_reward_mean": {"policy_0": -687.4061061475912}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-661.5607146947955, -163.2247153169085, -1076.0989762959916, -737.4935915400858, -1274.1837157357947, 4.494839448654267, -1042.5786717694136, -1297.2503622936747, -1092.8323505399007, -943.1499059327995, -618.2522431131243, -722.5343540492377, -1346.5523120535404, -43.88655566397196, -262.73401422792284, -762.1538212847076, -1120.4723033716848, -1364.292433170346, -651.1690234842081, -730.2926487574673, -1360.402208328344, -1281.0297024872075, -22.960404273390765, -135.17877281878458, -970.656759725871, -1040.393150108746, -701.7979015038212, -249.0587990337784, -522.3459266258958, -766.2284985798711, -608.5678702005731, -1027.8464136915782, -893.0157758560463, -341.6847850526654, -371.54363203552316, -224.35751729712865, -190.85489378087544, -1078.141728769499, -509.9490490801886, -106.63881837920844, -1139.9863623720576, -670.5730147947484, -1120.506052159189, -163.52890995870266, -638.6111972140644, -444.2969616838217, -706.7093321639821, -1008.8807429139763, -720.176949762602, -722.5689015818308, -43.01967758285887, -652.2041035726546, -597.9018202243379, -1291.891831163437, -372.30758028158164, -953.1343578624629, -758.6945928989335, -791.0878103221601, -652.0012872957973, -992.9939152883286, -479.6197405575117, -889.777488347399, -128.3257892804121, -523.903503205287, -43.217606766189284, -1030.128557471789, -708.9582597448629, -864.631054136857, -481.1719142889435, -605.5632612013554, -585.3370211802405, -1331.2729177086535, -746.5277910277701, -574.919133703471, -688.0424833744743, -680.7705896504608, -367.55504341016956, -337.5292790793012, -448.9819835631015, -443.493339393942, -1078.9533373404147, -763.9524827598983, -49.3694591115474, -1276.8461341554028, -439.9122379599095, -128.66149827669673, -628.7155432773517, -630.9552398808547, -1017.6732527709662, -464.52710216647165, -875.4302163666824, -854.1186608159803, -540.258485914149, -584.3046329158532, -1181.6366327273543, -495.5821489969083, -695.9658757174622, -344.71162217025926, -1053.9206651759307, -925.4427465934003], "episode_lengths": [150, 59, 150, 150, 150, 32, 150, 150, 150, 150, 150, 150, 150, 50, 148, 150, 150, 150, 150, 150, 150, 150, 33, 61, 150, 150, 150, 77, 150, 150, 150, 150, 150, 82, 100, 85, 84, 150, 150, 69, 150, 150, 150, 65, 150, 127, 150, 150, 150, 150, 43, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 74, 150, 56, 150, 150, 150, 108, 150, 150, 150, 147, 150, 150, 150, 112, 117, 115, 150, 150, 150, 52, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 85, 150, 150], "policy_policy_0_reward": [-661.5607146947955, -163.2247153169085, -1076.0989762959916, -737.4935915400858, -1274.1837157357947, 4.494839448654267, -1042.5786717694136, -1297.2503622936747, -1092.8323505399007, -943.1499059327995, -618.2522431131243, -722.5343540492377, -1346.5523120535404, -43.88655566397196, -262.73401422792284, -762.1538212847076, -1120.4723033716848, -1364.292433170346, -651.1690234842081, -730.2926487574673, -1360.402208328344, -1281.0297024872075, -22.960404273390765, -135.17877281878458, -970.656759725871, -1040.393150108746, -701.7979015038212, -249.0587990337784, -522.3459266258958, -766.2284985798711, -608.5678702005731, -1027.8464136915782, -893.0157758560463, -341.6847850526654, -371.54363203552316, -224.35751729712865, -190.85489378087544, -1078.141728769499, -509.9490490801886, -106.63881837920844, -1139.9863623720576, -670.5730147947484, -1120.506052159189, -163.52890995870266, -638.6111972140644, -444.2969616838217, -706.7093321639821, -1008.8807429139763, -720.176949762602, -722.5689015818308, -43.01967758285887, -652.2041035726546, -597.9018202243379, -1291.891831163437, -372.30758028158164, -953.1343578624629, -758.6945928989335, -791.0878103221601, -652.0012872957973, -992.9939152883286, -479.6197405575117, -889.777488347399, -128.3257892804121, -523.903503205287, -43.217606766189284, -1030.128557471789, -708.9582597448629, -864.631054136857, -481.1719142889435, -605.5632612013554, -585.3370211802405, -1331.2729177086535, -746.5277910277701, -574.919133703471, -688.0424833744743, -680.7705896504608, -367.55504341016956, -337.5292790793012, -448.9819835631015, -443.493339393942, -1078.9533373404147, -763.9524827598983, -49.3694591115474, -1276.8461341554028, -439.9122379599095, -128.66149827669673, -628.7155432773517, -630.9552398808547, -1017.6732527709662, -464.52710216647165, -875.4302163666824, -854.1186608159803, -540.258485914149, -584.3046329158532, -1181.6366327273543, -495.5821489969083, -695.9658757174622, -344.71162217025926, -1053.9206651759307, -925.4427465934003]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5561143718770097, "mean_inference_ms": 1.6718648310198718, "mean_action_processing_ms": 0.27562595168705833, "mean_env_wait_ms": 3.4805101565740717, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012367725372314453, "StateBufferConnector_ms": 0.008294820785522461, "ViewRequirementAgentConnector_ms": 0.1973874568939209}, "num_episodes": 30, "episode_return_max": 4.494839448654267, "episode_return_min": -1364.292433170346, "episode_return_mean": -687.4061061475912, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.07121403669555, "num_env_steps_trained_throughput_per_sec": 305.07121403669555, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12795.512, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12795.433, "sample_time_ms": 1167.313, "learn_time_ms": 11559.502, "learn_throughput": 346.036, "synch_weights_time_ms": 67.821}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00015", "date": "2024-08-04_06-55-39", "timestamp": 1722734739, "time_this_iter_s": 13.123939037322998, "time_total_s": 274.12981271743774, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708e3910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 274.12981271743774, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.611111111111107, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 50.32592781881491, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.928139831622442, "policy_loss": -0.011278357170522214, "vf_loss": 7.931062835454941, "vf_explained_var": 0.713527971940736, "kl": 0.018918947982259245, "entropy": 1.581651516755422, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": 7.920331794349277, "episode_reward_min": -1515.3064630099404, "episode_reward_mean": -654.2687260721368, "episode_len_mean": 131.86, "episode_media": {}, "episodes_timesteps_total": 13186, "policy_reward_min": {"policy_0": -1515.3064630099404}, "policy_reward_max": {"policy_0": 7.920331794349277}, "policy_reward_mean": {"policy_0": -654.2687260721368}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-766.2284985798711, -608.5678702005731, -1027.8464136915782, -893.0157758560463, -341.6847850526654, -371.54363203552316, -224.35751729712865, -190.85489378087544, -1078.141728769499, -509.9490490801886, -106.63881837920844, -1139.9863623720576, -670.5730147947484, -1120.506052159189, -163.52890995870266, -638.6111972140644, -444.2969616838217, -706.7093321639821, -1008.8807429139763, -720.176949762602, -722.5689015818308, -43.01967758285887, -652.2041035726546, -597.9018202243379, -1291.891831163437, -372.30758028158164, -953.1343578624629, -758.6945928989335, -791.0878103221601, -652.0012872957973, -992.9939152883286, -479.6197405575117, -889.777488347399, -128.3257892804121, -523.903503205287, -43.217606766189284, -1030.128557471789, -708.9582597448629, -864.631054136857, -481.1719142889435, -605.5632612013554, -585.3370211802405, -1331.2729177086535, -746.5277910277701, -574.919133703471, -688.0424833744743, -680.7705896504608, -367.55504341016956, -337.5292790793012, -448.9819835631015, -443.493339393942, -1078.9533373404147, -763.9524827598983, -49.3694591115474, -1276.8461341554028, -439.9122379599095, -128.66149827669673, -628.7155432773517, -630.9552398808547, -1017.6732527709662, -464.52710216647165, -875.4302163666824, -854.1186608159803, -540.258485914149, -584.3046329158532, -1181.6366327273543, -495.5821489969083, -695.9658757174622, -344.71162217025926, -1053.9206651759307, -925.4427465934003, -431.8542304586588, -679.7136705294389, -766.2837095951157, -1168.8864200339863, -504.93661900198396, -700.4195829403401, -46.89511652863788, -1057.8218743116684, -637.7129916415648, -634.5288273635223, -678.495164317143, -606.2773240671913, -115.28600199161733, -1078.1229929899296, -1042.5095630431367, 7.920331794349277, -137.49521183491774, -6.941383056994465, -747.5823822815075, -1515.3064630099404, -492.49114624465756, -718.595904087325, -603.1037113111561, -69.0196137501264, -972.6453141217239, -1297.1667538088927, -883.9383196233645, -847.6791485550594, -442.5143825020679], "episode_lengths": [150, 150, 150, 150, 82, 100, 85, 84, 150, 150, 69, 150, 150, 150, 65, 150, 127, 150, 150, 150, 150, 43, 150, 150, 150, 114, 150, 150, 150, 150, 150, 150, 150, 74, 150, 56, 150, 150, 150, 108, 150, 150, 150, 147, 150, 150, 150, 112, 117, 115, 150, 150, 150, 52, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 85, 150, 150, 132, 150, 133, 150, 150, 150, 49, 150, 150, 150, 150, 150, 74, 150, 150, 28, 66, 32, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-766.2284985798711, -608.5678702005731, -1027.8464136915782, -893.0157758560463, -341.6847850526654, -371.54363203552316, -224.35751729712865, -190.85489378087544, -1078.141728769499, -509.9490490801886, -106.63881837920844, -1139.9863623720576, -670.5730147947484, -1120.506052159189, -163.52890995870266, -638.6111972140644, -444.2969616838217, -706.7093321639821, -1008.8807429139763, -720.176949762602, -722.5689015818308, -43.01967758285887, -652.2041035726546, -597.9018202243379, -1291.891831163437, -372.30758028158164, -953.1343578624629, -758.6945928989335, -791.0878103221601, -652.0012872957973, -992.9939152883286, -479.6197405575117, -889.777488347399, -128.3257892804121, -523.903503205287, -43.217606766189284, -1030.128557471789, -708.9582597448629, -864.631054136857, -481.1719142889435, -605.5632612013554, -585.3370211802405, -1331.2729177086535, -746.5277910277701, -574.919133703471, -688.0424833744743, -680.7705896504608, -367.55504341016956, -337.5292790793012, -448.9819835631015, -443.493339393942, -1078.9533373404147, -763.9524827598983, -49.3694591115474, -1276.8461341554028, -439.9122379599095, -128.66149827669673, -628.7155432773517, -630.9552398808547, -1017.6732527709662, -464.52710216647165, -875.4302163666824, -854.1186608159803, -540.258485914149, -584.3046329158532, -1181.6366327273543, -495.5821489969083, -695.9658757174622, -344.71162217025926, -1053.9206651759307, -925.4427465934003, -431.8542304586588, -679.7136705294389, -766.2837095951157, -1168.8864200339863, -504.93661900198396, -700.4195829403401, -46.89511652863788, -1057.8218743116684, -637.7129916415648, -634.5288273635223, -678.495164317143, -606.2773240671913, -115.28600199161733, -1078.1229929899296, -1042.5095630431367, 7.920331794349277, -137.49521183491774, -6.941383056994465, -747.5823822815075, -1515.3064630099404, -492.49114624465756, -718.595904087325, -603.1037113111561, -69.0196137501264, -972.6453141217239, -1297.1667538088927, -883.9383196233645, -847.6791485550594, -442.5143825020679]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5557836953371268, "mean_inference_ms": 1.6719923642145382, "mean_action_processing_ms": 0.27543311119477915, "mean_env_wait_ms": 3.479939023240825, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01209568977355957, "StateBufferConnector_ms": 0.008216381072998047, "ViewRequirementAgentConnector_ms": 0.19646739959716797}, "num_episodes": 29, "episode_return_max": 7.920331794349277, "episode_return_min": -1515.3064630099404, "episode_return_mean": -654.2687260721368, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.77637688884266, "num_env_steps_trained_throughput_per_sec": 302.77637688884266, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12799.007, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12798.922, "sample_time_ms": 1167.347, "learn_time_ms": 11564.44, "learn_throughput": 345.888, "synch_weights_time_ms": 66.338}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00015", "date": "2024-08-04_06-55-52", "timestamp": 1722734752, "time_this_iter_s": 13.224709749221802, "time_total_s": 287.35452246665955, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370724310>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 287.35452246665955, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.23684210526316, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 43.559601944684985, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.072141849497955, "policy_loss": -0.013307610471868733, "vf_loss": 8.077489364643892, "vf_explained_var": 0.6748131080220143, "kl": 0.01801666974814301, "entropy": 1.473749639838934, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": 7.920331794349277, "episode_reward_min": -1545.8117971283204, "episode_reward_mean": -682.7169058188506, "episode_len_mean": 133.3, "episode_media": {}, "episodes_timesteps_total": 13330, "policy_reward_min": {"policy_0": -1545.8117971283204}, "policy_reward_max": {"policy_0": 7.920331794349277}, "policy_reward_mean": {"policy_0": -682.7169058188506}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-992.9939152883286, -479.6197405575117, -889.777488347399, -128.3257892804121, -523.903503205287, -43.217606766189284, -1030.128557471789, -708.9582597448629, -864.631054136857, -481.1719142889435, -605.5632612013554, -585.3370211802405, -1331.2729177086535, -746.5277910277701, -574.919133703471, -688.0424833744743, -680.7705896504608, -367.55504341016956, -337.5292790793012, -448.9819835631015, -443.493339393942, -1078.9533373404147, -763.9524827598983, -49.3694591115474, -1276.8461341554028, -439.9122379599095, -128.66149827669673, -628.7155432773517, -630.9552398808547, -1017.6732527709662, -464.52710216647165, -875.4302163666824, -854.1186608159803, -540.258485914149, -584.3046329158532, -1181.6366327273543, -495.5821489969083, -695.9658757174622, -344.71162217025926, -1053.9206651759307, -925.4427465934003, -431.8542304586588, -679.7136705294389, -766.2837095951157, -1168.8864200339863, -504.93661900198396, -700.4195829403401, -46.89511652863788, -1057.8218743116684, -637.7129916415648, -634.5288273635223, -678.495164317143, -606.2773240671913, -115.28600199161733, -1078.1229929899296, -1042.5095630431367, 7.920331794349277, -137.49521183491774, -6.941383056994465, -747.5823822815075, -1515.3064630099404, -492.49114624465756, -718.595904087325, -603.1037113111561, -69.0196137501264, -972.6453141217239, -1297.1667538088927, -883.9383196233645, -847.6791485550594, -442.5143825020679, -853.0321170171871, -1034.1696516821773, -1545.8117971283204, -1031.5141286459404, -665.9639084282047, -1385.1476623746046, -80.94674180931325, -218.192933547698, -689.8093049997861, -1250.9465437201181, -551.4948022110656, -631.1804132691954, -1305.421391971004, -540.6837600970644, -643.5284330429517, -828.339205446092, -975.4821412317707, -181.20036233751577, -1087.6220949609249, -438.01214652237894, -712.255586795336, -852.1593588670905, -566.6105159389178, -238.21051723436668, -639.6716790380973, -1216.6075418952173, -887.7315489614193, -666.9373767281259, -604.0889028201973, -88.95587448164126], "episode_lengths": [150, 150, 150, 74, 150, 56, 150, 150, 150, 108, 150, 150, 150, 147, 150, 150, 150, 112, 117, 115, 150, 150, 150, 52, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 108, 150, 85, 150, 150, 132, 150, 133, 150, 150, 150, 49, 150, 150, 150, 150, 150, 74, 150, 150, 28, 66, 32, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 76, 150, 150, 150, 150, 150, 121, 150, 150, 150, 79, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 58], "policy_policy_0_reward": [-992.9939152883286, -479.6197405575117, -889.777488347399, -128.3257892804121, -523.903503205287, -43.217606766189284, -1030.128557471789, -708.9582597448629, -864.631054136857, -481.1719142889435, -605.5632612013554, -585.3370211802405, -1331.2729177086535, -746.5277910277701, -574.919133703471, -688.0424833744743, -680.7705896504608, -367.55504341016956, -337.5292790793012, -448.9819835631015, -443.493339393942, -1078.9533373404147, -763.9524827598983, -49.3694591115474, -1276.8461341554028, -439.9122379599095, -128.66149827669673, -628.7155432773517, -630.9552398808547, -1017.6732527709662, -464.52710216647165, -875.4302163666824, -854.1186608159803, -540.258485914149, -584.3046329158532, -1181.6366327273543, -495.5821489969083, -695.9658757174622, -344.71162217025926, -1053.9206651759307, -925.4427465934003, -431.8542304586588, -679.7136705294389, -766.2837095951157, -1168.8864200339863, -504.93661900198396, -700.4195829403401, -46.89511652863788, -1057.8218743116684, -637.7129916415648, -634.5288273635223, -678.495164317143, -606.2773240671913, -115.28600199161733, -1078.1229929899296, -1042.5095630431367, 7.920331794349277, -137.49521183491774, -6.941383056994465, -747.5823822815075, -1515.3064630099404, -492.49114624465756, -718.595904087325, -603.1037113111561, -69.0196137501264, -972.6453141217239, -1297.1667538088927, -883.9383196233645, -847.6791485550594, -442.5143825020679, -853.0321170171871, -1034.1696516821773, -1545.8117971283204, -1031.5141286459404, -665.9639084282047, -1385.1476623746046, -80.94674180931325, -218.192933547698, -689.8093049997861, -1250.9465437201181, -551.4948022110656, -631.1804132691954, -1305.421391971004, -540.6837600970644, -643.5284330429517, -828.339205446092, -975.4821412317707, -181.20036233751577, -1087.6220949609249, -438.01214652237894, -712.255586795336, -852.1593588670905, -566.6105159389178, -238.21051723436668, -639.6716790380973, -1216.6075418952173, -887.7315489614193, -666.9373767281259, -604.0889028201973, -88.95587448164126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551586872251054, "mean_inference_ms": 1.6711557132582413, "mean_action_processing_ms": 0.27520321738668296, "mean_env_wait_ms": 3.4802397439628576, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012318134307861328, "StateBufferConnector_ms": 0.008217334747314453, "ViewRequirementAgentConnector_ms": 0.196793794631958}, "num_episodes": 30, "episode_return_max": 7.920331794349277, "episode_return_min": -1545.8117971283204, "episode_return_mean": -682.7169058188506, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.1911607721861, "num_env_steps_trained_throughput_per_sec": 305.1911607721861, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12791.628, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12791.543, "sample_time_ms": 1162.568, "learn_time_ms": 11562.256, "learn_throughput": 345.953, "synch_weights_time_ms": 65.928}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00015", "date": "2024-08-04_06-56-05", "timestamp": 1722734765, "time_this_iter_s": 13.119240999221802, "time_total_s": 300.47376346588135, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080aef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 300.47376346588135, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.542105263157897, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.671118181943896, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.843952093521754, "policy_loss": -0.007398541462801707, "vf_loss": 7.843186118702094, "vf_explained_var": 0.7340392269194126, "kl": 0.01845981180789143, "entropy": 1.4239230246593555, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": 7.920331794349277, "episode_reward_min": -1545.8117971283204, "episode_reward_mean": -682.6006534481461, "episode_len_mean": 131.98, "episode_media": {}, "episodes_timesteps_total": 13198, "policy_reward_min": {"policy_0": -1545.8117971283204}, "policy_reward_max": {"policy_0": 7.920331794349277}, "policy_reward_mean": {"policy_0": -682.6006534481461}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-464.52710216647165, -875.4302163666824, -854.1186608159803, -540.258485914149, -584.3046329158532, -1181.6366327273543, -495.5821489969083, -695.9658757174622, -344.71162217025926, -1053.9206651759307, -925.4427465934003, -431.8542304586588, -679.7136705294389, -766.2837095951157, -1168.8864200339863, -504.93661900198396, -700.4195829403401, -46.89511652863788, -1057.8218743116684, -637.7129916415648, -634.5288273635223, -678.495164317143, -606.2773240671913, -115.28600199161733, -1078.1229929899296, -1042.5095630431367, 7.920331794349277, -137.49521183491774, -6.941383056994465, -747.5823822815075, -1515.3064630099404, -492.49114624465756, -718.595904087325, -603.1037113111561, -69.0196137501264, -972.6453141217239, -1297.1667538088927, -883.9383196233645, -847.6791485550594, -442.5143825020679, -853.0321170171871, -1034.1696516821773, -1545.8117971283204, -1031.5141286459404, -665.9639084282047, -1385.1476623746046, -80.94674180931325, -218.192933547698, -689.8093049997861, -1250.9465437201181, -551.4948022110656, -631.1804132691954, -1305.421391971004, -540.6837600970644, -643.5284330429517, -828.339205446092, -975.4821412317707, -181.20036233751577, -1087.6220949609249, -438.01214652237894, -712.255586795336, -852.1593588670905, -566.6105159389178, -238.21051723436668, -639.6716790380973, -1216.6075418952173, -887.7315489614193, -666.9373767281259, -604.0889028201973, -88.95587448164126, -760.1157584303991, -818.3889836434357, -522.5047784543544, -747.3381423628249, -114.34463657143372, -550.497911303803, -1017.6042607888311, -1453.3487619610476, -555.7440957053276, -507.6495052700404, -80.03827759116786, -950.1974178676752, -493.49359262793786, -653.213703239803, -608.6640713594121, -1049.8597381450654, -1121.8443546006067, -92.74359931940732, -1204.8597324375842, -1031.0941423883928, -237.8867548084039, -229.24297629638434, -309.6875854026424, -1054.2693020507058, -338.22546577984696, -117.00827893672104, -515.017745134207, -619.3401606165141, -672.8936139078554, -529.017273841294], "episode_lengths": [150, 150, 150, 150, 150, 150, 108, 150, 85, 150, 150, 132, 150, 133, 150, 150, 150, 49, 150, 150, 150, 150, 150, 74, 150, 150, 28, 66, 32, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 76, 150, 150, 150, 150, 150, 121, 150, 150, 150, 79, 150, 150, 150, 150, 150, 69, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 73, 150, 150, 150, 150, 122, 68, 150, 150, 150, 144, 150, 150, 47, 150, 150, 96, 73, 81, 150, 101, 59, 150, 150, 150, 150], "policy_policy_0_reward": [-464.52710216647165, -875.4302163666824, -854.1186608159803, -540.258485914149, -584.3046329158532, -1181.6366327273543, -495.5821489969083, -695.9658757174622, -344.71162217025926, -1053.9206651759307, -925.4427465934003, -431.8542304586588, -679.7136705294389, -766.2837095951157, -1168.8864200339863, -504.93661900198396, -700.4195829403401, -46.89511652863788, -1057.8218743116684, -637.7129916415648, -634.5288273635223, -678.495164317143, -606.2773240671913, -115.28600199161733, -1078.1229929899296, -1042.5095630431367, 7.920331794349277, -137.49521183491774, -6.941383056994465, -747.5823822815075, -1515.3064630099404, -492.49114624465756, -718.595904087325, -603.1037113111561, -69.0196137501264, -972.6453141217239, -1297.1667538088927, -883.9383196233645, -847.6791485550594, -442.5143825020679, -853.0321170171871, -1034.1696516821773, -1545.8117971283204, -1031.5141286459404, -665.9639084282047, -1385.1476623746046, -80.94674180931325, -218.192933547698, -689.8093049997861, -1250.9465437201181, -551.4948022110656, -631.1804132691954, -1305.421391971004, -540.6837600970644, -643.5284330429517, -828.339205446092, -975.4821412317707, -181.20036233751577, -1087.6220949609249, -438.01214652237894, -712.255586795336, -852.1593588670905, -566.6105159389178, -238.21051723436668, -639.6716790380973, -1216.6075418952173, -887.7315489614193, -666.9373767281259, -604.0889028201973, -88.95587448164126, -760.1157584303991, -818.3889836434357, -522.5047784543544, -747.3381423628249, -114.34463657143372, -550.497911303803, -1017.6042607888311, -1453.3487619610476, -555.7440957053276, -507.6495052700404, -80.03827759116786, -950.1974178676752, -493.49359262793786, -653.213703239803, -608.6640713594121, -1049.8597381450654, -1121.8443546006067, -92.74359931940732, -1204.8597324375842, -1031.0941423883928, -237.8867548084039, -229.24297629638434, -309.6875854026424, -1054.2693020507058, -338.22546577984696, -117.00827893672104, -515.017745134207, -619.3401606165141, -672.8936139078554, -529.017273841294]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554381696415918, "mean_inference_ms": 1.670294603116132, "mean_action_processing_ms": 0.27522621935673397, "mean_env_wait_ms": 3.4817985748064593, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011904716491699219, "StateBufferConnector_ms": 0.007949113845825195, "ViewRequirementAgentConnector_ms": 0.19281435012817383}, "num_episodes": 30, "episode_return_max": 7.920331794349277, "episode_return_min": -1545.8117971283204, "episode_return_mean": -682.6006534481461, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 366.3781800482843, "num_env_steps_trained_throughput_per_sec": 366.3781800482843, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12539.375, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12539.291, "sample_time_ms": 1157.842, "learn_time_ms": 11314.877, "learn_throughput": 353.517, "synch_weights_time_ms": 65.783}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00015", "date": "2024-08-04_06-56-16", "timestamp": 1722734776, "time_this_iter_s": 10.930484533309937, "time_total_s": 311.4042479991913, "pid": 592212, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708e3910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 311.4042479991913, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 19.525, "ram_util_percent": 28.1}}
