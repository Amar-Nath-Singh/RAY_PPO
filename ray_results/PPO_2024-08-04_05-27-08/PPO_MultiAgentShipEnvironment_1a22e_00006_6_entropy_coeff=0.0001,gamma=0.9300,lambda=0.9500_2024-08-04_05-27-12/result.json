{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.2250110913688939, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.529060185949008, "policy_loss": -0.008589728028164245, "vf_loss": 9.53545104066531, "vf_explained_var": 0.01976271513849497, "kl": 0.011717215934731939, "entropy": 1.4453977645685276, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -165.8058761483814, "episode_reward_min": -1403.7457154217966, "episode_reward_mean": -851.4934869514806, "episode_len_mean": 135.33333333333334, "episode_media": {}, "episodes_timesteps_total": 3248, "policy_reward_min": {"policy_0": -1403.7457154217966}, "policy_reward_max": {"policy_0": -165.8058761483814}, "policy_reward_mean": {"policy_0": -851.4934869514806}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-548.8412694817887, -1273.7274620714843, -996.6919889721454, -982.972497770558, -960.0534513002531, -363.07938915140903, -603.874830222561, -1000.3532101999916, -232.64281153144898, -862.7213909726222, -631.3309277899637, -178.28587195110478, -165.8058761483814, -1211.604797050679, -1110.7210391227902, -975.2391398058178, -543.4572413770957, -1195.3945765506903, -954.1053601503523, -979.864883152746, -1159.2998797950213, -1290.335322246372, -811.6947545984609, -1403.7457154217966], "episode_lengths": [150, 150, 150, 150, 150, 108, 118, 150, 93, 144, 117, 85, 65, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-548.8412694817887, -1273.7274620714843, -996.6919889721454, -982.972497770558, -960.0534513002531, -363.07938915140903, -603.874830222561, -1000.3532101999916, -232.64281153144898, -862.7213909726222, -631.3309277899637, -178.28587195110478, -165.8058761483814, -1211.604797050679, -1110.7210391227902, -975.2391398058178, -543.4572413770957, -1195.3945765506903, -954.1053601503523, -979.864883152746, -1159.2998797950213, -1290.335322246372, -811.6947545984609, -1403.7457154217966]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5845027529090626, "mean_inference_ms": 1.7060993738231858, "mean_action_processing_ms": 0.28137335995213214, "mean_env_wait_ms": 3.4467044931066186, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011560320854187012, "StateBufferConnector_ms": 0.007756551106770833, "ViewRequirementAgentConnector_ms": 0.17241636912027994}, "num_episodes": 24, "episode_return_max": -165.8058761483814, "episode_return_min": -1403.7457154217966, "episode_return_mean": -851.4934869514806, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.2904053474033, "num_env_steps_trained_throughput_per_sec": 307.2904053474033, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13017.013, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13016.951, "sample_time_ms": 1263.328, "learn_time_ms": 11696.937, "learn_throughput": 341.97, "synch_weights_time_ms": 55.953}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00006", "date": "2024-08-04_06-01-14", "timestamp": 1722731474, "time_this_iter_s": 13.029684782028198, "time_total_s": 13.029684782028198, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0ae7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.029684782028198, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.573684210526313, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.548604242503643, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.454478215177854, "policy_loss": -0.009686437289929017, "vf_loss": 9.461315217614175, "vf_explained_var": 0.03685624649127325, "kl": 0.014938287011364083, "entropy": 1.3824956918756166, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -30.894406649041812, "episode_reward_min": -1403.7457154217966, "episode_reward_mean": -745.2664537633577, "episode_len_mean": 128.0, "episode_media": {}, "episodes_timesteps_total": 6656, "policy_reward_min": {"policy_0": -1403.7457154217966}, "policy_reward_max": {"policy_0": -30.894406649041812}, "policy_reward_mean": {"policy_0": -745.2664537633577}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-548.8412694817887, -1273.7274620714843, -996.6919889721454, -982.972497770558, -960.0534513002531, -363.07938915140903, -603.874830222561, -1000.3532101999916, -232.64281153144898, -862.7213909726222, -631.3309277899637, -178.28587195110478, -165.8058761483814, -1211.604797050679, -1110.7210391227902, -975.2391398058178, -543.4572413770957, -1195.3945765506903, -954.1053601503523, -979.864883152746, -1159.2998797950213, -1290.335322246372, -811.6947545984609, -1403.7457154217966, -1097.487569182056, -941.9043949754795, -966.9012276549782, -1129.8726987232703, -869.928557423404, -580.4335193819873, -533.9084324222458, -437.52461835029345, -347.90207914494704, -1022.9281916009631, -326.3054731866688, -739.8007678891186, -647.7672788293509, -167.77836438855093, -273.8649788679374, -1323.0982896519915, -786.5358443590202, -227.1444344888228, -342.3321745704693, -949.4259836733231, -1209.7380888472337, -746.1074019109335, -861.5776969525384, -786.8633130617071, -72.29420061055801, -30.894406649041812, -147.47210867810043, -750.2198133840756], "episode_lengths": [150, 150, 150, 150, 150, 108, 118, 150, 93, 144, 117, 85, 65, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 95, 93, 150, 83, 150, 143, 59, 105, 150, 150, 73, 97, 150, 150, 150, 150, 150, 40, 45, 65, 150], "policy_policy_0_reward": [-548.8412694817887, -1273.7274620714843, -996.6919889721454, -982.972497770558, -960.0534513002531, -363.07938915140903, -603.874830222561, -1000.3532101999916, -232.64281153144898, -862.7213909726222, -631.3309277899637, -178.28587195110478, -165.8058761483814, -1211.604797050679, -1110.7210391227902, -975.2391398058178, -543.4572413770957, -1195.3945765506903, -954.1053601503523, -979.864883152746, -1159.2998797950213, -1290.335322246372, -811.6947545984609, -1403.7457154217966, -1097.487569182056, -941.9043949754795, -966.9012276549782, -1129.8726987232703, -869.928557423404, -580.4335193819873, -533.9084324222458, -437.52461835029345, -347.90207914494704, -1022.9281916009631, -326.3054731866688, -739.8007678891186, -647.7672788293509, -167.77836438855093, -273.8649788679374, -1323.0982896519915, -786.5358443590202, -227.1444344888228, -342.3321745704693, -949.4259836733231, -1209.7380888472337, -746.1074019109335, -861.5776969525384, -786.8633130617071, -72.29420061055801, -30.894406649041812, -147.47210867810043, -750.2198133840756]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5759786221116844, "mean_inference_ms": 1.695170912389235, "mean_action_processing_ms": 0.2818835605655284, "mean_env_wait_ms": 3.4243883883685506, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013941067915696364, "StateBufferConnector_ms": 0.008129615050095778, "ViewRequirementAgentConnector_ms": 0.17996888894301194}, "num_episodes": 28, "episode_return_max": -30.894406649041812, "episode_return_min": -1403.7457154217966, "episode_return_mean": -745.2664537633577, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.85344740349353, "num_env_steps_trained_throughput_per_sec": 294.85344740349353, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13291.543, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13291.475, "sample_time_ms": 1196.295, "learn_time_ms": 12036.803, "learn_throughput": 332.314, "synch_weights_time_ms": 57.636}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00006", "date": "2024-08-04_06-01-28", "timestamp": 1722731488, "time_this_iter_s": 13.578636884689331, "time_total_s": 26.60832166671753, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a7880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.60832166671753, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.852631578947367, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.663071117084473, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.892428567508857, "policy_loss": -0.016203037656183975, "vf_loss": 8.904590392609437, "vf_explained_var": 0.09563276258607706, "kl": 0.02089818901343582, "entropy": 1.384346692636609, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -30.894406649041812, "episode_reward_min": -1403.7457154217966, "episode_reward_mean": -743.0352610063117, "episode_len_mean": 129.4375, "episode_media": {}, "episodes_timesteps_total": 10355, "policy_reward_min": {"policy_0": -1403.7457154217966}, "policy_reward_max": {"policy_0": -30.894406649041812}, "policy_reward_mean": {"policy_0": -743.0352610063117}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-548.8412694817887, -1273.7274620714843, -996.6919889721454, -982.972497770558, -960.0534513002531, -363.07938915140903, -603.874830222561, -1000.3532101999916, -232.64281153144898, -862.7213909726222, -631.3309277899637, -178.28587195110478, -165.8058761483814, -1211.604797050679, -1110.7210391227902, -975.2391398058178, -543.4572413770957, -1195.3945765506903, -954.1053601503523, -979.864883152746, -1159.2998797950213, -1290.335322246372, -811.6947545984609, -1403.7457154217966, -1097.487569182056, -941.9043949754795, -966.9012276549782, -1129.8726987232703, -869.928557423404, -580.4335193819873, -533.9084324222458, -437.52461835029345, -347.90207914494704, -1022.9281916009631, -326.3054731866688, -739.8007678891186, -647.7672788293509, -167.77836438855093, -273.8649788679374, -1323.0982896519915, -786.5358443590202, -227.1444344888228, -342.3321745704693, -949.4259836733231, -1209.7380888472337, -746.1074019109335, -861.5776969525384, -786.8633130617071, -72.29420061055801, -30.894406649041812, -147.47210867810043, -750.2198133840756, -722.3136995232962, -809.3993713595464, -154.65994248815068, -746.5696964722579, -1270.4466765167144, -327.9934467396271, -931.8829513063255, -493.26485922517213, -809.4447653479236, -733.8032578434031, -469.6041560804065, -981.6827146464127, -1258.023311131396, -1358.313545786439, -293.38764018668434, -831.9290867591841, -55.54736886397637, -957.4915215384997, -461.6000237419746, -1184.0880623823598, -940.9932382733555, -494.13242715543225, -142.6617990522708, -1269.6481311264001, -890.3032179046877, -1200.73673129805, -74.90011903036734, -824.1435230300232], "episode_lengths": [150, 150, 150, 150, 150, 108, 118, 150, 93, 144, 117, 85, 65, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 95, 93, 150, 83, 150, 143, 59, 105, 150, 150, 73, 97, 150, 150, 150, 150, 150, 40, 45, 65, 150, 150, 150, 55, 150, 150, 80, 150, 150, 146, 150, 150, 150, 150, 150, 87, 150, 55, 150, 150, 150, 150, 143, 71, 150, 150, 150, 62, 150], "policy_policy_0_reward": [-548.8412694817887, -1273.7274620714843, -996.6919889721454, -982.972497770558, -960.0534513002531, -363.07938915140903, -603.874830222561, -1000.3532101999916, -232.64281153144898, -862.7213909726222, -631.3309277899637, -178.28587195110478, -165.8058761483814, -1211.604797050679, -1110.7210391227902, -975.2391398058178, -543.4572413770957, -1195.3945765506903, -954.1053601503523, -979.864883152746, -1159.2998797950213, -1290.335322246372, -811.6947545984609, -1403.7457154217966, -1097.487569182056, -941.9043949754795, -966.9012276549782, -1129.8726987232703, -869.928557423404, -580.4335193819873, -533.9084324222458, -437.52461835029345, -347.90207914494704, -1022.9281916009631, -326.3054731866688, -739.8007678891186, -647.7672788293509, -167.77836438855093, -273.8649788679374, -1323.0982896519915, -786.5358443590202, -227.1444344888228, -342.3321745704693, -949.4259836733231, -1209.7380888472337, -746.1074019109335, -861.5776969525384, -786.8633130617071, -72.29420061055801, -30.894406649041812, -147.47210867810043, -750.2198133840756, -722.3136995232962, -809.3993713595464, -154.65994248815068, -746.5696964722579, -1270.4466765167144, -327.9934467396271, -931.8829513063255, -493.26485922517213, -809.4447653479236, -733.8032578434031, -469.6041560804065, -981.6827146464127, -1258.023311131396, -1358.313545786439, -293.38764018668434, -831.9290867591841, -55.54736886397637, -957.4915215384997, -461.6000237419746, -1184.0880623823598, -940.9932382733555, -494.13242715543225, -142.6617990522708, -1269.6481311264001, -890.3032179046877, -1200.73673129805, -74.90011903036734, -824.1435230300232]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5746253947820589, "mean_inference_ms": 1.699209562849473, "mean_action_processing_ms": 0.2833751769461509, "mean_env_wait_ms": 3.427450216970955, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013301670551300049, "StateBufferConnector_ms": 0.008259415626525879, "ViewRequirementAgentConnector_ms": 0.18296748399734497}, "num_episodes": 28, "episode_return_max": -30.894406649041812, "episode_return_min": -1403.7457154217966, "episode_return_mean": -743.0352610063117, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.078436480611, "num_env_steps_trained_throughput_per_sec": 311.078436480611, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13147.197, "restore_workers_time_ms": 0.03, "training_step_time_ms": 13147.128, "sample_time_ms": 1164.894, "learn_time_ms": 11918.184, "learn_throughput": 335.622, "synch_weights_time_ms": 63.251}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00006", "date": "2024-08-04_06-01-41", "timestamp": 1722731501, "time_this_iter_s": 12.870270013809204, "time_total_s": 39.47859168052673, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0ae3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.47859168052673, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.221052631578946, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.5330739227434, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.876272109647592, "policy_loss": -0.010159176864544862, "vf_loss": 7.882890336712202, "vf_explained_var": 0.37403033518542844, "kl": 0.012257571919841824, "entropy": 1.3633584558963776, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -30.894406649041812, "episode_reward_min": -1403.7457154217966, "episode_reward_mean": -748.3656089601428, "episode_len_mean": 129.68, "episode_media": {}, "episodes_timesteps_total": 12968, "policy_reward_min": {"policy_0": -1403.7457154217966}, "policy_reward_max": {"policy_0": -30.894406649041812}, "policy_reward_mean": {"policy_0": -748.3656089601428}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-178.28587195110478, -165.8058761483814, -1211.604797050679, -1110.7210391227902, -975.2391398058178, -543.4572413770957, -1195.3945765506903, -954.1053601503523, -979.864883152746, -1159.2998797950213, -1290.335322246372, -811.6947545984609, -1403.7457154217966, -1097.487569182056, -941.9043949754795, -966.9012276549782, -1129.8726987232703, -869.928557423404, -580.4335193819873, -533.9084324222458, -437.52461835029345, -347.90207914494704, -1022.9281916009631, -326.3054731866688, -739.8007678891186, -647.7672788293509, -167.77836438855093, -273.8649788679374, -1323.0982896519915, -786.5358443590202, -227.1444344888228, -342.3321745704693, -949.4259836733231, -1209.7380888472337, -746.1074019109335, -861.5776969525384, -786.8633130617071, -72.29420061055801, -30.894406649041812, -147.47210867810043, -750.2198133840756, -722.3136995232962, -809.3993713595464, -154.65994248815068, -746.5696964722579, -1270.4466765167144, -327.9934467396271, -931.8829513063255, -493.26485922517213, -809.4447653479236, -733.8032578434031, -469.6041560804065, -981.6827146464127, -1258.023311131396, -1358.313545786439, -293.38764018668434, -831.9290867591841, -55.54736886397637, -957.4915215384997, -461.6000237419746, -1184.0880623823598, -940.9932382733555, -494.13242715543225, -142.6617990522708, -1269.6481311264001, -890.3032179046877, -1200.73673129805, -74.90011903036734, -824.1435230300232, -945.6092998570339, -919.4349099893315, -1105.4031437122085, -201.36736550429916, -1254.1506935781726, -779.4670039009297, -449.77584435646, -1028.2620933929882, -825.7018014431956, -996.0428285052506, -946.1302169168268, -1244.5236624319227, -593.366404933987, -1046.4140284691002, -351.8792783412769, -784.5752499663344, -1002.6323542019711, -63.232377113639174, -986.5455681259917, -855.7920495237383, -1156.055435648604, -138.80156003431338, -1083.4615868013675, -863.5908120320273, -705.0790420950419, -884.5892668665721, -592.7997618108215, -105.27480823630744, -144.52629704377495, -1077.029245091954, -718.5152550481312], "episode_lengths": [85, 65, 150, 150, 150, 118, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 95, 93, 150, 83, 150, 143, 59, 105, 150, 150, 73, 97, 150, 150, 150, 150, 150, 40, 45, 65, 150, 150, 150, 55, 150, 150, 80, 150, 150, 146, 150, 150, 150, 150, 150, 87, 150, 55, 150, 150, 150, 150, 143, 71, 150, 150, 150, 62, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 87, 138, 150, 45, 150, 150, 150, 60, 150, 150, 150, 150, 150, 61, 51, 150, 142], "policy_policy_0_reward": [-178.28587195110478, -165.8058761483814, -1211.604797050679, -1110.7210391227902, -975.2391398058178, -543.4572413770957, -1195.3945765506903, -954.1053601503523, -979.864883152746, -1159.2998797950213, -1290.335322246372, -811.6947545984609, -1403.7457154217966, -1097.487569182056, -941.9043949754795, -966.9012276549782, -1129.8726987232703, -869.928557423404, -580.4335193819873, -533.9084324222458, -437.52461835029345, -347.90207914494704, -1022.9281916009631, -326.3054731866688, -739.8007678891186, -647.7672788293509, -167.77836438855093, -273.8649788679374, -1323.0982896519915, -786.5358443590202, -227.1444344888228, -342.3321745704693, -949.4259836733231, -1209.7380888472337, -746.1074019109335, -861.5776969525384, -786.8633130617071, -72.29420061055801, -30.894406649041812, -147.47210867810043, -750.2198133840756, -722.3136995232962, -809.3993713595464, -154.65994248815068, -746.5696964722579, -1270.4466765167144, -327.9934467396271, -931.8829513063255, -493.26485922517213, -809.4447653479236, -733.8032578434031, -469.6041560804065, -981.6827146464127, -1258.023311131396, -1358.313545786439, -293.38764018668434, -831.9290867591841, -55.54736886397637, -957.4915215384997, -461.6000237419746, -1184.0880623823598, -940.9932382733555, -494.13242715543225, -142.6617990522708, -1269.6481311264001, -890.3032179046877, -1200.73673129805, -74.90011903036734, -824.1435230300232, -945.6092998570339, -919.4349099893315, -1105.4031437122085, -201.36736550429916, -1254.1506935781726, -779.4670039009297, -449.77584435646, -1028.2620933929882, -825.7018014431956, -996.0428285052506, -946.1302169168268, -1244.5236624319227, -593.366404933987, -1046.4140284691002, -351.8792783412769, -784.5752499663344, -1002.6323542019711, -63.232377113639174, -986.5455681259917, -855.7920495237383, -1156.055435648604, -138.80156003431338, -1083.4615868013675, -863.5908120320273, -705.0790420950419, -884.5892668665721, -592.7997618108215, -105.27480823630744, -144.52629704377495, -1077.029245091954, -718.5152550481312]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5729136809696285, "mean_inference_ms": 1.69859536462557, "mean_action_processing_ms": 0.28351389861994586, "mean_env_wait_ms": 3.4305147291993716, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013812541961669922, "StateBufferConnector_ms": 0.008498430252075195, "ViewRequirementAgentConnector_ms": 0.18742847442626953}, "num_episodes": 31, "episode_return_max": -30.894406649041812, "episode_return_min": -1403.7457154217966, "episode_return_mean": -748.3656089601428, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 372.0980325633596, "num_env_steps_trained_throughput_per_sec": 372.0980325633596, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12547.865, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12547.794, "sample_time_ms": 1161.926, "learn_time_ms": 11320.324, "learn_throughput": 353.347, "synch_weights_time_ms": 64.741}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00006", "date": "2024-08-04_06-01-51", "timestamp": 1722731511, "time_this_iter_s": 10.760435104370117, "time_total_s": 50.23902678489685, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0ae7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 50.23902678489685, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.886666666666667, "ram_util_percent": 27.89999999999999}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 42.356169719497366, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 6.7221045444409055, "policy_loss": -0.010513495758641512, "vf_loss": 6.728376052280267, "vf_explained_var": 0.6559318078060945, "kl": 0.01460539293873353, "entropy": 1.3961644239723683, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -30.894406649041812, "episode_reward_min": -1369.425605536254, "episode_reward_mean": -732.3763903949416, "episode_len_mean": 129.89, "episode_media": {}, "episodes_timesteps_total": 12989, "policy_reward_min": {"policy_0": -1369.425605536254}, "policy_reward_max": {"policy_0": -30.894406649041812}, "policy_reward_mean": {"policy_0": -732.3763903949416}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-227.1444344888228, -342.3321745704693, -949.4259836733231, -1209.7380888472337, -746.1074019109335, -861.5776969525384, -786.8633130617071, -72.29420061055801, -30.894406649041812, -147.47210867810043, -750.2198133840756, -722.3136995232962, -809.3993713595464, -154.65994248815068, -746.5696964722579, -1270.4466765167144, -327.9934467396271, -931.8829513063255, -493.26485922517213, -809.4447653479236, -733.8032578434031, -469.6041560804065, -981.6827146464127, -1258.023311131396, -1358.313545786439, -293.38764018668434, -831.9290867591841, -55.54736886397637, -957.4915215384997, -461.6000237419746, -1184.0880623823598, -940.9932382733555, -494.13242715543225, -142.6617990522708, -1269.6481311264001, -890.3032179046877, -1200.73673129805, -74.90011903036734, -824.1435230300232, -945.6092998570339, -919.4349099893315, -1105.4031437122085, -201.36736550429916, -1254.1506935781726, -779.4670039009297, -449.77584435646, -1028.2620933929882, -825.7018014431956, -996.0428285052506, -946.1302169168268, -1244.5236624319227, -593.366404933987, -1046.4140284691002, -351.8792783412769, -784.5752499663344, -1002.6323542019711, -63.232377113639174, -986.5455681259917, -855.7920495237383, -1156.055435648604, -138.80156003431338, -1083.4615868013675, -863.5908120320273, -705.0790420950419, -884.5892668665721, -592.7997618108215, -105.27480823630744, -144.52629704377495, -1077.029245091954, -718.5152550481312, -1062.0807079523336, -142.67627075506863, -1369.425605536254, -1362.381452371405, -823.3734014092378, -712.3514351110485, -981.3153415117266, -205.3205386990627, -1115.0341906609494, -38.15327066239513, -195.2987491996511, -500.02211280123515, -430.9468016860409, -75.68302821266504, -1152.9234140056303, -1075.90146297419, -643.0979115474838, -164.31377182373672, -1344.9172003596977, -608.6724084027791, -1039.5401737764448, -950.8421318222936, -723.1567333841102, -646.8645226264147, -1063.008388497019, -694.9913801149755, -741.9887788583142, -1032.279294502461, -679.6505255087791, -998.3638821100501], "episode_lengths": [73, 97, 150, 150, 150, 150, 150, 40, 45, 65, 150, 150, 150, 55, 150, 150, 80, 150, 150, 146, 150, 150, 150, 150, 150, 87, 150, 55, 150, 150, 150, 150, 143, 71, 150, 150, 150, 62, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 87, 138, 150, 45, 150, 150, 150, 60, 150, 150, 150, 150, 150, 61, 51, 150, 142, 150, 63, 150, 150, 150, 150, 150, 75, 150, 34, 90, 150, 143, 65, 150, 150, 144, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-227.1444344888228, -342.3321745704693, -949.4259836733231, -1209.7380888472337, -746.1074019109335, -861.5776969525384, -786.8633130617071, -72.29420061055801, -30.894406649041812, -147.47210867810043, -750.2198133840756, -722.3136995232962, -809.3993713595464, -154.65994248815068, -746.5696964722579, -1270.4466765167144, -327.9934467396271, -931.8829513063255, -493.26485922517213, -809.4447653479236, -733.8032578434031, -469.6041560804065, -981.6827146464127, -1258.023311131396, -1358.313545786439, -293.38764018668434, -831.9290867591841, -55.54736886397637, -957.4915215384997, -461.6000237419746, -1184.0880623823598, -940.9932382733555, -494.13242715543225, -142.6617990522708, -1269.6481311264001, -890.3032179046877, -1200.73673129805, -74.90011903036734, -824.1435230300232, -945.6092998570339, -919.4349099893315, -1105.4031437122085, -201.36736550429916, -1254.1506935781726, -779.4670039009297, -449.77584435646, -1028.2620933929882, -825.7018014431956, -996.0428285052506, -946.1302169168268, -1244.5236624319227, -593.366404933987, -1046.4140284691002, -351.8792783412769, -784.5752499663344, -1002.6323542019711, -63.232377113639174, -986.5455681259917, -855.7920495237383, -1156.055435648604, -138.80156003431338, -1083.4615868013675, -863.5908120320273, -705.0790420950419, -884.5892668665721, -592.7997618108215, -105.27480823630744, -144.52629704377495, -1077.029245091954, -718.5152550481312, -1062.0807079523336, -142.67627075506863, -1369.425605536254, -1362.381452371405, -823.3734014092378, -712.3514351110485, -981.3153415117266, -205.3205386990627, -1115.0341906609494, -38.15327066239513, -195.2987491996511, -500.02211280123515, -430.9468016860409, -75.68302821266504, -1152.9234140056303, -1075.90146297419, -643.0979115474838, -164.31377182373672, -1344.9172003596977, -608.6724084027791, -1039.5401737764448, -950.8421318222936, -723.1567333841102, -646.8645226264147, -1063.008388497019, -694.9913801149755, -741.9887788583142, -1032.279294502461, -679.6505255087791, -998.3638821100501]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5685343156548579, "mean_inference_ms": 1.7005913910756185, "mean_action_processing_ms": 0.2842819671619864, "mean_env_wait_ms": 3.429966573830599, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013440847396850586, "StateBufferConnector_ms": 0.008687496185302734, "ViewRequirementAgentConnector_ms": 0.18947958946228027}, "num_episodes": 30, "episode_return_max": -30.894406649041812, "episode_return_min": -1369.425605536254, "episode_return_mean": -732.3763903949416, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.989722009814, "num_env_steps_trained_throughput_per_sec": 319.989722009814, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 12538.377, "restore_workers_time_ms": 0.037, "training_step_time_ms": 12538.294, "sample_time_ms": 1147.953, "learn_time_ms": 11324.59, "learn_throughput": 353.214, "synch_weights_time_ms": 64.93}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00006", "date": "2024-08-04_06-02-04", "timestamp": 1722731524, "time_this_iter_s": 12.513988733291626, "time_total_s": 62.75301551818848, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a7880>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 62.75301551818848, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.422222222222224, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 76.70647705197334, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.789607194066048, "policy_loss": -0.013197807855128, "vf_loss": 5.798541812598705, "vf_explained_var": 0.8113176403567195, "kl": 0.014673367718599674, "entropy": 1.3884225267916919, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -38.15327066239513, "episode_reward_min": -1431.665306881512, "episode_reward_mean": -745.1116597900357, "episode_len_mean": 130.95, "episode_media": {}, "episodes_timesteps_total": 13095, "policy_reward_min": {"policy_0": -1431.665306881512}, "policy_reward_max": {"policy_0": -38.15327066239513}, "policy_reward_mean": {"policy_0": -745.1116597900357}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-957.4915215384997, -461.6000237419746, -1184.0880623823598, -940.9932382733555, -494.13242715543225, -142.6617990522708, -1269.6481311264001, -890.3032179046877, -1200.73673129805, -74.90011903036734, -824.1435230300232, -945.6092998570339, -919.4349099893315, -1105.4031437122085, -201.36736550429916, -1254.1506935781726, -779.4670039009297, -449.77584435646, -1028.2620933929882, -825.7018014431956, -996.0428285052506, -946.1302169168268, -1244.5236624319227, -593.366404933987, -1046.4140284691002, -351.8792783412769, -784.5752499663344, -1002.6323542019711, -63.232377113639174, -986.5455681259917, -855.7920495237383, -1156.055435648604, -138.80156003431338, -1083.4615868013675, -863.5908120320273, -705.0790420950419, -884.5892668665721, -592.7997618108215, -105.27480823630744, -144.52629704377495, -1077.029245091954, -718.5152550481312, -1062.0807079523336, -142.67627075506863, -1369.425605536254, -1362.381452371405, -823.3734014092378, -712.3514351110485, -981.3153415117266, -205.3205386990627, -1115.0341906609494, -38.15327066239513, -195.2987491996511, -500.02211280123515, -430.9468016860409, -75.68302821266504, -1152.9234140056303, -1075.90146297419, -643.0979115474838, -164.31377182373672, -1344.9172003596977, -608.6724084027791, -1039.5401737764448, -950.8421318222936, -723.1567333841102, -646.8645226264147, -1063.008388497019, -694.9913801149755, -741.9887788583142, -1032.279294502461, -679.6505255087791, -998.3638821100501, -1033.8886669740893, -332.81353075409305, -1108.9355907608233, -1335.1575021618316, -1431.665306881512, -699.9592747798631, -1138.4633915677828, -1228.0436126317861, -236.39455879657697, -782.8284054737172, -1196.393267093307, -1027.533228633255, -264.56043508170643, -213.66213616054196, -447.29117944193194, -508.22360290477684, -782.8540887105535, -1301.2692696173344, -736.8694056351433, -56.735749152507054, -633.7118196266579, -690.7100257641487, -59.94639658391502, -240.53820973734358, -738.0646008775311, -356.38131602666283, -204.29692806689613, -858.6715527168251], "episode_lengths": [150, 150, 150, 150, 143, 71, 150, 150, 150, 62, 150, 150, 150, 150, 89, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 87, 138, 150, 45, 150, 150, 150, 60, 150, 150, 150, 150, 150, 61, 51, 150, 142, 150, 63, 150, 150, 150, 150, 150, 75, 150, 34, 90, 150, 143, 65, 150, 150, 144, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 100, 98, 129, 150, 150, 150, 45, 150, 150, 66, 74, 150, 87, 69, 150], "policy_policy_0_reward": [-957.4915215384997, -461.6000237419746, -1184.0880623823598, -940.9932382733555, -494.13242715543225, -142.6617990522708, -1269.6481311264001, -890.3032179046877, -1200.73673129805, -74.90011903036734, -824.1435230300232, -945.6092998570339, -919.4349099893315, -1105.4031437122085, -201.36736550429916, -1254.1506935781726, -779.4670039009297, -449.77584435646, -1028.2620933929882, -825.7018014431956, -996.0428285052506, -946.1302169168268, -1244.5236624319227, -593.366404933987, -1046.4140284691002, -351.8792783412769, -784.5752499663344, -1002.6323542019711, -63.232377113639174, -986.5455681259917, -855.7920495237383, -1156.055435648604, -138.80156003431338, -1083.4615868013675, -863.5908120320273, -705.0790420950419, -884.5892668665721, -592.7997618108215, -105.27480823630744, -144.52629704377495, -1077.029245091954, -718.5152550481312, -1062.0807079523336, -142.67627075506863, -1369.425605536254, -1362.381452371405, -823.3734014092378, -712.3514351110485, -981.3153415117266, -205.3205386990627, -1115.0341906609494, -38.15327066239513, -195.2987491996511, -500.02211280123515, -430.9468016860409, -75.68302821266504, -1152.9234140056303, -1075.90146297419, -643.0979115474838, -164.31377182373672, -1344.9172003596977, -608.6724084027791, -1039.5401737764448, -950.8421318222936, -723.1567333841102, -646.8645226264147, -1063.008388497019, -694.9913801149755, -741.9887788583142, -1032.279294502461, -679.6505255087791, -998.3638821100501, -1033.8886669740893, -332.81353075409305, -1108.9355907608233, -1335.1575021618316, -1431.665306881512, -699.9592747798631, -1138.4633915677828, -1228.0436126317861, -236.39455879657697, -782.8284054737172, -1196.393267093307, -1027.533228633255, -264.56043508170643, -213.66213616054196, -447.29117944193194, -508.22360290477684, -782.8540887105535, -1301.2692696173344, -736.8694056351433, -56.735749152507054, -633.7118196266579, -690.7100257641487, -59.94639658391502, -240.53820973734358, -738.0646008775311, -356.38131602666283, -204.29692806689613, -858.6715527168251]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.566105020373088, "mean_inference_ms": 1.69786787724579, "mean_action_processing_ms": 0.28380439567376575, "mean_env_wait_ms": 3.4304872847228354, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01320791244506836, "StateBufferConnector_ms": 0.008664846420288086, "ViewRequirementAgentConnector_ms": 0.18892645835876465}, "num_episodes": 28, "episode_return_max": -38.15327066239513, "episode_return_min": -1431.665306881512, "episode_return_mean": -745.1116597900357, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 294.6617418259291, "num_env_steps_trained_throughput_per_sec": 294.6617418259291, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12711.131, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12711.051, "sample_time_ms": 1148.59, "learn_time_ms": 11497.966, "learn_throughput": 347.888, "synch_weights_time_ms": 63.673}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00006", "date": "2024-08-04_06-02-18", "timestamp": 1722731538, "time_this_iter_s": 13.587428569793701, "time_total_s": 76.34044408798218, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01420e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 76.34044408798218, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.9, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 87.6890667607387, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.085000306988756, "policy_loss": -0.01167544994095806, "vf_loss": 5.091889432569345, "vf_explained_var": 0.8248188800488909, "kl": 0.016464874472634013, "entropy": 1.5313646775980791, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -38.15327066239513, "episode_reward_min": -1431.665306881512, "episode_reward_mean": -748.879090318826, "episode_len_mean": 131.38, "episode_media": {}, "episodes_timesteps_total": 13138, "policy_reward_min": {"policy_0": -1431.665306881512}, "policy_reward_max": {"policy_0": -38.15327066239513}, "policy_reward_mean": {"policy_0": -748.879090318826}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-855.7920495237383, -1156.055435648604, -138.80156003431338, -1083.4615868013675, -863.5908120320273, -705.0790420950419, -884.5892668665721, -592.7997618108215, -105.27480823630744, -144.52629704377495, -1077.029245091954, -718.5152550481312, -1062.0807079523336, -142.67627075506863, -1369.425605536254, -1362.381452371405, -823.3734014092378, -712.3514351110485, -981.3153415117266, -205.3205386990627, -1115.0341906609494, -38.15327066239513, -195.2987491996511, -500.02211280123515, -430.9468016860409, -75.68302821266504, -1152.9234140056303, -1075.90146297419, -643.0979115474838, -164.31377182373672, -1344.9172003596977, -608.6724084027791, -1039.5401737764448, -950.8421318222936, -723.1567333841102, -646.8645226264147, -1063.008388497019, -694.9913801149755, -741.9887788583142, -1032.279294502461, -679.6505255087791, -998.3638821100501, -1033.8886669740893, -332.81353075409305, -1108.9355907608233, -1335.1575021618316, -1431.665306881512, -699.9592747798631, -1138.4633915677828, -1228.0436126317861, -236.39455879657697, -782.8284054737172, -1196.393267093307, -1027.533228633255, -264.56043508170643, -213.66213616054196, -447.29117944193194, -508.22360290477684, -782.8540887105535, -1301.2692696173344, -736.8694056351433, -56.735749152507054, -633.7118196266579, -690.7100257641487, -59.94639658391502, -240.53820973734358, -738.0646008775311, -356.38131602666283, -204.29692806689613, -858.6715527168251, -865.8575915934842, -845.7362090339128, -847.8756223395239, -1306.9209033013872, -1236.8399367724714, -261.4442896625362, -1353.8380781855703, -407.9485904996714, -827.4879469057157, -689.7673254720802, -111.78672598259362, -1232.4959479329586, -206.09311375161118, -872.4833868117768, -940.1366130799194, -963.6015548008265, -447.32957463663615, -655.1362977767202, -1216.7761779138816, -1200.9673393225828, -1214.818224006125, -1279.9134240227618, -762.1242293496856, -210.58504711909995, -856.4893222608242, -987.4353947386288, -221.5381527031307, -708.2025055260009, -761.3108383960109, -849.0156082552621], "episode_lengths": [150, 150, 60, 150, 150, 150, 150, 150, 61, 51, 150, 142, 150, 63, 150, 150, 150, 150, 150, 75, 150, 34, 90, 150, 143, 65, 150, 150, 144, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 100, 98, 129, 150, 150, 150, 45, 150, 150, 66, 74, 150, 87, 69, 150, 150, 150, 150, 150, 150, 132, 150, 134, 150, 150, 47, 150, 65, 150, 150, 150, 127, 129, 150, 150, 150, 150, 150, 84, 150, 150, 80, 150, 150, 150], "policy_policy_0_reward": [-855.7920495237383, -1156.055435648604, -138.80156003431338, -1083.4615868013675, -863.5908120320273, -705.0790420950419, -884.5892668665721, -592.7997618108215, -105.27480823630744, -144.52629704377495, -1077.029245091954, -718.5152550481312, -1062.0807079523336, -142.67627075506863, -1369.425605536254, -1362.381452371405, -823.3734014092378, -712.3514351110485, -981.3153415117266, -205.3205386990627, -1115.0341906609494, -38.15327066239513, -195.2987491996511, -500.02211280123515, -430.9468016860409, -75.68302821266504, -1152.9234140056303, -1075.90146297419, -643.0979115474838, -164.31377182373672, -1344.9172003596977, -608.6724084027791, -1039.5401737764448, -950.8421318222936, -723.1567333841102, -646.8645226264147, -1063.008388497019, -694.9913801149755, -741.9887788583142, -1032.279294502461, -679.6505255087791, -998.3638821100501, -1033.8886669740893, -332.81353075409305, -1108.9355907608233, -1335.1575021618316, -1431.665306881512, -699.9592747798631, -1138.4633915677828, -1228.0436126317861, -236.39455879657697, -782.8284054737172, -1196.393267093307, -1027.533228633255, -264.56043508170643, -213.66213616054196, -447.29117944193194, -508.22360290477684, -782.8540887105535, -1301.2692696173344, -736.8694056351433, -56.735749152507054, -633.7118196266579, -690.7100257641487, -59.94639658391502, -240.53820973734358, -738.0646008775311, -356.38131602666283, -204.29692806689613, -858.6715527168251, -865.8575915934842, -845.7362090339128, -847.8756223395239, -1306.9209033013872, -1236.8399367724714, -261.4442896625362, -1353.8380781855703, -407.9485904996714, -827.4879469057157, -689.7673254720802, -111.78672598259362, -1232.4959479329586, -206.09311375161118, -872.4833868117768, -940.1366130799194, -963.6015548008265, -447.32957463663615, -655.1362977767202, -1216.7761779138816, -1200.9673393225828, -1214.818224006125, -1279.9134240227618, -762.1242293496856, -210.58504711909995, -856.4893222608242, -987.4353947386288, -221.5381527031307, -708.2025055260009, -761.3108383960109, -849.0156082552621]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5640552301803973, "mean_inference_ms": 1.6912351353679975, "mean_action_processing_ms": 0.28179855448221874, "mean_env_wait_ms": 3.4289124013303525, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012979507446289062, "StateBufferConnector_ms": 0.008496522903442383, "ViewRequirementAgentConnector_ms": 0.1909940242767334}, "num_episodes": 30, "episode_return_max": -38.15327066239513, "episode_return_min": -1431.665306881512, "episode_return_mean": -748.879090318826, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 361.55502995187436, "num_env_steps_trained_throughput_per_sec": 361.55502995187436, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12475.731, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12475.652, "sample_time_ms": 1151.391, "learn_time_ms": 11258.85, "learn_throughput": 355.276, "synch_weights_time_ms": 64.599}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00006", "date": "2024-08-04_06-02-29", "timestamp": 1722731549, "time_this_iter_s": 11.078084707260132, "time_total_s": 87.41852879524231, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0112f80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 87.41852879524231, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.55, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 104.6640884498755, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 5.003904488682747, "policy_loss": -0.017111099357134663, "vf_loss": 5.015552470336358, "vf_explained_var": 0.8987462711830934, "kl": 0.01870718236923495, "entropy": 1.4903490740805865, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -11.785471077625713, "episode_reward_min": -1452.3544375376227, "episode_reward_mean": -789.6838757338528, "episode_len_mean": 133.97, "episode_media": {}, "episodes_timesteps_total": 13397, "policy_reward_min": {"policy_0": -1452.3544375376227}, "policy_reward_max": {"policy_0": -11.785471077625713}, "policy_reward_mean": {"policy_0": -789.6838757338528}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-723.1567333841102, -646.8645226264147, -1063.008388497019, -694.9913801149755, -741.9887788583142, -1032.279294502461, -679.6505255087791, -998.3638821100501, -1033.8886669740893, -332.81353075409305, -1108.9355907608233, -1335.1575021618316, -1431.665306881512, -699.9592747798631, -1138.4633915677828, -1228.0436126317861, -236.39455879657697, -782.8284054737172, -1196.393267093307, -1027.533228633255, -264.56043508170643, -213.66213616054196, -447.29117944193194, -508.22360290477684, -782.8540887105535, -1301.2692696173344, -736.8694056351433, -56.735749152507054, -633.7118196266579, -690.7100257641487, -59.94639658391502, -240.53820973734358, -738.0646008775311, -356.38131602666283, -204.29692806689613, -858.6715527168251, -865.8575915934842, -845.7362090339128, -847.8756223395239, -1306.9209033013872, -1236.8399367724714, -261.4442896625362, -1353.8380781855703, -407.9485904996714, -827.4879469057157, -689.7673254720802, -111.78672598259362, -1232.4959479329586, -206.09311375161118, -872.4833868117768, -940.1366130799194, -963.6015548008265, -447.32957463663615, -655.1362977767202, -1216.7761779138816, -1200.9673393225828, -1214.818224006125, -1279.9134240227618, -762.1242293496856, -210.58504711909995, -856.4893222608242, -987.4353947386288, -221.5381527031307, -708.2025055260009, -761.3108383960109, -849.0156082552621, -919.7638709643286, -1224.7753737120108, -826.5504961977713, -11.785471077625713, -1114.405962006428, -1042.1900406758598, -225.15579771922754, -1452.3544375376227, -889.7235224301289, -1177.3803021633128, -214.41549134165743, -1155.8002007016128, -1057.015843384514, -798.0913552595455, -194.2330254344968, -305.23446898169266, -1358.5975128909017, -995.72809349306, -1224.2146993726203, -758.1126095636552, -931.2659184703513, -1112.7130347189218, -1330.195176857986, -1150.7811952413879, -419.99474291383643, -466.15821646318267, -613.27891780145, -488.3411137620367, -1102.6706394466662, -53.749109685325664, -802.7009278970048, -730.3986714214266, -1088.7371723139104, -1163.751631115095], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 97, 100, 98, 129, 150, 150, 150, 45, 150, 150, 66, 74, 150, 87, 69, 150, 150, 150, 150, 150, 150, 132, 150, 134, 150, 150, 47, 150, 65, 150, 150, 150, 127, 129, 150, 150, 150, 150, 150, 84, 150, 150, 80, 150, 150, 150, 150, 150, 150, 34, 150, 150, 109, 150, 150, 150, 99, 150, 150, 150, 94, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 124, 107, 150, 44, 150, 150, 150, 150], "policy_policy_0_reward": [-723.1567333841102, -646.8645226264147, -1063.008388497019, -694.9913801149755, -741.9887788583142, -1032.279294502461, -679.6505255087791, -998.3638821100501, -1033.8886669740893, -332.81353075409305, -1108.9355907608233, -1335.1575021618316, -1431.665306881512, -699.9592747798631, -1138.4633915677828, -1228.0436126317861, -236.39455879657697, -782.8284054737172, -1196.393267093307, -1027.533228633255, -264.56043508170643, -213.66213616054196, -447.29117944193194, -508.22360290477684, -782.8540887105535, -1301.2692696173344, -736.8694056351433, -56.735749152507054, -633.7118196266579, -690.7100257641487, -59.94639658391502, -240.53820973734358, -738.0646008775311, -356.38131602666283, -204.29692806689613, -858.6715527168251, -865.8575915934842, -845.7362090339128, -847.8756223395239, -1306.9209033013872, -1236.8399367724714, -261.4442896625362, -1353.8380781855703, -407.9485904996714, -827.4879469057157, -689.7673254720802, -111.78672598259362, -1232.4959479329586, -206.09311375161118, -872.4833868117768, -940.1366130799194, -963.6015548008265, -447.32957463663615, -655.1362977767202, -1216.7761779138816, -1200.9673393225828, -1214.818224006125, -1279.9134240227618, -762.1242293496856, -210.58504711909995, -856.4893222608242, -987.4353947386288, -221.5381527031307, -708.2025055260009, -761.3108383960109, -849.0156082552621, -919.7638709643286, -1224.7753737120108, -826.5504961977713, -11.785471077625713, -1114.405962006428, -1042.1900406758598, -225.15579771922754, -1452.3544375376227, -889.7235224301289, -1177.3803021633128, -214.41549134165743, -1155.8002007016128, -1057.015843384514, -798.0913552595455, -194.2330254344968, -305.23446898169266, -1358.5975128909017, -995.72809349306, -1224.2146993726203, -758.1126095636552, -931.2659184703513, -1112.7130347189218, -1330.195176857986, -1150.7811952413879, -419.99474291383643, -466.15821646318267, -613.27891780145, -488.3411137620367, -1102.6706394466662, -53.749109685325664, -802.7009278970048, -730.3986714214266, -1088.7371723139104, -1163.751631115095]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5627948212867233, "mean_inference_ms": 1.6887768637023592, "mean_action_processing_ms": 0.28187831654734014, "mean_env_wait_ms": 3.4396829391487307, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01236867904663086, "StateBufferConnector_ms": 0.008234739303588867, "ViewRequirementAgentConnector_ms": 0.19042754173278809}, "num_episodes": 34, "episode_return_max": -11.785471077625713, "episode_return_min": -1452.3544375376227, "episode_return_mean": -789.6838757338528, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.75198860437655, "num_env_steps_trained_throughput_per_sec": 300.75198860437655, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12578.766, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12578.686, "sample_time_ms": 1158.21, "learn_time_ms": 11354.042, "learn_throughput": 352.297, "synch_weights_time_ms": 65.61}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00006", "date": "2024-08-04_06-02-42", "timestamp": 1722731562, "time_this_iter_s": 13.312609195709229, "time_total_s": 100.73113799095154, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc702950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 100.73113799095154, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.189473684210526, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 127.63310559193293, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.544461106757323, "policy_loss": -0.012203891019453295, "vf_loss": 4.552042340487242, "vf_explained_var": 0.8878360723455747, "kl": 0.015909840041164604, "entropy": 1.5028931114822626, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -11.785471077625713, "episode_reward_min": -1452.3544375376227, "episode_reward_mean": -763.4553568369332, "episode_len_mean": 131.41, "episode_media": {}, "episodes_timesteps_total": 13141, "policy_reward_min": {"policy_0": -1452.3544375376227}, "policy_reward_max": {"policy_0": -11.785471077625713}, "policy_reward_mean": {"policy_0": -763.4553568369332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-59.94639658391502, -240.53820973734358, -738.0646008775311, -356.38131602666283, -204.29692806689613, -858.6715527168251, -865.8575915934842, -845.7362090339128, -847.8756223395239, -1306.9209033013872, -1236.8399367724714, -261.4442896625362, -1353.8380781855703, -407.9485904996714, -827.4879469057157, -689.7673254720802, -111.78672598259362, -1232.4959479329586, -206.09311375161118, -872.4833868117768, -940.1366130799194, -963.6015548008265, -447.32957463663615, -655.1362977767202, -1216.7761779138816, -1200.9673393225828, -1214.818224006125, -1279.9134240227618, -762.1242293496856, -210.58504711909995, -856.4893222608242, -987.4353947386288, -221.5381527031307, -708.2025055260009, -761.3108383960109, -849.0156082552621, -919.7638709643286, -1224.7753737120108, -826.5504961977713, -11.785471077625713, -1114.405962006428, -1042.1900406758598, -225.15579771922754, -1452.3544375376227, -889.7235224301289, -1177.3803021633128, -214.41549134165743, -1155.8002007016128, -1057.015843384514, -798.0913552595455, -194.2330254344968, -305.23446898169266, -1358.5975128909017, -995.72809349306, -1224.2146993726203, -758.1126095636552, -931.2659184703513, -1112.7130347189218, -1330.195176857986, -1150.7811952413879, -419.99474291383643, -466.15821646318267, -613.27891780145, -488.3411137620367, -1102.6706394466662, -53.749109685325664, -802.7009278970048, -730.3986714214266, -1088.7371723139104, -1163.751631115095, -481.6120027678227, -122.56819792798562, -157.3725959590182, -1143.268650368297, -564.3757390759793, -447.6081159820406, -30.430418481717435, -1098.0820546058715, -1267.9853837628336, -452.489332365529, -1131.0186138214096, -743.6276363686776, -1081.062244847546, -96.66031743397382, -628.0139016645574, -316.19544847666305, -560.0699848589338, -1098.0715825797008, -658.9592611081898, -892.01940735916, -1050.3137588987543, -836.3067632316636, -1349.383938286381, -967.9470503273911, -194.7200193656884, -422.92269678736625, -590.8167600845824, -1422.0120647516878, -472.09595504179003, -867.4057679228914], "episode_lengths": [66, 74, 150, 87, 69, 150, 150, 150, 150, 150, 150, 132, 150, 134, 150, 150, 47, 150, 65, 150, 150, 150, 127, 129, 150, 150, 150, 150, 150, 84, 150, 150, 80, 150, 150, 150, 150, 150, 150, 34, 150, 150, 109, 150, 150, 150, 99, 150, 150, 150, 94, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 124, 107, 150, 44, 150, 150, 150, 150, 150, 80, 62, 150, 111, 126, 46, 150, 150, 150, 150, 132, 150, 61, 150, 87, 121, 150, 150, 150, 150, 150, 150, 150, 100, 121, 150, 150, 150, 150], "policy_policy_0_reward": [-59.94639658391502, -240.53820973734358, -738.0646008775311, -356.38131602666283, -204.29692806689613, -858.6715527168251, -865.8575915934842, -845.7362090339128, -847.8756223395239, -1306.9209033013872, -1236.8399367724714, -261.4442896625362, -1353.8380781855703, -407.9485904996714, -827.4879469057157, -689.7673254720802, -111.78672598259362, -1232.4959479329586, -206.09311375161118, -872.4833868117768, -940.1366130799194, -963.6015548008265, -447.32957463663615, -655.1362977767202, -1216.7761779138816, -1200.9673393225828, -1214.818224006125, -1279.9134240227618, -762.1242293496856, -210.58504711909995, -856.4893222608242, -987.4353947386288, -221.5381527031307, -708.2025055260009, -761.3108383960109, -849.0156082552621, -919.7638709643286, -1224.7753737120108, -826.5504961977713, -11.785471077625713, -1114.405962006428, -1042.1900406758598, -225.15579771922754, -1452.3544375376227, -889.7235224301289, -1177.3803021633128, -214.41549134165743, -1155.8002007016128, -1057.015843384514, -798.0913552595455, -194.2330254344968, -305.23446898169266, -1358.5975128909017, -995.72809349306, -1224.2146993726203, -758.1126095636552, -931.2659184703513, -1112.7130347189218, -1330.195176857986, -1150.7811952413879, -419.99474291383643, -466.15821646318267, -613.27891780145, -488.3411137620367, -1102.6706394466662, -53.749109685325664, -802.7009278970048, -730.3986714214266, -1088.7371723139104, -1163.751631115095, -481.6120027678227, -122.56819792798562, -157.3725959590182, -1143.268650368297, -564.3757390759793, -447.6081159820406, -30.430418481717435, -1098.0820546058715, -1267.9853837628336, -452.489332365529, -1131.0186138214096, -743.6276363686776, -1081.062244847546, -96.66031743397382, -628.0139016645574, -316.19544847666305, -560.0699848589338, -1098.0715825797008, -658.9592611081898, -892.01940735916, -1050.3137588987543, -836.3067632316636, -1349.383938286381, -967.9470503273911, -194.7200193656884, -422.92269678736625, -590.8167600845824, -1422.0120647516878, -472.09595504179003, -867.4057679228914]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5617864676961588, "mean_inference_ms": 1.687410815990409, "mean_action_processing_ms": 0.28101162491689036, "mean_env_wait_ms": 3.4408748371244413, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011878728866577148, "StateBufferConnector_ms": 0.007893800735473633, "ViewRequirementAgentConnector_ms": 0.19594073295593262}, "num_episodes": 30, "episode_return_max": -11.785471077625713, "episode_return_min": -1452.3544375376227, "episode_return_mean": -763.4553568369332, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.896096304584, "num_env_steps_trained_throughput_per_sec": 296.896096304584, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12678.096, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12678.016, "sample_time_ms": 1154.351, "learn_time_ms": 11457.77, "learn_throughput": 349.108, "synch_weights_time_ms": 65.076}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00006", "date": "2024-08-04_06-02-56", "timestamp": 1722731576, "time_this_iter_s": 13.48447871208191, "time_total_s": 114.21561670303345, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0141000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 114.21561670303345, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.9, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 163.13749554753304, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.9155181596676507, "policy_loss": -0.009953999794864407, "vf_loss": 3.9212828556696575, "vf_explained_var": 0.9599986635769407, "kl": 0.014441867692282069, "entropy": 1.432689708347122, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -11.785471077625713, "episode_reward_min": -1452.3544375376227, "episode_reward_mean": -780.0844333032774, "episode_len_mean": 132.94, "episode_media": {}, "episodes_timesteps_total": 13294, "policy_reward_min": {"policy_0": -1452.3544375376227}, "policy_reward_max": {"policy_0": -11.785471077625713}, "policy_reward_mean": {"policy_0": -780.0844333032774}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-987.4353947386288, -221.5381527031307, -708.2025055260009, -761.3108383960109, -849.0156082552621, -919.7638709643286, -1224.7753737120108, -826.5504961977713, -11.785471077625713, -1114.405962006428, -1042.1900406758598, -225.15579771922754, -1452.3544375376227, -889.7235224301289, -1177.3803021633128, -214.41549134165743, -1155.8002007016128, -1057.015843384514, -798.0913552595455, -194.2330254344968, -305.23446898169266, -1358.5975128909017, -995.72809349306, -1224.2146993726203, -758.1126095636552, -931.2659184703513, -1112.7130347189218, -1330.195176857986, -1150.7811952413879, -419.99474291383643, -466.15821646318267, -613.27891780145, -488.3411137620367, -1102.6706394466662, -53.749109685325664, -802.7009278970048, -730.3986714214266, -1088.7371723139104, -1163.751631115095, -481.6120027678227, -122.56819792798562, -157.3725959590182, -1143.268650368297, -564.3757390759793, -447.6081159820406, -30.430418481717435, -1098.0820546058715, -1267.9853837628336, -452.489332365529, -1131.0186138214096, -743.6276363686776, -1081.062244847546, -96.66031743397382, -628.0139016645574, -316.19544847666305, -560.0699848589338, -1098.0715825797008, -658.9592611081898, -892.01940735916, -1050.3137588987543, -836.3067632316636, -1349.383938286381, -967.9470503273911, -194.7200193656884, -422.92269678736625, -590.8167600845824, -1422.0120647516878, -472.09595504179003, -867.4057679228914, -1212.9621230543821, -492.8214906561114, -876.506789401058, -48.7869080289958, -1007.541923076704, -220.2129390796005, -1371.1309455832447, -588.2749981611241, -989.7286609580634, -1032.5673318618237, -810.1924600878112, -1300.8903865881193, -934.8745468891776, -901.4838380768198, -176.19190134805297, -456.6766566242809, -772.1462198468957, -100.71543883442098, -437.89452701649014, -1029.2843426208674, -847.3578287668738, -814.302942507213, -614.555783649189, -227.28560616238977, -1192.5965235181716, -929.7180010884623, -1279.044549763031, -1126.8822446041854, -940.7003543601068, -1162.3798727186545, -1039.5519882456285], "episode_lengths": [150, 80, 150, 150, 150, 150, 150, 150, 34, 150, 150, 109, 150, 150, 150, 99, 150, 150, 150, 94, 79, 150, 150, 150, 150, 150, 150, 150, 150, 150, 110, 124, 107, 150, 44, 150, 150, 150, 150, 150, 80, 62, 150, 111, 126, 46, 150, 150, 150, 150, 132, 150, 61, 150, 87, 121, 150, 150, 150, 150, 150, 150, 150, 100, 121, 150, 150, 150, 150, 150, 150, 150, 42, 150, 74, 150, 149, 150, 150, 150, 150, 150, 150, 59, 103, 150, 79, 126, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-987.4353947386288, -221.5381527031307, -708.2025055260009, -761.3108383960109, -849.0156082552621, -919.7638709643286, -1224.7753737120108, -826.5504961977713, -11.785471077625713, -1114.405962006428, -1042.1900406758598, -225.15579771922754, -1452.3544375376227, -889.7235224301289, -1177.3803021633128, -214.41549134165743, -1155.8002007016128, -1057.015843384514, -798.0913552595455, -194.2330254344968, -305.23446898169266, -1358.5975128909017, -995.72809349306, -1224.2146993726203, -758.1126095636552, -931.2659184703513, -1112.7130347189218, -1330.195176857986, -1150.7811952413879, -419.99474291383643, -466.15821646318267, -613.27891780145, -488.3411137620367, -1102.6706394466662, -53.749109685325664, -802.7009278970048, -730.3986714214266, -1088.7371723139104, -1163.751631115095, -481.6120027678227, -122.56819792798562, -157.3725959590182, -1143.268650368297, -564.3757390759793, -447.6081159820406, -30.430418481717435, -1098.0820546058715, -1267.9853837628336, -452.489332365529, -1131.0186138214096, -743.6276363686776, -1081.062244847546, -96.66031743397382, -628.0139016645574, -316.19544847666305, -560.0699848589338, -1098.0715825797008, -658.9592611081898, -892.01940735916, -1050.3137588987543, -836.3067632316636, -1349.383938286381, -967.9470503273911, -194.7200193656884, -422.92269678736625, -590.8167600845824, -1422.0120647516878, -472.09595504179003, -867.4057679228914, -1212.9621230543821, -492.8214906561114, -876.506789401058, -48.7869080289958, -1007.541923076704, -220.2129390796005, -1371.1309455832447, -588.2749981611241, -989.7286609580634, -1032.5673318618237, -810.1924600878112, -1300.8903865881193, -934.8745468891776, -901.4838380768198, -176.19190134805297, -456.6766566242809, -772.1462198468957, -100.71543883442098, -437.89452701649014, -1029.2843426208674, -847.3578287668738, -814.302942507213, -614.555783649189, -227.28560616238977, -1192.5965235181716, -929.7180010884623, -1279.044549763031, -1126.8822446041854, -940.7003543601068, -1162.3798727186545, -1039.5519882456285]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5601424703130716, "mean_inference_ms": 1.6868676715161681, "mean_action_processing_ms": 0.28071891687629047, "mean_env_wait_ms": 3.4450544387724427, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011491775512695312, "StateBufferConnector_ms": 0.007767915725708008, "ViewRequirementAgentConnector_ms": 0.19348764419555664}, "num_episodes": 31, "episode_return_max": -11.785471077625713, "episode_return_min": -1452.3544375376227, "episode_return_mean": -780.0844333032774, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 318.7011672780995, "num_env_steps_trained_throughput_per_sec": 318.7011672780995, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12665.382, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12665.302, "sample_time_ms": 1153.498, "learn_time_ms": 11444.585, "learn_throughput": 349.51, "synch_weights_time_ms": 66.397}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00006", "date": "2024-08-04_06-03-08", "timestamp": 1722731588, "time_this_iter_s": 12.563454627990723, "time_total_s": 126.77907133102417, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0140430>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 126.77907133102417, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.366666666666664, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 148.74032500187556, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.879863495628039, "policy_loss": -0.013976751459995284, "vf_loss": 3.88920409878095, "vf_explained_var": 0.9716093347097436, "kl": 0.015970744575558152, "entropy": 1.5506400066117445, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -28.390772669374513, "episode_reward_min": -1455.6334487457323, "episode_reward_mean": -703.0305853032293, "episode_len_mean": 127.57, "episode_media": {}, "episodes_timesteps_total": 12757, "policy_reward_min": {"policy_0": -1455.6334487457323}, "policy_reward_max": {"policy_0": -28.390772669374513}, "policy_reward_mean": {"policy_0": -703.0305853032293}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-466.15821646318267, -613.27891780145, -488.3411137620367, -1102.6706394466662, -53.749109685325664, -802.7009278970048, -730.3986714214266, -1088.7371723139104, -1163.751631115095, -481.6120027678227, -122.56819792798562, -157.3725959590182, -1143.268650368297, -564.3757390759793, -447.6081159820406, -30.430418481717435, -1098.0820546058715, -1267.9853837628336, -452.489332365529, -1131.0186138214096, -743.6276363686776, -1081.062244847546, -96.66031743397382, -628.0139016645574, -316.19544847666305, -560.0699848589338, -1098.0715825797008, -658.9592611081898, -892.01940735916, -1050.3137588987543, -836.3067632316636, -1349.383938286381, -967.9470503273911, -194.7200193656884, -422.92269678736625, -590.8167600845824, -1422.0120647516878, -472.09595504179003, -867.4057679228914, -1212.9621230543821, -492.8214906561114, -876.506789401058, -48.7869080289958, -1007.541923076704, -220.2129390796005, -1371.1309455832447, -588.2749981611241, -989.7286609580634, -1032.5673318618237, -810.1924600878112, -1300.8903865881193, -934.8745468891776, -901.4838380768198, -176.19190134805297, -456.6766566242809, -772.1462198468957, -100.71543883442098, -437.89452701649014, -1029.2843426208674, -847.3578287668738, -814.302942507213, -614.555783649189, -227.28560616238977, -1192.5965235181716, -929.7180010884623, -1279.044549763031, -1126.8822446041854, -940.7003543601068, -1162.3798727186545, -1039.5519882456285, -492.2024932316115, -1388.7613632524449, -244.61042936667383, -188.16447684556763, -595.1796932744968, -54.81040237012504, -1133.3046043957297, -887.0968659672055, -189.82251525388568, -28.390772669374513, -118.92129100408312, -355.5215665375544, -137.24772580315408, -1059.2710050881246, -1235.6703060573338, -776.4290514498724, -292.91508977675215, -768.2656831534133, -225.47782120099063, -97.2545619910634, -271.13655260994545, -1275.2223024363539, -1455.6334487457323, -259.6759316448202, -491.48864921954333, -441.65060601539085, -132.38328478918532, -1335.4469436680938, -1045.3882432808307, -735.2526616254164], "episode_lengths": [110, 124, 107, 150, 44, 150, 150, 150, 150, 150, 80, 62, 150, 111, 126, 46, 150, 150, 150, 150, 132, 150, 61, 150, 87, 121, 150, 150, 150, 150, 150, 150, 150, 100, 121, 150, 150, 150, 150, 150, 150, 150, 42, 150, 74, 150, 149, 150, 150, 150, 150, 150, 150, 59, 103, 150, 79, 126, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 41, 150, 150, 79, 40, 63, 134, 77, 150, 150, 150, 112, 150, 105, 67, 96, 150, 150, 72, 150, 150, 62, 150, 150, 150], "policy_policy_0_reward": [-466.15821646318267, -613.27891780145, -488.3411137620367, -1102.6706394466662, -53.749109685325664, -802.7009278970048, -730.3986714214266, -1088.7371723139104, -1163.751631115095, -481.6120027678227, -122.56819792798562, -157.3725959590182, -1143.268650368297, -564.3757390759793, -447.6081159820406, -30.430418481717435, -1098.0820546058715, -1267.9853837628336, -452.489332365529, -1131.0186138214096, -743.6276363686776, -1081.062244847546, -96.66031743397382, -628.0139016645574, -316.19544847666305, -560.0699848589338, -1098.0715825797008, -658.9592611081898, -892.01940735916, -1050.3137588987543, -836.3067632316636, -1349.383938286381, -967.9470503273911, -194.7200193656884, -422.92269678736625, -590.8167600845824, -1422.0120647516878, -472.09595504179003, -867.4057679228914, -1212.9621230543821, -492.8214906561114, -876.506789401058, -48.7869080289958, -1007.541923076704, -220.2129390796005, -1371.1309455832447, -588.2749981611241, -989.7286609580634, -1032.5673318618237, -810.1924600878112, -1300.8903865881193, -934.8745468891776, -901.4838380768198, -176.19190134805297, -456.6766566242809, -772.1462198468957, -100.71543883442098, -437.89452701649014, -1029.2843426208674, -847.3578287668738, -814.302942507213, -614.555783649189, -227.28560616238977, -1192.5965235181716, -929.7180010884623, -1279.044549763031, -1126.8822446041854, -940.7003543601068, -1162.3798727186545, -1039.5519882456285, -492.2024932316115, -1388.7613632524449, -244.61042936667383, -188.16447684556763, -595.1796932744968, -54.81040237012504, -1133.3046043957297, -887.0968659672055, -189.82251525388568, -28.390772669374513, -118.92129100408312, -355.5215665375544, -137.24772580315408, -1059.2710050881246, -1235.6703060573338, -776.4290514498724, -292.91508977675215, -768.2656831534133, -225.47782120099063, -97.2545619910634, -271.13655260994545, -1275.2223024363539, -1455.6334487457323, -259.6759316448202, -491.48864921954333, -441.65060601539085, -132.38328478918532, -1335.4469436680938, -1045.3882432808307, -735.2526616254164]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5590521098388016, "mean_inference_ms": 1.6856022328340199, "mean_action_processing_ms": 0.28020567010581626, "mean_env_wait_ms": 3.4470897092307355, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01183176040649414, "StateBufferConnector_ms": 0.007842302322387695, "ViewRequirementAgentConnector_ms": 0.19466829299926758}, "num_episodes": 30, "episode_return_max": -28.390772669374513, "episode_return_min": -1455.6334487457323, "episode_return_mean": -703.0305853032293, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 325.55921065142593, "num_env_steps_trained_throughput_per_sec": 325.55921065142593, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12592.337, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12592.257, "sample_time_ms": 1143.268, "learn_time_ms": 11381.554, "learn_throughput": 351.446, "synch_weights_time_ms": 66.609}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00006", "date": "2024-08-04_06-03-21", "timestamp": 1722731601, "time_this_iter_s": 12.298903226852417, "time_total_s": 139.0779745578766, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01435b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 139.0779745578766, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.477777777777778, "ram_util_percent": 27.91111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 153.9831704099973, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.8645831160247326, "policy_loss": -0.017580825399879055, "vf_loss": 3.8768265378971893, "vf_explained_var": 0.9662896783401569, "kl": 0.01833406233428909, "entropy": 1.6281840031345685, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -20.457437728782775, "episode_reward_min": -1455.6334487457323, "episode_reward_mean": -680.5462060550522, "episode_len_mean": 124.56, "episode_media": {}, "episodes_timesteps_total": 12456, "policy_reward_min": {"policy_0": -1455.6334487457323}, "policy_reward_max": {"policy_0": -20.457437728782775}, "policy_reward_mean": {"policy_0": -680.5462060550522}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-422.92269678736625, -590.8167600845824, -1422.0120647516878, -472.09595504179003, -867.4057679228914, -1212.9621230543821, -492.8214906561114, -876.506789401058, -48.7869080289958, -1007.541923076704, -220.2129390796005, -1371.1309455832447, -588.2749981611241, -989.7286609580634, -1032.5673318618237, -810.1924600878112, -1300.8903865881193, -934.8745468891776, -901.4838380768198, -176.19190134805297, -456.6766566242809, -772.1462198468957, -100.71543883442098, -437.89452701649014, -1029.2843426208674, -847.3578287668738, -814.302942507213, -614.555783649189, -227.28560616238977, -1192.5965235181716, -929.7180010884623, -1279.044549763031, -1126.8822446041854, -940.7003543601068, -1162.3798727186545, -1039.5519882456285, -492.2024932316115, -1388.7613632524449, -244.61042936667383, -188.16447684556763, -595.1796932744968, -54.81040237012504, -1133.3046043957297, -887.0968659672055, -189.82251525388568, -28.390772669374513, -118.92129100408312, -355.5215665375544, -137.24772580315408, -1059.2710050881246, -1235.6703060573338, -776.4290514498724, -292.91508977675215, -768.2656831534133, -225.47782120099063, -97.2545619910634, -271.13655260994545, -1275.2223024363539, -1455.6334487457323, -259.6759316448202, -491.48864921954333, -441.65060601539085, -132.38328478918532, -1335.4469436680938, -1045.3882432808307, -735.2526616254164, -192.52597129386322, -1252.1166580119684, -155.00944189765832, -366.5155164070705, -804.314935040137, -504.144510586151, -760.2980984518633, -378.47593264495595, -1160.0634774644718, -900.3338577952427, -182.824050322279, -1112.2184844323617, -859.3297924565769, -455.1309349699739, -154.48321132870774, -343.22400597804966, -1219.544720894243, -133.09014798005984, -802.5504370385078, -529.3172373907346, -1287.9874399582566, -1436.5463239082555, -1163.4054047840402, -157.77199436040317, -326.2811316286587, -933.4966213420914, -594.1231900653207, -69.8828195387988, -221.13560667508509, -610.45316276182, -20.457437728782775, -1167.0055171819333, -1165.0629171012151, -212.3899055946365], "episode_lengths": [121, 150, 150, 150, 150, 150, 150, 150, 42, 150, 74, 150, 149, 150, 150, 150, 150, 150, 150, 59, 103, 150, 79, 126, 150, 150, 150, 150, 85, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 41, 150, 150, 79, 40, 63, 134, 77, 150, 150, 150, 112, 150, 105, 67, 96, 150, 150, 72, 150, 150, 62, 150, 150, 150, 67, 150, 82, 102, 150, 144, 150, 150, 150, 150, 63, 150, 150, 150, 53, 99, 150, 59, 150, 150, 150, 150, 150, 66, 77, 150, 125, 54, 91, 123, 41, 150, 150, 64], "policy_policy_0_reward": [-422.92269678736625, -590.8167600845824, -1422.0120647516878, -472.09595504179003, -867.4057679228914, -1212.9621230543821, -492.8214906561114, -876.506789401058, -48.7869080289958, -1007.541923076704, -220.2129390796005, -1371.1309455832447, -588.2749981611241, -989.7286609580634, -1032.5673318618237, -810.1924600878112, -1300.8903865881193, -934.8745468891776, -901.4838380768198, -176.19190134805297, -456.6766566242809, -772.1462198468957, -100.71543883442098, -437.89452701649014, -1029.2843426208674, -847.3578287668738, -814.302942507213, -614.555783649189, -227.28560616238977, -1192.5965235181716, -929.7180010884623, -1279.044549763031, -1126.8822446041854, -940.7003543601068, -1162.3798727186545, -1039.5519882456285, -492.2024932316115, -1388.7613632524449, -244.61042936667383, -188.16447684556763, -595.1796932744968, -54.81040237012504, -1133.3046043957297, -887.0968659672055, -189.82251525388568, -28.390772669374513, -118.92129100408312, -355.5215665375544, -137.24772580315408, -1059.2710050881246, -1235.6703060573338, -776.4290514498724, -292.91508977675215, -768.2656831534133, -225.47782120099063, -97.2545619910634, -271.13655260994545, -1275.2223024363539, -1455.6334487457323, -259.6759316448202, -491.48864921954333, -441.65060601539085, -132.38328478918532, -1335.4469436680938, -1045.3882432808307, -735.2526616254164, -192.52597129386322, -1252.1166580119684, -155.00944189765832, -366.5155164070705, -804.314935040137, -504.144510586151, -760.2980984518633, -378.47593264495595, -1160.0634774644718, -900.3338577952427, -182.824050322279, -1112.2184844323617, -859.3297924565769, -455.1309349699739, -154.48321132870774, -343.22400597804966, -1219.544720894243, -133.09014798005984, -802.5504370385078, -529.3172373907346, -1287.9874399582566, -1436.5463239082555, -1163.4054047840402, -157.77199436040317, -326.2811316286587, -933.4966213420914, -594.1231900653207, -69.8828195387988, -221.13560667508509, -610.45316276182, -20.457437728782775, -1167.0055171819333, -1165.0629171012151, -212.3899055946365]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5581649501859743, "mean_inference_ms": 1.6823714453734038, "mean_action_processing_ms": 0.2793278062713524, "mean_env_wait_ms": 3.448981857493971, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011788129806518555, "StateBufferConnector_ms": 0.007802724838256836, "ViewRequirementAgentConnector_ms": 0.19477391242980957}, "num_episodes": 34, "episode_return_max": -20.457437728782775, "episode_return_min": -1455.6334487457323, "episode_return_mean": -680.5462060550522, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.01880690479874, "num_env_steps_trained_throughput_per_sec": 302.01880690479874, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12560.152, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12560.072, "sample_time_ms": 1149.172, "learn_time_ms": 11343.244, "learn_throughput": 352.633, "synch_weights_time_ms": 66.83}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00006", "date": "2024-08-04_06-03-34", "timestamp": 1722731614, "time_this_iter_s": 13.255443334579468, "time_total_s": 152.33341789245605, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0142c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 152.33341789245605, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.084210526315786, "ram_util_percent": 27.99473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 198.11551049749056, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.1530978862196206, "policy_loss": -0.004693200196682786, "vf_loss": 3.15412327212592, "vf_explained_var": 0.9748724788427353, "kl": 0.012797818347856567, "entropy": 1.7153644358118376, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -20.457437728782775, "episode_reward_min": -1455.6334487457323, "episode_reward_mean": -671.4649214793259, "episode_len_mean": 122.16, "episode_media": {}, "episodes_timesteps_total": 12216, "policy_reward_min": {"policy_0": -1455.6334487457323}, "policy_reward_max": {"policy_0": -20.457437728782775}, "policy_reward_mean": {"policy_0": -671.4649214793259}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1039.5519882456285, -492.2024932316115, -1388.7613632524449, -244.61042936667383, -188.16447684556763, -595.1796932744968, -54.81040237012504, -1133.3046043957297, -887.0968659672055, -189.82251525388568, -28.390772669374513, -118.92129100408312, -355.5215665375544, -137.24772580315408, -1059.2710050881246, -1235.6703060573338, -776.4290514498724, -292.91508977675215, -768.2656831534133, -225.47782120099063, -97.2545619910634, -271.13655260994545, -1275.2223024363539, -1455.6334487457323, -259.6759316448202, -491.48864921954333, -441.65060601539085, -132.38328478918532, -1335.4469436680938, -1045.3882432808307, -735.2526616254164, -192.52597129386322, -1252.1166580119684, -155.00944189765832, -366.5155164070705, -804.314935040137, -504.144510586151, -760.2980984518633, -378.47593264495595, -1160.0634774644718, -900.3338577952427, -182.824050322279, -1112.2184844323617, -859.3297924565769, -455.1309349699739, -154.48321132870774, -343.22400597804966, -1219.544720894243, -133.09014798005984, -802.5504370385078, -529.3172373907346, -1287.9874399582566, -1436.5463239082555, -1163.4054047840402, -157.77199436040317, -326.2811316286587, -933.4966213420914, -594.1231900653207, -69.8828195387988, -221.13560667508509, -610.45316276182, -20.457437728782775, -1167.0055171819333, -1165.0629171012151, -212.3899055946365, -1199.922648212678, -763.0947764903393, -1128.997397074644, -247.03258310672155, -1040.8564690687876, -328.0984650474013, -598.8226780860861, -39.71481684209686, -559.2503055264763, -659.2154582383207, -1373.5921951876542, -1326.9044214713915, -956.7642411734414, -302.53868203209066, -329.3597453938332, -908.3642953760952, -1349.0264712078808, -455.5100124481118, -1310.2715166722355, -1069.1706300959327, -1035.790552151332, -963.8882589772271, -117.86919025362366, -913.5878423901257, -1179.4619707872098, -1425.2232906182496, -158.78650090269693, -795.7176538606394, -126.63930082428169, -116.3963116663399, -572.2130772113687, -44.91255205563275, -1256.8291856301255, -845.6357186562146, -1263.3737072107335], "episode_lengths": [150, 150, 150, 150, 60, 150, 41, 150, 150, 79, 40, 63, 134, 77, 150, 150, 150, 112, 150, 105, 67, 96, 150, 150, 72, 150, 150, 62, 150, 150, 150, 67, 150, 82, 102, 150, 144, 150, 150, 150, 150, 63, 150, 150, 150, 53, 99, 150, 59, 150, 150, 150, 150, 150, 66, 77, 150, 125, 54, 91, 123, 41, 150, 150, 64, 150, 150, 150, 94, 150, 103, 144, 35, 150, 150, 150, 150, 150, 102, 150, 150, 150, 111, 150, 150, 150, 150, 80, 150, 150, 150, 75, 150, 62, 54, 150, 38, 150, 150, 150], "policy_policy_0_reward": [-1039.5519882456285, -492.2024932316115, -1388.7613632524449, -244.61042936667383, -188.16447684556763, -595.1796932744968, -54.81040237012504, -1133.3046043957297, -887.0968659672055, -189.82251525388568, -28.390772669374513, -118.92129100408312, -355.5215665375544, -137.24772580315408, -1059.2710050881246, -1235.6703060573338, -776.4290514498724, -292.91508977675215, -768.2656831534133, -225.47782120099063, -97.2545619910634, -271.13655260994545, -1275.2223024363539, -1455.6334487457323, -259.6759316448202, -491.48864921954333, -441.65060601539085, -132.38328478918532, -1335.4469436680938, -1045.3882432808307, -735.2526616254164, -192.52597129386322, -1252.1166580119684, -155.00944189765832, -366.5155164070705, -804.314935040137, -504.144510586151, -760.2980984518633, -378.47593264495595, -1160.0634774644718, -900.3338577952427, -182.824050322279, -1112.2184844323617, -859.3297924565769, -455.1309349699739, -154.48321132870774, -343.22400597804966, -1219.544720894243, -133.09014798005984, -802.5504370385078, -529.3172373907346, -1287.9874399582566, -1436.5463239082555, -1163.4054047840402, -157.77199436040317, -326.2811316286587, -933.4966213420914, -594.1231900653207, -69.8828195387988, -221.13560667508509, -610.45316276182, -20.457437728782775, -1167.0055171819333, -1165.0629171012151, -212.3899055946365, -1199.922648212678, -763.0947764903393, -1128.997397074644, -247.03258310672155, -1040.8564690687876, -328.0984650474013, -598.8226780860861, -39.71481684209686, -559.2503055264763, -659.2154582383207, -1373.5921951876542, -1326.9044214713915, -956.7642411734414, -302.53868203209066, -329.3597453938332, -908.3642953760952, -1349.0264712078808, -455.5100124481118, -1310.2715166722355, -1069.1706300959327, -1035.790552151332, -963.8882589772271, -117.86919025362366, -913.5878423901257, -1179.4619707872098, -1425.2232906182496, -158.78650090269693, -795.7176538606394, -126.63930082428169, -116.3963116663399, -572.2130772113687, -44.91255205563275, -1256.8291856301255, -845.6357186562146, -1263.3737072107335]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.557628503620855, "mean_inference_ms": 1.6822756300608237, "mean_action_processing_ms": 0.2789730902829631, "mean_env_wait_ms": 3.4574215869461615, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012125015258789062, "StateBufferConnector_ms": 0.007886409759521484, "ViewRequirementAgentConnector_ms": 0.19316506385803223}, "num_episodes": 35, "episode_return_max": -20.457437728782775, "episode_return_min": -1455.6334487457323, "episode_return_mean": -671.4649214793259, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.5570890217856, "num_env_steps_trained_throughput_per_sec": 299.5570890217856, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12609.608, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12609.528, "sample_time_ms": 1153.926, "learn_time_ms": 11388.277, "learn_throughput": 351.238, "synch_weights_time_ms": 66.502}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00006", "date": "2024-08-04_06-03-47", "timestamp": 1722731627, "time_this_iter_s": 13.364399671554565, "time_total_s": 165.69781756401062, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0143e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 165.69781756401062, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.03684210526316, "ram_util_percent": 27.989473684210523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 229.0740547855695, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.6230883409579593, "policy_loss": -0.010555878201072726, "vf_loss": 2.630074983338515, "vf_explained_var": 0.9776020499567191, "kl": 0.012454879842266583, "entropy": 1.6722702410072088, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -20.457437728782775, "episode_reward_min": -1436.5463239082555, "episode_reward_mean": -745.6303432574813, "episode_len_mean": 127.67, "episode_media": {}, "episodes_timesteps_total": 12767, "policy_reward_min": {"policy_0": -1436.5463239082555}, "policy_reward_max": {"policy_0": -20.457437728782775}, "policy_reward_mean": {"policy_0": -745.6303432574813}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1045.3882432808307, -735.2526616254164, -192.52597129386322, -1252.1166580119684, -155.00944189765832, -366.5155164070705, -804.314935040137, -504.144510586151, -760.2980984518633, -378.47593264495595, -1160.0634774644718, -900.3338577952427, -182.824050322279, -1112.2184844323617, -859.3297924565769, -455.1309349699739, -154.48321132870774, -343.22400597804966, -1219.544720894243, -133.09014798005984, -802.5504370385078, -529.3172373907346, -1287.9874399582566, -1436.5463239082555, -1163.4054047840402, -157.77199436040317, -326.2811316286587, -933.4966213420914, -594.1231900653207, -69.8828195387988, -221.13560667508509, -610.45316276182, -20.457437728782775, -1167.0055171819333, -1165.0629171012151, -212.3899055946365, -1199.922648212678, -763.0947764903393, -1128.997397074644, -247.03258310672155, -1040.8564690687876, -328.0984650474013, -598.8226780860861, -39.71481684209686, -559.2503055264763, -659.2154582383207, -1373.5921951876542, -1326.9044214713915, -956.7642411734414, -302.53868203209066, -329.3597453938332, -908.3642953760952, -1349.0264712078808, -455.5100124481118, -1310.2715166722355, -1069.1706300959327, -1035.790552151332, -963.8882589772271, -117.86919025362366, -913.5878423901257, -1179.4619707872098, -1425.2232906182496, -158.78650090269693, -795.7176538606394, -126.63930082428169, -116.3963116663399, -572.2130772113687, -44.91255205563275, -1256.8291856301255, -845.6357186562146, -1263.3737072107335, -869.4830541211904, -1027.4082624700293, -1174.571572082239, -631.8544012305578, -221.2824936210652, -1267.5854122146827, -1173.0473759043093, -1053.4271622211272, -622.6773384544117, -676.2914939091692, -1083.9827957517239, -525.1390710933667, -601.9093991908251, -1092.1195519103205, -1024.4682744406143, -49.24813433768306, -1165.077816497926, -971.8966014605578, -921.0532799512126, -1055.364634496054, -1028.3604485894955, -1130.5922673445925, -1228.9711939187687, -39.16446103075955, -908.792466825101, -919.464595798824, -142.5026815508124, -936.5587619104692, -845.7546015518038], "episode_lengths": [150, 150, 67, 150, 82, 102, 150, 144, 150, 150, 150, 150, 63, 150, 150, 150, 53, 99, 150, 59, 150, 150, 150, 150, 150, 66, 77, 150, 125, 54, 91, 123, 41, 150, 150, 64, 150, 150, 150, 94, 150, 103, 144, 35, 150, 150, 150, 150, 150, 102, 150, 150, 150, 111, 150, 150, 150, 150, 80, 150, 150, 150, 75, 150, 62, 54, 150, 38, 150, 150, 150, 150, 150, 150, 133, 107, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 65, 150, 150], "policy_policy_0_reward": [-1045.3882432808307, -735.2526616254164, -192.52597129386322, -1252.1166580119684, -155.00944189765832, -366.5155164070705, -804.314935040137, -504.144510586151, -760.2980984518633, -378.47593264495595, -1160.0634774644718, -900.3338577952427, -182.824050322279, -1112.2184844323617, -859.3297924565769, -455.1309349699739, -154.48321132870774, -343.22400597804966, -1219.544720894243, -133.09014798005984, -802.5504370385078, -529.3172373907346, -1287.9874399582566, -1436.5463239082555, -1163.4054047840402, -157.77199436040317, -326.2811316286587, -933.4966213420914, -594.1231900653207, -69.8828195387988, -221.13560667508509, -610.45316276182, -20.457437728782775, -1167.0055171819333, -1165.0629171012151, -212.3899055946365, -1199.922648212678, -763.0947764903393, -1128.997397074644, -247.03258310672155, -1040.8564690687876, -328.0984650474013, -598.8226780860861, -39.71481684209686, -559.2503055264763, -659.2154582383207, -1373.5921951876542, -1326.9044214713915, -956.7642411734414, -302.53868203209066, -329.3597453938332, -908.3642953760952, -1349.0264712078808, -455.5100124481118, -1310.2715166722355, -1069.1706300959327, -1035.790552151332, -963.8882589772271, -117.86919025362366, -913.5878423901257, -1179.4619707872098, -1425.2232906182496, -158.78650090269693, -795.7176538606394, -126.63930082428169, -116.3963116663399, -572.2130772113687, -44.91255205563275, -1256.8291856301255, -845.6357186562146, -1263.3737072107335, -869.4830541211904, -1027.4082624700293, -1174.571572082239, -631.8544012305578, -221.2824936210652, -1267.5854122146827, -1173.0473759043093, -1053.4271622211272, -622.6773384544117, -676.2914939091692, -1083.9827957517239, -525.1390710933667, -601.9093991908251, -1092.1195519103205, -1024.4682744406143, -49.24813433768306, -1165.077816497926, -971.8966014605578, -921.0532799512126, -1055.364634496054, -1028.3604485894955, -1130.5922673445925, -1228.9711939187687, -39.16446103075955, -908.792466825101, -919.464595798824, -142.5026815508124, -936.5587619104692, -845.7546015518038]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5573620034717397, "mean_inference_ms": 1.6808827648807931, "mean_action_processing_ms": 0.27850436830231895, "mean_env_wait_ms": 3.4615723474523867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012004613876342773, "StateBufferConnector_ms": 0.007893562316894531, "ViewRequirementAgentConnector_ms": 0.19383454322814941}, "num_episodes": 29, "episode_return_max": -20.457437728782775, "episode_return_min": -1436.5463239082555, "episode_return_mean": -745.6303432574813, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.3380226217633, "num_env_steps_trained_throughput_per_sec": 304.3380226217633, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12848.95, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12848.871, "sample_time_ms": 1151.988, "learn_time_ms": 11630.191, "learn_throughput": 343.932, "synch_weights_time_ms": 65.87}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00006", "date": "2024-08-04_06-04-00", "timestamp": 1722731640, "time_this_iter_s": 13.156955242156982, "time_total_s": 178.8547728061676, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01431c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 178.8547728061676, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.36111111111111, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 212.52465723951659, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.531971310948332, "policy_loss": -0.010770380854470811, "vf_loss": 2.5383306104689836, "vf_explained_var": 0.986180155351758, "kl": 0.01524434673622941, "entropy": 1.6222405036290486, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -14.627323815355382, "episode_reward_min": -1425.2232906182496, "episode_reward_mean": -762.3864965359701, "episode_len_mean": 129.26, "episode_media": {}, "episodes_timesteps_total": 12926, "policy_reward_min": {"policy_0": -1425.2232906182496}, "policy_reward_max": {"policy_0": -14.627323815355382}, "policy_reward_mean": {"policy_0": -762.3864965359701}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-933.4966213420914, -594.1231900653207, -69.8828195387988, -221.13560667508509, -610.45316276182, -20.457437728782775, -1167.0055171819333, -1165.0629171012151, -212.3899055946365, -1199.922648212678, -763.0947764903393, -1128.997397074644, -247.03258310672155, -1040.8564690687876, -328.0984650474013, -598.8226780860861, -39.71481684209686, -559.2503055264763, -659.2154582383207, -1373.5921951876542, -1326.9044214713915, -956.7642411734414, -302.53868203209066, -329.3597453938332, -908.3642953760952, -1349.0264712078808, -455.5100124481118, -1310.2715166722355, -1069.1706300959327, -1035.790552151332, -963.8882589772271, -117.86919025362366, -913.5878423901257, -1179.4619707872098, -1425.2232906182496, -158.78650090269693, -795.7176538606394, -126.63930082428169, -116.3963116663399, -572.2130772113687, -44.91255205563275, -1256.8291856301255, -845.6357186562146, -1263.3737072107335, -869.4830541211904, -1027.4082624700293, -1174.571572082239, -631.8544012305578, -221.2824936210652, -1267.5854122146827, -1173.0473759043093, -1053.4271622211272, -622.6773384544117, -676.2914939091692, -1083.9827957517239, -525.1390710933667, -601.9093991908251, -1092.1195519103205, -1024.4682744406143, -49.24813433768306, -1165.077816497926, -971.8966014605578, -921.0532799512126, -1055.364634496054, -1028.3604485894955, -1130.5922673445925, -1228.9711939187687, -39.16446103075955, -908.792466825101, -919.464595798824, -142.5026815508124, -936.5587619104692, -845.7546015518038, -455.9828103959677, -940.6988699418837, -883.0824232542449, -554.6951136741791, -860.0799559857091, -1012.6899754593007, -378.91762218177644, -495.553911234149, -929.0756654687713, -14.627323815355382, -70.49133039609993, -1154.7977080164362, -431.92553039202164, -1187.6627176319166, -1084.8218017358745, -177.72998727560318, -1394.2194105770034, -1174.3576180787463, -50.52004033211611, -699.0170242944372, -1011.8208592545334, -871.2910384927989, -347.7065643105377, -659.4619285389456, -1325.8545905322537, -942.2813715641211, -984.3967569448339], "episode_lengths": [150, 125, 54, 91, 123, 41, 150, 150, 64, 150, 150, 150, 94, 150, 103, 144, 35, 150, 150, 150, 150, 150, 102, 150, 150, 150, 111, 150, 150, 150, 150, 80, 150, 150, 150, 75, 150, 62, 54, 150, 38, 150, 150, 150, 150, 150, 150, 133, 107, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 112, 122, 150, 40, 53, 150, 150, 150, 150, 70, 150, 150, 43, 150, 150, 150, 96, 135, 150, 150, 150], "policy_policy_0_reward": [-933.4966213420914, -594.1231900653207, -69.8828195387988, -221.13560667508509, -610.45316276182, -20.457437728782775, -1167.0055171819333, -1165.0629171012151, -212.3899055946365, -1199.922648212678, -763.0947764903393, -1128.997397074644, -247.03258310672155, -1040.8564690687876, -328.0984650474013, -598.8226780860861, -39.71481684209686, -559.2503055264763, -659.2154582383207, -1373.5921951876542, -1326.9044214713915, -956.7642411734414, -302.53868203209066, -329.3597453938332, -908.3642953760952, -1349.0264712078808, -455.5100124481118, -1310.2715166722355, -1069.1706300959327, -1035.790552151332, -963.8882589772271, -117.86919025362366, -913.5878423901257, -1179.4619707872098, -1425.2232906182496, -158.78650090269693, -795.7176538606394, -126.63930082428169, -116.3963116663399, -572.2130772113687, -44.91255205563275, -1256.8291856301255, -845.6357186562146, -1263.3737072107335, -869.4830541211904, -1027.4082624700293, -1174.571572082239, -631.8544012305578, -221.2824936210652, -1267.5854122146827, -1173.0473759043093, -1053.4271622211272, -622.6773384544117, -676.2914939091692, -1083.9827957517239, -525.1390710933667, -601.9093991908251, -1092.1195519103205, -1024.4682744406143, -49.24813433768306, -1165.077816497926, -971.8966014605578, -921.0532799512126, -1055.364634496054, -1028.3604485894955, -1130.5922673445925, -1228.9711939187687, -39.16446103075955, -908.792466825101, -919.464595798824, -142.5026815508124, -936.5587619104692, -845.7546015518038, -455.9828103959677, -940.6988699418837, -883.0824232542449, -554.6951136741791, -860.0799559857091, -1012.6899754593007, -378.91762218177644, -495.553911234149, -929.0756654687713, -14.627323815355382, -70.49133039609993, -1154.7977080164362, -431.92553039202164, -1187.6627176319166, -1084.8218017358745, -177.72998727560318, -1394.2194105770034, -1174.3576180787463, -50.52004033211611, -699.0170242944372, -1011.8208592545334, -871.2910384927989, -347.7065643105377, -659.4619285389456, -1325.8545905322537, -942.2813715641211, -984.3967569448339]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5566965120139651, "mean_inference_ms": 1.6809123620342117, "mean_action_processing_ms": 0.2782607746523786, "mean_env_wait_ms": 3.4639994828978145, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012167930603027344, "StateBufferConnector_ms": 0.008016347885131836, "ViewRequirementAgentConnector_ms": 0.1971876621246338}, "num_episodes": 27, "episode_return_max": -14.627323815355382, "episode_return_min": -1425.2232906182496, "episode_return_mean": -762.3864965359701, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.624950955626, "num_env_steps_trained_throughput_per_sec": 306.624950955626, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12903.434, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12903.361, "sample_time_ms": 1157.251, "learn_time_ms": 11679.741, "learn_throughput": 342.473, "synch_weights_time_ms": 65.558}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00006", "date": "2024-08-04_06-04-14", "timestamp": 1722731654, "time_this_iter_s": 13.057945966720581, "time_total_s": 191.91271877288818, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0141ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 191.91271877288818, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.031578947368423, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 266.81680760184923, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.7786924379567304, "policy_loss": -0.012555261142551899, "vf_loss": 2.786217098062237, "vf_explained_var": 0.9718219829723239, "kl": 0.017328078132292545, "entropy": 1.678212147951126, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -14.627323815355382, "episode_reward_min": -1425.2232906182496, "episode_reward_mean": -759.3128078739047, "episode_len_mean": 131.62, "episode_media": {}, "episodes_timesteps_total": 13162, "policy_reward_min": {"policy_0": -1425.2232906182496}, "policy_reward_max": {"policy_0": -14.627323815355382}, "policy_reward_mean": {"policy_0": -759.3128078739047}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-963.8882589772271, -117.86919025362366, -913.5878423901257, -1179.4619707872098, -1425.2232906182496, -158.78650090269693, -795.7176538606394, -126.63930082428169, -116.3963116663399, -572.2130772113687, -44.91255205563275, -1256.8291856301255, -845.6357186562146, -1263.3737072107335, -869.4830541211904, -1027.4082624700293, -1174.571572082239, -631.8544012305578, -221.2824936210652, -1267.5854122146827, -1173.0473759043093, -1053.4271622211272, -622.6773384544117, -676.2914939091692, -1083.9827957517239, -525.1390710933667, -601.9093991908251, -1092.1195519103205, -1024.4682744406143, -49.24813433768306, -1165.077816497926, -971.8966014605578, -921.0532799512126, -1055.364634496054, -1028.3604485894955, -1130.5922673445925, -1228.9711939187687, -39.16446103075955, -908.792466825101, -919.464595798824, -142.5026815508124, -936.5587619104692, -845.7546015518038, -455.9828103959677, -940.6988699418837, -883.0824232542449, -554.6951136741791, -860.0799559857091, -1012.6899754593007, -378.91762218177644, -495.553911234149, -929.0756654687713, -14.627323815355382, -70.49133039609993, -1154.7977080164362, -431.92553039202164, -1187.6627176319166, -1084.8218017358745, -177.72998727560318, -1394.2194105770034, -1174.3576180787463, -50.52004033211611, -699.0170242944372, -1011.8208592545334, -871.2910384927989, -347.7065643105377, -659.4619285389456, -1325.8545905322537, -942.2813715641211, -984.3967569448339, -1048.8739504841649, -1271.6602727878499, -884.2168165610024, -120.3498448102144, -571.8383173841479, -758.6791037703539, -481.30518858138083, -88.83458320031049, -328.99638004032414, -1164.2482238764078, -1037.6852540070556, -1108.177141961618, -481.09355777003464, -1330.7257280221006, -444.63333051464537, -1034.1559632826534, -911.8054981464848, -49.81144684019108, -162.36696566139315, -874.5206799010188, -899.7297707121886, -760.6321804895842, -105.3290304431851, -1058.0399636169461, -792.834932717813, -853.3788809979729, -1022.6043949474519, -416.9816091553722, -1269.1826040192439, -336.24505798358564], "episode_lengths": [150, 80, 150, 150, 150, 75, 150, 62, 54, 150, 38, 150, 150, 150, 150, 150, 150, 133, 107, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 42, 150, 150, 150, 150, 150, 150, 150, 44, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 112, 122, 150, 40, 53, 150, 150, 150, 150, 70, 150, 150, 43, 150, 150, 150, 96, 135, 150, 150, 150, 150, 150, 150, 89, 150, 134, 146, 69, 150, 150, 150, 150, 133, 150, 103, 150, 150, 52, 99, 150, 150, 150, 81, 150, 139, 150, 150, 150, 150, 128], "policy_policy_0_reward": [-963.8882589772271, -117.86919025362366, -913.5878423901257, -1179.4619707872098, -1425.2232906182496, -158.78650090269693, -795.7176538606394, -126.63930082428169, -116.3963116663399, -572.2130772113687, -44.91255205563275, -1256.8291856301255, -845.6357186562146, -1263.3737072107335, -869.4830541211904, -1027.4082624700293, -1174.571572082239, -631.8544012305578, -221.2824936210652, -1267.5854122146827, -1173.0473759043093, -1053.4271622211272, -622.6773384544117, -676.2914939091692, -1083.9827957517239, -525.1390710933667, -601.9093991908251, -1092.1195519103205, -1024.4682744406143, -49.24813433768306, -1165.077816497926, -971.8966014605578, -921.0532799512126, -1055.364634496054, -1028.3604485894955, -1130.5922673445925, -1228.9711939187687, -39.16446103075955, -908.792466825101, -919.464595798824, -142.5026815508124, -936.5587619104692, -845.7546015518038, -455.9828103959677, -940.6988699418837, -883.0824232542449, -554.6951136741791, -860.0799559857091, -1012.6899754593007, -378.91762218177644, -495.553911234149, -929.0756654687713, -14.627323815355382, -70.49133039609993, -1154.7977080164362, -431.92553039202164, -1187.6627176319166, -1084.8218017358745, -177.72998727560318, -1394.2194105770034, -1174.3576180787463, -50.52004033211611, -699.0170242944372, -1011.8208592545334, -871.2910384927989, -347.7065643105377, -659.4619285389456, -1325.8545905322537, -942.2813715641211, -984.3967569448339, -1048.8739504841649, -1271.6602727878499, -884.2168165610024, -120.3498448102144, -571.8383173841479, -758.6791037703539, -481.30518858138083, -88.83458320031049, -328.99638004032414, -1164.2482238764078, -1037.6852540070556, -1108.177141961618, -481.09355777003464, -1330.7257280221006, -444.63333051464537, -1034.1559632826534, -911.8054981464848, -49.81144684019108, -162.36696566139315, -874.5206799010188, -899.7297707121886, -760.6321804895842, -105.3290304431851, -1058.0399636169461, -792.834932717813, -853.3788809979729, -1022.6043949474519, -416.9816091553722, -1269.1826040192439, -336.24505798358564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556080852581446, "mean_inference_ms": 1.6821525755633564, "mean_action_processing_ms": 0.2779505435605085, "mean_env_wait_ms": 3.4711486651701473, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01207590103149414, "StateBufferConnector_ms": 0.008095264434814453, "ViewRequirementAgentConnector_ms": 0.197509765625}, "num_episodes": 30, "episode_return_max": -14.627323815355382, "episode_return_min": -1425.2232906182496, "episode_return_mean": -759.3128078739047, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.1418920630791, "num_env_steps_trained_throughput_per_sec": 305.1418920630791, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12856.811, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12856.737, "sample_time_ms": 1171.96, "learn_time_ms": 11617.541, "learn_throughput": 344.307, "synch_weights_time_ms": 66.428}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00006", "date": "2024-08-04_06-04-27", "timestamp": 1722731667, "time_this_iter_s": 13.120524406433105, "time_total_s": 205.0332431793213, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0141480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 205.0332431793213, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.34736842105263, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 184.03353093663853, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.797894770403703, "policy_loss": -0.008722030791007758, "vf_loss": 2.802649005750815, "vf_explained_var": 0.9722349354997277, "kl": 0.013769308626433501, "entropy": 1.6299882574627798, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -14.627323815355382, "episode_reward_min": -1394.2194105770034, "episode_reward_mean": -726.589396080668, "episode_len_mean": 131.89, "episode_media": {}, "episodes_timesteps_total": 13189, "policy_reward_min": {"policy_0": -1394.2194105770034}, "policy_reward_max": {"policy_0": -14.627323815355382}, "policy_reward_mean": {"policy_0": -726.589396080668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1028.3604485894955, -1130.5922673445925, -1228.9711939187687, -39.16446103075955, -908.792466825101, -919.464595798824, -142.5026815508124, -936.5587619104692, -845.7546015518038, -455.9828103959677, -940.6988699418837, -883.0824232542449, -554.6951136741791, -860.0799559857091, -1012.6899754593007, -378.91762218177644, -495.553911234149, -929.0756654687713, -14.627323815355382, -70.49133039609993, -1154.7977080164362, -431.92553039202164, -1187.6627176319166, -1084.8218017358745, -177.72998727560318, -1394.2194105770034, -1174.3576180787463, -50.52004033211611, -699.0170242944372, -1011.8208592545334, -871.2910384927989, -347.7065643105377, -659.4619285389456, -1325.8545905322537, -942.2813715641211, -984.3967569448339, -1048.8739504841649, -1271.6602727878499, -884.2168165610024, -120.3498448102144, -571.8383173841479, -758.6791037703539, -481.30518858138083, -88.83458320031049, -328.99638004032414, -1164.2482238764078, -1037.6852540070556, -1108.177141961618, -481.09355777003464, -1330.7257280221006, -444.63333051464537, -1034.1559632826534, -911.8054981464848, -49.81144684019108, -162.36696566139315, -874.5206799010188, -899.7297707121886, -760.6321804895842, -105.3290304431851, -1058.0399636169461, -792.834932717813, -853.3788809979729, -1022.6043949474519, -416.9816091553722, -1269.1826040192439, -336.24505798358564, -205.94777972385438, -1045.680062131196, -1009.502081737997, -1167.7423190371094, -519.9310739260666, -520.6569422928719, -877.5681568675817, -811.5482852893629, -86.85626004703593, -1196.778207962894, -694.4302170433112, -882.7010636949386, -506.2242325103727, -937.7379062009973, -152.1702288082164, -195.38000856615105, -470.5043075944628, -727.1917376732973, -956.1638541482278, -450.8324252397981, -588.8879731973803, -1148.950502714363, -1197.5935056087487, -996.78648064385, -956.2399223284316, -519.7993149414466, -402.3368549192789, -857.3448098932921, -68.95409757835807, -1131.5801146458732, -508.05786199107297, -553.7766172634812, -1184.846971175945, -185.37932968261106], "episode_lengths": [150, 150, 150, 44, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 112, 122, 150, 40, 53, 150, 150, 150, 150, 70, 150, 150, 43, 150, 150, 150, 96, 135, 150, 150, 150, 150, 150, 150, 89, 150, 134, 146, 69, 150, 150, 150, 150, 133, 150, 103, 150, 150, 52, 99, 150, 150, 150, 81, 150, 139, 150, 150, 150, 150, 128, 98, 150, 150, 150, 111, 150, 150, 150, 57, 150, 129, 150, 114, 150, 74, 81, 150, 150, 150, 105, 131, 150, 150, 150, 150, 150, 150, 150, 60, 150, 102, 150, 150, 124], "policy_policy_0_reward": [-1028.3604485894955, -1130.5922673445925, -1228.9711939187687, -39.16446103075955, -908.792466825101, -919.464595798824, -142.5026815508124, -936.5587619104692, -845.7546015518038, -455.9828103959677, -940.6988699418837, -883.0824232542449, -554.6951136741791, -860.0799559857091, -1012.6899754593007, -378.91762218177644, -495.553911234149, -929.0756654687713, -14.627323815355382, -70.49133039609993, -1154.7977080164362, -431.92553039202164, -1187.6627176319166, -1084.8218017358745, -177.72998727560318, -1394.2194105770034, -1174.3576180787463, -50.52004033211611, -699.0170242944372, -1011.8208592545334, -871.2910384927989, -347.7065643105377, -659.4619285389456, -1325.8545905322537, -942.2813715641211, -984.3967569448339, -1048.8739504841649, -1271.6602727878499, -884.2168165610024, -120.3498448102144, -571.8383173841479, -758.6791037703539, -481.30518858138083, -88.83458320031049, -328.99638004032414, -1164.2482238764078, -1037.6852540070556, -1108.177141961618, -481.09355777003464, -1330.7257280221006, -444.63333051464537, -1034.1559632826534, -911.8054981464848, -49.81144684019108, -162.36696566139315, -874.5206799010188, -899.7297707121886, -760.6321804895842, -105.3290304431851, -1058.0399636169461, -792.834932717813, -853.3788809979729, -1022.6043949474519, -416.9816091553722, -1269.1826040192439, -336.24505798358564, -205.94777972385438, -1045.680062131196, -1009.502081737997, -1167.7423190371094, -519.9310739260666, -520.6569422928719, -877.5681568675817, -811.5482852893629, -86.85626004703593, -1196.778207962894, -694.4302170433112, -882.7010636949386, -506.2242325103727, -937.7379062009973, -152.1702288082164, -195.38000856615105, -470.5043075944628, -727.1917376732973, -956.1638541482278, -450.8324252397981, -588.8879731973803, -1148.950502714363, -1197.5935056087487, -996.78648064385, -956.2399223284316, -519.7993149414466, -402.3368549192789, -857.3448098932921, -68.95409757835807, -1131.5801146458732, -508.05786199107297, -553.7766172634812, -1184.846971175945, -185.37932968261106]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560009622061051, "mean_inference_ms": 1.6826708217490278, "mean_action_processing_ms": 0.2778683431738344, "mean_env_wait_ms": 3.4718125409432705, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012159347534179688, "StateBufferConnector_ms": 0.008224248886108398, "ViewRequirementAgentConnector_ms": 0.20267009735107422}, "num_episodes": 34, "episode_return_max": -14.627323815355382, "episode_return_min": -1394.2194105770034, "episode_return_mean": -726.589396080668, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.2982237280128, "num_env_steps_trained_throughput_per_sec": 304.2982237280128, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13064.979, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13064.906, "sample_time_ms": 1167.803, "learn_time_ms": 11831.54, "learn_throughput": 338.079, "synch_weights_time_ms": 64.754}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00006", "date": "2024-08-04_06-04-40", "timestamp": 1722731680, "time_this_iter_s": 13.156758069992065, "time_total_s": 218.19000124931335, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01131c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 218.19000124931335, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.36666666666667, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 229.58062123060228, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.730854640652736, "policy_loss": -0.005030161604372552, "vf_loss": 2.732089052225153, "vf_explained_var": 0.9705853623027603, "kl": 0.013190698106639805, "entropy": 1.6146008613208929, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -49.81144684019108, "episode_reward_min": -1409.7151308362363, "episode_reward_mean": -715.5618772071771, "episode_len_mean": 132.18, "episode_media": {}, "episodes_timesteps_total": 13218, "policy_reward_min": {"policy_0": -1409.7151308362363}, "policy_reward_max": {"policy_0": -49.81144684019108}, "policy_reward_mean": {"policy_0": -715.5618772071771}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-871.2910384927989, -347.7065643105377, -659.4619285389456, -1325.8545905322537, -942.2813715641211, -984.3967569448339, -1048.8739504841649, -1271.6602727878499, -884.2168165610024, -120.3498448102144, -571.8383173841479, -758.6791037703539, -481.30518858138083, -88.83458320031049, -328.99638004032414, -1164.2482238764078, -1037.6852540070556, -1108.177141961618, -481.09355777003464, -1330.7257280221006, -444.63333051464537, -1034.1559632826534, -911.8054981464848, -49.81144684019108, -162.36696566139315, -874.5206799010188, -899.7297707121886, -760.6321804895842, -105.3290304431851, -1058.0399636169461, -792.834932717813, -853.3788809979729, -1022.6043949474519, -416.9816091553722, -1269.1826040192439, -336.24505798358564, -205.94777972385438, -1045.680062131196, -1009.502081737997, -1167.7423190371094, -519.9310739260666, -520.6569422928719, -877.5681568675817, -811.5482852893629, -86.85626004703593, -1196.778207962894, -694.4302170433112, -882.7010636949386, -506.2242325103727, -937.7379062009973, -152.1702288082164, -195.38000856615105, -470.5043075944628, -727.1917376732973, -956.1638541482278, -450.8324252397981, -588.8879731973803, -1148.950502714363, -1197.5935056087487, -996.78648064385, -956.2399223284316, -519.7993149414466, -402.3368549192789, -857.3448098932921, -68.95409757835807, -1131.5801146458732, -508.05786199107297, -553.7766172634812, -1184.846971175945, -185.37932968261106, -556.8677066798097, -70.75248402027938, -1095.8520734301267, -1345.5718783934983, -482.49360573781985, -130.68444763412893, -579.7502007358723, -1174.1178810232889, -1229.4144080422902, -785.52280822447, -213.49436264841341, -814.5675157151835, -1035.5285583054297, -883.9811858883917, -621.1960966643684, -1041.165508573914, -1409.7151308362363, -283.5650506034991, -460.56554952919106, -891.0298717658728, -1076.2771672175181, -958.2059103077966, -613.941555662833, -513.0015002855702, -267.82506085604575, -561.5293890968067, -802.209494549495, -837.0468082369498, -235.48591828078702, -68.8181616217633], "episode_lengths": [150, 96, 135, 150, 150, 150, 150, 150, 150, 89, 150, 134, 146, 69, 150, 150, 150, 150, 133, 150, 103, 150, 150, 52, 99, 150, 150, 150, 81, 150, 139, 150, 150, 150, 150, 128, 98, 150, 150, 150, 111, 150, 150, 150, 57, 150, 129, 150, 114, 150, 74, 81, 150, 150, 150, 105, 131, 150, 150, 150, 150, 150, 150, 150, 60, 150, 102, 150, 150, 124, 150, 59, 150, 150, 150, 52, 127, 150, 150, 150, 93, 150, 150, 143, 118, 150, 150, 95, 116, 150, 150, 150, 150, 129, 94, 150, 150, 150, 88, 64], "policy_policy_0_reward": [-871.2910384927989, -347.7065643105377, -659.4619285389456, -1325.8545905322537, -942.2813715641211, -984.3967569448339, -1048.8739504841649, -1271.6602727878499, -884.2168165610024, -120.3498448102144, -571.8383173841479, -758.6791037703539, -481.30518858138083, -88.83458320031049, -328.99638004032414, -1164.2482238764078, -1037.6852540070556, -1108.177141961618, -481.09355777003464, -1330.7257280221006, -444.63333051464537, -1034.1559632826534, -911.8054981464848, -49.81144684019108, -162.36696566139315, -874.5206799010188, -899.7297707121886, -760.6321804895842, -105.3290304431851, -1058.0399636169461, -792.834932717813, -853.3788809979729, -1022.6043949474519, -416.9816091553722, -1269.1826040192439, -336.24505798358564, -205.94777972385438, -1045.680062131196, -1009.502081737997, -1167.7423190371094, -519.9310739260666, -520.6569422928719, -877.5681568675817, -811.5482852893629, -86.85626004703593, -1196.778207962894, -694.4302170433112, -882.7010636949386, -506.2242325103727, -937.7379062009973, -152.1702288082164, -195.38000856615105, -470.5043075944628, -727.1917376732973, -956.1638541482278, -450.8324252397981, -588.8879731973803, -1148.950502714363, -1197.5935056087487, -996.78648064385, -956.2399223284316, -519.7993149414466, -402.3368549192789, -857.3448098932921, -68.95409757835807, -1131.5801146458732, -508.05786199107297, -553.7766172634812, -1184.846971175945, -185.37932968261106, -556.8677066798097, -70.75248402027938, -1095.8520734301267, -1345.5718783934983, -482.49360573781985, -130.68444763412893, -579.7502007358723, -1174.1178810232889, -1229.4144080422902, -785.52280822447, -213.49436264841341, -814.5675157151835, -1035.5285583054297, -883.9811858883917, -621.1960966643684, -1041.165508573914, -1409.7151308362363, -283.5650506034991, -460.56554952919106, -891.0298717658728, -1076.2771672175181, -958.2059103077966, -613.941555662833, -513.0015002855702, -267.82506085604575, -561.5293890968067, -802.209494549495, -837.0468082369498, -235.48591828078702, -68.8181616217633]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560107972666508, "mean_inference_ms": 1.6837082815218727, "mean_action_processing_ms": 0.2781857200467975, "mean_env_wait_ms": 3.4750308934627445, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011931419372558594, "StateBufferConnector_ms": 0.008090734481811523, "ViewRequirementAgentConnector_ms": 0.1994175910949707}, "num_episodes": 30, "episode_return_max": -49.81144684019108, "episode_return_min": -1409.7151308362363, "episode_return_mean": -715.5618772071771, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.0374611151185, "num_env_steps_trained_throughput_per_sec": 306.0374611151185, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 13042.009, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13041.938, "sample_time_ms": 1160.762, "learn_time_ms": 11815.1, "learn_throughput": 338.55, "synch_weights_time_ms": 65.279}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00006", "date": "2024-08-04_06-04-53", "timestamp": 1722731693, "time_this_iter_s": 13.081876754760742, "time_total_s": 231.2718780040741, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0142830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 231.2718780040741, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.042105263157897, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 252.47546292146046, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.5884430429587764, "policy_loss": -0.011343440862644154, "vf_loss": 2.5954399911065895, "vf_explained_var": 0.9934563123931487, "kl": 0.015014506805406827, "entropy": 1.5785837514946859, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -60.264806860307395, "episode_reward_min": -1455.2060986317804, "episode_reward_mean": -732.1190981962728, "episode_len_mean": 133.06, "episode_media": {}, "episodes_timesteps_total": 13306, "policy_reward_min": {"policy_0": -1455.2060986317804}, "policy_reward_max": {"policy_0": -60.264806860307395}, "policy_reward_mean": {"policy_0": -732.1190981962728}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1058.0399636169461, -792.834932717813, -853.3788809979729, -1022.6043949474519, -416.9816091553722, -1269.1826040192439, -336.24505798358564, -205.94777972385438, -1045.680062131196, -1009.502081737997, -1167.7423190371094, -519.9310739260666, -520.6569422928719, -877.5681568675817, -811.5482852893629, -86.85626004703593, -1196.778207962894, -694.4302170433112, -882.7010636949386, -506.2242325103727, -937.7379062009973, -152.1702288082164, -195.38000856615105, -470.5043075944628, -727.1917376732973, -956.1638541482278, -450.8324252397981, -588.8879731973803, -1148.950502714363, -1197.5935056087487, -996.78648064385, -956.2399223284316, -519.7993149414466, -402.3368549192789, -857.3448098932921, -68.95409757835807, -1131.5801146458732, -508.05786199107297, -553.7766172634812, -1184.846971175945, -185.37932968261106, -556.8677066798097, -70.75248402027938, -1095.8520734301267, -1345.5718783934983, -482.49360573781985, -130.68444763412893, -579.7502007358723, -1174.1178810232889, -1229.4144080422902, -785.52280822447, -213.49436264841341, -814.5675157151835, -1035.5285583054297, -883.9811858883917, -621.1960966643684, -1041.165508573914, -1409.7151308362363, -283.5650506034991, -460.56554952919106, -891.0298717658728, -1076.2771672175181, -958.2059103077966, -613.941555662833, -513.0015002855702, -267.82506085604575, -561.5293890968067, -802.209494549495, -837.0468082369498, -235.48591828078702, -68.8181616217633, -395.161133176771, -450.47902149475857, -1171.8155882202022, -992.9139269453593, -126.19649458577865, -1025.4243596758918, -1079.1618310294136, -155.46781674540443, -641.808987514941, -319.01872917539845, -1335.2588118241686, -60.264806860307395, -991.8883134861838, -258.899493349935, -678.3008280388657, -1018.201339171819, -1183.5310699222132, -586.7717083236683, -1130.869528503544, -544.907470507056, -850.7608701152272, -1244.1624400113856, -1329.1175119218753, -453.5250314297462, -767.7349290616183, -1116.1751626513842, -1052.931789552419, -290.42848661425876, -1455.2060986317804], "episode_lengths": [150, 139, 150, 150, 150, 150, 128, 98, 150, 150, 150, 111, 150, 150, 150, 57, 150, 129, 150, 114, 150, 74, 81, 150, 150, 150, 105, 131, 150, 150, 150, 150, 150, 150, 150, 60, 150, 102, 150, 150, 124, 150, 59, 150, 150, 150, 52, 127, 150, 150, 150, 93, 150, 150, 143, 118, 150, 150, 95, 116, 150, 150, 150, 150, 129, 94, 150, 150, 150, 88, 64, 141, 150, 150, 150, 62, 150, 150, 87, 150, 106, 150, 57, 150, 94, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 79, 150], "policy_policy_0_reward": [-1058.0399636169461, -792.834932717813, -853.3788809979729, -1022.6043949474519, -416.9816091553722, -1269.1826040192439, -336.24505798358564, -205.94777972385438, -1045.680062131196, -1009.502081737997, -1167.7423190371094, -519.9310739260666, -520.6569422928719, -877.5681568675817, -811.5482852893629, -86.85626004703593, -1196.778207962894, -694.4302170433112, -882.7010636949386, -506.2242325103727, -937.7379062009973, -152.1702288082164, -195.38000856615105, -470.5043075944628, -727.1917376732973, -956.1638541482278, -450.8324252397981, -588.8879731973803, -1148.950502714363, -1197.5935056087487, -996.78648064385, -956.2399223284316, -519.7993149414466, -402.3368549192789, -857.3448098932921, -68.95409757835807, -1131.5801146458732, -508.05786199107297, -553.7766172634812, -1184.846971175945, -185.37932968261106, -556.8677066798097, -70.75248402027938, -1095.8520734301267, -1345.5718783934983, -482.49360573781985, -130.68444763412893, -579.7502007358723, -1174.1178810232889, -1229.4144080422902, -785.52280822447, -213.49436264841341, -814.5675157151835, -1035.5285583054297, -883.9811858883917, -621.1960966643684, -1041.165508573914, -1409.7151308362363, -283.5650506034991, -460.56554952919106, -891.0298717658728, -1076.2771672175181, -958.2059103077966, -613.941555662833, -513.0015002855702, -267.82506085604575, -561.5293890968067, -802.209494549495, -837.0468082369498, -235.48591828078702, -68.8181616217633, -395.161133176771, -450.47902149475857, -1171.8155882202022, -992.9139269453593, -126.19649458577865, -1025.4243596758918, -1079.1618310294136, -155.46781674540443, -641.808987514941, -319.01872917539845, -1335.2588118241686, -60.264806860307395, -991.8883134861838, -258.899493349935, -678.3008280388657, -1018.201339171819, -1183.5310699222132, -586.7717083236683, -1130.869528503544, -544.907470507056, -850.7608701152272, -1244.1624400113856, -1329.1175119218753, -453.5250314297462, -767.7349290616183, -1116.1751626513842, -1052.931789552419, -290.42848661425876, -1455.2060986317804]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559719191651269, "mean_inference_ms": 1.682135203542635, "mean_action_processing_ms": 0.2776905565168926, "mean_env_wait_ms": 3.472680768835786, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011956214904785156, "StateBufferConnector_ms": 0.007910490036010742, "ViewRequirementAgentConnector_ms": 0.1939694881439209}, "num_episodes": 29, "episode_return_max": -60.264806860307395, "episode_return_min": -1455.2060986317804, "episode_return_mean": -732.1190981962728, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.58960139201486, "num_env_steps_trained_throughput_per_sec": 301.58960139201486, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 13021.042, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13020.97, "sample_time_ms": 1160.808, "learn_time_ms": 11792.992, "learn_throughput": 339.185, "synch_weights_time_ms": 66.373}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00006", "date": "2024-08-04_06-05-06", "timestamp": 1722731706, "time_this_iter_s": 13.276813268661499, "time_total_s": 244.5486912727356, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc702a70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 244.5486912727356, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.973684210526315, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 209.15475060741107, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.8146773468703032, "policy_loss": -0.012687295377448511, "vf_loss": 2.8233153386662404, "vf_explained_var": 0.972550033343335, "kl": 0.013989120247795956, "entropy": 1.474375880509615, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -60.264806860307395, "episode_reward_min": -1455.2060986317804, "episode_reward_mean": -669.4406219538882, "episode_len_mean": 127.0, "episode_media": {}, "episodes_timesteps_total": 12700, "policy_reward_min": {"policy_0": -1455.2060986317804}, "policy_reward_max": {"policy_0": -60.264806860307395}, "policy_reward_mean": {"policy_0": -669.4406219538882}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-956.2399223284316, -519.7993149414466, -402.3368549192789, -857.3448098932921, -68.95409757835807, -1131.5801146458732, -508.05786199107297, -553.7766172634812, -1184.846971175945, -185.37932968261106, -556.8677066798097, -70.75248402027938, -1095.8520734301267, -1345.5718783934983, -482.49360573781985, -130.68444763412893, -579.7502007358723, -1174.1178810232889, -1229.4144080422902, -785.52280822447, -213.49436264841341, -814.5675157151835, -1035.5285583054297, -883.9811858883917, -621.1960966643684, -1041.165508573914, -1409.7151308362363, -283.5650506034991, -460.56554952919106, -891.0298717658728, -1076.2771672175181, -958.2059103077966, -613.941555662833, -513.0015002855702, -267.82506085604575, -561.5293890968067, -802.209494549495, -837.0468082369498, -235.48591828078702, -68.8181616217633, -395.161133176771, -450.47902149475857, -1171.8155882202022, -992.9139269453593, -126.19649458577865, -1025.4243596758918, -1079.1618310294136, -155.46781674540443, -641.808987514941, -319.01872917539845, -1335.2588118241686, -60.264806860307395, -991.8883134861838, -258.899493349935, -678.3008280388657, -1018.201339171819, -1183.5310699222132, -586.7717083236683, -1130.869528503544, -544.907470507056, -850.7608701152272, -1244.1624400113856, -1329.1175119218753, -453.5250314297462, -767.7349290616183, -1116.1751626513842, -1052.931789552419, -290.42848661425876, -1455.2060986317804, -367.9661597709882, -1097.0222126075846, -514.6396246473835, -301.5124787512352, -990.8705516728045, -61.43737244681905, -204.3717307452183, -1043.0927472609796, -535.3234811618931, -154.32747225709008, -1204.7769012660324, -805.6540279472053, -66.27253690222535, -615.4627223482012, -483.92442685901585, -463.04307490961827, -841.5226865262875, -569.4614267301253, -422.89112808029495, -141.40941946365626, -505.73224849114894, -1131.2235264386734, -1060.6100134516712, -1186.5213919632915, -666.6603998958012, -73.7339303501743, -85.7203836550924, -328.0366157942489, -342.8119502131576, -374.29467126610103, -188.85811798598021], "episode_lengths": [150, 150, 150, 150, 60, 150, 102, 150, 150, 124, 150, 59, 150, 150, 150, 52, 127, 150, 150, 150, 93, 150, 150, 143, 118, 150, 150, 95, 116, 150, 150, 150, 150, 129, 94, 150, 150, 150, 88, 64, 141, 150, 150, 150, 62, 150, 150, 87, 150, 106, 150, 57, 150, 94, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 87, 150, 43, 94, 150, 150, 69, 150, 150, 42, 120, 109, 150, 150, 150, 95, 51, 124, 150, 150, 150, 125, 62, 64, 85, 94, 114, 83], "policy_policy_0_reward": [-956.2399223284316, -519.7993149414466, -402.3368549192789, -857.3448098932921, -68.95409757835807, -1131.5801146458732, -508.05786199107297, -553.7766172634812, -1184.846971175945, -185.37932968261106, -556.8677066798097, -70.75248402027938, -1095.8520734301267, -1345.5718783934983, -482.49360573781985, -130.68444763412893, -579.7502007358723, -1174.1178810232889, -1229.4144080422902, -785.52280822447, -213.49436264841341, -814.5675157151835, -1035.5285583054297, -883.9811858883917, -621.1960966643684, -1041.165508573914, -1409.7151308362363, -283.5650506034991, -460.56554952919106, -891.0298717658728, -1076.2771672175181, -958.2059103077966, -613.941555662833, -513.0015002855702, -267.82506085604575, -561.5293890968067, -802.209494549495, -837.0468082369498, -235.48591828078702, -68.8181616217633, -395.161133176771, -450.47902149475857, -1171.8155882202022, -992.9139269453593, -126.19649458577865, -1025.4243596758918, -1079.1618310294136, -155.46781674540443, -641.808987514941, -319.01872917539845, -1335.2588118241686, -60.264806860307395, -991.8883134861838, -258.899493349935, -678.3008280388657, -1018.201339171819, -1183.5310699222132, -586.7717083236683, -1130.869528503544, -544.907470507056, -850.7608701152272, -1244.1624400113856, -1329.1175119218753, -453.5250314297462, -767.7349290616183, -1116.1751626513842, -1052.931789552419, -290.42848661425876, -1455.2060986317804, -367.9661597709882, -1097.0222126075846, -514.6396246473835, -301.5124787512352, -990.8705516728045, -61.43737244681905, -204.3717307452183, -1043.0927472609796, -535.3234811618931, -154.32747225709008, -1204.7769012660324, -805.6540279472053, -66.27253690222535, -615.4627223482012, -483.92442685901585, -463.04307490961827, -841.5226865262875, -569.4614267301253, -422.89112808029495, -141.40941946365626, -505.73224849114894, -1131.2235264386734, -1060.6100134516712, -1186.5213919632915, -666.6603998958012, -73.7339303501743, -85.7203836550924, -328.0366157942489, -342.8119502131576, -374.29467126610103, -188.85811798598021]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.555255078995295, "mean_inference_ms": 1.680949158084363, "mean_action_processing_ms": 0.27741664055840537, "mean_env_wait_ms": 3.472612268365997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01189279556274414, "StateBufferConnector_ms": 0.007782459259033203, "ViewRequirementAgentConnector_ms": 0.1909329891204834}, "num_episodes": 31, "episode_return_max": -60.264806860307395, "episode_return_min": -1455.2060986317804, "episode_return_mean": -669.4406219538882, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.78508428352603, "num_env_steps_trained_throughput_per_sec": 296.78508428352603, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 13113.724, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13113.654, "sample_time_ms": 1160.862, "learn_time_ms": 11886.104, "learn_throughput": 336.527, "synch_weights_time_ms": 65.884}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00006", "date": "2024-08-04_06-05-20", "timestamp": 1722731720, "time_this_iter_s": 13.489238739013672, "time_total_s": 258.03793001174927, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0111c60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 258.03793001174927, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.905263157894737, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 248.926310629646, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.610778995975852, "policy_loss": -0.008585263096999066, "vf_loss": 2.6152841626356045, "vf_explained_var": 0.9885370740046103, "kl": 0.014086856704731568, "entropy": 1.4595394514501094, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -57.84692445357427, "episode_reward_min": -1455.2060986317804, "episode_reward_mean": -627.733193191561, "episode_len_mean": 123.83, "episode_media": {}, "episodes_timesteps_total": 12383, "policy_reward_min": {"policy_0": -1455.2060986317804}, "policy_reward_max": {"policy_0": -57.84692445357427}, "policy_reward_mean": {"policy_0": -627.733193191561}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-267.82506085604575, -561.5293890968067, -802.209494549495, -837.0468082369498, -235.48591828078702, -68.8181616217633, -395.161133176771, -450.47902149475857, -1171.8155882202022, -992.9139269453593, -126.19649458577865, -1025.4243596758918, -1079.1618310294136, -155.46781674540443, -641.808987514941, -319.01872917539845, -1335.2588118241686, -60.264806860307395, -991.8883134861838, -258.899493349935, -678.3008280388657, -1018.201339171819, -1183.5310699222132, -586.7717083236683, -1130.869528503544, -544.907470507056, -850.7608701152272, -1244.1624400113856, -1329.1175119218753, -453.5250314297462, -767.7349290616183, -1116.1751626513842, -1052.931789552419, -290.42848661425876, -1455.2060986317804, -367.9661597709882, -1097.0222126075846, -514.6396246473835, -301.5124787512352, -990.8705516728045, -61.43737244681905, -204.3717307452183, -1043.0927472609796, -535.3234811618931, -154.32747225709008, -1204.7769012660324, -805.6540279472053, -66.27253690222535, -615.4627223482012, -483.92442685901585, -463.04307490961827, -841.5226865262875, -569.4614267301253, -422.89112808029495, -141.40941946365626, -505.73224849114894, -1131.2235264386734, -1060.6100134516712, -1186.5213919632915, -666.6603998958012, -73.7339303501743, -85.7203836550924, -328.0366157942489, -342.8119502131576, -374.29467126610103, -188.85811798598021, -767.1314062757621, -1064.8312051780013, -340.3171776333416, -180.16780448483743, -445.20005687788654, -434.4024304736823, -894.4370209626791, -748.2501404919989, -1071.1634195628299, -168.22306395025515, -469.905603689146, -711.4471171151501, -144.75924031696053, -902.7276351280366, -92.55222837759948, -1031.3740966363391, -886.8275616943527, -57.84692445357427, -901.5439219103718, -362.94956680090905, -651.1643019002868, -66.57109533552428, -235.1393195374695, -301.79794214495024, -171.11216707688564, -1164.1961071477945, -110.97466105077132, -504.7442749613933, -939.4049292217542, -969.4647695656314, -962.648630855264, -1138.4986803847924, -329.4975251405032, -1243.5634497761246], "episode_lengths": [94, 150, 150, 150, 88, 64, 141, 150, 150, 150, 62, 150, 150, 87, 150, 106, 150, 57, 150, 94, 150, 150, 150, 150, 150, 149, 150, 150, 150, 150, 150, 150, 150, 79, 150, 150, 150, 150, 87, 150, 43, 94, 150, 150, 69, 150, 150, 42, 120, 109, 150, 150, 150, 95, 51, 124, 150, 150, 150, 125, 62, 64, 85, 94, 114, 83, 150, 150, 134, 65, 125, 101, 150, 150, 150, 77, 150, 150, 76, 150, 58, 150, 150, 43, 150, 150, 139, 51, 108, 108, 78, 150, 96, 143, 150, 150, 150, 150, 99, 150], "policy_policy_0_reward": [-267.82506085604575, -561.5293890968067, -802.209494549495, -837.0468082369498, -235.48591828078702, -68.8181616217633, -395.161133176771, -450.47902149475857, -1171.8155882202022, -992.9139269453593, -126.19649458577865, -1025.4243596758918, -1079.1618310294136, -155.46781674540443, -641.808987514941, -319.01872917539845, -1335.2588118241686, -60.264806860307395, -991.8883134861838, -258.899493349935, -678.3008280388657, -1018.201339171819, -1183.5310699222132, -586.7717083236683, -1130.869528503544, -544.907470507056, -850.7608701152272, -1244.1624400113856, -1329.1175119218753, -453.5250314297462, -767.7349290616183, -1116.1751626513842, -1052.931789552419, -290.42848661425876, -1455.2060986317804, -367.9661597709882, -1097.0222126075846, -514.6396246473835, -301.5124787512352, -990.8705516728045, -61.43737244681905, -204.3717307452183, -1043.0927472609796, -535.3234811618931, -154.32747225709008, -1204.7769012660324, -805.6540279472053, -66.27253690222535, -615.4627223482012, -483.92442685901585, -463.04307490961827, -841.5226865262875, -569.4614267301253, -422.89112808029495, -141.40941946365626, -505.73224849114894, -1131.2235264386734, -1060.6100134516712, -1186.5213919632915, -666.6603998958012, -73.7339303501743, -85.7203836550924, -328.0366157942489, -342.8119502131576, -374.29467126610103, -188.85811798598021, -767.1314062757621, -1064.8312051780013, -340.3171776333416, -180.16780448483743, -445.20005687788654, -434.4024304736823, -894.4370209626791, -748.2501404919989, -1071.1634195628299, -168.22306395025515, -469.905603689146, -711.4471171151501, -144.75924031696053, -902.7276351280366, -92.55222837759948, -1031.3740966363391, -886.8275616943527, -57.84692445357427, -901.5439219103718, -362.94956680090905, -651.1643019002868, -66.57109533552428, -235.1393195374695, -301.79794214495024, -171.11216707688564, -1164.1961071477945, -110.97466105077132, -504.7442749613933, -939.4049292217542, -969.4647695656314, -962.648630855264, -1138.4986803847924, -329.4975251405032, -1243.5634497761246]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548646579296544, "mean_inference_ms": 1.6795081142966333, "mean_action_processing_ms": 0.2770395180281378, "mean_env_wait_ms": 3.469493520339004, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01193690299987793, "StateBufferConnector_ms": 0.007991790771484375, "ViewRequirementAgentConnector_ms": 0.19378304481506348}, "num_episodes": 34, "episode_return_max": -57.84692445357427, "episode_return_min": -1455.2060986317804, "episode_return_mean": -627.733193191561, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.87583830909966, "num_env_steps_trained_throughput_per_sec": 296.87583830909966, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 13232.434, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13232.363, "sample_time_ms": 1163.084, "learn_time_ms": 12001.627, "learn_throughput": 333.288, "synch_weights_time_ms": 66.845}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00006", "date": "2024-08-04_06-05-33", "timestamp": 1722731733, "time_this_iter_s": 13.486487627029419, "time_total_s": 271.5244176387787, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0ae3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 271.5244176387787, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.09473684210526, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 219.92385105689365, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.7314658079296352, "policy_loss": -0.010529396420073075, "vf_loss": 2.737810441975792, "vf_explained_var": 0.9800324787696203, "kl": 0.014459894822622724, "entropy": 1.5320833473155895, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -23.85972652234068, "episode_reward_min": -1455.2060986317804, "episode_reward_mean": -603.0026615809365, "episode_len_mean": 121.37, "episode_media": {}, "episodes_timesteps_total": 12137, "policy_reward_min": {"policy_0": -1455.2060986317804}, "policy_reward_max": {"policy_0": -23.85972652234068}, "policy_reward_mean": {"policy_0": -603.0026615809365}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-767.7349290616183, -1116.1751626513842, -1052.931789552419, -290.42848661425876, -1455.2060986317804, -367.9661597709882, -1097.0222126075846, -514.6396246473835, -301.5124787512352, -990.8705516728045, -61.43737244681905, -204.3717307452183, -1043.0927472609796, -535.3234811618931, -154.32747225709008, -1204.7769012660324, -805.6540279472053, -66.27253690222535, -615.4627223482012, -483.92442685901585, -463.04307490961827, -841.5226865262875, -569.4614267301253, -422.89112808029495, -141.40941946365626, -505.73224849114894, -1131.2235264386734, -1060.6100134516712, -1186.5213919632915, -666.6603998958012, -73.7339303501743, -85.7203836550924, -328.0366157942489, -342.8119502131576, -374.29467126610103, -188.85811798598021, -767.1314062757621, -1064.8312051780013, -340.3171776333416, -180.16780448483743, -445.20005687788654, -434.4024304736823, -894.4370209626791, -748.2501404919989, -1071.1634195628299, -168.22306395025515, -469.905603689146, -711.4471171151501, -144.75924031696053, -902.7276351280366, -92.55222837759948, -1031.3740966363391, -886.8275616943527, -57.84692445357427, -901.5439219103718, -362.94956680090905, -651.1643019002868, -66.57109533552428, -235.1393195374695, -301.79794214495024, -171.11216707688564, -1164.1961071477945, -110.97466105077132, -504.7442749613933, -939.4049292217542, -969.4647695656314, -962.648630855264, -1138.4986803847924, -329.4975251405032, -1243.5634497761246, -892.0844888427071, -1148.7894424008746, -440.40488988803156, -60.83805467011288, -1170.605556537989, -903.0039707920365, -1215.7504032800625, -1096.157555540118, -1235.0704526750173, -308.6964867110187, -1083.8702819215603, -283.92208937638907, -649.0458329615016, -299.79530622747694, -652.7196289956554, -706.99928997966, -23.85972652234068, -701.3222226233269, -62.2392258614706, -336.9311651223458, -158.93865961300708, -160.55052281132367, -244.0275343879863, -1245.9972021576316, -1358.0870056228923, -515.3224625607078, -253.8657714684638, -446.5454759006489, -416.8288965740695, -251.49918158290583], "episode_lengths": [150, 150, 150, 79, 150, 150, 150, 150, 87, 150, 43, 94, 150, 150, 69, 150, 150, 42, 120, 109, 150, 150, 150, 95, 51, 124, 150, 150, 150, 125, 62, 64, 85, 94, 114, 83, 150, 150, 134, 65, 125, 101, 150, 150, 150, 77, 150, 150, 76, 150, 58, 150, 150, 43, 150, 150, 139, 51, 108, 108, 78, 150, 96, 143, 150, 150, 150, 150, 99, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 106, 150, 150, 129, 111, 150, 150, 37, 150, 49, 150, 64, 56, 101, 150, 150, 150, 89, 150, 91, 113], "policy_policy_0_reward": [-767.7349290616183, -1116.1751626513842, -1052.931789552419, -290.42848661425876, -1455.2060986317804, -367.9661597709882, -1097.0222126075846, -514.6396246473835, -301.5124787512352, -990.8705516728045, -61.43737244681905, -204.3717307452183, -1043.0927472609796, -535.3234811618931, -154.32747225709008, -1204.7769012660324, -805.6540279472053, -66.27253690222535, -615.4627223482012, -483.92442685901585, -463.04307490961827, -841.5226865262875, -569.4614267301253, -422.89112808029495, -141.40941946365626, -505.73224849114894, -1131.2235264386734, -1060.6100134516712, -1186.5213919632915, -666.6603998958012, -73.7339303501743, -85.7203836550924, -328.0366157942489, -342.8119502131576, -374.29467126610103, -188.85811798598021, -767.1314062757621, -1064.8312051780013, -340.3171776333416, -180.16780448483743, -445.20005687788654, -434.4024304736823, -894.4370209626791, -748.2501404919989, -1071.1634195628299, -168.22306395025515, -469.905603689146, -711.4471171151501, -144.75924031696053, -902.7276351280366, -92.55222837759948, -1031.3740966363391, -886.8275616943527, -57.84692445357427, -901.5439219103718, -362.94956680090905, -651.1643019002868, -66.57109533552428, -235.1393195374695, -301.79794214495024, -171.11216707688564, -1164.1961071477945, -110.97466105077132, -504.7442749613933, -939.4049292217542, -969.4647695656314, -962.648630855264, -1138.4986803847924, -329.4975251405032, -1243.5634497761246, -892.0844888427071, -1148.7894424008746, -440.40488988803156, -60.83805467011288, -1170.605556537989, -903.0039707920365, -1215.7504032800625, -1096.157555540118, -1235.0704526750173, -308.6964867110187, -1083.8702819215603, -283.92208937638907, -649.0458329615016, -299.79530622747694, -652.7196289956554, -706.99928997966, -23.85972652234068, -701.3222226233269, -62.2392258614706, -336.9311651223458, -158.93865961300708, -160.55052281132367, -244.0275343879863, -1245.9972021576316, -1358.0870056228923, -515.3224625607078, -253.8657714684638, -446.5454759006489, -416.8288965740695, -251.49918158290583]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549906035408577, "mean_inference_ms": 1.679011262172057, "mean_action_processing_ms": 0.27674411600731164, "mean_env_wait_ms": 3.468762553626833, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012214183807373047, "StateBufferConnector_ms": 0.008253335952758789, "ViewRequirementAgentConnector_ms": 0.22017693519592285}, "num_episodes": 30, "episode_return_max": -23.85972652234068, "episode_return_min": -1455.2060986317804, "episode_return_mean": -603.0026615809365, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.52482639380554, "num_env_steps_trained_throughput_per_sec": 308.52482639380554, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 13204.505, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13204.434, "sample_time_ms": 1157.625, "learn_time_ms": 11979.058, "learn_throughput": 333.916, "synch_weights_time_ms": 66.946}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00006", "date": "2024-08-04_06-05-46", "timestamp": 1722731746, "time_this_iter_s": 12.977960348129272, "time_total_s": 284.50237798690796, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0142b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 284.50237798690796, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.821052631578944, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 247.66635912458102, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.2093753539025784, "policy_loss": -0.011906011523872924, "vf_loss": 2.216527952377995, "vf_explained_var": 0.9934473124022285, "kl": 0.016371418386794782, "entropy": 1.5801346340527138, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -23.85972652234068, "episode_reward_min": -1414.6247993149545, "episode_reward_mean": -608.6342413110473, "episode_len_mean": 125.13, "episode_media": {}, "episodes_timesteps_total": 12513, "policy_reward_min": {"policy_0": -1414.6247993149545}, "policy_reward_max": {"policy_0": -23.85972652234068}, "policy_reward_mean": {"policy_0": -608.6342413110473}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-342.8119502131576, -374.29467126610103, -188.85811798598021, -767.1314062757621, -1064.8312051780013, -340.3171776333416, -180.16780448483743, -445.20005687788654, -434.4024304736823, -894.4370209626791, -748.2501404919989, -1071.1634195628299, -168.22306395025515, -469.905603689146, -711.4471171151501, -144.75924031696053, -902.7276351280366, -92.55222837759948, -1031.3740966363391, -886.8275616943527, -57.84692445357427, -901.5439219103718, -362.94956680090905, -651.1643019002868, -66.57109533552428, -235.1393195374695, -301.79794214495024, -171.11216707688564, -1164.1961071477945, -110.97466105077132, -504.7442749613933, -939.4049292217542, -969.4647695656314, -962.648630855264, -1138.4986803847924, -329.4975251405032, -1243.5634497761246, -892.0844888427071, -1148.7894424008746, -440.40488988803156, -60.83805467011288, -1170.605556537989, -903.0039707920365, -1215.7504032800625, -1096.157555540118, -1235.0704526750173, -308.6964867110187, -1083.8702819215603, -283.92208937638907, -649.0458329615016, -299.79530622747694, -652.7196289956554, -706.99928997966, -23.85972652234068, -701.3222226233269, -62.2392258614706, -336.9311651223458, -158.93865961300708, -160.55052281132367, -244.0275343879863, -1245.9972021576316, -1358.0870056228923, -515.3224625607078, -253.8657714684638, -446.5454759006489, -416.8288965740695, -251.49918158290583, -605.737678767125, -1125.115848224937, -866.78788839717, -1147.7877218229637, -786.9906164745594, -990.9330199735969, -540.2433697251785, -1101.1368392811003, -216.52910246899444, -927.2691849513974, -196.33830956537838, -887.2565294131718, -412.9840633151807, -1414.6247993149545, -418.291564547345, -680.3755705333158, -146.9752120038694, -176.16757714181776, -917.6334404480654, -164.1523934163005, -545.305802536544, -872.7896713073286, -573.1824568643716, -942.2145127426395, -236.86822724109038, -408.582895469565, -769.3291030477234, -875.6490607688793, -223.47848348735425, -326.496499824874, -157.78322480450578, -1102.1947468376288, -411.64971719835495], "episode_lengths": [94, 114, 83, 150, 150, 134, 65, 125, 101, 150, 150, 150, 77, 150, 150, 76, 150, 58, 150, 150, 43, 150, 150, 139, 51, 108, 108, 78, 150, 96, 143, 150, 150, 150, 150, 99, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 106, 150, 150, 129, 111, 150, 150, 37, 150, 49, 150, 64, 56, 101, 150, 150, 150, 89, 150, 91, 113, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 68, 150, 150, 150, 150, 150, 71, 82, 150, 70, 148, 150, 150, 150, 91, 110, 150, 150, 79, 150, 68, 150, 150], "policy_policy_0_reward": [-342.8119502131576, -374.29467126610103, -188.85811798598021, -767.1314062757621, -1064.8312051780013, -340.3171776333416, -180.16780448483743, -445.20005687788654, -434.4024304736823, -894.4370209626791, -748.2501404919989, -1071.1634195628299, -168.22306395025515, -469.905603689146, -711.4471171151501, -144.75924031696053, -902.7276351280366, -92.55222837759948, -1031.3740966363391, -886.8275616943527, -57.84692445357427, -901.5439219103718, -362.94956680090905, -651.1643019002868, -66.57109533552428, -235.1393195374695, -301.79794214495024, -171.11216707688564, -1164.1961071477945, -110.97466105077132, -504.7442749613933, -939.4049292217542, -969.4647695656314, -962.648630855264, -1138.4986803847924, -329.4975251405032, -1243.5634497761246, -892.0844888427071, -1148.7894424008746, -440.40488988803156, -60.83805467011288, -1170.605556537989, -903.0039707920365, -1215.7504032800625, -1096.157555540118, -1235.0704526750173, -308.6964867110187, -1083.8702819215603, -283.92208937638907, -649.0458329615016, -299.79530622747694, -652.7196289956554, -706.99928997966, -23.85972652234068, -701.3222226233269, -62.2392258614706, -336.9311651223458, -158.93865961300708, -160.55052281132367, -244.0275343879863, -1245.9972021576316, -1358.0870056228923, -515.3224625607078, -253.8657714684638, -446.5454759006489, -416.8288965740695, -251.49918158290583, -605.737678767125, -1125.115848224937, -866.78788839717, -1147.7877218229637, -786.9906164745594, -990.9330199735969, -540.2433697251785, -1101.1368392811003, -216.52910246899444, -927.2691849513974, -196.33830956537838, -887.2565294131718, -412.9840633151807, -1414.6247993149545, -418.291564547345, -680.3755705333158, -146.9752120038694, -176.16757714181776, -917.6334404480654, -164.1523934163005, -545.305802536544, -872.7896713073286, -573.1824568643716, -942.2145127426395, -236.86822724109038, -408.582895469565, -769.3291030477234, -875.6490607688793, -223.47848348735425, -326.496499824874, -157.78322480450578, -1102.1947468376288, -411.64971719835495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554630433544181, "mean_inference_ms": 1.679380521565257, "mean_action_processing_ms": 0.27673912549777113, "mean_env_wait_ms": 3.470633399635557, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012555122375488281, "StateBufferConnector_ms": 0.00818777084350586, "ViewRequirementAgentConnector_ms": 0.22367262840270996}, "num_episodes": 33, "episode_return_max": -23.85972652234068, "episode_return_min": -1414.6247993149545, "episode_return_mean": -608.6342413110473, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.36900902489504, "num_env_steps_trained_throughput_per_sec": 353.36900902489504, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 13001.162, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13001.089, "sample_time_ms": 1154.421, "learn_time_ms": 11781.6, "learn_throughput": 339.512, "synch_weights_time_ms": 64.276}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00006", "date": "2024-08-04_06-05-58", "timestamp": 1722731758, "time_this_iter_s": 11.331486463546753, "time_total_s": 295.8338644504547, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0143d00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.8338644504547, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 19.412499999999998, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 285.15008660356204, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.27234171765546, "policy_loss": -0.0060948153346544135, "vf_loss": 2.2746349073946477, "vf_explained_var": 0.9842358670507868, "kl": 0.01330125337105228, "entropy": 1.8875049268205961, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -23.85972652234068, "episode_reward_min": -1414.6247993149545, "episode_reward_mean": -699.4860232824448, "episode_len_mean": 131.81, "episode_media": {}, "episodes_timesteps_total": 13181, "policy_reward_min": {"policy_0": -1414.6247993149545}, "policy_reward_max": {"policy_0": -23.85972652234068}, "policy_reward_mean": {"policy_0": -699.4860232824448}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-504.7442749613933, -939.4049292217542, -969.4647695656314, -962.648630855264, -1138.4986803847924, -329.4975251405032, -1243.5634497761246, -892.0844888427071, -1148.7894424008746, -440.40488988803156, -60.83805467011288, -1170.605556537989, -903.0039707920365, -1215.7504032800625, -1096.157555540118, -1235.0704526750173, -308.6964867110187, -1083.8702819215603, -283.92208937638907, -649.0458329615016, -299.79530622747694, -652.7196289956554, -706.99928997966, -23.85972652234068, -701.3222226233269, -62.2392258614706, -336.9311651223458, -158.93865961300708, -160.55052281132367, -244.0275343879863, -1245.9972021576316, -1358.0870056228923, -515.3224625607078, -253.8657714684638, -446.5454759006489, -416.8288965740695, -251.49918158290583, -605.737678767125, -1125.115848224937, -866.78788839717, -1147.7877218229637, -786.9906164745594, -990.9330199735969, -540.2433697251785, -1101.1368392811003, -216.52910246899444, -927.2691849513974, -196.33830956537838, -887.2565294131718, -412.9840633151807, -1414.6247993149545, -418.291564547345, -680.3755705333158, -146.9752120038694, -176.16757714181776, -917.6334404480654, -164.1523934163005, -545.305802536544, -872.7896713073286, -573.1824568643716, -942.2145127426395, -236.86822724109038, -408.582895469565, -769.3291030477234, -875.6490607688793, -223.47848348735425, -326.496499824874, -157.78322480450578, -1102.1947468376288, -411.64971719835495, -746.9178050598845, -451.06050940471715, -1051.0281842379172, -1337.772667557139, -1200.6067087168624, -251.60006019814455, -201.12872944771456, -48.92370537132037, -1003.063392469728, -987.4172672538417, -918.4485268958571, -1232.6345504532421, -377.12518010963714, -804.9324455023192, -586.3925115858506, -1346.7808866938037, -806.1564583023413, -970.7589906739496, -876.0036489634354, -302.0454728493832, -1081.654985669214, -913.8685196543832, -936.6035597486696, -1036.1801414419274, -805.0508615738187, -1151.470125912295, -509.9786150708324, -1268.3499966633651, -589.1225245140861, -575.079120816717], "episode_lengths": [143, 150, 150, 150, 150, 99, 150, 150, 150, 150, 50, 150, 150, 150, 150, 150, 106, 150, 150, 129, 111, 150, 150, 37, 150, 49, 150, 64, 56, 101, 150, 150, 150, 89, 150, 91, 113, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 68, 150, 150, 150, 150, 150, 71, 82, 150, 70, 148, 150, 150, 150, 91, 110, 150, 150, 79, 150, 68, 150, 150, 150, 100, 150, 150, 150, 99, 86, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 132, 150, 130, 150, 150, 150], "policy_policy_0_reward": [-504.7442749613933, -939.4049292217542, -969.4647695656314, -962.648630855264, -1138.4986803847924, -329.4975251405032, -1243.5634497761246, -892.0844888427071, -1148.7894424008746, -440.40488988803156, -60.83805467011288, -1170.605556537989, -903.0039707920365, -1215.7504032800625, -1096.157555540118, -1235.0704526750173, -308.6964867110187, -1083.8702819215603, -283.92208937638907, -649.0458329615016, -299.79530622747694, -652.7196289956554, -706.99928997966, -23.85972652234068, -701.3222226233269, -62.2392258614706, -336.9311651223458, -158.93865961300708, -160.55052281132367, -244.0275343879863, -1245.9972021576316, -1358.0870056228923, -515.3224625607078, -253.8657714684638, -446.5454759006489, -416.8288965740695, -251.49918158290583, -605.737678767125, -1125.115848224937, -866.78788839717, -1147.7877218229637, -786.9906164745594, -990.9330199735969, -540.2433697251785, -1101.1368392811003, -216.52910246899444, -927.2691849513974, -196.33830956537838, -887.2565294131718, -412.9840633151807, -1414.6247993149545, -418.291564547345, -680.3755705333158, -146.9752120038694, -176.16757714181776, -917.6334404480654, -164.1523934163005, -545.305802536544, -872.7896713073286, -573.1824568643716, -942.2145127426395, -236.86822724109038, -408.582895469565, -769.3291030477234, -875.6490607688793, -223.47848348735425, -326.496499824874, -157.78322480450578, -1102.1947468376288, -411.64971719835495, -746.9178050598845, -451.06050940471715, -1051.0281842379172, -1337.772667557139, -1200.6067087168624, -251.60006019814455, -201.12872944771456, -48.92370537132037, -1003.063392469728, -987.4172672538417, -918.4485268958571, -1232.6345504532421, -377.12518010963714, -804.9324455023192, -586.3925115858506, -1346.7808866938037, -806.1564583023413, -970.7589906739496, -876.0036489634354, -302.0454728493832, -1081.654985669214, -913.8685196543832, -936.6035597486696, -1036.1801414419274, -805.0508615738187, -1151.470125912295, -509.9786150708324, -1268.3499966633651, -589.1225245140861, -575.079120816717]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5557479674134448, "mean_inference_ms": 1.6785399066198616, "mean_action_processing_ms": 0.2760706648654263, "mean_env_wait_ms": 3.468291489246522, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012459278106689453, "StateBufferConnector_ms": 0.008075952529907227, "ViewRequirementAgentConnector_ms": 0.2210686206817627}, "num_episodes": 30, "episode_return_max": -23.85972652234068, "episode_return_min": -1414.6247993149545, "episode_return_mean": -699.4860232824448, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.31897733729403, "num_env_steps_trained_throughput_per_sec": 308.31897733729403, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12984.192, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12984.118, "sample_time_ms": 1165.114, "learn_time_ms": 11753.435, "learn_throughput": 340.326, "synch_weights_time_ms": 64.784}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00006", "date": "2024-08-04_06-06-11", "timestamp": 1722731771, "time_this_iter_s": 12.98616361618042, "time_total_s": 308.82002806663513, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01a5090>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.82002806663513, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 20.731578947368423, "ram_util_percent": 28.00526315789474}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 217.72330983082455, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.30405989823242, "policy_loss": -0.012842463990091346, "vf_loss": 2.3122349688162407, "vf_explained_var": 0.9947213384012381, "kl": 0.01613233066552008, "entropy": 1.723085409278671, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -48.92370537132037, "episode_reward_min": -1414.6247993149545, "episode_reward_mean": -697.5434913249039, "episode_len_mean": 131.3, "episode_media": {}, "episodes_timesteps_total": 13130, "policy_reward_min": {"policy_0": -1414.6247993149545}, "policy_reward_max": {"policy_0": -48.92370537132037}, "policy_reward_mean": {"policy_0": -697.5434913249039}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-244.0275343879863, -1245.9972021576316, -1358.0870056228923, -515.3224625607078, -253.8657714684638, -446.5454759006489, -416.8288965740695, -251.49918158290583, -605.737678767125, -1125.115848224937, -866.78788839717, -1147.7877218229637, -786.9906164745594, -990.9330199735969, -540.2433697251785, -1101.1368392811003, -216.52910246899444, -927.2691849513974, -196.33830956537838, -887.2565294131718, -412.9840633151807, -1414.6247993149545, -418.291564547345, -680.3755705333158, -146.9752120038694, -176.16757714181776, -917.6334404480654, -164.1523934163005, -545.305802536544, -872.7896713073286, -573.1824568643716, -942.2145127426395, -236.86822724109038, -408.582895469565, -769.3291030477234, -875.6490607688793, -223.47848348735425, -326.496499824874, -157.78322480450578, -1102.1947468376288, -411.64971719835495, -746.9178050598845, -451.06050940471715, -1051.0281842379172, -1337.772667557139, -1200.6067087168624, -251.60006019814455, -201.12872944771456, -48.92370537132037, -1003.063392469728, -987.4172672538417, -918.4485268958571, -1232.6345504532421, -377.12518010963714, -804.9324455023192, -586.3925115858506, -1346.7808866938037, -806.1564583023413, -970.7589906739496, -876.0036489634354, -302.0454728493832, -1081.654985669214, -913.8685196543832, -936.6035597486696, -1036.1801414419274, -805.0508615738187, -1151.470125912295, -509.9786150708324, -1268.3499966633651, -589.1225245140861, -575.079120816717, -1058.7264437729239, -1163.983844234724, -1146.8366251607208, -1132.7507793602188, -694.7241158983151, -177.0326847771912, -1202.2332365905731, -905.1233117430472, -144.3504146949523, -985.2205607291706, -1313.8460340415172, -983.5679029657388, -419.15131963742834, -908.1406877845142, -604.0922269364928, -1249.2693510277386, -223.38060922430932, -50.27739857649598, -60.01925820742256, -809.4232492492002, -661.364310195406, -1098.1112799427124, -471.19169382693855, -57.99460312522533, -180.17369247500017, -512.5953407321923, -872.1801333137371, -299.38853665743, -100.01467262405795], "episode_lengths": [101, 150, 150, 150, 89, 150, 91, 113, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 68, 150, 150, 150, 150, 150, 71, 82, 150, 70, 148, 150, 150, 150, 91, 110, 150, 150, 79, 150, 68, 150, 150, 150, 100, 150, 150, 150, 99, 86, 53, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 118, 150, 150, 150, 150, 132, 150, 130, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 75, 150, 150, 150, 123, 150, 150, 150, 88, 63, 66, 150, 150, 150, 139, 56, 75, 150, 150, 83, 87], "policy_policy_0_reward": [-244.0275343879863, -1245.9972021576316, -1358.0870056228923, -515.3224625607078, -253.8657714684638, -446.5454759006489, -416.8288965740695, -251.49918158290583, -605.737678767125, -1125.115848224937, -866.78788839717, -1147.7877218229637, -786.9906164745594, -990.9330199735969, -540.2433697251785, -1101.1368392811003, -216.52910246899444, -927.2691849513974, -196.33830956537838, -887.2565294131718, -412.9840633151807, -1414.6247993149545, -418.291564547345, -680.3755705333158, -146.9752120038694, -176.16757714181776, -917.6334404480654, -164.1523934163005, -545.305802536544, -872.7896713073286, -573.1824568643716, -942.2145127426395, -236.86822724109038, -408.582895469565, -769.3291030477234, -875.6490607688793, -223.47848348735425, -326.496499824874, -157.78322480450578, -1102.1947468376288, -411.64971719835495, -746.9178050598845, -451.06050940471715, -1051.0281842379172, -1337.772667557139, -1200.6067087168624, -251.60006019814455, -201.12872944771456, -48.92370537132037, -1003.063392469728, -987.4172672538417, -918.4485268958571, -1232.6345504532421, -377.12518010963714, -804.9324455023192, -586.3925115858506, -1346.7808866938037, -806.1564583023413, -970.7589906739496, -876.0036489634354, -302.0454728493832, -1081.654985669214, -913.8685196543832, -936.6035597486696, -1036.1801414419274, -805.0508615738187, -1151.470125912295, -509.9786150708324, -1268.3499966633651, -589.1225245140861, -575.079120816717, -1058.7264437729239, -1163.983844234724, -1146.8366251607208, -1132.7507793602188, -694.7241158983151, -177.0326847771912, -1202.2332365905731, -905.1233117430472, -144.3504146949523, -985.2205607291706, -1313.8460340415172, -983.5679029657388, -419.15131963742834, -908.1406877845142, -604.0922269364928, -1249.2693510277386, -223.38060922430932, -50.27739857649598, -60.01925820742256, -809.4232492492002, -661.364310195406, -1098.1112799427124, -471.19169382693855, -57.99460312522533, -180.17369247500017, -512.5953407321923, -872.1801333137371, -299.38853665743, -100.01467262405795]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556381898086338, "mean_inference_ms": 1.6799701509929525, "mean_action_processing_ms": 0.27643499155368795, "mean_env_wait_ms": 3.4721776010223806, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012120723724365234, "StateBufferConnector_ms": 0.007953405380249023, "ViewRequirementAgentConnector_ms": 0.20213055610656738}, "num_episodes": 29, "episode_return_max": -48.92370537132037, "episode_return_min": -1414.6247993149545, "episode_return_mean": -697.5434913249039, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 416.9516018792478, "num_env_steps_trained_throughput_per_sec": 416.9516018792478, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12639.011, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12638.937, "sample_time_ms": 1174.078, "learn_time_ms": 11400.009, "learn_throughput": 350.877, "synch_weights_time_ms": 64.069}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00006", "date": "2024-08-04_06-06-21", "timestamp": 1722731781, "time_this_iter_s": 9.606466293334961, "time_total_s": 318.4264943599701, "pid": 577521, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0143c70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 318.4264943599701, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 27.561538461538458, "ram_util_percent": 28.199999999999996}}
