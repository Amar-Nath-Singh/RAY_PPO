{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0892805345666905, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.58846057554086, "policy_loss": -0.010842524706580056, "vf_loss": 9.59784081975619, "vf_explained_var": 0.0483101940403382, "kl": 0.014560624992691373, "entropy": 1.4498170482615629, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -27.84695134587413, "episode_reward_min": -1240.499131027, "episode_reward_mean": -696.4359053486919, "episode_len_mean": 127.68, "episode_media": {}, "episodes_timesteps_total": 3192, "policy_reward_min": {"policy_0": -1240.499131027}, "policy_reward_max": {"policy_0": -27.84695134587413}, "policy_reward_mean": {"policy_0": -696.4359053486919}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-732.2592865681038, -1240.499131027, -280.71615365379216, -57.239810843171696, -760.9423837299913, -999.434204109884, -874.0635054149315, -1045.7891660072835, -343.87927676887676, -276.9008545010469, -770.7514581209293, -969.5061119530973, -1182.9419644355273, -879.1620337406653, -27.84695134587413, -397.686065007041, -545.1769386542849, -942.169564733821, -751.4971151225719, -1123.7486681444827, -611.8130372496461, -680.8942886909056, -884.0278571810788, -34.116717654280585, -997.8350890590114], "episode_lengths": [150, 150, 80, 57, 150, 150, 138, 150, 88, 81, 150, 150, 150, 150, 52, 122, 138, 150, 148, 150, 149, 150, 150, 39, 150], "policy_policy_0_reward": [-732.2592865681038, -1240.499131027, -280.71615365379216, -57.239810843171696, -760.9423837299913, -999.434204109884, -874.0635054149315, -1045.7891660072835, -343.87927676887676, -276.9008545010469, -770.7514581209293, -969.5061119530973, -1182.9419644355273, -879.1620337406653, -27.84695134587413, -397.686065007041, -545.1769386542849, -942.169564733821, -751.4971151225719, -1123.7486681444827, -611.8130372496461, -680.8942886909056, -884.0278571810788, -34.116717654280585, -997.8350890590114]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5679640320525773, "mean_inference_ms": 1.6786857999604323, "mean_action_processing_ms": 0.2746278424568364, "mean_env_wait_ms": 3.3997812296173646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.010999679565429688, "StateBufferConnector_ms": 0.007838249206542969, "ViewRequirementAgentConnector_ms": 0.17390823364257812}, "num_episodes": 25, "episode_return_max": -27.84695134587413, "episode_return_min": -1240.499131027, "episode_return_mean": -696.4359053486919, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.52116151772736, "num_env_steps_trained_throughput_per_sec": 306.52116151772736, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13049.68, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13049.613, "sample_time_ms": 1250.653, "learn_time_ms": 11712.302, "learn_throughput": 341.521, "synch_weights_time_ms": 85.788}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00007", "date": "2024-08-04_06-06-53", "timestamp": 1722731813, "time_this_iter_s": 13.061601877212524, "time_total_s": 13.061601877212524, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a7e20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.061601877212524, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 18.91578947368421, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.6332273576098184, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.933794941008092, "policy_loss": -0.01111829803994624, "vf_loss": 8.943422350784143, "vf_explained_var": 0.11846733819693327, "kl": 0.015281382122232878, "entropy": 1.5653923663000266, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -2.2234541192689026, "episode_reward_min": -1403.2067541131416, "episode_reward_mean": -647.2857300889272, "episode_len_mean": 118.83018867924528, "episode_media": {}, "episodes_timesteps_total": 6298, "policy_reward_min": {"policy_0": -1403.2067541131416}, "policy_reward_max": {"policy_0": -2.2234541192689026}, "policy_reward_mean": {"policy_0": -647.2857300889272}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-732.2592865681038, -1240.499131027, -280.71615365379216, -57.239810843171696, -760.9423837299913, -999.434204109884, -874.0635054149315, -1045.7891660072835, -343.87927676887676, -276.9008545010469, -770.7514581209293, -969.5061119530973, -1182.9419644355273, -879.1620337406653, -27.84695134587413, -397.686065007041, -545.1769386542849, -942.169564733821, -751.4971151225719, -1123.7486681444827, -611.8130372496461, -680.8942886909056, -884.0278571810788, -34.116717654280585, -997.8350890590114, -1123.4071223294275, -201.75182790699517, -366.5925129868034, -945.0632080373113, -293.90531046329164, -631.6285936122135, -2.2234541192689026, -1150.9794424428171, -313.8832599653444, -124.59570931915911, -94.55078368511832, -1403.2067541131416, -868.7920548042396, -561.525427688672, -829.2530188138679, -1175.382981011579, -90.67405131917964, -759.3890867968644, -1096.4510562844741, -1135.4829168170468, -1075.348645742691, -189.44060376740026, -1037.4849591654977, -78.42045642067029, -171.90060896497116, -885.8803712792866, -23.552691450443213, -264.4791516880555], "episode_lengths": [150, 150, 80, 57, 150, 150, 138, 150, 88, 81, 150, 150, 150, 150, 52, 122, 138, 150, 148, 150, 149, 150, 150, 39, 150, 150, 70, 86, 150, 77, 150, 36, 150, 100, 53, 42, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 81, 150, 44, 78, 150, 39, 93], "policy_policy_0_reward": [-732.2592865681038, -1240.499131027, -280.71615365379216, -57.239810843171696, -760.9423837299913, -999.434204109884, -874.0635054149315, -1045.7891660072835, -343.87927676887676, -276.9008545010469, -770.7514581209293, -969.5061119530973, -1182.9419644355273, -879.1620337406653, -27.84695134587413, -397.686065007041, -545.1769386542849, -942.169564733821, -751.4971151225719, -1123.7486681444827, -611.8130372496461, -680.8942886909056, -884.0278571810788, -34.116717654280585, -997.8350890590114, -1123.4071223294275, -201.75182790699517, -366.5925129868034, -945.0632080373113, -293.90531046329164, -631.6285936122135, -2.2234541192689026, -1150.9794424428171, -313.8832599653444, -124.59570931915911, -94.55078368511832, -1403.2067541131416, -868.7920548042396, -561.525427688672, -829.2530188138679, -1175.382981011579, -90.67405131917964, -759.3890867968644, -1096.4510562844741, -1135.4829168170468, -1075.348645742691, -189.44060376740026, -1037.4849591654977, -78.42045642067029, -171.90060896497116, -885.8803712792866, -23.552691450443213, -264.4791516880555]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5662883147996418, "mean_inference_ms": 1.680452604758448, "mean_action_processing_ms": 0.2773071141615544, "mean_env_wait_ms": 3.424320859622544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012798579233997274, "StateBufferConnector_ms": 0.008430570926306382, "ViewRequirementAgentConnector_ms": 0.19122519583072303}, "num_episodes": 28, "episode_return_max": -2.2234541192689026, "episode_return_min": -1403.2067541131416, "episode_return_mean": -647.2857300889272, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.3089647599573, "num_env_steps_trained_throughput_per_sec": 310.3089647599573, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12970.035, "restore_workers_time_ms": 0.024, "training_step_time_ms": 12969.971, "sample_time_ms": 1185.495, "learn_time_ms": 11707.646, "learn_throughput": 341.657, "synch_weights_time_ms": 76.012}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00007", "date": "2024-08-04_06-07-05", "timestamp": 1722731825, "time_this_iter_s": 12.901911497116089, "time_total_s": 25.963513374328613, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a5000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 25.963513374328613, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.438888888888886, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.0563439582784975, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.944121669232846, "policy_loss": -0.008162205197731965, "vf_loss": 8.951418517529964, "vf_explained_var": 0.26052889619022607, "kl": 0.012075226191973347, "entropy": 1.5496861446648835, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -2.2234541192689026, "episode_reward_min": -1403.2067541131416, "episode_reward_mean": -685.0207429822589, "episode_len_mean": 120.59302325581395, "episode_media": {}, "episodes_timesteps_total": 10371, "policy_reward_min": {"policy_0": -1403.2067541131416}, "policy_reward_max": {"policy_0": -2.2234541192689026}, "policy_reward_mean": {"policy_0": -685.0207429822589}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-732.2592865681038, -1240.499131027, -280.71615365379216, -57.239810843171696, -760.9423837299913, -999.434204109884, -874.0635054149315, -1045.7891660072835, -343.87927676887676, -276.9008545010469, -770.7514581209293, -969.5061119530973, -1182.9419644355273, -879.1620337406653, -27.84695134587413, -397.686065007041, -545.1769386542849, -942.169564733821, -751.4971151225719, -1123.7486681444827, -611.8130372496461, -680.8942886909056, -884.0278571810788, -34.116717654280585, -997.8350890590114, -1123.4071223294275, -201.75182790699517, -366.5925129868034, -945.0632080373113, -293.90531046329164, -631.6285936122135, -2.2234541192689026, -1150.9794424428171, -313.8832599653444, -124.59570931915911, -94.55078368511832, -1403.2067541131416, -868.7920548042396, -561.525427688672, -829.2530188138679, -1175.382981011579, -90.67405131917964, -759.3890867968644, -1096.4510562844741, -1135.4829168170468, -1075.348645742691, -189.44060376740026, -1037.4849591654977, -78.42045642067029, -171.90060896497116, -885.8803712792866, -23.552691450443213, -264.4791516880555, -1392.1430313705296, -1049.1640603715027, -1135.3464103941762, -1280.9152589621322, -828.1500691801408, -1293.851296800328, -169.55830983935792, -945.613273429107, -789.6062983372805, -87.15083436631913, -267.555744623839, -268.85743558903977, -296.18552488922677, -403.0769033718648, -1086.1616453019274, -1186.103000495324, -1061.212159881537, -23.366399217869883, -1093.460789529835, -116.92133083256667, -205.28129972550113, -997.1994534963504, -992.3344007614771, -1224.9003721940944, -124.85888283430036, -1089.3671433640288, -1003.5857058593625, -900.7586125613888, -108.72695911478307, -391.6741385677109, -854.8997911727082, -1013.0215458691871, -924.6321194563371], "episode_lengths": [150, 150, 80, 57, 150, 150, 138, 150, 88, 81, 150, 150, 150, 150, 52, 122, 138, 150, 148, 150, 149, 150, 150, 39, 150, 150, 70, 86, 150, 77, 150, 36, 150, 100, 53, 42, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 81, 150, 44, 78, 150, 39, 93, 150, 150, 150, 150, 145, 150, 69, 150, 139, 61, 100, 103, 109, 96, 150, 150, 150, 53, 150, 51, 73, 150, 150, 150, 59, 150, 150, 150, 70, 95, 150, 150, 150], "policy_policy_0_reward": [-732.2592865681038, -1240.499131027, -280.71615365379216, -57.239810843171696, -760.9423837299913, -999.434204109884, -874.0635054149315, -1045.7891660072835, -343.87927676887676, -276.9008545010469, -770.7514581209293, -969.5061119530973, -1182.9419644355273, -879.1620337406653, -27.84695134587413, -397.686065007041, -545.1769386542849, -942.169564733821, -751.4971151225719, -1123.7486681444827, -611.8130372496461, -680.8942886909056, -884.0278571810788, -34.116717654280585, -997.8350890590114, -1123.4071223294275, -201.75182790699517, -366.5925129868034, -945.0632080373113, -293.90531046329164, -631.6285936122135, -2.2234541192689026, -1150.9794424428171, -313.8832599653444, -124.59570931915911, -94.55078368511832, -1403.2067541131416, -868.7920548042396, -561.525427688672, -829.2530188138679, -1175.382981011579, -90.67405131917964, -759.3890867968644, -1096.4510562844741, -1135.4829168170468, -1075.348645742691, -189.44060376740026, -1037.4849591654977, -78.42045642067029, -171.90060896497116, -885.8803712792866, -23.552691450443213, -264.4791516880555, -1392.1430313705296, -1049.1640603715027, -1135.3464103941762, -1280.9152589621322, -828.1500691801408, -1293.851296800328, -169.55830983935792, -945.613273429107, -789.6062983372805, -87.15083436631913, -267.555744623839, -268.85743558903977, -296.18552488922677, -403.0769033718648, -1086.1616453019274, -1186.103000495324, -1061.212159881537, -23.366399217869883, -1093.460789529835, -116.92133083256667, -205.28129972550113, -997.1994534963504, -992.3344007614771, -1224.9003721940944, -124.85888283430036, -1089.3671433640288, -1003.5857058593625, -900.7586125613888, -108.72695911478307, -391.6741385677109, -854.8997911727082, -1013.0215458691871, -924.6321194563371]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.564965496294853, "mean_inference_ms": 1.680668555318168, "mean_action_processing_ms": 0.2784722517272255, "mean_env_wait_ms": 3.441170377221796, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01262509545614553, "StateBufferConnector_ms": 0.008544256520825763, "ViewRequirementAgentConnector_ms": 0.19279552060504293}, "num_episodes": 33, "episode_return_max": -2.2234541192689026, "episode_return_min": -1403.2067541131416, "episode_return_mean": -685.0207429822589, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.4588839035557, "num_env_steps_trained_throughput_per_sec": 303.4588839035557, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13040.48, "restore_workers_time_ms": 0.024, "training_step_time_ms": 13040.416, "sample_time_ms": 1170.54, "learn_time_ms": 11799.225, "learn_throughput": 339.005, "synch_weights_time_ms": 69.856}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00007", "date": "2024-08-04_06-07-19", "timestamp": 1722731839, "time_this_iter_s": 13.193415641784668, "time_total_s": 39.15692901611328, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0142c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.15692901611328, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.86315789473684, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.078357599427303, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.15682341704766, "policy_loss": -0.00512824207447314, "vf_loss": 7.160483572880427, "vf_explained_var": 0.5775147819270691, "kl": 0.015032958569978898, "entropy": 1.538483719403545, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -2.2234541192689026, "episode_reward_min": -1403.2067541131416, "episode_reward_mean": -684.2544801945332, "episode_len_mean": 119.25, "episode_media": {}, "episodes_timesteps_total": 11925, "policy_reward_min": {"policy_0": -1403.2067541131416}, "policy_reward_max": {"policy_0": -2.2234541192689026}, "policy_reward_mean": {"policy_0": -684.2544801945332}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-680.8942886909056, -884.0278571810788, -34.116717654280585, -997.8350890590114, -1123.4071223294275, -201.75182790699517, -366.5925129868034, -945.0632080373113, -293.90531046329164, -631.6285936122135, -2.2234541192689026, -1150.9794424428171, -313.8832599653444, -124.59570931915911, -94.55078368511832, -1403.2067541131416, -868.7920548042396, -561.525427688672, -829.2530188138679, -1175.382981011579, -90.67405131917964, -759.3890867968644, -1096.4510562844741, -1135.4829168170468, -1075.348645742691, -189.44060376740026, -1037.4849591654977, -78.42045642067029, -171.90060896497116, -885.8803712792866, -23.552691450443213, -264.4791516880555, -1392.1430313705296, -1049.1640603715027, -1135.3464103941762, -1280.9152589621322, -828.1500691801408, -1293.851296800328, -169.55830983935792, -945.613273429107, -789.6062983372805, -87.15083436631913, -267.555744623839, -268.85743558903977, -296.18552488922677, -403.0769033718648, -1086.1616453019274, -1186.103000495324, -1061.212159881537, -23.366399217869883, -1093.460789529835, -116.92133083256667, -205.28129972550113, -997.1994534963504, -992.3344007614771, -1224.9003721940944, -124.85888283430036, -1089.3671433640288, -1003.5857058593625, -900.7586125613888, -108.72695911478307, -391.6741385677109, -854.8997911727082, -1013.0215458691871, -924.6321194563371, -231.01729624267983, -859.306437294634, -235.7892386527111, -485.5367424467666, -822.898571070937, -1122.0065180308102, -1144.0249534951374, -181.98659689135496, -766.9675809111794, -15.005168243569068, -132.748448804547, -757.5360518118355, -1105.4095692235753, -987.7002265382772, -1038.0428211404762, -959.6887648425958, -1263.6213185490994, -99.15609323898215, -1152.9003217584725, -1129.279131620842, -395.4839353464584, -94.80168432190295, -358.6241262514611, -1283.8999926516308, -1217.6454626791804, -748.7915537802198, -998.7168075608364, -269.0774132973751, -317.8787286172709, -920.068103501759, -1016.3889670188134, -779.6607479388366, -17.872578913493015, -65.69213209009757, -1352.4637193332724], "episode_lengths": [150, 150, 39, 150, 150, 70, 86, 150, 77, 150, 36, 150, 100, 53, 42, 150, 150, 150, 150, 150, 57, 150, 150, 150, 150, 81, 150, 44, 78, 150, 39, 93, 150, 150, 150, 150, 145, 150, 69, 150, 139, 61, 100, 103, 109, 96, 150, 150, 150, 53, 150, 51, 73, 150, 150, 150, 59, 150, 150, 150, 70, 95, 150, 150, 150, 75, 150, 65, 150, 150, 150, 150, 80, 150, 42, 79, 150, 150, 150, 150, 150, 150, 74, 150, 150, 102, 59, 94, 150, 150, 150, 150, 106, 87, 150, 150, 150, 38, 56, 150], "policy_policy_0_reward": [-680.8942886909056, -884.0278571810788, -34.116717654280585, -997.8350890590114, -1123.4071223294275, -201.75182790699517, -366.5925129868034, -945.0632080373113, -293.90531046329164, -631.6285936122135, -2.2234541192689026, -1150.9794424428171, -313.8832599653444, -124.59570931915911, -94.55078368511832, -1403.2067541131416, -868.7920548042396, -561.525427688672, -829.2530188138679, -1175.382981011579, -90.67405131917964, -759.3890867968644, -1096.4510562844741, -1135.4829168170468, -1075.348645742691, -189.44060376740026, -1037.4849591654977, -78.42045642067029, -171.90060896497116, -885.8803712792866, -23.552691450443213, -264.4791516880555, -1392.1430313705296, -1049.1640603715027, -1135.3464103941762, -1280.9152589621322, -828.1500691801408, -1293.851296800328, -169.55830983935792, -945.613273429107, -789.6062983372805, -87.15083436631913, -267.555744623839, -268.85743558903977, -296.18552488922677, -403.0769033718648, -1086.1616453019274, -1186.103000495324, -1061.212159881537, -23.366399217869883, -1093.460789529835, -116.92133083256667, -205.28129972550113, -997.1994534963504, -992.3344007614771, -1224.9003721940944, -124.85888283430036, -1089.3671433640288, -1003.5857058593625, -900.7586125613888, -108.72695911478307, -391.6741385677109, -854.8997911727082, -1013.0215458691871, -924.6321194563371, -231.01729624267983, -859.306437294634, -235.7892386527111, -485.5367424467666, -822.898571070937, -1122.0065180308102, -1144.0249534951374, -181.98659689135496, -766.9675809111794, -15.005168243569068, -132.748448804547, -757.5360518118355, -1105.4095692235753, -987.7002265382772, -1038.0428211404762, -959.6887648425958, -1263.6213185490994, -99.15609323898215, -1152.9003217584725, -1129.279131620842, -395.4839353464584, -94.80168432190295, -358.6241262514611, -1283.8999926516308, -1217.6454626791804, -748.7915537802198, -998.7168075608364, -269.0774132973751, -317.8787286172709, -920.068103501759, -1016.3889670188134, -779.6607479388366, -17.872578913493015, -65.69213209009757, -1352.4637193332724]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5632367224628628, "mean_inference_ms": 1.6893378314781196, "mean_action_processing_ms": 0.28051754180285843, "mean_env_wait_ms": 3.4788145154596526, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013607263565063477, "StateBufferConnector_ms": 0.008945465087890625, "ViewRequirementAgentConnector_ms": 0.2027606964111328}, "num_episodes": 35, "episode_return_max": -2.2234541192689026, "episode_return_min": -1403.2067541131416, "episode_return_mean": -684.2544801945332, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.88117623111964, "num_env_steps_trained_throughput_per_sec": 306.88117623111964, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13038.953, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13038.889, "sample_time_ms": 1163.406, "learn_time_ms": 11803.604, "learn_throughput": 338.88, "synch_weights_time_ms": 71.092}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00007", "date": "2024-08-04_06-07-32", "timestamp": 1722731852, "time_this_iter_s": 13.046554565429688, "time_total_s": 52.20348358154297, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0112dd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.20348358154297, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.978947368421053, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 46.448859787980716, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.17642131994168, "policy_loss": -0.007654130599500301, "vf_loss": 6.182714355488618, "vf_explained_var": 0.7588577451184392, "kl": 0.014456123507018977, "entropy": 1.5301503978669644, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -15.005168243569068, "episode_reward_min": -1392.1430313705296, "episode_reward_mean": -714.7871029597442, "episode_len_mean": 123.18, "episode_media": {}, "episodes_timesteps_total": 12318, "policy_reward_min": {"policy_0": -1392.1430313705296}, "policy_reward_max": {"policy_0": -15.005168243569068}, "policy_reward_mean": {"policy_0": -714.7871029597442}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-885.8803712792866, -23.552691450443213, -264.4791516880555, -1392.1430313705296, -1049.1640603715027, -1135.3464103941762, -1280.9152589621322, -828.1500691801408, -1293.851296800328, -169.55830983935792, -945.613273429107, -789.6062983372805, -87.15083436631913, -267.555744623839, -268.85743558903977, -296.18552488922677, -403.0769033718648, -1086.1616453019274, -1186.103000495324, -1061.212159881537, -23.366399217869883, -1093.460789529835, -116.92133083256667, -205.28129972550113, -997.1994534963504, -992.3344007614771, -1224.9003721940944, -124.85888283430036, -1089.3671433640288, -1003.5857058593625, -900.7586125613888, -108.72695911478307, -391.6741385677109, -854.8997911727082, -1013.0215458691871, -924.6321194563371, -231.01729624267983, -859.306437294634, -235.7892386527111, -485.5367424467666, -822.898571070937, -1122.0065180308102, -1144.0249534951374, -181.98659689135496, -766.9675809111794, -15.005168243569068, -132.748448804547, -757.5360518118355, -1105.4095692235753, -987.7002265382772, -1038.0428211404762, -959.6887648425958, -1263.6213185490994, -99.15609323898215, -1152.9003217584725, -1129.279131620842, -395.4839353464584, -94.80168432190295, -358.6241262514611, -1283.8999926516308, -1217.6454626791804, -748.7915537802198, -998.7168075608364, -269.0774132973751, -317.8787286172709, -920.068103501759, -1016.3889670188134, -779.6607479388366, -17.872578913493015, -65.69213209009757, -1352.4637193332724, -140.1623291398645, -1024.3349194955865, -406.7258202668584, -1029.4762015214, -489.60318089531563, -1138.6726512136806, -946.2544013995124, -920.1952645437927, -486.0526958093422, -658.1745490368091, -1192.7804090286352, -149.99831232783396, -466.3504869469781, -675.7548837043745, -481.2387302148728, -851.5579212419835, -1322.7542863333877, -664.4492375842597, -801.6296052958035, -1154.3680692289868, -1158.5491891687943, -25.342150603859697, -808.7276205465135, -1126.990987600152, -155.97707345977864, -285.67989244070526, -391.6910939372965, -1215.4345482703848, -1202.543564427662], "episode_lengths": [150, 39, 93, 150, 150, 150, 150, 145, 150, 69, 150, 139, 61, 100, 103, 109, 96, 150, 150, 150, 53, 150, 51, 73, 150, 150, 150, 59, 150, 150, 150, 70, 95, 150, 150, 150, 75, 150, 65, 150, 150, 150, 150, 80, 150, 42, 79, 150, 150, 150, 150, 150, 150, 74, 150, 150, 102, 59, 94, 150, 150, 150, 150, 106, 87, 150, 150, 150, 38, 56, 150, 62, 150, 96, 150, 150, 150, 150, 150, 150, 136, 150, 55, 101, 127, 111, 136, 150, 150, 150, 150, 150, 39, 139, 150, 63, 91, 150, 150, 150], "policy_policy_0_reward": [-885.8803712792866, -23.552691450443213, -264.4791516880555, -1392.1430313705296, -1049.1640603715027, -1135.3464103941762, -1280.9152589621322, -828.1500691801408, -1293.851296800328, -169.55830983935792, -945.613273429107, -789.6062983372805, -87.15083436631913, -267.555744623839, -268.85743558903977, -296.18552488922677, -403.0769033718648, -1086.1616453019274, -1186.103000495324, -1061.212159881537, -23.366399217869883, -1093.460789529835, -116.92133083256667, -205.28129972550113, -997.1994534963504, -992.3344007614771, -1224.9003721940944, -124.85888283430036, -1089.3671433640288, -1003.5857058593625, -900.7586125613888, -108.72695911478307, -391.6741385677109, -854.8997911727082, -1013.0215458691871, -924.6321194563371, -231.01729624267983, -859.306437294634, -235.7892386527111, -485.5367424467666, -822.898571070937, -1122.0065180308102, -1144.0249534951374, -181.98659689135496, -766.9675809111794, -15.005168243569068, -132.748448804547, -757.5360518118355, -1105.4095692235753, -987.7002265382772, -1038.0428211404762, -959.6887648425958, -1263.6213185490994, -99.15609323898215, -1152.9003217584725, -1129.279131620842, -395.4839353464584, -94.80168432190295, -358.6241262514611, -1283.8999926516308, -1217.6454626791804, -748.7915537802198, -998.7168075608364, -269.0774132973751, -317.8787286172709, -920.068103501759, -1016.3889670188134, -779.6607479388366, -17.872578913493015, -65.69213209009757, -1352.4637193332724, -140.1623291398645, -1024.3349194955865, -406.7258202668584, -1029.4762015214, -489.60318089531563, -1138.6726512136806, -946.2544013995124, -920.1952645437927, -486.0526958093422, -658.1745490368091, -1192.7804090286352, -149.99831232783396, -466.3504869469781, -675.7548837043745, -481.2387302148728, -851.5579212419835, -1322.7542863333877, -664.4492375842597, -801.6296052958035, -1154.3680692289868, -1158.5491891687943, -25.342150603859697, -808.7276205465135, -1126.990987600152, -155.97707345977864, -285.67989244070526, -391.6910939372965, -1215.4345482703848, -1202.543564427662]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5621300055912036, "mean_inference_ms": 1.6885114386939182, "mean_action_processing_ms": 0.28089047259820377, "mean_env_wait_ms": 3.486507648878687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013047456741333008, "StateBufferConnector_ms": 0.008901596069335938, "ViewRequirementAgentConnector_ms": 0.19858598709106445}, "num_episodes": 29, "episode_return_max": -15.005168243569068, "episode_return_min": -1392.1430313705296, "episode_return_mean": -714.7871029597442, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.61955221349746, "num_env_steps_trained_throughput_per_sec": 307.61955221349746, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13031.78, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13031.715, "sample_time_ms": 1161.466, "learn_time_ms": 11796.827, "learn_throughput": 339.074, "synch_weights_time_ms": 72.626}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00007", "date": "2024-08-04_06-07-45", "timestamp": 1722731865, "time_this_iter_s": 13.016716718673706, "time_total_s": 65.22020030021667, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a5000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 65.22020030021667, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.349999999999998, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 69.7255936096112, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.625617280602455, "policy_loss": -0.010499005454281967, "vf_loss": 5.634346649795771, "vf_explained_var": 0.8340018281092246, "kl": 0.016280842601357412, "entropy": 1.4865458933015665, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -15.005168243569068, "episode_reward_min": -1352.4637193332724, "episode_reward_mean": -707.8206211037697, "episode_len_mean": 125.02, "episode_media": {}, "episodes_timesteps_total": 12502, "policy_reward_min": {"policy_0": -1352.4637193332724}, "policy_reward_max": {"policy_0": -15.005168243569068}, "policy_reward_mean": {"policy_0": -707.8206211037697}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-108.72695911478307, -391.6741385677109, -854.8997911727082, -1013.0215458691871, -924.6321194563371, -231.01729624267983, -859.306437294634, -235.7892386527111, -485.5367424467666, -822.898571070937, -1122.0065180308102, -1144.0249534951374, -181.98659689135496, -766.9675809111794, -15.005168243569068, -132.748448804547, -757.5360518118355, -1105.4095692235753, -987.7002265382772, -1038.0428211404762, -959.6887648425958, -1263.6213185490994, -99.15609323898215, -1152.9003217584725, -1129.279131620842, -395.4839353464584, -94.80168432190295, -358.6241262514611, -1283.8999926516308, -1217.6454626791804, -748.7915537802198, -998.7168075608364, -269.0774132973751, -317.8787286172709, -920.068103501759, -1016.3889670188134, -779.6607479388366, -17.872578913493015, -65.69213209009757, -1352.4637193332724, -140.1623291398645, -1024.3349194955865, -406.7258202668584, -1029.4762015214, -489.60318089531563, -1138.6726512136806, -946.2544013995124, -920.1952645437927, -486.0526958093422, -658.1745490368091, -1192.7804090286352, -149.99831232783396, -466.3504869469781, -675.7548837043745, -481.2387302148728, -851.5579212419835, -1322.7542863333877, -664.4492375842597, -801.6296052958035, -1154.3680692289868, -1158.5491891687943, -25.342150603859697, -808.7276205465135, -1126.990987600152, -155.97707345977864, -285.67989244070526, -391.6910939372965, -1215.4345482703848, -1202.543564427662, -953.9581696629873, -787.6108953182707, -538.9368388819123, -953.9071837670845, -1148.0063798561016, -763.1082550936891, -821.4847607103413, -149.14137501974403, -514.5508865568352, -139.24951140681497, -1247.5280213386102, -383.5756194144214, -885.7508784386357, -379.05917790681593, -610.611937911748, -941.5125990978225, -344.4513383411524, -53.15865902860122, -107.43509375441407, -936.9092497135952, -969.0951084010832, -87.41512030250479, -1269.3582765499484, -870.204277787221, -275.73499395433487, -984.8780146344952, -324.595264707788, -831.4539060113431, -1232.0887871168925, -1020.7730972785206, -1264.4059984369765], "episode_lengths": [70, 95, 150, 150, 150, 75, 150, 65, 150, 150, 150, 150, 80, 150, 42, 79, 150, 150, 150, 150, 150, 150, 74, 150, 150, 102, 59, 94, 150, 150, 150, 150, 106, 87, 150, 150, 150, 38, 56, 150, 62, 150, 96, 150, 150, 150, 150, 150, 150, 136, 150, 55, 101, 127, 111, 136, 150, 150, 150, 150, 150, 39, 139, 150, 63, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 71, 150, 86, 150, 150, 133, 150, 98, 54, 55, 150, 150, 58, 150, 150, 77, 150, 82, 150, 150, 150, 150], "policy_policy_0_reward": [-108.72695911478307, -391.6741385677109, -854.8997911727082, -1013.0215458691871, -924.6321194563371, -231.01729624267983, -859.306437294634, -235.7892386527111, -485.5367424467666, -822.898571070937, -1122.0065180308102, -1144.0249534951374, -181.98659689135496, -766.9675809111794, -15.005168243569068, -132.748448804547, -757.5360518118355, -1105.4095692235753, -987.7002265382772, -1038.0428211404762, -959.6887648425958, -1263.6213185490994, -99.15609323898215, -1152.9003217584725, -1129.279131620842, -395.4839353464584, -94.80168432190295, -358.6241262514611, -1283.8999926516308, -1217.6454626791804, -748.7915537802198, -998.7168075608364, -269.0774132973751, -317.8787286172709, -920.068103501759, -1016.3889670188134, -779.6607479388366, -17.872578913493015, -65.69213209009757, -1352.4637193332724, -140.1623291398645, -1024.3349194955865, -406.7258202668584, -1029.4762015214, -489.60318089531563, -1138.6726512136806, -946.2544013995124, -920.1952645437927, -486.0526958093422, -658.1745490368091, -1192.7804090286352, -149.99831232783396, -466.3504869469781, -675.7548837043745, -481.2387302148728, -851.5579212419835, -1322.7542863333877, -664.4492375842597, -801.6296052958035, -1154.3680692289868, -1158.5491891687943, -25.342150603859697, -808.7276205465135, -1126.990987600152, -155.97707345977864, -285.67989244070526, -391.6910939372965, -1215.4345482703848, -1202.543564427662, -953.9581696629873, -787.6108953182707, -538.9368388819123, -953.9071837670845, -1148.0063798561016, -763.1082550936891, -821.4847607103413, -149.14137501974403, -514.5508865568352, -139.24951140681497, -1247.5280213386102, -383.5756194144214, -885.7508784386357, -379.05917790681593, -610.611937911748, -941.5125990978225, -344.4513383411524, -53.15865902860122, -107.43509375441407, -936.9092497135952, -969.0951084010832, -87.41512030250479, -1269.3582765499484, -870.204277787221, -275.73499395433487, -984.8780146344952, -324.595264707788, -831.4539060113431, -1232.0887871168925, -1020.7730972785206, -1264.4059984369765]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5623591484588346, "mean_inference_ms": 1.6896999037139444, "mean_action_processing_ms": 0.2808798640561433, "mean_env_wait_ms": 3.4938342248653513, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013119220733642578, "StateBufferConnector_ms": 0.008867263793945312, "ViewRequirementAgentConnector_ms": 0.2011713981628418}, "num_episodes": 31, "episode_return_max": -15.005168243569068, "episode_return_min": -1352.4637193332724, "episode_return_mean": -707.8206211037697, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.7117357268691, "num_env_steps_trained_throughput_per_sec": 301.7117357268691, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 13069.433, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13069.366, "sample_time_ms": 1155.159, "learn_time_ms": 11842.862, "learn_throughput": 337.756, "synch_weights_time_ms": 70.555}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00007", "date": "2024-08-04_06-07-58", "timestamp": 1722731878, "time_this_iter_s": 13.269118547439575, "time_total_s": 78.48931884765625, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01a6b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 78.48931884765625, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.852631578947364, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 92.00044794281324, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.681076972186565, "policy_loss": -0.012199046241585165, "vf_loss": 4.690924802919229, "vf_explained_var": 0.8642986983681719, "kl": 0.018470498696281843, "entropy": 1.3428668193519115, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -17.872578913493015, "episode_reward_min": -1352.4637193332724, "episode_reward_mean": -703.7961385339123, "episode_len_mean": 126.9, "episode_media": {}, "episodes_timesteps_total": 12690, "policy_reward_min": {"policy_0": -1352.4637193332724}, "policy_reward_max": {"policy_0": -17.872578913493015}, "policy_reward_mean": {"policy_0": -703.7961385339123}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-317.8787286172709, -920.068103501759, -1016.3889670188134, -779.6607479388366, -17.872578913493015, -65.69213209009757, -1352.4637193332724, -140.1623291398645, -1024.3349194955865, -406.7258202668584, -1029.4762015214, -489.60318089531563, -1138.6726512136806, -946.2544013995124, -920.1952645437927, -486.0526958093422, -658.1745490368091, -1192.7804090286352, -149.99831232783396, -466.3504869469781, -675.7548837043745, -481.2387302148728, -851.5579212419835, -1322.7542863333877, -664.4492375842597, -801.6296052958035, -1154.3680692289868, -1158.5491891687943, -25.342150603859697, -808.7276205465135, -1126.990987600152, -155.97707345977864, -285.67989244070526, -391.6910939372965, -1215.4345482703848, -1202.543564427662, -953.9581696629873, -787.6108953182707, -538.9368388819123, -953.9071837670845, -1148.0063798561016, -763.1082550936891, -821.4847607103413, -149.14137501974403, -514.5508865568352, -139.24951140681497, -1247.5280213386102, -383.5756194144214, -885.7508784386357, -379.05917790681593, -610.611937911748, -941.5125990978225, -344.4513383411524, -53.15865902860122, -107.43509375441407, -936.9092497135952, -969.0951084010832, -87.41512030250479, -1269.3582765499484, -870.204277787221, -275.73499395433487, -984.8780146344952, -324.595264707788, -831.4539060113431, -1232.0887871168925, -1020.7730972785206, -1264.4059984369765, -930.488979231747, -856.3552707557241, -1074.1313315474572, -214.71494262240458, -225.98711681277956, -501.01677158126245, -1072.6257617991353, -796.4092101943679, -378.67714405379996, -1035.2497455929908, -374.15616364127783, -1084.2016424972965, -768.7890401801259, -517.2978111946989, -1091.6558621998402, -809.7319662762375, -473.0888178921559, -1323.6228728673527, -395.54268224921515, -878.4331729330437, -1075.4685565962488, -268.862323387095, -476.0825432947783, -277.906789631344, -1336.4828658196896, -58.37771367897575, -491.27756298861124, -919.4678988609239, -636.6317255454954, -105.45888305185952, -207.59858083807308, -1005.209964365611, -1087.167409710931], "episode_lengths": [87, 150, 150, 150, 38, 56, 150, 62, 150, 96, 150, 150, 150, 150, 150, 150, 136, 150, 55, 101, 127, 111, 136, 150, 150, 150, 150, 150, 39, 139, 150, 63, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 71, 150, 86, 150, 150, 133, 150, 98, 54, 55, 150, 150, 58, 150, 150, 77, 150, 82, 150, 150, 150, 150, 150, 150, 150, 98, 85, 150, 150, 150, 128, 150, 120, 150, 150, 139, 150, 142, 150, 150, 106, 150, 150, 104, 104, 105, 150, 45, 150, 150, 131, 57, 65, 150, 150], "policy_policy_0_reward": [-317.8787286172709, -920.068103501759, -1016.3889670188134, -779.6607479388366, -17.872578913493015, -65.69213209009757, -1352.4637193332724, -140.1623291398645, -1024.3349194955865, -406.7258202668584, -1029.4762015214, -489.60318089531563, -1138.6726512136806, -946.2544013995124, -920.1952645437927, -486.0526958093422, -658.1745490368091, -1192.7804090286352, -149.99831232783396, -466.3504869469781, -675.7548837043745, -481.2387302148728, -851.5579212419835, -1322.7542863333877, -664.4492375842597, -801.6296052958035, -1154.3680692289868, -1158.5491891687943, -25.342150603859697, -808.7276205465135, -1126.990987600152, -155.97707345977864, -285.67989244070526, -391.6910939372965, -1215.4345482703848, -1202.543564427662, -953.9581696629873, -787.6108953182707, -538.9368388819123, -953.9071837670845, -1148.0063798561016, -763.1082550936891, -821.4847607103413, -149.14137501974403, -514.5508865568352, -139.24951140681497, -1247.5280213386102, -383.5756194144214, -885.7508784386357, -379.05917790681593, -610.611937911748, -941.5125990978225, -344.4513383411524, -53.15865902860122, -107.43509375441407, -936.9092497135952, -969.0951084010832, -87.41512030250479, -1269.3582765499484, -870.204277787221, -275.73499395433487, -984.8780146344952, -324.595264707788, -831.4539060113431, -1232.0887871168925, -1020.7730972785206, -1264.4059984369765, -930.488979231747, -856.3552707557241, -1074.1313315474572, -214.71494262240458, -225.98711681277956, -501.01677158126245, -1072.6257617991353, -796.4092101943679, -378.67714405379996, -1035.2497455929908, -374.15616364127783, -1084.2016424972965, -768.7890401801259, -517.2978111946989, -1091.6558621998402, -809.7319662762375, -473.0888178921559, -1323.6228728673527, -395.54268224921515, -878.4331729330437, -1075.4685565962488, -268.862323387095, -476.0825432947783, -277.906789631344, -1336.4828658196896, -58.37771367897575, -491.27756298861124, -919.4678988609239, -636.6317255454954, -105.45888305185952, -207.59858083807308, -1005.209964365611, -1087.167409710931]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5617488278773856, "mean_inference_ms": 1.6888727508834998, "mean_action_processing_ms": 0.28019492915300437, "mean_env_wait_ms": 3.4925673614423287, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012509346008300781, "StateBufferConnector_ms": 0.008609771728515625, "ViewRequirementAgentConnector_ms": 0.19951176643371582}, "num_episodes": 33, "episode_return_max": -17.872578913493015, "episode_return_min": -1352.4637193332724, "episode_return_mean": -703.7961385339123, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 370.7425019084364, "num_env_steps_trained_throughput_per_sec": 370.7425019084364, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12743.682, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12743.614, "sample_time_ms": 1153.343, "learn_time_ms": 11520.83, "learn_throughput": 347.197, "synch_weights_time_ms": 68.633}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00007", "date": "2024-08-04_06-08-09", "timestamp": 1722731889, "time_this_iter_s": 10.802915573120117, "time_total_s": 89.29223442077637, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0143d00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 89.29223442077637, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 19.04375, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107.17794992625713, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.277947829663754, "policy_loss": -0.011903748305727883, "vf_loss": 4.287006585548322, "vf_explained_var": 0.9031520103414853, "kl": 0.02126454390336221, "entropy": 1.4079229799409707, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -53.15865902860122, "episode_reward_min": -1384.9934734656172, "episode_reward_mean": -721.1424367312674, "episode_len_mean": 132.11, "episode_media": {}, "episodes_timesteps_total": 13211, "policy_reward_min": {"policy_0": -1384.9934734656172}, "policy_reward_max": {"policy_0": -53.15865902860122}, "policy_reward_mean": {"policy_0": -721.1424367312674}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-808.7276205465135, -1126.990987600152, -155.97707345977864, -285.67989244070526, -391.6910939372965, -1215.4345482703848, -1202.543564427662, -953.9581696629873, -787.6108953182707, -538.9368388819123, -953.9071837670845, -1148.0063798561016, -763.1082550936891, -821.4847607103413, -149.14137501974403, -514.5508865568352, -139.24951140681497, -1247.5280213386102, -383.5756194144214, -885.7508784386357, -379.05917790681593, -610.611937911748, -941.5125990978225, -344.4513383411524, -53.15865902860122, -107.43509375441407, -936.9092497135952, -969.0951084010832, -87.41512030250479, -1269.3582765499484, -870.204277787221, -275.73499395433487, -984.8780146344952, -324.595264707788, -831.4539060113431, -1232.0887871168925, -1020.7730972785206, -1264.4059984369765, -930.488979231747, -856.3552707557241, -1074.1313315474572, -214.71494262240458, -225.98711681277956, -501.01677158126245, -1072.6257617991353, -796.4092101943679, -378.67714405379996, -1035.2497455929908, -374.15616364127783, -1084.2016424972965, -768.7890401801259, -517.2978111946989, -1091.6558621998402, -809.7319662762375, -473.0888178921559, -1323.6228728673527, -395.54268224921515, -878.4331729330437, -1075.4685565962488, -268.862323387095, -476.0825432947783, -277.906789631344, -1336.4828658196896, -58.37771367897575, -491.27756298861124, -919.4678988609239, -636.6317255454954, -105.45888305185952, -207.59858083807308, -1005.209964365611, -1087.167409710931, -823.7861326680543, -978.6729608268628, -722.8485957753358, -1039.2993065021103, -1129.198312339678, -867.735076317301, -717.2135076817236, -765.1957433367403, -1094.769681749592, -764.6645596095437, -878.0240006977759, -319.4591399951141, -367.4678478197359, -527.5632036238906, -798.9056763333078, -599.3395781453324, -1123.7467253433351, -544.3048569332539, -877.3885446796133, -824.4712046579573, -515.7326394093067, -1384.9934734656172, -845.7338560224716, -626.2679858625509, -354.9266871089771, -501.7548986147654, -1213.4292884539032, -250.65714875464158, -931.5294594224981], "episode_lengths": [139, 150, 63, 91, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 60, 150, 71, 150, 86, 150, 150, 133, 150, 98, 54, 55, 150, 150, 58, 150, 150, 77, 150, 82, 150, 150, 150, 150, 150, 150, 150, 98, 85, 150, 150, 150, 128, 150, 120, 150, 150, 139, 150, 142, 150, 150, 106, 150, 150, 104, 104, 105, 150, 45, 150, 150, 131, 57, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 114, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 69, 150], "policy_policy_0_reward": [-808.7276205465135, -1126.990987600152, -155.97707345977864, -285.67989244070526, -391.6910939372965, -1215.4345482703848, -1202.543564427662, -953.9581696629873, -787.6108953182707, -538.9368388819123, -953.9071837670845, -1148.0063798561016, -763.1082550936891, -821.4847607103413, -149.14137501974403, -514.5508865568352, -139.24951140681497, -1247.5280213386102, -383.5756194144214, -885.7508784386357, -379.05917790681593, -610.611937911748, -941.5125990978225, -344.4513383411524, -53.15865902860122, -107.43509375441407, -936.9092497135952, -969.0951084010832, -87.41512030250479, -1269.3582765499484, -870.204277787221, -275.73499395433487, -984.8780146344952, -324.595264707788, -831.4539060113431, -1232.0887871168925, -1020.7730972785206, -1264.4059984369765, -930.488979231747, -856.3552707557241, -1074.1313315474572, -214.71494262240458, -225.98711681277956, -501.01677158126245, -1072.6257617991353, -796.4092101943679, -378.67714405379996, -1035.2497455929908, -374.15616364127783, -1084.2016424972965, -768.7890401801259, -517.2978111946989, -1091.6558621998402, -809.7319662762375, -473.0888178921559, -1323.6228728673527, -395.54268224921515, -878.4331729330437, -1075.4685565962488, -268.862323387095, -476.0825432947783, -277.906789631344, -1336.4828658196896, -58.37771367897575, -491.27756298861124, -919.4678988609239, -636.6317255454954, -105.45888305185952, -207.59858083807308, -1005.209964365611, -1087.167409710931, -823.7861326680543, -978.6729608268628, -722.8485957753358, -1039.2993065021103, -1129.198312339678, -867.735076317301, -717.2135076817236, -765.1957433367403, -1094.769681749592, -764.6645596095437, -878.0240006977759, -319.4591399951141, -367.4678478197359, -527.5632036238906, -798.9056763333078, -599.3395781453324, -1123.7467253433351, -544.3048569332539, -877.3885446796133, -824.4712046579573, -515.7326394093067, -1384.9934734656172, -845.7338560224716, -626.2679858625509, -354.9266871089771, -501.7548986147654, -1213.4292884539032, -250.65714875464158, -931.5294594224981]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5609511958013895, "mean_inference_ms": 1.6865972488965708, "mean_action_processing_ms": 0.2796761875276932, "mean_env_wait_ms": 3.484514336283143, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012264728546142578, "StateBufferConnector_ms": 0.008268117904663086, "ViewRequirementAgentConnector_ms": 0.1964259147644043}, "num_episodes": 29, "episode_return_max": -53.15865902860122, "episode_return_min": -1384.9934734656172, "episode_return_mean": -721.1424367312674, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.57880590230576, "num_env_steps_trained_throughput_per_sec": 307.57880590230576, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12776.323, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12776.254, "sample_time_ms": 1144.096, "learn_time_ms": 11563.47, "learn_throughput": 345.917, "synch_weights_time_ms": 67.884}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00007", "date": "2024-08-04_06-08-22", "timestamp": 1722731902, "time_this_iter_s": 13.017300844192505, "time_total_s": 102.30953526496887, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a6f80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.30953526496887, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.283333333333335, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 131.64393664399782, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.715170491486788, "policy_loss": -0.008589561821524209, "vf_loss": 3.7206229622165363, "vf_explained_var": 0.9365002603580554, "kl": 0.014900680249729703, "entropy": 1.3331201430410147, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -58.37771367897575, "episode_reward_min": -1530.5175259882935, "episode_reward_mean": -749.5990365150521, "episode_len_mean": 133.6, "episode_media": {}, "episodes_timesteps_total": 13360, "policy_reward_min": {"policy_0": -1530.5175259882935}, "policy_reward_max": {"policy_0": -58.37771367897575}, "policy_reward_mean": {"policy_0": -749.5990365150521}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-969.0951084010832, -87.41512030250479, -1269.3582765499484, -870.204277787221, -275.73499395433487, -984.8780146344952, -324.595264707788, -831.4539060113431, -1232.0887871168925, -1020.7730972785206, -1264.4059984369765, -930.488979231747, -856.3552707557241, -1074.1313315474572, -214.71494262240458, -225.98711681277956, -501.01677158126245, -1072.6257617991353, -796.4092101943679, -378.67714405379996, -1035.2497455929908, -374.15616364127783, -1084.2016424972965, -768.7890401801259, -517.2978111946989, -1091.6558621998402, -809.7319662762375, -473.0888178921559, -1323.6228728673527, -395.54268224921515, -878.4331729330437, -1075.4685565962488, -268.862323387095, -476.0825432947783, -277.906789631344, -1336.4828658196896, -58.37771367897575, -491.27756298861124, -919.4678988609239, -636.6317255454954, -105.45888305185952, -207.59858083807308, -1005.209964365611, -1087.167409710931, -823.7861326680543, -978.6729608268628, -722.8485957753358, -1039.2993065021103, -1129.198312339678, -867.735076317301, -717.2135076817236, -765.1957433367403, -1094.769681749592, -764.6645596095437, -878.0240006977759, -319.4591399951141, -367.4678478197359, -527.5632036238906, -798.9056763333078, -599.3395781453324, -1123.7467253433351, -544.3048569332539, -877.3885446796133, -824.4712046579573, -515.7326394093067, -1384.9934734656172, -845.7338560224716, -626.2679858625509, -354.9266871089771, -501.7548986147654, -1213.4292884539032, -250.65714875464158, -931.5294594224981, -1179.8485881137576, -821.5798398127266, -197.0452442690636, -1097.2000449274478, -1037.5098256013712, -301.33245470826466, -198.257855066394, -508.1429259457185, -1010.1983876547088, -989.7235531138314, -166.2840127288819, -1050.7141769131047, -751.6207329721201, -1037.293651860899, -443.857056000594, -1334.5488057660737, -708.9785068744857, -579.3665059462686, -877.2803340151769, -106.3426486423078, -1042.5188050951785, -71.89836333578252, -1530.5175259882935, -851.2947012395009, -987.7309998259253, -845.8452873907326, -965.7207564719378], "episode_lengths": [150, 58, 150, 150, 77, 150, 82, 150, 150, 150, 150, 150, 150, 150, 98, 85, 150, 150, 150, 128, 150, 120, 150, 150, 139, 150, 142, 150, 150, 106, 150, 150, 104, 104, 105, 150, 45, 150, 150, 131, 57, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 114, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 69, 150, 150, 150, 66, 150, 150, 113, 74, 150, 150, 150, 83, 150, 143, 150, 139, 150, 150, 130, 150, 47, 150, 54, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-969.0951084010832, -87.41512030250479, -1269.3582765499484, -870.204277787221, -275.73499395433487, -984.8780146344952, -324.595264707788, -831.4539060113431, -1232.0887871168925, -1020.7730972785206, -1264.4059984369765, -930.488979231747, -856.3552707557241, -1074.1313315474572, -214.71494262240458, -225.98711681277956, -501.01677158126245, -1072.6257617991353, -796.4092101943679, -378.67714405379996, -1035.2497455929908, -374.15616364127783, -1084.2016424972965, -768.7890401801259, -517.2978111946989, -1091.6558621998402, -809.7319662762375, -473.0888178921559, -1323.6228728673527, -395.54268224921515, -878.4331729330437, -1075.4685565962488, -268.862323387095, -476.0825432947783, -277.906789631344, -1336.4828658196896, -58.37771367897575, -491.27756298861124, -919.4678988609239, -636.6317255454954, -105.45888305185952, -207.59858083807308, -1005.209964365611, -1087.167409710931, -823.7861326680543, -978.6729608268628, -722.8485957753358, -1039.2993065021103, -1129.198312339678, -867.735076317301, -717.2135076817236, -765.1957433367403, -1094.769681749592, -764.6645596095437, -878.0240006977759, -319.4591399951141, -367.4678478197359, -527.5632036238906, -798.9056763333078, -599.3395781453324, -1123.7467253433351, -544.3048569332539, -877.3885446796133, -824.4712046579573, -515.7326394093067, -1384.9934734656172, -845.7338560224716, -626.2679858625509, -354.9266871089771, -501.7548986147654, -1213.4292884539032, -250.65714875464158, -931.5294594224981, -1179.8485881137576, -821.5798398127266, -197.0452442690636, -1097.2000449274478, -1037.5098256013712, -301.33245470826466, -198.257855066394, -508.1429259457185, -1010.1983876547088, -989.7235531138314, -166.2840127288819, -1050.7141769131047, -751.6207329721201, -1037.293651860899, -443.857056000594, -1334.5488057660737, -708.9785068744857, -579.3665059462686, -877.2803340151769, -106.3426486423078, -1042.5188050951785, -71.89836333578252, -1530.5175259882935, -851.2947012395009, -987.7309998259253, -845.8452873907326, -965.7207564719378]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.560405468116982, "mean_inference_ms": 1.6841352647915984, "mean_action_processing_ms": 0.27887575739218556, "mean_env_wait_ms": 3.4811284572100516, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012118101119995117, "StateBufferConnector_ms": 0.008007526397705078, "ViewRequirementAgentConnector_ms": 0.19143056869506836}, "num_episodes": 27, "episode_return_max": -58.37771367897575, "episode_return_min": -1530.5175259882935, "episode_return_mean": -749.5990365150521, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.9281279699062, "num_env_steps_trained_throughput_per_sec": 309.9281279699062, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12790.757, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12790.688, "sample_time_ms": 1138.707, "learn_time_ms": 11582.768, "learn_throughput": 345.341, "synch_weights_time_ms": 68.412}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00007", "date": "2024-08-04_06-08-35", "timestamp": 1722731915, "time_this_iter_s": 12.91911005973816, "time_total_s": 115.22864532470703, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0143760>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.22864532470703, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.826315789473682, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 156.465841648976, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.490376583238443, "policy_loss": -0.006359253033103111, "vf_loss": 3.493838035687804, "vf_explained_var": 0.9553330144534509, "kl": 0.01380247890871639, "entropy": 1.2429419198383889, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -58.37771367897575, "episode_reward_min": -1530.5175259882935, "episode_reward_mean": -741.750932949152, "episode_len_mean": 133.53, "episode_media": {}, "episodes_timesteps_total": 13353, "policy_reward_min": {"policy_0": -1530.5175259882935}, "policy_reward_max": {"policy_0": -58.37771367897575}, "policy_reward_mean": {"policy_0": -741.750932949152}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1075.4685565962488, -268.862323387095, -476.0825432947783, -277.906789631344, -1336.4828658196896, -58.37771367897575, -491.27756298861124, -919.4678988609239, -636.6317255454954, -105.45888305185952, -207.59858083807308, -1005.209964365611, -1087.167409710931, -823.7861326680543, -978.6729608268628, -722.8485957753358, -1039.2993065021103, -1129.198312339678, -867.735076317301, -717.2135076817236, -765.1957433367403, -1094.769681749592, -764.6645596095437, -878.0240006977759, -319.4591399951141, -367.4678478197359, -527.5632036238906, -798.9056763333078, -599.3395781453324, -1123.7467253433351, -544.3048569332539, -877.3885446796133, -824.4712046579573, -515.7326394093067, -1384.9934734656172, -845.7338560224716, -626.2679858625509, -354.9266871089771, -501.7548986147654, -1213.4292884539032, -250.65714875464158, -931.5294594224981, -1179.8485881137576, -821.5798398127266, -197.0452442690636, -1097.2000449274478, -1037.5098256013712, -301.33245470826466, -198.257855066394, -508.1429259457185, -1010.1983876547088, -989.7235531138314, -166.2840127288819, -1050.7141769131047, -751.6207329721201, -1037.293651860899, -443.857056000594, -1334.5488057660737, -708.9785068744857, -579.3665059462686, -877.2803340151769, -106.3426486423078, -1042.5188050951785, -71.89836333578252, -1530.5175259882935, -851.2947012395009, -987.7309998259253, -845.8452873907326, -965.7207564719378, -1163.5162246905059, -680.387538283573, -892.4002880304041, -1172.2293744341232, -1178.6641242774667, -483.7975796256268, -1161.7833040835094, -332.1378783548524, -817.9685352617089, -1267.5985364131086, -168.43996399881178, -433.98589295133473, -780.8357574027423, -689.2661323226054, -1093.8569332456616, -828.8138018162934, -1423.6561924331177, -747.383606463244, -1259.0546449139213, -987.3436301993787, -840.9457425186225, -347.47718010178204, -378.03390973049636, -340.882166693145, -472.7384114120671, -316.6372312139687, -138.16242405293193, -442.0447389813895, -880.2926900544946, -793.0628679157194, -633.9714928374004], "episode_lengths": [150, 104, 104, 105, 150, 45, 150, 150, 131, 57, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 114, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 69, 150, 150, 150, 66, 150, 150, 113, 74, 150, 150, 150, 83, 150, 143, 150, 139, 150, 150, 130, 150, 47, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 107, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 96, 93, 150, 104, 59, 150, 150, 150, 123], "policy_policy_0_reward": [-1075.4685565962488, -268.862323387095, -476.0825432947783, -277.906789631344, -1336.4828658196896, -58.37771367897575, -491.27756298861124, -919.4678988609239, -636.6317255454954, -105.45888305185952, -207.59858083807308, -1005.209964365611, -1087.167409710931, -823.7861326680543, -978.6729608268628, -722.8485957753358, -1039.2993065021103, -1129.198312339678, -867.735076317301, -717.2135076817236, -765.1957433367403, -1094.769681749592, -764.6645596095437, -878.0240006977759, -319.4591399951141, -367.4678478197359, -527.5632036238906, -798.9056763333078, -599.3395781453324, -1123.7467253433351, -544.3048569332539, -877.3885446796133, -824.4712046579573, -515.7326394093067, -1384.9934734656172, -845.7338560224716, -626.2679858625509, -354.9266871089771, -501.7548986147654, -1213.4292884539032, -250.65714875464158, -931.5294594224981, -1179.8485881137576, -821.5798398127266, -197.0452442690636, -1097.2000449274478, -1037.5098256013712, -301.33245470826466, -198.257855066394, -508.1429259457185, -1010.1983876547088, -989.7235531138314, -166.2840127288819, -1050.7141769131047, -751.6207329721201, -1037.293651860899, -443.857056000594, -1334.5488057660737, -708.9785068744857, -579.3665059462686, -877.2803340151769, -106.3426486423078, -1042.5188050951785, -71.89836333578252, -1530.5175259882935, -851.2947012395009, -987.7309998259253, -845.8452873907326, -965.7207564719378, -1163.5162246905059, -680.387538283573, -892.4002880304041, -1172.2293744341232, -1178.6641242774667, -483.7975796256268, -1161.7833040835094, -332.1378783548524, -817.9685352617089, -1267.5985364131086, -168.43996399881178, -433.98589295133473, -780.8357574027423, -689.2661323226054, -1093.8569332456616, -828.8138018162934, -1423.6561924331177, -747.383606463244, -1259.0546449139213, -987.3436301993787, -840.9457425186225, -347.47718010178204, -378.03390973049636, -340.882166693145, -472.7384114120671, -316.6372312139687, -138.16242405293193, -442.0447389813895, -880.2926900544946, -793.0628679157194, -633.9714928374004]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5589849389700379, "mean_inference_ms": 1.6823858433087044, "mean_action_processing_ms": 0.2780868571859767, "mean_env_wait_ms": 3.475715019858206, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011919498443603516, "StateBufferConnector_ms": 0.007859945297241211, "ViewRequirementAgentConnector_ms": 0.19462180137634277}, "num_episodes": 31, "episode_return_max": -58.37771367897575, "episode_return_min": -1530.5175259882935, "episode_return_mean": -741.750932949152, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.7882749935878, "num_env_steps_trained_throughput_per_sec": 307.7882749935878, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12811.277, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12811.207, "sample_time_ms": 1135.629, "learn_time_ms": 11606.375, "learn_throughput": 344.638, "synch_weights_time_ms": 68.405}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00007", "date": "2024-08-04_06-08-48", "timestamp": 1722731928, "time_this_iter_s": 13.008705615997314, "time_total_s": 128.23735094070435, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01a7490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 128.23735094070435, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.244444444444444, "ram_util_percent": 27.93333333333333}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 170.35561043421427, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.414170951147874, "policy_loss": -0.011221033425924058, "vf_loss": 3.421259917318821, "vf_explained_var": 0.9684972953672211, "kl": 0.018169668157982717, "entropy": 1.3188354001690945, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -71.89836333578252, "episode_reward_min": -1530.5175259882935, "episode_reward_mean": -752.8658688734956, "episode_len_mean": 137.04, "episode_media": {}, "episodes_timesteps_total": 13704, "policy_reward_min": {"policy_0": -1530.5175259882935}, "policy_reward_max": {"policy_0": -71.89836333578252}, "policy_reward_mean": {"policy_0": -752.8658688734956}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-599.3395781453324, -1123.7467253433351, -544.3048569332539, -877.3885446796133, -824.4712046579573, -515.7326394093067, -1384.9934734656172, -845.7338560224716, -626.2679858625509, -354.9266871089771, -501.7548986147654, -1213.4292884539032, -250.65714875464158, -931.5294594224981, -1179.8485881137576, -821.5798398127266, -197.0452442690636, -1097.2000449274478, -1037.5098256013712, -301.33245470826466, -198.257855066394, -508.1429259457185, -1010.1983876547088, -989.7235531138314, -166.2840127288819, -1050.7141769131047, -751.6207329721201, -1037.293651860899, -443.857056000594, -1334.5488057660737, -708.9785068744857, -579.3665059462686, -877.2803340151769, -106.3426486423078, -1042.5188050951785, -71.89836333578252, -1530.5175259882935, -851.2947012395009, -987.7309998259253, -845.8452873907326, -965.7207564719378, -1163.5162246905059, -680.387538283573, -892.4002880304041, -1172.2293744341232, -1178.6641242774667, -483.7975796256268, -1161.7833040835094, -332.1378783548524, -817.9685352617089, -1267.5985364131086, -168.43996399881178, -433.98589295133473, -780.8357574027423, -689.2661323226054, -1093.8569332456616, -828.8138018162934, -1423.6561924331177, -747.383606463244, -1259.0546449139213, -987.3436301993787, -840.9457425186225, -347.47718010178204, -378.03390973049636, -340.882166693145, -472.7384114120671, -316.6372312139687, -138.16242405293193, -442.0447389813895, -880.2926900544946, -793.0628679157194, -633.9714928374004, -656.1705955700561, -366.5638589276436, -896.9794609215787, -850.5463287831515, -1335.7255600903547, -344.2416823646177, -553.857877845476, -1103.8402237846483, -727.5224077207429, -1242.8798227870363, -298.34154206519923, -727.4582710062712, -456.46186683679366, -688.727798824272, -738.7274117181594, -676.4474932550139, -1088.7151658534249, -862.7097808943572, -550.7511597254119, -496.8732429916577, -932.2325210986952, -891.0099758632689, -662.5843431265986, -780.3130944503707, -1128.171703556205, -266.81229546279576, -892.1264268798217, -635.4982430771676], "episode_lengths": [120, 150, 150, 150, 150, 150, 150, 150, 119, 150, 150, 150, 69, 150, 150, 150, 66, 150, 150, 113, 74, 150, 150, 150, 83, 150, 143, 150, 139, 150, 150, 130, 150, 47, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 107, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 96, 93, 150, 104, 59, 150, 150, 150, 123, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 81, 150, 150], "policy_policy_0_reward": [-599.3395781453324, -1123.7467253433351, -544.3048569332539, -877.3885446796133, -824.4712046579573, -515.7326394093067, -1384.9934734656172, -845.7338560224716, -626.2679858625509, -354.9266871089771, -501.7548986147654, -1213.4292884539032, -250.65714875464158, -931.5294594224981, -1179.8485881137576, -821.5798398127266, -197.0452442690636, -1097.2000449274478, -1037.5098256013712, -301.33245470826466, -198.257855066394, -508.1429259457185, -1010.1983876547088, -989.7235531138314, -166.2840127288819, -1050.7141769131047, -751.6207329721201, -1037.293651860899, -443.857056000594, -1334.5488057660737, -708.9785068744857, -579.3665059462686, -877.2803340151769, -106.3426486423078, -1042.5188050951785, -71.89836333578252, -1530.5175259882935, -851.2947012395009, -987.7309998259253, -845.8452873907326, -965.7207564719378, -1163.5162246905059, -680.387538283573, -892.4002880304041, -1172.2293744341232, -1178.6641242774667, -483.7975796256268, -1161.7833040835094, -332.1378783548524, -817.9685352617089, -1267.5985364131086, -168.43996399881178, -433.98589295133473, -780.8357574027423, -689.2661323226054, -1093.8569332456616, -828.8138018162934, -1423.6561924331177, -747.383606463244, -1259.0546449139213, -987.3436301993787, -840.9457425186225, -347.47718010178204, -378.03390973049636, -340.882166693145, -472.7384114120671, -316.6372312139687, -138.16242405293193, -442.0447389813895, -880.2926900544946, -793.0628679157194, -633.9714928374004, -656.1705955700561, -366.5638589276436, -896.9794609215787, -850.5463287831515, -1335.7255600903547, -344.2416823646177, -553.857877845476, -1103.8402237846483, -727.5224077207429, -1242.8798227870363, -298.34154206519923, -727.4582710062712, -456.46186683679366, -688.727798824272, -738.7274117181594, -676.4474932550139, -1088.7151658534249, -862.7097808943572, -550.7511597254119, -496.8732429916577, -932.2325210986952, -891.0099758632689, -662.5843431265986, -780.3130944503707, -1128.171703556205, -266.81229546279576, -892.1264268798217, -635.4982430771676]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5582065416224508, "mean_inference_ms": 1.6803358845287804, "mean_action_processing_ms": 0.27749884442958833, "mean_env_wait_ms": 3.4708448142390087, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01206350326538086, "StateBufferConnector_ms": 0.007909536361694336, "ViewRequirementAgentConnector_ms": 0.19748806953430176}, "num_episodes": 28, "episode_return_max": -71.89836333578252, "episode_return_min": -1530.5175259882935, "episode_return_mean": -752.8658688734956, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.4670450328406, "num_env_steps_trained_throughput_per_sec": 305.4670450328406, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12815.781, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12815.711, "sample_time_ms": 1131.529, "learn_time_ms": 11617.61, "learn_throughput": 344.305, "synch_weights_time_ms": 65.784}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00007", "date": "2024-08-04_06-09-01", "timestamp": 1722731941, "time_this_iter_s": 13.10497760772705, "time_total_s": 141.3423285484314, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01a79a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 141.3423285484314, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.878947368421056, "ram_util_percent": 27.99473684210526}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 153.9169784228007, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.254583824177583, "policy_loss": -0.011505113291786984, "vf_loss": 3.2619813080877065, "vf_explained_var": 0.9798971419533093, "kl": 0.01828181069087691, "entropy": 1.376913411046068, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -71.89836333578252, "episode_reward_min": -1530.5175259882935, "episode_reward_mean": -760.2954668546769, "episode_len_mean": 139.72, "episode_media": {}, "episodes_timesteps_total": 13972, "policy_reward_min": {"policy_0": -1530.5175259882935}, "policy_reward_max": {"policy_0": -71.89836333578252}, "policy_reward_mean": {"policy_0": -760.2954668546769}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-751.6207329721201, -1037.293651860899, -443.857056000594, -1334.5488057660737, -708.9785068744857, -579.3665059462686, -877.2803340151769, -106.3426486423078, -1042.5188050951785, -71.89836333578252, -1530.5175259882935, -851.2947012395009, -987.7309998259253, -845.8452873907326, -965.7207564719378, -1163.5162246905059, -680.387538283573, -892.4002880304041, -1172.2293744341232, -1178.6641242774667, -483.7975796256268, -1161.7833040835094, -332.1378783548524, -817.9685352617089, -1267.5985364131086, -168.43996399881178, -433.98589295133473, -780.8357574027423, -689.2661323226054, -1093.8569332456616, -828.8138018162934, -1423.6561924331177, -747.383606463244, -1259.0546449139213, -987.3436301993787, -840.9457425186225, -347.47718010178204, -378.03390973049636, -340.882166693145, -472.7384114120671, -316.6372312139687, -138.16242405293193, -442.0447389813895, -880.2926900544946, -793.0628679157194, -633.9714928374004, -656.1705955700561, -366.5638589276436, -896.9794609215787, -850.5463287831515, -1335.7255600903547, -344.2416823646177, -553.857877845476, -1103.8402237846483, -727.5224077207429, -1242.8798227870363, -298.34154206519923, -727.4582710062712, -456.46186683679366, -688.727798824272, -738.7274117181594, -676.4474932550139, -1088.7151658534249, -862.7097808943572, -550.7511597254119, -496.8732429916577, -932.2325210986952, -891.0099758632689, -662.5843431265986, -780.3130944503707, -1128.171703556205, -266.81229546279576, -892.1264268798217, -635.4982430771676, -543.1484925505439, -921.1675919741514, -1365.8880415668407, -505.62741573145115, -72.45029237855263, -702.8062749964723, -759.4975179368992, -1040.4282532339944, -884.801318304966, -637.9053266119884, -1002.638280041923, -570.3826308954792, -558.2695312051293, -437.5698445135917, -612.9721837432216, -803.8360533073412, -1001.4896003734086, -893.916941699675, -804.5401257843894, -652.2065374355545, -1113.710059438269, -1090.0407512513912, -388.78632113078476, -307.5249166275207, -1245.5962924442442, -977.8724586698394], "episode_lengths": [143, 150, 139, 150, 150, 130, 150, 47, 150, 54, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 130, 150, 107, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 96, 93, 150, 104, 59, 150, 150, 150, 123, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 81, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150], "policy_policy_0_reward": [-751.6207329721201, -1037.293651860899, -443.857056000594, -1334.5488057660737, -708.9785068744857, -579.3665059462686, -877.2803340151769, -106.3426486423078, -1042.5188050951785, -71.89836333578252, -1530.5175259882935, -851.2947012395009, -987.7309998259253, -845.8452873907326, -965.7207564719378, -1163.5162246905059, -680.387538283573, -892.4002880304041, -1172.2293744341232, -1178.6641242774667, -483.7975796256268, -1161.7833040835094, -332.1378783548524, -817.9685352617089, -1267.5985364131086, -168.43996399881178, -433.98589295133473, -780.8357574027423, -689.2661323226054, -1093.8569332456616, -828.8138018162934, -1423.6561924331177, -747.383606463244, -1259.0546449139213, -987.3436301993787, -840.9457425186225, -347.47718010178204, -378.03390973049636, -340.882166693145, -472.7384114120671, -316.6372312139687, -138.16242405293193, -442.0447389813895, -880.2926900544946, -793.0628679157194, -633.9714928374004, -656.1705955700561, -366.5638589276436, -896.9794609215787, -850.5463287831515, -1335.7255600903547, -344.2416823646177, -553.857877845476, -1103.8402237846483, -727.5224077207429, -1242.8798227870363, -298.34154206519923, -727.4582710062712, -456.46186683679366, -688.727798824272, -738.7274117181594, -676.4474932550139, -1088.7151658534249, -862.7097808943572, -550.7511597254119, -496.8732429916577, -932.2325210986952, -891.0099758632689, -662.5843431265986, -780.3130944503707, -1128.171703556205, -266.81229546279576, -892.1264268798217, -635.4982430771676, -543.1484925505439, -921.1675919741514, -1365.8880415668407, -505.62741573145115, -72.45029237855263, -702.8062749964723, -759.4975179368992, -1040.4282532339944, -884.801318304966, -637.9053266119884, -1002.638280041923, -570.3826308954792, -558.2695312051293, -437.5698445135917, -612.9721837432216, -803.8360533073412, -1001.4896003734086, -893.916941699675, -804.5401257843894, -652.2065374355545, -1113.710059438269, -1090.0407512513912, -388.78632113078476, -307.5249166275207, -1245.5962924442442, -977.8724586698394]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578523335883099, "mean_inference_ms": 1.6798732104401644, "mean_action_processing_ms": 0.2769690945197306, "mean_env_wait_ms": 3.465268159298908, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012006521224975586, "StateBufferConnector_ms": 0.00792837142944336, "ViewRequirementAgentConnector_ms": 0.1972968578338623}, "num_episodes": 26, "episode_return_max": -71.89836333578252, "episode_return_min": -1530.5175259882935, "episode_return_mean": -760.2954668546769, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 331.93634454173053, "num_env_steps_trained_throughput_per_sec": 331.93634454173053, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12731.793, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12731.723, "sample_time_ms": 1130.828, "learn_time_ms": 11534.887, "learn_throughput": 346.774, "synch_weights_time_ms": 65.219}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00007", "date": "2024-08-04_06-09-13", "timestamp": 1722731953, "time_this_iter_s": 12.062400817871094, "time_total_s": 153.4047293663025, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01a7d90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 153.4047293663025, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.49411764705882, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 160.9229022304217, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.736372675001621, "policy_loss": -0.014711520250906081, "vf_loss": 2.746914965783556, "vf_explained_var": 0.9833128657812874, "kl": 0.01869052868150902, "entropy": 1.4379202753305436, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -13.883092503509227, "episode_reward_min": -1423.6561924331177, "episode_reward_mean": -721.6988766633675, "episode_len_mean": 138.38, "episode_media": {}, "episodes_timesteps_total": 13838, "policy_reward_min": {"policy_0": -1423.6561924331177}, "policy_reward_max": {"policy_0": -13.883092503509227}, "policy_reward_mean": {"policy_0": -721.6988766633675}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1423.6561924331177, -747.383606463244, -1259.0546449139213, -987.3436301993787, -840.9457425186225, -347.47718010178204, -378.03390973049636, -340.882166693145, -472.7384114120671, -316.6372312139687, -138.16242405293193, -442.0447389813895, -880.2926900544946, -793.0628679157194, -633.9714928374004, -656.1705955700561, -366.5638589276436, -896.9794609215787, -850.5463287831515, -1335.7255600903547, -344.2416823646177, -553.857877845476, -1103.8402237846483, -727.5224077207429, -1242.8798227870363, -298.34154206519923, -727.4582710062712, -456.46186683679366, -688.727798824272, -738.7274117181594, -676.4474932550139, -1088.7151658534249, -862.7097808943572, -550.7511597254119, -496.8732429916577, -932.2325210986952, -891.0099758632689, -662.5843431265986, -780.3130944503707, -1128.171703556205, -266.81229546279576, -892.1264268798217, -635.4982430771676, -543.1484925505439, -921.1675919741514, -1365.8880415668407, -505.62741573145115, -72.45029237855263, -702.8062749964723, -759.4975179368992, -1040.4282532339944, -884.801318304966, -637.9053266119884, -1002.638280041923, -570.3826308954792, -558.2695312051293, -437.5698445135917, -612.9721837432216, -803.8360533073412, -1001.4896003734086, -893.916941699675, -804.5401257843894, -652.2065374355545, -1113.710059438269, -1090.0407512513912, -388.78632113078476, -307.5249166275207, -1245.5962924442442, -977.8724586698394, -337.36536115476173, -1236.4394220033437, -13.883092503509227, -862.4820287464034, -911.9224697387463, -306.1299714683437, -1205.4893029805737, -662.9222679607503, -743.6921015812992, -33.36241942487248, -75.90406118473814, -438.1212264793367, -386.28189401953875, -280.83911531176005, -1114.940528848366, -1057.4153631141812, -977.1838113552166, -638.6835553506766, -823.4035913763688, -1124.8839953288184, -458.6543295177529, -502.349326004498, -1051.9657697984067, -456.3713426065545, -333.7987040690226, -1315.129790246333, -1036.479056724727, -488.93793620036547, -923.3884308527806, -1258.5707505958685, -363.84651093874504], "episode_lengths": [150, 150, 150, 150, 150, 88, 96, 93, 150, 104, 59, 150, 150, 150, 123, 150, 86, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 81, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 35, 150, 150, 74, 150, 150, 150, 46, 42, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1423.6561924331177, -747.383606463244, -1259.0546449139213, -987.3436301993787, -840.9457425186225, -347.47718010178204, -378.03390973049636, -340.882166693145, -472.7384114120671, -316.6372312139687, -138.16242405293193, -442.0447389813895, -880.2926900544946, -793.0628679157194, -633.9714928374004, -656.1705955700561, -366.5638589276436, -896.9794609215787, -850.5463287831515, -1335.7255600903547, -344.2416823646177, -553.857877845476, -1103.8402237846483, -727.5224077207429, -1242.8798227870363, -298.34154206519923, -727.4582710062712, -456.46186683679366, -688.727798824272, -738.7274117181594, -676.4474932550139, -1088.7151658534249, -862.7097808943572, -550.7511597254119, -496.8732429916577, -932.2325210986952, -891.0099758632689, -662.5843431265986, -780.3130944503707, -1128.171703556205, -266.81229546279576, -892.1264268798217, -635.4982430771676, -543.1484925505439, -921.1675919741514, -1365.8880415668407, -505.62741573145115, -72.45029237855263, -702.8062749964723, -759.4975179368992, -1040.4282532339944, -884.801318304966, -637.9053266119884, -1002.638280041923, -570.3826308954792, -558.2695312051293, -437.5698445135917, -612.9721837432216, -803.8360533073412, -1001.4896003734086, -893.916941699675, -804.5401257843894, -652.2065374355545, -1113.710059438269, -1090.0407512513912, -388.78632113078476, -307.5249166275207, -1245.5962924442442, -977.8724586698394, -337.36536115476173, -1236.4394220033437, -13.883092503509227, -862.4820287464034, -911.9224697387463, -306.1299714683437, -1205.4893029805737, -662.9222679607503, -743.6921015812992, -33.36241942487248, -75.90406118473814, -438.1212264793367, -386.28189401953875, -280.83911531176005, -1114.940528848366, -1057.4153631141812, -977.1838113552166, -638.6835553506766, -823.4035913763688, -1124.8839953288184, -458.6543295177529, -502.349326004498, -1051.9657697984067, -456.3713426065545, -333.7987040690226, -1315.129790246333, -1036.479056724727, -488.93793620036547, -923.3884308527806, -1258.5707505958685, -363.84651093874504]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5576218523976852, "mean_inference_ms": 1.6801216139680213, "mean_action_processing_ms": 0.2768055144505648, "mean_env_wait_ms": 3.4659834484943612, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012012243270874023, "StateBufferConnector_ms": 0.007986068725585938, "ViewRequirementAgentConnector_ms": 0.19840502738952637}, "num_episodes": 31, "episode_return_max": -13.883092503509227, "episode_return_min": -1423.6561924331177, "episode_return_mean": -721.6988766633675, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.145033670312, "num_env_steps_trained_throughput_per_sec": 303.145033670312, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12733.158, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12733.088, "sample_time_ms": 1126.497, "learn_time_ms": 11538.199, "learn_throughput": 346.675, "synch_weights_time_ms": 67.578}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00007", "date": "2024-08-04_06-09-27", "timestamp": 1722731967, "time_this_iter_s": 13.207220554351807, "time_total_s": 166.6119499206543, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01a7c70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 166.6119499206543, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.815789473684212, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 195.09793914755184, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.825664148852229, "policy_loss": -0.012189459419460036, "vf_loss": 2.834802975257238, "vf_explained_var": 0.9808748257656892, "kl": 0.015302373866870781, "entropy": 1.540072230125467, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -13.883092503509227, "episode_reward_min": -1411.6270907951568, "episode_reward_mean": -740.3653575753871, "episode_len_mean": 141.29, "episode_media": {}, "episodes_timesteps_total": 14129, "policy_reward_min": {"policy_0": -1411.6270907951568}, "policy_reward_max": {"policy_0": -13.883092503509227}, "policy_reward_mean": {"policy_0": -740.3653575753871}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-688.727798824272, -738.7274117181594, -676.4474932550139, -1088.7151658534249, -862.7097808943572, -550.7511597254119, -496.8732429916577, -932.2325210986952, -891.0099758632689, -662.5843431265986, -780.3130944503707, -1128.171703556205, -266.81229546279576, -892.1264268798217, -635.4982430771676, -543.1484925505439, -921.1675919741514, -1365.8880415668407, -505.62741573145115, -72.45029237855263, -702.8062749964723, -759.4975179368992, -1040.4282532339944, -884.801318304966, -637.9053266119884, -1002.638280041923, -570.3826308954792, -558.2695312051293, -437.5698445135917, -612.9721837432216, -803.8360533073412, -1001.4896003734086, -893.916941699675, -804.5401257843894, -652.2065374355545, -1113.710059438269, -1090.0407512513912, -388.78632113078476, -307.5249166275207, -1245.5962924442442, -977.8724586698394, -337.36536115476173, -1236.4394220033437, -13.883092503509227, -862.4820287464034, -911.9224697387463, -306.1299714683437, -1205.4893029805737, -662.9222679607503, -743.6921015812992, -33.36241942487248, -75.90406118473814, -438.1212264793367, -386.28189401953875, -280.83911531176005, -1114.940528848366, -1057.4153631141812, -977.1838113552166, -638.6835553506766, -823.4035913763688, -1124.8839953288184, -458.6543295177529, -502.349326004498, -1051.9657697984067, -456.3713426065545, -333.7987040690226, -1315.129790246333, -1036.479056724727, -488.93793620036547, -923.3884308527806, -1258.5707505958685, -363.84651093874504, -502.92178834587077, -983.3606019192086, -973.8352895064091, -1177.9287083783101, -421.51524898701354, -598.8279679043151, -973.9944489512443, -1279.3104523404586, -462.9570045905118, -122.28434946231408, -844.0866322193185, -951.6317184896402, -624.875822430822, -931.5423331462007, -1186.1739374764938, -292.55798424816794, -1007.0549632921778, -762.9177383416621, -933.0519834538975, -582.2556220670784, -764.6568713191848, -432.990761881118, -334.8877941102365, -898.5655210036563, -308.2115266057433, -1411.6270907951568, -912.4675501777451, -752.432807983243], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 149, 150, 150, 81, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 35, 150, 150, 74, 150, 150, 150, 46, 42, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 138, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-688.727798824272, -738.7274117181594, -676.4474932550139, -1088.7151658534249, -862.7097808943572, -550.7511597254119, -496.8732429916577, -932.2325210986952, -891.0099758632689, -662.5843431265986, -780.3130944503707, -1128.171703556205, -266.81229546279576, -892.1264268798217, -635.4982430771676, -543.1484925505439, -921.1675919741514, -1365.8880415668407, -505.62741573145115, -72.45029237855263, -702.8062749964723, -759.4975179368992, -1040.4282532339944, -884.801318304966, -637.9053266119884, -1002.638280041923, -570.3826308954792, -558.2695312051293, -437.5698445135917, -612.9721837432216, -803.8360533073412, -1001.4896003734086, -893.916941699675, -804.5401257843894, -652.2065374355545, -1113.710059438269, -1090.0407512513912, -388.78632113078476, -307.5249166275207, -1245.5962924442442, -977.8724586698394, -337.36536115476173, -1236.4394220033437, -13.883092503509227, -862.4820287464034, -911.9224697387463, -306.1299714683437, -1205.4893029805737, -662.9222679607503, -743.6921015812992, -33.36241942487248, -75.90406118473814, -438.1212264793367, -386.28189401953875, -280.83911531176005, -1114.940528848366, -1057.4153631141812, -977.1838113552166, -638.6835553506766, -823.4035913763688, -1124.8839953288184, -458.6543295177529, -502.349326004498, -1051.9657697984067, -456.3713426065545, -333.7987040690226, -1315.129790246333, -1036.479056724727, -488.93793620036547, -923.3884308527806, -1258.5707505958685, -363.84651093874504, -502.92178834587077, -983.3606019192086, -973.8352895064091, -1177.9287083783101, -421.51524898701354, -598.8279679043151, -973.9944489512443, -1279.3104523404586, -462.9570045905118, -122.28434946231408, -844.0866322193185, -951.6317184896402, -624.875822430822, -931.5423331462007, -1186.1739374764938, -292.55798424816794, -1007.0549632921778, -762.9177383416621, -933.0519834538975, -582.2556220670784, -764.6568713191848, -432.990761881118, -334.8877941102365, -898.5655210036563, -308.2115266057433, -1411.6270907951568, -912.4675501777451, -752.432807983243]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.55739234112817, "mean_inference_ms": 1.6785552519920985, "mean_action_processing_ms": 0.27673438403362804, "mean_env_wait_ms": 3.465449574822725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012117147445678711, "StateBufferConnector_ms": 0.008017778396606445, "ViewRequirementAgentConnector_ms": 0.19442963600158691}, "num_episodes": 28, "episode_return_max": -13.883092503509227, "episode_return_min": -1411.6270907951568, "episode_return_mean": -740.3653575753871, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.52464447771246, "num_env_steps_trained_throughput_per_sec": 302.52464447771246, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12751.928, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12751.858, "sample_time_ms": 1129.3, "learn_time_ms": 11555.559, "learn_throughput": 346.154, "synch_weights_time_ms": 66.18}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00007", "date": "2024-08-04_06-09-40", "timestamp": 1722731980, "time_this_iter_s": 13.235656499862671, "time_total_s": 179.84760642051697, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01a5900>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 179.84760642051697, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.826315789473686, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 202.20059729615846, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.0009302515536547, "policy_loss": -0.010138260999519843, "vf_loss": 3.0082926407456396, "vf_explained_var": 0.9622573668137193, "kl": 0.013998034600930017, "entropy": 1.423546432579557, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -13.883092503509227, "episode_reward_min": -1411.6270907951568, "episode_reward_mean": -734.8056202223931, "episode_len_mean": 141.47, "episode_media": {}, "episodes_timesteps_total": 14147, "policy_reward_min": {"policy_0": -1411.6270907951568}, "policy_reward_max": {"policy_0": -13.883092503509227}, "policy_reward_mean": {"policy_0": -734.8056202223931}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-558.2695312051293, -437.5698445135917, -612.9721837432216, -803.8360533073412, -1001.4896003734086, -893.916941699675, -804.5401257843894, -652.2065374355545, -1113.710059438269, -1090.0407512513912, -388.78632113078476, -307.5249166275207, -1245.5962924442442, -977.8724586698394, -337.36536115476173, -1236.4394220033437, -13.883092503509227, -862.4820287464034, -911.9224697387463, -306.1299714683437, -1205.4893029805737, -662.9222679607503, -743.6921015812992, -33.36241942487248, -75.90406118473814, -438.1212264793367, -386.28189401953875, -280.83911531176005, -1114.940528848366, -1057.4153631141812, -977.1838113552166, -638.6835553506766, -823.4035913763688, -1124.8839953288184, -458.6543295177529, -502.349326004498, -1051.9657697984067, -456.3713426065545, -333.7987040690226, -1315.129790246333, -1036.479056724727, -488.93793620036547, -923.3884308527806, -1258.5707505958685, -363.84651093874504, -502.92178834587077, -983.3606019192086, -973.8352895064091, -1177.9287083783101, -421.51524898701354, -598.8279679043151, -973.9944489512443, -1279.3104523404586, -462.9570045905118, -122.28434946231408, -844.0866322193185, -951.6317184896402, -624.875822430822, -931.5423331462007, -1186.1739374764938, -292.55798424816794, -1007.0549632921778, -762.9177383416621, -933.0519834538975, -582.2556220670784, -764.6568713191848, -432.990761881118, -334.8877941102365, -898.5655210036563, -308.2115266057433, -1411.6270907951568, -912.4675501777451, -752.432807983243, -746.5843073741052, -884.403088319841, -519.376781970238, -575.1573637161573, -1214.9287813425667, -718.4941736019364, -555.7327572894296, -840.9280925010977, -722.6180542547798, -1163.8581991944934, -597.8097978244774, -752.6051007523204, -375.78046650139487, -569.2641232331455, -1012.5747621556012, -702.3350682949645, -559.1857293587098, -1366.889135181797, -1002.967791928702, -534.2800544740143, -301.7446323195654, -751.1011104372269, -848.7924800787122, -501.18607879425736, -470.7253154011768, -630.551014294791, -822.5940971056092], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 35, 150, 150, 74, 150, 150, 150, 46, 42, 150, 92, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 138, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 113, 126, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-558.2695312051293, -437.5698445135917, -612.9721837432216, -803.8360533073412, -1001.4896003734086, -893.916941699675, -804.5401257843894, -652.2065374355545, -1113.710059438269, -1090.0407512513912, -388.78632113078476, -307.5249166275207, -1245.5962924442442, -977.8724586698394, -337.36536115476173, -1236.4394220033437, -13.883092503509227, -862.4820287464034, -911.9224697387463, -306.1299714683437, -1205.4893029805737, -662.9222679607503, -743.6921015812992, -33.36241942487248, -75.90406118473814, -438.1212264793367, -386.28189401953875, -280.83911531176005, -1114.940528848366, -1057.4153631141812, -977.1838113552166, -638.6835553506766, -823.4035913763688, -1124.8839953288184, -458.6543295177529, -502.349326004498, -1051.9657697984067, -456.3713426065545, -333.7987040690226, -1315.129790246333, -1036.479056724727, -488.93793620036547, -923.3884308527806, -1258.5707505958685, -363.84651093874504, -502.92178834587077, -983.3606019192086, -973.8352895064091, -1177.9287083783101, -421.51524898701354, -598.8279679043151, -973.9944489512443, -1279.3104523404586, -462.9570045905118, -122.28434946231408, -844.0866322193185, -951.6317184896402, -624.875822430822, -931.5423331462007, -1186.1739374764938, -292.55798424816794, -1007.0549632921778, -762.9177383416621, -933.0519834538975, -582.2556220670784, -764.6568713191848, -432.990761881118, -334.8877941102365, -898.5655210036563, -308.2115266057433, -1411.6270907951568, -912.4675501777451, -752.432807983243, -746.5843073741052, -884.403088319841, -519.376781970238, -575.1573637161573, -1214.9287813425667, -718.4941736019364, -555.7327572894296, -840.9280925010977, -722.6180542547798, -1163.8581991944934, -597.8097978244774, -752.6051007523204, -375.78046650139487, -569.2641232331455, -1012.5747621556012, -702.3350682949645, -559.1857293587098, -1366.889135181797, -1002.967791928702, -534.2800544740143, -301.7446323195654, -751.1011104372269, -848.7924800787122, -501.18607879425736, -470.7253154011768, -630.551014294791, -822.5940971056092]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567346712724366, "mean_inference_ms": 1.6764939365203488, "mean_action_processing_ms": 0.2762272264677605, "mean_env_wait_ms": 3.465092609920396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011875391006469727, "StateBufferConnector_ms": 0.008056163787841797, "ViewRequirementAgentConnector_ms": 0.19312834739685059}, "num_episodes": 27, "episode_return_max": -13.883092503509227, "episode_return_min": -1411.6270907951568, "episode_return_mean": -734.8056202223931, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.3058576055585, "num_env_steps_trained_throughput_per_sec": 306.3058576055585, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12757.505, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12757.434, "sample_time_ms": 1124.998, "learn_time_ms": 11567.256, "learn_throughput": 345.804, "synch_weights_time_ms": 64.366}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00007", "date": "2024-08-04_06-09-53", "timestamp": 1722731993, "time_this_iter_s": 13.071598291397095, "time_total_s": 192.91920471191406, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0141630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.91920471191406, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.322222222222223, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 218.5917997956276, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.492974678302805, "policy_loss": -0.007584512367611751, "vf_loss": 2.4960767279068627, "vf_explained_var": 0.9894045989960432, "kl": 0.0202756860200225, "entropy": 1.6002470464756091, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -23.197412874976735, "episode_reward_min": -1411.6270907951568, "episode_reward_mean": -753.0046211797493, "episode_len_mean": 144.18, "episode_media": {}, "episodes_timesteps_total": 14418, "policy_reward_min": {"policy_0": -1411.6270907951568}, "policy_reward_max": {"policy_0": -23.197412874976735}, "policy_reward_mean": {"policy_0": -753.0046211797493}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1057.4153631141812, -977.1838113552166, -638.6835553506766, -823.4035913763688, -1124.8839953288184, -458.6543295177529, -502.349326004498, -1051.9657697984067, -456.3713426065545, -333.7987040690226, -1315.129790246333, -1036.479056724727, -488.93793620036547, -923.3884308527806, -1258.5707505958685, -363.84651093874504, -502.92178834587077, -983.3606019192086, -973.8352895064091, -1177.9287083783101, -421.51524898701354, -598.8279679043151, -973.9944489512443, -1279.3104523404586, -462.9570045905118, -122.28434946231408, -844.0866322193185, -951.6317184896402, -624.875822430822, -931.5423331462007, -1186.1739374764938, -292.55798424816794, -1007.0549632921778, -762.9177383416621, -933.0519834538975, -582.2556220670784, -764.6568713191848, -432.990761881118, -334.8877941102365, -898.5655210036563, -308.2115266057433, -1411.6270907951568, -912.4675501777451, -752.432807983243, -746.5843073741052, -884.403088319841, -519.376781970238, -575.1573637161573, -1214.9287813425667, -718.4941736019364, -555.7327572894296, -840.9280925010977, -722.6180542547798, -1163.8581991944934, -597.8097978244774, -752.6051007523204, -375.78046650139487, -569.2641232331455, -1012.5747621556012, -702.3350682949645, -559.1857293587098, -1366.889135181797, -1002.967791928702, -534.2800544740143, -301.7446323195654, -751.1011104372269, -848.7924800787122, -501.18607879425736, -470.7253154011768, -630.551014294791, -822.5940971056092, -1236.0618663940618, -1111.8439861501427, -596.7383454830143, -744.1946240673952, -1196.0075800027191, -522.224440277723, -703.2355804896223, -288.9430568248232, -890.4269417226485, -365.6003017826585, -601.7774922641983, -438.02773715672197, -717.0207263129915, -650.8824313353902, -23.197412874976735, -874.1239030575861, -53.59514967267475, -1099.6114370252817, -1098.669942102447, -324.02393300429424, -367.8822979973158, -598.7300938482135, -1215.7381097626155, -1219.400976483354, -778.7900805565521, -547.6558320955085, -860.7848282258756, -1182.5949588986648, -1010.2229108968219], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 105, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 138, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 113, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 51, 150, 43, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1057.4153631141812, -977.1838113552166, -638.6835553506766, -823.4035913763688, -1124.8839953288184, -458.6543295177529, -502.349326004498, -1051.9657697984067, -456.3713426065545, -333.7987040690226, -1315.129790246333, -1036.479056724727, -488.93793620036547, -923.3884308527806, -1258.5707505958685, -363.84651093874504, -502.92178834587077, -983.3606019192086, -973.8352895064091, -1177.9287083783101, -421.51524898701354, -598.8279679043151, -973.9944489512443, -1279.3104523404586, -462.9570045905118, -122.28434946231408, -844.0866322193185, -951.6317184896402, -624.875822430822, -931.5423331462007, -1186.1739374764938, -292.55798424816794, -1007.0549632921778, -762.9177383416621, -933.0519834538975, -582.2556220670784, -764.6568713191848, -432.990761881118, -334.8877941102365, -898.5655210036563, -308.2115266057433, -1411.6270907951568, -912.4675501777451, -752.432807983243, -746.5843073741052, -884.403088319841, -519.376781970238, -575.1573637161573, -1214.9287813425667, -718.4941736019364, -555.7327572894296, -840.9280925010977, -722.6180542547798, -1163.8581991944934, -597.8097978244774, -752.6051007523204, -375.78046650139487, -569.2641232331455, -1012.5747621556012, -702.3350682949645, -559.1857293587098, -1366.889135181797, -1002.967791928702, -534.2800544740143, -301.7446323195654, -751.1011104372269, -848.7924800787122, -501.18607879425736, -470.7253154011768, -630.551014294791, -822.5940971056092, -1236.0618663940618, -1111.8439861501427, -596.7383454830143, -744.1946240673952, -1196.0075800027191, -522.224440277723, -703.2355804896223, -288.9430568248232, -890.4269417226485, -365.6003017826585, -601.7774922641983, -438.02773715672197, -717.0207263129915, -650.8824313353902, -23.197412874976735, -874.1239030575861, -53.59514967267475, -1099.6114370252817, -1098.669942102447, -324.02393300429424, -367.8822979973158, -598.7300938482135, -1215.7381097626155, -1219.400976483354, -778.7900805565521, -547.6558320955085, -860.7848282258756, -1182.5949588986648, -1010.2229108968219]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5568171116564485, "mean_inference_ms": 1.6766843862755045, "mean_action_processing_ms": 0.27613815966525057, "mean_env_wait_ms": 3.468630825570496, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012115240097045898, "StateBufferConnector_ms": 0.008144378662109375, "ViewRequirementAgentConnector_ms": 0.19591641426086426}, "num_episodes": 29, "episode_return_max": -23.197412874976735, "episode_return_min": -1411.6270907951568, "episode_return_mean": -753.0046211797493, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.5536287336326, "num_env_steps_trained_throughput_per_sec": 303.5536287336326, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12749.46, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12749.39, "sample_time_ms": 1124.288, "learn_time_ms": 11558.419, "learn_throughput": 346.068, "synch_weights_time_ms": 65.86}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00007", "date": "2024-08-04_06-10-06", "timestamp": 1722732006, "time_this_iter_s": 13.189677476882935, "time_total_s": 206.108882188797, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01a6290>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 206.108882188797, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 18.094736842105263, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 205.4067383845647, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.735121712336938, "policy_loss": -0.007284537811938207, "vf_loss": 2.739125377188126, "vf_explained_var": 0.9815460966899991, "kl": 0.010754766496377991, "entropy": 1.5587621673941612, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -9.762452998214322, "episode_reward_min": -1411.6270907951568, "episode_reward_mean": -730.0348174943359, "episode_len_mean": 139.42, "episode_media": {}, "episodes_timesteps_total": 13942, "policy_reward_min": {"policy_0": -1411.6270907951568}, "policy_reward_max": {"policy_0": -9.762452998214322}, "policy_reward_mean": {"policy_0": -730.0348174943359}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-931.5423331462007, -1186.1739374764938, -292.55798424816794, -1007.0549632921778, -762.9177383416621, -933.0519834538975, -582.2556220670784, -764.6568713191848, -432.990761881118, -334.8877941102365, -898.5655210036563, -308.2115266057433, -1411.6270907951568, -912.4675501777451, -752.432807983243, -746.5843073741052, -884.403088319841, -519.376781970238, -575.1573637161573, -1214.9287813425667, -718.4941736019364, -555.7327572894296, -840.9280925010977, -722.6180542547798, -1163.8581991944934, -597.8097978244774, -752.6051007523204, -375.78046650139487, -569.2641232331455, -1012.5747621556012, -702.3350682949645, -559.1857293587098, -1366.889135181797, -1002.967791928702, -534.2800544740143, -301.7446323195654, -751.1011104372269, -848.7924800787122, -501.18607879425736, -470.7253154011768, -630.551014294791, -822.5940971056092, -1236.0618663940618, -1111.8439861501427, -596.7383454830143, -744.1946240673952, -1196.0075800027191, -522.224440277723, -703.2355804896223, -288.9430568248232, -890.4269417226485, -365.6003017826585, -601.7774922641983, -438.02773715672197, -717.0207263129915, -650.8824313353902, -23.197412874976735, -874.1239030575861, -53.59514967267475, -1099.6114370252817, -1098.669942102447, -324.02393300429424, -367.8822979973158, -598.7300938482135, -1215.7381097626155, -1219.400976483354, -778.7900805565521, -547.6558320955085, -860.7848282258756, -1182.5949588986648, -1010.2229108968219, -879.0624321778039, -1371.933092722569, -1357.600802339019, -1379.018038961114, -927.2450791608179, -1210.9184071743032, -1033.6193447774117, -290.19423365953645, -38.19845541703307, -212.63807764665776, -403.83020749785686, -880.221048295374, -1027.9736714294622, -479.1327030879528, -122.2968849905021, -1002.0847118718816, -867.4283557865697, -347.1646341126736, -1160.809377323597, -406.95315533430625, -848.7825559467113, -871.8040288499695, -404.28542226215455, -9.762452998214322, -632.6919539213076, -166.03813730451924, -1075.8407849650248, -520.1955080095382, -503.888371040544], "episode_lengths": [150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 150, 150, 150, 150, 107, 150, 150, 150, 150, 150, 150, 113, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 51, 150, 43, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 51, 62, 150, 150, 150, 108, 60, 150, 150, 150, 150, 150, 150, 150, 150, 38, 150, 69, 150, 117, 150], "policy_policy_0_reward": [-931.5423331462007, -1186.1739374764938, -292.55798424816794, -1007.0549632921778, -762.9177383416621, -933.0519834538975, -582.2556220670784, -764.6568713191848, -432.990761881118, -334.8877941102365, -898.5655210036563, -308.2115266057433, -1411.6270907951568, -912.4675501777451, -752.432807983243, -746.5843073741052, -884.403088319841, -519.376781970238, -575.1573637161573, -1214.9287813425667, -718.4941736019364, -555.7327572894296, -840.9280925010977, -722.6180542547798, -1163.8581991944934, -597.8097978244774, -752.6051007523204, -375.78046650139487, -569.2641232331455, -1012.5747621556012, -702.3350682949645, -559.1857293587098, -1366.889135181797, -1002.967791928702, -534.2800544740143, -301.7446323195654, -751.1011104372269, -848.7924800787122, -501.18607879425736, -470.7253154011768, -630.551014294791, -822.5940971056092, -1236.0618663940618, -1111.8439861501427, -596.7383454830143, -744.1946240673952, -1196.0075800027191, -522.224440277723, -703.2355804896223, -288.9430568248232, -890.4269417226485, -365.6003017826585, -601.7774922641983, -438.02773715672197, -717.0207263129915, -650.8824313353902, -23.197412874976735, -874.1239030575861, -53.59514967267475, -1099.6114370252817, -1098.669942102447, -324.02393300429424, -367.8822979973158, -598.7300938482135, -1215.7381097626155, -1219.400976483354, -778.7900805565521, -547.6558320955085, -860.7848282258756, -1182.5949588986648, -1010.2229108968219, -879.0624321778039, -1371.933092722569, -1357.600802339019, -1379.018038961114, -927.2450791608179, -1210.9184071743032, -1033.6193447774117, -290.19423365953645, -38.19845541703307, -212.63807764665776, -403.83020749785686, -880.221048295374, -1027.9736714294622, -479.1327030879528, -122.2968849905021, -1002.0847118718816, -867.4283557865697, -347.1646341126736, -1160.809377323597, -406.95315533430625, -848.7825559467113, -871.8040288499695, -404.28542226215455, -9.762452998214322, -632.6919539213076, -166.03813730451924, -1075.8407849650248, -520.1955080095382, -503.888371040544]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562949846245365, "mean_inference_ms": 1.6745228856983811, "mean_action_processing_ms": 0.2755226404590329, "mean_env_wait_ms": 3.4663660651606802, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012363910675048828, "StateBufferConnector_ms": 0.008012771606445312, "ViewRequirementAgentConnector_ms": 0.19484996795654297}, "num_episodes": 29, "episode_return_max": -9.762452998214322, "episode_return_min": -1411.6270907951568, "episode_return_mean": -730.0348174943359, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.13531479106837, "num_env_steps_trained_throughput_per_sec": 302.13531479106837, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12994.455, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12994.383, "sample_time_ms": 1120.325, "learn_time_ms": 11806.298, "learn_throughput": 338.802, "synch_weights_time_ms": 66.955}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00007", "date": "2024-08-04_06-10-20", "timestamp": 1722732020, "time_this_iter_s": 13.251704454421997, "time_total_s": 219.360586643219, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270caf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 219.360586643219, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.8, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 168.22633387049038, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.739827881256739, "policy_loss": -0.009426450924850845, "vf_loss": 2.744903934498628, "vf_explained_var": 0.9807622756188115, "kl": 0.012881188455655017, "entropy": 1.4461394759515922, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -9.762452998214322, "episode_reward_min": -1466.3537447162146, "episode_reward_mean": -698.5874506572297, "episode_len_mean": 134.98, "episode_media": {}, "episodes_timesteps_total": 13498, "policy_reward_min": {"policy_0": -1466.3537447162146}, "policy_reward_max": {"policy_0": -9.762452998214322}, "policy_reward_mean": {"policy_0": -698.5874506572297}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1002.967791928702, -534.2800544740143, -301.7446323195654, -751.1011104372269, -848.7924800787122, -501.18607879425736, -470.7253154011768, -630.551014294791, -822.5940971056092, -1236.0618663940618, -1111.8439861501427, -596.7383454830143, -744.1946240673952, -1196.0075800027191, -522.224440277723, -703.2355804896223, -288.9430568248232, -890.4269417226485, -365.6003017826585, -601.7774922641983, -438.02773715672197, -717.0207263129915, -650.8824313353902, -23.197412874976735, -874.1239030575861, -53.59514967267475, -1099.6114370252817, -1098.669942102447, -324.02393300429424, -367.8822979973158, -598.7300938482135, -1215.7381097626155, -1219.400976483354, -778.7900805565521, -547.6558320955085, -860.7848282258756, -1182.5949588986648, -1010.2229108968219, -879.0624321778039, -1371.933092722569, -1357.600802339019, -1379.018038961114, -927.2450791608179, -1210.9184071743032, -1033.6193447774117, -290.19423365953645, -38.19845541703307, -212.63807764665776, -403.83020749785686, -880.221048295374, -1027.9736714294622, -479.1327030879528, -122.2968849905021, -1002.0847118718816, -867.4283557865697, -347.1646341126736, -1160.809377323597, -406.95315533430625, -848.7825559467113, -871.8040288499695, -404.28542226215455, -9.762452998214322, -632.6919539213076, -166.03813730451924, -1075.8407849650248, -520.1955080095382, -503.888371040544, -39.31608083052134, -585.5470371976772, -309.1039085301445, -859.05903419134, -860.491721388798, -1144.2915887654653, -576.3182762365682, -657.8366954522675, -987.9386879298307, -440.377144389562, -795.89148992488, -470.57473279455166, -1039.4815060601666, -939.8507506603413, -757.9645565739803, -140.2644543170166, -459.9372827291582, -1079.4694425634407, -707.2676813846997, -1466.3537447162146, -1275.0469208304512, -418.4800957497148, -297.60853302672405, -463.43330759403966, -986.017053127943, -444.8555231391033, -609.4248218544063, -825.4430499976316, -855.2708132497465, -243.626331751322, -37.57604738289455, -217.4527748436938, -1253.6124958739035], "episode_lengths": [150, 113, 126, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 120, 150, 150, 51, 150, 43, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 51, 62, 150, 150, 150, 108, 60, 150, 150, 150, 150, 150, 150, 150, 150, 38, 150, 69, 150, 117, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 71, 150, 150, 150, 150, 150, 105, 131, 150, 150, 131, 150, 150, 150, 70, 46, 64, 150], "policy_policy_0_reward": [-1002.967791928702, -534.2800544740143, -301.7446323195654, -751.1011104372269, -848.7924800787122, -501.18607879425736, -470.7253154011768, -630.551014294791, -822.5940971056092, -1236.0618663940618, -1111.8439861501427, -596.7383454830143, -744.1946240673952, -1196.0075800027191, -522.224440277723, -703.2355804896223, -288.9430568248232, -890.4269417226485, -365.6003017826585, -601.7774922641983, -438.02773715672197, -717.0207263129915, -650.8824313353902, -23.197412874976735, -874.1239030575861, -53.59514967267475, -1099.6114370252817, -1098.669942102447, -324.02393300429424, -367.8822979973158, -598.7300938482135, -1215.7381097626155, -1219.400976483354, -778.7900805565521, -547.6558320955085, -860.7848282258756, -1182.5949588986648, -1010.2229108968219, -879.0624321778039, -1371.933092722569, -1357.600802339019, -1379.018038961114, -927.2450791608179, -1210.9184071743032, -1033.6193447774117, -290.19423365953645, -38.19845541703307, -212.63807764665776, -403.83020749785686, -880.221048295374, -1027.9736714294622, -479.1327030879528, -122.2968849905021, -1002.0847118718816, -867.4283557865697, -347.1646341126736, -1160.809377323597, -406.95315533430625, -848.7825559467113, -871.8040288499695, -404.28542226215455, -9.762452998214322, -632.6919539213076, -166.03813730451924, -1075.8407849650248, -520.1955080095382, -503.888371040544, -39.31608083052134, -585.5470371976772, -309.1039085301445, -859.05903419134, -860.491721388798, -1144.2915887654653, -576.3182762365682, -657.8366954522675, -987.9386879298307, -440.377144389562, -795.89148992488, -470.57473279455166, -1039.4815060601666, -939.8507506603413, -757.9645565739803, -140.2644543170166, -459.9372827291582, -1079.4694425634407, -707.2676813846997, -1466.3537447162146, -1275.0469208304512, -418.4800957497148, -297.60853302672405, -463.43330759403966, -986.017053127943, -444.8555231391033, -609.4248218544063, -825.4430499976316, -855.2708132497465, -243.626331751322, -37.57604738289455, -217.4527748436938, -1253.6124958739035]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556392599635944, "mean_inference_ms": 1.672385445297205, "mean_action_processing_ms": 0.275122634162385, "mean_env_wait_ms": 3.464810746593116, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012364864349365234, "StateBufferConnector_ms": 0.008112192153930664, "ViewRequirementAgentConnector_ms": 0.19584059715270996}, "num_episodes": 33, "episode_return_max": -9.762452998214322, "episode_return_min": -1466.3537447162146, "episode_return_mean": -698.5874506572297, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.5573124187751, "num_env_steps_trained_throughput_per_sec": 333.5573124187751, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12893.169, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12893.099, "sample_time_ms": 1122.412, "learn_time_ms": 11703.041, "learn_throughput": 341.792, "synch_weights_time_ms": 66.841}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00007", "date": "2024-08-04_06-10-32", "timestamp": 1722732032, "time_this_iter_s": 12.002215147018433, "time_total_s": 231.36280179023743, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0141000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 231.36280179023743, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.72941176470588, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 171.42137365738552, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 3.011596309269468, "policy_loss": -0.008138100862076196, "vf_loss": 3.0142663615445295, "vf_explained_var": 0.9789654955267906, "kl": 0.01522801355052555, "entropy": 1.3845531720668078, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -6.191658408916657, "episode_reward_min": -1466.3537447162146, "episode_reward_mean": -684.8902128175207, "episode_len_mean": 133.52, "episode_media": {}, "episodes_timesteps_total": 13352, "policy_reward_min": {"policy_0": -1466.3537447162146}, "policy_reward_max": {"policy_0": -6.191658408916657}, "policy_reward_mean": {"policy_0": -684.8902128175207}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-324.02393300429424, -367.8822979973158, -598.7300938482135, -1215.7381097626155, -1219.400976483354, -778.7900805565521, -547.6558320955085, -860.7848282258756, -1182.5949588986648, -1010.2229108968219, -879.0624321778039, -1371.933092722569, -1357.600802339019, -1379.018038961114, -927.2450791608179, -1210.9184071743032, -1033.6193447774117, -290.19423365953645, -38.19845541703307, -212.63807764665776, -403.83020749785686, -880.221048295374, -1027.9736714294622, -479.1327030879528, -122.2968849905021, -1002.0847118718816, -867.4283557865697, -347.1646341126736, -1160.809377323597, -406.95315533430625, -848.7825559467113, -871.8040288499695, -404.28542226215455, -9.762452998214322, -632.6919539213076, -166.03813730451924, -1075.8407849650248, -520.1955080095382, -503.888371040544, -39.31608083052134, -585.5470371976772, -309.1039085301445, -859.05903419134, -860.491721388798, -1144.2915887654653, -576.3182762365682, -657.8366954522675, -987.9386879298307, -440.377144389562, -795.89148992488, -470.57473279455166, -1039.4815060601666, -939.8507506603413, -757.9645565739803, -140.2644543170166, -459.9372827291582, -1079.4694425634407, -707.2676813846997, -1466.3537447162146, -1275.0469208304512, -418.4800957497148, -297.60853302672405, -463.43330759403966, -986.017053127943, -444.8555231391033, -609.4248218544063, -825.4430499976316, -855.2708132497465, -243.626331751322, -37.57604738289455, -217.4527748436938, -1253.6124958739035, -372.4010266796832, -373.6622846682565, -719.9715719234711, -1238.4113934873938, -927.4635049733715, -1421.4892921047492, -443.87644153022535, -783.8229558782474, -460.08325686015644, -792.4762352358167, -6.191658408916657, -147.04464477141929, -1271.1332224499572, -427.1185996403858, -635.1937063871377, -527.4114493735395, -435.25779319379717, -492.98364741646583, -906.4568163534714, -379.05482478379116, -444.99196901732336, -530.584723438909, -50.63618582700462, -969.8024171503225, -1249.733365515386, -330.32270178437017, -825.6588610969686, -543.1671959096817], "episode_lengths": [150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 51, 62, 150, 150, 150, 108, 60, 150, 150, 150, 150, 150, 150, 150, 150, 38, 150, 69, 150, 117, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 71, 150, 150, 150, 150, 150, 105, 131, 150, 150, 131, 150, 150, 150, 70, 46, 64, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 34, 56, 150, 150, 150, 150, 98, 150, 150, 150, 120, 131, 54, 150, 150, 120, 150, 150], "policy_policy_0_reward": [-324.02393300429424, -367.8822979973158, -598.7300938482135, -1215.7381097626155, -1219.400976483354, -778.7900805565521, -547.6558320955085, -860.7848282258756, -1182.5949588986648, -1010.2229108968219, -879.0624321778039, -1371.933092722569, -1357.600802339019, -1379.018038961114, -927.2450791608179, -1210.9184071743032, -1033.6193447774117, -290.19423365953645, -38.19845541703307, -212.63807764665776, -403.83020749785686, -880.221048295374, -1027.9736714294622, -479.1327030879528, -122.2968849905021, -1002.0847118718816, -867.4283557865697, -347.1646341126736, -1160.809377323597, -406.95315533430625, -848.7825559467113, -871.8040288499695, -404.28542226215455, -9.762452998214322, -632.6919539213076, -166.03813730451924, -1075.8407849650248, -520.1955080095382, -503.888371040544, -39.31608083052134, -585.5470371976772, -309.1039085301445, -859.05903419134, -860.491721388798, -1144.2915887654653, -576.3182762365682, -657.8366954522675, -987.9386879298307, -440.377144389562, -795.89148992488, -470.57473279455166, -1039.4815060601666, -939.8507506603413, -757.9645565739803, -140.2644543170166, -459.9372827291582, -1079.4694425634407, -707.2676813846997, -1466.3537447162146, -1275.0469208304512, -418.4800957497148, -297.60853302672405, -463.43330759403966, -986.017053127943, -444.8555231391033, -609.4248218544063, -825.4430499976316, -855.2708132497465, -243.626331751322, -37.57604738289455, -217.4527748436938, -1253.6124958739035, -372.4010266796832, -373.6622846682565, -719.9715719234711, -1238.4113934873938, -927.4635049733715, -1421.4892921047492, -443.87644153022535, -783.8229558782474, -460.08325686015644, -792.4762352358167, -6.191658408916657, -147.04464477141929, -1271.1332224499572, -427.1185996403858, -635.1937063871377, -527.4114493735395, -435.25779319379717, -492.98364741646583, -906.4568163534714, -379.05482478379116, -444.99196901732336, -530.584723438909, -50.63618582700462, -969.8024171503225, -1249.733365515386, -330.32270178437017, -825.6588610969686, -543.1671959096817]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550584027078788, "mean_inference_ms": 1.6713734980747394, "mean_action_processing_ms": 0.27491089453565404, "mean_env_wait_ms": 3.4644340582871997, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01250600814819336, "StateBufferConnector_ms": 0.007968902587890625, "ViewRequirementAgentConnector_ms": 0.1936655044555664}, "num_episodes": 28, "episode_return_max": -6.191658408916657, "episode_return_min": -1466.3537447162146, "episode_return_mean": -684.8902128175207, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.11713833181756, "num_env_steps_trained_throughput_per_sec": 311.11713833181756, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12888.237, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12888.165, "sample_time_ms": 1125.129, "learn_time_ms": 11695.034, "learn_throughput": 342.026, "synch_weights_time_ms": 67.196}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00007", "date": "2024-08-04_06-10-44", "timestamp": 1722732044, "time_this_iter_s": 12.869123697280884, "time_total_s": 244.2319254875183, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01411b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 244.2319254875183, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.25, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 185.77620228330295, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.6827208173150816, "policy_loss": -0.01662226237046222, "vf_loss": 2.6944694865494965, "vf_explained_var": 0.988417645978431, "kl": 0.014375960217156111, "entropy": 1.5955927941948176, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -6.191658408916657, "episode_reward_min": -1500.2177389880305, "episode_reward_mean": -630.0318127833953, "episode_len_mean": 132.1, "episode_media": {}, "episodes_timesteps_total": 13210, "policy_reward_min": {"policy_0": -1500.2177389880305}, "policy_reward_max": {"policy_0": -6.191658408916657}, "policy_reward_mean": {"policy_0": -630.0318127833953}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-404.28542226215455, -9.762452998214322, -632.6919539213076, -166.03813730451924, -1075.8407849650248, -520.1955080095382, -503.888371040544, -39.31608083052134, -585.5470371976772, -309.1039085301445, -859.05903419134, -860.491721388798, -1144.2915887654653, -576.3182762365682, -657.8366954522675, -987.9386879298307, -440.377144389562, -795.89148992488, -470.57473279455166, -1039.4815060601666, -939.8507506603413, -757.9645565739803, -140.2644543170166, -459.9372827291582, -1079.4694425634407, -707.2676813846997, -1466.3537447162146, -1275.0469208304512, -418.4800957497148, -297.60853302672405, -463.43330759403966, -986.017053127943, -444.8555231391033, -609.4248218544063, -825.4430499976316, -855.2708132497465, -243.626331751322, -37.57604738289455, -217.4527748436938, -1253.6124958739035, -372.4010266796832, -373.6622846682565, -719.9715719234711, -1238.4113934873938, -927.4635049733715, -1421.4892921047492, -443.87644153022535, -783.8229558782474, -460.08325686015644, -792.4762352358167, -6.191658408916657, -147.04464477141929, -1271.1332224499572, -427.1185996403858, -635.1937063871377, -527.4114493735395, -435.25779319379717, -492.98364741646583, -906.4568163534714, -379.05482478379116, -444.99196901732336, -530.584723438909, -50.63618582700462, -969.8024171503225, -1249.733365515386, -330.32270178437017, -825.6588610969686, -543.1671959096817, -731.9525058158789, -202.41889479563255, -914.7080283910944, -989.2571839954563, -478.71842168579207, -837.3664149070847, -606.9758499422784, -778.495006606666, -761.1374656691124, -234.1816085567627, -949.0956064180511, -439.10421326757773, -1354.561592308575, -197.28219943486394, -948.1257044126984, -534.4111679382402, -407.25228063182846, -105.08245147546633, -189.62901777556172, -835.1814761898231, -81.93708856212304, -885.4704140903184, -1044.2018878694678, -32.631821026393986, -271.5788642434974, -1500.2177389880305, -160.33844536815053, -571.648969615591, -1129.1174360013229, -475.75944992802675, -975.4164661289896, -115.63764487944881], "episode_lengths": [150, 38, 150, 69, 150, 117, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 150, 71, 150, 150, 150, 150, 150, 105, 131, 150, 150, 131, 150, 150, 150, 70, 46, 64, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 34, 56, 150, 150, 150, 150, 98, 150, 150, 150, 120, 131, 54, 150, 150, 120, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 71, 150, 150, 59, 116, 150, 73, 150, 150, 150, 150, 65], "policy_policy_0_reward": [-404.28542226215455, -9.762452998214322, -632.6919539213076, -166.03813730451924, -1075.8407849650248, -520.1955080095382, -503.888371040544, -39.31608083052134, -585.5470371976772, -309.1039085301445, -859.05903419134, -860.491721388798, -1144.2915887654653, -576.3182762365682, -657.8366954522675, -987.9386879298307, -440.377144389562, -795.89148992488, -470.57473279455166, -1039.4815060601666, -939.8507506603413, -757.9645565739803, -140.2644543170166, -459.9372827291582, -1079.4694425634407, -707.2676813846997, -1466.3537447162146, -1275.0469208304512, -418.4800957497148, -297.60853302672405, -463.43330759403966, -986.017053127943, -444.8555231391033, -609.4248218544063, -825.4430499976316, -855.2708132497465, -243.626331751322, -37.57604738289455, -217.4527748436938, -1253.6124958739035, -372.4010266796832, -373.6622846682565, -719.9715719234711, -1238.4113934873938, -927.4635049733715, -1421.4892921047492, -443.87644153022535, -783.8229558782474, -460.08325686015644, -792.4762352358167, -6.191658408916657, -147.04464477141929, -1271.1332224499572, -427.1185996403858, -635.1937063871377, -527.4114493735395, -435.25779319379717, -492.98364741646583, -906.4568163534714, -379.05482478379116, -444.99196901732336, -530.584723438909, -50.63618582700462, -969.8024171503225, -1249.733365515386, -330.32270178437017, -825.6588610969686, -543.1671959096817, -731.9525058158789, -202.41889479563255, -914.7080283910944, -989.2571839954563, -478.71842168579207, -837.3664149070847, -606.9758499422784, -778.495006606666, -761.1374656691124, -234.1816085567627, -949.0956064180511, -439.10421326757773, -1354.561592308575, -197.28219943486394, -948.1257044126984, -534.4111679382402, -407.25228063182846, -105.08245147546633, -189.62901777556172, -835.1814761898231, -81.93708856212304, -885.4704140903184, -1044.2018878694678, -32.631821026393986, -271.5788642434974, -1500.2177389880305, -160.33844536815053, -571.648969615591, -1129.1174360013229, -475.75944992802675, -975.4164661289896, -115.63764487944881]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547365027505985, "mean_inference_ms": 1.670851731450295, "mean_action_processing_ms": 0.2750224662477586, "mean_env_wait_ms": 3.463759428296837, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012145042419433594, "StateBufferConnector_ms": 0.007941007614135742, "ViewRequirementAgentConnector_ms": 0.1929178237915039}, "num_episodes": 32, "episode_return_max": -6.191658408916657, "episode_return_min": -1500.2177389880305, "episode_return_mean": -630.0318127833953, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.8870422734979, "num_env_steps_trained_throughput_per_sec": 306.8870422734979, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12892.053, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12891.983, "sample_time_ms": 1131.13, "learn_time_ms": 11693.823, "learn_throughput": 342.061, "synch_weights_time_ms": 66.224}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00007", "date": "2024-08-04_06-10-58", "timestamp": 1722732058, "time_this_iter_s": 13.046604633331299, "time_total_s": 257.2785301208496, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f67250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 257.2785301208496, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.88947368421053, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 181.9048073788484, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.4835842083518704, "policy_loss": -0.013740027969470247, "vf_loss": 2.4926928678527474, "vf_explained_var": 0.9931299238776167, "kl": 0.013778774653716658, "entropy": 1.5690824979295332, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -6.191658408916657, "episode_reward_min": -1518.8592074541446, "episode_reward_mean": -656.6590555312262, "episode_len_mean": 132.73, "episode_media": {}, "episodes_timesteps_total": 13273, "policy_reward_min": {"policy_0": -1518.8592074541446}, "policy_reward_max": {"policy_0": -6.191658408916657}, "policy_reward_mean": {"policy_0": -656.6590555312262}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-463.43330759403966, -986.017053127943, -444.8555231391033, -609.4248218544063, -825.4430499976316, -855.2708132497465, -243.626331751322, -37.57604738289455, -217.4527748436938, -1253.6124958739035, -372.4010266796832, -373.6622846682565, -719.9715719234711, -1238.4113934873938, -927.4635049733715, -1421.4892921047492, -443.87644153022535, -783.8229558782474, -460.08325686015644, -792.4762352358167, -6.191658408916657, -147.04464477141929, -1271.1332224499572, -427.1185996403858, -635.1937063871377, -527.4114493735395, -435.25779319379717, -492.98364741646583, -906.4568163534714, -379.05482478379116, -444.99196901732336, -530.584723438909, -50.63618582700462, -969.8024171503225, -1249.733365515386, -330.32270178437017, -825.6588610969686, -543.1671959096817, -731.9525058158789, -202.41889479563255, -914.7080283910944, -989.2571839954563, -478.71842168579207, -837.3664149070847, -606.9758499422784, -778.495006606666, -761.1374656691124, -234.1816085567627, -949.0956064180511, -439.10421326757773, -1354.561592308575, -197.28219943486394, -948.1257044126984, -534.4111679382402, -407.25228063182846, -105.08245147546633, -189.62901777556172, -835.1814761898231, -81.93708856212304, -885.4704140903184, -1044.2018878694678, -32.631821026393986, -271.5788642434974, -1500.2177389880305, -160.33844536815053, -571.648969615591, -1129.1174360013229, -475.75944992802675, -975.4164661289896, -115.63764487944881, -1142.8685026244225, -553.5408215768923, -262.07690053210445, -440.00794005003695, -518.5763460399238, -60.8274840072169, -405.3722915053438, -821.5430035749222, -520.9694088104904, -1101.530396039279, -920.9764530692905, -1013.8734715445328, -59.337291544865735, -1140.9015197300296, -192.97000776128553, -988.824840716768, -25.38597125066669, -1249.217646671713, -194.0518843251686, -584.1957037208185, -1518.8592074541446, -1185.6120423561504, -1187.3864355301262, -1053.2227468934004, -547.2756245291441, -672.696143882051, -1019.0968684995637, -688.637491858014, -1057.035037490944, -1157.028787938599], "episode_lengths": [150, 150, 131, 150, 150, 150, 70, 46, 64, 150, 150, 150, 150, 150, 150, 150, 150, 144, 150, 150, 34, 56, 150, 150, 150, 150, 98, 150, 150, 150, 120, 131, 54, 150, 150, 120, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 71, 150, 150, 59, 116, 150, 73, 150, 150, 150, 150, 65, 150, 150, 150, 137, 150, 71, 142, 150, 150, 150, 150, 150, 53, 150, 66, 150, 44, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-463.43330759403966, -986.017053127943, -444.8555231391033, -609.4248218544063, -825.4430499976316, -855.2708132497465, -243.626331751322, -37.57604738289455, -217.4527748436938, -1253.6124958739035, -372.4010266796832, -373.6622846682565, -719.9715719234711, -1238.4113934873938, -927.4635049733715, -1421.4892921047492, -443.87644153022535, -783.8229558782474, -460.08325686015644, -792.4762352358167, -6.191658408916657, -147.04464477141929, -1271.1332224499572, -427.1185996403858, -635.1937063871377, -527.4114493735395, -435.25779319379717, -492.98364741646583, -906.4568163534714, -379.05482478379116, -444.99196901732336, -530.584723438909, -50.63618582700462, -969.8024171503225, -1249.733365515386, -330.32270178437017, -825.6588610969686, -543.1671959096817, -731.9525058158789, -202.41889479563255, -914.7080283910944, -989.2571839954563, -478.71842168579207, -837.3664149070847, -606.9758499422784, -778.495006606666, -761.1374656691124, -234.1816085567627, -949.0956064180511, -439.10421326757773, -1354.561592308575, -197.28219943486394, -948.1257044126984, -534.4111679382402, -407.25228063182846, -105.08245147546633, -189.62901777556172, -835.1814761898231, -81.93708856212304, -885.4704140903184, -1044.2018878694678, -32.631821026393986, -271.5788642434974, -1500.2177389880305, -160.33844536815053, -571.648969615591, -1129.1174360013229, -475.75944992802675, -975.4164661289896, -115.63764487944881, -1142.8685026244225, -553.5408215768923, -262.07690053210445, -440.00794005003695, -518.5763460399238, -60.8274840072169, -405.3722915053438, -821.5430035749222, -520.9694088104904, -1101.530396039279, -920.9764530692905, -1013.8734715445328, -59.337291544865735, -1140.9015197300296, -192.97000776128553, -988.824840716768, -25.38597125066669, -1249.217646671713, -194.0518843251686, -584.1957037208185, -1518.8592074541446, -1185.6120423561504, -1187.3864355301262, -1053.2227468934004, -547.2756245291441, -672.696143882051, -1019.0968684995637, -688.637491858014, -1057.035037490944, -1157.028787938599]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542725554554019, "mean_inference_ms": 1.6689506978437456, "mean_action_processing_ms": 0.27468263766847406, "mean_env_wait_ms": 3.465215098732854, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012160301208496094, "StateBufferConnector_ms": 0.0077779293060302734, "ViewRequirementAgentConnector_ms": 0.18997454643249512}, "num_episodes": 30, "episode_return_max": -6.191658408916657, "episode_return_min": -1518.8592074541446, "episode_return_mean": -656.6590555312262, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 333.4056627041313, "num_env_steps_trained_throughput_per_sec": 333.4056627041313, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12782.323, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12782.252, "sample_time_ms": 1120.467, "learn_time_ms": 11593.534, "learn_throughput": 345.02, "synch_weights_time_ms": 67.444}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00007", "date": "2024-08-04_06-11-10", "timestamp": 1722732070, "time_this_iter_s": 12.010453224182129, "time_total_s": 269.28898334503174, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01a7130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 269.28898334503174, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.60588235294118, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 190.70026415685814, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.588139708712697, "policy_loss": -0.006247376393002923, "vf_loss": 2.591290009021759, "vf_explained_var": 0.9792256472011407, "kl": 0.01026935321227332, "entropy": 1.5241341234495243, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -25.38597125066669, "episode_reward_min": -1518.8592074541446, "episode_reward_mean": -652.1873297657913, "episode_len_mean": 132.9, "episode_media": {}, "episodes_timesteps_total": 13290, "policy_reward_min": {"policy_0": -1518.8592074541446}, "policy_reward_max": {"policy_0": -25.38597125066669}, "policy_reward_mean": {"policy_0": -652.1873297657913}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-379.05482478379116, -444.99196901732336, -530.584723438909, -50.63618582700462, -969.8024171503225, -1249.733365515386, -330.32270178437017, -825.6588610969686, -543.1671959096817, -731.9525058158789, -202.41889479563255, -914.7080283910944, -989.2571839954563, -478.71842168579207, -837.3664149070847, -606.9758499422784, -778.495006606666, -761.1374656691124, -234.1816085567627, -949.0956064180511, -439.10421326757773, -1354.561592308575, -197.28219943486394, -948.1257044126984, -534.4111679382402, -407.25228063182846, -105.08245147546633, -189.62901777556172, -835.1814761898231, -81.93708856212304, -885.4704140903184, -1044.2018878694678, -32.631821026393986, -271.5788642434974, -1500.2177389880305, -160.33844536815053, -571.648969615591, -1129.1174360013229, -475.75944992802675, -975.4164661289896, -115.63764487944881, -1142.8685026244225, -553.5408215768923, -262.07690053210445, -440.00794005003695, -518.5763460399238, -60.8274840072169, -405.3722915053438, -821.5430035749222, -520.9694088104904, -1101.530396039279, -920.9764530692905, -1013.8734715445328, -59.337291544865735, -1140.9015197300296, -192.97000776128553, -988.824840716768, -25.38597125066669, -1249.217646671713, -194.0518843251686, -584.1957037208185, -1518.8592074541446, -1185.6120423561504, -1187.3864355301262, -1053.2227468934004, -547.2756245291441, -672.696143882051, -1019.0968684995637, -688.637491858014, -1057.035037490944, -1157.028787938599, -596.8391952085437, -240.06529974568636, -1111.9624329093258, -996.3712643942617, -742.5776481684842, -569.0467767963814, -402.7292659571, -380.22410206646526, -440.33374212637545, -774.603988663876, -342.06826004981747, -1299.0918299962213, -111.94418409562044, -1238.2674936066032, -238.4271154362298, -742.4536560582965, -419.4039855312667, -337.7819645401247, -908.8626144519869, -242.7294583410216, -723.7068035613651, -299.28723733526925, -47.15820556258783, -938.054565161971, -1172.557819563485, -257.9271447839695, -889.589862646283, -293.6517975300908, -1114.271429318956], "episode_lengths": [150, 120, 131, 54, 150, 150, 120, 150, 150, 150, 147, 150, 150, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 150, 150, 65, 150, 150, 71, 150, 150, 59, 116, 150, 73, 150, 150, 150, 150, 65, 150, 150, 150, 137, 150, 71, 142, 150, 150, 150, 150, 150, 53, 150, 66, 150, 44, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 74, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 57, 150, 100, 150, 150, 83, 139, 112, 150, 114, 43, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-379.05482478379116, -444.99196901732336, -530.584723438909, -50.63618582700462, -969.8024171503225, -1249.733365515386, -330.32270178437017, -825.6588610969686, -543.1671959096817, -731.9525058158789, -202.41889479563255, -914.7080283910944, -989.2571839954563, -478.71842168579207, -837.3664149070847, -606.9758499422784, -778.495006606666, -761.1374656691124, -234.1816085567627, -949.0956064180511, -439.10421326757773, -1354.561592308575, -197.28219943486394, -948.1257044126984, -534.4111679382402, -407.25228063182846, -105.08245147546633, -189.62901777556172, -835.1814761898231, -81.93708856212304, -885.4704140903184, -1044.2018878694678, -32.631821026393986, -271.5788642434974, -1500.2177389880305, -160.33844536815053, -571.648969615591, -1129.1174360013229, -475.75944992802675, -975.4164661289896, -115.63764487944881, -1142.8685026244225, -553.5408215768923, -262.07690053210445, -440.00794005003695, -518.5763460399238, -60.8274840072169, -405.3722915053438, -821.5430035749222, -520.9694088104904, -1101.530396039279, -920.9764530692905, -1013.8734715445328, -59.337291544865735, -1140.9015197300296, -192.97000776128553, -988.824840716768, -25.38597125066669, -1249.217646671713, -194.0518843251686, -584.1957037208185, -1518.8592074541446, -1185.6120423561504, -1187.3864355301262, -1053.2227468934004, -547.2756245291441, -672.696143882051, -1019.0968684995637, -688.637491858014, -1057.035037490944, -1157.028787938599, -596.8391952085437, -240.06529974568636, -1111.9624329093258, -996.3712643942617, -742.5776481684842, -569.0467767963814, -402.7292659571, -380.22410206646526, -440.33374212637545, -774.603988663876, -342.06826004981747, -1299.0918299962213, -111.94418409562044, -1238.2674936066032, -238.4271154362298, -742.4536560582965, -419.4039855312667, -337.7819645401247, -908.8626144519869, -242.7294583410216, -723.7068035613651, -299.28723733526925, -47.15820556258783, -938.054565161971, -1172.557819563485, -257.9271447839695, -889.589862646283, -293.6517975300908, -1114.271429318956]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542141106653247, "mean_inference_ms": 1.6696681593188745, "mean_action_processing_ms": 0.27482101332158354, "mean_env_wait_ms": 3.4712401629976193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012181282043457031, "StateBufferConnector_ms": 0.007800102233886719, "ViewRequirementAgentConnector_ms": 0.1909041404724121}, "num_episodes": 29, "episode_return_max": -25.38597125066669, "episode_return_min": -1518.8592074541446, "episode_return_mean": -652.1873297657913, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.1846182702131, "num_env_steps_trained_throughput_per_sec": 307.1846182702131, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12879.421, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12879.348, "sample_time_ms": 1119.465, "learn_time_ms": 11691.241, "learn_throughput": 342.136, "synch_weights_time_ms": 67.828}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00007", "date": "2024-08-04_06-11-23", "timestamp": 1722732083, "time_this_iter_s": 13.033212423324585, "time_total_s": 282.3221957683563, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270d510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 282.3221957683563, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.266666666666666, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 237.08400976657867, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.372022122517228, "policy_loss": -0.006990263109522251, "vf_loss": 2.3744770023971795, "vf_explained_var": 0.9915807520970702, "kl": 0.013966489788981563, "entropy": 1.749516993885239, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -25.38597125066669, "episode_reward_min": -1518.8592074541446, "episode_reward_mean": -674.4672414256205, "episode_len_mean": 131.41, "episode_media": {}, "episodes_timesteps_total": 13141, "policy_reward_min": {"policy_0": -1518.8592074541446}, "policy_reward_max": {"policy_0": -25.38597125066669}, "policy_reward_mean": {"policy_0": -674.4672414256205}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-189.62901777556172, -835.1814761898231, -81.93708856212304, -885.4704140903184, -1044.2018878694678, -32.631821026393986, -271.5788642434974, -1500.2177389880305, -160.33844536815053, -571.648969615591, -1129.1174360013229, -475.75944992802675, -975.4164661289896, -115.63764487944881, -1142.8685026244225, -553.5408215768923, -262.07690053210445, -440.00794005003695, -518.5763460399238, -60.8274840072169, -405.3722915053438, -821.5430035749222, -520.9694088104904, -1101.530396039279, -920.9764530692905, -1013.8734715445328, -59.337291544865735, -1140.9015197300296, -192.97000776128553, -988.824840716768, -25.38597125066669, -1249.217646671713, -194.0518843251686, -584.1957037208185, -1518.8592074541446, -1185.6120423561504, -1187.3864355301262, -1053.2227468934004, -547.2756245291441, -672.696143882051, -1019.0968684995637, -688.637491858014, -1057.035037490944, -1157.028787938599, -596.8391952085437, -240.06529974568636, -1111.9624329093258, -996.3712643942617, -742.5776481684842, -569.0467767963814, -402.7292659571, -380.22410206646526, -440.33374212637545, -774.603988663876, -342.06826004981747, -1299.0918299962213, -111.94418409562044, -1238.2674936066032, -238.4271154362298, -742.4536560582965, -419.4039855312667, -337.7819645401247, -908.8626144519869, -242.7294583410216, -723.7068035613651, -299.28723733526925, -47.15820556258783, -938.054565161971, -1172.557819563485, -257.9271447839695, -889.589862646283, -293.6517975300908, -1114.271429318956, -999.221441821665, -929.6142994536957, -947.0236996145585, -316.4731690247138, -1081.4469173170667, -1124.8314808488217, -453.3373941735133, -1446.8022708233962, -71.34382035858529, -148.86498566249594, -688.2503681864198, -233.39341699847003, -1144.5874252961885, -372.8837048554829, -971.7128170194092, -26.592292608189236, -141.09954529343872, -563.4953344041984, -414.86904034546814, -1252.5167046725571, -302.04826996547473, -813.8102229255334, -1201.8326940032516, -1289.8612730476948, -1157.4698010673849, -816.1461886415142, -112.54142833052889], "episode_lengths": [150, 150, 71, 150, 150, 59, 116, 150, 73, 150, 150, 150, 150, 65, 150, 150, 150, 137, 150, 71, 142, 150, 150, 150, 150, 150, 53, 150, 66, 150, 44, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 74, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 57, 150, 100, 150, 150, 83, 139, 112, 150, 114, 43, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 63, 117, 150, 150, 118, 150, 57, 71, 150, 136, 150, 150, 150, 150, 150, 150, 150, 77], "policy_policy_0_reward": [-189.62901777556172, -835.1814761898231, -81.93708856212304, -885.4704140903184, -1044.2018878694678, -32.631821026393986, -271.5788642434974, -1500.2177389880305, -160.33844536815053, -571.648969615591, -1129.1174360013229, -475.75944992802675, -975.4164661289896, -115.63764487944881, -1142.8685026244225, -553.5408215768923, -262.07690053210445, -440.00794005003695, -518.5763460399238, -60.8274840072169, -405.3722915053438, -821.5430035749222, -520.9694088104904, -1101.530396039279, -920.9764530692905, -1013.8734715445328, -59.337291544865735, -1140.9015197300296, -192.97000776128553, -988.824840716768, -25.38597125066669, -1249.217646671713, -194.0518843251686, -584.1957037208185, -1518.8592074541446, -1185.6120423561504, -1187.3864355301262, -1053.2227468934004, -547.2756245291441, -672.696143882051, -1019.0968684995637, -688.637491858014, -1057.035037490944, -1157.028787938599, -596.8391952085437, -240.06529974568636, -1111.9624329093258, -996.3712643942617, -742.5776481684842, -569.0467767963814, -402.7292659571, -380.22410206646526, -440.33374212637545, -774.603988663876, -342.06826004981747, -1299.0918299962213, -111.94418409562044, -1238.2674936066032, -238.4271154362298, -742.4536560582965, -419.4039855312667, -337.7819645401247, -908.8626144519869, -242.7294583410216, -723.7068035613651, -299.28723733526925, -47.15820556258783, -938.054565161971, -1172.557819563485, -257.9271447839695, -889.589862646283, -293.6517975300908, -1114.271429318956, -999.221441821665, -929.6142994536957, -947.0236996145585, -316.4731690247138, -1081.4469173170667, -1124.8314808488217, -453.3373941735133, -1446.8022708233962, -71.34382035858529, -148.86498566249594, -688.2503681864198, -233.39341699847003, -1144.5874252961885, -372.8837048554829, -971.7128170194092, -26.592292608189236, -141.09954529343872, -563.4953344041984, -414.86904034546814, -1252.5167046725571, -302.04826996547473, -813.8102229255334, -1201.8326940032516, -1289.8612730476948, -1157.4698010673849, -816.1461886415142, -112.54142833052889]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542255071380634, "mean_inference_ms": 1.6695108308175874, "mean_action_processing_ms": 0.27461660406952054, "mean_env_wait_ms": 3.473543301678464, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012465715408325195, "StateBufferConnector_ms": 0.007914543151855469, "ViewRequirementAgentConnector_ms": 0.20107197761535645}, "num_episodes": 27, "episode_return_max": -25.38597125066669, "episode_return_min": -1518.8592074541446, "episode_return_mean": -674.4672414256205, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.0522442231074, "num_env_steps_trained_throughput_per_sec": 300.0522442231074, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12893.022, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12892.948, "sample_time_ms": 1131.472, "learn_time_ms": 11693.126, "learn_throughput": 342.081, "synch_weights_time_ms": 67.535}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00007", "date": "2024-08-04_06-11-36", "timestamp": 1722732096, "time_this_iter_s": 13.344513416290283, "time_total_s": 295.6667091846466, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270db40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.6667091846466, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.05263157894737, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 210.21316987077395, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.347416294179857, "policy_loss": -0.01141798209088544, "vf_loss": 2.354522351672252, "vf_explained_var": 0.9939521332581838, "kl": 0.01279319149582536, "entropy": 1.445003838216265, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -26.592292608189236, "episode_reward_min": -1518.8592074541446, "episode_reward_mean": -703.5143954742416, "episode_len_mean": 136.62, "episode_media": {}, "episodes_timesteps_total": 13662, "policy_reward_min": {"policy_0": -1518.8592074541446}, "policy_reward_max": {"policy_0": -26.592292608189236}, "policy_reward_mean": {"policy_0": -703.5143954742416}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-194.0518843251686, -584.1957037208185, -1518.8592074541446, -1185.6120423561504, -1187.3864355301262, -1053.2227468934004, -547.2756245291441, -672.696143882051, -1019.0968684995637, -688.637491858014, -1057.035037490944, -1157.028787938599, -596.8391952085437, -240.06529974568636, -1111.9624329093258, -996.3712643942617, -742.5776481684842, -569.0467767963814, -402.7292659571, -380.22410206646526, -440.33374212637545, -774.603988663876, -342.06826004981747, -1299.0918299962213, -111.94418409562044, -1238.2674936066032, -238.4271154362298, -742.4536560582965, -419.4039855312667, -337.7819645401247, -908.8626144519869, -242.7294583410216, -723.7068035613651, -299.28723733526925, -47.15820556258783, -938.054565161971, -1172.557819563485, -257.9271447839695, -889.589862646283, -293.6517975300908, -1114.271429318956, -999.221441821665, -929.6142994536957, -947.0236996145585, -316.4731690247138, -1081.4469173170667, -1124.8314808488217, -453.3373941735133, -1446.8022708233962, -71.34382035858529, -148.86498566249594, -688.2503681864198, -233.39341699847003, -1144.5874252961885, -372.8837048554829, -971.7128170194092, -26.592292608189236, -141.09954529343872, -563.4953344041984, -414.86904034546814, -1252.5167046725571, -302.04826996547473, -813.8102229255334, -1201.8326940032516, -1289.8612730476948, -1157.4698010673849, -816.1461886415142, -112.54142833052889, -775.980060231793, -1034.8823405135056, -258.6017843126285, -785.3783938294703, -952.5039470520428, -1246.4316859050077, -439.87712054878784, -304.99273179442804, -622.3111829173491, -854.6362391229839, -753.702421835751, -657.3952973077857, -193.36999347041686, -473.92258177692304, -808.5309093374316, -1091.7100089814107, -924.2477468832985, -479.7288123999996, -686.514131835602, -270.9613818824473, -1243.5017234071008, -296.0766104476862, -676.7417748835682, -715.0540831477687, -649.0969613619577, -1171.4935224191397, -529.106819830297, -992.05041730902, -1288.8343600216997, -571.3908903144314, -669.5029030681318, -173.75358442877493], "episode_lengths": [78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 121, 74, 150, 150, 150, 150, 117, 150, 150, 150, 150, 150, 57, 150, 100, 150, 150, 83, 139, 112, 150, 114, 43, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 63, 117, 150, 150, 118, 150, 57, 71, 150, 136, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 143, 150, 150, 150, 150, 65], "policy_policy_0_reward": [-194.0518843251686, -584.1957037208185, -1518.8592074541446, -1185.6120423561504, -1187.3864355301262, -1053.2227468934004, -547.2756245291441, -672.696143882051, -1019.0968684995637, -688.637491858014, -1057.035037490944, -1157.028787938599, -596.8391952085437, -240.06529974568636, -1111.9624329093258, -996.3712643942617, -742.5776481684842, -569.0467767963814, -402.7292659571, -380.22410206646526, -440.33374212637545, -774.603988663876, -342.06826004981747, -1299.0918299962213, -111.94418409562044, -1238.2674936066032, -238.4271154362298, -742.4536560582965, -419.4039855312667, -337.7819645401247, -908.8626144519869, -242.7294583410216, -723.7068035613651, -299.28723733526925, -47.15820556258783, -938.054565161971, -1172.557819563485, -257.9271447839695, -889.589862646283, -293.6517975300908, -1114.271429318956, -999.221441821665, -929.6142994536957, -947.0236996145585, -316.4731690247138, -1081.4469173170667, -1124.8314808488217, -453.3373941735133, -1446.8022708233962, -71.34382035858529, -148.86498566249594, -688.2503681864198, -233.39341699847003, -1144.5874252961885, -372.8837048554829, -971.7128170194092, -26.592292608189236, -141.09954529343872, -563.4953344041984, -414.86904034546814, -1252.5167046725571, -302.04826996547473, -813.8102229255334, -1201.8326940032516, -1289.8612730476948, -1157.4698010673849, -816.1461886415142, -112.54142833052889, -775.980060231793, -1034.8823405135056, -258.6017843126285, -785.3783938294703, -952.5039470520428, -1246.4316859050077, -439.87712054878784, -304.99273179442804, -622.3111829173491, -854.6362391229839, -753.702421835751, -657.3952973077857, -193.36999347041686, -473.92258177692304, -808.5309093374316, -1091.7100089814107, -924.2477468832985, -479.7288123999996, -686.514131835602, -270.9613818824473, -1243.5017234071008, -296.0766104476862, -676.7417748835682, -715.0540831477687, -649.0969613619577, -1171.4935224191397, -529.106819830297, -992.05041730902, -1288.8343600216997, -571.3908903144314, -669.5029030681318, -173.75358442877493]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5543678206397022, "mean_inference_ms": 1.6698134331365673, "mean_action_processing_ms": 0.27450373684503615, "mean_env_wait_ms": 3.4758585070824193, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01264333724975586, "StateBufferConnector_ms": 0.007908344268798828, "ViewRequirementAgentConnector_ms": 0.2008838653564453}, "num_episodes": 32, "episode_return_max": -26.592292608189236, "episode_return_min": -1518.8592074541446, "episode_return_mean": -703.5143954742416, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.6318897583664, "num_env_steps_trained_throughput_per_sec": 309.6318897583664, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12862.673, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12862.599, "sample_time_ms": 1123.432, "learn_time_ms": 11671.0, "learn_throughput": 342.73, "synch_weights_time_ms": 67.354}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00007", "date": "2024-08-04_06-11-49", "timestamp": 1722732109, "time_this_iter_s": 12.930905818939209, "time_total_s": 308.5976150035858, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270e3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.5976150035858, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.747368421052634, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 181.1019006530444, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.196501759129266, "policy_loss": -0.012077211216577174, "vf_loss": 2.203990095605453, "vf_explained_var": 0.9965878733744223, "kl": 0.013649232118571794, "entropy": 1.5532801200946171, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -26.592292608189236, "episode_reward_min": -1446.8022708233962, "episode_reward_mean": -700.3845007315672, "episode_len_mean": 137.49, "episode_media": {}, "episodes_timesteps_total": 13749, "policy_reward_min": {"policy_0": -1446.8022708233962}, "policy_reward_max": {"policy_0": -26.592292608189236}, "policy_reward_mean": {"policy_0": -700.3845007315672}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-742.4536560582965, -419.4039855312667, -337.7819645401247, -908.8626144519869, -242.7294583410216, -723.7068035613651, -299.28723733526925, -47.15820556258783, -938.054565161971, -1172.557819563485, -257.9271447839695, -889.589862646283, -293.6517975300908, -1114.271429318956, -999.221441821665, -929.6142994536957, -947.0236996145585, -316.4731690247138, -1081.4469173170667, -1124.8314808488217, -453.3373941735133, -1446.8022708233962, -71.34382035858529, -148.86498566249594, -688.2503681864198, -233.39341699847003, -1144.5874252961885, -372.8837048554829, -971.7128170194092, -26.592292608189236, -141.09954529343872, -563.4953344041984, -414.86904034546814, -1252.5167046725571, -302.04826996547473, -813.8102229255334, -1201.8326940032516, -1289.8612730476948, -1157.4698010673849, -816.1461886415142, -112.54142833052889, -775.980060231793, -1034.8823405135056, -258.6017843126285, -785.3783938294703, -952.5039470520428, -1246.4316859050077, -439.87712054878784, -304.99273179442804, -622.3111829173491, -854.6362391229839, -753.702421835751, -657.3952973077857, -193.36999347041686, -473.92258177692304, -808.5309093374316, -1091.7100089814107, -924.2477468832985, -479.7288123999996, -686.514131835602, -270.9613818824473, -1243.5017234071008, -296.0766104476862, -676.7417748835682, -715.0540831477687, -649.0969613619577, -1171.4935224191397, -529.106819830297, -992.05041730902, -1288.8343600216997, -571.3908903144314, -669.5029030681318, -173.75358442877493, -493.7290653671463, -833.9600996319544, -1091.9659524024619, -650.2383170071657, -417.68787210318175, -947.3906873747005, -1414.2644399856397, -1181.230708107337, -482.74499790019763, -1141.577426612625, -99.64683354239182, -1196.2638202553749, -377.7352461247144, -556.0365473332075, -885.5305769790319, -207.83517358907616, -448.3017775526702, -178.87105375635093, -140.55966576183093, -885.9858927737346, -109.78756724993589, -784.5670366874842, -790.3646083495852, -1236.8953339438285, -882.038917752302, -1255.2887292667526, -1346.1627520210068], "episode_lengths": [150, 150, 83, 139, 112, 150, 114, 43, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 63, 117, 150, 150, 118, 150, 57, 71, 150, 136, 150, 150, 150, 150, 150, 150, 150, 77, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 150, 126, 150, 150, 150, 150, 143, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 150, 59, 150, 70, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-742.4536560582965, -419.4039855312667, -337.7819645401247, -908.8626144519869, -242.7294583410216, -723.7068035613651, -299.28723733526925, -47.15820556258783, -938.054565161971, -1172.557819563485, -257.9271447839695, -889.589862646283, -293.6517975300908, -1114.271429318956, -999.221441821665, -929.6142994536957, -947.0236996145585, -316.4731690247138, -1081.4469173170667, -1124.8314808488217, -453.3373941735133, -1446.8022708233962, -71.34382035858529, -148.86498566249594, -688.2503681864198, -233.39341699847003, -1144.5874252961885, -372.8837048554829, -971.7128170194092, -26.592292608189236, -141.09954529343872, -563.4953344041984, -414.86904034546814, -1252.5167046725571, -302.04826996547473, -813.8102229255334, -1201.8326940032516, -1289.8612730476948, -1157.4698010673849, -816.1461886415142, -112.54142833052889, -775.980060231793, -1034.8823405135056, -258.6017843126285, -785.3783938294703, -952.5039470520428, -1246.4316859050077, -439.87712054878784, -304.99273179442804, -622.3111829173491, -854.6362391229839, -753.702421835751, -657.3952973077857, -193.36999347041686, -473.92258177692304, -808.5309093374316, -1091.7100089814107, -924.2477468832985, -479.7288123999996, -686.514131835602, -270.9613818824473, -1243.5017234071008, -296.0766104476862, -676.7417748835682, -715.0540831477687, -649.0969613619577, -1171.4935224191397, -529.106819830297, -992.05041730902, -1288.8343600216997, -571.3908903144314, -669.5029030681318, -173.75358442877493, -493.7290653671463, -833.9600996319544, -1091.9659524024619, -650.2383170071657, -417.68787210318175, -947.3906873747005, -1414.2644399856397, -1181.230708107337, -482.74499790019763, -1141.577426612625, -99.64683354239182, -1196.2638202553749, -377.7352461247144, -556.0365473332075, -885.5305769790319, -207.83517358907616, -448.3017775526702, -178.87105375635093, -140.55966576183093, -885.9858927737346, -109.78756724993589, -784.5670366874842, -790.3646083495852, -1236.8953339438285, -882.038917752302, -1255.2887292667526, -1346.1627520210068]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540808714110438, "mean_inference_ms": 1.6692206351775731, "mean_action_processing_ms": 0.27449429534280495, "mean_env_wait_ms": 3.4765122179473824, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012727975845336914, "StateBufferConnector_ms": 0.008070707321166992, "ViewRequirementAgentConnector_ms": 0.2019357681274414}, "num_episodes": 27, "episode_return_max": -26.592292608189236, "episode_return_min": -1446.8022708233962, "episode_return_mean": -700.3845007315672, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.1619537212884, "num_env_steps_trained_throughput_per_sec": 312.1619537212884, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12838.174, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12838.102, "sample_time_ms": 1123.279, "learn_time_ms": 11645.066, "learn_throughput": 343.493, "synch_weights_time_ms": 68.945}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00007", "date": "2024-08-04_06-12-02", "timestamp": 1722732122, "time_this_iter_s": 12.825782299041748, "time_total_s": 321.42339730262756, "pid": 579236, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01a5990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.42339730262756, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.222222222222218, "ram_util_percent": 28.0}}
