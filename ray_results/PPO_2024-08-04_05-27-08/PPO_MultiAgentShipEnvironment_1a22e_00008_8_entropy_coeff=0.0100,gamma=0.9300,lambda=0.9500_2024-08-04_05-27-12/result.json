{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0312036276484529, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.56144223312537, "policy_loss": -0.010094434028724208, "vf_loss": 9.583453380068143, "vf_explained_var": 0.005306047759950161, "kl": 0.011867998621657232, "entropy": 1.4290314519157012, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -21.68779969750349, "episode_reward_min": -1240.8527864298903, "episode_reward_mean": -745.6487105235996, "episode_len_mean": 123.08333333333333, "episode_media": {}, "episodes_timesteps_total": 2954, "policy_reward_min": {"policy_0": -1240.8527864298903}, "policy_reward_max": {"policy_0": -21.68779969750349}, "policy_reward_mean": {"policy_0": -745.6487105235996}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-861.7315996061848, -946.2309966764959, -1018.8093418640707, -1225.9748779028005, -1240.8527864298903, -998.1721518383832, -1184.3171872212108, -1142.9470213027237, -941.9566274104704, -887.6383282077744, -620.5482212264279, -1180.7859920886622, -889.8365223208576, -21.68779969750349, -137.4323335583036, -118.8480899300283, -170.46501293976434, -1088.0977937489276, -1025.3932757918076, -50.2514895225429, -81.19849003016947, -197.43051808264931, -806.1364712715304, -1058.82612389721], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 42, 56, 49, 94, 150, 150, 45, 67, 63, 150, 150], "policy_policy_0_reward": [-861.7315996061848, -946.2309966764959, -1018.8093418640707, -1225.9748779028005, -1240.8527864298903, -998.1721518383832, -1184.3171872212108, -1142.9470213027237, -941.9566274104704, -887.6383282077744, -620.5482212264279, -1180.7859920886622, -889.8365223208576, -21.68779969750349, -137.4323335583036, -118.8480899300283, -170.46501293976434, -1088.0977937489276, -1025.3932757918076, -50.2514895225429, -81.19849003016947, -197.43051808264931, -806.1364712715304, -1058.82612389721]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5634969058556183, "mean_inference_ms": 1.6655464229782095, "mean_action_processing_ms": 0.2729124404983437, "mean_env_wait_ms": 3.3810734487845715, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01146396001180013, "StateBufferConnector_ms": 0.008268157641092936, "ViewRequirementAgentConnector_ms": 0.18191933631896973}, "num_episodes": 24, "episode_return_max": -21.68779969750349, "episode_return_min": -1240.8527864298903, "episode_return_mean": -745.6487105235996, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.30261022268746, "num_env_steps_trained_throughput_per_sec": 309.30261022268746, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12932.329, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12932.264, "sample_time_ms": 1135.461, "learn_time_ms": 11733.706, "learn_throughput": 340.898, "synch_weights_time_ms": 62.32}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00008", "date": "2024-08-04_06-12-32", "timestamp": 1722732152, "time_this_iter_s": 12.944283723831177, "time_total_s": 12.944283723831177, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01411b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.944283723831177, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.373684210526314, "ram_util_percent": 27.821052631578944}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.449262553670754, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.482700556516647, "policy_loss": -0.008425766802974976, "vf_loss": 9.503469025095304, "vf_explained_var": 0.052632468752563, "kl": 0.012837088678679724, "entropy": 1.4910095787296693, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -21.68779969750349, "episode_reward_min": -1407.600744797644, "episode_reward_mean": -786.5208767878587, "episode_len_mean": 128.7, "episode_media": {}, "episodes_timesteps_total": 6435, "policy_reward_min": {"policy_0": -1407.600744797644}, "policy_reward_max": {"policy_0": -21.68779969750349}, "policy_reward_mean": {"policy_0": -786.5208767878587}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-861.7315996061848, -946.2309966764959, -1018.8093418640707, -1225.9748779028005, -1240.8527864298903, -998.1721518383832, -1184.3171872212108, -1142.9470213027237, -941.9566274104704, -887.6383282077744, -620.5482212264279, -1180.7859920886622, -889.8365223208576, -21.68779969750349, -137.4323335583036, -118.8480899300283, -170.46501293976434, -1088.0977937489276, -1025.3932757918076, -50.2514895225429, -81.19849003016947, -197.43051808264931, -806.1364712715304, -1058.82612389721, -1323.7760999470106, -1084.8525629070155, -853.0698568013911, -405.6346363769585, -468.90338061772155, -1088.6968968351684, -569.3125065677225, -449.0534042175958, -1274.7361905826444, -65.80144932604509, -865.2577925920787, -1029.2246881443712, -1086.1149799221532, -165.47863515035232, -1047.904597431557, -867.348277705363, -663.7983763681866, -1052.141519723537, -1407.600744797644, -938.4724684575226, -740.2845281668822, -540.5755269637666, -1039.5988334090978, -129.28942073567137, -1142.3395100936134, -1131.2079029854824], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 42, 56, 49, 94, 150, 150, 45, 67, 63, 150, 150, 150, 150, 150, 108, 115, 150, 111, 96, 150, 43, 150, 150, 150, 76, 150, 150, 148, 150, 150, 150, 150, 150, 150, 84, 150, 150], "policy_policy_0_reward": [-861.7315996061848, -946.2309966764959, -1018.8093418640707, -1225.9748779028005, -1240.8527864298903, -998.1721518383832, -1184.3171872212108, -1142.9470213027237, -941.9566274104704, -887.6383282077744, -620.5482212264279, -1180.7859920886622, -889.8365223208576, -21.68779969750349, -137.4323335583036, -118.8480899300283, -170.46501293976434, -1088.0977937489276, -1025.3932757918076, -50.2514895225429, -81.19849003016947, -197.43051808264931, -806.1364712715304, -1058.82612389721, -1323.7760999470106, -1084.8525629070155, -853.0698568013911, -405.6346363769585, -468.90338061772155, -1088.6968968351684, -569.3125065677225, -449.0534042175958, -1274.7361905826444, -65.80144932604509, -865.2577925920787, -1029.2246881443712, -1086.1149799221532, -165.47863515035232, -1047.904597431557, -867.348277705363, -663.7983763681866, -1052.141519723537, -1407.600744797644, -938.4724684575226, -740.2845281668822, -540.5755269637666, -1039.5988334090978, -129.28942073567137, -1142.3395100936134, -1131.2079029854824]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5634860967029973, "mean_inference_ms": 1.6609806566648424, "mean_action_processing_ms": 0.2729335956109089, "mean_env_wait_ms": 3.3883913558861747, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013781070709228516, "StateBufferConnector_ms": 0.008298873901367188, "ViewRequirementAgentConnector_ms": 0.1840667724609375}, "num_episodes": 26, "episode_return_max": -21.68779969750349, "episode_return_min": -1407.600744797644, "episode_return_mean": -786.5208767878587, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.229940286965, "num_env_steps_trained_throughput_per_sec": 301.229940286965, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13105.617, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13105.55, "sample_time_ms": 1121.602, "learn_time_ms": 11922.582, "learn_throughput": 335.498, "synch_weights_time_ms": 60.605}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00008", "date": "2024-08-04_06-12-46", "timestamp": 1722732166, "time_this_iter_s": 13.289668083190918, "time_total_s": 26.233951807022095, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01a6cb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.233951807022095, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.115789473684206, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.730153817000488, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.748166639109453, "policy_loss": -0.010476533937617206, "vf_loss": 8.7708014468352, "vf_explained_var": 0.1914409065619111, "kl": 0.01486658602455767, "entropy": 1.5131567316750685, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -8.337961707839494, "episode_reward_min": -1407.600744797644, "episode_reward_mean": -703.4730522421194, "episode_len_mean": 121.27906976744185, "episode_media": {}, "episodes_timesteps_total": 10430, "policy_reward_min": {"policy_0": -1407.600744797644}, "policy_reward_max": {"policy_0": -8.337961707839494}, "policy_reward_mean": {"policy_0": -703.4730522421194}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-861.7315996061848, -946.2309966764959, -1018.8093418640707, -1225.9748779028005, -1240.8527864298903, -998.1721518383832, -1184.3171872212108, -1142.9470213027237, -941.9566274104704, -887.6383282077744, -620.5482212264279, -1180.7859920886622, -889.8365223208576, -21.68779969750349, -137.4323335583036, -118.8480899300283, -170.46501293976434, -1088.0977937489276, -1025.3932757918076, -50.2514895225429, -81.19849003016947, -197.43051808264931, -806.1364712715304, -1058.82612389721, -1323.7760999470106, -1084.8525629070155, -853.0698568013911, -405.6346363769585, -468.90338061772155, -1088.6968968351684, -569.3125065677225, -449.0534042175958, -1274.7361905826444, -65.80144932604509, -865.2577925920787, -1029.2246881443712, -1086.1149799221532, -165.47863515035232, -1047.904597431557, -867.348277705363, -663.7983763681866, -1052.141519723537, -1407.600744797644, -938.4724684575226, -740.2845281668822, -540.5755269637666, -1039.5988334090978, -129.28942073567137, -1142.3395100936134, -1131.2079029854824, -455.21751508628927, -1246.2085494891764, -880.7218629193297, -756.223945469421, -1053.5096596712367, -1258.8905563528385, -157.35462469836247, -694.4987578532325, -126.07099906020437, -8.337961707839494, -825.793606677732, -256.0892004549249, -224.41389656878556, -225.41981648367437, -366.764269626494, -57.18824571634328, -122.15463244205182, -228.13825170296198, -205.49353926865763, -1073.6872600843938, -274.0593685566716, -969.3622554103572, -1174.4062658821326, -93.41390506004232, -15.18678050066869, -1308.524499518031, -541.6732872839667, -743.972265884171, -898.157096566936, -369.44464215772916, -418.5233781595331, -1228.001697395485, -883.2104010201765, -598.2609397039196, -123.50859530254499, -1310.7561236929976], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 150, 150, 42, 56, 49, 94, 150, 150, 45, 67, 63, 150, 150, 150, 150, 150, 108, 115, 150, 111, 96, 150, 43, 150, 150, 150, 76, 150, 150, 148, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 136, 150, 150, 59, 125, 71, 34, 150, 89, 67, 68, 88, 40, 69, 81, 89, 150, 110, 150, 150, 44, 39, 150, 150, 150, 150, 88, 98, 150, 150, 150, 50, 150], "policy_policy_0_reward": [-861.7315996061848, -946.2309966764959, -1018.8093418640707, -1225.9748779028005, -1240.8527864298903, -998.1721518383832, -1184.3171872212108, -1142.9470213027237, -941.9566274104704, -887.6383282077744, -620.5482212264279, -1180.7859920886622, -889.8365223208576, -21.68779969750349, -137.4323335583036, -118.8480899300283, -170.46501293976434, -1088.0977937489276, -1025.3932757918076, -50.2514895225429, -81.19849003016947, -197.43051808264931, -806.1364712715304, -1058.82612389721, -1323.7760999470106, -1084.8525629070155, -853.0698568013911, -405.6346363769585, -468.90338061772155, -1088.6968968351684, -569.3125065677225, -449.0534042175958, -1274.7361905826444, -65.80144932604509, -865.2577925920787, -1029.2246881443712, -1086.1149799221532, -165.47863515035232, -1047.904597431557, -867.348277705363, -663.7983763681866, -1052.141519723537, -1407.600744797644, -938.4724684575226, -740.2845281668822, -540.5755269637666, -1039.5988334090978, -129.28942073567137, -1142.3395100936134, -1131.2079029854824, -455.21751508628927, -1246.2085494891764, -880.7218629193297, -756.223945469421, -1053.5096596712367, -1258.8905563528385, -157.35462469836247, -694.4987578532325, -126.07099906020437, -8.337961707839494, -825.793606677732, -256.0892004549249, -224.41389656878556, -225.41981648367437, -366.764269626494, -57.18824571634328, -122.15463244205182, -228.13825170296198, -205.49353926865763, -1073.6872600843938, -274.0593685566716, -969.3622554103572, -1174.4062658821326, -93.41390506004232, -15.18678050066869, -1308.524499518031, -541.6732872839667, -743.972265884171, -898.157096566936, -369.44464215772916, -418.5233781595331, -1228.001697395485, -883.2104010201765, -598.2609397039196, -123.50859530254499, -1310.7561236929976]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5647953021574711, "mean_inference_ms": 1.6621429897406685, "mean_action_processing_ms": 0.27387866694957286, "mean_env_wait_ms": 3.407896507083523, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01347591710645099, "StateBufferConnector_ms": 0.008549801138944404, "ViewRequirementAgentConnector_ms": 0.19085629041804825}, "num_episodes": 36, "episode_return_max": -8.337961707839494, "episode_return_min": -1407.600744797644, "episode_return_mean": -703.4730522421194, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.73181088421904, "num_env_steps_trained_throughput_per_sec": 306.73181088421904, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13083.985, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13083.915, "sample_time_ms": 1126.392, "learn_time_ms": 11893.934, "learn_throughput": 336.306, "synch_weights_time_ms": 62.781}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00008", "date": "2024-08-04_06-12-59", "timestamp": 1722732179, "time_this_iter_s": 13.05394172668457, "time_total_s": 39.287893533706665, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0111ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.287893533706665, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.4, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.927574266120791, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 8.73025482147932, "policy_loss": -0.009000644105738805, "vf_loss": 8.752376907567184, "vf_explained_var": 0.28624576988319556, "kl": 0.015393583436919777, "entropy": 1.620015953357021, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -8.337961707839494, "episode_reward_min": -1407.600744797644, "episode_reward_mean": -714.9965017177004, "episode_len_mean": 121.94, "episode_media": {}, "episodes_timesteps_total": 12194, "policy_reward_min": {"policy_0": -1407.600744797644}, "policy_reward_max": {"policy_0": -8.337961707839494}, "policy_reward_mean": {"policy_0": -714.9965017177004}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1025.3932757918076, -50.2514895225429, -81.19849003016947, -197.43051808264931, -806.1364712715304, -1058.82612389721, -1323.7760999470106, -1084.8525629070155, -853.0698568013911, -405.6346363769585, -468.90338061772155, -1088.6968968351684, -569.3125065677225, -449.0534042175958, -1274.7361905826444, -65.80144932604509, -865.2577925920787, -1029.2246881443712, -1086.1149799221532, -165.47863515035232, -1047.904597431557, -867.348277705363, -663.7983763681866, -1052.141519723537, -1407.600744797644, -938.4724684575226, -740.2845281668822, -540.5755269637666, -1039.5988334090978, -129.28942073567137, -1142.3395100936134, -1131.2079029854824, -455.21751508628927, -1246.2085494891764, -880.7218629193297, -756.223945469421, -1053.5096596712367, -1258.8905563528385, -157.35462469836247, -694.4987578532325, -126.07099906020437, -8.337961707839494, -825.793606677732, -256.0892004549249, -224.41389656878556, -225.41981648367437, -366.764269626494, -57.18824571634328, -122.15463244205182, -228.13825170296198, -205.49353926865763, -1073.6872600843938, -274.0593685566716, -969.3622554103572, -1174.4062658821326, -93.41390506004232, -15.18678050066869, -1308.524499518031, -541.6732872839667, -743.972265884171, -898.157096566936, -369.44464215772916, -418.5233781595331, -1228.001697395485, -883.2104010201765, -598.2609397039196, -123.50859530254499, -1310.7561236929976, -900.6221629837755, -1373.918863461675, -1092.1867263927334, -1098.3970806570326, -653.1500624351819, -1134.5070722955556, -1302.2035334588666, -803.6665672907149, -41.66107743595202, -1048.238258169423, -223.38622293024062, -52.756912526030014, -1308.7536094687505, -74.03499032438086, -859.7241663604482, -1248.790377087032, -984.6423024571671, -1256.835163949347, -364.327385770386, -1002.5423940096988, -768.2588638294408, -779.7908884837548, -858.0915376455149, -1203.3646028712465, -1165.3612163758055, -1175.351638056806, -724.6563117641624, -138.30316441552088, -92.66621202968336, -160.5738915015662, -844.7266612837257, -941.8104451966503], "episode_lengths": [150, 45, 67, 63, 150, 150, 150, 150, 150, 108, 115, 150, 111, 96, 150, 43, 150, 150, 150, 76, 150, 150, 148, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 136, 150, 150, 59, 125, 71, 34, 150, 89, 67, 68, 88, 40, 69, 81, 89, 150, 110, 150, 150, 44, 39, 150, 150, 150, 150, 88, 98, 150, 150, 150, 50, 150, 150, 150, 150, 150, 128, 150, 150, 150, 38, 150, 66, 55, 150, 61, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 145, 69, 66, 70, 150, 150], "policy_policy_0_reward": [-1025.3932757918076, -50.2514895225429, -81.19849003016947, -197.43051808264931, -806.1364712715304, -1058.82612389721, -1323.7760999470106, -1084.8525629070155, -853.0698568013911, -405.6346363769585, -468.90338061772155, -1088.6968968351684, -569.3125065677225, -449.0534042175958, -1274.7361905826444, -65.80144932604509, -865.2577925920787, -1029.2246881443712, -1086.1149799221532, -165.47863515035232, -1047.904597431557, -867.348277705363, -663.7983763681866, -1052.141519723537, -1407.600744797644, -938.4724684575226, -740.2845281668822, -540.5755269637666, -1039.5988334090978, -129.28942073567137, -1142.3395100936134, -1131.2079029854824, -455.21751508628927, -1246.2085494891764, -880.7218629193297, -756.223945469421, -1053.5096596712367, -1258.8905563528385, -157.35462469836247, -694.4987578532325, -126.07099906020437, -8.337961707839494, -825.793606677732, -256.0892004549249, -224.41389656878556, -225.41981648367437, -366.764269626494, -57.18824571634328, -122.15463244205182, -228.13825170296198, -205.49353926865763, -1073.6872600843938, -274.0593685566716, -969.3622554103572, -1174.4062658821326, -93.41390506004232, -15.18678050066869, -1308.524499518031, -541.6732872839667, -743.972265884171, -898.157096566936, -369.44464215772916, -418.5233781595331, -1228.001697395485, -883.2104010201765, -598.2609397039196, -123.50859530254499, -1310.7561236929976, -900.6221629837755, -1373.918863461675, -1092.1867263927334, -1098.3970806570326, -653.1500624351819, -1134.5070722955556, -1302.2035334588666, -803.6665672907149, -41.66107743595202, -1048.238258169423, -223.38622293024062, -52.756912526030014, -1308.7536094687505, -74.03499032438086, -859.7241663604482, -1248.790377087032, -984.6423024571671, -1256.835163949347, -364.327385770386, -1002.5423940096988, -768.2588638294408, -779.7908884837548, -858.0915376455149, -1203.3646028712465, -1165.3612163758055, -1175.351638056806, -724.6563117641624, -138.30316441552088, -92.66621202968336, -160.5738915015662, -844.7266612837257, -941.8104451966503]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5653059287171687, "mean_inference_ms": 1.6680601634779617, "mean_action_processing_ms": 0.27473106523797514, "mean_env_wait_ms": 3.4294373805032903, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01386880874633789, "StateBufferConnector_ms": 0.008725643157958984, "ViewRequirementAgentConnector_ms": 0.19092273712158203}, "num_episodes": 32, "episode_return_max": -8.337961707839494, "episode_return_min": -1407.600744797644, "episode_return_mean": -714.9965017177004, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.6912917551927, "num_env_steps_trained_throughput_per_sec": 299.6912917551927, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13149.758, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13149.691, "sample_time_ms": 1130.97, "learn_time_ms": 11951.274, "learn_throughput": 334.692, "synch_weights_time_ms": 66.655}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00008", "date": "2024-08-04_06-13-12", "timestamp": 1722732192, "time_this_iter_s": 13.357953786849976, "time_total_s": 52.64584732055664, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01411b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.64584732055664, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.95263157894737, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 34.269789186368385, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.111837654809157, "policy_loss": -0.011792254412042288, "vf_loss": 7.136285914977392, "vf_explained_var": 0.7063841937109828, "kl": 0.0183489314103781, "entropy": 1.6325793309758108, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -8.337961707839494, "episode_reward_min": -1373.918863461675, "episode_reward_mean": -718.3158703285679, "episode_len_mean": 121.85, "episode_media": {}, "episodes_timesteps_total": 12185, "policy_reward_min": {"policy_0": -1373.918863461675}, "policy_reward_max": {"policy_0": -8.337961707839494}, "policy_reward_mean": {"policy_0": -718.3158703285679}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1142.3395100936134, -1131.2079029854824, -455.21751508628927, -1246.2085494891764, -880.7218629193297, -756.223945469421, -1053.5096596712367, -1258.8905563528385, -157.35462469836247, -694.4987578532325, -126.07099906020437, -8.337961707839494, -825.793606677732, -256.0892004549249, -224.41389656878556, -225.41981648367437, -366.764269626494, -57.18824571634328, -122.15463244205182, -228.13825170296198, -205.49353926865763, -1073.6872600843938, -274.0593685566716, -969.3622554103572, -1174.4062658821326, -93.41390506004232, -15.18678050066869, -1308.524499518031, -541.6732872839667, -743.972265884171, -898.157096566936, -369.44464215772916, -418.5233781595331, -1228.001697395485, -883.2104010201765, -598.2609397039196, -123.50859530254499, -1310.7561236929976, -900.6221629837755, -1373.918863461675, -1092.1867263927334, -1098.3970806570326, -653.1500624351819, -1134.5070722955556, -1302.2035334588666, -803.6665672907149, -41.66107743595202, -1048.238258169423, -223.38622293024062, -52.756912526030014, -1308.7536094687505, -74.03499032438086, -859.7241663604482, -1248.790377087032, -984.6423024571671, -1256.835163949347, -364.327385770386, -1002.5423940096988, -768.2588638294408, -779.7908884837548, -858.0915376455149, -1203.3646028712465, -1165.3612163758055, -1175.351638056806, -724.6563117641624, -138.30316441552088, -92.66621202968336, -160.5738915015662, -844.7266612837257, -941.8104451966503, -760.1153919177464, -486.33302104930175, -911.7716390204682, -1228.9128660389467, -540.5702614105394, -966.7813778033259, -200.0142386377369, -1017.4020645427909, -940.4584279861684, -835.5976167640829, -186.39102854274412, -834.403934455708, -1295.2021204301209, -879.452704803428, -1236.9130841715412, -1133.4850843072963, -990.1607857192367, -1128.8691383765263, -1003.1279834167137, -1004.1734090903233, -841.80670812824, -83.78589846717894, -51.15507817027515, -1073.3439503651982, -291.18037569626495, -1285.5166885452243, -1101.488239253185, -147.92522123931383, -11.601305507316495, -240.160959573172], "episode_lengths": [150, 150, 150, 150, 150, 136, 150, 150, 59, 125, 71, 34, 150, 89, 67, 68, 88, 40, 69, 81, 89, 150, 110, 150, 150, 44, 39, 150, 150, 150, 150, 88, 98, 150, 150, 150, 50, 150, 150, 150, 150, 150, 128, 150, 150, 150, 38, 150, 66, 55, 150, 61, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 145, 69, 66, 70, 150, 150, 150, 104, 150, 150, 120, 150, 83, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 64, 56, 150, 103, 150, 150, 82, 34, 80], "policy_policy_0_reward": [-1142.3395100936134, -1131.2079029854824, -455.21751508628927, -1246.2085494891764, -880.7218629193297, -756.223945469421, -1053.5096596712367, -1258.8905563528385, -157.35462469836247, -694.4987578532325, -126.07099906020437, -8.337961707839494, -825.793606677732, -256.0892004549249, -224.41389656878556, -225.41981648367437, -366.764269626494, -57.18824571634328, -122.15463244205182, -228.13825170296198, -205.49353926865763, -1073.6872600843938, -274.0593685566716, -969.3622554103572, -1174.4062658821326, -93.41390506004232, -15.18678050066869, -1308.524499518031, -541.6732872839667, -743.972265884171, -898.157096566936, -369.44464215772916, -418.5233781595331, -1228.001697395485, -883.2104010201765, -598.2609397039196, -123.50859530254499, -1310.7561236929976, -900.6221629837755, -1373.918863461675, -1092.1867263927334, -1098.3970806570326, -653.1500624351819, -1134.5070722955556, -1302.2035334588666, -803.6665672907149, -41.66107743595202, -1048.238258169423, -223.38622293024062, -52.756912526030014, -1308.7536094687505, -74.03499032438086, -859.7241663604482, -1248.790377087032, -984.6423024571671, -1256.835163949347, -364.327385770386, -1002.5423940096988, -768.2588638294408, -779.7908884837548, -858.0915376455149, -1203.3646028712465, -1165.3612163758055, -1175.351638056806, -724.6563117641624, -138.30316441552088, -92.66621202968336, -160.5738915015662, -844.7266612837257, -941.8104451966503, -760.1153919177464, -486.33302104930175, -911.7716390204682, -1228.9128660389467, -540.5702614105394, -966.7813778033259, -200.0142386377369, -1017.4020645427909, -940.4584279861684, -835.5976167640829, -186.39102854274412, -834.403934455708, -1295.2021204301209, -879.452704803428, -1236.9130841715412, -1133.4850843072963, -990.1607857192367, -1128.8691383765263, -1003.1279834167137, -1004.1734090903233, -841.80670812824, -83.78589846717894, -51.15507817027515, -1073.3439503651982, -291.18037569626495, -1285.5166885452243, -1101.488239253185, -147.92522123931383, -11.601305507316495, -240.160959573172]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.56678965244859, "mean_inference_ms": 1.6740523089712085, "mean_action_processing_ms": 0.2765121200260594, "mean_env_wait_ms": 3.4558067734616262, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01339411735534668, "StateBufferConnector_ms": 0.008821964263916016, "ViewRequirementAgentConnector_ms": 0.1929612159729004}, "num_episodes": 30, "episode_return_max": -8.337961707839494, "episode_return_min": -1373.918863461675, "episode_return_mean": -718.3158703285679, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.83265024899265, "num_env_steps_trained_throughput_per_sec": 299.83265024899265, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13187.964, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13187.896, "sample_time_ms": 1144.023, "learn_time_ms": 11976.067, "learn_throughput": 333.999, "synch_weights_time_ms": 67.016}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00008", "date": "2024-08-04_06-13-26", "timestamp": 1722732206, "time_this_iter_s": 13.353906154632568, "time_total_s": 65.99975347518921, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270f640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 65.99975347518921, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 18.009999999999998, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 67.80508626699448, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 6.219536557793617, "policy_loss": -0.00906584465992637, "vf_loss": 6.241593692203363, "vf_explained_var": 0.7231299577901761, "kl": 0.014658400929207957, "entropy": 1.592295801639557, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -11.601305507316495, "episode_reward_min": -1373.918863461675, "episode_reward_mean": -788.5910827307198, "episode_len_mean": 130.28, "episode_media": {}, "episodes_timesteps_total": 13028, "policy_reward_min": {"policy_0": -1373.918863461675}, "policy_reward_max": {"policy_0": -11.601305507316495}, "policy_reward_mean": {"policy_0": -788.5910827307198}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-418.5233781595331, -1228.001697395485, -883.2104010201765, -598.2609397039196, -123.50859530254499, -1310.7561236929976, -900.6221629837755, -1373.918863461675, -1092.1867263927334, -1098.3970806570326, -653.1500624351819, -1134.5070722955556, -1302.2035334588666, -803.6665672907149, -41.66107743595202, -1048.238258169423, -223.38622293024062, -52.756912526030014, -1308.7536094687505, -74.03499032438086, -859.7241663604482, -1248.790377087032, -984.6423024571671, -1256.835163949347, -364.327385770386, -1002.5423940096988, -768.2588638294408, -779.7908884837548, -858.0915376455149, -1203.3646028712465, -1165.3612163758055, -1175.351638056806, -724.6563117641624, -138.30316441552088, -92.66621202968336, -160.5738915015662, -844.7266612837257, -941.8104451966503, -760.1153919177464, -486.33302104930175, -911.7716390204682, -1228.9128660389467, -540.5702614105394, -966.7813778033259, -200.0142386377369, -1017.4020645427909, -940.4584279861684, -835.5976167640829, -186.39102854274412, -834.403934455708, -1295.2021204301209, -879.452704803428, -1236.9130841715412, -1133.4850843072963, -990.1607857192367, -1128.8691383765263, -1003.1279834167137, -1004.1734090903233, -841.80670812824, -83.78589846717894, -51.15507817027515, -1073.3439503651982, -291.18037569626495, -1285.5166885452243, -1101.488239253185, -147.92522123931383, -11.601305507316495, -240.160959573172, -888.3601992947491, -135.7721360464957, -1314.2937636842903, -745.2022467123869, -222.94568802269444, -683.1236948554342, -600.3814339430197, -268.2333175061302, -583.2049229605409, -889.3668335925612, -1171.11035859602, -572.2681326103684, -845.4244920966426, -1193.8724988674892, -699.2962351530398, -1098.2140792571622, -1236.112413623486, -1024.6537923023166, -1055.3917967624668, -971.6131617020365, -875.4769928094905, -1037.3261750637178, -1059.6753598865168, -1311.8325928438671, -494.4277508782395, -652.9615945353701, -1119.0851051144282, -843.5317871890392, -755.3860688027639, -68.89769160709683, -652.0302601372204, -841.9735949918515], "episode_lengths": [98, 150, 150, 150, 50, 150, 150, 150, 150, 150, 128, 150, 150, 150, 38, 150, 66, 55, 150, 61, 150, 150, 150, 150, 95, 150, 150, 150, 150, 150, 150, 150, 145, 69, 66, 70, 150, 150, 150, 104, 150, 150, 120, 150, 83, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 64, 56, 150, 103, 150, 150, 82, 34, 80, 150, 58, 150, 150, 68, 150, 114, 90, 140, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 145, 64, 150, 150], "policy_policy_0_reward": [-418.5233781595331, -1228.001697395485, -883.2104010201765, -598.2609397039196, -123.50859530254499, -1310.7561236929976, -900.6221629837755, -1373.918863461675, -1092.1867263927334, -1098.3970806570326, -653.1500624351819, -1134.5070722955556, -1302.2035334588666, -803.6665672907149, -41.66107743595202, -1048.238258169423, -223.38622293024062, -52.756912526030014, -1308.7536094687505, -74.03499032438086, -859.7241663604482, -1248.790377087032, -984.6423024571671, -1256.835163949347, -364.327385770386, -1002.5423940096988, -768.2588638294408, -779.7908884837548, -858.0915376455149, -1203.3646028712465, -1165.3612163758055, -1175.351638056806, -724.6563117641624, -138.30316441552088, -92.66621202968336, -160.5738915015662, -844.7266612837257, -941.8104451966503, -760.1153919177464, -486.33302104930175, -911.7716390204682, -1228.9128660389467, -540.5702614105394, -966.7813778033259, -200.0142386377369, -1017.4020645427909, -940.4584279861684, -835.5976167640829, -186.39102854274412, -834.403934455708, -1295.2021204301209, -879.452704803428, -1236.9130841715412, -1133.4850843072963, -990.1607857192367, -1128.8691383765263, -1003.1279834167137, -1004.1734090903233, -841.80670812824, -83.78589846717894, -51.15507817027515, -1073.3439503651982, -291.18037569626495, -1285.5166885452243, -1101.488239253185, -147.92522123931383, -11.601305507316495, -240.160959573172, -888.3601992947491, -135.7721360464957, -1314.2937636842903, -745.2022467123869, -222.94568802269444, -683.1236948554342, -600.3814339430197, -268.2333175061302, -583.2049229605409, -889.3668335925612, -1171.11035859602, -572.2681326103684, -845.4244920966426, -1193.8724988674892, -699.2962351530398, -1098.2140792571622, -1236.112413623486, -1024.6537923023166, -1055.3917967624668, -971.6131617020365, -875.4769928094905, -1037.3261750637178, -1059.6753598865168, -1311.8325928438671, -494.4277508782395, -652.9615945353701, -1119.0851051144282, -843.5317871890392, -755.3860688027639, -68.89769160709683, -652.0302601372204, -841.9735949918515]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.564643280551507, "mean_inference_ms": 1.678699548855988, "mean_action_processing_ms": 0.27770242046336174, "mean_env_wait_ms": 3.4782237114170846, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013439416885375977, "StateBufferConnector_ms": 0.008643865585327148, "ViewRequirementAgentConnector_ms": 0.1888570785522461}, "num_episodes": 32, "episode_return_max": -11.601305507316495, "episode_return_min": -1373.918863461675, "episode_return_mean": -788.5910827307198, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 356.8418475895917, "num_env_steps_trained_throughput_per_sec": 356.8418475895917, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12858.214, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12858.144, "sample_time_ms": 1142.548, "learn_time_ms": 11648.047, "learn_throughput": 343.405, "synch_weights_time_ms": 66.749}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00008", "date": "2024-08-04_06-13-37", "timestamp": 1722732217, "time_this_iter_s": 11.222683191299438, "time_total_s": 77.22243666648865, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01a6cb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 77.22243666648865, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 19.3625, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 103.14172973036766, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.860089254379273, "policy_loss": -0.01091668872977607, "vf_loss": 4.883247709522645, "vf_explained_var": 0.8921687884877125, "kl": 0.017482723429278244, "entropy": 1.5738311833391587, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -11.601305507316495, "episode_reward_min": -1397.9277841777978, "episode_reward_mean": -726.1678209379548, "episode_len_mean": 128.0, "episode_media": {}, "episodes_timesteps_total": 12800, "policy_reward_min": {"policy_0": -1397.9277841777978}, "policy_reward_max": {"policy_0": -11.601305507316495}, "policy_reward_mean": {"policy_0": -726.1678209379548}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1165.3612163758055, -1175.351638056806, -724.6563117641624, -138.30316441552088, -92.66621202968336, -160.5738915015662, -844.7266612837257, -941.8104451966503, -760.1153919177464, -486.33302104930175, -911.7716390204682, -1228.9128660389467, -540.5702614105394, -966.7813778033259, -200.0142386377369, -1017.4020645427909, -940.4584279861684, -835.5976167640829, -186.39102854274412, -834.403934455708, -1295.2021204301209, -879.452704803428, -1236.9130841715412, -1133.4850843072963, -990.1607857192367, -1128.8691383765263, -1003.1279834167137, -1004.1734090903233, -841.80670812824, -83.78589846717894, -51.15507817027515, -1073.3439503651982, -291.18037569626495, -1285.5166885452243, -1101.488239253185, -147.92522123931383, -11.601305507316495, -240.160959573172, -888.3601992947491, -135.7721360464957, -1314.2937636842903, -745.2022467123869, -222.94568802269444, -683.1236948554342, -600.3814339430197, -268.2333175061302, -583.2049229605409, -889.3668335925612, -1171.11035859602, -572.2681326103684, -845.4244920966426, -1193.8724988674892, -699.2962351530398, -1098.2140792571622, -1236.112413623486, -1024.6537923023166, -1055.3917967624668, -971.6131617020365, -875.4769928094905, -1037.3261750637178, -1059.6753598865168, -1311.8325928438671, -494.4277508782395, -652.9615945353701, -1119.0851051144282, -843.5317871890392, -755.3860688027639, -68.89769160709683, -652.0302601372204, -841.9735949918515, -1014.5863871752864, -286.7840720242566, -278.6017480913159, -941.8103135501595, -814.2401830460789, -1251.8075540806494, -805.3817721813424, -328.13521177020755, -904.9238829995543, -1397.9277841777978, -95.53038856741134, -644.6933483185769, -222.53675249689437, -854.8120117466225, -1334.4173066049093, -744.672840485517, -17.8649288344661, -772.7008807618263, -385.93740430396036, -204.89850876044977, -119.92757274509529, -978.6870335186444, -546.6193660943391, -377.6704254015514, -361.85286071076354, -633.2492544716633, -982.4145798885403, -741.9566853994495, -365.9006181803208, -343.244101904863], "episode_lengths": [150, 150, 145, 69, 66, 70, 150, 150, 150, 104, 150, 150, 120, 150, 83, 150, 150, 150, 76, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 64, 56, 150, 103, 150, 150, 82, 34, 80, 150, 58, 150, 150, 68, 150, 114, 90, 140, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 145, 64, 150, 150, 150, 110, 89, 150, 150, 150, 150, 114, 150, 150, 54, 150, 69, 150, 150, 145, 39, 150, 106, 87, 53, 150, 106, 117, 114, 150, 150, 150, 87, 123], "policy_policy_0_reward": [-1165.3612163758055, -1175.351638056806, -724.6563117641624, -138.30316441552088, -92.66621202968336, -160.5738915015662, -844.7266612837257, -941.8104451966503, -760.1153919177464, -486.33302104930175, -911.7716390204682, -1228.9128660389467, -540.5702614105394, -966.7813778033259, -200.0142386377369, -1017.4020645427909, -940.4584279861684, -835.5976167640829, -186.39102854274412, -834.403934455708, -1295.2021204301209, -879.452704803428, -1236.9130841715412, -1133.4850843072963, -990.1607857192367, -1128.8691383765263, -1003.1279834167137, -1004.1734090903233, -841.80670812824, -83.78589846717894, -51.15507817027515, -1073.3439503651982, -291.18037569626495, -1285.5166885452243, -1101.488239253185, -147.92522123931383, -11.601305507316495, -240.160959573172, -888.3601992947491, -135.7721360464957, -1314.2937636842903, -745.2022467123869, -222.94568802269444, -683.1236948554342, -600.3814339430197, -268.2333175061302, -583.2049229605409, -889.3668335925612, -1171.11035859602, -572.2681326103684, -845.4244920966426, -1193.8724988674892, -699.2962351530398, -1098.2140792571622, -1236.112413623486, -1024.6537923023166, -1055.3917967624668, -971.6131617020365, -875.4769928094905, -1037.3261750637178, -1059.6753598865168, -1311.8325928438671, -494.4277508782395, -652.9615945353701, -1119.0851051144282, -843.5317871890392, -755.3860688027639, -68.89769160709683, -652.0302601372204, -841.9735949918515, -1014.5863871752864, -286.7840720242566, -278.6017480913159, -941.8103135501595, -814.2401830460789, -1251.8075540806494, -805.3817721813424, -328.13521177020755, -904.9238829995543, -1397.9277841777978, -95.53038856741134, -644.6933483185769, -222.53675249689437, -854.8120117466225, -1334.4173066049093, -744.672840485517, -17.8649288344661, -772.7008807618263, -385.93740430396036, -204.89850876044977, -119.92757274509529, -978.6870335186444, -546.6193660943391, -377.6704254015514, -361.85286071076354, -633.2492544716633, -982.4145798885403, -741.9566853994495, -365.9006181803208, -343.244101904863]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5626190348667385, "mean_inference_ms": 1.6776758671086784, "mean_action_processing_ms": 0.27781658990767255, "mean_env_wait_ms": 3.4843143318913405, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012810945510864258, "StateBufferConnector_ms": 0.008409500122070312, "ViewRequirementAgentConnector_ms": 0.1894974708557129}, "num_episodes": 30, "episode_return_max": -11.601305507316495, "episode_return_min": -1397.9277841777978, "episode_return_mean": -726.1678209379548, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 319.26418364778715, "num_env_steps_trained_throughput_per_sec": 319.26418364778715, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12811.159, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12811.078, "sample_time_ms": 1142.867, "learn_time_ms": 11602.007, "learn_throughput": 344.768, "synch_weights_time_ms": 65.411}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00008", "date": "2024-08-04_06-13-49", "timestamp": 1722732229, "time_this_iter_s": 12.54163932800293, "time_total_s": 89.76407599449158, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270ef80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 89.76407599449158, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.835294117647056, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 103.62685783704121, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.923103852321704, "policy_loss": -0.014152647705729274, "vf_loss": 4.9482268358270325, "vf_explained_var": 0.9044142396499714, "kl": 0.022493441969163547, "entropy": 1.5469011300553879, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -11.601305507316495, "episode_reward_min": -1445.2299413002609, "episode_reward_mean": -709.5095377979551, "episode_len_mean": 127.12, "episode_media": {}, "episodes_timesteps_total": 12712, "policy_reward_min": {"policy_0": -1445.2299413002609}, "policy_reward_max": {"policy_0": -11.601305507316495}, "policy_reward_mean": {"policy_0": -709.5095377979551}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1073.3439503651982, -291.18037569626495, -1285.5166885452243, -1101.488239253185, -147.92522123931383, -11.601305507316495, -240.160959573172, -888.3601992947491, -135.7721360464957, -1314.2937636842903, -745.2022467123869, -222.94568802269444, -683.1236948554342, -600.3814339430197, -268.2333175061302, -583.2049229605409, -889.3668335925612, -1171.11035859602, -572.2681326103684, -845.4244920966426, -1193.8724988674892, -699.2962351530398, -1098.2140792571622, -1236.112413623486, -1024.6537923023166, -1055.3917967624668, -971.6131617020365, -875.4769928094905, -1037.3261750637178, -1059.6753598865168, -1311.8325928438671, -494.4277508782395, -652.9615945353701, -1119.0851051144282, -843.5317871890392, -755.3860688027639, -68.89769160709683, -652.0302601372204, -841.9735949918515, -1014.5863871752864, -286.7840720242566, -278.6017480913159, -941.8103135501595, -814.2401830460789, -1251.8075540806494, -805.3817721813424, -328.13521177020755, -904.9238829995543, -1397.9277841777978, -95.53038856741134, -644.6933483185769, -222.53675249689437, -854.8120117466225, -1334.4173066049093, -744.672840485517, -17.8649288344661, -772.7008807618263, -385.93740430396036, -204.89850876044977, -119.92757274509529, -978.6870335186444, -546.6193660943391, -377.6704254015514, -361.85286071076354, -633.2492544716633, -982.4145798885403, -741.9566853994495, -365.9006181803208, -343.244101904863, -221.86898779515752, -1024.9800933381255, -843.685335668859, -739.9834410696363, -344.4396559965152, -1209.4407427330032, -838.6313692860517, -572.1973011963826, -1445.2299413002609, -743.6606655809636, -909.9520973961013, -1170.2905529897528, -141.38148097422902, -983.8670556214558, -230.83976482374229, -532.1494498030523, -895.9580653810576, -409.37612231521916, -997.373952589241, -87.16734102278417, -210.07783341207505, -941.151278545246, -125.66365733827935, -1339.0894113386787, -1131.6480873786843, -1024.9449463749488, -136.48963709522718, -364.68945787763613, -1182.27954933163, -1216.6690416158233, -119.32877268455239], "episode_lengths": [150, 103, 150, 150, 82, 34, 80, 150, 58, 150, 150, 68, 150, 114, 90, 140, 150, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 132, 150, 150, 150, 145, 64, 150, 150, 150, 110, 89, 150, 150, 150, 150, 114, 150, 150, 54, 150, 69, 150, 150, 145, 39, 150, 106, 87, 53, 150, 106, 117, 114, 150, 150, 150, 87, 123, 71, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 81, 150, 108, 120, 150, 150, 150, 68, 92, 150, 50, 150, 150, 150, 57, 91, 150, 150, 52], "policy_policy_0_reward": [-1073.3439503651982, -291.18037569626495, -1285.5166885452243, -1101.488239253185, -147.92522123931383, -11.601305507316495, -240.160959573172, -888.3601992947491, -135.7721360464957, -1314.2937636842903, -745.2022467123869, -222.94568802269444, -683.1236948554342, -600.3814339430197, -268.2333175061302, -583.2049229605409, -889.3668335925612, -1171.11035859602, -572.2681326103684, -845.4244920966426, -1193.8724988674892, -699.2962351530398, -1098.2140792571622, -1236.112413623486, -1024.6537923023166, -1055.3917967624668, -971.6131617020365, -875.4769928094905, -1037.3261750637178, -1059.6753598865168, -1311.8325928438671, -494.4277508782395, -652.9615945353701, -1119.0851051144282, -843.5317871890392, -755.3860688027639, -68.89769160709683, -652.0302601372204, -841.9735949918515, -1014.5863871752864, -286.7840720242566, -278.6017480913159, -941.8103135501595, -814.2401830460789, -1251.8075540806494, -805.3817721813424, -328.13521177020755, -904.9238829995543, -1397.9277841777978, -95.53038856741134, -644.6933483185769, -222.53675249689437, -854.8120117466225, -1334.4173066049093, -744.672840485517, -17.8649288344661, -772.7008807618263, -385.93740430396036, -204.89850876044977, -119.92757274509529, -978.6870335186444, -546.6193660943391, -377.6704254015514, -361.85286071076354, -633.2492544716633, -982.4145798885403, -741.9566853994495, -365.9006181803208, -343.244101904863, -221.86898779515752, -1024.9800933381255, -843.685335668859, -739.9834410696363, -344.4396559965152, -1209.4407427330032, -838.6313692860517, -572.1973011963826, -1445.2299413002609, -743.6606655809636, -909.9520973961013, -1170.2905529897528, -141.38148097422902, -983.8670556214558, -230.83976482374229, -532.1494498030523, -895.9580653810576, -409.37612231521916, -997.373952589241, -87.16734102278417, -210.07783341207505, -941.151278545246, -125.66365733827935, -1339.0894113386787, -1131.6480873786843, -1024.9449463749488, -136.48963709522718, -364.68945787763613, -1182.27954933163, -1216.6690416158233, -119.32877268455239]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5607563966118113, "mean_inference_ms": 1.678659963176721, "mean_action_processing_ms": 0.2776976063978074, "mean_env_wait_ms": 3.494573727761814, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012647151947021484, "StateBufferConnector_ms": 0.008125066757202148, "ViewRequirementAgentConnector_ms": 0.18920254707336426}, "num_episodes": 31, "episode_return_max": -11.601305507316495, "episode_return_min": -1445.2299413002609, "episode_return_mean": -709.5095377979551, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.19420828485323, "num_env_steps_trained_throughput_per_sec": 309.19420828485323, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12826.872, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12826.794, "sample_time_ms": 1140.486, "learn_time_ms": 11620.718, "learn_throughput": 344.213, "synch_weights_time_ms": 64.798}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00008", "date": "2024-08-04_06-14-02", "timestamp": 1722732242, "time_this_iter_s": 12.949750900268555, "time_total_s": 102.71382689476013, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a7be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.71382689476013, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.142105263157895, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 134.20282343626022, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 4.595694335798423, "policy_loss": -0.012637356098275631, "vf_loss": 4.619288296004137, "vf_explained_var": 0.9564209051430226, "kl": 0.017119522016294773, "entropy": 1.6092480191340048, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -17.8649288344661, "episode_reward_min": -1445.2299413002609, "episode_reward_mean": -723.7855148955542, "episode_len_mean": 127.6, "episode_media": {}, "episodes_timesteps_total": 12760, "policy_reward_min": {"policy_0": -1445.2299413002609}, "policy_reward_max": {"policy_0": -17.8649288344661}, "policy_reward_mean": {"policy_0": -723.7855148955542}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-652.9615945353701, -1119.0851051144282, -843.5317871890392, -755.3860688027639, -68.89769160709683, -652.0302601372204, -841.9735949918515, -1014.5863871752864, -286.7840720242566, -278.6017480913159, -941.8103135501595, -814.2401830460789, -1251.8075540806494, -805.3817721813424, -328.13521177020755, -904.9238829995543, -1397.9277841777978, -95.53038856741134, -644.6933483185769, -222.53675249689437, -854.8120117466225, -1334.4173066049093, -744.672840485517, -17.8649288344661, -772.7008807618263, -385.93740430396036, -204.89850876044977, -119.92757274509529, -978.6870335186444, -546.6193660943391, -377.6704254015514, -361.85286071076354, -633.2492544716633, -982.4145798885403, -741.9566853994495, -365.9006181803208, -343.244101904863, -221.86898779515752, -1024.9800933381255, -843.685335668859, -739.9834410696363, -344.4396559965152, -1209.4407427330032, -838.6313692860517, -572.1973011963826, -1445.2299413002609, -743.6606655809636, -909.9520973961013, -1170.2905529897528, -141.38148097422902, -983.8670556214558, -230.83976482374229, -532.1494498030523, -895.9580653810576, -409.37612231521916, -997.373952589241, -87.16734102278417, -210.07783341207505, -941.151278545246, -125.66365733827935, -1339.0894113386787, -1131.6480873786843, -1024.9449463749488, -136.48963709522718, -364.68945787763613, -1182.27954933163, -1216.6690416158233, -119.32877268455239, -1154.748185437298, -940.5126435367911, -1134.8907968010888, -879.46088562544, -757.0871431536049, -265.4095232115628, -108.0724425557305, -151.60552920403234, -1196.216884295502, -945.2597081514679, -1172.7754796609338, -895.5681521633104, -1181.9342190067375, -179.47514738011745, -1076.4792464751151, -140.67950141648885, -1102.3018801141513, -1032.9754617596632, -776.9031904224685, -174.6405921189444, -881.1348220642648, -688.6555265032854, -1023.7728773144731, -1243.6229100785051, -309.6319828270416, -1305.2380440161432, -1116.2609951600416, -1254.4230297222712, -1164.064855526128, -199.25220664830937, -975.1616316752726, -1128.1790249845785], "episode_lengths": [150, 150, 150, 145, 64, 150, 150, 150, 110, 89, 150, 150, 150, 150, 114, 150, 150, 54, 150, 69, 150, 150, 145, 39, 150, 106, 87, 53, 150, 106, 117, 114, 150, 150, 150, 87, 123, 71, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 81, 150, 108, 120, 150, 150, 150, 68, 92, 150, 50, 150, 150, 150, 57, 91, 150, 150, 52, 150, 150, 150, 150, 150, 105, 60, 95, 150, 150, 150, 150, 150, 71, 150, 70, 150, 150, 150, 61, 150, 150, 150, 150, 99, 150, 150, 150, 150, 67, 150, 150], "policy_policy_0_reward": [-652.9615945353701, -1119.0851051144282, -843.5317871890392, -755.3860688027639, -68.89769160709683, -652.0302601372204, -841.9735949918515, -1014.5863871752864, -286.7840720242566, -278.6017480913159, -941.8103135501595, -814.2401830460789, -1251.8075540806494, -805.3817721813424, -328.13521177020755, -904.9238829995543, -1397.9277841777978, -95.53038856741134, -644.6933483185769, -222.53675249689437, -854.8120117466225, -1334.4173066049093, -744.672840485517, -17.8649288344661, -772.7008807618263, -385.93740430396036, -204.89850876044977, -119.92757274509529, -978.6870335186444, -546.6193660943391, -377.6704254015514, -361.85286071076354, -633.2492544716633, -982.4145798885403, -741.9566853994495, -365.9006181803208, -343.244101904863, -221.86898779515752, -1024.9800933381255, -843.685335668859, -739.9834410696363, -344.4396559965152, -1209.4407427330032, -838.6313692860517, -572.1973011963826, -1445.2299413002609, -743.6606655809636, -909.9520973961013, -1170.2905529897528, -141.38148097422902, -983.8670556214558, -230.83976482374229, -532.1494498030523, -895.9580653810576, -409.37612231521916, -997.373952589241, -87.16734102278417, -210.07783341207505, -941.151278545246, -125.66365733827935, -1339.0894113386787, -1131.6480873786843, -1024.9449463749488, -136.48963709522718, -364.68945787763613, -1182.27954933163, -1216.6690416158233, -119.32877268455239, -1154.748185437298, -940.5126435367911, -1134.8907968010888, -879.46088562544, -757.0871431536049, -265.4095232115628, -108.0724425557305, -151.60552920403234, -1196.216884295502, -945.2597081514679, -1172.7754796609338, -895.5681521633104, -1181.9342190067375, -179.47514738011745, -1076.4792464751151, -140.67950141648885, -1102.3018801141513, -1032.9754617596632, -776.9031904224685, -174.6405921189444, -881.1348220642648, -688.6555265032854, -1023.7728773144731, -1243.6229100785051, -309.6319828270416, -1305.2380440161432, -1116.2609951600416, -1254.4230297222712, -1164.064855526128, -199.25220664830937, -975.1616316752726, -1128.1790249845785]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578506852672898, "mean_inference_ms": 1.6748623182436417, "mean_action_processing_ms": 0.2770676665975474, "mean_env_wait_ms": 3.494198057926315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012275218963623047, "StateBufferConnector_ms": 0.007943868637084961, "ViewRequirementAgentConnector_ms": 0.19025301933288574}, "num_episodes": 32, "episode_return_max": -17.8649288344661, "episode_return_min": -1445.2299413002609, "episode_return_mean": -723.7855148955542, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.84818054207364, "num_env_steps_trained_throughput_per_sec": 301.84818054207364, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12874.076, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12873.999, "sample_time_ms": 1140.892, "learn_time_ms": 11667.647, "learn_throughput": 342.828, "synch_weights_time_ms": 64.671}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00008", "date": "2024-08-04_06-14-16", "timestamp": 1722732256, "time_this_iter_s": 13.263563394546509, "time_total_s": 115.97739028930664, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01a6b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.97739028930664, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.03157894736842, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 147.18152740796407, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.726037146647771, "policy_loss": -0.00892728372127749, "vf_loss": 3.7450748135646186, "vf_explained_var": 0.957976451702416, "kl": 0.013670720329264441, "entropy": 1.4211598691840968, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -63.0462911929458, "episode_reward_min": -1445.2299413002609, "episode_reward_mean": -729.88247794423, "episode_len_mean": 129.17, "episode_media": {}, "episodes_timesteps_total": 12917, "policy_reward_min": {"policy_0": -1445.2299413002609}, "policy_reward_max": {"policy_0": -63.0462911929458}, "policy_reward_mean": {"policy_0": -729.88247794423}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-633.2492544716633, -982.4145798885403, -741.9566853994495, -365.9006181803208, -343.244101904863, -221.86898779515752, -1024.9800933381255, -843.685335668859, -739.9834410696363, -344.4396559965152, -1209.4407427330032, -838.6313692860517, -572.1973011963826, -1445.2299413002609, -743.6606655809636, -909.9520973961013, -1170.2905529897528, -141.38148097422902, -983.8670556214558, -230.83976482374229, -532.1494498030523, -895.9580653810576, -409.37612231521916, -997.373952589241, -87.16734102278417, -210.07783341207505, -941.151278545246, -125.66365733827935, -1339.0894113386787, -1131.6480873786843, -1024.9449463749488, -136.48963709522718, -364.68945787763613, -1182.27954933163, -1216.6690416158233, -119.32877268455239, -1154.748185437298, -940.5126435367911, -1134.8907968010888, -879.46088562544, -757.0871431536049, -265.4095232115628, -108.0724425557305, -151.60552920403234, -1196.216884295502, -945.2597081514679, -1172.7754796609338, -895.5681521633104, -1181.9342190067375, -179.47514738011745, -1076.4792464751151, -140.67950141648885, -1102.3018801141513, -1032.9754617596632, -776.9031904224685, -174.6405921189444, -881.1348220642648, -688.6555265032854, -1023.7728773144731, -1243.6229100785051, -309.6319828270416, -1305.2380440161432, -1116.2609951600416, -1254.4230297222712, -1164.064855526128, -199.25220664830937, -975.1616316752726, -1128.1790249845785, -478.44097588379265, -419.2827358751631, -1147.8150241267654, -658.4354088865817, -273.95507515818394, -162.49430563372565, -840.4162070997354, -898.2150760785225, -147.08699807968742, -976.2380127697689, -995.7947488798364, -442.44504250075624, -1031.2283534602232, -755.3264653261315, -1021.9618867943991, -852.3818626191145, -709.9468654610826, -1212.3718283322212, -1193.1943717756387, -450.36368267380163, -812.875597942608, -352.3676237489141, -595.7103062640923, -63.0462911929458, -208.94573026806842, -958.7564057180972, -159.15038402420964, -535.2908673791876, -903.3176336454186, -944.1608676879245, -680.6691459090948, -348.89716449733163], "episode_lengths": [150, 150, 150, 87, 123, 71, 150, 150, 150, 150, 150, 150, 120, 150, 150, 150, 150, 81, 150, 108, 120, 150, 150, 150, 68, 92, 150, 50, 150, 150, 150, 57, 91, 150, 150, 52, 150, 150, 150, 150, 150, 105, 60, 95, 150, 150, 150, 150, 150, 71, 150, 70, 150, 150, 150, 61, 150, 150, 150, 150, 99, 150, 150, 150, 150, 67, 150, 150, 135, 150, 150, 150, 92, 73, 134, 150, 57, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 129, 150, 86, 143, 49, 61, 150, 131, 114, 150, 150, 150, 87], "policy_policy_0_reward": [-633.2492544716633, -982.4145798885403, -741.9566853994495, -365.9006181803208, -343.244101904863, -221.86898779515752, -1024.9800933381255, -843.685335668859, -739.9834410696363, -344.4396559965152, -1209.4407427330032, -838.6313692860517, -572.1973011963826, -1445.2299413002609, -743.6606655809636, -909.9520973961013, -1170.2905529897528, -141.38148097422902, -983.8670556214558, -230.83976482374229, -532.1494498030523, -895.9580653810576, -409.37612231521916, -997.373952589241, -87.16734102278417, -210.07783341207505, -941.151278545246, -125.66365733827935, -1339.0894113386787, -1131.6480873786843, -1024.9449463749488, -136.48963709522718, -364.68945787763613, -1182.27954933163, -1216.6690416158233, -119.32877268455239, -1154.748185437298, -940.5126435367911, -1134.8907968010888, -879.46088562544, -757.0871431536049, -265.4095232115628, -108.0724425557305, -151.60552920403234, -1196.216884295502, -945.2597081514679, -1172.7754796609338, -895.5681521633104, -1181.9342190067375, -179.47514738011745, -1076.4792464751151, -140.67950141648885, -1102.3018801141513, -1032.9754617596632, -776.9031904224685, -174.6405921189444, -881.1348220642648, -688.6555265032854, -1023.7728773144731, -1243.6229100785051, -309.6319828270416, -1305.2380440161432, -1116.2609951600416, -1254.4230297222712, -1164.064855526128, -199.25220664830937, -975.1616316752726, -1128.1790249845785, -478.44097588379265, -419.2827358751631, -1147.8150241267654, -658.4354088865817, -273.95507515818394, -162.49430563372565, -840.4162070997354, -898.2150760785225, -147.08699807968742, -976.2380127697689, -995.7947488798364, -442.44504250075624, -1031.2283534602232, -755.3264653261315, -1021.9618867943991, -852.3818626191145, -709.9468654610826, -1212.3718283322212, -1193.1943717756387, -450.36368267380163, -812.875597942608, -352.3676237489141, -595.7103062640923, -63.0462911929458, -208.94573026806842, -958.7564057180972, -159.15038402420964, -535.2908673791876, -903.3176336454186, -944.1608676879245, -680.6691459090948, -348.89716449733163]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5559818589773475, "mean_inference_ms": 1.6737273597505, "mean_action_processing_ms": 0.27623307875390746, "mean_env_wait_ms": 3.4939991065640315, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012092351913452148, "StateBufferConnector_ms": 0.007931947708129883, "ViewRequirementAgentConnector_ms": 0.19066119194030762}, "num_episodes": 32, "episode_return_max": -63.0462911929458, "episode_return_min": -1445.2299413002609, "episode_return_mean": -729.88247794423, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.6770976925045, "num_env_steps_trained_throughput_per_sec": 311.6770976925045, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12870.05, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12869.97, "sample_time_ms": 1139.953, "learn_time_ms": 11663.254, "learn_throughput": 342.957, "synch_weights_time_ms": 65.978}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00008", "date": "2024-08-04_06-14-29", "timestamp": 1722732269, "time_this_iter_s": 12.845936059951782, "time_total_s": 128.82332634925842, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270ef80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 128.82332634925842, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.333333333333332, "ram_util_percent": 27.92222222222222}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 188.1962347884973, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.2886483244597913, "policy_loss": -0.01284558991076968, "vf_loss": 3.3111196175217628, "vf_explained_var": 0.9707347409799695, "kl": 0.013765706670164959, "entropy": 1.375541669006149, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -17.616151927932304, "episode_reward_min": -1305.2380440161432, "episode_reward_mean": -710.0459427369933, "episode_len_mean": 129.04, "episode_media": {}, "episodes_timesteps_total": 12904, "policy_reward_min": {"policy_0": -1305.2380440161432}, "policy_reward_max": {"policy_0": -17.616151927932304}, "policy_reward_mean": {"policy_0": -710.0459427369933}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1024.9449463749488, -136.48963709522718, -364.68945787763613, -1182.27954933163, -1216.6690416158233, -119.32877268455239, -1154.748185437298, -940.5126435367911, -1134.8907968010888, -879.46088562544, -757.0871431536049, -265.4095232115628, -108.0724425557305, -151.60552920403234, -1196.216884295502, -945.2597081514679, -1172.7754796609338, -895.5681521633104, -1181.9342190067375, -179.47514738011745, -1076.4792464751151, -140.67950141648885, -1102.3018801141513, -1032.9754617596632, -776.9031904224685, -174.6405921189444, -881.1348220642648, -688.6555265032854, -1023.7728773144731, -1243.6229100785051, -309.6319828270416, -1305.2380440161432, -1116.2609951600416, -1254.4230297222712, -1164.064855526128, -199.25220664830937, -975.1616316752726, -1128.1790249845785, -478.44097588379265, -419.2827358751631, -1147.8150241267654, -658.4354088865817, -273.95507515818394, -162.49430563372565, -840.4162070997354, -898.2150760785225, -147.08699807968742, -976.2380127697689, -995.7947488798364, -442.44504250075624, -1031.2283534602232, -755.3264653261315, -1021.9618867943991, -852.3818626191145, -709.9468654610826, -1212.3718283322212, -1193.1943717756387, -450.36368267380163, -812.875597942608, -352.3676237489141, -595.7103062640923, -63.0462911929458, -208.94573026806842, -958.7564057180972, -159.15038402420964, -535.2908673791876, -903.3176336454186, -944.1608676879245, -680.6691459090948, -348.89716449733163, -627.3421833982138, -1247.189360341297, -1089.4493765594439, -638.9434145549214, -874.651705960442, -591.6044657630239, -234.56016129146545, -668.3827969325732, -318.45325475914956, -140.50203427088118, -85.76761964656103, -1102.921365082048, -723.4266576492728, -589.2611408209871, -695.035619816117, -849.1653779588902, -55.360293582586856, -435.8829775386709, -462.23346014539686, -445.5655031527288, -358.43327140059404, -401.3465751715001, -776.9060391166443, -1222.9666303958575, -17.616151927932304, -998.2145436524169, -593.4419673325068, -1232.1194218228065, -1155.0100345334877, -541.461999437305], "episode_lengths": [150, 57, 91, 150, 150, 52, 150, 150, 150, 150, 150, 105, 60, 95, 150, 150, 150, 150, 150, 71, 150, 70, 150, 150, 150, 61, 150, 150, 150, 150, 99, 150, 150, 150, 150, 67, 150, 150, 135, 150, 150, 150, 92, 73, 134, 150, 57, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 129, 150, 86, 143, 49, 61, 150, 131, 114, 150, 150, 150, 87, 150, 150, 150, 142, 150, 150, 114, 129, 87, 84, 74, 150, 150, 150, 150, 150, 51, 121, 103, 150, 150, 137, 150, 150, 43, 150, 124, 150, 150, 148], "policy_policy_0_reward": [-1024.9449463749488, -136.48963709522718, -364.68945787763613, -1182.27954933163, -1216.6690416158233, -119.32877268455239, -1154.748185437298, -940.5126435367911, -1134.8907968010888, -879.46088562544, -757.0871431536049, -265.4095232115628, -108.0724425557305, -151.60552920403234, -1196.216884295502, -945.2597081514679, -1172.7754796609338, -895.5681521633104, -1181.9342190067375, -179.47514738011745, -1076.4792464751151, -140.67950141648885, -1102.3018801141513, -1032.9754617596632, -776.9031904224685, -174.6405921189444, -881.1348220642648, -688.6555265032854, -1023.7728773144731, -1243.6229100785051, -309.6319828270416, -1305.2380440161432, -1116.2609951600416, -1254.4230297222712, -1164.064855526128, -199.25220664830937, -975.1616316752726, -1128.1790249845785, -478.44097588379265, -419.2827358751631, -1147.8150241267654, -658.4354088865817, -273.95507515818394, -162.49430563372565, -840.4162070997354, -898.2150760785225, -147.08699807968742, -976.2380127697689, -995.7947488798364, -442.44504250075624, -1031.2283534602232, -755.3264653261315, -1021.9618867943991, -852.3818626191145, -709.9468654610826, -1212.3718283322212, -1193.1943717756387, -450.36368267380163, -812.875597942608, -352.3676237489141, -595.7103062640923, -63.0462911929458, -208.94573026806842, -958.7564057180972, -159.15038402420964, -535.2908673791876, -903.3176336454186, -944.1608676879245, -680.6691459090948, -348.89716449733163, -627.3421833982138, -1247.189360341297, -1089.4493765594439, -638.9434145549214, -874.651705960442, -591.6044657630239, -234.56016129146545, -668.3827969325732, -318.45325475914956, -140.50203427088118, -85.76761964656103, -1102.921365082048, -723.4266576492728, -589.2611408209871, -695.035619816117, -849.1653779588902, -55.360293582586856, -435.8829775386709, -462.23346014539686, -445.5655031527288, -358.43327140059404, -401.3465751715001, -776.9060391166443, -1222.9666303958575, -17.616151927932304, -998.2145436524169, -593.4419673325068, -1232.1194218228065, -1155.0100345334877, -541.461999437305]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5552488067335095, "mean_inference_ms": 1.6754545949901576, "mean_action_processing_ms": 0.2761521150739366, "mean_env_wait_ms": 3.4979641719931247, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01196742057800293, "StateBufferConnector_ms": 0.008018970489501953, "ViewRequirementAgentConnector_ms": 0.19084787368774414}, "num_episodes": 30, "episode_return_max": -17.616151927932304, "episode_return_min": -1305.2380440161432, "episode_return_mean": -710.0459427369933, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.9558251461936, "num_env_steps_trained_throughput_per_sec": 296.9558251461936, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12923.82, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12923.739, "sample_time_ms": 1150.421, "learn_time_ms": 11706.209, "learn_throughput": 341.699, "synch_weights_time_ms": 66.321}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00008", "date": "2024-08-04_06-14-42", "timestamp": 1722732282, "time_this_iter_s": 13.483585834503174, "time_total_s": 142.3069121837616, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7a7be0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 142.3069121837616, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.49473684210526, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 182.44493680198988, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.4605841408173244, "policy_loss": -0.009606261784695865, "vf_loss": 3.47981578707695, "vf_explained_var": 0.9794054659083485, "kl": 0.01695676818779551, "entropy": 1.4712423743059238, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -17.616151927932304, "episode_reward_min": -1305.2380440161432, "episode_reward_mean": -643.0824697340852, "episode_len_mean": 124.87, "episode_media": {}, "episodes_timesteps_total": 12487, "policy_reward_min": {"policy_0": -1305.2380440161432}, "policy_reward_max": {"policy_0": -17.616151927932304}, "policy_reward_mean": {"policy_0": -643.0824697340852}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1305.2380440161432, -1116.2609951600416, -1254.4230297222712, -1164.064855526128, -199.25220664830937, -975.1616316752726, -1128.1790249845785, -478.44097588379265, -419.2827358751631, -1147.8150241267654, -658.4354088865817, -273.95507515818394, -162.49430563372565, -840.4162070997354, -898.2150760785225, -147.08699807968742, -976.2380127697689, -995.7947488798364, -442.44504250075624, -1031.2283534602232, -755.3264653261315, -1021.9618867943991, -852.3818626191145, -709.9468654610826, -1212.3718283322212, -1193.1943717756387, -450.36368267380163, -812.875597942608, -352.3676237489141, -595.7103062640923, -63.0462911929458, -208.94573026806842, -958.7564057180972, -159.15038402420964, -535.2908673791876, -903.3176336454186, -944.1608676879245, -680.6691459090948, -348.89716449733163, -627.3421833982138, -1247.189360341297, -1089.4493765594439, -638.9434145549214, -874.651705960442, -591.6044657630239, -234.56016129146545, -668.3827969325732, -318.45325475914956, -140.50203427088118, -85.76761964656103, -1102.921365082048, -723.4266576492728, -589.2611408209871, -695.035619816117, -849.1653779588902, -55.360293582586856, -435.8829775386709, -462.23346014539686, -445.5655031527288, -358.43327140059404, -401.3465751715001, -776.9060391166443, -1222.9666303958575, -17.616151927932304, -998.2145436524169, -593.4419673325068, -1232.1194218228065, -1155.0100345334877, -541.461999437305, -132.82703597019432, -247.52345308198693, -882.7224871641247, -187.23714674724152, -68.22509578955723, -380.21446626154676, -1289.515330417354, -158.67146166718496, -539.7818113476018, -39.094179261040466, -545.9772876090314, -950.9782095753744, -731.4943843040159, -210.2717326640546, -174.2282841703981, -1094.3252087221745, -114.04330104986686, -134.04950548227498, -594.9163117406217, -94.12269990204165, -271.294164884425, -994.3634851027189, -1301.7384568052717, -862.3413174681949, -846.1871501383281, -236.77344444225383, -703.8594459836837, -1024.39299364606, -298.58203808872645, -756.7744635767269, -895.3424829029486], "episode_lengths": [150, 150, 150, 150, 67, 150, 150, 135, 150, 150, 150, 92, 73, 134, 150, 57, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 129, 150, 86, 143, 49, 61, 150, 131, 114, 150, 150, 150, 87, 150, 150, 150, 142, 150, 150, 114, 129, 87, 84, 74, 150, 150, 150, 150, 150, 51, 121, 103, 150, 150, 137, 150, 150, 43, 150, 124, 150, 150, 148, 65, 77, 150, 67, 60, 88, 150, 64, 150, 48, 107, 150, 150, 70, 77, 150, 85, 73, 150, 73, 106, 150, 150, 150, 150, 105, 150, 150, 79, 150, 150], "policy_policy_0_reward": [-1305.2380440161432, -1116.2609951600416, -1254.4230297222712, -1164.064855526128, -199.25220664830937, -975.1616316752726, -1128.1790249845785, -478.44097588379265, -419.2827358751631, -1147.8150241267654, -658.4354088865817, -273.95507515818394, -162.49430563372565, -840.4162070997354, -898.2150760785225, -147.08699807968742, -976.2380127697689, -995.7947488798364, -442.44504250075624, -1031.2283534602232, -755.3264653261315, -1021.9618867943991, -852.3818626191145, -709.9468654610826, -1212.3718283322212, -1193.1943717756387, -450.36368267380163, -812.875597942608, -352.3676237489141, -595.7103062640923, -63.0462911929458, -208.94573026806842, -958.7564057180972, -159.15038402420964, -535.2908673791876, -903.3176336454186, -944.1608676879245, -680.6691459090948, -348.89716449733163, -627.3421833982138, -1247.189360341297, -1089.4493765594439, -638.9434145549214, -874.651705960442, -591.6044657630239, -234.56016129146545, -668.3827969325732, -318.45325475914956, -140.50203427088118, -85.76761964656103, -1102.921365082048, -723.4266576492728, -589.2611408209871, -695.035619816117, -849.1653779588902, -55.360293582586856, -435.8829775386709, -462.23346014539686, -445.5655031527288, -358.43327140059404, -401.3465751715001, -776.9060391166443, -1222.9666303958575, -17.616151927932304, -998.2145436524169, -593.4419673325068, -1232.1194218228065, -1155.0100345334877, -541.461999437305, -132.82703597019432, -247.52345308198693, -882.7224871641247, -187.23714674724152, -68.22509578955723, -380.21446626154676, -1289.515330417354, -158.67146166718496, -539.7818113476018, -39.094179261040466, -545.9772876090314, -950.9782095753744, -731.4943843040159, -210.2717326640546, -174.2282841703981, -1094.3252087221745, -114.04330104986686, -134.04950548227498, -594.9163117406217, -94.12269990204165, -271.294164884425, -994.3634851027189, -1301.7384568052717, -862.3413174681949, -846.1871501383281, -236.77344444225383, -703.8594459836837, -1024.39299364606, -298.58203808872645, -756.7744635767269, -895.3424829029486]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548056042506597, "mean_inference_ms": 1.6791644098752854, "mean_action_processing_ms": 0.27626683047885603, "mean_env_wait_ms": 3.4982032086699046, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011917591094970703, "StateBufferConnector_ms": 0.008020877838134766, "ViewRequirementAgentConnector_ms": 0.18984675407409668}, "num_episodes": 31, "episode_return_max": -17.616151927932304, "episode_return_min": -1305.2380440161432, "episode_return_mean": -643.0824697340852, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.0832583101446, "num_env_steps_trained_throughput_per_sec": 302.0832583101446, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12920.069, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12919.988, "sample_time_ms": 1149.222, "learn_time_ms": 11703.325, "learn_throughput": 341.783, "synch_weights_time_ms": 66.652}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00008", "date": "2024-08-04_06-14-55", "timestamp": 1722732295, "time_this_iter_s": 13.254743099212646, "time_total_s": 155.56165528297424, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923727b5990>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 155.56165528297424, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.91578947368421, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 184.20294772585234, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.0184873235722383, "policy_loss": -0.012983179082705949, "vf_loss": 3.040419094885389, "vf_explained_var": 0.9866903472070893, "kl": 0.016665088529756168, "entropy": 1.3948114916682244, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -14.037527717487727, "episode_reward_min": -1468.9565582782577, "episode_reward_mean": -635.1381243310899, "episode_len_mean": 123.14, "episode_media": {}, "episodes_timesteps_total": 12314, "policy_reward_min": {"policy_0": -1468.9565582782577}, "policy_reward_max": {"policy_0": -14.037527717487727}, "policy_reward_mean": {"policy_0": -635.1381243310899}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-535.2908673791876, -903.3176336454186, -944.1608676879245, -680.6691459090948, -348.89716449733163, -627.3421833982138, -1247.189360341297, -1089.4493765594439, -638.9434145549214, -874.651705960442, -591.6044657630239, -234.56016129146545, -668.3827969325732, -318.45325475914956, -140.50203427088118, -85.76761964656103, -1102.921365082048, -723.4266576492728, -589.2611408209871, -695.035619816117, -849.1653779588902, -55.360293582586856, -435.8829775386709, -462.23346014539686, -445.5655031527288, -358.43327140059404, -401.3465751715001, -776.9060391166443, -1222.9666303958575, -17.616151927932304, -998.2145436524169, -593.4419673325068, -1232.1194218228065, -1155.0100345334877, -541.461999437305, -132.82703597019432, -247.52345308198693, -882.7224871641247, -187.23714674724152, -68.22509578955723, -380.21446626154676, -1289.515330417354, -158.67146166718496, -539.7818113476018, -39.094179261040466, -545.9772876090314, -950.9782095753744, -731.4943843040159, -210.2717326640546, -174.2282841703981, -1094.3252087221745, -114.04330104986686, -134.04950548227498, -594.9163117406217, -94.12269990204165, -271.294164884425, -994.3634851027189, -1301.7384568052717, -862.3413174681949, -846.1871501383281, -236.77344444225383, -703.8594459836837, -1024.39299364606, -298.58203808872645, -756.7744635767269, -895.3424829029486, -439.1954390328615, -1151.9476586947437, -280.94824290781787, -217.2804078705291, -1135.5021116527146, -1114.4786742093877, -1065.3307454987607, -407.9497449922605, -14.037527717487727, -176.02308040786986, -149.44635139497706, -1383.4407944523364, -1034.2032445646926, -211.07505791487804, -465.1066989305443, -978.1138838605449, -366.8531681187535, -1076.4125909437557, -1468.9565582782577, -898.2357959016255, -1136.445685746316, -80.42056841408098, -1230.024502265086, -953.0833012124467, -348.06493645960427, -833.1238938357185, -477.68977650640153, -757.0059787085493, -958.6345117782944, -500.8804053805357, -1227.7606644064674, -380.84694366014355, -1205.125358406822, -42.74820988201933], "episode_lengths": [114, 150, 150, 150, 87, 150, 150, 150, 142, 150, 150, 114, 129, 87, 84, 74, 150, 150, 150, 150, 150, 51, 121, 103, 150, 150, 137, 150, 150, 43, 150, 124, 150, 150, 148, 65, 77, 150, 67, 60, 88, 150, 64, 150, 48, 107, 150, 150, 70, 77, 150, 85, 73, 150, 73, 106, 150, 150, 150, 150, 105, 150, 150, 79, 150, 150, 146, 150, 125, 81, 150, 150, 150, 135, 30, 82, 63, 150, 150, 90, 150, 150, 87, 150, 150, 150, 150, 58, 150, 150, 83, 149, 118, 150, 150, 150, 150, 120, 150, 45], "policy_policy_0_reward": [-535.2908673791876, -903.3176336454186, -944.1608676879245, -680.6691459090948, -348.89716449733163, -627.3421833982138, -1247.189360341297, -1089.4493765594439, -638.9434145549214, -874.651705960442, -591.6044657630239, -234.56016129146545, -668.3827969325732, -318.45325475914956, -140.50203427088118, -85.76761964656103, -1102.921365082048, -723.4266576492728, -589.2611408209871, -695.035619816117, -849.1653779588902, -55.360293582586856, -435.8829775386709, -462.23346014539686, -445.5655031527288, -358.43327140059404, -401.3465751715001, -776.9060391166443, -1222.9666303958575, -17.616151927932304, -998.2145436524169, -593.4419673325068, -1232.1194218228065, -1155.0100345334877, -541.461999437305, -132.82703597019432, -247.52345308198693, -882.7224871641247, -187.23714674724152, -68.22509578955723, -380.21446626154676, -1289.515330417354, -158.67146166718496, -539.7818113476018, -39.094179261040466, -545.9772876090314, -950.9782095753744, -731.4943843040159, -210.2717326640546, -174.2282841703981, -1094.3252087221745, -114.04330104986686, -134.04950548227498, -594.9163117406217, -94.12269990204165, -271.294164884425, -994.3634851027189, -1301.7384568052717, -862.3413174681949, -846.1871501383281, -236.77344444225383, -703.8594459836837, -1024.39299364606, -298.58203808872645, -756.7744635767269, -895.3424829029486, -439.1954390328615, -1151.9476586947437, -280.94824290781787, -217.2804078705291, -1135.5021116527146, -1114.4786742093877, -1065.3307454987607, -407.9497449922605, -14.037527717487727, -176.02308040786986, -149.44635139497706, -1383.4407944523364, -1034.2032445646926, -211.07505791487804, -465.1066989305443, -978.1138838605449, -366.8531681187535, -1076.4125909437557, -1468.9565582782577, -898.2357959016255, -1136.445685746316, -80.42056841408098, -1230.024502265086, -953.0833012124467, -348.06493645960427, -833.1238938357185, -477.68977650640153, -757.0059787085493, -958.6345117782944, -500.8804053805357, -1227.7606644064674, -380.84694366014355, -1205.125358406822, -42.74820988201933]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5557737528102318, "mean_inference_ms": 1.6834499318591156, "mean_action_processing_ms": 0.2763815382242041, "mean_env_wait_ms": 3.499985300930477, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012031793594360352, "StateBufferConnector_ms": 0.008004188537597656, "ViewRequirementAgentConnector_ms": 0.19144248962402344}, "num_episodes": 34, "episode_return_max": -14.037527717487727, "episode_return_min": -1468.9565582782577, "episode_return_mean": -635.1381243310899, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.7384547769266, "num_env_steps_trained_throughput_per_sec": 301.7384547769266, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12941.65, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12941.566, "sample_time_ms": 1149.984, "learn_time_ms": 11723.469, "learn_throughput": 341.196, "synch_weights_time_ms": 67.339}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00008", "date": "2024-08-04_06-15-09", "timestamp": 1722732309, "time_this_iter_s": 13.268807649612427, "time_total_s": 168.83046293258667, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0111ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 168.83046293258667, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.95263157894737, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.86641199787456, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.903551660105586, "policy_loss": -0.01705794832329654, "vf_loss": 2.931046700353424, "vf_explained_var": 0.9893668428063392, "kl": 0.01562977179561738, "entropy": 1.5126032131413618, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -14.037527717487727, "episode_reward_min": -1468.9565582782577, "episode_reward_mean": -671.7575025427633, "episode_len_mean": 125.29, "episode_media": {}, "episodes_timesteps_total": 12529, "policy_reward_min": {"policy_0": -1468.9565582782577}, "policy_reward_max": {"policy_0": -14.037527717487727}, "policy_reward_mean": {"policy_0": -671.7575025427633}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-593.4419673325068, -1232.1194218228065, -1155.0100345334877, -541.461999437305, -132.82703597019432, -247.52345308198693, -882.7224871641247, -187.23714674724152, -68.22509578955723, -380.21446626154676, -1289.515330417354, -158.67146166718496, -539.7818113476018, -39.094179261040466, -545.9772876090314, -950.9782095753744, -731.4943843040159, -210.2717326640546, -174.2282841703981, -1094.3252087221745, -114.04330104986686, -134.04950548227498, -594.9163117406217, -94.12269990204165, -271.294164884425, -994.3634851027189, -1301.7384568052717, -862.3413174681949, -846.1871501383281, -236.77344444225383, -703.8594459836837, -1024.39299364606, -298.58203808872645, -756.7744635767269, -895.3424829029486, -439.1954390328615, -1151.9476586947437, -280.94824290781787, -217.2804078705291, -1135.5021116527146, -1114.4786742093877, -1065.3307454987607, -407.9497449922605, -14.037527717487727, -176.02308040786986, -149.44635139497706, -1383.4407944523364, -1034.2032445646926, -211.07505791487804, -465.1066989305443, -978.1138838605449, -366.8531681187535, -1076.4125909437557, -1468.9565582782577, -898.2357959016255, -1136.445685746316, -80.42056841408098, -1230.024502265086, -953.0833012124467, -348.06493645960427, -833.1238938357185, -477.68977650640153, -757.0059787085493, -958.6345117782944, -500.8804053805357, -1227.7606644064674, -380.84694366014355, -1205.125358406822, -42.74820988201933, -1122.3004572517718, -669.5739667305627, -1170.5184499618533, -1045.0863921180319, -1097.1849248028823, -914.2022006644544, -826.3301664638019, -388.25568262464463, -1090.6391587592195, -738.2404311718932, -1081.2531010879025, -722.3636429928689, -393.17061429216204, -528.3946431001292, -939.4060695549134, -580.49313428098, -868.1457201359606, -244.1916588372077, -386.5215247196678, -67.72154754489252, -1045.2154824905983, -1356.14942072307, -1136.1575401484092, -948.1589180829736, -89.4316955685999, -83.7376490058071, -51.407476034831106, -1062.8690008004965, -980.108137352739, -757.1394875742311, -341.08718629835573], "episode_lengths": [124, 150, 150, 148, 65, 77, 150, 67, 60, 88, 150, 64, 150, 48, 107, 150, 150, 70, 77, 150, 85, 73, 150, 73, 106, 150, 150, 150, 150, 105, 150, 150, 79, 150, 150, 146, 150, 125, 81, 150, 150, 150, 135, 30, 82, 63, 150, 150, 90, 150, 150, 87, 150, 150, 150, 150, 58, 150, 150, 83, 149, 118, 150, 150, 150, 150, 120, 150, 45, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 125, 150, 150, 150, 97, 150, 53, 150, 150, 150, 150, 84, 71, 59, 150, 150, 132, 150], "policy_policy_0_reward": [-593.4419673325068, -1232.1194218228065, -1155.0100345334877, -541.461999437305, -132.82703597019432, -247.52345308198693, -882.7224871641247, -187.23714674724152, -68.22509578955723, -380.21446626154676, -1289.515330417354, -158.67146166718496, -539.7818113476018, -39.094179261040466, -545.9772876090314, -950.9782095753744, -731.4943843040159, -210.2717326640546, -174.2282841703981, -1094.3252087221745, -114.04330104986686, -134.04950548227498, -594.9163117406217, -94.12269990204165, -271.294164884425, -994.3634851027189, -1301.7384568052717, -862.3413174681949, -846.1871501383281, -236.77344444225383, -703.8594459836837, -1024.39299364606, -298.58203808872645, -756.7744635767269, -895.3424829029486, -439.1954390328615, -1151.9476586947437, -280.94824290781787, -217.2804078705291, -1135.5021116527146, -1114.4786742093877, -1065.3307454987607, -407.9497449922605, -14.037527717487727, -176.02308040786986, -149.44635139497706, -1383.4407944523364, -1034.2032445646926, -211.07505791487804, -465.1066989305443, -978.1138838605449, -366.8531681187535, -1076.4125909437557, -1468.9565582782577, -898.2357959016255, -1136.445685746316, -80.42056841408098, -1230.024502265086, -953.0833012124467, -348.06493645960427, -833.1238938357185, -477.68977650640153, -757.0059787085493, -958.6345117782944, -500.8804053805357, -1227.7606644064674, -380.84694366014355, -1205.125358406822, -42.74820988201933, -1122.3004572517718, -669.5739667305627, -1170.5184499618533, -1045.0863921180319, -1097.1849248028823, -914.2022006644544, -826.3301664638019, -388.25568262464463, -1090.6391587592195, -738.2404311718932, -1081.2531010879025, -722.3636429928689, -393.17061429216204, -528.3946431001292, -939.4060695549134, -580.49313428098, -868.1457201359606, -244.1916588372077, -386.5215247196678, -67.72154754489252, -1045.2154824905983, -1356.14942072307, -1136.1575401484092, -948.1589180829736, -89.4316955685999, -83.7376490058071, -51.407476034831106, -1062.8690008004965, -980.108137352739, -757.1394875742311, -341.08718629835573]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5554704843007889, "mean_inference_ms": 1.6827612062513158, "mean_action_processing_ms": 0.27641221011708716, "mean_env_wait_ms": 3.496122958934809, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01226496696472168, "StateBufferConnector_ms": 0.00809931755065918, "ViewRequirementAgentConnector_ms": 0.19260334968566895}, "num_episodes": 31, "episode_return_max": -14.037527717487727, "episode_return_min": -1468.9565582782577, "episode_return_mean": -671.7575025427633, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.4657324734351, "num_env_steps_trained_throughput_per_sec": 305.4657324734351, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12916.419, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12916.335, "sample_time_ms": 1146.511, "learn_time_ms": 11701.38, "learn_throughput": 341.84, "synch_weights_time_ms": 67.657}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00008", "date": "2024-08-04_06-15-22", "timestamp": 1722732322, "time_this_iter_s": 13.106689691543579, "time_total_s": 181.93715262413025, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270e710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 181.93715262413025, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.757894736842104, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 164.1613183796406, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.6907645139843224, "policy_loss": -0.012200114248359265, "vf_loss": 2.7135177704195184, "vf_explained_var": 0.9924679811423024, "kl": 0.01536782537756761, "entropy": 1.5163488453874985, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -14.037527717487727, "episode_reward_min": -1468.9565582782577, "episode_reward_mean": -681.4800738469552, "episode_len_mean": 128.57, "episode_media": {}, "episodes_timesteps_total": 12857, "policy_reward_min": {"policy_0": -1468.9565582782577}, "policy_reward_max": {"policy_0": -14.037527717487727}, "policy_reward_mean": {"policy_0": -681.4800738469552}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-236.77344444225383, -703.8594459836837, -1024.39299364606, -298.58203808872645, -756.7744635767269, -895.3424829029486, -439.1954390328615, -1151.9476586947437, -280.94824290781787, -217.2804078705291, -1135.5021116527146, -1114.4786742093877, -1065.3307454987607, -407.9497449922605, -14.037527717487727, -176.02308040786986, -149.44635139497706, -1383.4407944523364, -1034.2032445646926, -211.07505791487804, -465.1066989305443, -978.1138838605449, -366.8531681187535, -1076.4125909437557, -1468.9565582782577, -898.2357959016255, -1136.445685746316, -80.42056841408098, -1230.024502265086, -953.0833012124467, -348.06493645960427, -833.1238938357185, -477.68977650640153, -757.0059787085493, -958.6345117782944, -500.8804053805357, -1227.7606644064674, -380.84694366014355, -1205.125358406822, -42.74820988201933, -1122.3004572517718, -669.5739667305627, -1170.5184499618533, -1045.0863921180319, -1097.1849248028823, -914.2022006644544, -826.3301664638019, -388.25568262464463, -1090.6391587592195, -738.2404311718932, -1081.2531010879025, -722.3636429928689, -393.17061429216204, -528.3946431001292, -939.4060695549134, -580.49313428098, -868.1457201359606, -244.1916588372077, -386.5215247196678, -67.72154754489252, -1045.2154824905983, -1356.14942072307, -1136.1575401484092, -948.1589180829736, -89.4316955685999, -83.7376490058071, -51.407476034831106, -1062.8690008004965, -980.108137352739, -757.1394875742311, -341.08718629835573, -1190.033642361542, -203.18845186123067, -1058.0594471005072, -479.70625479155376, -95.05263829999626, -1034.4022836246402, -408.39168972146473, -945.832740043081, -660.7290840948951, -527.2810519121882, -611.3698349569981, -967.2699576397587, -165.4294802597145, -454.9796307959444, -490.43582709744857, -138.67918562436694, -489.9251844946687, -571.6528743297333, -905.9204826816576, -334.1526359866571, -1030.2294389309643, -77.08873460703315, -1094.2294737934053, -70.790866697296, -180.66158598333038, -1252.3532042333297, -324.54039176138184, -1207.9485762628756, -370.0998709242619], "episode_lengths": [105, 150, 150, 79, 150, 150, 146, 150, 125, 81, 150, 150, 150, 135, 30, 82, 63, 150, 150, 90, 150, 150, 87, 150, 150, 150, 150, 58, 150, 150, 83, 149, 118, 150, 150, 150, 150, 120, 150, 45, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 125, 150, 150, 150, 97, 150, 53, 150, 150, 150, 150, 84, 71, 59, 150, 150, 132, 150, 150, 87, 150, 150, 49, 150, 141, 150, 150, 150, 150, 150, 87, 150, 150, 57, 148, 150, 150, 102, 150, 61, 150, 45, 79, 150, 100, 150, 104], "policy_policy_0_reward": [-236.77344444225383, -703.8594459836837, -1024.39299364606, -298.58203808872645, -756.7744635767269, -895.3424829029486, -439.1954390328615, -1151.9476586947437, -280.94824290781787, -217.2804078705291, -1135.5021116527146, -1114.4786742093877, -1065.3307454987607, -407.9497449922605, -14.037527717487727, -176.02308040786986, -149.44635139497706, -1383.4407944523364, -1034.2032445646926, -211.07505791487804, -465.1066989305443, -978.1138838605449, -366.8531681187535, -1076.4125909437557, -1468.9565582782577, -898.2357959016255, -1136.445685746316, -80.42056841408098, -1230.024502265086, -953.0833012124467, -348.06493645960427, -833.1238938357185, -477.68977650640153, -757.0059787085493, -958.6345117782944, -500.8804053805357, -1227.7606644064674, -380.84694366014355, -1205.125358406822, -42.74820988201933, -1122.3004572517718, -669.5739667305627, -1170.5184499618533, -1045.0863921180319, -1097.1849248028823, -914.2022006644544, -826.3301664638019, -388.25568262464463, -1090.6391587592195, -738.2404311718932, -1081.2531010879025, -722.3636429928689, -393.17061429216204, -528.3946431001292, -939.4060695549134, -580.49313428098, -868.1457201359606, -244.1916588372077, -386.5215247196678, -67.72154754489252, -1045.2154824905983, -1356.14942072307, -1136.1575401484092, -948.1589180829736, -89.4316955685999, -83.7376490058071, -51.407476034831106, -1062.8690008004965, -980.108137352739, -757.1394875742311, -341.08718629835573, -1190.033642361542, -203.18845186123067, -1058.0594471005072, -479.70625479155376, -95.05263829999626, -1034.4022836246402, -408.39168972146473, -945.832740043081, -660.7290840948951, -527.2810519121882, -611.3698349569981, -967.2699576397587, -165.4294802597145, -454.9796307959444, -490.43582709744857, -138.67918562436694, -489.9251844946687, -571.6528743297333, -905.9204826816576, -334.1526359866571, -1030.2294389309643, -77.08873460703315, -1094.2294737934053, -70.790866697296, -180.66158598333038, -1252.3532042333297, -324.54039176138184, -1207.9485762628756, -370.0998709242619]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551253861429367, "mean_inference_ms": 1.6811611041361423, "mean_action_processing_ms": 0.2762579366380878, "mean_env_wait_ms": 3.492882584519297, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0123443603515625, "StateBufferConnector_ms": 0.008165121078491211, "ViewRequirementAgentConnector_ms": 0.1942903995513916}, "num_episodes": 29, "episode_return_max": -14.037527717487727, "episode_return_min": -1468.9565582782577, "episode_return_mean": -681.4800738469552, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.97206587286735, "num_env_steps_trained_throughput_per_sec": 302.97206587286735, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12902.596, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12902.512, "sample_time_ms": 1140.566, "learn_time_ms": 11693.863, "learn_throughput": 342.06, "synch_weights_time_ms": 67.297}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00008", "date": "2024-08-04_06-15-35", "timestamp": 1722732335, "time_this_iter_s": 13.215943336486816, "time_total_s": 195.15309596061707, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270f1c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 195.15309596061707, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.794736842105262, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 224.6451836248239, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.4962367846320075, "policy_loss": -0.015045291737866744, "vf_loss": 2.520753817136089, "vf_explained_var": 0.9942383409788211, "kl": 0.017940897632191404, "entropy": 1.4854011463622252, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -14.419689861254573, "episode_reward_min": -1420.2592505645086, "episode_reward_mean": -666.3569210600782, "episode_len_mean": 126.96, "episode_media": {}, "episodes_timesteps_total": 12696, "policy_reward_min": {"policy_0": -1420.2592505645086}, "policy_reward_max": {"policy_0": -14.419689861254573}, "policy_reward_mean": {"policy_0": -666.3569210600782}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-500.8804053805357, -1227.7606644064674, -380.84694366014355, -1205.125358406822, -42.74820988201933, -1122.3004572517718, -669.5739667305627, -1170.5184499618533, -1045.0863921180319, -1097.1849248028823, -914.2022006644544, -826.3301664638019, -388.25568262464463, -1090.6391587592195, -738.2404311718932, -1081.2531010879025, -722.3636429928689, -393.17061429216204, -528.3946431001292, -939.4060695549134, -580.49313428098, -868.1457201359606, -244.1916588372077, -386.5215247196678, -67.72154754489252, -1045.2154824905983, -1356.14942072307, -1136.1575401484092, -948.1589180829736, -89.4316955685999, -83.7376490058071, -51.407476034831106, -1062.8690008004965, -980.108137352739, -757.1394875742311, -341.08718629835573, -1190.033642361542, -203.18845186123067, -1058.0594471005072, -479.70625479155376, -95.05263829999626, -1034.4022836246402, -408.39168972146473, -945.832740043081, -660.7290840948951, -527.2810519121882, -611.3698349569981, -967.2699576397587, -165.4294802597145, -454.9796307959444, -490.43582709744857, -138.67918562436694, -489.9251844946687, -571.6528743297333, -905.9204826816576, -334.1526359866571, -1030.2294389309643, -77.08873460703315, -1094.2294737934053, -70.790866697296, -180.66158598333038, -1252.3532042333297, -324.54039176138184, -1207.9485762628756, -370.0998709242619, -861.0746107330871, -281.7322633499073, -284.9458096060357, -14.419689861254573, -135.59890568822834, -1025.504674116742, -39.17110971045547, -1221.7755806603254, -839.7648942603346, -86.28320901254345, -570.8251606006334, -951.662351878445, -1390.6801928792906, -106.17581570227162, -299.93456820737987, -938.4315156146502, -504.5451283660232, -196.1406135184566, -765.6021214736195, -786.6785680053243, -67.41902285719438, -1136.5981208918658, -1141.2580194771567, -1354.867665688665, -1025.7988416437834, -198.07393994805363, -82.88382389201053, -680.1404762333963, -615.4150935260374, -1057.6323939042195, -891.9646518779992, -1210.1320439712126, -104.49115513095171, -924.559239371926, -1420.2592505645086], "episode_lengths": [150, 150, 120, 150, 45, 150, 150, 150, 150, 150, 150, 150, 130, 150, 150, 150, 150, 150, 125, 150, 150, 150, 97, 150, 53, 150, 150, 150, 150, 84, 71, 59, 150, 150, 132, 150, 150, 87, 150, 150, 49, 150, 141, 150, 150, 150, 150, 150, 87, 150, 150, 57, 148, 150, 150, 102, 150, 61, 150, 45, 79, 150, 100, 150, 104, 150, 116, 79, 33, 86, 150, 45, 150, 150, 67, 150, 150, 150, 72, 109, 150, 150, 90, 150, 150, 52, 150, 150, 150, 150, 85, 72, 150, 150, 150, 150, 150, 64, 150, 150], "policy_policy_0_reward": [-500.8804053805357, -1227.7606644064674, -380.84694366014355, -1205.125358406822, -42.74820988201933, -1122.3004572517718, -669.5739667305627, -1170.5184499618533, -1045.0863921180319, -1097.1849248028823, -914.2022006644544, -826.3301664638019, -388.25568262464463, -1090.6391587592195, -738.2404311718932, -1081.2531010879025, -722.3636429928689, -393.17061429216204, -528.3946431001292, -939.4060695549134, -580.49313428098, -868.1457201359606, -244.1916588372077, -386.5215247196678, -67.72154754489252, -1045.2154824905983, -1356.14942072307, -1136.1575401484092, -948.1589180829736, -89.4316955685999, -83.7376490058071, -51.407476034831106, -1062.8690008004965, -980.108137352739, -757.1394875742311, -341.08718629835573, -1190.033642361542, -203.18845186123067, -1058.0594471005072, -479.70625479155376, -95.05263829999626, -1034.4022836246402, -408.39168972146473, -945.832740043081, -660.7290840948951, -527.2810519121882, -611.3698349569981, -967.2699576397587, -165.4294802597145, -454.9796307959444, -490.43582709744857, -138.67918562436694, -489.9251844946687, -571.6528743297333, -905.9204826816576, -334.1526359866571, -1030.2294389309643, -77.08873460703315, -1094.2294737934053, -70.790866697296, -180.66158598333038, -1252.3532042333297, -324.54039176138184, -1207.9485762628756, -370.0998709242619, -861.0746107330871, -281.7322633499073, -284.9458096060357, -14.419689861254573, -135.59890568822834, -1025.504674116742, -39.17110971045547, -1221.7755806603254, -839.7648942603346, -86.28320901254345, -570.8251606006334, -951.662351878445, -1390.6801928792906, -106.17581570227162, -299.93456820737987, -938.4315156146502, -504.5451283660232, -196.1406135184566, -765.6021214736195, -786.6785680053243, -67.41902285719438, -1136.5981208918658, -1141.2580194771567, -1354.867665688665, -1025.7988416437834, -198.07393994805363, -82.88382389201053, -680.1404762333963, -615.4150935260374, -1057.6323939042195, -891.9646518779992, -1210.1320439712126, -104.49115513095171, -924.559239371926, -1420.2592505645086]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550718222060488, "mean_inference_ms": 1.6796950258100392, "mean_action_processing_ms": 0.27585450056868305, "mean_env_wait_ms": 3.4878318468974454, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011997461318969727, "StateBufferConnector_ms": 0.008259296417236328, "ViewRequirementAgentConnector_ms": 0.19602251052856445}, "num_episodes": 35, "episode_return_max": -14.419689861254573, "episode_return_min": -1420.2592505645086, "episode_return_mean": -666.3569210600782, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.738226895308, "num_env_steps_trained_throughput_per_sec": 347.738226895308, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12931.942, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12931.857, "sample_time_ms": 1155.632, "learn_time_ms": 11707.54, "learn_throughput": 341.66, "synch_weights_time_ms": 67.896}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00008", "date": "2024-08-04_06-15-47", "timestamp": 1722732347, "time_this_iter_s": 11.515364646911621, "time_total_s": 206.6684606075287, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270e7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 206.6684606075287, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.24375, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 236.53749395211537, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.46160496758918, "policy_loss": 0.000979072191209222, "vf_loss": 2.4692071015636126, "vf_explained_var": 0.9817907778546214, "kl": 0.025830539788694318, "entropy": 1.6330368497719367, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -14.419689861254573, "episode_reward_min": -1459.427663114317, "episode_reward_mean": -687.2142266083455, "episode_len_mean": 126.4, "episode_media": {}, "episodes_timesteps_total": 12640, "policy_reward_min": {"policy_0": -1459.427663114317}, "policy_reward_max": {"policy_0": -14.419689861254573}, "policy_reward_mean": {"policy_0": -687.2142266083455}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-83.7376490058071, -51.407476034831106, -1062.8690008004965, -980.108137352739, -757.1394875742311, -341.08718629835573, -1190.033642361542, -203.18845186123067, -1058.0594471005072, -479.70625479155376, -95.05263829999626, -1034.4022836246402, -408.39168972146473, -945.832740043081, -660.7290840948951, -527.2810519121882, -611.3698349569981, -967.2699576397587, -165.4294802597145, -454.9796307959444, -490.43582709744857, -138.67918562436694, -489.9251844946687, -571.6528743297333, -905.9204826816576, -334.1526359866571, -1030.2294389309643, -77.08873460703315, -1094.2294737934053, -70.790866697296, -180.66158598333038, -1252.3532042333297, -324.54039176138184, -1207.9485762628756, -370.0998709242619, -861.0746107330871, -281.7322633499073, -284.9458096060357, -14.419689861254573, -135.59890568822834, -1025.504674116742, -39.17110971045547, -1221.7755806603254, -839.7648942603346, -86.28320901254345, -570.8251606006334, -951.662351878445, -1390.6801928792906, -106.17581570227162, -299.93456820737987, -938.4315156146502, -504.5451283660232, -196.1406135184566, -765.6021214736195, -786.6785680053243, -67.41902285719438, -1136.5981208918658, -1141.2580194771567, -1354.867665688665, -1025.7988416437834, -198.07393994805363, -82.88382389201053, -680.1404762333963, -615.4150935260374, -1057.6323939042195, -891.9646518779992, -1210.1320439712126, -104.49115513095171, -924.559239371926, -1420.2592505645086, -482.09224028738817, -1174.8610840472188, -1296.9973919613917, -913.2968243592634, -519.0131118222465, -1246.1381436670654, -373.26560272141603, -796.6643121349673, -691.504222167883, -1048.7023631141178, -881.7486242611922, -1143.9098452038752, -632.176938179914, -266.4787229631819, -1146.6992365203025, -587.8053866078045, -724.7640787968446, -574.7908441506903, -561.0749252947688, -1206.6639945335655, -1217.5681243141446, -1193.0860106486282, -66.18765596121968, -1083.6911269831394, -440.02368866614796, -753.0249152792841, -1459.427663114317, -1159.591243965893, -973.8306432483587, -277.1197156959464], "episode_lengths": [71, 59, 150, 150, 132, 150, 150, 87, 150, 150, 49, 150, 141, 150, 150, 150, 150, 150, 87, 150, 150, 57, 148, 150, 150, 102, 150, 61, 150, 45, 79, 150, 100, 150, 104, 150, 116, 79, 33, 86, 150, 45, 150, 150, 67, 150, 150, 150, 72, 109, 150, 150, 90, 150, 150, 52, 150, 150, 150, 150, 85, 72, 150, 150, 150, 150, 150, 64, 150, 150, 106, 150, 150, 150, 123, 150, 128, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 108, 142, 150, 150, 150, 39, 150, 95, 150, 150, 150, 150, 75], "policy_policy_0_reward": [-83.7376490058071, -51.407476034831106, -1062.8690008004965, -980.108137352739, -757.1394875742311, -341.08718629835573, -1190.033642361542, -203.18845186123067, -1058.0594471005072, -479.70625479155376, -95.05263829999626, -1034.4022836246402, -408.39168972146473, -945.832740043081, -660.7290840948951, -527.2810519121882, -611.3698349569981, -967.2699576397587, -165.4294802597145, -454.9796307959444, -490.43582709744857, -138.67918562436694, -489.9251844946687, -571.6528743297333, -905.9204826816576, -334.1526359866571, -1030.2294389309643, -77.08873460703315, -1094.2294737934053, -70.790866697296, -180.66158598333038, -1252.3532042333297, -324.54039176138184, -1207.9485762628756, -370.0998709242619, -861.0746107330871, -281.7322633499073, -284.9458096060357, -14.419689861254573, -135.59890568822834, -1025.504674116742, -39.17110971045547, -1221.7755806603254, -839.7648942603346, -86.28320901254345, -570.8251606006334, -951.662351878445, -1390.6801928792906, -106.17581570227162, -299.93456820737987, -938.4315156146502, -504.5451283660232, -196.1406135184566, -765.6021214736195, -786.6785680053243, -67.41902285719438, -1136.5981208918658, -1141.2580194771567, -1354.867665688665, -1025.7988416437834, -198.07393994805363, -82.88382389201053, -680.1404762333963, -615.4150935260374, -1057.6323939042195, -891.9646518779992, -1210.1320439712126, -104.49115513095171, -924.559239371926, -1420.2592505645086, -482.09224028738817, -1174.8610840472188, -1296.9973919613917, -913.2968243592634, -519.0131118222465, -1246.1381436670654, -373.26560272141603, -796.6643121349673, -691.504222167883, -1048.7023631141178, -881.7486242611922, -1143.9098452038752, -632.176938179914, -266.4787229631819, -1146.6992365203025, -587.8053866078045, -724.7640787968446, -574.7908441506903, -561.0749252947688, -1206.6639945335655, -1217.5681243141446, -1193.0860106486282, -66.18765596121968, -1083.6911269831394, -440.02368866614796, -753.0249152792841, -1459.427663114317, -1159.591243965893, -973.8306432483587, -277.1197156959464]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542484607050762, "mean_inference_ms": 1.6782582919222728, "mean_action_processing_ms": 0.2757133483500759, "mean_env_wait_ms": 3.487422777629189, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011809110641479492, "StateBufferConnector_ms": 0.007989883422851562, "ViewRequirementAgentConnector_ms": 0.19358158111572266}, "num_episodes": 30, "episode_return_max": -14.419689861254573, "episode_return_min": -1459.427663114317, "episode_return_mean": -687.2142266083455, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.7455948935702, "num_env_steps_trained_throughput_per_sec": 302.7455948935702, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 13000.301, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13000.224, "sample_time_ms": 1154.018, "learn_time_ms": 11775.632, "learn_throughput": 339.685, "synch_weights_time_ms": 69.787}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00008", "date": "2024-08-04_06-16-00", "timestamp": 1722732360, "time_this_iter_s": 13.223693370819092, "time_total_s": 219.89215397834778, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270e710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 219.89215397834778, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.878947368421052, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 198.6651191631953, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.646258231376608, "policy_loss": -0.007720122987423869, "vf_loss": 2.6655121594667435, "vf_explained_var": 0.9798009840150674, "kl": 0.009508007995221631, "entropy": 1.5812418546527625, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -14.419689861254573, "episode_reward_min": -1459.427663114317, "episode_reward_mean": -710.4255954513505, "episode_len_mean": 129.03, "episode_media": {}, "episodes_timesteps_total": 12903, "policy_reward_min": {"policy_0": -1459.427663114317}, "policy_reward_max": {"policy_0": -14.419689861254573}, "policy_reward_mean": {"policy_0": -710.4255954513505}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-70.790866697296, -180.66158598333038, -1252.3532042333297, -324.54039176138184, -1207.9485762628756, -370.0998709242619, -861.0746107330871, -281.7322633499073, -284.9458096060357, -14.419689861254573, -135.59890568822834, -1025.504674116742, -39.17110971045547, -1221.7755806603254, -839.7648942603346, -86.28320901254345, -570.8251606006334, -951.662351878445, -1390.6801928792906, -106.17581570227162, -299.93456820737987, -938.4315156146502, -504.5451283660232, -196.1406135184566, -765.6021214736195, -786.6785680053243, -67.41902285719438, -1136.5981208918658, -1141.2580194771567, -1354.867665688665, -1025.7988416437834, -198.07393994805363, -82.88382389201053, -680.1404762333963, -615.4150935260374, -1057.6323939042195, -891.9646518779992, -1210.1320439712126, -104.49115513095171, -924.559239371926, -1420.2592505645086, -482.09224028738817, -1174.8610840472188, -1296.9973919613917, -913.2968243592634, -519.0131118222465, -1246.1381436670654, -373.26560272141603, -796.6643121349673, -691.504222167883, -1048.7023631141178, -881.7486242611922, -1143.9098452038752, -632.176938179914, -266.4787229631819, -1146.6992365203025, -587.8053866078045, -724.7640787968446, -574.7908441506903, -561.0749252947688, -1206.6639945335655, -1217.5681243141446, -1193.0860106486282, -66.18765596121968, -1083.6911269831394, -440.02368866614796, -753.0249152792841, -1459.427663114317, -1159.591243965893, -973.8306432483587, -277.1197156959464, -265.7980828443637, -433.8764139097434, -696.021080036301, -598.6550945687636, -591.2463733402552, -1113.8868694290848, -831.2830567148345, -508.8161215079769, -1369.1678599196189, -453.7115687650515, -559.0260766515031, -432.1448948561101, -330.5990525765562, -1228.3178453524927, -1116.411247035923, -39.38220782541768, -842.3727498439372, -216.9439572383585, -159.32474105661316, -861.0108739315018, -1070.3651157083523, -893.3457034227647, -630.3967948713722, -760.4044469996552, -384.51869801781845, -929.8585532128044, -802.2154073370194, -786.4058883026892, -626.0190710995166], "episode_lengths": [45, 79, 150, 100, 150, 104, 150, 116, 79, 33, 86, 150, 45, 150, 150, 67, 150, 150, 150, 72, 109, 150, 150, 90, 150, 150, 52, 150, 150, 150, 150, 85, 72, 150, 150, 150, 150, 150, 64, 150, 150, 106, 150, 150, 150, 123, 150, 128, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 108, 142, 150, 150, 150, 39, 150, 95, 150, 150, 150, 150, 75, 101, 145, 150, 150, 141, 150, 150, 150, 150, 150, 150, 92, 139, 150, 150, 42, 150, 67, 150, 150, 150, 150, 148, 150, 115, 150, 130, 150, 137], "policy_policy_0_reward": [-70.790866697296, -180.66158598333038, -1252.3532042333297, -324.54039176138184, -1207.9485762628756, -370.0998709242619, -861.0746107330871, -281.7322633499073, -284.9458096060357, -14.419689861254573, -135.59890568822834, -1025.504674116742, -39.17110971045547, -1221.7755806603254, -839.7648942603346, -86.28320901254345, -570.8251606006334, -951.662351878445, -1390.6801928792906, -106.17581570227162, -299.93456820737987, -938.4315156146502, -504.5451283660232, -196.1406135184566, -765.6021214736195, -786.6785680053243, -67.41902285719438, -1136.5981208918658, -1141.2580194771567, -1354.867665688665, -1025.7988416437834, -198.07393994805363, -82.88382389201053, -680.1404762333963, -615.4150935260374, -1057.6323939042195, -891.9646518779992, -1210.1320439712126, -104.49115513095171, -924.559239371926, -1420.2592505645086, -482.09224028738817, -1174.8610840472188, -1296.9973919613917, -913.2968243592634, -519.0131118222465, -1246.1381436670654, -373.26560272141603, -796.6643121349673, -691.504222167883, -1048.7023631141178, -881.7486242611922, -1143.9098452038752, -632.176938179914, -266.4787229631819, -1146.6992365203025, -587.8053866078045, -724.7640787968446, -574.7908441506903, -561.0749252947688, -1206.6639945335655, -1217.5681243141446, -1193.0860106486282, -66.18765596121968, -1083.6911269831394, -440.02368866614796, -753.0249152792841, -1459.427663114317, -1159.591243965893, -973.8306432483587, -277.1197156959464, -265.7980828443637, -433.8764139097434, -696.021080036301, -598.6550945687636, -591.2463733402552, -1113.8868694290848, -831.2830567148345, -508.8161215079769, -1369.1678599196189, -453.7115687650515, -559.0260766515031, -432.1448948561101, -330.5990525765562, -1228.3178453524927, -1116.411247035923, -39.38220782541768, -842.3727498439372, -216.9439572383585, -159.32474105661316, -861.0108739315018, -1070.3651157083523, -893.3457034227647, -630.3967948713722, -760.4044469996552, -384.51869801781845, -929.8585532128044, -802.2154073370194, -786.4058883026892, -626.0190710995166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538107620020489, "mean_inference_ms": 1.6777366218689063, "mean_action_processing_ms": 0.27567171725961964, "mean_env_wait_ms": 3.4915553041228975, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011653900146484375, "StateBufferConnector_ms": 0.008005857467651367, "ViewRequirementAgentConnector_ms": 0.1967906951904297}, "num_episodes": 29, "episode_return_max": -14.419689861254573, "episode_return_min": -1459.427663114317, "episode_return_mean": -710.4255954513505, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.78482575395685, "num_env_steps_trained_throughput_per_sec": 309.78482575395685, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12997.835, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12997.758, "sample_time_ms": 1157.264, "learn_time_ms": 11769.821, "learn_throughput": 339.852, "synch_weights_time_ms": 69.89}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00008", "date": "2024-08-04_06-16-13", "timestamp": 1722732373, "time_this_iter_s": 12.92470383644104, "time_total_s": 232.81685781478882, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01a7130>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 232.81685781478882, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.37777777777778, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 225.6131609896819, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.4339161212245624, "policy_loss": -0.01009168647021094, "vf_loss": 2.453983609129985, "vf_explained_var": 0.9887926520158847, "kl": 0.012289420797439258, "entropy": 1.5506035078316927, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -39.38220782541768, "episode_reward_min": -1459.427663114317, "episode_reward_mean": -736.1061832194504, "episode_len_mean": 134.63, "episode_media": {}, "episodes_timesteps_total": 13463, "policy_reward_min": {"policy_0": -1459.427663114317}, "policy_reward_max": {"policy_0": -39.38220782541768}, "policy_reward_mean": {"policy_0": -736.1061832194504}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1136.5981208918658, -1141.2580194771567, -1354.867665688665, -1025.7988416437834, -198.07393994805363, -82.88382389201053, -680.1404762333963, -615.4150935260374, -1057.6323939042195, -891.9646518779992, -1210.1320439712126, -104.49115513095171, -924.559239371926, -1420.2592505645086, -482.09224028738817, -1174.8610840472188, -1296.9973919613917, -913.2968243592634, -519.0131118222465, -1246.1381436670654, -373.26560272141603, -796.6643121349673, -691.504222167883, -1048.7023631141178, -881.7486242611922, -1143.9098452038752, -632.176938179914, -266.4787229631819, -1146.6992365203025, -587.8053866078045, -724.7640787968446, -574.7908441506903, -561.0749252947688, -1206.6639945335655, -1217.5681243141446, -1193.0860106486282, -66.18765596121968, -1083.6911269831394, -440.02368866614796, -753.0249152792841, -1459.427663114317, -1159.591243965893, -973.8306432483587, -277.1197156959464, -265.7980828443637, -433.8764139097434, -696.021080036301, -598.6550945687636, -591.2463733402552, -1113.8868694290848, -831.2830567148345, -508.8161215079769, -1369.1678599196189, -453.7115687650515, -559.0260766515031, -432.1448948561101, -330.5990525765562, -1228.3178453524927, -1116.411247035923, -39.38220782541768, -842.3727498439372, -216.9439572383585, -159.32474105661316, -861.0108739315018, -1070.3651157083523, -893.3457034227647, -630.3967948713722, -760.4044469996552, -384.51869801781845, -929.8585532128044, -802.2154073370194, -786.4058883026892, -626.0190710995166, -728.8817730328818, -632.573393496416, -251.36152946324836, -72.18882063093663, -1128.2652670038094, -320.82128697230985, -322.42776307701513, -694.4231034959513, -369.92914265002287, -1155.047528460526, -469.1835769302697, -630.6167939402802, -88.09180422866012, -703.8048491947962, -525.4101950728389, -844.4529221514092, -896.680461866924, -476.3939284438571, -204.1801492566178, -929.3631555750527, -1301.9310243463863, -712.9446315441004, -373.1946839705432, -1177.593137846145, -1102.5936019860612, -1179.7826255385687, -50.68192859903648], "episode_lengths": [150, 150, 150, 150, 85, 72, 150, 150, 150, 150, 150, 64, 150, 150, 106, 150, 150, 150, 123, 150, 128, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 108, 142, 150, 150, 150, 39, 150, 95, 150, 150, 150, 150, 75, 101, 145, 150, 150, 141, 150, 150, 150, 150, 150, 150, 92, 139, 150, 150, 42, 150, 67, 150, 150, 150, 150, 148, 150, 115, 150, 130, 150, 137, 150, 150, 78, 65, 150, 150, 150, 139, 150, 150, 112, 150, 62, 150, 150, 150, 150, 150, 86, 150, 150, 129, 150, 150, 150, 150, 66], "policy_policy_0_reward": [-1136.5981208918658, -1141.2580194771567, -1354.867665688665, -1025.7988416437834, -198.07393994805363, -82.88382389201053, -680.1404762333963, -615.4150935260374, -1057.6323939042195, -891.9646518779992, -1210.1320439712126, -104.49115513095171, -924.559239371926, -1420.2592505645086, -482.09224028738817, -1174.8610840472188, -1296.9973919613917, -913.2968243592634, -519.0131118222465, -1246.1381436670654, -373.26560272141603, -796.6643121349673, -691.504222167883, -1048.7023631141178, -881.7486242611922, -1143.9098452038752, -632.176938179914, -266.4787229631819, -1146.6992365203025, -587.8053866078045, -724.7640787968446, -574.7908441506903, -561.0749252947688, -1206.6639945335655, -1217.5681243141446, -1193.0860106486282, -66.18765596121968, -1083.6911269831394, -440.02368866614796, -753.0249152792841, -1459.427663114317, -1159.591243965893, -973.8306432483587, -277.1197156959464, -265.7980828443637, -433.8764139097434, -696.021080036301, -598.6550945687636, -591.2463733402552, -1113.8868694290848, -831.2830567148345, -508.8161215079769, -1369.1678599196189, -453.7115687650515, -559.0260766515031, -432.1448948561101, -330.5990525765562, -1228.3178453524927, -1116.411247035923, -39.38220782541768, -842.3727498439372, -216.9439572383585, -159.32474105661316, -861.0108739315018, -1070.3651157083523, -893.3457034227647, -630.3967948713722, -760.4044469996552, -384.51869801781845, -929.8585532128044, -802.2154073370194, -786.4058883026892, -626.0190710995166, -728.8817730328818, -632.573393496416, -251.36152946324836, -72.18882063093663, -1128.2652670038094, -320.82128697230985, -322.42776307701513, -694.4231034959513, -369.92914265002287, -1155.047528460526, -469.1835769302697, -630.6167939402802, -88.09180422866012, -703.8048491947962, -525.4101950728389, -844.4529221514092, -896.680461866924, -476.3939284438571, -204.1801492566178, -929.3631555750527, -1301.9310243463863, -712.9446315441004, -373.1946839705432, -1177.593137846145, -1102.5936019860612, -1179.7826255385687, -50.68192859903648]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5540596737783494, "mean_inference_ms": 1.6777307888388184, "mean_action_processing_ms": 0.2755267073517582, "mean_env_wait_ms": 3.493482637264093, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012162208557128906, "StateBufferConnector_ms": 0.007936716079711914, "ViewRequirementAgentConnector_ms": 0.19481658935546875}, "num_episodes": 27, "episode_return_max": -39.38220782541768, "episode_return_min": -1459.427663114317, "episode_return_mean": -736.1061832194504, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.0188651822784, "num_env_steps_trained_throughput_per_sec": 311.0188651822784, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12958.761, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12958.683, "sample_time_ms": 1161.258, "learn_time_ms": 11726.76, "learn_throughput": 341.1, "synch_weights_time_ms": 69.882}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00008", "date": "2024-08-04_06-16-26", "timestamp": 1722732386, "time_this_iter_s": 12.875219583511353, "time_total_s": 245.69207739830017, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270eef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 245.69207739830017, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.27368421052632, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 200.53678434292476, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.61022572008272, "policy_loss": -0.0092896114346028, "vf_loss": 2.6272734691699346, "vf_explained_var": 0.9923215523983041, "kl": 0.014609639425907517, "entropy": 1.433248745277524, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -39.38220782541768, "episode_reward_min": -1459.427663114317, "episode_reward_mean": -651.5416098194924, "episode_len_mean": 127.93, "episode_media": {}, "episodes_timesteps_total": 12793, "policy_reward_min": {"policy_0": -1459.427663114317}, "policy_reward_max": {"policy_0": -39.38220782541768}, "policy_reward_mean": {"policy_0": -651.5416098194924}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1083.6911269831394, -440.02368866614796, -753.0249152792841, -1459.427663114317, -1159.591243965893, -973.8306432483587, -277.1197156959464, -265.7980828443637, -433.8764139097434, -696.021080036301, -598.6550945687636, -591.2463733402552, -1113.8868694290848, -831.2830567148345, -508.8161215079769, -1369.1678599196189, -453.7115687650515, -559.0260766515031, -432.1448948561101, -330.5990525765562, -1228.3178453524927, -1116.411247035923, -39.38220782541768, -842.3727498439372, -216.9439572383585, -159.32474105661316, -861.0108739315018, -1070.3651157083523, -893.3457034227647, -630.3967948713722, -760.4044469996552, -384.51869801781845, -929.8585532128044, -802.2154073370194, -786.4058883026892, -626.0190710995166, -728.8817730328818, -632.573393496416, -251.36152946324836, -72.18882063093663, -1128.2652670038094, -320.82128697230985, -322.42776307701513, -694.4231034959513, -369.92914265002287, -1155.047528460526, -469.1835769302697, -630.6167939402802, -88.09180422866012, -703.8048491947962, -525.4101950728389, -844.4529221514092, -896.680461866924, -476.3939284438571, -204.1801492566178, -929.3631555750527, -1301.9310243463863, -712.9446315441004, -373.1946839705432, -1177.593137846145, -1102.5936019860612, -1179.7826255385687, -50.68192859903648, -421.9199941824177, -1140.7436998251644, -1273.9141037613851, -1068.1466373512246, -637.3636250228681, -420.35591812046687, -62.73937399262905, -1333.8777023140283, -49.92239141548991, -1235.8815415550166, -94.18143514193328, -460.6384771648601, -122.14494698651804, -359.8096142006593, -221.02122653667035, -999.6576097659766, -88.32760417477529, -559.4776143562981, -597.3449276925037, -147.29921850742727, -619.6768274794064, -246.61394110935666, -1151.32293960955, -97.94710080050133, -88.76202838115898, -1153.205366399088, -658.6189864034048, -342.04996398121233, -108.56080376066947, -1367.3997627872488, -1380.7925575524807, -958.2297097331015, -347.63784709653396, -164.00656408964727, -827.3124652712122, -1279.9207220351423, -46.28181128705377], "episode_lengths": [150, 95, 150, 150, 150, 150, 75, 101, 145, 150, 150, 141, 150, 150, 150, 150, 150, 150, 92, 139, 150, 150, 42, 150, 67, 150, 150, 150, 150, 148, 150, 115, 150, 130, 150, 137, 150, 150, 78, 65, 150, 150, 150, 139, 150, 150, 112, 150, 62, 150, 150, 150, 150, 150, 86, 150, 150, 129, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 68, 150, 39, 150, 68, 150, 68, 123, 109, 150, 58, 114, 150, 80, 147, 99, 150, 70, 59, 150, 121, 103, 69, 150, 150, 150, 113, 75, 150, 150, 46], "policy_policy_0_reward": [-1083.6911269831394, -440.02368866614796, -753.0249152792841, -1459.427663114317, -1159.591243965893, -973.8306432483587, -277.1197156959464, -265.7980828443637, -433.8764139097434, -696.021080036301, -598.6550945687636, -591.2463733402552, -1113.8868694290848, -831.2830567148345, -508.8161215079769, -1369.1678599196189, -453.7115687650515, -559.0260766515031, -432.1448948561101, -330.5990525765562, -1228.3178453524927, -1116.411247035923, -39.38220782541768, -842.3727498439372, -216.9439572383585, -159.32474105661316, -861.0108739315018, -1070.3651157083523, -893.3457034227647, -630.3967948713722, -760.4044469996552, -384.51869801781845, -929.8585532128044, -802.2154073370194, -786.4058883026892, -626.0190710995166, -728.8817730328818, -632.573393496416, -251.36152946324836, -72.18882063093663, -1128.2652670038094, -320.82128697230985, -322.42776307701513, -694.4231034959513, -369.92914265002287, -1155.047528460526, -469.1835769302697, -630.6167939402802, -88.09180422866012, -703.8048491947962, -525.4101950728389, -844.4529221514092, -896.680461866924, -476.3939284438571, -204.1801492566178, -929.3631555750527, -1301.9310243463863, -712.9446315441004, -373.1946839705432, -1177.593137846145, -1102.5936019860612, -1179.7826255385687, -50.68192859903648, -421.9199941824177, -1140.7436998251644, -1273.9141037613851, -1068.1466373512246, -637.3636250228681, -420.35591812046687, -62.73937399262905, -1333.8777023140283, -49.92239141548991, -1235.8815415550166, -94.18143514193328, -460.6384771648601, -122.14494698651804, -359.8096142006593, -221.02122653667035, -999.6576097659766, -88.32760417477529, -559.4776143562981, -597.3449276925037, -147.29921850742727, -619.6768274794064, -246.61394110935666, -1151.32293960955, -97.94710080050133, -88.76202838115898, -1153.205366399088, -658.6189864034048, -342.04996398121233, -108.56080376066947, -1367.3997627872488, -1380.7925575524807, -958.2297097331015, -347.63784709653396, -164.00656408964727, -827.3124652712122, -1279.9207220351423, -46.28181128705377]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537771807303862, "mean_inference_ms": 1.6776866518277842, "mean_action_processing_ms": 0.2756351336206717, "mean_env_wait_ms": 3.4973929479305026, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012181997299194336, "StateBufferConnector_ms": 0.007916927337646484, "ViewRequirementAgentConnector_ms": 0.19482135772705078}, "num_episodes": 37, "episode_return_max": -39.38220782541768, "episode_return_min": -1459.427663114317, "episode_return_mean": -651.5416098194924, "episodes_this_iter": 37}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 393.53048619869736, "num_env_steps_trained_throughput_per_sec": 393.53048619869736, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12691.821, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12691.746, "sample_time_ms": 1160.451, "learn_time_ms": 11462.776, "learn_throughput": 348.956, "synch_weights_time_ms": 67.735}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00008", "date": "2024-08-04_06-16-36", "timestamp": 1722732396, "time_this_iter_s": 10.17748761177063, "time_total_s": 255.8695650100708, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270f0a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 255.8695650100708, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 20.257142857142856, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 204.74554127057394, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.703892246137063, "policy_loss": -0.014435253546495611, "vf_loss": 2.7270661696791647, "vf_explained_var": 0.9920300604775548, "kl": 0.013831245733172182, "entropy": 1.49627226938804, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -46.28181128705377, "episode_reward_min": -1380.7925575524807, "episode_reward_mean": -607.8179985686271, "episode_len_mean": 125.65, "episode_media": {}, "episodes_timesteps_total": 12565, "policy_reward_min": {"policy_0": -1380.7925575524807}, "policy_reward_max": {"policy_0": -46.28181128705377}, "policy_reward_mean": {"policy_0": -607.8179985686271}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-384.51869801781845, -929.8585532128044, -802.2154073370194, -786.4058883026892, -626.0190710995166, -728.8817730328818, -632.573393496416, -251.36152946324836, -72.18882063093663, -1128.2652670038094, -320.82128697230985, -322.42776307701513, -694.4231034959513, -369.92914265002287, -1155.047528460526, -469.1835769302697, -630.6167939402802, -88.09180422866012, -703.8048491947962, -525.4101950728389, -844.4529221514092, -896.680461866924, -476.3939284438571, -204.1801492566178, -929.3631555750527, -1301.9310243463863, -712.9446315441004, -373.1946839705432, -1177.593137846145, -1102.5936019860612, -1179.7826255385687, -50.68192859903648, -421.9199941824177, -1140.7436998251644, -1273.9141037613851, -1068.1466373512246, -637.3636250228681, -420.35591812046687, -62.73937399262905, -1333.8777023140283, -49.92239141548991, -1235.8815415550166, -94.18143514193328, -460.6384771648601, -122.14494698651804, -359.8096142006593, -221.02122653667035, -999.6576097659766, -88.32760417477529, -559.4776143562981, -597.3449276925037, -147.29921850742727, -619.6768274794064, -246.61394110935666, -1151.32293960955, -97.94710080050133, -88.76202838115898, -1153.205366399088, -658.6189864034048, -342.04996398121233, -108.56080376066947, -1367.3997627872488, -1380.7925575524807, -958.2297097331015, -347.63784709653396, -164.00656408964727, -827.3124652712122, -1279.9207220351423, -46.28181128705377, -1046.6440709139495, -267.4477384964852, -314.28332745295575, -118.87835668768214, -269.2669865604812, -507.4656397959089, -1130.2834707567208, -768.751755947513, -771.7757181782949, -945.2006809482914, -190.88995402136152, -1118.5596468839478, -83.13159881308438, -874.3932111818744, -662.8602994537374, -493.55208483277414, -1308.3320026996998, -346.8128438254446, -82.27566791259946, -214.67410653502472, -808.367923575679, -702.5868149599942, -714.0016364802029, -484.39817837466387, -953.7370542803988, -180.6517473894064, -319.38432401469936, -103.59377624173953, -1101.3128241220315, -227.74389661378135, -665.5987623226973], "episode_lengths": [115, 150, 130, 150, 137, 150, 150, 78, 65, 150, 150, 150, 139, 150, 150, 112, 150, 62, 150, 150, 150, 150, 150, 86, 150, 150, 129, 150, 150, 150, 150, 66, 150, 150, 150, 150, 150, 150, 68, 150, 39, 150, 68, 150, 68, 123, 109, 150, 58, 114, 150, 80, 147, 99, 150, 70, 59, 150, 121, 103, 69, 150, 150, 150, 113, 75, 150, 150, 46, 150, 150, 121, 83, 94, 150, 150, 150, 150, 150, 92, 150, 48, 150, 150, 150, 150, 150, 79, 72, 150, 150, 150, 150, 150, 102, 78, 75, 150, 123, 150], "policy_policy_0_reward": [-384.51869801781845, -929.8585532128044, -802.2154073370194, -786.4058883026892, -626.0190710995166, -728.8817730328818, -632.573393496416, -251.36152946324836, -72.18882063093663, -1128.2652670038094, -320.82128697230985, -322.42776307701513, -694.4231034959513, -369.92914265002287, -1155.047528460526, -469.1835769302697, -630.6167939402802, -88.09180422866012, -703.8048491947962, -525.4101950728389, -844.4529221514092, -896.680461866924, -476.3939284438571, -204.1801492566178, -929.3631555750527, -1301.9310243463863, -712.9446315441004, -373.1946839705432, -1177.593137846145, -1102.5936019860612, -1179.7826255385687, -50.68192859903648, -421.9199941824177, -1140.7436998251644, -1273.9141037613851, -1068.1466373512246, -637.3636250228681, -420.35591812046687, -62.73937399262905, -1333.8777023140283, -49.92239141548991, -1235.8815415550166, -94.18143514193328, -460.6384771648601, -122.14494698651804, -359.8096142006593, -221.02122653667035, -999.6576097659766, -88.32760417477529, -559.4776143562981, -597.3449276925037, -147.29921850742727, -619.6768274794064, -246.61394110935666, -1151.32293960955, -97.94710080050133, -88.76202838115898, -1153.205366399088, -658.6189864034048, -342.04996398121233, -108.56080376066947, -1367.3997627872488, -1380.7925575524807, -958.2297097331015, -347.63784709653396, -164.00656408964727, -827.3124652712122, -1279.9207220351423, -46.28181128705377, -1046.6440709139495, -267.4477384964852, -314.28332745295575, -118.87835668768214, -269.2669865604812, -507.4656397959089, -1130.2834707567208, -768.751755947513, -771.7757181782949, -945.2006809482914, -190.88995402136152, -1118.5596468839478, -83.13159881308438, -874.3932111818744, -662.8602994537374, -493.55208483277414, -1308.3320026996998, -346.8128438254446, -82.27566791259946, -214.67410653502472, -808.367923575679, -702.5868149599942, -714.0016364802029, -484.39817837466387, -953.7370542803988, -180.6517473894064, -319.38432401469936, -103.59377624173953, -1101.3128241220315, -227.74389661378135, -665.5987623226973]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541032161055832, "mean_inference_ms": 1.6781394427514118, "mean_action_processing_ms": 0.27546854701230056, "mean_env_wait_ms": 3.500450811981634, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012258768081665039, "StateBufferConnector_ms": 0.007902860641479492, "ViewRequirementAgentConnector_ms": 0.19300627708435059}, "num_episodes": 31, "episode_return_max": -46.28181128705377, "episode_return_min": -1380.7925575524807, "episode_return_mean": -607.8179985686271, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 369.12580596857106, "num_env_steps_trained_throughput_per_sec": 369.12580596857106, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12428.46, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12428.387, "sample_time_ms": 1157.739, "learn_time_ms": 11202.394, "learn_throughput": 357.067, "synch_weights_time_ms": 67.474}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00008", "date": "2024-08-04_06-16-47", "timestamp": 1722732407, "time_this_iter_s": 10.848262548446655, "time_total_s": 266.71782755851746, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270f520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 266.71782755851746, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 19.268749999999997, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 282.60045630931853, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.027254299198588, "policy_loss": -0.015280121319907873, "vf_loss": 2.0548945552359026, "vf_explained_var": 0.9971953444803755, "kl": 0.012585861303765978, "entropy": 1.8023772889127334, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -30.048193931158316, "episode_reward_min": -1380.7925575524807, "episode_reward_mean": -622.7764435796818, "episode_len_mean": 124.85, "episode_media": {}, "episodes_timesteps_total": 12485, "policy_reward_min": {"policy_0": -1380.7925575524807}, "policy_reward_max": {"policy_0": -30.048193931158316}, "policy_reward_mean": {"policy_0": -622.7764435796818}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1102.5936019860612, -1179.7826255385687, -50.68192859903648, -421.9199941824177, -1140.7436998251644, -1273.9141037613851, -1068.1466373512246, -637.3636250228681, -420.35591812046687, -62.73937399262905, -1333.8777023140283, -49.92239141548991, -1235.8815415550166, -94.18143514193328, -460.6384771648601, -122.14494698651804, -359.8096142006593, -221.02122653667035, -999.6576097659766, -88.32760417477529, -559.4776143562981, -597.3449276925037, -147.29921850742727, -619.6768274794064, -246.61394110935666, -1151.32293960955, -97.94710080050133, -88.76202838115898, -1153.205366399088, -658.6189864034048, -342.04996398121233, -108.56080376066947, -1367.3997627872488, -1380.7925575524807, -958.2297097331015, -347.63784709653396, -164.00656408964727, -827.3124652712122, -1279.9207220351423, -46.28181128705377, -1046.6440709139495, -267.4477384964852, -314.28332745295575, -118.87835668768214, -269.2669865604812, -507.4656397959089, -1130.2834707567208, -768.751755947513, -771.7757181782949, -945.2006809482914, -190.88995402136152, -1118.5596468839478, -83.13159881308438, -874.3932111818744, -662.8602994537374, -493.55208483277414, -1308.3320026996998, -346.8128438254446, -82.27566791259946, -214.67410653502472, -808.367923575679, -702.5868149599942, -714.0016364802029, -484.39817837466387, -953.7370542803988, -180.6517473894064, -319.38432401469936, -103.59377624173953, -1101.3128241220315, -227.74389661378135, -665.5987623226973, -456.6484969244193, -1270.092494088707, -305.0105989608527, -30.048193931158316, -119.81454040306454, -223.3559295351671, -468.5033216376196, -654.1541874486247, -202.67911586936702, -1345.8850835190867, -907.1225718984688, -232.39122486011388, -1148.929459015404, -1050.5371746587473, -1181.5127938330868, -749.5239863144235, -859.9325149113979, -643.3249067697739, -1315.584928898264, -453.55076073147745, -168.69051003498979, -385.16473107842893, -442.4032496152083, -862.9228889186364, -1271.873197780864, -1035.4475165257127, -981.2619971422234, -366.9723003888511, -901.2843660321616], "episode_lengths": [150, 150, 66, 150, 150, 150, 150, 150, 150, 68, 150, 39, 150, 68, 150, 68, 123, 109, 150, 58, 114, 150, 80, 147, 99, 150, 70, 59, 150, 121, 103, 69, 150, 150, 150, 113, 75, 150, 150, 46, 150, 150, 121, 83, 94, 150, 150, 150, 150, 150, 92, 150, 48, 150, 150, 150, 150, 150, 79, 72, 150, 150, 150, 150, 150, 102, 78, 75, 150, 123, 150, 149, 150, 107, 49, 67, 86, 150, 150, 89, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 126, 125, 139, 150, 150, 150, 150, 117, 150], "policy_policy_0_reward": [-1102.5936019860612, -1179.7826255385687, -50.68192859903648, -421.9199941824177, -1140.7436998251644, -1273.9141037613851, -1068.1466373512246, -637.3636250228681, -420.35591812046687, -62.73937399262905, -1333.8777023140283, -49.92239141548991, -1235.8815415550166, -94.18143514193328, -460.6384771648601, -122.14494698651804, -359.8096142006593, -221.02122653667035, -999.6576097659766, -88.32760417477529, -559.4776143562981, -597.3449276925037, -147.29921850742727, -619.6768274794064, -246.61394110935666, -1151.32293960955, -97.94710080050133, -88.76202838115898, -1153.205366399088, -658.6189864034048, -342.04996398121233, -108.56080376066947, -1367.3997627872488, -1380.7925575524807, -958.2297097331015, -347.63784709653396, -164.00656408964727, -827.3124652712122, -1279.9207220351423, -46.28181128705377, -1046.6440709139495, -267.4477384964852, -314.28332745295575, -118.87835668768214, -269.2669865604812, -507.4656397959089, -1130.2834707567208, -768.751755947513, -771.7757181782949, -945.2006809482914, -190.88995402136152, -1118.5596468839478, -83.13159881308438, -874.3932111818744, -662.8602994537374, -493.55208483277414, -1308.3320026996998, -346.8128438254446, -82.27566791259946, -214.67410653502472, -808.367923575679, -702.5868149599942, -714.0016364802029, -484.39817837466387, -953.7370542803988, -180.6517473894064, -319.38432401469936, -103.59377624173953, -1101.3128241220315, -227.74389661378135, -665.5987623226973, -456.6484969244193, -1270.092494088707, -305.0105989608527, -30.048193931158316, -119.81454040306454, -223.3559295351671, -468.5033216376196, -654.1541874486247, -202.67911586936702, -1345.8850835190867, -907.1225718984688, -232.39122486011388, -1148.929459015404, -1050.5371746587473, -1181.5127938330868, -749.5239863144235, -859.9325149113979, -643.3249067697739, -1315.584928898264, -453.55076073147745, -168.69051003498979, -385.16473107842893, -442.4032496152083, -862.9228889186364, -1271.873197780864, -1035.4475165257127, -981.2619971422234, -366.9723003888511, -901.2843660321616]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554197295522349, "mean_inference_ms": 1.6774099236434892, "mean_action_processing_ms": 0.275342924864977, "mean_env_wait_ms": 3.498455255001107, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011940479278564453, "StateBufferConnector_ms": 0.007961273193359375, "ViewRequirementAgentConnector_ms": 0.19544744491577148}, "num_episodes": 29, "episode_return_max": -30.048193931158316, "episode_return_min": -1380.7925575524807, "episode_return_mean": -622.7764435796818, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.72782934999987, "num_env_steps_trained_throughput_per_sec": 306.72782934999987, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12408.41, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12408.335, "sample_time_ms": 1173.147, "learn_time_ms": 11166.991, "learn_throughput": 358.199, "synch_weights_time_ms": 67.41}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00008", "date": "2024-08-04_06-17-00", "timestamp": 1722732420, "time_this_iter_s": 13.052540302276611, "time_total_s": 279.77036786079407, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0111ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 279.77036786079407, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.57222222222222, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 233.81121556758882, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.2871638599783184, "policy_loss": -0.015565223041630816, "vf_loss": 2.313419032966097, "vf_explained_var": 0.9948517724250754, "kl": 0.012218542533810276, "entropy": 1.6188290383666755, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -6.779372641913089, "episode_reward_min": -1464.8865629988356, "episode_reward_mean": -619.2265791220541, "episode_len_mean": 125.13, "episode_media": {}, "episodes_timesteps_total": 12513, "policy_reward_min": {"policy_0": -1464.8865629988356}, "policy_reward_max": {"policy_0": -6.779372641913089}, "policy_reward_mean": {"policy_0": -619.2265791220541}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1279.9207220351423, -46.28181128705377, -1046.6440709139495, -267.4477384964852, -314.28332745295575, -118.87835668768214, -269.2669865604812, -507.4656397959089, -1130.2834707567208, -768.751755947513, -771.7757181782949, -945.2006809482914, -190.88995402136152, -1118.5596468839478, -83.13159881308438, -874.3932111818744, -662.8602994537374, -493.55208483277414, -1308.3320026996998, -346.8128438254446, -82.27566791259946, -214.67410653502472, -808.367923575679, -702.5868149599942, -714.0016364802029, -484.39817837466387, -953.7370542803988, -180.6517473894064, -319.38432401469936, -103.59377624173953, -1101.3128241220315, -227.74389661378135, -665.5987623226973, -456.6484969244193, -1270.092494088707, -305.0105989608527, -30.048193931158316, -119.81454040306454, -223.3559295351671, -468.5033216376196, -654.1541874486247, -202.67911586936702, -1345.8850835190867, -907.1225718984688, -232.39122486011388, -1148.929459015404, -1050.5371746587473, -1181.5127938330868, -749.5239863144235, -859.9325149113979, -643.3249067697739, -1315.584928898264, -453.55076073147745, -168.69051003498979, -385.16473107842893, -442.4032496152083, -862.9228889186364, -1271.873197780864, -1035.4475165257127, -981.2619971422234, -366.9723003888511, -901.2843660321616, -229.00475782417075, -742.88069802087, -249.41741419251312, -646.1803133282291, -680.6499338200873, -588.4357852379642, -1461.0386614273868, -52.02075067227151, -225.90045255167504, -1238.2699897840241, -140.7417509153696, -213.52819121009748, -48.215897563860864, -766.1338877475396, -900.1981968378478, -71.92847177177411, -574.4120839339405, -843.0578661593271, -150.03760558372383, -200.88405286123285, -6.779372641913089, -673.0867749111172, -1007.7209557132792, -1169.232239120433, -80.37520381933815, -561.3850116010362, -1309.3445999877301, -98.70057691467535, -1074.8789976718563, -167.41338167290266, -881.4006779418664, -810.928346546203, -83.67291866615534, -1464.8865629988356, -161.62082882927055, -1236.6784572187275, -1022.8074575512566, -951.127111633293], "episode_lengths": [150, 46, 150, 150, 121, 83, 94, 150, 150, 150, 150, 150, 92, 150, 48, 150, 150, 150, 150, 150, 79, 72, 150, 150, 150, 150, 150, 102, 78, 75, 150, 123, 150, 149, 150, 107, 49, 67, 86, 150, 150, 89, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 126, 125, 139, 150, 150, 150, 150, 117, 150, 70, 150, 90, 141, 150, 150, 150, 59, 101, 150, 55, 95, 55, 150, 150, 62, 150, 150, 85, 85, 37, 150, 150, 150, 89, 118, 150, 68, 150, 96, 150, 150, 82, 150, 139, 150, 150, 150], "policy_policy_0_reward": [-1279.9207220351423, -46.28181128705377, -1046.6440709139495, -267.4477384964852, -314.28332745295575, -118.87835668768214, -269.2669865604812, -507.4656397959089, -1130.2834707567208, -768.751755947513, -771.7757181782949, -945.2006809482914, -190.88995402136152, -1118.5596468839478, -83.13159881308438, -874.3932111818744, -662.8602994537374, -493.55208483277414, -1308.3320026996998, -346.8128438254446, -82.27566791259946, -214.67410653502472, -808.367923575679, -702.5868149599942, -714.0016364802029, -484.39817837466387, -953.7370542803988, -180.6517473894064, -319.38432401469936, -103.59377624173953, -1101.3128241220315, -227.74389661378135, -665.5987623226973, -456.6484969244193, -1270.092494088707, -305.0105989608527, -30.048193931158316, -119.81454040306454, -223.3559295351671, -468.5033216376196, -654.1541874486247, -202.67911586936702, -1345.8850835190867, -907.1225718984688, -232.39122486011388, -1148.929459015404, -1050.5371746587473, -1181.5127938330868, -749.5239863144235, -859.9325149113979, -643.3249067697739, -1315.584928898264, -453.55076073147745, -168.69051003498979, -385.16473107842893, -442.4032496152083, -862.9228889186364, -1271.873197780864, -1035.4475165257127, -981.2619971422234, -366.9723003888511, -901.2843660321616, -229.00475782417075, -742.88069802087, -249.41741419251312, -646.1803133282291, -680.6499338200873, -588.4357852379642, -1461.0386614273868, -52.02075067227151, -225.90045255167504, -1238.2699897840241, -140.7417509153696, -213.52819121009748, -48.215897563860864, -766.1338877475396, -900.1981968378478, -71.92847177177411, -574.4120839339405, -843.0578661593271, -150.03760558372383, -200.88405286123285, -6.779372641913089, -673.0867749111172, -1007.7209557132792, -1169.232239120433, -80.37520381933815, -561.3850116010362, -1309.3445999877301, -98.70057691467535, -1074.8789976718563, -167.41338167290266, -881.4006779418664, -810.928346546203, -83.67291866615534, -1464.8865629988356, -161.62082882927055, -1236.6784572187275, -1022.8074575512566, -951.127111633293]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542214053831305, "mean_inference_ms": 1.677726012209525, "mean_action_processing_ms": 0.2754217804694541, "mean_env_wait_ms": 3.504179306674919, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012031316757202148, "StateBufferConnector_ms": 0.00794839859008789, "ViewRequirementAgentConnector_ms": 0.1968555450439453}, "num_episodes": 38, "episode_return_max": -6.779372641913089, "episode_return_min": -1464.8865629988356, "episode_return_mean": -619.2265791220541, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.3035479368655, "num_env_steps_trained_throughput_per_sec": 314.3035479368655, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12355.414, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12355.336, "sample_time_ms": 1175.984, "learn_time_ms": 11112.143, "learn_throughput": 359.967, "synch_weights_time_ms": 66.421}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00008", "date": "2024-08-04_06-17-13", "timestamp": 1722732433, "time_this_iter_s": 12.739899158477783, "time_total_s": 292.51026701927185, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270f0a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 292.51026701927185, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.333333333333336, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 219.61254900892575, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.2840822959318756, "policy_loss": -0.006810019889477796, "vf_loss": 2.3026013903319837, "vf_explained_var": 0.9908814148977398, "kl": 0.010904596020373018, "entropy": 1.6616136167198419, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -6.779372641913089, "episode_reward_min": -1464.8865629988356, "episode_reward_mean": -635.0989602392067, "episode_len_mean": 124.05, "episode_media": {}, "episodes_timesteps_total": 12405, "policy_reward_min": {"policy_0": -1464.8865629988356}, "policy_reward_max": {"policy_0": -6.779372641913089}, "policy_reward_mean": {"policy_0": -635.0989602392067}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-665.5987623226973, -456.6484969244193, -1270.092494088707, -305.0105989608527, -30.048193931158316, -119.81454040306454, -223.3559295351671, -468.5033216376196, -654.1541874486247, -202.67911586936702, -1345.8850835190867, -907.1225718984688, -232.39122486011388, -1148.929459015404, -1050.5371746587473, -1181.5127938330868, -749.5239863144235, -859.9325149113979, -643.3249067697739, -1315.584928898264, -453.55076073147745, -168.69051003498979, -385.16473107842893, -442.4032496152083, -862.9228889186364, -1271.873197780864, -1035.4475165257127, -981.2619971422234, -366.9723003888511, -901.2843660321616, -229.00475782417075, -742.88069802087, -249.41741419251312, -646.1803133282291, -680.6499338200873, -588.4357852379642, -1461.0386614273868, -52.02075067227151, -225.90045255167504, -1238.2699897840241, -140.7417509153696, -213.52819121009748, -48.215897563860864, -766.1338877475396, -900.1981968378478, -71.92847177177411, -574.4120839339405, -843.0578661593271, -150.03760558372383, -200.88405286123285, -6.779372641913089, -673.0867749111172, -1007.7209557132792, -1169.232239120433, -80.37520381933815, -561.3850116010362, -1309.3445999877301, -98.70057691467535, -1074.8789976718563, -167.41338167290266, -881.4006779418664, -810.928346546203, -83.67291866615534, -1464.8865629988356, -161.62082882927055, -1236.6784572187275, -1022.8074575512566, -951.127111633293, -1023.8895617297072, -246.399180713478, -129.70899980966993, -16.374453879423484, -686.2863577055456, -1332.5131858747209, -104.13965469611594, -873.0459449442216, -119.56092828682623, -624.2440134264943, -555.1871796209173, -1021.3726751722289, -1298.617386544424, -1286.2404521417473, -935.340123734801, -661.5602736764899, -110.69330033584727, -664.9899472919809, -673.1561368029885, -858.8502070641376, -432.64930958160613, -939.8272381284089, -892.5334484233402, -102.68674185393033, -742.9093611845667, -921.883118854601, -41.60744957529576, -100.67341233969432, -183.51985335387627, -69.34168867486733, -1033.4991603637118, -1341.3972372022142], "episode_lengths": [150, 149, 150, 107, 49, 67, 86, 150, 150, 89, 150, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 126, 125, 139, 150, 150, 150, 150, 117, 150, 70, 150, 90, 141, 150, 150, 150, 59, 101, 150, 55, 95, 55, 150, 150, 62, 150, 150, 85, 85, 37, 150, 150, 150, 89, 118, 150, 68, 150, 96, 150, 150, 82, 150, 139, 150, 150, 150, 150, 119, 60, 39, 150, 150, 71, 150, 72, 137, 150, 150, 150, 150, 150, 150, 68, 150, 150, 136, 130, 150, 150, 83, 150, 150, 57, 83, 86, 64, 150, 150], "policy_policy_0_reward": [-665.5987623226973, -456.6484969244193, -1270.092494088707, -305.0105989608527, -30.048193931158316, -119.81454040306454, -223.3559295351671, -468.5033216376196, -654.1541874486247, -202.67911586936702, -1345.8850835190867, -907.1225718984688, -232.39122486011388, -1148.929459015404, -1050.5371746587473, -1181.5127938330868, -749.5239863144235, -859.9325149113979, -643.3249067697739, -1315.584928898264, -453.55076073147745, -168.69051003498979, -385.16473107842893, -442.4032496152083, -862.9228889186364, -1271.873197780864, -1035.4475165257127, -981.2619971422234, -366.9723003888511, -901.2843660321616, -229.00475782417075, -742.88069802087, -249.41741419251312, -646.1803133282291, -680.6499338200873, -588.4357852379642, -1461.0386614273868, -52.02075067227151, -225.90045255167504, -1238.2699897840241, -140.7417509153696, -213.52819121009748, -48.215897563860864, -766.1338877475396, -900.1981968378478, -71.92847177177411, -574.4120839339405, -843.0578661593271, -150.03760558372383, -200.88405286123285, -6.779372641913089, -673.0867749111172, -1007.7209557132792, -1169.232239120433, -80.37520381933815, -561.3850116010362, -1309.3445999877301, -98.70057691467535, -1074.8789976718563, -167.41338167290266, -881.4006779418664, -810.928346546203, -83.67291866615534, -1464.8865629988356, -161.62082882927055, -1236.6784572187275, -1022.8074575512566, -951.127111633293, -1023.8895617297072, -246.399180713478, -129.70899980966993, -16.374453879423484, -686.2863577055456, -1332.5131858747209, -104.13965469611594, -873.0459449442216, -119.56092828682623, -624.2440134264943, -555.1871796209173, -1021.3726751722289, -1298.617386544424, -1286.2404521417473, -935.340123734801, -661.5602736764899, -110.69330033584727, -664.9899472919809, -673.1561368029885, -858.8502070641376, -432.64930958160613, -939.8272381284089, -892.5334484233402, -102.68674185393033, -742.9093611845667, -921.883118854601, -41.60744957529576, -100.67341233969432, -183.51985335387627, -69.34168867486733, -1033.4991603637118, -1341.3972372022142]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537345413091225, "mean_inference_ms": 1.677294259760424, "mean_action_processing_ms": 0.27567968726905856, "mean_env_wait_ms": 3.507181468480275, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012111425399780273, "StateBufferConnector_ms": 0.008047342300415039, "ViewRequirementAgentConnector_ms": 0.19754719734191895}, "num_episodes": 32, "episode_return_max": -6.779372641913089, "episode_return_min": -1464.8865629988356, "episode_return_mean": -635.0989602392067, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.25725238563274, "num_env_steps_trained_throughput_per_sec": 308.25725238563274, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12343.555, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12343.474, "sample_time_ms": 1178.057, "learn_time_ms": 11100.06, "learn_throughput": 360.358, "synch_weights_time_ms": 64.568}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00008", "date": "2024-08-04_06-17-26", "timestamp": 1722732446, "time_this_iter_s": 12.99013066291809, "time_total_s": 305.50039768218994, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923727b6e60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 305.50039768218994, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.900000000000002, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 211.64479698141415, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 2.775955578312278, "policy_loss": -0.0076756967609981075, "vf_loss": 2.7931618887931107, "vf_explained_var": 0.9693376349906127, "kl": 0.01167262246158316, "entropy": 1.478330186381936, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -6.779372641913089, "episode_reward_min": -1517.071079805667, "episode_reward_mean": -598.6039760111514, "episode_len_mean": 120.01, "episode_media": {}, "episodes_timesteps_total": 12001, "policy_reward_min": {"policy_0": -1517.071079805667}, "policy_reward_max": {"policy_0": -6.779372641913089}, "policy_reward_mean": {"policy_0": -598.6039760111514}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-680.6499338200873, -588.4357852379642, -1461.0386614273868, -52.02075067227151, -225.90045255167504, -1238.2699897840241, -140.7417509153696, -213.52819121009748, -48.215897563860864, -766.1338877475396, -900.1981968378478, -71.92847177177411, -574.4120839339405, -843.0578661593271, -150.03760558372383, -200.88405286123285, -6.779372641913089, -673.0867749111172, -1007.7209557132792, -1169.232239120433, -80.37520381933815, -561.3850116010362, -1309.3445999877301, -98.70057691467535, -1074.8789976718563, -167.41338167290266, -881.4006779418664, -810.928346546203, -83.67291866615534, -1464.8865629988356, -161.62082882927055, -1236.6784572187275, -1022.8074575512566, -951.127111633293, -1023.8895617297072, -246.399180713478, -129.70899980966993, -16.374453879423484, -686.2863577055456, -1332.5131858747209, -104.13965469611594, -873.0459449442216, -119.56092828682623, -624.2440134264943, -555.1871796209173, -1021.3726751722289, -1298.617386544424, -1286.2404521417473, -935.340123734801, -661.5602736764899, -110.69330033584727, -664.9899472919809, -673.1561368029885, -858.8502070641376, -432.64930958160613, -939.8272381284089, -892.5334484233402, -102.68674185393033, -742.9093611845667, -921.883118854601, -41.60744957529576, -100.67341233969432, -183.51985335387627, -69.34168867486733, -1033.4991603637118, -1341.3972372022142, -163.38536222004979, -1517.071079805667, -321.2314690758557, -244.8926117240378, -783.1722507978996, -240.02009222115734, -469.6155015983523, -271.87770083609445, -363.8004153757113, -966.4176289423582, -1166.3032746429524, -434.3930535991346, -388.2487910220535, -284.5430060106633, -950.8848714434107, -60.832231732668674, -24.94279143462136, -66.03316623169339, -868.4978829736198, -694.9784363138157, -62.88663223553793, -497.3555886612402, -881.8576266500457, -328.52073129026394, -446.1150336470249, -282.5139415986669, -1004.3432631297359, -800.843531162479, -278.6002813156824, -1235.577835351896, -571.2632363368813, -753.8092428734161, -1346.3848199193283, -146.99318243522524], "episode_lengths": [150, 150, 150, 59, 101, 150, 55, 95, 55, 150, 150, 62, 150, 150, 85, 85, 37, 150, 150, 150, 89, 118, 150, 68, 150, 96, 150, 150, 82, 150, 139, 150, 150, 150, 150, 119, 60, 39, 150, 150, 71, 150, 72, 137, 150, 150, 150, 150, 150, 150, 68, 150, 150, 136, 130, 150, 150, 83, 150, 150, 57, 83, 86, 64, 150, 150, 60, 150, 87, 93, 150, 118, 138, 96, 150, 150, 150, 135, 132, 122, 143, 47, 49, 61, 137, 150, 59, 105, 150, 85, 108, 150, 150, 150, 89, 150, 150, 150, 150, 56], "policy_policy_0_reward": [-680.6499338200873, -588.4357852379642, -1461.0386614273868, -52.02075067227151, -225.90045255167504, -1238.2699897840241, -140.7417509153696, -213.52819121009748, -48.215897563860864, -766.1338877475396, -900.1981968378478, -71.92847177177411, -574.4120839339405, -843.0578661593271, -150.03760558372383, -200.88405286123285, -6.779372641913089, -673.0867749111172, -1007.7209557132792, -1169.232239120433, -80.37520381933815, -561.3850116010362, -1309.3445999877301, -98.70057691467535, -1074.8789976718563, -167.41338167290266, -881.4006779418664, -810.928346546203, -83.67291866615534, -1464.8865629988356, -161.62082882927055, -1236.6784572187275, -1022.8074575512566, -951.127111633293, -1023.8895617297072, -246.399180713478, -129.70899980966993, -16.374453879423484, -686.2863577055456, -1332.5131858747209, -104.13965469611594, -873.0459449442216, -119.56092828682623, -624.2440134264943, -555.1871796209173, -1021.3726751722289, -1298.617386544424, -1286.2404521417473, -935.340123734801, -661.5602736764899, -110.69330033584727, -664.9899472919809, -673.1561368029885, -858.8502070641376, -432.64930958160613, -939.8272381284089, -892.5334484233402, -102.68674185393033, -742.9093611845667, -921.883118854601, -41.60744957529576, -100.67341233969432, -183.51985335387627, -69.34168867486733, -1033.4991603637118, -1341.3972372022142, -163.38536222004979, -1517.071079805667, -321.2314690758557, -244.8926117240378, -783.1722507978996, -240.02009222115734, -469.6155015983523, -271.87770083609445, -363.8004153757113, -966.4176289423582, -1166.3032746429524, -434.3930535991346, -388.2487910220535, -284.5430060106633, -950.8848714434107, -60.832231732668674, -24.94279143462136, -66.03316623169339, -868.4978829736198, -694.9784363138157, -62.88663223553793, -497.3555886612402, -881.8576266500457, -328.52073129026394, -446.1150336470249, -282.5139415986669, -1004.3432631297359, -800.843531162479, -278.6002813156824, -1235.577835351896, -571.2632363368813, -753.8092428734161, -1346.3848199193283, -146.99318243522524]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553784927458914, "mean_inference_ms": 1.6782370432104319, "mean_action_processing_ms": 0.2758432036515465, "mean_env_wait_ms": 3.5113659128286248, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011966943740844727, "StateBufferConnector_ms": 0.00803375244140625, "ViewRequirementAgentConnector_ms": 0.19661259651184082}, "num_episodes": 34, "episode_return_max": -6.779372641913089, "episode_return_min": -1517.071079805667, "episode_return_mean": -598.6039760111514, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.0153611582421, "num_env_steps_trained_throughput_per_sec": 304.0153611582421, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12339.024, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12338.942, "sample_time_ms": 1179.59, "learn_time_ms": 11094.593, "learn_throughput": 360.536, "synch_weights_time_ms": 63.973}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00008", "date": "2024-08-04_06-17-39", "timestamp": 1722732459, "time_this_iter_s": 13.169749975204468, "time_total_s": 318.6701476573944, "pid": 580872, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270fb50>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 318.6701476573944, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.042105263157897, "ram_util_percent": 28.0}}
