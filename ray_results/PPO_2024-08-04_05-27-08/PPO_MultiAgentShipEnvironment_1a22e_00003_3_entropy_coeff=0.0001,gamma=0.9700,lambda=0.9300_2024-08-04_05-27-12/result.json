{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9329483330870668, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.649413178364435, "policy_loss": -0.006941064843946757, "vf_loss": 9.654357176025709, "vf_explained_var": 0.025003115087747572, "kl": 0.010698494829875926, "entropy": 1.4266026948889097, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -49.621080199657655, "episode_reward_min": -1084.4202863810985, "episode_reward_mean": -637.9683572611548, "episode_len_mean": 120.76, "episode_media": {}, "episodes_timesteps_total": 3019, "policy_reward_min": {"policy_0": -1084.4202863810985}, "policy_reward_max": {"policy_0": -49.621080199657655}, "policy_reward_mean": {"policy_0": -637.9683572611548}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-828.0176853220953, -912.0141969607625, -951.6617838869641, -302.43380115532307, -904.3717762089565, -1077.5920485732902, -970.7292444002965, -555.6880454299932, -123.01412114018213, -1084.4202863810985, -925.5138897200471, -786.1654994328501, -958.7048158525465, -74.39183911361931, -161.62068067154138, -124.13035693729006, -921.6263915874265, -49.621080199657655, -137.22685362229072, -522.2124734327589, -835.5991124375972, -824.9230172755495, -578.4942576187223, -763.3459654987915, -575.6897086692186], "episode_lengths": [150, 150, 150, 86, 150, 150, 150, 150, 77, 150, 150, 134, 150, 51, 68, 49, 150, 38, 52, 116, 150, 141, 128, 129, 150], "policy_policy_0_reward": [-828.0176853220953, -912.0141969607625, -951.6617838869641, -302.43380115532307, -904.3717762089565, -1077.5920485732902, -970.7292444002965, -555.6880454299932, -123.01412114018213, -1084.4202863810985, -925.5138897200471, -786.1654994328501, -958.7048158525465, -74.39183911361931, -161.62068067154138, -124.13035693729006, -921.6263915874265, -49.621080199657655, -137.22685362229072, -522.2124734327589, -835.5991124375972, -824.9230172755495, -578.4942576187223, -763.3459654987915, -575.6897086692186]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5725675883551536, "mean_inference_ms": 1.6927765014723608, "mean_action_processing_ms": 0.2797665675872652, "mean_env_wait_ms": 3.4718973980357104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011310577392578125, "StateBufferConnector_ms": 0.008168220520019531, "ViewRequirementAgentConnector_ms": 0.18013572692871094}, "num_episodes": 25, "episode_return_max": -49.621080199657655, "episode_return_min": -1084.4202863810985, "episode_return_mean": -637.9683572611548, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.16683551502643, "num_env_steps_trained_throughput_per_sec": 310.16683551502643, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12896.295, "restore_workers_time_ms": 0.026, "training_step_time_ms": 12896.231, "sample_time_ms": 1200.431, "learn_time_ms": 11625.512, "learn_throughput": 344.071, "synch_weights_time_ms": 69.543}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00003", "date": "2024-08-04_05-44-18", "timestamp": 1722730458, "time_this_iter_s": 12.906590461730957, "time_total_s": 12.906590461730957, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f66050>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.906590461730957, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.173684210526318, "ram_util_percent": 27.794736842105266}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8689625785996516, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.764227138956388, "policy_loss": -0.006447286899977674, "vf_loss": 9.768849603335063, "vf_explained_var": 0.027318043261766435, "kl": 0.009841506117057482, "entropy": 1.434929462398092, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -8.326334214854423, "episode_reward_min": -1306.6760250154948, "episode_reward_mean": -693.0052509543984, "episode_len_mean": 123.15686274509804, "episode_media": {}, "episodes_timesteps_total": 6281, "policy_reward_min": {"policy_0": -1306.6760250154948}, "policy_reward_max": {"policy_0": -8.326334214854423}, "policy_reward_mean": {"policy_0": -693.0052509543984}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-828.0176853220953, -912.0141969607625, -951.6617838869641, -302.43380115532307, -904.3717762089565, -1077.5920485732902, -970.7292444002965, -555.6880454299932, -123.01412114018213, -1084.4202863810985, -925.5138897200471, -786.1654994328501, -958.7048158525465, -74.39183911361931, -161.62068067154138, -124.13035693729006, -921.6263915874265, -49.621080199657655, -137.22685362229072, -522.2124734327589, -835.5991124375972, -824.9230172755495, -578.4942576187223, -763.3459654987915, -575.6897086692186, -1054.1973434354686, -19.683762848964534, -1120.1102708466428, -692.6978783524607, -1037.1038683443153, -8.326334214854423, -19.476249022718946, -1053.1767483378208, -334.0744587813518, -234.60471644799887, -1128.297831493543, -746.2838866757385, -790.0244145030143, -1245.5620707328749, -85.6605151047549, -1196.227463535813, -957.4557424690253, -921.0567655235159, -903.383887781626, -821.0633985827563, -902.4604284581399, -874.3544550393345, -650.5736291226202, -1306.6760250154948, -1092.2378025671785, -199.28891990742656], "episode_lengths": [150, 150, 150, 86, 150, 150, 150, 150, 77, 150, 150, 134, 150, 51, 68, 49, 150, 38, 52, 116, 150, 141, 128, 129, 150, 150, 41, 150, 150, 150, 34, 32, 150, 89, 79, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85], "policy_policy_0_reward": [-828.0176853220953, -912.0141969607625, -951.6617838869641, -302.43380115532307, -904.3717762089565, -1077.5920485732902, -970.7292444002965, -555.6880454299932, -123.01412114018213, -1084.4202863810985, -925.5138897200471, -786.1654994328501, -958.7048158525465, -74.39183911361931, -161.62068067154138, -124.13035693729006, -921.6263915874265, -49.621080199657655, -137.22685362229072, -522.2124734327589, -835.5991124375972, -824.9230172755495, -578.4942576187223, -763.3459654987915, -575.6897086692186, -1054.1973434354686, -19.683762848964534, -1120.1102708466428, -692.6978783524607, -1037.1038683443153, -8.326334214854423, -19.476249022718946, -1053.1767483378208, -334.0744587813518, -234.60471644799887, -1128.297831493543, -746.2838866757385, -790.0244145030143, -1245.5620707328749, -85.6605151047549, -1196.227463535813, -957.4557424690253, -921.0567655235159, -903.383887781626, -821.0633985827563, -902.4604284581399, -874.3544550393345, -650.5736291226202, -1306.6760250154948, -1092.2378025671785, -199.28891990742656]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5682256426479934, "mean_inference_ms": 1.6847119186780237, "mean_action_processing_ms": 0.2786681542885617, "mean_env_wait_ms": 3.4624495290215056, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013291602041207108, "StateBufferConnector_ms": 0.008412435943005132, "ViewRequirementAgentConnector_ms": 0.1878808526431813}, "num_episodes": 26, "episode_return_max": -8.326334214854423, "episode_return_min": -1306.6760250154948, "episode_return_mean": -693.0052509543984, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.449617467543, "num_env_steps_trained_throughput_per_sec": 302.449617467543, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13060.827, "restore_workers_time_ms": 0.037, "training_step_time_ms": 13060.748, "sample_time_ms": 1155.675, "learn_time_ms": 11828.741, "learn_throughput": 338.159, "synch_weights_time_ms": 75.574}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00003", "date": "2024-08-04_05-44-32", "timestamp": 1722730472, "time_this_iter_s": 13.237361431121826, "time_total_s": 26.143951892852783, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16eebf40>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.143951892852783, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.631578947368418, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.4970040818986794, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.501679525772731, "policy_loss": -0.009389398685016204, "vf_loss": 9.508344613512357, "vf_explained_var": 0.1302474834645788, "kl": 0.01436921872579357, "entropy": 1.495713568602999, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -8.326334214854423, "episode_reward_min": -1329.7814633879516, "episode_reward_mean": -692.0036082454038, "episode_len_mean": 123.86904761904762, "episode_media": {}, "episodes_timesteps_total": 10405, "policy_reward_min": {"policy_0": -1329.7814633879516}, "policy_reward_max": {"policy_0": -8.326334214854423}, "policy_reward_mean": {"policy_0": -692.0036082454038}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-828.0176853220953, -912.0141969607625, -951.6617838869641, -302.43380115532307, -904.3717762089565, -1077.5920485732902, -970.7292444002965, -555.6880454299932, -123.01412114018213, -1084.4202863810985, -925.5138897200471, -786.1654994328501, -958.7048158525465, -74.39183911361931, -161.62068067154138, -124.13035693729006, -921.6263915874265, -49.621080199657655, -137.22685362229072, -522.2124734327589, -835.5991124375972, -824.9230172755495, -578.4942576187223, -763.3459654987915, -575.6897086692186, -1054.1973434354686, -19.683762848964534, -1120.1102708466428, -692.6978783524607, -1037.1038683443153, -8.326334214854423, -19.476249022718946, -1053.1767483378208, -334.0744587813518, -234.60471644799887, -1128.297831493543, -746.2838866757385, -790.0244145030143, -1245.5620707328749, -85.6605151047549, -1196.227463535813, -957.4557424690253, -921.0567655235159, -903.383887781626, -821.0633985827563, -902.4604284581399, -874.3544550393345, -650.5736291226202, -1306.6760250154948, -1092.2378025671785, -199.28891990742656, -832.2944754957354, -163.3060369545677, -971.5055745660374, -768.174983482686, -870.8659502479495, -382.948034530525, -57.868830206152126, -809.5886578703255, -1014.3687710095775, -907.1293784102741, -1023.3472712783497, -669.17384431738, -637.5478064687343, -287.87278347768773, -1126.5413798655777, -482.30743782125745, -1329.7814633879516, -1075.053304569966, -1241.3319896232683, -759.969777223882, -26.13662077125563, -129.84437386432603, -462.3200963343208, -391.47485710959353, -590.4269189283483, -1001.9916094109992, -993.8917155523353, -190.27503869890867, -994.7028030924781, -126.89505318260775, -1056.6213406154081, -458.3075348846742, -951.1695806864691], "episode_lengths": [150, 150, 150, 86, 150, 150, 150, 150, 77, 150, 150, 134, 150, 51, 68, 49, 150, 38, 52, 116, 150, 141, 128, 129, 150, 150, 41, 150, 150, 150, 34, 32, 150, 89, 79, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 73, 150, 140, 150, 93, 55, 150, 150, 150, 150, 135, 150, 99, 150, 150, 150, 150, 150, 150, 39, 57, 105, 106, 116, 150, 150, 62, 150, 74, 150, 120, 150], "policy_policy_0_reward": [-828.0176853220953, -912.0141969607625, -951.6617838869641, -302.43380115532307, -904.3717762089565, -1077.5920485732902, -970.7292444002965, -555.6880454299932, -123.01412114018213, -1084.4202863810985, -925.5138897200471, -786.1654994328501, -958.7048158525465, -74.39183911361931, -161.62068067154138, -124.13035693729006, -921.6263915874265, -49.621080199657655, -137.22685362229072, -522.2124734327589, -835.5991124375972, -824.9230172755495, -578.4942576187223, -763.3459654987915, -575.6897086692186, -1054.1973434354686, -19.683762848964534, -1120.1102708466428, -692.6978783524607, -1037.1038683443153, -8.326334214854423, -19.476249022718946, -1053.1767483378208, -334.0744587813518, -234.60471644799887, -1128.297831493543, -746.2838866757385, -790.0244145030143, -1245.5620707328749, -85.6605151047549, -1196.227463535813, -957.4557424690253, -921.0567655235159, -903.383887781626, -821.0633985827563, -902.4604284581399, -874.3544550393345, -650.5736291226202, -1306.6760250154948, -1092.2378025671785, -199.28891990742656, -832.2944754957354, -163.3060369545677, -971.5055745660374, -768.174983482686, -870.8659502479495, -382.948034530525, -57.868830206152126, -809.5886578703255, -1014.3687710095775, -907.1293784102741, -1023.3472712783497, -669.17384431738, -637.5478064687343, -287.87278347768773, -1126.5413798655777, -482.30743782125745, -1329.7814633879516, -1075.053304569966, -1241.3319896232683, -759.969777223882, -26.13662077125563, -129.84437386432603, -462.3200963343208, -391.47485710959353, -590.4269189283483, -1001.9916094109992, -993.8917155523353, -190.27503869890867, -994.7028030924781, -126.89505318260775, -1056.6213406154081, -458.3075348846742, -951.1695806864691]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5681876018705404, "mean_inference_ms": 1.6818412511128602, "mean_action_processing_ms": 0.2785111590618968, "mean_env_wait_ms": 3.459857768950544, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013577654248192197, "StateBufferConnector_ms": 0.008542480922880628, "ViewRequirementAgentConnector_ms": 0.19228259722391763}, "num_episodes": 33, "episode_return_max": -8.326334214854423, "episode_return_min": -1329.7814633879516, "episode_return_mean": -692.0036082454038, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.5019804130519, "num_env_steps_trained_throughput_per_sec": 308.5019804130519, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13029.182, "restore_workers_time_ms": 0.034, "training_step_time_ms": 13029.107, "sample_time_ms": 1139.819, "learn_time_ms": 11817.678, "learn_throughput": 338.476, "synch_weights_time_ms": 70.853}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00003", "date": "2024-08-04_05-44-45", "timestamp": 1722730485, "time_this_iter_s": 12.977260828018188, "time_total_s": 39.12121272087097, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5caf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.12121272087097, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.03333333333333, "ram_util_percent": 27.888888888888886}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.403441295338174, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.355134904384613, "policy_loss": -0.008201918417277436, "vf_loss": 9.36066717406114, "vf_explained_var": 0.21728786664704483, "kl": 0.01410678845289416, "entropy": 1.5172434126337369, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -8.326334214854423, "episode_reward_min": -1445.6572048555377, "episode_reward_mean": -717.6426115467153, "episode_len_mean": 124.83, "episode_media": {}, "episodes_timesteps_total": 12483, "policy_reward_min": {"policy_0": -1445.6572048555377}, "policy_reward_max": {"policy_0": -8.326334214854423}, "policy_reward_mean": {"policy_0": -717.6426115467153}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-49.621080199657655, -137.22685362229072, -522.2124734327589, -835.5991124375972, -824.9230172755495, -578.4942576187223, -763.3459654987915, -575.6897086692186, -1054.1973434354686, -19.683762848964534, -1120.1102708466428, -692.6978783524607, -1037.1038683443153, -8.326334214854423, -19.476249022718946, -1053.1767483378208, -334.0744587813518, -234.60471644799887, -1128.297831493543, -746.2838866757385, -790.0244145030143, -1245.5620707328749, -85.6605151047549, -1196.227463535813, -957.4557424690253, -921.0567655235159, -903.383887781626, -821.0633985827563, -902.4604284581399, -874.3544550393345, -650.5736291226202, -1306.6760250154948, -1092.2378025671785, -199.28891990742656, -832.2944754957354, -163.3060369545677, -971.5055745660374, -768.174983482686, -870.8659502479495, -382.948034530525, -57.868830206152126, -809.5886578703255, -1014.3687710095775, -907.1293784102741, -1023.3472712783497, -669.17384431738, -637.5478064687343, -287.87278347768773, -1126.5413798655777, -482.30743782125745, -1329.7814633879516, -1075.053304569966, -1241.3319896232683, -759.969777223882, -26.13662077125563, -129.84437386432603, -462.3200963343208, -391.47485710959353, -590.4269189283483, -1001.9916094109992, -993.8917155523353, -190.27503869890867, -994.7028030924781, -126.89505318260775, -1056.6213406154081, -458.3075348846742, -951.1695806864691, -368.065057376026, -1110.0519610180318, -1155.5898627274696, -158.363637752633, -1007.4504143791455, -1179.9543893348905, -772.8591931420196, -1139.2256334024376, -365.64419783910654, -1445.6572048555377, -1014.5620723516639, -822.2018423050797, -996.8981516971039, -1258.932523358298, -1184.1842530038177, -1142.069944141678, -899.1433619581436, -10.93283192442342, -1010.2842424829383, -1016.8247595162566, -105.15701402105076, -116.55876786539241, -96.76858978855826, -1180.9896230123486, -9.717171153383756, -948.903320566114, -836.6280152862522, -94.34368633422407, -488.9624471243315, -1130.5459850804891, -763.8955380359517, -936.0040397135621, -530.684792283508], "episode_lengths": [38, 52, 116, 150, 141, 128, 129, 150, 150, 41, 150, 150, 150, 34, 32, 150, 89, 79, 150, 150, 150, 150, 52, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 150, 73, 150, 140, 150, 93, 55, 150, 150, 150, 150, 135, 150, 99, 150, 150, 150, 150, 150, 150, 39, 57, 105, 106, 116, 150, 150, 62, 150, 74, 150, 120, 150, 150, 150, 150, 81, 150, 150, 131, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 38, 150, 150, 65, 70, 55, 150, 37, 150, 150, 62, 113, 150, 150, 150, 150], "policy_policy_0_reward": [-49.621080199657655, -137.22685362229072, -522.2124734327589, -835.5991124375972, -824.9230172755495, -578.4942576187223, -763.3459654987915, -575.6897086692186, -1054.1973434354686, -19.683762848964534, -1120.1102708466428, -692.6978783524607, -1037.1038683443153, -8.326334214854423, -19.476249022718946, -1053.1767483378208, -334.0744587813518, -234.60471644799887, -1128.297831493543, -746.2838866757385, -790.0244145030143, -1245.5620707328749, -85.6605151047549, -1196.227463535813, -957.4557424690253, -921.0567655235159, -903.383887781626, -821.0633985827563, -902.4604284581399, -874.3544550393345, -650.5736291226202, -1306.6760250154948, -1092.2378025671785, -199.28891990742656, -832.2944754957354, -163.3060369545677, -971.5055745660374, -768.174983482686, -870.8659502479495, -382.948034530525, -57.868830206152126, -809.5886578703255, -1014.3687710095775, -907.1293784102741, -1023.3472712783497, -669.17384431738, -637.5478064687343, -287.87278347768773, -1126.5413798655777, -482.30743782125745, -1329.7814633879516, -1075.053304569966, -1241.3319896232683, -759.969777223882, -26.13662077125563, -129.84437386432603, -462.3200963343208, -391.47485710959353, -590.4269189283483, -1001.9916094109992, -993.8917155523353, -190.27503869890867, -994.7028030924781, -126.89505318260775, -1056.6213406154081, -458.3075348846742, -951.1695806864691, -368.065057376026, -1110.0519610180318, -1155.5898627274696, -158.363637752633, -1007.4504143791455, -1179.9543893348905, -772.8591931420196, -1139.2256334024376, -365.64419783910654, -1445.6572048555377, -1014.5620723516639, -822.2018423050797, -996.8981516971039, -1258.932523358298, -1184.1842530038177, -1142.069944141678, -899.1433619581436, -10.93283192442342, -1010.2842424829383, -1016.8247595162566, -105.15701402105076, -116.55876786539241, -96.76858978855826, -1180.9896230123486, -9.717171153383756, -948.903320566114, -836.6280152862522, -94.34368633422407, -488.9624471243315, -1130.5459850804891, -763.8955380359517, -936.0040397135621, -530.684792283508]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5673264353584488, "mean_inference_ms": 1.6818967159705127, "mean_action_processing_ms": 0.2786719059377316, "mean_env_wait_ms": 3.467590712679127, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014102935791015625, "StateBufferConnector_ms": 0.0086669921875, "ViewRequirementAgentConnector_ms": 0.1944284439086914}, "num_episodes": 33, "episode_return_max": -8.326334214854423, "episode_return_min": -1445.6572048555377, "episode_return_mean": -717.6426115467153, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.4075006858997, "num_env_steps_trained_throughput_per_sec": 303.4075006858997, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13067.787, "restore_workers_time_ms": 0.032, "training_step_time_ms": 13067.714, "sample_time_ms": 1156.785, "learn_time_ms": 11841.561, "learn_throughput": 337.793, "synch_weights_time_ms": 68.599}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00003", "date": "2024-08-04_05-44-58", "timestamp": 1722730498, "time_this_iter_s": 13.194857835769653, "time_total_s": 52.316070556640625, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f66320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 52.316070556640625, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.821052631578947, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.155849546970179, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.60082822640737, "policy_loss": -0.011141066620863664, "vf_loss": 9.608069829146068, "vf_explained_var": 0.22551564083745082, "kl": 0.020293083118788982, "entropy": 1.5914463261763254, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -9.717171153383756, "episode_reward_min": -1445.6572048555377, "episode_reward_mean": -776.3332664890946, "episode_len_mean": 131.01, "episode_media": {}, "episodes_timesteps_total": 13101, "policy_reward_min": {"policy_0": -1445.6572048555377}, "policy_reward_max": {"policy_0": -9.717171153383756}, "policy_reward_mean": {"policy_0": -776.3332664890946}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-903.383887781626, -821.0633985827563, -902.4604284581399, -874.3544550393345, -650.5736291226202, -1306.6760250154948, -1092.2378025671785, -199.28891990742656, -832.2944754957354, -163.3060369545677, -971.5055745660374, -768.174983482686, -870.8659502479495, -382.948034530525, -57.868830206152126, -809.5886578703255, -1014.3687710095775, -907.1293784102741, -1023.3472712783497, -669.17384431738, -637.5478064687343, -287.87278347768773, -1126.5413798655777, -482.30743782125745, -1329.7814633879516, -1075.053304569966, -1241.3319896232683, -759.969777223882, -26.13662077125563, -129.84437386432603, -462.3200963343208, -391.47485710959353, -590.4269189283483, -1001.9916094109992, -993.8917155523353, -190.27503869890867, -994.7028030924781, -126.89505318260775, -1056.6213406154081, -458.3075348846742, -951.1695806864691, -368.065057376026, -1110.0519610180318, -1155.5898627274696, -158.363637752633, -1007.4504143791455, -1179.9543893348905, -772.8591931420196, -1139.2256334024376, -365.64419783910654, -1445.6572048555377, -1014.5620723516639, -822.2018423050797, -996.8981516971039, -1258.932523358298, -1184.1842530038177, -1142.069944141678, -899.1433619581436, -10.93283192442342, -1010.2842424829383, -1016.8247595162566, -105.15701402105076, -116.55876786539241, -96.76858978855826, -1180.9896230123486, -9.717171153383756, -948.903320566114, -836.6280152862522, -94.34368633422407, -488.9624471243315, -1130.5459850804891, -763.8955380359517, -936.0040397135621, -530.684792283508, -898.91336070246, -837.5566739959766, -355.8420204599708, -1076.1593396150126, -196.94769162758448, -184.99075640445017, -1135.7691355402824, -842.7149708446639, -1085.3637687553223, -853.1300774354723, -830.4574384220359, -713.3088796731429, -1085.0472590501588, -959.4979847613416, -959.802485291343, -853.9650853538692, -1407.4859841873808, -1270.455519439334, -760.187944930864, -1160.1996119600105, -254.97399613340716, -750.416573328066, -1012.9897938623283, -903.8894646505184, -1373.7949204485872, -1036.337546789822], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 85, 150, 73, 150, 140, 150, 93, 55, 150, 150, 150, 150, 135, 150, 99, 150, 150, 150, 150, 150, 150, 39, 57, 105, 106, 116, 150, 150, 62, 150, 74, 150, 120, 150, 150, 150, 150, 81, 150, 150, 131, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 38, 150, 150, 65, 70, 55, 150, 37, 150, 150, 62, 113, 150, 150, 150, 150, 150, 150, 90, 150, 76, 94, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-903.383887781626, -821.0633985827563, -902.4604284581399, -874.3544550393345, -650.5736291226202, -1306.6760250154948, -1092.2378025671785, -199.28891990742656, -832.2944754957354, -163.3060369545677, -971.5055745660374, -768.174983482686, -870.8659502479495, -382.948034530525, -57.868830206152126, -809.5886578703255, -1014.3687710095775, -907.1293784102741, -1023.3472712783497, -669.17384431738, -637.5478064687343, -287.87278347768773, -1126.5413798655777, -482.30743782125745, -1329.7814633879516, -1075.053304569966, -1241.3319896232683, -759.969777223882, -26.13662077125563, -129.84437386432603, -462.3200963343208, -391.47485710959353, -590.4269189283483, -1001.9916094109992, -993.8917155523353, -190.27503869890867, -994.7028030924781, -126.89505318260775, -1056.6213406154081, -458.3075348846742, -951.1695806864691, -368.065057376026, -1110.0519610180318, -1155.5898627274696, -158.363637752633, -1007.4504143791455, -1179.9543893348905, -772.8591931420196, -1139.2256334024376, -365.64419783910654, -1445.6572048555377, -1014.5620723516639, -822.2018423050797, -996.8981516971039, -1258.932523358298, -1184.1842530038177, -1142.069944141678, -899.1433619581436, -10.93283192442342, -1010.2842424829383, -1016.8247595162566, -105.15701402105076, -116.55876786539241, -96.76858978855826, -1180.9896230123486, -9.717171153383756, -948.903320566114, -836.6280152862522, -94.34368633422407, -488.9624471243315, -1130.5459850804891, -763.8955380359517, -936.0040397135621, -530.684792283508, -898.91336070246, -837.5566739959766, -355.8420204599708, -1076.1593396150126, -196.94769162758448, -184.99075640445017, -1135.7691355402824, -842.7149708446639, -1085.3637687553223, -853.1300774354723, -830.4574384220359, -713.3088796731429, -1085.0472590501588, -959.4979847613416, -959.802485291343, -853.9650853538692, -1407.4859841873808, -1270.455519439334, -760.187944930864, -1160.1996119600105, -254.97399613340716, -750.416573328066, -1012.9897938623283, -903.8894646505184, -1373.7949204485872, -1036.337546789822]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5662723172635422, "mean_inference_ms": 1.6794701544609032, "mean_action_processing_ms": 0.2788977290511267, "mean_env_wait_ms": 3.468399864202059, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013868093490600586, "StateBufferConnector_ms": 0.00863504409790039, "ViewRequirementAgentConnector_ms": 0.19405746459960938}, "num_episodes": 26, "episode_return_max": -9.717171153383756, "episode_return_min": -1445.6572048555377, "episode_return_mean": -776.3332664890946, "episodes_this_iter": 26}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.9073749635341, "num_env_steps_trained_throughput_per_sec": 309.9073749635341, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13035.649, "restore_workers_time_ms": 0.033, "training_step_time_ms": 13035.575, "sample_time_ms": 1145.048, "learn_time_ms": 11821.506, "learn_throughput": 338.366, "synch_weights_time_ms": 68.236}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00003", "date": "2024-08-04_05-45-11", "timestamp": 1722730511, "time_this_iter_s": 12.919384002685547, "time_total_s": 65.23545455932617, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0ae950>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 65.23545455932617, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.977777777777774, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.20284114672492, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.371991525093714, "policy_loss": -0.012292327449540608, "vf_loss": 9.379074301322301, "vf_explained_var": 0.33164409634967645, "kl": 0.01789988371701839, "entropy": 1.6045166236658892, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -9.717171153383756, "episode_reward_min": -1445.6572048555377, "episode_reward_mean": -789.866568664189, "episode_len_mean": 131.57, "episode_media": {}, "episodes_timesteps_total": 13157, "policy_reward_min": {"policy_0": -1445.6572048555377}, "policy_reward_max": {"policy_0": -9.717171153383756}, "policy_reward_mean": {"policy_0": -789.866568664189}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-391.47485710959353, -590.4269189283483, -1001.9916094109992, -993.8917155523353, -190.27503869890867, -994.7028030924781, -126.89505318260775, -1056.6213406154081, -458.3075348846742, -951.1695806864691, -368.065057376026, -1110.0519610180318, -1155.5898627274696, -158.363637752633, -1007.4504143791455, -1179.9543893348905, -772.8591931420196, -1139.2256334024376, -365.64419783910654, -1445.6572048555377, -1014.5620723516639, -822.2018423050797, -996.8981516971039, -1258.932523358298, -1184.1842530038177, -1142.069944141678, -899.1433619581436, -10.93283192442342, -1010.2842424829383, -1016.8247595162566, -105.15701402105076, -116.55876786539241, -96.76858978855826, -1180.9896230123486, -9.717171153383756, -948.903320566114, -836.6280152862522, -94.34368633422407, -488.9624471243315, -1130.5459850804891, -763.8955380359517, -936.0040397135621, -530.684792283508, -898.91336070246, -837.5566739959766, -355.8420204599708, -1076.1593396150126, -196.94769162758448, -184.99075640445017, -1135.7691355402824, -842.7149708446639, -1085.3637687553223, -853.1300774354723, -830.4574384220359, -713.3088796731429, -1085.0472590501588, -959.4979847613416, -959.802485291343, -853.9650853538692, -1407.4859841873808, -1270.455519439334, -760.187944930864, -1160.1996119600105, -254.97399613340716, -750.416573328066, -1012.9897938623283, -903.8894646505184, -1373.7949204485872, -1036.337546789822, -688.7716534297173, -1407.6460755414714, -1089.2165071578227, -1179.699180080353, -109.27670820538128, -1117.9536717492588, -1021.009401382924, -1192.8439608781111, -1253.2790256408177, -828.6271616585776, -1074.060180772984, -997.218433346078, -125.06143821751081, -1016.8739801115423, -1206.3910959238078, -738.4320370452975, -108.15064503442977, -829.3651908436261, -924.6771970690896, -40.08253741700351, -322.81181698462086, -896.0119346236744, -1030.8280078864768, -648.1050706756153, -929.5522606910645, -1078.2739105110566, -126.79296704836752, -202.77912079513797, -744.1796058403863, -269.3780328664907, -935.2987963331153], "episode_lengths": [106, 116, 150, 150, 62, 150, 74, 150, 120, 150, 150, 150, 150, 81, 150, 150, 131, 150, 91, 150, 150, 150, 150, 150, 150, 150, 150, 38, 150, 150, 65, 70, 55, 150, 37, 150, 150, 62, 113, 150, 150, 150, 150, 150, 150, 90, 150, 76, 94, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 71, 150, 150, 50, 116, 150, 150, 150, 150, 150, 79, 83, 150, 93, 150], "policy_policy_0_reward": [-391.47485710959353, -590.4269189283483, -1001.9916094109992, -993.8917155523353, -190.27503869890867, -994.7028030924781, -126.89505318260775, -1056.6213406154081, -458.3075348846742, -951.1695806864691, -368.065057376026, -1110.0519610180318, -1155.5898627274696, -158.363637752633, -1007.4504143791455, -1179.9543893348905, -772.8591931420196, -1139.2256334024376, -365.64419783910654, -1445.6572048555377, -1014.5620723516639, -822.2018423050797, -996.8981516971039, -1258.932523358298, -1184.1842530038177, -1142.069944141678, -899.1433619581436, -10.93283192442342, -1010.2842424829383, -1016.8247595162566, -105.15701402105076, -116.55876786539241, -96.76858978855826, -1180.9896230123486, -9.717171153383756, -948.903320566114, -836.6280152862522, -94.34368633422407, -488.9624471243315, -1130.5459850804891, -763.8955380359517, -936.0040397135621, -530.684792283508, -898.91336070246, -837.5566739959766, -355.8420204599708, -1076.1593396150126, -196.94769162758448, -184.99075640445017, -1135.7691355402824, -842.7149708446639, -1085.3637687553223, -853.1300774354723, -830.4574384220359, -713.3088796731429, -1085.0472590501588, -959.4979847613416, -959.802485291343, -853.9650853538692, -1407.4859841873808, -1270.455519439334, -760.187944930864, -1160.1996119600105, -254.97399613340716, -750.416573328066, -1012.9897938623283, -903.8894646505184, -1373.7949204485872, -1036.337546789822, -688.7716534297173, -1407.6460755414714, -1089.2165071578227, -1179.699180080353, -109.27670820538128, -1117.9536717492588, -1021.009401382924, -1192.8439608781111, -1253.2790256408177, -828.6271616585776, -1074.060180772984, -997.218433346078, -125.06143821751081, -1016.8739801115423, -1206.3910959238078, -738.4320370452975, -108.15064503442977, -829.3651908436261, -924.6771970690896, -40.08253741700351, -322.81181698462086, -896.0119346236744, -1030.8280078864768, -648.1050706756153, -929.5522606910645, -1078.2739105110566, -126.79296704836752, -202.77912079513797, -744.1796058403863, -269.3780328664907, -935.2987963331153]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5649758160551125, "mean_inference_ms": 1.6788949260637878, "mean_action_processing_ms": 0.27929955016835334, "mean_env_wait_ms": 3.4797105801969725, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013870477676391602, "StateBufferConnector_ms": 0.008579492568969727, "ViewRequirementAgentConnector_ms": 0.19247770309448242}, "num_episodes": 31, "episode_return_max": -9.717171153383756, "episode_return_min": -1445.6572048555377, "episode_return_mean": -789.866568664189, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.4165082745627, "num_env_steps_trained_throughput_per_sec": 304.4165082745627, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 13053.025, "restore_workers_time_ms": 0.036, "training_step_time_ms": 13052.947, "sample_time_ms": 1139.315, "learn_time_ms": 11843.991, "learn_throughput": 337.724, "synch_weights_time_ms": 68.864}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00003", "date": "2024-08-04_05-45-24", "timestamp": 1722730524, "time_this_iter_s": 13.15263295173645, "time_total_s": 78.38808751106262, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0af520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 78.38808751106262, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.910526315789475, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.5585948379089434, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.540261599421502, "policy_loss": -0.01659220519165198, "vf_loss": 9.552195975184441, "vf_explained_var": 0.3275478514532248, "kl": 0.016038998469639416, "entropy": 1.538689628491799, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -2.902977270032259, "episode_reward_min": -1489.7061167006734, "episode_reward_mean": -753.8521438733801, "episode_len_mean": 130.33, "episode_media": {}, "episodes_timesteps_total": 13033, "policy_reward_min": {"policy_0": -1489.7061167006734}, "policy_reward_max": {"policy_0": -2.902977270032259}, "policy_reward_mean": {"policy_0": -753.8521438733801}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-96.76858978855826, -1180.9896230123486, -9.717171153383756, -948.903320566114, -836.6280152862522, -94.34368633422407, -488.9624471243315, -1130.5459850804891, -763.8955380359517, -936.0040397135621, -530.684792283508, -898.91336070246, -837.5566739959766, -355.8420204599708, -1076.1593396150126, -196.94769162758448, -184.99075640445017, -1135.7691355402824, -842.7149708446639, -1085.3637687553223, -853.1300774354723, -830.4574384220359, -713.3088796731429, -1085.0472590501588, -959.4979847613416, -959.802485291343, -853.9650853538692, -1407.4859841873808, -1270.455519439334, -760.187944930864, -1160.1996119600105, -254.97399613340716, -750.416573328066, -1012.9897938623283, -903.8894646505184, -1373.7949204485872, -1036.337546789822, -688.7716534297173, -1407.6460755414714, -1089.2165071578227, -1179.699180080353, -109.27670820538128, -1117.9536717492588, -1021.009401382924, -1192.8439608781111, -1253.2790256408177, -828.6271616585776, -1074.060180772984, -997.218433346078, -125.06143821751081, -1016.8739801115423, -1206.3910959238078, -738.4320370452975, -108.15064503442977, -829.3651908436261, -924.6771970690896, -40.08253741700351, -322.81181698462086, -896.0119346236744, -1030.8280078864768, -648.1050706756153, -929.5522606910645, -1078.2739105110566, -126.79296704836752, -202.77912079513797, -744.1796058403863, -269.3780328664907, -935.2987963331153, -816.9822510617885, -671.2834101517783, -503.6316570209168, -981.0750288835899, -1065.8820441594037, -951.6805907539068, -512.8376111995814, -244.96771928662199, -679.720536404313, -718.4459944877203, -811.8661453166337, -1002.0093405219231, -1262.876325647429, -1038.8019836256253, -907.5946496085879, -138.195362517866, -550.6988975001735, -1005.615251484623, -570.7064249700558, -69.40856338309052, -700.9961648832201, -175.5565647444511, -847.3802798020857, -2.902977270032259, -488.3314453809216, -554.7534701230556, -93.35657967665526, -102.65064498811118, -976.8834000672829, -131.64122529976132, -1366.4866326121933, -1489.7061167006734], "episode_lengths": [55, 150, 37, 150, 150, 62, 113, 150, 150, 150, 150, 150, 150, 90, 150, 76, 94, 150, 146, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 71, 150, 150, 50, 116, 150, 150, 150, 150, 150, 79, 83, 150, 93, 150, 150, 150, 150, 150, 150, 150, 103, 108, 150, 150, 150, 150, 150, 150, 150, 64, 115, 150, 150, 50, 150, 61, 150, 35, 109, 150, 56, 68, 150, 61, 150, 150], "policy_policy_0_reward": [-96.76858978855826, -1180.9896230123486, -9.717171153383756, -948.903320566114, -836.6280152862522, -94.34368633422407, -488.9624471243315, -1130.5459850804891, -763.8955380359517, -936.0040397135621, -530.684792283508, -898.91336070246, -837.5566739959766, -355.8420204599708, -1076.1593396150126, -196.94769162758448, -184.99075640445017, -1135.7691355402824, -842.7149708446639, -1085.3637687553223, -853.1300774354723, -830.4574384220359, -713.3088796731429, -1085.0472590501588, -959.4979847613416, -959.802485291343, -853.9650853538692, -1407.4859841873808, -1270.455519439334, -760.187944930864, -1160.1996119600105, -254.97399613340716, -750.416573328066, -1012.9897938623283, -903.8894646505184, -1373.7949204485872, -1036.337546789822, -688.7716534297173, -1407.6460755414714, -1089.2165071578227, -1179.699180080353, -109.27670820538128, -1117.9536717492588, -1021.009401382924, -1192.8439608781111, -1253.2790256408177, -828.6271616585776, -1074.060180772984, -997.218433346078, -125.06143821751081, -1016.8739801115423, -1206.3910959238078, -738.4320370452975, -108.15064503442977, -829.3651908436261, -924.6771970690896, -40.08253741700351, -322.81181698462086, -896.0119346236744, -1030.8280078864768, -648.1050706756153, -929.5522606910645, -1078.2739105110566, -126.79296704836752, -202.77912079513797, -744.1796058403863, -269.3780328664907, -935.2987963331153, -816.9822510617885, -671.2834101517783, -503.6316570209168, -981.0750288835899, -1065.8820441594037, -951.6805907539068, -512.8376111995814, -244.96771928662199, -679.720536404313, -718.4459944877203, -811.8661453166337, -1002.0093405219231, -1262.876325647429, -1038.8019836256253, -907.5946496085879, -138.195362517866, -550.6988975001735, -1005.615251484623, -570.7064249700558, -69.40856338309052, -700.9961648832201, -175.5565647444511, -847.3802798020857, -2.902977270032259, -488.3314453809216, -554.7534701230556, -93.35657967665526, -102.65064498811118, -976.8834000672829, -131.64122529976132, -1366.4866326121933, -1489.7061167006734]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5643412514997487, "mean_inference_ms": 1.6790096507526118, "mean_action_processing_ms": 0.27941006229889653, "mean_env_wait_ms": 3.4852120082298783, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013391256332397461, "StateBufferConnector_ms": 0.00833439826965332, "ViewRequirementAgentConnector_ms": 0.19136643409729004}, "num_episodes": 32, "episode_return_max": -2.902977270032259, "episode_return_min": -1489.7061167006734, "episode_return_mean": -753.8521438733801, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.88093896829093, "num_env_steps_trained_throughput_per_sec": 308.88093896829093, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 13038.305, "restore_workers_time_ms": 0.035, "training_step_time_ms": 13038.228, "sample_time_ms": 1132.764, "learn_time_ms": 11834.836, "learn_throughput": 337.985, "synch_weights_time_ms": 69.827}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00003", "date": "2024-08-04_05-45-37", "timestamp": 1722730537, "time_this_iter_s": 12.961859941482544, "time_total_s": 91.34994745254517, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5caf0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 91.34994745254517, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.626315789473686, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.881741629696141, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.474093376596768, "policy_loss": -0.012151216511847451, "vf_loss": 9.48162414431572, "vf_explained_var": 0.17363938732693593, "kl": 0.015978987435937606, "entropy": 1.7322999263803165, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -2.902977270032259, "episode_reward_min": -1489.7061167006734, "episode_reward_mean": -796.3271107890536, "episode_len_mean": 134.09, "episode_media": {}, "episodes_timesteps_total": 13409, "policy_reward_min": {"policy_0": -1489.7061167006734}, "policy_reward_max": {"policy_0": -2.902977270032259}, "policy_reward_mean": {"policy_0": -796.3271107890536}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-959.802485291343, -853.9650853538692, -1407.4859841873808, -1270.455519439334, -760.187944930864, -1160.1996119600105, -254.97399613340716, -750.416573328066, -1012.9897938623283, -903.8894646505184, -1373.7949204485872, -1036.337546789822, -688.7716534297173, -1407.6460755414714, -1089.2165071578227, -1179.699180080353, -109.27670820538128, -1117.9536717492588, -1021.009401382924, -1192.8439608781111, -1253.2790256408177, -828.6271616585776, -1074.060180772984, -997.218433346078, -125.06143821751081, -1016.8739801115423, -1206.3910959238078, -738.4320370452975, -108.15064503442977, -829.3651908436261, -924.6771970690896, -40.08253741700351, -322.81181698462086, -896.0119346236744, -1030.8280078864768, -648.1050706756153, -929.5522606910645, -1078.2739105110566, -126.79296704836752, -202.77912079513797, -744.1796058403863, -269.3780328664907, -935.2987963331153, -816.9822510617885, -671.2834101517783, -503.6316570209168, -981.0750288835899, -1065.8820441594037, -951.6805907539068, -512.8376111995814, -244.96771928662199, -679.720536404313, -718.4459944877203, -811.8661453166337, -1002.0093405219231, -1262.876325647429, -1038.8019836256253, -907.5946496085879, -138.195362517866, -550.6988975001735, -1005.615251484623, -570.7064249700558, -69.40856338309052, -700.9961648832201, -175.5565647444511, -847.3802798020857, -2.902977270032259, -488.3314453809216, -554.7534701230556, -93.35657967665526, -102.65064498811118, -976.8834000672829, -131.64122529976132, -1366.4866326121933, -1489.7061167006734, -1189.895692254011, -1023.4866700698793, -1038.7269060790404, -963.608030926238, -1077.8764385943655, -944.8922878966772, -824.6936808145305, -951.8590811282759, -885.3600307066066, -130.71474534424493, -1111.2503679557983, -1065.187977121945, -540.3339793025549, -1376.7179346565342, -993.169442392288, -824.9343909263141, -435.643189729489, -1143.1658122048307, -1213.077693532959, -860.6758684081626, -625.7543242069104, -395.61394860125614, -1036.33720094421, -1082.41044150003, -585.2531219367877], "episode_lengths": [150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 150, 150, 150, 72, 150, 150, 150, 150, 150, 150, 150, 73, 150, 150, 150, 71, 150, 150, 50, 116, 150, 150, 150, 150, 150, 79, 83, 150, 93, 150, 150, 150, 150, 150, 150, 150, 103, 108, 150, 150, 150, 150, 150, 150, 150, 64, 115, 150, 150, 50, 150, 61, 150, 35, 109, 150, 56, 68, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150], "policy_policy_0_reward": [-959.802485291343, -853.9650853538692, -1407.4859841873808, -1270.455519439334, -760.187944930864, -1160.1996119600105, -254.97399613340716, -750.416573328066, -1012.9897938623283, -903.8894646505184, -1373.7949204485872, -1036.337546789822, -688.7716534297173, -1407.6460755414714, -1089.2165071578227, -1179.699180080353, -109.27670820538128, -1117.9536717492588, -1021.009401382924, -1192.8439608781111, -1253.2790256408177, -828.6271616585776, -1074.060180772984, -997.218433346078, -125.06143821751081, -1016.8739801115423, -1206.3910959238078, -738.4320370452975, -108.15064503442977, -829.3651908436261, -924.6771970690896, -40.08253741700351, -322.81181698462086, -896.0119346236744, -1030.8280078864768, -648.1050706756153, -929.5522606910645, -1078.2739105110566, -126.79296704836752, -202.77912079513797, -744.1796058403863, -269.3780328664907, -935.2987963331153, -816.9822510617885, -671.2834101517783, -503.6316570209168, -981.0750288835899, -1065.8820441594037, -951.6805907539068, -512.8376111995814, -244.96771928662199, -679.720536404313, -718.4459944877203, -811.8661453166337, -1002.0093405219231, -1262.876325647429, -1038.8019836256253, -907.5946496085879, -138.195362517866, -550.6988975001735, -1005.615251484623, -570.7064249700558, -69.40856338309052, -700.9961648832201, -175.5565647444511, -847.3802798020857, -2.902977270032259, -488.3314453809216, -554.7534701230556, -93.35657967665526, -102.65064498811118, -976.8834000672829, -131.64122529976132, -1366.4866326121933, -1489.7061167006734, -1189.895692254011, -1023.4866700698793, -1038.7269060790404, -963.608030926238, -1077.8764385943655, -944.8922878966772, -824.6936808145305, -951.8590811282759, -885.3600307066066, -130.71474534424493, -1111.2503679557983, -1065.187977121945, -540.3339793025549, -1376.7179346565342, -993.169442392288, -824.9343909263141, -435.643189729489, -1143.1658122048307, -1213.077693532959, -860.6758684081626, -625.7543242069104, -395.61394860125614, -1036.33720094421, -1082.41044150003, -585.2531219367877]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5630001870447745, "mean_inference_ms": 1.6759224656013125, "mean_action_processing_ms": 0.2787126631937319, "mean_env_wait_ms": 3.4865887694274886, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012922525405883789, "StateBufferConnector_ms": 0.008174419403076172, "ViewRequirementAgentConnector_ms": 0.1910703182220459}, "num_episodes": 25, "episode_return_max": -2.902977270032259, "episode_return_min": -1489.7061167006734, "episode_return_mean": -796.3271107890536, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 355.8015315110826, "num_env_steps_trained_throughput_per_sec": 355.8015315110826, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12813.796, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12813.722, "sample_time_ms": 1133.781, "learn_time_ms": 11609.006, "learn_throughput": 344.56, "synch_weights_time_ms": 70.14}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00003", "date": "2024-08-04_05-45-48", "timestamp": 1722730548, "time_this_iter_s": 11.254679441452026, "time_total_s": 102.60462689399719, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f67520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 102.60462689399719, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 19.03125, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 9.502603428189953, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.963221123317878, "policy_loss": -0.013195747563440819, "vf_loss": 8.97184497018655, "vf_explained_var": 0.4425426784902811, "kl": 0.015749051685831243, "entropy": 1.5283557598789532, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -2.902977270032259, "episode_reward_min": -1489.7061167006734, "episode_reward_mean": -768.9285536651762, "episode_len_mean": 131.33, "episode_media": {}, "episodes_timesteps_total": 13133, "policy_reward_min": {"policy_0": -1489.7061167006734}, "policy_reward_max": {"policy_0": -2.902977270032259}, "policy_reward_mean": {"policy_0": -768.9285536651762}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1030.8280078864768, -648.1050706756153, -929.5522606910645, -1078.2739105110566, -126.79296704836752, -202.77912079513797, -744.1796058403863, -269.3780328664907, -935.2987963331153, -816.9822510617885, -671.2834101517783, -503.6316570209168, -981.0750288835899, -1065.8820441594037, -951.6805907539068, -512.8376111995814, -244.96771928662199, -679.720536404313, -718.4459944877203, -811.8661453166337, -1002.0093405219231, -1262.876325647429, -1038.8019836256253, -907.5946496085879, -138.195362517866, -550.6988975001735, -1005.615251484623, -570.7064249700558, -69.40856338309052, -700.9961648832201, -175.5565647444511, -847.3802798020857, -2.902977270032259, -488.3314453809216, -554.7534701230556, -93.35657967665526, -102.65064498811118, -976.8834000672829, -131.64122529976132, -1366.4866326121933, -1489.7061167006734, -1189.895692254011, -1023.4866700698793, -1038.7269060790404, -963.608030926238, -1077.8764385943655, -944.8922878966772, -824.6936808145305, -951.8590811282759, -885.3600307066066, -130.71474534424493, -1111.2503679557983, -1065.187977121945, -540.3339793025549, -1376.7179346565342, -993.169442392288, -824.9343909263141, -435.643189729489, -1143.1658122048307, -1213.077693532959, -860.6758684081626, -625.7543242069104, -395.61394860125614, -1036.33720094421, -1082.41044150003, -585.2531219367877, -1028.2912999605032, -883.5866339588563, -968.0010034177496, -794.7617608475482, -843.3098437745563, -566.5594907951822, -61.20383662437224, -1104.4523303781646, -80.71292582482938, -603.9241465722788, -1444.4375523169558, -717.4352937229495, -724.9175263299303, -442.12295515708007, -983.9972699023131, -1243.9841781844475, -1401.3513459609687, -448.80288579176715, -253.91863712135125, -1458.5951860476816, -579.0376887659118, -407.3025927492036, -157.41775616543453, -930.3453708279766, -739.0359136651723, -792.3092237205243, -1222.32057017784, -1244.4593511760397, -1260.0376469214837, -1404.8765592162713, -58.29259732605865, -989.2054188022076, -219.62178373860914, -1113.4744711596902], "episode_lengths": [150, 150, 150, 150, 79, 83, 150, 93, 150, 150, 150, 150, 150, 150, 150, 103, 108, 150, 150, 150, 150, 150, 150, 150, 64, 115, 150, 150, 50, 150, 61, 150, 35, 109, 150, 56, 68, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 117, 46, 150, 54, 118, 150, 150, 150, 135, 150, 150, 150, 100, 83, 150, 143, 112, 63, 150, 150, 150, 150, 150, 150, 150, 57, 150, 71, 150], "policy_policy_0_reward": [-1030.8280078864768, -648.1050706756153, -929.5522606910645, -1078.2739105110566, -126.79296704836752, -202.77912079513797, -744.1796058403863, -269.3780328664907, -935.2987963331153, -816.9822510617885, -671.2834101517783, -503.6316570209168, -981.0750288835899, -1065.8820441594037, -951.6805907539068, -512.8376111995814, -244.96771928662199, -679.720536404313, -718.4459944877203, -811.8661453166337, -1002.0093405219231, -1262.876325647429, -1038.8019836256253, -907.5946496085879, -138.195362517866, -550.6988975001735, -1005.615251484623, -570.7064249700558, -69.40856338309052, -700.9961648832201, -175.5565647444511, -847.3802798020857, -2.902977270032259, -488.3314453809216, -554.7534701230556, -93.35657967665526, -102.65064498811118, -976.8834000672829, -131.64122529976132, -1366.4866326121933, -1489.7061167006734, -1189.895692254011, -1023.4866700698793, -1038.7269060790404, -963.608030926238, -1077.8764385943655, -944.8922878966772, -824.6936808145305, -951.8590811282759, -885.3600307066066, -130.71474534424493, -1111.2503679557983, -1065.187977121945, -540.3339793025549, -1376.7179346565342, -993.169442392288, -824.9343909263141, -435.643189729489, -1143.1658122048307, -1213.077693532959, -860.6758684081626, -625.7543242069104, -395.61394860125614, -1036.33720094421, -1082.41044150003, -585.2531219367877, -1028.2912999605032, -883.5866339588563, -968.0010034177496, -794.7617608475482, -843.3098437745563, -566.5594907951822, -61.20383662437224, -1104.4523303781646, -80.71292582482938, -603.9241465722788, -1444.4375523169558, -717.4352937229495, -724.9175263299303, -442.12295515708007, -983.9972699023131, -1243.9841781844475, -1401.3513459609687, -448.80288579176715, -253.91863712135125, -1458.5951860476816, -579.0376887659118, -407.3025927492036, -157.41775616543453, -930.3453708279766, -739.0359136651723, -792.3092237205243, -1222.32057017784, -1244.4593511760397, -1260.0376469214837, -1404.8765592162713, -58.29259732605865, -989.2054188022076, -219.62178373860914, -1113.4744711596902]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5616674312411092, "mean_inference_ms": 1.6748355278088634, "mean_action_processing_ms": 0.2780320564735781, "mean_env_wait_ms": 3.494008572512548, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012584447860717773, "StateBufferConnector_ms": 0.008039712905883789, "ViewRequirementAgentConnector_ms": 0.19698452949523926}, "num_episodes": 34, "episode_return_max": -2.902977270032259, "episode_return_min": -1489.7061167006734, "episode_return_mean": -768.9285536651762, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.3826637420302, "num_env_steps_trained_throughput_per_sec": 305.3826637420302, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12845.411, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12845.335, "sample_time_ms": 1133.18, "learn_time_ms": 11642.317, "learn_throughput": 343.574, "synch_weights_time_ms": 69.047}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00003", "date": "2024-08-04_05-46-01", "timestamp": 1722730561, "time_this_iter_s": 13.111191272735596, "time_total_s": 115.71581816673279, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0ae710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 115.71581816673279, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 17.931578947368422, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 10.540414316455523, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.208609724541505, "policy_loss": -0.01148230715916725, "vf_loss": 9.214437672495842, "vf_explained_var": 0.5958129276211063, "kl": 0.01934201457427965, "entropy": 1.481924349690477, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -2.902977270032259, "episode_reward_min": -1489.7061167006734, "episode_reward_mean": -762.9230900366878, "episode_len_mean": 129.52, "episode_media": {}, "episodes_timesteps_total": 12952, "policy_reward_min": {"policy_0": -1489.7061167006734}, "policy_reward_max": {"policy_0": -2.902977270032259}, "policy_reward_mean": {"policy_0": -762.9230900366878}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-2.902977270032259, -488.3314453809216, -554.7534701230556, -93.35657967665526, -102.65064498811118, -976.8834000672829, -131.64122529976132, -1366.4866326121933, -1489.7061167006734, -1189.895692254011, -1023.4866700698793, -1038.7269060790404, -963.608030926238, -1077.8764385943655, -944.8922878966772, -824.6936808145305, -951.8590811282759, -885.3600307066066, -130.71474534424493, -1111.2503679557983, -1065.187977121945, -540.3339793025549, -1376.7179346565342, -993.169442392288, -824.9343909263141, -435.643189729489, -1143.1658122048307, -1213.077693532959, -860.6758684081626, -625.7543242069104, -395.61394860125614, -1036.33720094421, -1082.41044150003, -585.2531219367877, -1028.2912999605032, -883.5866339588563, -968.0010034177496, -794.7617608475482, -843.3098437745563, -566.5594907951822, -61.20383662437224, -1104.4523303781646, -80.71292582482938, -603.9241465722788, -1444.4375523169558, -717.4352937229495, -724.9175263299303, -442.12295515708007, -983.9972699023131, -1243.9841781844475, -1401.3513459609687, -448.80288579176715, -253.91863712135125, -1458.5951860476816, -579.0376887659118, -407.3025927492036, -157.41775616543453, -930.3453708279766, -739.0359136651723, -792.3092237205243, -1222.32057017784, -1244.4593511760397, -1260.0376469214837, -1404.8765592162713, -58.29259732605865, -989.2054188022076, -219.62178373860914, -1113.4744711596902, -758.4356055590338, -106.46947723449266, -636.5538884248363, -22.728428820005316, -216.30537533964323, -1231.4786399527218, -114.03424820725014, -188.85523572955137, -1198.9413695064106, -1013.834054219979, -450.93085941117283, -357.5586019486192, -800.5180961574194, -358.9597366960525, -342.10514341636633, -142.6568253460091, -1140.4757395669408, -868.1616567963262, -980.1100264267118, -1301.8834065878982, -727.5155510185572, -1160.3151542237724, -968.2437376117016, -880.8711682062927, -941.4599927053006, -467.7081084639946, -908.1838327124057, -683.845049137928, -591.0108616103806, -908.9654829610341, -753.6225834873612, -370.1162697280738], "episode_lengths": [35, 109, 150, 56, 68, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 51, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 150, 150, 117, 46, 150, 54, 118, 150, 150, 150, 135, 150, 150, 150, 100, 83, 150, 143, 112, 63, 150, 150, 150, 150, 150, 150, 150, 57, 150, 71, 150, 150, 67, 150, 39, 72, 150, 66, 70, 150, 150, 150, 109, 134, 86, 112, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 110, 150, 150, 150], "policy_policy_0_reward": [-2.902977270032259, -488.3314453809216, -554.7534701230556, -93.35657967665526, -102.65064498811118, -976.8834000672829, -131.64122529976132, -1366.4866326121933, -1489.7061167006734, -1189.895692254011, -1023.4866700698793, -1038.7269060790404, -963.608030926238, -1077.8764385943655, -944.8922878966772, -824.6936808145305, -951.8590811282759, -885.3600307066066, -130.71474534424493, -1111.2503679557983, -1065.187977121945, -540.3339793025549, -1376.7179346565342, -993.169442392288, -824.9343909263141, -435.643189729489, -1143.1658122048307, -1213.077693532959, -860.6758684081626, -625.7543242069104, -395.61394860125614, -1036.33720094421, -1082.41044150003, -585.2531219367877, -1028.2912999605032, -883.5866339588563, -968.0010034177496, -794.7617608475482, -843.3098437745563, -566.5594907951822, -61.20383662437224, -1104.4523303781646, -80.71292582482938, -603.9241465722788, -1444.4375523169558, -717.4352937229495, -724.9175263299303, -442.12295515708007, -983.9972699023131, -1243.9841781844475, -1401.3513459609687, -448.80288579176715, -253.91863712135125, -1458.5951860476816, -579.0376887659118, -407.3025927492036, -157.41775616543453, -930.3453708279766, -739.0359136651723, -792.3092237205243, -1222.32057017784, -1244.4593511760397, -1260.0376469214837, -1404.8765592162713, -58.29259732605865, -989.2054188022076, -219.62178373860914, -1113.4744711596902, -758.4356055590338, -106.46947723449266, -636.5538884248363, -22.728428820005316, -216.30537533964323, -1231.4786399527218, -114.03424820725014, -188.85523572955137, -1198.9413695064106, -1013.834054219979, -450.93085941117283, -357.5586019486192, -800.5180961574194, -358.9597366960525, -342.10514341636633, -142.6568253460091, -1140.4757395669408, -868.1616567963262, -980.1100264267118, -1301.8834065878982, -727.5155510185572, -1160.3151542237724, -968.2437376117016, -880.8711682062927, -941.4599927053006, -467.7081084639946, -908.1838327124057, -683.845049137928, -591.0108616103806, -908.9654829610341, -753.6225834873612, -370.1162697280738]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5593069321188717, "mean_inference_ms": 1.6728356893118492, "mean_action_processing_ms": 0.27722194448879395, "mean_env_wait_ms": 3.5001577367652232, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011941909790039062, "StateBufferConnector_ms": 0.007898569107055664, "ViewRequirementAgentConnector_ms": 0.19430279731750488}, "num_episodes": 32, "episode_return_max": -2.902977270032259, "episode_return_min": -1489.7061167006734, "episode_return_mean": -762.9230900366878, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.86477621028615, "num_env_steps_trained_throughput_per_sec": 303.86477621028615, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12877.247, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12877.171, "sample_time_ms": 1142.475, "learn_time_ms": 11666.13, "learn_throughput": 342.873, "synch_weights_time_ms": 67.774}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00003", "date": "2024-08-04_05-46-15", "timestamp": 1722730575, "time_this_iter_s": 13.176024675369263, "time_total_s": 128.89184284210205, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0afd90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 128.89184284210205, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 18.150000000000002, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.40136068003873, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.932227645814418, "policy_loss": -0.009562974901443037, "vf_loss": 8.93757410099109, "vf_explained_var": 0.6118575404708584, "kl": 0.014565684605501398, "entropy": 1.5318249098956584, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -22.728428820005316, "episode_reward_min": -1458.5951860476816, "episode_reward_mean": -725.724064381096, "episode_len_mean": 127.65, "episode_media": {}, "episodes_timesteps_total": 12765, "policy_reward_min": {"policy_0": -1458.5951860476816}, "policy_reward_max": {"policy_0": -22.728428820005316}, "policy_reward_mean": {"policy_0": -725.724064381096}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1082.41044150003, -585.2531219367877, -1028.2912999605032, -883.5866339588563, -968.0010034177496, -794.7617608475482, -843.3098437745563, -566.5594907951822, -61.20383662437224, -1104.4523303781646, -80.71292582482938, -603.9241465722788, -1444.4375523169558, -717.4352937229495, -724.9175263299303, -442.12295515708007, -983.9972699023131, -1243.9841781844475, -1401.3513459609687, -448.80288579176715, -253.91863712135125, -1458.5951860476816, -579.0376887659118, -407.3025927492036, -157.41775616543453, -930.3453708279766, -739.0359136651723, -792.3092237205243, -1222.32057017784, -1244.4593511760397, -1260.0376469214837, -1404.8765592162713, -58.29259732605865, -989.2054188022076, -219.62178373860914, -1113.4744711596902, -758.4356055590338, -106.46947723449266, -636.5538884248363, -22.728428820005316, -216.30537533964323, -1231.4786399527218, -114.03424820725014, -188.85523572955137, -1198.9413695064106, -1013.834054219979, -450.93085941117283, -357.5586019486192, -800.5180961574194, -358.9597366960525, -342.10514341636633, -142.6568253460091, -1140.4757395669408, -868.1616567963262, -980.1100264267118, -1301.8834065878982, -727.5155510185572, -1160.3151542237724, -968.2437376117016, -880.8711682062927, -941.4599927053006, -467.7081084639946, -908.1838327124057, -683.845049137928, -591.0108616103806, -908.9654829610341, -753.6225834873612, -370.1162697280738, -1303.7117301916917, -107.98857786894763, -1037.8938357993613, -333.7199748662046, -54.58822142906526, -775.9220617016715, -51.70007777469342, -1301.7451570214844, -880.6332159038305, -506.6245581396405, -241.62237433038405, -418.4787914351772, -1140.3997529816909, -806.7929860164037, -1203.5444776830593, -402.5017500689162, -1399.8276126951973, -1155.571647739417, -618.399411014768, -701.5706183763906, -142.1463474405986, -931.3311393205669, -1024.3364274961382, -1235.5309386365875, -89.20594192526086, -322.8092164490017, -630.6657738248699, -423.61407064162296, -219.2849767412542, -1147.173584651436, -426.5466696984261, -1103.9037004928807], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 117, 46, 150, 54, 118, 150, 150, 150, 135, 150, 150, 150, 100, 83, 150, 143, 112, 63, 150, 150, 150, 150, 150, 150, 150, 57, 150, 71, 150, 150, 67, 150, 39, 72, 150, 66, 70, 150, 150, 150, 109, 134, 86, 112, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 110, 150, 150, 150, 150, 72, 150, 93, 49, 150, 52, 150, 150, 150, 92, 97, 150, 150, 150, 124, 150, 150, 150, 150, 78, 150, 150, 150, 58, 112, 150, 150, 64, 150, 150, 150], "policy_policy_0_reward": [-1082.41044150003, -585.2531219367877, -1028.2912999605032, -883.5866339588563, -968.0010034177496, -794.7617608475482, -843.3098437745563, -566.5594907951822, -61.20383662437224, -1104.4523303781646, -80.71292582482938, -603.9241465722788, -1444.4375523169558, -717.4352937229495, -724.9175263299303, -442.12295515708007, -983.9972699023131, -1243.9841781844475, -1401.3513459609687, -448.80288579176715, -253.91863712135125, -1458.5951860476816, -579.0376887659118, -407.3025927492036, -157.41775616543453, -930.3453708279766, -739.0359136651723, -792.3092237205243, -1222.32057017784, -1244.4593511760397, -1260.0376469214837, -1404.8765592162713, -58.29259732605865, -989.2054188022076, -219.62178373860914, -1113.4744711596902, -758.4356055590338, -106.46947723449266, -636.5538884248363, -22.728428820005316, -216.30537533964323, -1231.4786399527218, -114.03424820725014, -188.85523572955137, -1198.9413695064106, -1013.834054219979, -450.93085941117283, -357.5586019486192, -800.5180961574194, -358.9597366960525, -342.10514341636633, -142.6568253460091, -1140.4757395669408, -868.1616567963262, -980.1100264267118, -1301.8834065878982, -727.5155510185572, -1160.3151542237724, -968.2437376117016, -880.8711682062927, -941.4599927053006, -467.7081084639946, -908.1838327124057, -683.845049137928, -591.0108616103806, -908.9654829610341, -753.6225834873612, -370.1162697280738, -1303.7117301916917, -107.98857786894763, -1037.8938357993613, -333.7199748662046, -54.58822142906526, -775.9220617016715, -51.70007777469342, -1301.7451570214844, -880.6332159038305, -506.6245581396405, -241.62237433038405, -418.4787914351772, -1140.3997529816909, -806.7929860164037, -1203.5444776830593, -402.5017500689162, -1399.8276126951973, -1155.571647739417, -618.399411014768, -701.5706183763906, -142.1463474405986, -931.3311393205669, -1024.3364274961382, -1235.5309386365875, -89.20594192526086, -322.8092164490017, -630.6657738248699, -423.61407064162296, -219.2849767412542, -1147.173584651436, -426.5466696984261, -1103.9037004928807]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5578097018948671, "mean_inference_ms": 1.6737100887953236, "mean_action_processing_ms": 0.27702474225364476, "mean_env_wait_ms": 3.5080453830202396, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012097358703613281, "StateBufferConnector_ms": 0.007946252822875977, "ViewRequirementAgentConnector_ms": 0.19529390335083008}, "num_episodes": 32, "episode_return_max": -22.728428820005316, "episode_return_min": -1458.5951860476816, "episode_return_mean": -725.724064381096, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 363.3567424007126, "num_env_steps_trained_throughput_per_sec": 363.3567424007126, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12688.465, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12688.388, "sample_time_ms": 1133.455, "learn_time_ms": 11485.148, "learn_throughput": 348.276, "synch_weights_time_ms": 68.989}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00003", "date": "2024-08-04_05-46-26", "timestamp": 1722730586, "time_this_iter_s": 11.020488500595093, "time_total_s": 139.91233134269714, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc700700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 139.91233134269714, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 19.1, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.19864426900943, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.861565450330575, "policy_loss": -0.010911521942277128, "vf_loss": 8.867816791435082, "vf_explained_var": 0.4953666696945826, "kl": 0.016057563549452425, "entropy": 1.5709778358538946, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -22.728428820005316, "episode_reward_min": -1447.7194367632349, "episode_reward_mean": -721.1655620588378, "episode_len_mean": 126.9, "episode_media": {}, "episodes_timesteps_total": 12690, "policy_reward_min": {"policy_0": -1447.7194367632349}, "policy_reward_max": {"policy_0": -22.728428820005316}, "policy_reward_mean": {"policy_0": -721.1655620588378}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1404.8765592162713, -58.29259732605865, -989.2054188022076, -219.62178373860914, -1113.4744711596902, -758.4356055590338, -106.46947723449266, -636.5538884248363, -22.728428820005316, -216.30537533964323, -1231.4786399527218, -114.03424820725014, -188.85523572955137, -1198.9413695064106, -1013.834054219979, -450.93085941117283, -357.5586019486192, -800.5180961574194, -358.9597366960525, -342.10514341636633, -142.6568253460091, -1140.4757395669408, -868.1616567963262, -980.1100264267118, -1301.8834065878982, -727.5155510185572, -1160.3151542237724, -968.2437376117016, -880.8711682062927, -941.4599927053006, -467.7081084639946, -908.1838327124057, -683.845049137928, -591.0108616103806, -908.9654829610341, -753.6225834873612, -370.1162697280738, -1303.7117301916917, -107.98857786894763, -1037.8938357993613, -333.7199748662046, -54.58822142906526, -775.9220617016715, -51.70007777469342, -1301.7451570214844, -880.6332159038305, -506.6245581396405, -241.62237433038405, -418.4787914351772, -1140.3997529816909, -806.7929860164037, -1203.5444776830593, -402.5017500689162, -1399.8276126951973, -1155.571647739417, -618.399411014768, -701.5706183763906, -142.1463474405986, -931.3311393205669, -1024.3364274961382, -1235.5309386365875, -89.20594192526086, -322.8092164490017, -630.6657738248699, -423.61407064162296, -219.2849767412542, -1147.173584651436, -426.5466696984261, -1103.9037004928807, -877.5816431973053, -1104.3834795954697, -616.2292052262785, -585.0943039310862, -988.5619059123802, -541.6230259806011, -403.36571322564714, -1279.0264899457766, -416.84161853186555, -1094.8318267545853, -878.9064252657341, -1189.0746284347733, -303.6302208945884, -1232.79734944006, -662.5148252633909, -194.27551705593166, -553.293157486977, -1265.9327475221269, -420.29972615337067, -243.99120607101602, -587.5316815926271, -1447.7194367632349, -954.3021642758102, -105.53480720633263, -803.4186271340611, -45.96411019730687, -1135.7162773162179, -1268.6682491960482, -1251.4502835867338, -945.9253302130983, -1199.9595646996127], "episode_lengths": [150, 57, 150, 71, 150, 150, 67, 150, 39, 72, 150, 66, 70, 150, 150, 150, 109, 134, 86, 112, 58, 150, 150, 150, 150, 150, 150, 150, 150, 150, 102, 150, 150, 110, 150, 150, 150, 150, 72, 150, 93, 49, 150, 52, 150, 150, 150, 92, 97, 150, 150, 150, 124, 150, 150, 150, 150, 78, 150, 150, 150, 58, 112, 150, 150, 64, 150, 150, 150, 150, 150, 124, 110, 150, 109, 96, 150, 95, 150, 150, 150, 99, 150, 150, 67, 150, 150, 150, 89, 150, 150, 150, 62, 150, 45, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1404.8765592162713, -58.29259732605865, -989.2054188022076, -219.62178373860914, -1113.4744711596902, -758.4356055590338, -106.46947723449266, -636.5538884248363, -22.728428820005316, -216.30537533964323, -1231.4786399527218, -114.03424820725014, -188.85523572955137, -1198.9413695064106, -1013.834054219979, -450.93085941117283, -357.5586019486192, -800.5180961574194, -358.9597366960525, -342.10514341636633, -142.6568253460091, -1140.4757395669408, -868.1616567963262, -980.1100264267118, -1301.8834065878982, -727.5155510185572, -1160.3151542237724, -968.2437376117016, -880.8711682062927, -941.4599927053006, -467.7081084639946, -908.1838327124057, -683.845049137928, -591.0108616103806, -908.9654829610341, -753.6225834873612, -370.1162697280738, -1303.7117301916917, -107.98857786894763, -1037.8938357993613, -333.7199748662046, -54.58822142906526, -775.9220617016715, -51.70007777469342, -1301.7451570214844, -880.6332159038305, -506.6245581396405, -241.62237433038405, -418.4787914351772, -1140.3997529816909, -806.7929860164037, -1203.5444776830593, -402.5017500689162, -1399.8276126951973, -1155.571647739417, -618.399411014768, -701.5706183763906, -142.1463474405986, -931.3311393205669, -1024.3364274961382, -1235.5309386365875, -89.20594192526086, -322.8092164490017, -630.6657738248699, -423.61407064162296, -219.2849767412542, -1147.173584651436, -426.5466696984261, -1103.9037004928807, -877.5816431973053, -1104.3834795954697, -616.2292052262785, -585.0943039310862, -988.5619059123802, -541.6230259806011, -403.36571322564714, -1279.0264899457766, -416.84161853186555, -1094.8318267545853, -878.9064252657341, -1189.0746284347733, -303.6302208945884, -1232.79734944006, -662.5148252633909, -194.27551705593166, -553.293157486977, -1265.9327475221269, -420.29972615337067, -243.99120607101602, -587.5316815926271, -1447.7194367632349, -954.3021642758102, -105.53480720633263, -803.4186271340611, -45.96411019730687, -1135.7162773162179, -1268.6682491960482, -1251.4502835867338, -945.9253302130983, -1199.9595646996127]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5574461626738616, "mean_inference_ms": 1.6745361126236131, "mean_action_processing_ms": 0.2770369314598926, "mean_env_wait_ms": 3.514717198786302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011839866638183594, "StateBufferConnector_ms": 0.007906198501586914, "ViewRequirementAgentConnector_ms": 0.19166159629821777}, "num_episodes": 31, "episode_return_max": -22.728428820005316, "episode_return_min": -1447.7194367632349, "episode_return_mean": -721.1655620588378, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.59903953771084, "num_env_steps_trained_throughput_per_sec": 307.59903953771084, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12666.324, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12666.249, "sample_time_ms": 1134.467, "learn_time_ms": 11463.22, "learn_throughput": 348.942, "synch_weights_time_ms": 67.736}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00003", "date": "2024-08-04_05-46-39", "timestamp": 1722730599, "time_this_iter_s": 13.016041994094849, "time_total_s": 152.928373336792, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc700ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 152.928373336792, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 17.763157894736842, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 19.304072382549446, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.39592235982418, "policy_loss": -0.007442101449123583, "vf_loss": 8.398853101332982, "vf_explained_var": 0.5029042651876807, "kl": 0.015517665251051478, "entropy": 1.4395210129519305, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -29.686213803093068, "episode_reward_min": -1447.7194367632349, "episode_reward_mean": -752.733601961877, "episode_len_mean": 131.8, "episode_media": {}, "episodes_timesteps_total": 13180, "policy_reward_min": {"policy_0": -1447.7194367632349}, "policy_reward_max": {"policy_0": -29.686213803093068}, "policy_reward_mean": {"policy_0": -752.733601961877}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-880.8711682062927, -941.4599927053006, -467.7081084639946, -908.1838327124057, -683.845049137928, -591.0108616103806, -908.9654829610341, -753.6225834873612, -370.1162697280738, -1303.7117301916917, -107.98857786894763, -1037.8938357993613, -333.7199748662046, -54.58822142906526, -775.9220617016715, -51.70007777469342, -1301.7451570214844, -880.6332159038305, -506.6245581396405, -241.62237433038405, -418.4787914351772, -1140.3997529816909, -806.7929860164037, -1203.5444776830593, -402.5017500689162, -1399.8276126951973, -1155.571647739417, -618.399411014768, -701.5706183763906, -142.1463474405986, -931.3311393205669, -1024.3364274961382, -1235.5309386365875, -89.20594192526086, -322.8092164490017, -630.6657738248699, -423.61407064162296, -219.2849767412542, -1147.173584651436, -426.5466696984261, -1103.9037004928807, -877.5816431973053, -1104.3834795954697, -616.2292052262785, -585.0943039310862, -988.5619059123802, -541.6230259806011, -403.36571322564714, -1279.0264899457766, -416.84161853186555, -1094.8318267545853, -878.9064252657341, -1189.0746284347733, -303.6302208945884, -1232.79734944006, -662.5148252633909, -194.27551705593166, -553.293157486977, -1265.9327475221269, -420.29972615337067, -243.99120607101602, -587.5316815926271, -1447.7194367632349, -954.3021642758102, -105.53480720633263, -803.4186271340611, -45.96411019730687, -1135.7162773162179, -1268.6682491960482, -1251.4502835867338, -945.9253302130983, -1199.9595646996127, -1209.1292508426036, -582.5249720916594, -555.0048710731512, -877.201463136314, -1121.3782681533958, -642.6479744185513, -244.94244293697946, -854.2042585365822, -864.5888072116874, -868.671700719629, -29.686213803093068, -1332.685552623423, -1389.7326056563268, -590.2992926441792, -1050.3158358135356, -1142.690107671199, -450.50513158785947, -479.83632490329, -1240.6994254576678, -873.310336302461, -1237.626011289473, -751.308828989769, -376.9990829871267, -856.8090442034166, -684.5211676242404, -903.3286817982327, -190.82374810699065, -627.8742781654022], "episode_lengths": [150, 150, 102, 150, 150, 110, 150, 150, 150, 150, 72, 150, 93, 49, 150, 52, 150, 150, 150, 92, 97, 150, 150, 150, 124, 150, 150, 150, 150, 78, 150, 150, 150, 58, 112, 150, 150, 64, 150, 150, 150, 150, 150, 124, 110, 150, 109, 96, 150, 95, 150, 150, 150, 99, 150, 150, 67, 150, 150, 150, 89, 150, 150, 150, 62, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 49, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 98, 150, 150, 150, 74, 132], "policy_policy_0_reward": [-880.8711682062927, -941.4599927053006, -467.7081084639946, -908.1838327124057, -683.845049137928, -591.0108616103806, -908.9654829610341, -753.6225834873612, -370.1162697280738, -1303.7117301916917, -107.98857786894763, -1037.8938357993613, -333.7199748662046, -54.58822142906526, -775.9220617016715, -51.70007777469342, -1301.7451570214844, -880.6332159038305, -506.6245581396405, -241.62237433038405, -418.4787914351772, -1140.3997529816909, -806.7929860164037, -1203.5444776830593, -402.5017500689162, -1399.8276126951973, -1155.571647739417, -618.399411014768, -701.5706183763906, -142.1463474405986, -931.3311393205669, -1024.3364274961382, -1235.5309386365875, -89.20594192526086, -322.8092164490017, -630.6657738248699, -423.61407064162296, -219.2849767412542, -1147.173584651436, -426.5466696984261, -1103.9037004928807, -877.5816431973053, -1104.3834795954697, -616.2292052262785, -585.0943039310862, -988.5619059123802, -541.6230259806011, -403.36571322564714, -1279.0264899457766, -416.84161853186555, -1094.8318267545853, -878.9064252657341, -1189.0746284347733, -303.6302208945884, -1232.79734944006, -662.5148252633909, -194.27551705593166, -553.293157486977, -1265.9327475221269, -420.29972615337067, -243.99120607101602, -587.5316815926271, -1447.7194367632349, -954.3021642758102, -105.53480720633263, -803.4186271340611, -45.96411019730687, -1135.7162773162179, -1268.6682491960482, -1251.4502835867338, -945.9253302130983, -1199.9595646996127, -1209.1292508426036, -582.5249720916594, -555.0048710731512, -877.201463136314, -1121.3782681533958, -642.6479744185513, -244.94244293697946, -854.2042585365822, -864.5888072116874, -868.671700719629, -29.686213803093068, -1332.685552623423, -1389.7326056563268, -590.2992926441792, -1050.3158358135356, -1142.690107671199, -450.50513158785947, -479.83632490329, -1240.6994254576678, -873.310336302461, -1237.626011289473, -751.308828989769, -376.9990829871267, -856.8090442034166, -684.5211676242404, -903.3286817982327, -190.82374810699065, -627.8742781654022]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5574642865515581, "mean_inference_ms": 1.6735845836932493, "mean_action_processing_ms": 0.27684391099662775, "mean_env_wait_ms": 3.513266385117597, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01153111457824707, "StateBufferConnector_ms": 0.007806062698364258, "ViewRequirementAgentConnector_ms": 0.18983769416809082}, "num_episodes": 28, "episode_return_max": -29.686213803093068, "episode_return_min": -1447.7194367632349, "episode_return_mean": -752.733601961877, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.3608767049726, "num_env_steps_trained_throughput_per_sec": 307.3608767049726, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12671.138, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12671.062, "sample_time_ms": 1134.125, "learn_time_ms": 11468.567, "learn_throughput": 348.779, "synch_weights_time_ms": 67.543}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00003", "date": "2024-08-04_05-46-52", "timestamp": 1722730612, "time_this_iter_s": 13.027889013290405, "time_total_s": 165.9562623500824, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0adfc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 165.9562623500824, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 18.06666666666667, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.830691549678644, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.34077478001515, "policy_loss": -0.011095292667353837, "vf_loss": 8.346868488192559, "vf_explained_var": 0.7443322954699397, "kl": 0.017156559762255105, "entropy": 1.4538485222806534, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -29.686213803093068, "episode_reward_min": -1485.368153009742, "episode_reward_mean": -757.8551403610992, "episode_len_mean": 132.28, "episode_media": {}, "episodes_timesteps_total": 13228, "policy_reward_min": {"policy_0": -1485.368153009742}, "policy_reward_max": {"policy_0": -29.686213803093068}, "policy_reward_mean": {"policy_0": -757.8551403610992}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1235.5309386365875, -89.20594192526086, -322.8092164490017, -630.6657738248699, -423.61407064162296, -219.2849767412542, -1147.173584651436, -426.5466696984261, -1103.9037004928807, -877.5816431973053, -1104.3834795954697, -616.2292052262785, -585.0943039310862, -988.5619059123802, -541.6230259806011, -403.36571322564714, -1279.0264899457766, -416.84161853186555, -1094.8318267545853, -878.9064252657341, -1189.0746284347733, -303.6302208945884, -1232.79734944006, -662.5148252633909, -194.27551705593166, -553.293157486977, -1265.9327475221269, -420.29972615337067, -243.99120607101602, -587.5316815926271, -1447.7194367632349, -954.3021642758102, -105.53480720633263, -803.4186271340611, -45.96411019730687, -1135.7162773162179, -1268.6682491960482, -1251.4502835867338, -945.9253302130983, -1199.9595646996127, -1209.1292508426036, -582.5249720916594, -555.0048710731512, -877.201463136314, -1121.3782681533958, -642.6479744185513, -244.94244293697946, -854.2042585365822, -864.5888072116874, -868.671700719629, -29.686213803093068, -1332.685552623423, -1389.7326056563268, -590.2992926441792, -1050.3158358135356, -1142.690107671199, -450.50513158785947, -479.83632490329, -1240.6994254576678, -873.310336302461, -1237.626011289473, -751.308828989769, -376.9990829871267, -856.8090442034166, -684.5211676242404, -903.3286817982327, -190.82374810699065, -627.8742781654022, -1323.4122594816097, -617.7522281788584, -1087.7749479089257, -123.77750218721498, -1269.332500151387, -977.3353200634161, -760.2087999932965, -994.3736513266404, -192.6132795646932, -967.4951356477278, -616.9683826450811, -474.79501033782816, -178.87627273353192, -881.2589821281947, -1094.4159456389298, -940.0156925305243, -923.8332949255326, -692.1913977772657, -858.4407170310396, -1025.226449067552, -1485.368153009742, -1087.9282449120385, -246.66458202067292, -877.8274289548491, -124.72871924759328, -1146.8904647873455, -314.3842361960278, -697.3543566611058, -371.1797671894036, -333.98739514768204, -168.61264444202004, -703.964174342581], "episode_lengths": [150, 58, 112, 150, 150, 64, 150, 150, 150, 150, 150, 124, 110, 150, 109, 96, 150, 95, 150, 150, 150, 99, 150, 150, 67, 150, 150, 150, 89, 150, 150, 150, 62, 150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 49, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 98, 150, 150, 150, 74, 132, 150, 150, 150, 58, 150, 150, 150, 150, 67, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 60, 150, 97, 150, 110, 128, 79, 150], "policy_policy_0_reward": [-1235.5309386365875, -89.20594192526086, -322.8092164490017, -630.6657738248699, -423.61407064162296, -219.2849767412542, -1147.173584651436, -426.5466696984261, -1103.9037004928807, -877.5816431973053, -1104.3834795954697, -616.2292052262785, -585.0943039310862, -988.5619059123802, -541.6230259806011, -403.36571322564714, -1279.0264899457766, -416.84161853186555, -1094.8318267545853, -878.9064252657341, -1189.0746284347733, -303.6302208945884, -1232.79734944006, -662.5148252633909, -194.27551705593166, -553.293157486977, -1265.9327475221269, -420.29972615337067, -243.99120607101602, -587.5316815926271, -1447.7194367632349, -954.3021642758102, -105.53480720633263, -803.4186271340611, -45.96411019730687, -1135.7162773162179, -1268.6682491960482, -1251.4502835867338, -945.9253302130983, -1199.9595646996127, -1209.1292508426036, -582.5249720916594, -555.0048710731512, -877.201463136314, -1121.3782681533958, -642.6479744185513, -244.94244293697946, -854.2042585365822, -864.5888072116874, -868.671700719629, -29.686213803093068, -1332.685552623423, -1389.7326056563268, -590.2992926441792, -1050.3158358135356, -1142.690107671199, -450.50513158785947, -479.83632490329, -1240.6994254576678, -873.310336302461, -1237.626011289473, -751.308828989769, -376.9990829871267, -856.8090442034166, -684.5211676242404, -903.3286817982327, -190.82374810699065, -627.8742781654022, -1323.4122594816097, -617.7522281788584, -1087.7749479089257, -123.77750218721498, -1269.332500151387, -977.3353200634161, -760.2087999932965, -994.3736513266404, -192.6132795646932, -967.4951356477278, -616.9683826450811, -474.79501033782816, -178.87627273353192, -881.2589821281947, -1094.4159456389298, -940.0156925305243, -923.8332949255326, -692.1913977772657, -858.4407170310396, -1025.226449067552, -1485.368153009742, -1087.9282449120385, -246.66458202067292, -877.8274289548491, -124.72871924759328, -1146.8904647873455, -314.3842361960278, -697.3543566611058, -371.1797671894036, -333.98739514768204, -168.61264444202004, -703.964174342581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556499711493553, "mean_inference_ms": 1.6724955791962544, "mean_action_processing_ms": 0.2765198686487614, "mean_env_wait_ms": 3.5147127274338823, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011777162551879883, "StateBufferConnector_ms": 0.007890939712524414, "ViewRequirementAgentConnector_ms": 0.1931145191192627}, "num_episodes": 32, "episode_return_max": -29.686213803093068, "episode_return_min": -1485.368153009742, "episode_return_mean": -757.8551403610992, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.15741478364885, "num_env_steps_trained_throughput_per_sec": 306.15741478364885, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12659.297, "restore_workers_time_ms": 0.033, "training_step_time_ms": 12659.221, "sample_time_ms": 1124.831, "learn_time_ms": 11464.082, "learn_throughput": 348.916, "synch_weights_time_ms": 69.478}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00003", "date": "2024-08-04_05-47-05", "timestamp": 1722730625, "time_this_iter_s": 13.07828950881958, "time_total_s": 179.03455185890198, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0ae3b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 179.03455185890198, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.547368421052635, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.978642358382544, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.46499840815862, "policy_loss": -0.01332690608833218, "vf_loss": 7.472551464041074, "vf_explained_var": 0.7496740631759167, "kl": 0.01968973523841367, "entropy": 1.3305165221293767, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -29.686213803093068, "episode_reward_min": -1485.368153009742, "episode_reward_mean": -746.890381884854, "episode_len_mean": 132.52, "episode_media": {}, "episodes_timesteps_total": 13252, "policy_reward_min": {"policy_0": -1485.368153009742}, "policy_reward_max": {"policy_0": -29.686213803093068}, "policy_reward_mean": {"policy_0": -746.890381884854}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-803.4186271340611, -45.96411019730687, -1135.7162773162179, -1268.6682491960482, -1251.4502835867338, -945.9253302130983, -1199.9595646996127, -1209.1292508426036, -582.5249720916594, -555.0048710731512, -877.201463136314, -1121.3782681533958, -642.6479744185513, -244.94244293697946, -854.2042585365822, -864.5888072116874, -868.671700719629, -29.686213803093068, -1332.685552623423, -1389.7326056563268, -590.2992926441792, -1050.3158358135356, -1142.690107671199, -450.50513158785947, -479.83632490329, -1240.6994254576678, -873.310336302461, -1237.626011289473, -751.308828989769, -376.9990829871267, -856.8090442034166, -684.5211676242404, -903.3286817982327, -190.82374810699065, -627.8742781654022, -1323.4122594816097, -617.7522281788584, -1087.7749479089257, -123.77750218721498, -1269.332500151387, -977.3353200634161, -760.2087999932965, -994.3736513266404, -192.6132795646932, -967.4951356477278, -616.9683826450811, -474.79501033782816, -178.87627273353192, -881.2589821281947, -1094.4159456389298, -940.0156925305243, -923.8332949255326, -692.1913977772657, -858.4407170310396, -1025.226449067552, -1485.368153009742, -1087.9282449120385, -246.66458202067292, -877.8274289548491, -124.72871924759328, -1146.8904647873455, -314.3842361960278, -697.3543566611058, -371.1797671894036, -333.98739514768204, -168.61264444202004, -703.964174342581, -769.0221644822554, -442.91670368635386, -374.35658563606404, -785.682620454784, -357.99716938001836, -1205.7639086440051, -812.922226567838, -981.0205914004904, -312.60831230268394, -1298.4513012156285, -1001.1126495344739, -938.4109197152911, -45.58429980885588, -908.7572745046484, -300.6541995756732, -268.8608418728401, -1229.1737052113056, -651.1379820011542, -128.47934295212983, -923.159037376309, -708.1338624529525, -437.6754269194294, -90.38405448729189, -973.1363483747709, -502.1806791216999, -670.0318279752055, -71.23597941578723, -1185.1431499333391, -970.0794484578676, -618.3920547772065, -540.4521459104024, -1137.1810886478506, -809.5042283671651], "episode_lengths": [150, 45, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 70, 150, 150, 150, 49, 150, 150, 150, 150, 150, 108, 150, 150, 150, 150, 150, 98, 150, 150, 150, 74, 132, 150, 150, 150, 58, 150, 150, 150, 150, 67, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 60, 150, 97, 150, 110, 128, 79, 150, 150, 101, 97, 150, 132, 150, 150, 150, 115, 150, 150, 150, 52, 150, 103, 79, 150, 122, 74, 150, 150, 150, 63, 150, 150, 150, 64, 150, 150, 130, 127, 150, 150], "policy_policy_0_reward": [-803.4186271340611, -45.96411019730687, -1135.7162773162179, -1268.6682491960482, -1251.4502835867338, -945.9253302130983, -1199.9595646996127, -1209.1292508426036, -582.5249720916594, -555.0048710731512, -877.201463136314, -1121.3782681533958, -642.6479744185513, -244.94244293697946, -854.2042585365822, -864.5888072116874, -868.671700719629, -29.686213803093068, -1332.685552623423, -1389.7326056563268, -590.2992926441792, -1050.3158358135356, -1142.690107671199, -450.50513158785947, -479.83632490329, -1240.6994254576678, -873.310336302461, -1237.626011289473, -751.308828989769, -376.9990829871267, -856.8090442034166, -684.5211676242404, -903.3286817982327, -190.82374810699065, -627.8742781654022, -1323.4122594816097, -617.7522281788584, -1087.7749479089257, -123.77750218721498, -1269.332500151387, -977.3353200634161, -760.2087999932965, -994.3736513266404, -192.6132795646932, -967.4951356477278, -616.9683826450811, -474.79501033782816, -178.87627273353192, -881.2589821281947, -1094.4159456389298, -940.0156925305243, -923.8332949255326, -692.1913977772657, -858.4407170310396, -1025.226449067552, -1485.368153009742, -1087.9282449120385, -246.66458202067292, -877.8274289548491, -124.72871924759328, -1146.8904647873455, -314.3842361960278, -697.3543566611058, -371.1797671894036, -333.98739514768204, -168.61264444202004, -703.964174342581, -769.0221644822554, -442.91670368635386, -374.35658563606404, -785.682620454784, -357.99716938001836, -1205.7639086440051, -812.922226567838, -981.0205914004904, -312.60831230268394, -1298.4513012156285, -1001.1126495344739, -938.4109197152911, -45.58429980885588, -908.7572745046484, -300.6541995756732, -268.8608418728401, -1229.1737052113056, -651.1379820011542, -128.47934295212983, -923.159037376309, -708.1338624529525, -437.6754269194294, -90.38405448729189, -973.1363483747709, -502.1806791216999, -670.0318279752055, -71.23597941578723, -1185.1431499333391, -970.0794484578676, -618.3920547772065, -540.4521459104024, -1137.1810886478506, -809.5042283671651]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558455597298871, "mean_inference_ms": 1.6699695845002904, "mean_action_processing_ms": 0.27597905413933443, "mean_env_wait_ms": 3.509581710437999, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011880636215209961, "StateBufferConnector_ms": 0.007884979248046875, "ViewRequirementAgentConnector_ms": 0.19375395774841309}, "num_episodes": 33, "episode_return_max": -29.686213803093068, "episode_return_min": -1485.368153009742, "episode_return_mean": -746.890381884854, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.0616766952385, "num_env_steps_trained_throughput_per_sec": 304.0616766952385, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12684.111, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12684.036, "sample_time_ms": 1128.059, "learn_time_ms": 11483.97, "learn_throughput": 348.312, "synch_weights_time_ms": 71.174}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00003", "date": "2024-08-04_05-47-18", "timestamp": 1722730638, "time_this_iter_s": 13.168522119522095, "time_total_s": 192.20307397842407, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0ae320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 192.20307397842407, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.494736842105265, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 27.189168128867944, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 7.711618779599666, "policy_loss": -0.013767454391927458, "vf_loss": 7.71904372771581, "vf_explained_var": 0.7632104150950909, "kl": 0.02155657085543986, "entropy": 1.2443596883366506, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -20.902385983268974, "episode_reward_min": -1485.368153009742, "episode_reward_mean": -688.2970286244605, "episode_len_mean": 129.29, "episode_media": {}, "episodes_timesteps_total": 12929, "policy_reward_min": {"policy_0": -1485.368153009742}, "policy_reward_max": {"policy_0": -20.902385983268974}, "policy_reward_mean": {"policy_0": -688.2970286244605}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-856.8090442034166, -684.5211676242404, -903.3286817982327, -190.82374810699065, -627.8742781654022, -1323.4122594816097, -617.7522281788584, -1087.7749479089257, -123.77750218721498, -1269.332500151387, -977.3353200634161, -760.2087999932965, -994.3736513266404, -192.6132795646932, -967.4951356477278, -616.9683826450811, -474.79501033782816, -178.87627273353192, -881.2589821281947, -1094.4159456389298, -940.0156925305243, -923.8332949255326, -692.1913977772657, -858.4407170310396, -1025.226449067552, -1485.368153009742, -1087.9282449120385, -246.66458202067292, -877.8274289548491, -124.72871924759328, -1146.8904647873455, -314.3842361960278, -697.3543566611058, -371.1797671894036, -333.98739514768204, -168.61264444202004, -703.964174342581, -769.0221644822554, -442.91670368635386, -374.35658563606404, -785.682620454784, -357.99716938001836, -1205.7639086440051, -812.922226567838, -981.0205914004904, -312.60831230268394, -1298.4513012156285, -1001.1126495344739, -938.4109197152911, -45.58429980885588, -908.7572745046484, -300.6541995756732, -268.8608418728401, -1229.1737052113056, -651.1379820011542, -128.47934295212983, -923.159037376309, -708.1338624529525, -437.6754269194294, -90.38405448729189, -973.1363483747709, -502.1806791216999, -670.0318279752055, -71.23597941578723, -1185.1431499333391, -970.0794484578676, -618.3920547772065, -540.4521459104024, -1137.1810886478506, -809.5042283671651, -250.84841018894429, -412.91602255495, -458.8641270549431, -149.11410352975943, -989.4994528866508, -664.8273274126892, -604.4878022874897, -767.0678809351082, -1188.3062113572355, -1052.0383023890888, -713.6544850729779, -75.91629656699763, -1119.7499773505997, -1300.913771394855, -1071.9284371117685, -20.902385983268974, -827.6698835385404, -441.04145542571865, -827.5847733081794, -799.3231340694194, -30.73728958958871, -306.234877877249, -529.9761154557569, -1109.517283890453, -701.7484467297537, -1096.296285146443, -566.0216341085279, -63.059219662922835, -626.3040106598687, -791.2064716139286], "episode_lengths": [150, 150, 150, 74, 132, 150, 150, 150, 58, 150, 150, 150, 150, 67, 150, 150, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 150, 90, 150, 60, 150, 97, 150, 110, 128, 79, 150, 150, 101, 97, 150, 132, 150, 150, 150, 115, 150, 150, 150, 52, 150, 103, 79, 150, 122, 74, 150, 150, 150, 63, 150, 150, 150, 64, 150, 150, 130, 127, 150, 150, 79, 113, 113, 77, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 44, 147, 117, 150, 143, 41, 103, 150, 150, 150, 150, 150, 58, 146, 150], "policy_policy_0_reward": [-856.8090442034166, -684.5211676242404, -903.3286817982327, -190.82374810699065, -627.8742781654022, -1323.4122594816097, -617.7522281788584, -1087.7749479089257, -123.77750218721498, -1269.332500151387, -977.3353200634161, -760.2087999932965, -994.3736513266404, -192.6132795646932, -967.4951356477278, -616.9683826450811, -474.79501033782816, -178.87627273353192, -881.2589821281947, -1094.4159456389298, -940.0156925305243, -923.8332949255326, -692.1913977772657, -858.4407170310396, -1025.226449067552, -1485.368153009742, -1087.9282449120385, -246.66458202067292, -877.8274289548491, -124.72871924759328, -1146.8904647873455, -314.3842361960278, -697.3543566611058, -371.1797671894036, -333.98739514768204, -168.61264444202004, -703.964174342581, -769.0221644822554, -442.91670368635386, -374.35658563606404, -785.682620454784, -357.99716938001836, -1205.7639086440051, -812.922226567838, -981.0205914004904, -312.60831230268394, -1298.4513012156285, -1001.1126495344739, -938.4109197152911, -45.58429980885588, -908.7572745046484, -300.6541995756732, -268.8608418728401, -1229.1737052113056, -651.1379820011542, -128.47934295212983, -923.159037376309, -708.1338624529525, -437.6754269194294, -90.38405448729189, -973.1363483747709, -502.1806791216999, -670.0318279752055, -71.23597941578723, -1185.1431499333391, -970.0794484578676, -618.3920547772065, -540.4521459104024, -1137.1810886478506, -809.5042283671651, -250.84841018894429, -412.91602255495, -458.8641270549431, -149.11410352975943, -989.4994528866508, -664.8273274126892, -604.4878022874897, -767.0678809351082, -1188.3062113572355, -1052.0383023890888, -713.6544850729779, -75.91629656699763, -1119.7499773505997, -1300.913771394855, -1071.9284371117685, -20.902385983268974, -827.6698835385404, -441.04145542571865, -827.5847733081794, -799.3231340694194, -30.73728958958871, -306.234877877249, -529.9761154557569, -1109.517283890453, -701.7484467297537, -1096.296285146443, -566.0216341085279, -63.059219662922835, -626.3040106598687, -791.2064716139286]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.555191371699363, "mean_inference_ms": 1.6690587489860205, "mean_action_processing_ms": 0.2757997314080517, "mean_env_wait_ms": 3.5102551114284255, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012036323547363281, "StateBufferConnector_ms": 0.007842540740966797, "ViewRequirementAgentConnector_ms": 0.19341278076171875}, "num_episodes": 30, "episode_return_max": -20.902385983268974, "episode_return_min": -1485.368153009742, "episode_return_mean": -688.2970286244605, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.05237072733337, "num_env_steps_trained_throughput_per_sec": 299.05237072733337, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12707.679, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12707.607, "sample_time_ms": 1147.058, "learn_time_ms": 11487.662, "learn_throughput": 348.2, "synch_weights_time_ms": 72.035}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00003", "date": "2024-08-04_05-47-32", "timestamp": 1722730652, "time_this_iter_s": 13.387614727020264, "time_total_s": 205.59068870544434, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5f6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 205.59068870544434, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.57894736842105, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 32.71371554583311, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.256072128812472, "policy_loss": -0.01155853802532268, "vf_loss": 7.259953074653944, "vf_explained_var": 0.8427710786461831, "kl": 0.017323161930471544, "entropy": 1.1782017330328622, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -20.902385983268974, "episode_reward_min": -1300.913771394855, "episode_reward_mean": -654.3664582444137, "episode_len_mean": 128.28, "episode_media": {}, "episodes_timesteps_total": 12828, "policy_reward_min": {"policy_0": -1300.913771394855}, "policy_reward_max": {"policy_0": -20.902385983268974}, "policy_reward_mean": {"policy_0": -654.3664582444137}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-371.1797671894036, -333.98739514768204, -168.61264444202004, -703.964174342581, -769.0221644822554, -442.91670368635386, -374.35658563606404, -785.682620454784, -357.99716938001836, -1205.7639086440051, -812.922226567838, -981.0205914004904, -312.60831230268394, -1298.4513012156285, -1001.1126495344739, -938.4109197152911, -45.58429980885588, -908.7572745046484, -300.6541995756732, -268.8608418728401, -1229.1737052113056, -651.1379820011542, -128.47934295212983, -923.159037376309, -708.1338624529525, -437.6754269194294, -90.38405448729189, -973.1363483747709, -502.1806791216999, -670.0318279752055, -71.23597941578723, -1185.1431499333391, -970.0794484578676, -618.3920547772065, -540.4521459104024, -1137.1810886478506, -809.5042283671651, -250.84841018894429, -412.91602255495, -458.8641270549431, -149.11410352975943, -989.4994528866508, -664.8273274126892, -604.4878022874897, -767.0678809351082, -1188.3062113572355, -1052.0383023890888, -713.6544850729779, -75.91629656699763, -1119.7499773505997, -1300.913771394855, -1071.9284371117685, -20.902385983268974, -827.6698835385404, -441.04145542571865, -827.5847733081794, -799.3231340694194, -30.73728958958871, -306.234877877249, -529.9761154557569, -1109.517283890453, -701.7484467297537, -1096.296285146443, -566.0216341085279, -63.059219662922835, -626.3040106598687, -791.2064716139286, -1084.593714182458, -751.979064827465, -723.8867789707815, -1094.5038761205233, -125.98638347944818, -82.14983792009248, -913.6294223730882, -899.6048912052727, -219.16174374743278, -692.4391413862603, -696.1629191592976, -666.5063570023646, -745.5196217850323, -1152.744954130193, -130.93645908873475, -826.9270783751956, -838.9205184687847, -989.0814769645269, -1267.9188921416485, -490.3181869254451, -506.8283503328946, -57.02537348331059, -538.8232275781897, -1024.203067358149, -984.7328045439547, -60.92816989232423, -914.8093603970892, -691.2516578380063, -599.5243274639454, -557.6065452246487, -906.2797824416032, -589.7659999612001, -26.793852232860626], "episode_lengths": [110, 128, 79, 150, 150, 101, 97, 150, 132, 150, 150, 150, 115, 150, 150, 150, 52, 150, 103, 79, 150, 122, 74, 150, 150, 150, 63, 150, 150, 150, 64, 150, 150, 130, 127, 150, 150, 79, 113, 113, 77, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 44, 147, 117, 150, 143, 41, 103, 150, 150, 150, 150, 150, 58, 146, 150, 150, 150, 150, 150, 47, 70, 150, 150, 93, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 110, 150, 48, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 53], "policy_policy_0_reward": [-371.1797671894036, -333.98739514768204, -168.61264444202004, -703.964174342581, -769.0221644822554, -442.91670368635386, -374.35658563606404, -785.682620454784, -357.99716938001836, -1205.7639086440051, -812.922226567838, -981.0205914004904, -312.60831230268394, -1298.4513012156285, -1001.1126495344739, -938.4109197152911, -45.58429980885588, -908.7572745046484, -300.6541995756732, -268.8608418728401, -1229.1737052113056, -651.1379820011542, -128.47934295212983, -923.159037376309, -708.1338624529525, -437.6754269194294, -90.38405448729189, -973.1363483747709, -502.1806791216999, -670.0318279752055, -71.23597941578723, -1185.1431499333391, -970.0794484578676, -618.3920547772065, -540.4521459104024, -1137.1810886478506, -809.5042283671651, -250.84841018894429, -412.91602255495, -458.8641270549431, -149.11410352975943, -989.4994528866508, -664.8273274126892, -604.4878022874897, -767.0678809351082, -1188.3062113572355, -1052.0383023890888, -713.6544850729779, -75.91629656699763, -1119.7499773505997, -1300.913771394855, -1071.9284371117685, -20.902385983268974, -827.6698835385404, -441.04145542571865, -827.5847733081794, -799.3231340694194, -30.73728958958871, -306.234877877249, -529.9761154557569, -1109.517283890453, -701.7484467297537, -1096.296285146443, -566.0216341085279, -63.059219662922835, -626.3040106598687, -791.2064716139286, -1084.593714182458, -751.979064827465, -723.8867789707815, -1094.5038761205233, -125.98638347944818, -82.14983792009248, -913.6294223730882, -899.6048912052727, -219.16174374743278, -692.4391413862603, -696.1629191592976, -666.5063570023646, -745.5196217850323, -1152.744954130193, -130.93645908873475, -826.9270783751956, -838.9205184687847, -989.0814769645269, -1267.9188921416485, -490.3181869254451, -506.8283503328946, -57.02537348331059, -538.8232275781897, -1024.203067358149, -984.7328045439547, -60.92816989232423, -914.8093603970892, -691.2516578380063, -599.5243274639454, -557.6065452246487, -906.2797824416032, -589.7659999612001, -26.793852232860626]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548923941391559, "mean_inference_ms": 1.6685380230568523, "mean_action_processing_ms": 0.2758282899192357, "mean_env_wait_ms": 3.5073293476848035, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01176762580871582, "StateBufferConnector_ms": 0.007742166519165039, "ViewRequirementAgentConnector_ms": 0.18978190422058105}, "num_episodes": 33, "episode_return_max": -20.902385983268974, "episode_return_min": -1300.913771394855, "episode_return_mean": -654.3664582444137, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.305214492043, "num_env_steps_trained_throughput_per_sec": 306.305214492043, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12718.57, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12718.495, "sample_time_ms": 1146.794, "learn_time_ms": 11500.229, "learn_throughput": 347.819, "synch_weights_time_ms": 70.639}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00003", "date": "2024-08-04_05-47-45", "timestamp": 1722730665, "time_this_iter_s": 13.071813344955444, "time_total_s": 218.66250205039978, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc7016c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 218.66250205039978, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.755555555555553, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 39.05400902926922, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.323334069550038, "policy_loss": -0.014041277282134008, "vf_loss": 7.3300567617019015, "vf_explained_var": 0.8272812930246194, "kl": 0.01656732014422841, "entropy": 1.3670778278882305, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -20.902385983268974, "episode_reward_min": -1310.3320696576934, "episode_reward_mean": -663.0949347139167, "episode_len_mean": 126.74, "episode_media": {}, "episodes_timesteps_total": 12674, "policy_reward_min": {"policy_0": -1310.3320696576934}, "policy_reward_max": {"policy_0": -20.902385983268974}, "policy_reward_mean": {"policy_0": -663.0949347139167}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1185.1431499333391, -970.0794484578676, -618.3920547772065, -540.4521459104024, -1137.1810886478506, -809.5042283671651, -250.84841018894429, -412.91602255495, -458.8641270549431, -149.11410352975943, -989.4994528866508, -664.8273274126892, -604.4878022874897, -767.0678809351082, -1188.3062113572355, -1052.0383023890888, -713.6544850729779, -75.91629656699763, -1119.7499773505997, -1300.913771394855, -1071.9284371117685, -20.902385983268974, -827.6698835385404, -441.04145542571865, -827.5847733081794, -799.3231340694194, -30.73728958958871, -306.234877877249, -529.9761154557569, -1109.517283890453, -701.7484467297537, -1096.296285146443, -566.0216341085279, -63.059219662922835, -626.3040106598687, -791.2064716139286, -1084.593714182458, -751.979064827465, -723.8867789707815, -1094.5038761205233, -125.98638347944818, -82.14983792009248, -913.6294223730882, -899.6048912052727, -219.16174374743278, -692.4391413862603, -696.1629191592976, -666.5063570023646, -745.5196217850323, -1152.744954130193, -130.93645908873475, -826.9270783751956, -838.9205184687847, -989.0814769645269, -1267.9188921416485, -490.3181869254451, -506.8283503328946, -57.02537348331059, -538.8232275781897, -1024.203067358149, -984.7328045439547, -60.92816989232423, -914.8093603970892, -691.2516578380063, -599.5243274639454, -557.6065452246487, -906.2797824416032, -589.7659999612001, -26.793852232860626, -962.6790761876277, -926.863214367286, -657.5181138699969, -107.58234662978701, -621.9171138608423, -255.7439685826666, -69.36349102690971, -1088.571683823734, -112.29424049215476, -1083.3741001593498, -755.6397999025503, -1083.2125420678176, -275.29022567062754, -1310.3320696576934, -190.51171028199713, -162.53300788859818, -833.8381199736864, -753.0542288277877, -982.6713996595932, -635.0366634302371, -868.9740687323331, -416.71499031997666, -119.65330910055047, -755.8359683793472, -1048.1211957770877, -752.2206732271226, -1104.2245931594623, -1037.2118686448548, -462.49694491606436, -155.30754759397536, -50.65336693023244], "episode_lengths": [150, 150, 130, 127, 150, 150, 79, 113, 113, 77, 150, 150, 150, 150, 150, 150, 150, 66, 150, 150, 150, 44, 147, 117, 150, 143, 41, 103, 150, 150, 150, 150, 150, 58, 146, 150, 150, 150, 150, 150, 47, 70, 150, 150, 93, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 110, 150, 48, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 47, 150, 121, 56, 150, 47, 150, 150, 150, 89, 150, 65, 74, 150, 143, 150, 150, 150, 97, 68, 150, 150, 138, 150, 150, 117, 56, 47], "policy_policy_0_reward": [-1185.1431499333391, -970.0794484578676, -618.3920547772065, -540.4521459104024, -1137.1810886478506, -809.5042283671651, -250.84841018894429, -412.91602255495, -458.8641270549431, -149.11410352975943, -989.4994528866508, -664.8273274126892, -604.4878022874897, -767.0678809351082, -1188.3062113572355, -1052.0383023890888, -713.6544850729779, -75.91629656699763, -1119.7499773505997, -1300.913771394855, -1071.9284371117685, -20.902385983268974, -827.6698835385404, -441.04145542571865, -827.5847733081794, -799.3231340694194, -30.73728958958871, -306.234877877249, -529.9761154557569, -1109.517283890453, -701.7484467297537, -1096.296285146443, -566.0216341085279, -63.059219662922835, -626.3040106598687, -791.2064716139286, -1084.593714182458, -751.979064827465, -723.8867789707815, -1094.5038761205233, -125.98638347944818, -82.14983792009248, -913.6294223730882, -899.6048912052727, -219.16174374743278, -692.4391413862603, -696.1629191592976, -666.5063570023646, -745.5196217850323, -1152.744954130193, -130.93645908873475, -826.9270783751956, -838.9205184687847, -989.0814769645269, -1267.9188921416485, -490.3181869254451, -506.8283503328946, -57.02537348331059, -538.8232275781897, -1024.203067358149, -984.7328045439547, -60.92816989232423, -914.8093603970892, -691.2516578380063, -599.5243274639454, -557.6065452246487, -906.2797824416032, -589.7659999612001, -26.793852232860626, -962.6790761876277, -926.863214367286, -657.5181138699969, -107.58234662978701, -621.9171138608423, -255.7439685826666, -69.36349102690971, -1088.571683823734, -112.29424049215476, -1083.3741001593498, -755.6397999025503, -1083.2125420678176, -275.29022567062754, -1310.3320696576934, -190.51171028199713, -162.53300788859818, -833.8381199736864, -753.0542288277877, -982.6713996595932, -635.0366634302371, -868.9740687323331, -416.71499031997666, -119.65330910055047, -755.8359683793472, -1048.1211957770877, -752.2206732271226, -1104.2245931594623, -1037.2118686448548, -462.49694491606436, -155.30754759397536, -50.65336693023244]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545080427659145, "mean_inference_ms": 1.6667583129501722, "mean_action_processing_ms": 0.27565601045255983, "mean_env_wait_ms": 3.5038825135298084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011795282363891602, "StateBufferConnector_ms": 0.007844209671020508, "ViewRequirementAgentConnector_ms": 0.19060826301574707}, "num_episodes": 31, "episode_return_max": -20.902385983268974, "episode_return_min": -1310.3320696576934, "episode_return_mean": -663.0949347139167, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.4884111953999, "num_env_steps_trained_throughput_per_sec": 303.4884111953999, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12912.355, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12912.28, "sample_time_ms": 1145.075, "learn_time_ms": 11695.638, "learn_throughput": 342.008, "synch_weights_time_ms": 70.727}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00003", "date": "2024-08-04_05-47-58", "timestamp": 1722730678, "time_this_iter_s": 13.192309379577637, "time_total_s": 231.85481142997742, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc701fc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 231.85481142997742, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.773684210526316, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.64473935465018, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.37534499814113, "policy_loss": -0.007955000490377036, "vf_loss": 7.376754943529765, "vf_explained_var": 0.8632653043294947, "kl": 0.014817231397895132, "entropy": 1.2269943284491698, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -16.366549294437487, "episode_reward_min": -1441.8634351885748, "episode_reward_mean": -629.9295830398165, "episode_len_mean": 124.75, "episode_media": {}, "episodes_timesteps_total": 12475, "policy_reward_min": {"policy_0": -1441.8634351885748}, "policy_reward_max": {"policy_0": -16.366549294437487}, "policy_reward_mean": {"policy_0": -629.9295830398165}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1096.296285146443, -566.0216341085279, -63.059219662922835, -626.3040106598687, -791.2064716139286, -1084.593714182458, -751.979064827465, -723.8867789707815, -1094.5038761205233, -125.98638347944818, -82.14983792009248, -913.6294223730882, -899.6048912052727, -219.16174374743278, -692.4391413862603, -696.1629191592976, -666.5063570023646, -745.5196217850323, -1152.744954130193, -130.93645908873475, -826.9270783751956, -838.9205184687847, -989.0814769645269, -1267.9188921416485, -490.3181869254451, -506.8283503328946, -57.02537348331059, -538.8232275781897, -1024.203067358149, -984.7328045439547, -60.92816989232423, -914.8093603970892, -691.2516578380063, -599.5243274639454, -557.6065452246487, -906.2797824416032, -589.7659999612001, -26.793852232860626, -962.6790761876277, -926.863214367286, -657.5181138699969, -107.58234662978701, -621.9171138608423, -255.7439685826666, -69.36349102690971, -1088.571683823734, -112.29424049215476, -1083.3741001593498, -755.6397999025503, -1083.2125420678176, -275.29022567062754, -1310.3320696576934, -190.51171028199713, -162.53300788859818, -833.8381199736864, -753.0542288277877, -982.6713996595932, -635.0366634302371, -868.9740687323331, -416.71499031997666, -119.65330910055047, -755.8359683793472, -1048.1211957770877, -752.2206732271226, -1104.2245931594623, -1037.2118686448548, -462.49694491606436, -155.30754759397536, -50.65336693023244, -218.2581150870682, -1098.4895570128988, -604.2788051065166, -173.81046074634136, -821.4005421144667, -951.0648452561848, -30.733352395391876, -887.2563320907536, -378.90641343146916, -835.1283665190912, -501.8567971587314, -831.0000485815956, -746.7102320163284, -1441.8634351885748, -709.2650086946504, -359.4382553625825, -38.37018039297208, -624.4697147202558, -16.366549294437487, -125.8092155893434, -389.7826257817641, -862.6136710151253, -520.1088570897358, -121.0375155169123, -844.4749190365395, -934.4225760949851, -817.4622412618934, -717.1857563941061, -85.58966511975133, -820.3540185615934, -851.5771300137185], "episode_lengths": [150, 150, 58, 146, 150, 150, 150, 150, 150, 47, 70, 150, 150, 93, 150, 150, 150, 150, 150, 77, 150, 150, 150, 150, 110, 150, 48, 150, 150, 150, 57, 150, 150, 150, 150, 150, 150, 53, 150, 150, 150, 47, 150, 121, 56, 150, 47, 150, 150, 150, 89, 150, 65, 74, 150, 143, 150, 150, 150, 97, 68, 150, 150, 138, 150, 150, 117, 56, 47, 73, 150, 150, 59, 150, 150, 52, 150, 116, 150, 150, 150, 150, 150, 150, 96, 51, 131, 42, 80, 135, 150, 135, 68, 150, 146, 150, 150, 67, 150, 150], "policy_policy_0_reward": [-1096.296285146443, -566.0216341085279, -63.059219662922835, -626.3040106598687, -791.2064716139286, -1084.593714182458, -751.979064827465, -723.8867789707815, -1094.5038761205233, -125.98638347944818, -82.14983792009248, -913.6294223730882, -899.6048912052727, -219.16174374743278, -692.4391413862603, -696.1629191592976, -666.5063570023646, -745.5196217850323, -1152.744954130193, -130.93645908873475, -826.9270783751956, -838.9205184687847, -989.0814769645269, -1267.9188921416485, -490.3181869254451, -506.8283503328946, -57.02537348331059, -538.8232275781897, -1024.203067358149, -984.7328045439547, -60.92816989232423, -914.8093603970892, -691.2516578380063, -599.5243274639454, -557.6065452246487, -906.2797824416032, -589.7659999612001, -26.793852232860626, -962.6790761876277, -926.863214367286, -657.5181138699969, -107.58234662978701, -621.9171138608423, -255.7439685826666, -69.36349102690971, -1088.571683823734, -112.29424049215476, -1083.3741001593498, -755.6397999025503, -1083.2125420678176, -275.29022567062754, -1310.3320696576934, -190.51171028199713, -162.53300788859818, -833.8381199736864, -753.0542288277877, -982.6713996595932, -635.0366634302371, -868.9740687323331, -416.71499031997666, -119.65330910055047, -755.8359683793472, -1048.1211957770877, -752.2206732271226, -1104.2245931594623, -1037.2118686448548, -462.49694491606436, -155.30754759397536, -50.65336693023244, -218.2581150870682, -1098.4895570128988, -604.2788051065166, -173.81046074634136, -821.4005421144667, -951.0648452561848, -30.733352395391876, -887.2563320907536, -378.90641343146916, -835.1283665190912, -501.8567971587314, -831.0000485815956, -746.7102320163284, -1441.8634351885748, -709.2650086946504, -359.4382553625825, -38.37018039297208, -624.4697147202558, -16.366549294437487, -125.8092155893434, -389.7826257817641, -862.6136710151253, -520.1088570897358, -121.0375155169123, -844.4749190365395, -934.4225760949851, -817.4622412618934, -717.1857563941061, -85.58966511975133, -820.3540185615934, -851.5771300137185]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547556719112602, "mean_inference_ms": 1.667429852980134, "mean_action_processing_ms": 0.27568410932666954, "mean_env_wait_ms": 3.503214876815648, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011964082717895508, "StateBufferConnector_ms": 0.007879972457885742, "ViewRequirementAgentConnector_ms": 0.20087718963623047}, "num_episodes": 31, "episode_return_max": -16.366549294437487, "episode_return_min": -1441.8634351885748, "episode_return_mean": -629.9295830398165, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.79582780179527, "num_env_steps_trained_throughput_per_sec": 313.79582780179527, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12877.237, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12877.165, "sample_time_ms": 1142.438, "learn_time_ms": 11662.908, "learn_throughput": 342.968, "synch_weights_time_ms": 70.962}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00003", "date": "2024-08-04_05-48-11", "timestamp": 1722730691, "time_this_iter_s": 12.759929180145264, "time_total_s": 244.61474061012268, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f66320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 244.61474061012268, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 17.916666666666668, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 59.17030622462432, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.730666444202265, "policy_loss": -0.013936642823197568, "vf_loss": 6.73746559570233, "vf_explained_var": 0.9071467757845918, "kl": 0.016104614851565238, "entropy": 1.0957830740138887, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -16.366549294437487, "episode_reward_min": -1441.8634351885748, "episode_reward_mean": -588.548726766972, "episode_len_mean": 119.76, "episode_media": {}, "episodes_timesteps_total": 11976, "policy_reward_min": {"policy_0": -1441.8634351885748}, "policy_reward_max": {"policy_0": -16.366549294437487}, "policy_reward_mean": {"policy_0": -588.548726766972}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-906.2797824416032, -589.7659999612001, -26.793852232860626, -962.6790761876277, -926.863214367286, -657.5181138699969, -107.58234662978701, -621.9171138608423, -255.7439685826666, -69.36349102690971, -1088.571683823734, -112.29424049215476, -1083.3741001593498, -755.6397999025503, -1083.2125420678176, -275.29022567062754, -1310.3320696576934, -190.51171028199713, -162.53300788859818, -833.8381199736864, -753.0542288277877, -982.6713996595932, -635.0366634302371, -868.9740687323331, -416.71499031997666, -119.65330910055047, -755.8359683793472, -1048.1211957770877, -752.2206732271226, -1104.2245931594623, -1037.2118686448548, -462.49694491606436, -155.30754759397536, -50.65336693023244, -218.2581150870682, -1098.4895570128988, -604.2788051065166, -173.81046074634136, -821.4005421144667, -951.0648452561848, -30.733352395391876, -887.2563320907536, -378.90641343146916, -835.1283665190912, -501.8567971587314, -831.0000485815956, -746.7102320163284, -1441.8634351885748, -709.2650086946504, -359.4382553625825, -38.37018039297208, -624.4697147202558, -16.366549294437487, -125.8092155893434, -389.7826257817641, -862.6136710151253, -520.1088570897358, -121.0375155169123, -844.4749190365395, -934.4225760949851, -817.4622412618934, -717.1857563941061, -85.58966511975133, -820.3540185615934, -851.5771300137185, -679.0055848117453, -442.22786797991773, -1143.9212349301977, -131.39785436186733, -1319.1017252327947, -726.4033110356706, -726.8017278232172, -848.6664905004234, -735.005581823301, -225.549052849122, -326.36099120841243, -894.1216328860914, -780.9443232967704, -326.6009811014125, -770.8028545775319, -151.43588734610898, -870.8681704865114, -120.68800815338007, -1132.8358710648852, -235.16940269697702, -861.2291013584113, -99.89310101374386, -799.361371895993, -143.56578623509154, -644.5063003437265, -88.63741513050401, -28.440788706362287, -961.5899381406937, -113.65911552060552, -562.567020751809, -419.75907320967707, -1049.8138581754695, -48.23626445044624, -57.538479704072785, -866.8000274708613], "episode_lengths": [150, 150, 53, 150, 150, 150, 47, 150, 121, 56, 150, 47, 150, 150, 150, 89, 150, 65, 74, 150, 143, 150, 150, 150, 97, 68, 150, 150, 138, 150, 150, 117, 56, 47, 73, 150, 150, 59, 150, 150, 52, 150, 116, 150, 150, 150, 150, 150, 150, 96, 51, 131, 42, 80, 135, 150, 135, 68, 150, 146, 150, 150, 67, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 84, 106, 150, 150, 99, 150, 84, 150, 71, 150, 70, 150, 51, 150, 81, 150, 64, 42, 150, 62, 150, 128, 150, 42, 55, 150], "policy_policy_0_reward": [-906.2797824416032, -589.7659999612001, -26.793852232860626, -962.6790761876277, -926.863214367286, -657.5181138699969, -107.58234662978701, -621.9171138608423, -255.7439685826666, -69.36349102690971, -1088.571683823734, -112.29424049215476, -1083.3741001593498, -755.6397999025503, -1083.2125420678176, -275.29022567062754, -1310.3320696576934, -190.51171028199713, -162.53300788859818, -833.8381199736864, -753.0542288277877, -982.6713996595932, -635.0366634302371, -868.9740687323331, -416.71499031997666, -119.65330910055047, -755.8359683793472, -1048.1211957770877, -752.2206732271226, -1104.2245931594623, -1037.2118686448548, -462.49694491606436, -155.30754759397536, -50.65336693023244, -218.2581150870682, -1098.4895570128988, -604.2788051065166, -173.81046074634136, -821.4005421144667, -951.0648452561848, -30.733352395391876, -887.2563320907536, -378.90641343146916, -835.1283665190912, -501.8567971587314, -831.0000485815956, -746.7102320163284, -1441.8634351885748, -709.2650086946504, -359.4382553625825, -38.37018039297208, -624.4697147202558, -16.366549294437487, -125.8092155893434, -389.7826257817641, -862.6136710151253, -520.1088570897358, -121.0375155169123, -844.4749190365395, -934.4225760949851, -817.4622412618934, -717.1857563941061, -85.58966511975133, -820.3540185615934, -851.5771300137185, -679.0055848117453, -442.22786797991773, -1143.9212349301977, -131.39785436186733, -1319.1017252327947, -726.4033110356706, -726.8017278232172, -848.6664905004234, -735.005581823301, -225.549052849122, -326.36099120841243, -894.1216328860914, -780.9443232967704, -326.6009811014125, -770.8028545775319, -151.43588734610898, -870.8681704865114, -120.68800815338007, -1132.8358710648852, -235.16940269697702, -861.2291013584113, -99.89310101374386, -799.361371895993, -143.56578623509154, -644.5063003437265, -88.63741513050401, -28.440788706362287, -961.5899381406937, -113.65911552060552, -562.567020751809, -419.75907320967707, -1049.8138581754695, -48.23626445044624, -57.538479704072785, -866.8000274708613]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545957343115786, "mean_inference_ms": 1.667245989777396, "mean_action_processing_ms": 0.27550735669177984, "mean_env_wait_ms": 3.5008089128031084, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012157440185546875, "StateBufferConnector_ms": 0.007944107055664062, "ViewRequirementAgentConnector_ms": 0.20220947265625}, "num_episodes": 35, "episode_return_max": -16.366549294437487, "episode_return_min": -1441.8634351885748, "episode_return_mean": -588.548726766972, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.50795649332684, "num_env_steps_trained_throughput_per_sec": 303.50795649332684, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12878.784, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12878.712, "sample_time_ms": 1129.862, "learn_time_ms": 11675.502, "learn_throughput": 342.598, "synch_weights_time_ms": 72.452}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00003", "date": "2024-08-04_05-48-24", "timestamp": 1722730704, "time_this_iter_s": 13.191624164581299, "time_total_s": 257.806364774704, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5f5b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 257.806364774704, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.64736842105263, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 60.35417331258456, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.975935563445091, "policy_loss": -0.014155049408145715, "vf_loss": 6.983280092974504, "vf_explained_var": 0.8615818929548065, "kl": 0.015426859245174758, "entropy": 1.3158438873787721, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -16.366549294437487, "episode_reward_min": -1491.4680741831087, "episode_reward_mean": -600.3244481199093, "episode_len_mean": 123.05, "episode_media": {}, "episodes_timesteps_total": 12305, "policy_reward_min": {"policy_0": -1491.4680741831087}, "policy_reward_max": {"policy_0": -16.366549294437487}, "policy_reward_mean": {"policy_0": -600.3244481199093}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-462.49694491606436, -155.30754759397536, -50.65336693023244, -218.2581150870682, -1098.4895570128988, -604.2788051065166, -173.81046074634136, -821.4005421144667, -951.0648452561848, -30.733352395391876, -887.2563320907536, -378.90641343146916, -835.1283665190912, -501.8567971587314, -831.0000485815956, -746.7102320163284, -1441.8634351885748, -709.2650086946504, -359.4382553625825, -38.37018039297208, -624.4697147202558, -16.366549294437487, -125.8092155893434, -389.7826257817641, -862.6136710151253, -520.1088570897358, -121.0375155169123, -844.4749190365395, -934.4225760949851, -817.4622412618934, -717.1857563941061, -85.58966511975133, -820.3540185615934, -851.5771300137185, -679.0055848117453, -442.22786797991773, -1143.9212349301977, -131.39785436186733, -1319.1017252327947, -726.4033110356706, -726.8017278232172, -848.6664905004234, -735.005581823301, -225.549052849122, -326.36099120841243, -894.1216328860914, -780.9443232967704, -326.6009811014125, -770.8028545775319, -151.43588734610898, -870.8681704865114, -120.68800815338007, -1132.8358710648852, -235.16940269697702, -861.2291013584113, -99.89310101374386, -799.361371895993, -143.56578623509154, -644.5063003437265, -88.63741513050401, -28.440788706362287, -961.5899381406937, -113.65911552060552, -562.567020751809, -419.75907320967707, -1049.8138581754695, -48.23626445044624, -57.538479704072785, -866.8000274708613, -812.6787564983925, -882.3866973198868, -1491.4680741831087, -588.7611164467488, -223.1387987375826, -910.807852127938, -639.6572930801302, -1083.2915975631265, -800.4529726116555, -96.68545619446843, -707.8918152591774, -731.0415898080207, -898.3510953348958, -897.7178626356939, -165.31831904124067, -1202.8043925292275, -725.2907028225359, -642.7795002971757, -312.36056808780273, -633.0629062410783, -115.29387708411647, -774.243074962255, -604.5234854761844, -355.72269660635345, -1377.0317583962267, -1017.7486211335405, -690.5169214872584, -582.3229248091931, -736.0083902852164, -757.0481923306412, -214.98824424019645], "episode_lengths": [117, 56, 47, 73, 150, 150, 59, 150, 150, 52, 150, 116, 150, 150, 150, 150, 150, 150, 96, 51, 131, 42, 80, 135, 150, 135, 68, 150, 146, 150, 150, 67, 150, 150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 84, 106, 150, 150, 99, 150, 84, 150, 71, 150, 70, 150, 51, 150, 81, 150, 64, 42, 150, 62, 150, 128, 150, 42, 55, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 71, 150, 150, 150, 150, 82, 150, 150, 150, 105, 150, 80, 150, 150, 107, 150, 150, 150, 150, 132, 138, 77], "policy_policy_0_reward": [-462.49694491606436, -155.30754759397536, -50.65336693023244, -218.2581150870682, -1098.4895570128988, -604.2788051065166, -173.81046074634136, -821.4005421144667, -951.0648452561848, -30.733352395391876, -887.2563320907536, -378.90641343146916, -835.1283665190912, -501.8567971587314, -831.0000485815956, -746.7102320163284, -1441.8634351885748, -709.2650086946504, -359.4382553625825, -38.37018039297208, -624.4697147202558, -16.366549294437487, -125.8092155893434, -389.7826257817641, -862.6136710151253, -520.1088570897358, -121.0375155169123, -844.4749190365395, -934.4225760949851, -817.4622412618934, -717.1857563941061, -85.58966511975133, -820.3540185615934, -851.5771300137185, -679.0055848117453, -442.22786797991773, -1143.9212349301977, -131.39785436186733, -1319.1017252327947, -726.4033110356706, -726.8017278232172, -848.6664905004234, -735.005581823301, -225.549052849122, -326.36099120841243, -894.1216328860914, -780.9443232967704, -326.6009811014125, -770.8028545775319, -151.43588734610898, -870.8681704865114, -120.68800815338007, -1132.8358710648852, -235.16940269697702, -861.2291013584113, -99.89310101374386, -799.361371895993, -143.56578623509154, -644.5063003437265, -88.63741513050401, -28.440788706362287, -961.5899381406937, -113.65911552060552, -562.567020751809, -419.75907320967707, -1049.8138581754695, -48.23626445044624, -57.538479704072785, -866.8000274708613, -812.6787564983925, -882.3866973198868, -1491.4680741831087, -588.7611164467488, -223.1387987375826, -910.807852127938, -639.6572930801302, -1083.2915975631265, -800.4529726116555, -96.68545619446843, -707.8918152591774, -731.0415898080207, -898.3510953348958, -897.7178626356939, -165.31831904124067, -1202.8043925292275, -725.2907028225359, -642.7795002971757, -312.36056808780273, -633.0629062410783, -115.29387708411647, -774.243074962255, -604.5234854761844, -355.72269660635345, -1377.0317583962267, -1017.7486211335405, -690.5169214872584, -582.3229248091931, -736.0083902852164, -757.0481923306412, -214.98824424019645]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5546513761691917, "mean_inference_ms": 1.6679856469814387, "mean_action_processing_ms": 0.2754231778889225, "mean_env_wait_ms": 3.500882706233288, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012081384658813477, "StateBufferConnector_ms": 0.007857084274291992, "ViewRequirementAgentConnector_ms": 0.20552706718444824}, "num_episodes": 31, "episode_return_max": -16.366549294437487, "episode_return_min": -1491.4680741831087, "episode_return_mean": -600.3244481199093, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 347.40332866373114, "num_env_steps_trained_throughput_per_sec": 347.40332866373114, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12929.337, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12929.265, "sample_time_ms": 1145.337, "learn_time_ms": 11712.879, "learn_throughput": 341.504, "synch_weights_time_ms": 70.142}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00003", "date": "2024-08-04_05-48-36", "timestamp": 1722730716, "time_this_iter_s": 11.527274370193481, "time_total_s": 269.33363914489746, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0af6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 269.33363914489746, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.84375, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70.61503383715947, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.182965440054734, "policy_loss": -0.015404686526259563, "vf_loss": 7.190744515756766, "vf_explained_var": 0.8956499086072047, "kl": 0.01720820510502866, "entropy": 1.1806702915579081, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -28.440788706362287, "episode_reward_min": -1491.4680741831087, "episode_reward_mean": -609.5977145726695, "episode_len_mean": 125.47, "episode_media": {}, "episodes_timesteps_total": 12547, "policy_reward_min": {"policy_0": -1491.4680741831087}, "policy_reward_max": {"policy_0": -28.440788706362287}, "policy_reward_mean": {"policy_0": -609.5977145726695}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-851.5771300137185, -679.0055848117453, -442.22786797991773, -1143.9212349301977, -131.39785436186733, -1319.1017252327947, -726.4033110356706, -726.8017278232172, -848.6664905004234, -735.005581823301, -225.549052849122, -326.36099120841243, -894.1216328860914, -780.9443232967704, -326.6009811014125, -770.8028545775319, -151.43588734610898, -870.8681704865114, -120.68800815338007, -1132.8358710648852, -235.16940269697702, -861.2291013584113, -99.89310101374386, -799.361371895993, -143.56578623509154, -644.5063003437265, -88.63741513050401, -28.440788706362287, -961.5899381406937, -113.65911552060552, -562.567020751809, -419.75907320967707, -1049.8138581754695, -48.23626445044624, -57.538479704072785, -866.8000274708613, -812.6787564983925, -882.3866973198868, -1491.4680741831087, -588.7611164467488, -223.1387987375826, -910.807852127938, -639.6572930801302, -1083.2915975631265, -800.4529726116555, -96.68545619446843, -707.8918152591774, -731.0415898080207, -898.3510953348958, -897.7178626356939, -165.31831904124067, -1202.8043925292275, -725.2907028225359, -642.7795002971757, -312.36056808780273, -633.0629062410783, -115.29387708411647, -774.243074962255, -604.5234854761844, -355.72269660635345, -1377.0317583962267, -1017.7486211335405, -690.5169214872584, -582.3229248091931, -736.0083902852164, -757.0481923306412, -214.98824424019645, -1035.4152054161946, -705.9258803092863, -746.9940719650509, -135.4565955395084, -852.290232446368, -656.7754947503389, -873.1243635294289, -51.5590574439907, -1179.607059010113, -598.9700844597276, -628.7086871899635, -834.832868935554, -734.9082992024737, -183.60165311482393, -662.4933618999578, -87.24715288972551, -610.4045495225351, -921.1731102719333, -574.3497583701319, -468.4244347869969, -127.12600503851237, -332.7710905411994, -951.0948689107764, -900.6997714987986, -134.0172778965153, -136.3225448374408, -440.3950459788556, -815.5466245770508, -582.9884160810168, -116.4727450369092, -158.667141590319, -600.3452761892635, -1264.5838481175872], "episode_lengths": [150, 150, 150, 150, 68, 150, 150, 150, 150, 150, 84, 106, 150, 150, 99, 150, 84, 150, 71, 150, 70, 150, 51, 150, 81, 150, 64, 42, 150, 62, 150, 128, 150, 42, 55, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 71, 150, 150, 150, 150, 82, 150, 150, 150, 105, 150, 80, 150, 150, 107, 150, 150, 150, 150, 132, 138, 77, 150, 150, 150, 55, 150, 150, 150, 49, 150, 150, 148, 136, 150, 91, 150, 63, 150, 150, 150, 115, 89, 121, 150, 150, 79, 53, 132, 150, 150, 66, 95, 121, 150], "policy_policy_0_reward": [-851.5771300137185, -679.0055848117453, -442.22786797991773, -1143.9212349301977, -131.39785436186733, -1319.1017252327947, -726.4033110356706, -726.8017278232172, -848.6664905004234, -735.005581823301, -225.549052849122, -326.36099120841243, -894.1216328860914, -780.9443232967704, -326.6009811014125, -770.8028545775319, -151.43588734610898, -870.8681704865114, -120.68800815338007, -1132.8358710648852, -235.16940269697702, -861.2291013584113, -99.89310101374386, -799.361371895993, -143.56578623509154, -644.5063003437265, -88.63741513050401, -28.440788706362287, -961.5899381406937, -113.65911552060552, -562.567020751809, -419.75907320967707, -1049.8138581754695, -48.23626445044624, -57.538479704072785, -866.8000274708613, -812.6787564983925, -882.3866973198868, -1491.4680741831087, -588.7611164467488, -223.1387987375826, -910.807852127938, -639.6572930801302, -1083.2915975631265, -800.4529726116555, -96.68545619446843, -707.8918152591774, -731.0415898080207, -898.3510953348958, -897.7178626356939, -165.31831904124067, -1202.8043925292275, -725.2907028225359, -642.7795002971757, -312.36056808780273, -633.0629062410783, -115.29387708411647, -774.243074962255, -604.5234854761844, -355.72269660635345, -1377.0317583962267, -1017.7486211335405, -690.5169214872584, -582.3229248091931, -736.0083902852164, -757.0481923306412, -214.98824424019645, -1035.4152054161946, -705.9258803092863, -746.9940719650509, -135.4565955395084, -852.290232446368, -656.7754947503389, -873.1243635294289, -51.5590574439907, -1179.607059010113, -598.9700844597276, -628.7086871899635, -834.832868935554, -734.9082992024737, -183.60165311482393, -662.4933618999578, -87.24715288972551, -610.4045495225351, -921.1731102719333, -574.3497583701319, -468.4244347869969, -127.12600503851237, -332.7710905411994, -951.0948689107764, -900.6997714987986, -134.0172778965153, -136.3225448374408, -440.3950459788556, -815.5466245770508, -582.9884160810168, -116.4727450369092, -158.667141590319, -600.3452761892635, -1264.5838481175872]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.554756328061035, "mean_inference_ms": 1.669265874239246, "mean_action_processing_ms": 0.2754349709899341, "mean_env_wait_ms": 3.5040364168159925, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012031793594360352, "StateBufferConnector_ms": 0.007746219635009766, "ViewRequirementAgentConnector_ms": 0.1942155361175537}, "num_episodes": 33, "episode_return_max": -28.440788706362287, "episode_return_min": -1491.4680741831087, "episode_return_mean": -609.5977145726695, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.0127939954504, "num_env_steps_trained_throughput_per_sec": 304.0127939954504, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12944.677, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12944.606, "sample_time_ms": 1154.616, "learn_time_ms": 11719.457, "learn_throughput": 341.313, "synch_weights_time_ms": 69.656}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00003", "date": "2024-08-04_05-48-49", "timestamp": 1722730729, "time_this_iter_s": 13.170440196990967, "time_total_s": 282.5040793418884, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc700f70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 282.5040793418884, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.66842105263158, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 66.9272876282533, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 6.937108539044857, "policy_loss": -0.009333845866300787, "vf_loss": 6.938756316155195, "vf_explained_var": 0.8603551737343271, "kl": 0.01735652738112424, "entropy": 1.2436617599800228, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -38.86824506861351, "episode_reward_min": -1491.4680741831087, "episode_reward_mean": -607.6697591072151, "episode_len_mean": 124.26, "episode_media": {}, "episodes_timesteps_total": 12426, "policy_reward_min": {"policy_0": -1491.4680741831087}, "policy_reward_max": {"policy_0": -38.86824506861351}, "policy_reward_mean": {"policy_0": -607.6697591072151}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-419.75907320967707, -1049.8138581754695, -48.23626445044624, -57.538479704072785, -866.8000274708613, -812.6787564983925, -882.3866973198868, -1491.4680741831087, -588.7611164467488, -223.1387987375826, -910.807852127938, -639.6572930801302, -1083.2915975631265, -800.4529726116555, -96.68545619446843, -707.8918152591774, -731.0415898080207, -898.3510953348958, -897.7178626356939, -165.31831904124067, -1202.8043925292275, -725.2907028225359, -642.7795002971757, -312.36056808780273, -633.0629062410783, -115.29387708411647, -774.243074962255, -604.5234854761844, -355.72269660635345, -1377.0317583962267, -1017.7486211335405, -690.5169214872584, -582.3229248091931, -736.0083902852164, -757.0481923306412, -214.98824424019645, -1035.4152054161946, -705.9258803092863, -746.9940719650509, -135.4565955395084, -852.290232446368, -656.7754947503389, -873.1243635294289, -51.5590574439907, -1179.607059010113, -598.9700844597276, -628.7086871899635, -834.832868935554, -734.9082992024737, -183.60165311482393, -662.4933618999578, -87.24715288972551, -610.4045495225351, -921.1731102719333, -574.3497583701319, -468.4244347869969, -127.12600503851237, -332.7710905411994, -951.0948689107764, -900.6997714987986, -134.0172778965153, -136.3225448374408, -440.3950459788556, -815.5466245770508, -582.9884160810168, -116.4727450369092, -158.667141590319, -600.3452761892635, -1264.5838481175872, -261.0248833932917, -360.58751367631015, -651.6908346970324, -866.9476398247482, -936.6844660397975, -711.399436236697, -38.86824506861351, -316.5662711347896, -567.6377677957355, -69.67237754865963, -93.92040245159738, -588.5916643864773, -1457.4097779481606, -533.7281343434202, -409.77649093653395, -140.7981672509551, -629.3582189598303, -224.63909890260734, -1139.635727969811, -167.8972089955584, -596.4221135952106, -688.1945092937023, -869.6527696012438, -798.3310777457023, -1307.1562857927343, -549.1278887722716, -382.41364414668453, -198.05157090386373, -727.264519817725, -1069.0651148622844, -197.6262546395168], "episode_lengths": [128, 150, 42, 55, 150, 150, 150, 150, 150, 85, 150, 150, 150, 150, 71, 150, 150, 150, 150, 82, 150, 150, 150, 105, 150, 80, 150, 150, 107, 150, 150, 150, 150, 132, 138, 77, 150, 150, 150, 55, 150, 150, 150, 49, 150, 150, 148, 136, 150, 91, 150, 63, 150, 150, 150, 115, 89, 121, 150, 150, 79, 53, 132, 150, 150, 66, 95, 121, 150, 112, 93, 150, 150, 150, 139, 52, 123, 150, 41, 57, 150, 150, 113, 104, 54, 150, 69, 150, 76, 117, 150, 150, 150, 150, 108, 92, 97, 150, 150, 64], "policy_policy_0_reward": [-419.75907320967707, -1049.8138581754695, -48.23626445044624, -57.538479704072785, -866.8000274708613, -812.6787564983925, -882.3866973198868, -1491.4680741831087, -588.7611164467488, -223.1387987375826, -910.807852127938, -639.6572930801302, -1083.2915975631265, -800.4529726116555, -96.68545619446843, -707.8918152591774, -731.0415898080207, -898.3510953348958, -897.7178626356939, -165.31831904124067, -1202.8043925292275, -725.2907028225359, -642.7795002971757, -312.36056808780273, -633.0629062410783, -115.29387708411647, -774.243074962255, -604.5234854761844, -355.72269660635345, -1377.0317583962267, -1017.7486211335405, -690.5169214872584, -582.3229248091931, -736.0083902852164, -757.0481923306412, -214.98824424019645, -1035.4152054161946, -705.9258803092863, -746.9940719650509, -135.4565955395084, -852.290232446368, -656.7754947503389, -873.1243635294289, -51.5590574439907, -1179.607059010113, -598.9700844597276, -628.7086871899635, -834.832868935554, -734.9082992024737, -183.60165311482393, -662.4933618999578, -87.24715288972551, -610.4045495225351, -921.1731102719333, -574.3497583701319, -468.4244347869969, -127.12600503851237, -332.7710905411994, -951.0948689107764, -900.6997714987986, -134.0172778965153, -136.3225448374408, -440.3950459788556, -815.5466245770508, -582.9884160810168, -116.4727450369092, -158.667141590319, -600.3452761892635, -1264.5838481175872, -261.0248833932917, -360.58751367631015, -651.6908346970324, -866.9476398247482, -936.6844660397975, -711.399436236697, -38.86824506861351, -316.5662711347896, -567.6377677957355, -69.67237754865963, -93.92040245159738, -588.5916643864773, -1457.4097779481606, -533.7281343434202, -409.77649093653395, -140.7981672509551, -629.3582189598303, -224.63909890260734, -1139.635727969811, -167.8972089955584, -596.4221135952106, -688.1945092937023, -869.6527696012438, -798.3310777457023, -1307.1562857927343, -549.1278887722716, -382.41364414668453, -198.05157090386373, -727.264519817725, -1069.0651148622844, -197.6262546395168]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5547107699214873, "mean_inference_ms": 1.6699531167200619, "mean_action_processing_ms": 0.2753118012479151, "mean_env_wait_ms": 3.5030218091921177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012433767318725586, "StateBufferConnector_ms": 0.007762432098388672, "ViewRequirementAgentConnector_ms": 0.19597935676574707}, "num_episodes": 31, "episode_return_max": -38.86824506861351, "episode_return_min": -1491.4680741831087, "episode_return_mean": -607.6697591072151, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.82363367472914, "num_env_steps_trained_throughput_per_sec": 310.82363367472914, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12930.179, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12930.107, "sample_time_ms": 1153.859, "learn_time_ms": 11705.327, "learn_throughput": 341.725, "synch_weights_time_ms": 70.047}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00003", "date": "2024-08-04_05-49-02", "timestamp": 1722730742, "time_this_iter_s": 12.881251335144043, "time_total_s": 295.38533067703247, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc701000>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 295.38533067703247, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.955555555555556, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 69.8007000207901, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.001441120107969, "policy_loss": -0.011973112150735687, "vf_loss": 7.005950397749742, "vf_explained_var": 0.930577660103639, "kl": 0.016842929851554844, "entropy": 1.1548320373520256, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -14.151887943288353, "episode_reward_min": -1457.4097779481606, "episode_reward_mean": -544.5015038902119, "episode_len_mean": 116.46, "episode_media": {}, "episodes_timesteps_total": 11646, "policy_reward_min": {"policy_0": -1457.4097779481606}, "policy_reward_max": {"policy_0": -14.151887943288353}, "policy_reward_mean": {"policy_0": -544.5015038902119}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-746.9940719650509, -135.4565955395084, -852.290232446368, -656.7754947503389, -873.1243635294289, -51.5590574439907, -1179.607059010113, -598.9700844597276, -628.7086871899635, -834.832868935554, -734.9082992024737, -183.60165311482393, -662.4933618999578, -87.24715288972551, -610.4045495225351, -921.1731102719333, -574.3497583701319, -468.4244347869969, -127.12600503851237, -332.7710905411994, -951.0948689107764, -900.6997714987986, -134.0172778965153, -136.3225448374408, -440.3950459788556, -815.5466245770508, -582.9884160810168, -116.4727450369092, -158.667141590319, -600.3452761892635, -1264.5838481175872, -261.0248833932917, -360.58751367631015, -651.6908346970324, -866.9476398247482, -936.6844660397975, -711.399436236697, -38.86824506861351, -316.5662711347896, -567.6377677957355, -69.67237754865963, -93.92040245159738, -588.5916643864773, -1457.4097779481606, -533.7281343434202, -409.77649093653395, -140.7981672509551, -629.3582189598303, -224.63909890260734, -1139.635727969811, -167.8972089955584, -596.4221135952106, -688.1945092937023, -869.6527696012438, -798.3310777457023, -1307.1562857927343, -549.1278887722716, -382.41364414668453, -198.05157090386373, -727.264519817725, -1069.0651148622844, -197.6262546395168, -47.86731563739626, -216.92677821146881, -626.5745629115397, -14.151887943288353, -841.8344797213035, -783.7116566924419, -151.58722094738368, -85.30701222383158, -631.0080758182605, -635.9334005935917, -82.72803428422243, -125.05128263025657, -1239.9375489647182, -52.75953775343923, -1141.8817055548486, -198.6721128291551, -40.9659669985253, -992.3041535114158, -992.5782463564244, -90.77307787454885, -762.2199905407032, -205.06599486015702, -629.195187433867, -696.9406944253134, -101.99410452286232, -955.2037829782755, -1005.1736879512838, -724.8076184364903, -465.9047800436078, -131.66826554887396, -802.8004846661389, -348.95633373694943, -868.8891225399767, -78.27564813430149, -976.4628284399361, -776.6051129118295, -868.1914653208662, -147.1496607172561], "episode_lengths": [150, 55, 150, 150, 150, 49, 150, 150, 148, 136, 150, 91, 150, 63, 150, 150, 150, 115, 89, 121, 150, 150, 79, 53, 132, 150, 150, 66, 95, 121, 150, 112, 93, 150, 150, 150, 139, 52, 123, 150, 41, 57, 150, 150, 113, 104, 54, 150, 69, 150, 76, 117, 150, 150, 150, 150, 108, 92, 97, 150, 150, 64, 58, 70, 136, 34, 150, 150, 62, 47, 127, 150, 65, 74, 150, 55, 150, 87, 52, 150, 150, 61, 150, 97, 150, 150, 67, 150, 150, 150, 125, 58, 150, 103, 150, 62, 150, 150, 150, 82], "policy_policy_0_reward": [-746.9940719650509, -135.4565955395084, -852.290232446368, -656.7754947503389, -873.1243635294289, -51.5590574439907, -1179.607059010113, -598.9700844597276, -628.7086871899635, -834.832868935554, -734.9082992024737, -183.60165311482393, -662.4933618999578, -87.24715288972551, -610.4045495225351, -921.1731102719333, -574.3497583701319, -468.4244347869969, -127.12600503851237, -332.7710905411994, -951.0948689107764, -900.6997714987986, -134.0172778965153, -136.3225448374408, -440.3950459788556, -815.5466245770508, -582.9884160810168, -116.4727450369092, -158.667141590319, -600.3452761892635, -1264.5838481175872, -261.0248833932917, -360.58751367631015, -651.6908346970324, -866.9476398247482, -936.6844660397975, -711.399436236697, -38.86824506861351, -316.5662711347896, -567.6377677957355, -69.67237754865963, -93.92040245159738, -588.5916643864773, -1457.4097779481606, -533.7281343434202, -409.77649093653395, -140.7981672509551, -629.3582189598303, -224.63909890260734, -1139.635727969811, -167.8972089955584, -596.4221135952106, -688.1945092937023, -869.6527696012438, -798.3310777457023, -1307.1562857927343, -549.1278887722716, -382.41364414668453, -198.05157090386373, -727.264519817725, -1069.0651148622844, -197.6262546395168, -47.86731563739626, -216.92677821146881, -626.5745629115397, -14.151887943288353, -841.8344797213035, -783.7116566924419, -151.58722094738368, -85.30701222383158, -631.0080758182605, -635.9334005935917, -82.72803428422243, -125.05128263025657, -1239.9375489647182, -52.75953775343923, -1141.8817055548486, -198.6721128291551, -40.9659669985253, -992.3041535114158, -992.5782463564244, -90.77307787454885, -762.2199905407032, -205.06599486015702, -629.195187433867, -696.9406944253134, -101.99410452286232, -955.2037829782755, -1005.1736879512838, -724.8076184364903, -465.9047800436078, -131.66826554887396, -802.8004846661389, -348.95633373694943, -868.8891225399767, -78.27564813430149, -976.4628284399361, -776.6051129118295, -868.1914653208662, -147.1496607172561]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5544798515711409, "mean_inference_ms": 1.6705626795327486, "mean_action_processing_ms": 0.2752401634042378, "mean_env_wait_ms": 3.505075472221918, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012488365173339844, "StateBufferConnector_ms": 0.007735490798950195, "ViewRequirementAgentConnector_ms": 0.1914517879486084}, "num_episodes": 38, "episode_return_max": -14.151887943288353, "episode_return_min": -1457.4097779481606, "episode_return_mean": -544.5015038902119, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.3263212099334, "num_env_steps_trained_throughput_per_sec": 306.3263212099334, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12929.458, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12929.386, "sample_time_ms": 1152.96, "learn_time_ms": 11707.433, "learn_throughput": 341.663, "synch_weights_time_ms": 68.121}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00003", "date": "2024-08-04_05-49-15", "timestamp": 1722730755, "time_this_iter_s": 13.070593357086182, "time_total_s": 308.45592403411865, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923bc702f80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 308.45592403411865, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 17.689473684210526, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 70.7414922316869, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.279977038005987, "policy_loss": -0.008032568122628921, "vf_loss": 7.281820786992709, "vf_explained_var": 0.8835917971407373, "kl": 0.014116340920251484, "entropy": 1.635402223467827, "entropy_coeff": 0.00010000000000000003}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -10.132859895490899, "episode_reward_min": -1517.0480083361056, "episode_reward_mean": -572.0654156331789, "episode_len_mean": 115.48, "episode_media": {}, "episodes_timesteps_total": 11548, "policy_reward_min": {"policy_0": -1517.0480083361056}, "policy_reward_max": {"policy_0": -10.132859895490899}, "policy_reward_mean": {"policy_0": -572.0654156331789}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-360.58751367631015, -651.6908346970324, -866.9476398247482, -936.6844660397975, -711.399436236697, -38.86824506861351, -316.5662711347896, -567.6377677957355, -69.67237754865963, -93.92040245159738, -588.5916643864773, -1457.4097779481606, -533.7281343434202, -409.77649093653395, -140.7981672509551, -629.3582189598303, -224.63909890260734, -1139.635727969811, -167.8972089955584, -596.4221135952106, -688.1945092937023, -869.6527696012438, -798.3310777457023, -1307.1562857927343, -549.1278887722716, -382.41364414668453, -198.05157090386373, -727.264519817725, -1069.0651148622844, -197.6262546395168, -47.86731563739626, -216.92677821146881, -626.5745629115397, -14.151887943288353, -841.8344797213035, -783.7116566924419, -151.58722094738368, -85.30701222383158, -631.0080758182605, -635.9334005935917, -82.72803428422243, -125.05128263025657, -1239.9375489647182, -52.75953775343923, -1141.8817055548486, -198.6721128291551, -40.9659669985253, -992.3041535114158, -992.5782463564244, -90.77307787454885, -762.2199905407032, -205.06599486015702, -629.195187433867, -696.9406944253134, -101.99410452286232, -955.2037829782755, -1005.1736879512838, -724.8076184364903, -465.9047800436078, -131.66826554887396, -802.8004846661389, -348.95633373694943, -868.8891225399767, -78.27564813430149, -976.4628284399361, -776.6051129118295, -868.1914653208662, -147.1496607172561, -852.6811438341714, -16.395013420978707, -1267.2610727661863, -926.9950400176442, -87.56888895324398, -1111.2249340793066, -1517.0480083361056, -667.6686852084146, -37.80859066504801, -510.4607511625364, -225.2542032864648, -332.4689836940947, -830.3670886537873, -1034.0525731026403, -367.05323193124207, -664.8579050987264, -1112.6972896504385, -247.5933292733087, -780.8374668596182, -1378.5190372878492, -727.0302380684706, -472.7989925424451, -1059.0876588057383, -32.864071809684035, -990.4015638525838, -878.0023710433262, -68.65217669761607, -817.222927509392, -75.32236176536489, -10.132859895490899, -677.2301457539853, -601.8089442869713], "episode_lengths": [93, 150, 150, 150, 139, 52, 123, 150, 41, 57, 150, 150, 113, 104, 54, 150, 69, 150, 76, 117, 150, 150, 150, 150, 108, 92, 97, 150, 150, 64, 58, 70, 136, 34, 150, 150, 62, 47, 127, 150, 65, 74, 150, 55, 150, 87, 52, 150, 150, 61, 150, 97, 150, 150, 67, 150, 150, 150, 125, 58, 150, 103, 150, 62, 150, 150, 150, 82, 150, 38, 150, 150, 61, 150, 150, 142, 52, 150, 66, 120, 150, 150, 125, 150, 150, 100, 146, 150, 150, 129, 150, 42, 150, 150, 64, 150, 43, 37, 124, 138], "policy_policy_0_reward": [-360.58751367631015, -651.6908346970324, -866.9476398247482, -936.6844660397975, -711.399436236697, -38.86824506861351, -316.5662711347896, -567.6377677957355, -69.67237754865963, -93.92040245159738, -588.5916643864773, -1457.4097779481606, -533.7281343434202, -409.77649093653395, -140.7981672509551, -629.3582189598303, -224.63909890260734, -1139.635727969811, -167.8972089955584, -596.4221135952106, -688.1945092937023, -869.6527696012438, -798.3310777457023, -1307.1562857927343, -549.1278887722716, -382.41364414668453, -198.05157090386373, -727.264519817725, -1069.0651148622844, -197.6262546395168, -47.86731563739626, -216.92677821146881, -626.5745629115397, -14.151887943288353, -841.8344797213035, -783.7116566924419, -151.58722094738368, -85.30701222383158, -631.0080758182605, -635.9334005935917, -82.72803428422243, -125.05128263025657, -1239.9375489647182, -52.75953775343923, -1141.8817055548486, -198.6721128291551, -40.9659669985253, -992.3041535114158, -992.5782463564244, -90.77307787454885, -762.2199905407032, -205.06599486015702, -629.195187433867, -696.9406944253134, -101.99410452286232, -955.2037829782755, -1005.1736879512838, -724.8076184364903, -465.9047800436078, -131.66826554887396, -802.8004846661389, -348.95633373694943, -868.8891225399767, -78.27564813430149, -976.4628284399361, -776.6051129118295, -868.1914653208662, -147.1496607172561, -852.6811438341714, -16.395013420978707, -1267.2610727661863, -926.9950400176442, -87.56888895324398, -1111.2249340793066, -1517.0480083361056, -667.6686852084146, -37.80859066504801, -510.4607511625364, -225.2542032864648, -332.4689836940947, -830.3670886537873, -1034.0525731026403, -367.05323193124207, -664.8579050987264, -1112.6972896504385, -247.5933292733087, -780.8374668596182, -1378.5190372878492, -727.0302380684706, -472.7989925424451, -1059.0876588057383, -32.864071809684035, -990.4015638525838, -878.0023710433262, -68.65217669761607, -817.222927509392, -75.32236176536489, -10.132859895490899, -677.2301457539853, -601.8089442869713]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5539986903318644, "mean_inference_ms": 1.6694918522983166, "mean_action_processing_ms": 0.27498661956134973, "mean_env_wait_ms": 3.503519447640305, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012576103210449219, "StateBufferConnector_ms": 0.007881641387939453, "ViewRequirementAgentConnector_ms": 0.19288182258605957}, "num_episodes": 32, "episode_return_max": -10.132859895490899, "episode_return_min": -1517.0480083361056, "episode_return_mean": -572.0654156331789, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 353.90236086771597, "num_env_steps_trained_throughput_per_sec": 353.90236086771597, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12744.191, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12744.118, "sample_time_ms": 1153.493, "learn_time_ms": 11523.791, "learn_throughput": 347.108, "synch_weights_time_ms": 65.97}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00003", "date": "2024-08-04_05-49-26", "timestamp": 1722730766, "time_this_iter_s": 11.316035509109497, "time_total_s": 319.77195954322815, "pid": 572690, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923cc0ae8c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.0001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 319.77195954322815, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 19.1875, "ram_util_percent": 27.912499999999998}}
