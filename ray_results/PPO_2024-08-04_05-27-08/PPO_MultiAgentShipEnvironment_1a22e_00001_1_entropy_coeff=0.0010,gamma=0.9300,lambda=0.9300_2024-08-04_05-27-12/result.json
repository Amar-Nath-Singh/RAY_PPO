{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.496649178986748, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.31192482362191, "policy_loss": -0.007188271898970319, "vf_loss": 9.318616831302643, "vf_explained_var": 0.04070568221310775, "kl": 0.009655390629617008, "entropy": 1.4348001008232434, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -39.04524976214849, "episode_reward_min": -1333.0097242383715, "episode_reward_mean": -634.6635623134179, "episode_len_mean": 116.25, "episode_media": {}, "episodes_timesteps_total": 2790, "policy_reward_min": {"policy_0": -1333.0097242383715}, "policy_reward_max": {"policy_0": -39.04524976214849}, "policy_reward_mean": {"policy_0": -634.6635623134179}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-292.6496877073401, -120.04474496367392, -70.6438465277142, -1183.247393992005, -350.14069127363246, -562.2738087793034, -88.62957240681463, -155.15979376126896, -867.4906742772065, -1015.0394741165192, -144.37219531537718, -988.0342480402431, -759.4029419834972, -744.1589650516388, -1122.564751588118, -1213.7869033630275, -39.04524976214849, -805.9259471320595, -1116.1792866882702, -792.3068873255419, -591.2214550151474, -1333.0097242383715, -154.49591450840157, -722.1013377047065], "episode_lengths": [79, 86, 45, 150, 86, 116, 53, 68, 150, 150, 74, 150, 150, 150, 150, 150, 57, 150, 150, 135, 150, 150, 64, 127], "policy_policy_0_reward": [-292.6496877073401, -120.04474496367392, -70.6438465277142, -1183.247393992005, -350.14069127363246, -562.2738087793034, -88.62957240681463, -155.15979376126896, -867.4906742772065, -1015.0394741165192, -144.37219531537718, -988.0342480402431, -759.4029419834972, -744.1589650516388, -1122.564751588118, -1213.7869033630275, -39.04524976214849, -805.9259471320595, -1116.1792866882702, -792.3068873255419, -591.2214550151474, -1333.0097242383715, -154.49591450840157, -722.1013377047065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5619493366658003, "mean_inference_ms": 1.6540067875783302, "mean_action_processing_ms": 0.27992507996426036, "mean_env_wait_ms": 3.3621208649485497, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011715292930603027, "StateBufferConnector_ms": 0.008536378542582193, "ViewRequirementAgentConnector_ms": 0.18689235051472983}, "num_episodes": 24, "episode_return_max": -39.04524976214849, "episode_return_min": -1333.0097242383715, "episode_return_mean": -634.6635623134179, "episodes_this_iter": 24}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.6805628779708, "num_env_steps_trained_throughput_per_sec": 304.6805628779708, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 13128.515, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13128.446, "sample_time_ms": 1132.505, "learn_time_ms": 11927.702, "learn_throughput": 335.354, "synch_weights_time_ms": 67.493}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00001", "date": "2024-08-04_05-33-16", "timestamp": 1722729796, "time_this_iter_s": 13.138834476470947, "time_total_s": 13.138834476470947, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16eea320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 13.138834476470947, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.92105263157895, "ram_util_percent": 27.72631578947368}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 15.46577446454515, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.262442586322625, "policy_loss": -0.00790735568346766, "vf_loss": 7.269135286907355, "vf_explained_var": 0.3654089632133643, "kl": 0.013257014110577833, "entropy": 1.4367509751270215, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -39.04524976214849, "episode_reward_min": -1333.0097242383715, "episode_reward_mean": -610.9683928346828, "episode_len_mean": 115.43636363636364, "episode_media": {}, "episodes_timesteps_total": 6349, "policy_reward_min": {"policy_0": -1333.0097242383715}, "policy_reward_max": {"policy_0": -39.04524976214849}, "policy_reward_mean": {"policy_0": -610.9683928346828}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-292.6496877073401, -120.04474496367392, -70.6438465277142, -1183.247393992005, -350.14069127363246, -562.2738087793034, -88.62957240681463, -155.15979376126896, -867.4906742772065, -1015.0394741165192, -144.37219531537718, -988.0342480402431, -759.4029419834972, -744.1589650516388, -1122.564751588118, -1213.7869033630275, -39.04524976214849, -805.9259471320595, -1116.1792866882702, -792.3068873255419, -591.2214550151474, -1333.0097242383715, -154.49591450840157, -722.1013377047065, -1107.2014846050279, -138.91399857297242, -987.4147299626636, -708.02719470395, -569.9214036313354, -263.68829868773724, -130.79614360398514, -895.9696445748975, -824.2231460593432, -737.2473624225031, -144.45640477383057, -269.3775627851471, -944.272308063288, -362.322191455441, -158.67678219993857, -1186.6891112111932, -177.20882050479761, -1015.2724598393302, -1076.839492274954, -65.92865183664561, -876.9682169949023, -263.6513332638362, -306.07227251588813, -156.63696292545285, -1263.2679066653354, -1005.8426482665483, -224.8285584054096, -146.46031418730664, -873.073041355191, -1115.4487717788766, -374.63889225780304], "episode_lengths": [79, 86, 45, 150, 86, 116, 53, 68, 150, 150, 74, 150, 150, 150, 150, 150, 57, 150, 150, 135, 150, 150, 64, 127, 150, 52, 150, 150, 150, 82, 59, 150, 150, 137, 72, 82, 150, 119, 83, 150, 70, 150, 150, 60, 150, 83, 93, 64, 150, 150, 71, 72, 150, 150, 110], "policy_policy_0_reward": [-292.6496877073401, -120.04474496367392, -70.6438465277142, -1183.247393992005, -350.14069127363246, -562.2738087793034, -88.62957240681463, -155.15979376126896, -867.4906742772065, -1015.0394741165192, -144.37219531537718, -988.0342480402431, -759.4029419834972, -744.1589650516388, -1122.564751588118, -1213.7869033630275, -39.04524976214849, -805.9259471320595, -1116.1792866882702, -792.3068873255419, -591.2214550151474, -1333.0097242383715, -154.49591450840157, -722.1013377047065, -1107.2014846050279, -138.91399857297242, -987.4147299626636, -708.02719470395, -569.9214036313354, -263.68829868773724, -130.79614360398514, -895.9696445748975, -824.2231460593432, -737.2473624225031, -144.45640477383057, -269.3775627851471, -944.272308063288, -362.322191455441, -158.67678219993857, -1186.6891112111932, -177.20882050479761, -1015.2724598393302, -1076.839492274954, -65.92865183664561, -876.9682169949023, -263.6513332638362, -306.07227251588813, -156.63696292545285, -1263.2679066653354, -1005.8426482665483, -224.8285584054096, -146.46031418730664, -873.073041355191, -1115.4487717788766, -374.63889225780304]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5589145842605442, "mean_inference_ms": 1.6548909615804557, "mean_action_processing_ms": 0.27846835985486135, "mean_env_wait_ms": 3.3692009980484867, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013105219060724432, "StateBufferConnector_ms": 0.008674534884366121, "ViewRequirementAgentConnector_ms": 0.18834937702525745}, "num_episodes": 31, "episode_return_max": -39.04524976214849, "episode_return_min": -1333.0097242383715, "episode_return_mean": -610.9683928346828, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.10949919292045, "num_env_steps_trained_throughput_per_sec": 302.10949919292045, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13184.379, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13184.315, "sample_time_ms": 1124.044, "learn_time_ms": 11993.031, "learn_throughput": 333.527, "synch_weights_time_ms": 66.497}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00001", "date": "2024-08-04_05-33-29", "timestamp": 1722729809, "time_this_iter_s": 13.251944303512573, "time_total_s": 26.39077877998352, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16ee88b0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.39077877998352, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 17.45263157894737, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.547442859907946, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 7.621654630700747, "policy_loss": -0.011979598991941506, "vf_loss": 7.631549805402756, "vf_explained_var": 0.6412131909901897, "kl": 0.017755269487376307, "entropy": 1.4666298277676106, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -39.04524976214849, "episode_reward_min": -1333.0097242383715, "episode_reward_mean": -623.5899999875654, "episode_len_mean": 118.3409090909091, "episode_media": {}, "episodes_timesteps_total": 10414, "policy_reward_min": {"policy_0": -1333.0097242383715}, "policy_reward_max": {"policy_0": -39.04524976214849}, "policy_reward_mean": {"policy_0": -623.5899999875654}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-292.6496877073401, -120.04474496367392, -70.6438465277142, -1183.247393992005, -350.14069127363246, -562.2738087793034, -88.62957240681463, -155.15979376126896, -867.4906742772065, -1015.0394741165192, -144.37219531537718, -988.0342480402431, -759.4029419834972, -744.1589650516388, -1122.564751588118, -1213.7869033630275, -39.04524976214849, -805.9259471320595, -1116.1792866882702, -792.3068873255419, -591.2214550151474, -1333.0097242383715, -154.49591450840157, -722.1013377047065, -1107.2014846050279, -138.91399857297242, -987.4147299626636, -708.02719470395, -569.9214036313354, -263.68829868773724, -130.79614360398514, -895.9696445748975, -824.2231460593432, -737.2473624225031, -144.45640477383057, -269.3775627851471, -944.272308063288, -362.322191455441, -158.67678219993857, -1186.6891112111932, -177.20882050479761, -1015.2724598393302, -1076.839492274954, -65.92865183664561, -876.9682169949023, -263.6513332638362, -306.07227251588813, -156.63696292545285, -1263.2679066653354, -1005.8426482665483, -224.8285584054096, -146.46031418730664, -873.073041355191, -1115.4487717788766, -374.63889225780304, -211.2692463655718, -120.12094460008309, -553.8884400866033, -842.3570135826137, -1190.4295699495594, -690.9049983290149, -525.6897574958267, -278.42128446082603, -273.9532565623897, -1191.1698927701502, -886.5037111062294, -61.86518915476566, -1043.2626046521846, -51.97694377606088, -488.46509080568416, -836.1178000841481, -1283.2245421496964, -871.776629713226, -180.69858404819993, -1090.9168884398346, -862.9430816495426, -51.0090771781404, -122.75224727183931, -69.807170842094, -1013.7714991546992, -455.42284609723333, -1126.9040431083533, -893.2571591177191, -1138.6826184086985, -299.0534921253974, -398.9950705856657, -1096.949571890811, -1070.0981274353373], "episode_lengths": [79, 86, 45, 150, 86, 116, 53, 68, 150, 150, 74, 150, 150, 150, 150, 150, 57, 150, 150, 135, 150, 150, 64, 127, 150, 52, 150, 150, 150, 82, 59, 150, 150, 137, 72, 82, 150, 119, 83, 150, 70, 150, 150, 60, 150, 83, 93, 64, 150, 150, 71, 72, 150, 150, 110, 94, 59, 150, 150, 150, 150, 135, 96, 91, 150, 150, 66, 150, 44, 150, 150, 150, 150, 83, 150, 150, 46, 76, 38, 150, 150, 150, 150, 150, 87, 150, 150, 150], "policy_policy_0_reward": [-292.6496877073401, -120.04474496367392, -70.6438465277142, -1183.247393992005, -350.14069127363246, -562.2738087793034, -88.62957240681463, -155.15979376126896, -867.4906742772065, -1015.0394741165192, -144.37219531537718, -988.0342480402431, -759.4029419834972, -744.1589650516388, -1122.564751588118, -1213.7869033630275, -39.04524976214849, -805.9259471320595, -1116.1792866882702, -792.3068873255419, -591.2214550151474, -1333.0097242383715, -154.49591450840157, -722.1013377047065, -1107.2014846050279, -138.91399857297242, -987.4147299626636, -708.02719470395, -569.9214036313354, -263.68829868773724, -130.79614360398514, -895.9696445748975, -824.2231460593432, -737.2473624225031, -144.45640477383057, -269.3775627851471, -944.272308063288, -362.322191455441, -158.67678219993857, -1186.6891112111932, -177.20882050479761, -1015.2724598393302, -1076.839492274954, -65.92865183664561, -876.9682169949023, -263.6513332638362, -306.07227251588813, -156.63696292545285, -1263.2679066653354, -1005.8426482665483, -224.8285584054096, -146.46031418730664, -873.073041355191, -1115.4487717788766, -374.63889225780304, -211.2692463655718, -120.12094460008309, -553.8884400866033, -842.3570135826137, -1190.4295699495594, -690.9049983290149, -525.6897574958267, -278.42128446082603, -273.9532565623897, -1191.1698927701502, -886.5037111062294, -61.86518915476566, -1043.2626046521846, -51.97694377606088, -488.46509080568416, -836.1178000841481, -1283.2245421496964, -871.776629713226, -180.69858404819993, -1090.9168884398346, -862.9430816495426, -51.0090771781404, -122.75224727183931, -69.807170842094, -1013.7714991546992, -455.42284609723333, -1126.9040431083533, -893.2571591177191, -1138.6826184086985, -299.0534921253974, -398.9950705856657, -1096.949571890811, -1070.0981274353373]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5604977312982368, "mean_inference_ms": 1.6624983093213623, "mean_action_processing_ms": 0.27963987842549676, "mean_env_wait_ms": 3.3909768446107607, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.019064816561612217, "StateBufferConnector_ms": 0.008742917667735706, "ViewRequirementAgentConnector_ms": 0.1998977227644487}, "num_episodes": 33, "episode_return_max": -39.04524976214849, "episode_return_min": -1333.0097242383715, "episode_return_mean": -623.5899999875654, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.2723331696277, "num_env_steps_trained_throughput_per_sec": 295.2723331696277, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 13305.196, "restore_workers_time_ms": 0.026, "training_step_time_ms": 13305.129, "sample_time_ms": 1183.726, "learn_time_ms": 12055.874, "learn_throughput": 331.788, "synch_weights_time_ms": 64.785}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00001", "date": "2024-08-04_05-33-43", "timestamp": 1722729823, "time_this_iter_s": 13.559340238571167, "time_total_s": 39.95011901855469, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16eeb6d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 39.95011901855469, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 17.678947368421053, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 55.59290068993966, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.664051523307959, "policy_loss": -0.014893354591913521, "vf_loss": 5.677334166318178, "vf_explained_var": 0.7369579823687673, "kl": 0.015861602347649755, "entropy": 1.5615934252738952, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -16.855824165374905, "episode_reward_min": -1345.2180059881266, "episode_reward_mean": -696.9087426310238, "episode_len_mean": 124.35, "episode_media": {}, "episodes_timesteps_total": 12435, "policy_reward_min": {"policy_0": -1345.2180059881266}, "policy_reward_max": {"policy_0": -16.855824165374905}, "policy_reward_mean": {"policy_0": -696.9087426310238}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-792.3068873255419, -591.2214550151474, -1333.0097242383715, -154.49591450840157, -722.1013377047065, -1107.2014846050279, -138.91399857297242, -987.4147299626636, -708.02719470395, -569.9214036313354, -263.68829868773724, -130.79614360398514, -895.9696445748975, -824.2231460593432, -737.2473624225031, -144.45640477383057, -269.3775627851471, -944.272308063288, -362.322191455441, -158.67678219993857, -1186.6891112111932, -177.20882050479761, -1015.2724598393302, -1076.839492274954, -65.92865183664561, -876.9682169949023, -263.6513332638362, -306.07227251588813, -156.63696292545285, -1263.2679066653354, -1005.8426482665483, -224.8285584054096, -146.46031418730664, -873.073041355191, -1115.4487717788766, -374.63889225780304, -211.2692463655718, -120.12094460008309, -553.8884400866033, -842.3570135826137, -1190.4295699495594, -690.9049983290149, -525.6897574958267, -278.42128446082603, -273.9532565623897, -1191.1698927701502, -886.5037111062294, -61.86518915476566, -1043.2626046521846, -51.97694377606088, -488.46509080568416, -836.1178000841481, -1283.2245421496964, -871.776629713226, -180.69858404819993, -1090.9168884398346, -862.9430816495426, -51.0090771781404, -122.75224727183931, -69.807170842094, -1013.7714991546992, -455.42284609723333, -1126.9040431083533, -893.2571591177191, -1138.6826184086985, -299.0534921253974, -398.9950705856657, -1096.949571890811, -1070.0981274353373, -1010.9383993554608, -1309.5074990915061, -897.9158646689426, -920.0569428996941, -1160.85078106343, -1212.8715500415867, -216.59385602385817, -1063.703397654576, -211.60332736573068, -305.4933732118048, -793.4749649371425, -865.0211933779931, -903.9848182988184, -1214.0794874529427, -1123.992814606254, -716.0198613119426, -1259.0611058876038, -165.63176844338975, -378.1978891111559, -467.5390358314089, -1194.9011064892493, -1270.6710633992823, -958.0906317191834, -1000.7644981650241, -842.5987998809356, -16.855824165374905, -1066.6738330028406, -1345.2180059881266, -962.0696351629616, -890.4020908955762, -708.9610214226841], "episode_lengths": [135, 150, 150, 64, 127, 150, 52, 150, 150, 150, 82, 59, 150, 150, 137, 72, 82, 150, 119, 83, 150, 70, 150, 150, 60, 150, 83, 93, 64, 150, 150, 71, 72, 150, 150, 110, 94, 59, 150, 150, 150, 150, 135, 96, 91, 150, 150, 66, 150, 44, 150, 150, 150, 150, 83, 150, 150, 46, 76, 38, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 82, 101, 150, 150, 150, 150, 150, 150, 150, 74, 96, 115, 150, 150, 150, 150, 150, 34, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-792.3068873255419, -591.2214550151474, -1333.0097242383715, -154.49591450840157, -722.1013377047065, -1107.2014846050279, -138.91399857297242, -987.4147299626636, -708.02719470395, -569.9214036313354, -263.68829868773724, -130.79614360398514, -895.9696445748975, -824.2231460593432, -737.2473624225031, -144.45640477383057, -269.3775627851471, -944.272308063288, -362.322191455441, -158.67678219993857, -1186.6891112111932, -177.20882050479761, -1015.2724598393302, -1076.839492274954, -65.92865183664561, -876.9682169949023, -263.6513332638362, -306.07227251588813, -156.63696292545285, -1263.2679066653354, -1005.8426482665483, -224.8285584054096, -146.46031418730664, -873.073041355191, -1115.4487717788766, -374.63889225780304, -211.2692463655718, -120.12094460008309, -553.8884400866033, -842.3570135826137, -1190.4295699495594, -690.9049983290149, -525.6897574958267, -278.42128446082603, -273.9532565623897, -1191.1698927701502, -886.5037111062294, -61.86518915476566, -1043.2626046521846, -51.97694377606088, -488.46509080568416, -836.1178000841481, -1283.2245421496964, -871.776629713226, -180.69858404819993, -1090.9168884398346, -862.9430816495426, -51.0090771781404, -122.75224727183931, -69.807170842094, -1013.7714991546992, -455.42284609723333, -1126.9040431083533, -893.2571591177191, -1138.6826184086985, -299.0534921253974, -398.9950705856657, -1096.949571890811, -1070.0981274353373, -1010.9383993554608, -1309.5074990915061, -897.9158646689426, -920.0569428996941, -1160.85078106343, -1212.8715500415867, -216.59385602385817, -1063.703397654576, -211.60332736573068, -305.4933732118048, -793.4749649371425, -865.0211933779931, -903.9848182988184, -1214.0794874529427, -1123.992814606254, -716.0198613119426, -1259.0611058876038, -165.63176844338975, -378.1978891111559, -467.5390358314089, -1194.9011064892493, -1270.6710633992823, -958.0906317191834, -1000.7644981650241, -842.5987998809356, -16.855824165374905, -1066.6738330028406, -1345.2180059881266, -962.0696351629616, -890.4020908955762, -708.9610214226841]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5606445698233811, "mean_inference_ms": 1.6679746136375357, "mean_action_processing_ms": 0.28046112160252523, "mean_env_wait_ms": 3.4079487543217972, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018462657928466797, "StateBufferConnector_ms": 0.008832454681396484, "ViewRequirementAgentConnector_ms": 0.19838452339172363}, "num_episodes": 31, "episode_return_max": -16.855824165374905, "episode_return_min": -1345.2180059881266, "episode_return_mean": -696.9087426310238, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.50101407677886, "num_env_steps_trained_throughput_per_sec": 304.50101407677886, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 13262.961, "restore_workers_time_ms": 0.027, "training_step_time_ms": 13262.894, "sample_time_ms": 1172.328, "learn_time_ms": 12025.22, "learn_throughput": 332.634, "synch_weights_time_ms": 64.604}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00001", "date": "2024-08-04_05-33-56", "timestamp": 1722729836, "time_this_iter_s": 13.150669574737549, "time_total_s": 53.100788593292236, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5c280>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 53.100788593292236, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 17.615789473684213, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 107.68902410070102, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 5.421652489403884, "policy_loss": -0.00872190614415255, "vf_loss": 5.4286515362560746, "vf_explained_var": 0.9026329718530178, "kl": 0.01614484914525747, "entropy": 1.5060992505401374, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -16.855824165374905, "episode_reward_min": -1345.2180059881266, "episode_reward_mean": -763.5426705868412, "episode_len_mean": 128.71, "episode_media": {}, "episodes_timesteps_total": 12871, "policy_reward_min": {"policy_0": -1345.2180059881266}, "policy_reward_max": {"policy_0": -16.855824165374905}, "policy_reward_mean": {"policy_0": -763.5426705868412}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-156.63696292545285, -1263.2679066653354, -1005.8426482665483, -224.8285584054096, -146.46031418730664, -873.073041355191, -1115.4487717788766, -374.63889225780304, -211.2692463655718, -120.12094460008309, -553.8884400866033, -842.3570135826137, -1190.4295699495594, -690.9049983290149, -525.6897574958267, -278.42128446082603, -273.9532565623897, -1191.1698927701502, -886.5037111062294, -61.86518915476566, -1043.2626046521846, -51.97694377606088, -488.46509080568416, -836.1178000841481, -1283.2245421496964, -871.776629713226, -180.69858404819993, -1090.9168884398346, -862.9430816495426, -51.0090771781404, -122.75224727183931, -69.807170842094, -1013.7714991546992, -455.42284609723333, -1126.9040431083533, -893.2571591177191, -1138.6826184086985, -299.0534921253974, -398.9950705856657, -1096.949571890811, -1070.0981274353373, -1010.9383993554608, -1309.5074990915061, -897.9158646689426, -920.0569428996941, -1160.85078106343, -1212.8715500415867, -216.59385602385817, -1063.703397654576, -211.60332736573068, -305.4933732118048, -793.4749649371425, -865.0211933779931, -903.9848182988184, -1214.0794874529427, -1123.992814606254, -716.0198613119426, -1259.0611058876038, -165.63176844338975, -378.1978891111559, -467.5390358314089, -1194.9011064892493, -1270.6710633992823, -958.0906317191834, -1000.7644981650241, -842.5987998809356, -16.855824165374905, -1066.6738330028406, -1345.2180059881266, -962.0696351629616, -890.4020908955762, -708.9610214226841, -1167.9225448353025, -972.6529987688821, -1029.19208521455, -930.7867097205128, -744.9677903539352, -135.25131099959725, -998.489425784437, -804.2758570915994, -1096.407365333742, -1253.5270424739047, -1054.7965441439303, -19.52247818838149, -169.88968609017198, -1130.3612732265935, -232.15150682477883, -1148.3197997405587, -1213.1760396206066, -474.5956310291907, -678.8622355247245, -1098.8366938863999, -1113.6256863899278, -996.2896889035411, -206.65819569934425, -1001.5944853741444, -761.8971197504445, -913.1152139165064, -1281.6143053483345, -838.8874146834603], "episode_lengths": [64, 150, 150, 71, 72, 150, 150, 110, 94, 59, 150, 150, 150, 150, 135, 96, 91, 150, 150, 66, 150, 44, 150, 150, 150, 150, 83, 150, 150, 46, 76, 38, 150, 150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 82, 101, 150, 150, 150, 150, 150, 150, 150, 74, 96, 115, 150, 150, 150, 150, 150, 34, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 61, 150, 150, 150, 150, 150, 38, 75, 150, 79, 150, 150, 98, 127, 150, 150, 150, 88, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-156.63696292545285, -1263.2679066653354, -1005.8426482665483, -224.8285584054096, -146.46031418730664, -873.073041355191, -1115.4487717788766, -374.63889225780304, -211.2692463655718, -120.12094460008309, -553.8884400866033, -842.3570135826137, -1190.4295699495594, -690.9049983290149, -525.6897574958267, -278.42128446082603, -273.9532565623897, -1191.1698927701502, -886.5037111062294, -61.86518915476566, -1043.2626046521846, -51.97694377606088, -488.46509080568416, -836.1178000841481, -1283.2245421496964, -871.776629713226, -180.69858404819993, -1090.9168884398346, -862.9430816495426, -51.0090771781404, -122.75224727183931, -69.807170842094, -1013.7714991546992, -455.42284609723333, -1126.9040431083533, -893.2571591177191, -1138.6826184086985, -299.0534921253974, -398.9950705856657, -1096.949571890811, -1070.0981274353373, -1010.9383993554608, -1309.5074990915061, -897.9158646689426, -920.0569428996941, -1160.85078106343, -1212.8715500415867, -216.59385602385817, -1063.703397654576, -211.60332736573068, -305.4933732118048, -793.4749649371425, -865.0211933779931, -903.9848182988184, -1214.0794874529427, -1123.992814606254, -716.0198613119426, -1259.0611058876038, -165.63176844338975, -378.1978891111559, -467.5390358314089, -1194.9011064892493, -1270.6710633992823, -958.0906317191834, -1000.7644981650241, -842.5987998809356, -16.855824165374905, -1066.6738330028406, -1345.2180059881266, -962.0696351629616, -890.4020908955762, -708.9610214226841, -1167.9225448353025, -972.6529987688821, -1029.19208521455, -930.7867097205128, -744.9677903539352, -135.25131099959725, -998.489425784437, -804.2758570915994, -1096.407365333742, -1253.5270424739047, -1054.7965441439303, -19.52247818838149, -169.88968609017198, -1130.3612732265935, -232.15150682477883, -1148.3197997405587, -1213.1760396206066, -474.5956310291907, -678.8622355247245, -1098.8366938863999, -1113.6256863899278, -996.2896889035411, -206.65819569934425, -1001.5944853741444, -761.8971197504445, -913.1152139165064, -1281.6143053483345, -838.8874146834603]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5625144501501051, "mean_inference_ms": 1.6768721042580923, "mean_action_processing_ms": 0.2826740161846133, "mean_env_wait_ms": 3.435546488623229, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.018110990524291992, "StateBufferConnector_ms": 0.008890867233276367, "ViewRequirementAgentConnector_ms": 0.19871068000793457}, "num_episodes": 28, "episode_return_max": -16.855824165374905, "episode_return_min": -1345.2180059881266, "episode_return_mean": -763.5426705868412, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.9645525382839, "num_env_steps_trained_throughput_per_sec": 299.9645525382839, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 13277.354, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13277.282, "sample_time_ms": 1163.323, "learn_time_ms": 12047.272, "learn_throughput": 332.025, "synch_weights_time_ms": 65.919}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00001", "date": "2024-08-04_05-34-09", "timestamp": 1722729849, "time_this_iter_s": 13.34852647781372, "time_total_s": 66.44931507110596, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5ca60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 66.44931507110596, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 17.736842105263158, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 112.91670690178871, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 4.506037391722202, "policy_loss": -0.0064506468484372215, "vf_loss": 4.511432130138079, "vf_explained_var": 0.9274169808874527, "kl": 0.012581431147615755, "entropy": 1.4603691074997187, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -16.855824165374905, "episode_reward_min": -1345.2180059881266, "episode_reward_mean": -797.6608238308437, "episode_len_mean": 131.24, "episode_media": {}, "episodes_timesteps_total": 13124, "policy_reward_min": {"policy_0": -1345.2180059881266}, "policy_reward_max": {"policy_0": -16.855824165374905}, "policy_reward_mean": {"policy_0": -797.6608238308437}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-455.42284609723333, -1126.9040431083533, -893.2571591177191, -1138.6826184086985, -299.0534921253974, -398.9950705856657, -1096.949571890811, -1070.0981274353373, -1010.9383993554608, -1309.5074990915061, -897.9158646689426, -920.0569428996941, -1160.85078106343, -1212.8715500415867, -216.59385602385817, -1063.703397654576, -211.60332736573068, -305.4933732118048, -793.4749649371425, -865.0211933779931, -903.9848182988184, -1214.0794874529427, -1123.992814606254, -716.0198613119426, -1259.0611058876038, -165.63176844338975, -378.1978891111559, -467.5390358314089, -1194.9011064892493, -1270.6710633992823, -958.0906317191834, -1000.7644981650241, -842.5987998809356, -16.855824165374905, -1066.6738330028406, -1345.2180059881266, -962.0696351629616, -890.4020908955762, -708.9610214226841, -1167.9225448353025, -972.6529987688821, -1029.19208521455, -930.7867097205128, -744.9677903539352, -135.25131099959725, -998.489425784437, -804.2758570915994, -1096.407365333742, -1253.5270424739047, -1054.7965441439303, -19.52247818838149, -169.88968609017198, -1130.3612732265935, -232.15150682477883, -1148.3197997405587, -1213.1760396206066, -474.5956310291907, -678.8622355247245, -1098.8366938863999, -1113.6256863899278, -996.2896889035411, -206.65819569934425, -1001.5944853741444, -761.8971197504445, -913.1152139165064, -1281.6143053483345, -838.8874146834603, -655.1592342285755, -978.774891197736, -484.4750358529028, -552.0085225570256, -25.367656304761343, -565.4793792124452, -144.28550814052977, -690.8861234489407, -1235.4653799432392, -289.7531347419419, -1284.1646186806015, -868.1214117830075, -1157.1302431738218, -1141.9594686943071, -887.9659483359271, -1268.1877854416075, -867.8507350321509, -973.1847591384292, -315.14086692980686, -1105.4442149961842, -518.177411664716, -1101.1972355798878, -184.58461114965186, -185.52762010607012, -88.81361433267051, -939.3843017914141, -1027.7184775380574, -1140.4543974568953, -484.06457546223055, -1071.2855216669032, -935.1253518504301, -169.42161356457044, -28.748234473757407], "episode_lengths": [150, 150, 150, 150, 87, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 82, 101, 150, 150, 150, 150, 150, 150, 150, 74, 96, 115, 150, 150, 150, 150, 150, 34, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 61, 150, 150, 150, 150, 150, 38, 75, 150, 79, 150, 150, 98, 127, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 112, 150, 44, 150, 54, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 113, 150, 58, 62, 69, 150, 150, 150, 104, 150, 150, 86, 39], "policy_policy_0_reward": [-455.42284609723333, -1126.9040431083533, -893.2571591177191, -1138.6826184086985, -299.0534921253974, -398.9950705856657, -1096.949571890811, -1070.0981274353373, -1010.9383993554608, -1309.5074990915061, -897.9158646689426, -920.0569428996941, -1160.85078106343, -1212.8715500415867, -216.59385602385817, -1063.703397654576, -211.60332736573068, -305.4933732118048, -793.4749649371425, -865.0211933779931, -903.9848182988184, -1214.0794874529427, -1123.992814606254, -716.0198613119426, -1259.0611058876038, -165.63176844338975, -378.1978891111559, -467.5390358314089, -1194.9011064892493, -1270.6710633992823, -958.0906317191834, -1000.7644981650241, -842.5987998809356, -16.855824165374905, -1066.6738330028406, -1345.2180059881266, -962.0696351629616, -890.4020908955762, -708.9610214226841, -1167.9225448353025, -972.6529987688821, -1029.19208521455, -930.7867097205128, -744.9677903539352, -135.25131099959725, -998.489425784437, -804.2758570915994, -1096.407365333742, -1253.5270424739047, -1054.7965441439303, -19.52247818838149, -169.88968609017198, -1130.3612732265935, -232.15150682477883, -1148.3197997405587, -1213.1760396206066, -474.5956310291907, -678.8622355247245, -1098.8366938863999, -1113.6256863899278, -996.2896889035411, -206.65819569934425, -1001.5944853741444, -761.8971197504445, -913.1152139165064, -1281.6143053483345, -838.8874146834603, -655.1592342285755, -978.774891197736, -484.4750358529028, -552.0085225570256, -25.367656304761343, -565.4793792124452, -144.28550814052977, -690.8861234489407, -1235.4653799432392, -289.7531347419419, -1284.1646186806015, -868.1214117830075, -1157.1302431738218, -1141.9594686943071, -887.9659483359271, -1268.1877854416075, -867.8507350321509, -973.1847591384292, -315.14086692980686, -1105.4442149961842, -518.177411664716, -1101.1972355798878, -184.58461114965186, -185.52762010607012, -88.81361433267051, -939.3843017914141, -1027.7184775380574, -1140.4543974568953, -484.06457546223055, -1071.2855216669032, -935.1253518504301, -169.42161356457044, -28.748234473757407]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5627971364453268, "mean_inference_ms": 1.6839049208722274, "mean_action_processing_ms": 0.28433162355989977, "mean_env_wait_ms": 3.4561441687943546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012519121170043945, "StateBufferConnector_ms": 0.008862495422363281, "ViewRequirementAgentConnector_ms": 0.1930067539215088}, "num_episodes": 33, "episode_return_max": -16.855824165374905, "episode_return_min": -1345.2180059881266, "episode_return_mean": -797.6608238308437, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.45925736231464, "num_env_steps_trained_throughput_per_sec": 307.45925736231464, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 13232.773, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13232.701, "sample_time_ms": 1157.665, "learn_time_ms": 12009.658, "learn_throughput": 333.065, "synch_weights_time_ms": 64.593}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00001", "date": "2024-08-04_05-34-22", "timestamp": 1722729862, "time_this_iter_s": 13.021614789962769, "time_total_s": 79.47092986106873, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5d630>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 79.47092986106873, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.584210526315786, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 169.08772806922596, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.510919666911165, "policy_loss": -0.014898398431250825, "vf_loss": 3.5235866681983072, "vf_explained_var": 0.9671612640221914, "kl": 0.018346377938723894, "entropy": 1.4378721233457328, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -16.855824165374905, "episode_reward_min": -1391.084695067046, "episode_reward_mean": -761.0726789141266, "episode_len_mean": 128.44, "episode_media": {}, "episodes_timesteps_total": 12844, "policy_reward_min": {"policy_0": -1391.084695067046}, "policy_reward_max": {"policy_0": -16.855824165374905}, "policy_reward_mean": {"policy_0": -761.0726789141266}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1000.7644981650241, -842.5987998809356, -16.855824165374905, -1066.6738330028406, -1345.2180059881266, -962.0696351629616, -890.4020908955762, -708.9610214226841, -1167.9225448353025, -972.6529987688821, -1029.19208521455, -930.7867097205128, -744.9677903539352, -135.25131099959725, -998.489425784437, -804.2758570915994, -1096.407365333742, -1253.5270424739047, -1054.7965441439303, -19.52247818838149, -169.88968609017198, -1130.3612732265935, -232.15150682477883, -1148.3197997405587, -1213.1760396206066, -474.5956310291907, -678.8622355247245, -1098.8366938863999, -1113.6256863899278, -996.2896889035411, -206.65819569934425, -1001.5944853741444, -761.8971197504445, -913.1152139165064, -1281.6143053483345, -838.8874146834603, -655.1592342285755, -978.774891197736, -484.4750358529028, -552.0085225570256, -25.367656304761343, -565.4793792124452, -144.28550814052977, -690.8861234489407, -1235.4653799432392, -289.7531347419419, -1284.1646186806015, -868.1214117830075, -1157.1302431738218, -1141.9594686943071, -887.9659483359271, -1268.1877854416075, -867.8507350321509, -973.1847591384292, -315.14086692980686, -1105.4442149961842, -518.177411664716, -1101.1972355798878, -184.58461114965186, -185.52762010607012, -88.81361433267051, -939.3843017914141, -1027.7184775380574, -1140.4543974568953, -484.06457546223055, -1071.2855216669032, -935.1253518504301, -169.42161356457044, -28.748234473757407, -1057.9306016441576, -823.8640417992871, -907.240605200498, -1052.2802067796679, -24.75398612404603, -678.2145661806354, -1022.5932048735004, -818.9712331355714, -1391.084695067046, -853.5103911902069, -1218.0349503647499, -591.1150473866907, -759.0439554867571, -361.6501353469204, -1100.4051287187367, -1025.0905559470891, -562.6466381104516, -110.32449062251926, -749.9774465202364, -980.1604480882771, -145.5561550960676, -659.9399897084187, -943.1188859043277, -1100.868505570145, -106.75469806914445, -87.50901585860656, -657.252973825607, -705.6902878366391, -26.46384842176901, -1296.40676876115, -622.2957117015166], "episode_lengths": [150, 150, 34, 150, 150, 150, 150, 150, 150, 150, 150, 150, 138, 61, 150, 150, 150, 150, 150, 38, 75, 150, 79, 150, 150, 98, 127, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 150, 112, 150, 44, 150, 54, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 113, 150, 58, 62, 69, 150, 150, 150, 104, 150, 150, 86, 39, 150, 150, 150, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 110, 48, 150, 150, 57, 150, 150, 150, 69, 44, 150, 150, 33, 150, 150], "policy_policy_0_reward": [-1000.7644981650241, -842.5987998809356, -16.855824165374905, -1066.6738330028406, -1345.2180059881266, -962.0696351629616, -890.4020908955762, -708.9610214226841, -1167.9225448353025, -972.6529987688821, -1029.19208521455, -930.7867097205128, -744.9677903539352, -135.25131099959725, -998.489425784437, -804.2758570915994, -1096.407365333742, -1253.5270424739047, -1054.7965441439303, -19.52247818838149, -169.88968609017198, -1130.3612732265935, -232.15150682477883, -1148.3197997405587, -1213.1760396206066, -474.5956310291907, -678.8622355247245, -1098.8366938863999, -1113.6256863899278, -996.2896889035411, -206.65819569934425, -1001.5944853741444, -761.8971197504445, -913.1152139165064, -1281.6143053483345, -838.8874146834603, -655.1592342285755, -978.774891197736, -484.4750358529028, -552.0085225570256, -25.367656304761343, -565.4793792124452, -144.28550814052977, -690.8861234489407, -1235.4653799432392, -289.7531347419419, -1284.1646186806015, -868.1214117830075, -1157.1302431738218, -1141.9594686943071, -887.9659483359271, -1268.1877854416075, -867.8507350321509, -973.1847591384292, -315.14086692980686, -1105.4442149961842, -518.177411664716, -1101.1972355798878, -184.58461114965186, -185.52762010607012, -88.81361433267051, -939.3843017914141, -1027.7184775380574, -1140.4543974568953, -484.06457546223055, -1071.2855216669032, -935.1253518504301, -169.42161356457044, -28.748234473757407, -1057.9306016441576, -823.8640417992871, -907.240605200498, -1052.2802067796679, -24.75398612404603, -678.2145661806354, -1022.5932048735004, -818.9712331355714, -1391.084695067046, -853.5103911902069, -1218.0349503647499, -591.1150473866907, -759.0439554867571, -361.6501353469204, -1100.4051287187367, -1025.0905559470891, -562.6466381104516, -110.32449062251926, -749.9774465202364, -980.1604480882771, -145.5561550960676, -659.9399897084187, -943.1188859043277, -1100.868505570145, -106.75469806914445, -87.50901585860656, -657.252973825607, -705.6902878366391, -26.46384842176901, -1296.40676876115, -622.2957117015166]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.562228603058566, "mean_inference_ms": 1.685661403905023, "mean_action_processing_ms": 0.28405174433131614, "mean_env_wait_ms": 3.466132260157104, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012675285339355469, "StateBufferConnector_ms": 0.008663415908813477, "ViewRequirementAgentConnector_ms": 0.19026780128479004}, "num_episodes": 31, "episode_return_max": -16.855824165374905, "episode_return_min": -1391.084695067046, "episode_return_mean": -761.0726789141266, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.5453394337915, "num_env_steps_trained_throughput_per_sec": 310.5453394337915, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 13182.459, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13182.388, "sample_time_ms": 1154.84, "learn_time_ms": 11961.565, "learn_throughput": 334.404, "synch_weights_time_ms": 65.196}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00001", "date": "2024-08-04_05-34-35", "timestamp": 1722729875, "time_this_iter_s": 12.892951250076294, "time_total_s": 92.36388111114502, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16eeb370>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 92.36388111114502, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 17.777777777777775, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 147.83257473111152, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.68935755752027, "policy_loss": -0.0024693789217659894, "vf_loss": 3.6905576016753914, "vf_explained_var": 0.9547197584683697, "kl": 0.013702874032514956, "entropy": 1.471244448547562, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -24.75398612404603, "episode_reward_min": -1391.084695067046, "episode_reward_mean": -715.2356428029151, "episode_len_mean": 128.06, "episode_media": {}, "episodes_timesteps_total": 12806, "policy_reward_min": {"policy_0": -1391.084695067046}, "policy_reward_max": {"policy_0": -24.75398612404603}, "policy_reward_mean": {"policy_0": -715.2356428029151}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1001.5944853741444, -761.8971197504445, -913.1152139165064, -1281.6143053483345, -838.8874146834603, -655.1592342285755, -978.774891197736, -484.4750358529028, -552.0085225570256, -25.367656304761343, -565.4793792124452, -144.28550814052977, -690.8861234489407, -1235.4653799432392, -289.7531347419419, -1284.1646186806015, -868.1214117830075, -1157.1302431738218, -1141.9594686943071, -887.9659483359271, -1268.1877854416075, -867.8507350321509, -973.1847591384292, -315.14086692980686, -1105.4442149961842, -518.177411664716, -1101.1972355798878, -184.58461114965186, -185.52762010607012, -88.81361433267051, -939.3843017914141, -1027.7184775380574, -1140.4543974568953, -484.06457546223055, -1071.2855216669032, -935.1253518504301, -169.42161356457044, -28.748234473757407, -1057.9306016441576, -823.8640417992871, -907.240605200498, -1052.2802067796679, -24.75398612404603, -678.2145661806354, -1022.5932048735004, -818.9712331355714, -1391.084695067046, -853.5103911902069, -1218.0349503647499, -591.1150473866907, -759.0439554867571, -361.6501353469204, -1100.4051287187367, -1025.0905559470891, -562.6466381104516, -110.32449062251926, -749.9774465202364, -980.1604480882771, -145.5561550960676, -659.9399897084187, -943.1188859043277, -1100.868505570145, -106.75469806914445, -87.50901585860656, -657.252973825607, -705.6902878366391, -26.46384842176901, -1296.40676876115, -622.2957117015166, -135.68685872364208, -1014.2655148784634, -1038.8903974918983, -468.56990718274267, -465.64680465554693, -589.4312206825397, -114.4700761755947, -604.6441790327879, -573.7357803490432, -655.7427996913782, -606.6725477918422, -1165.5046209218578, -844.1942681384201, -146.56125829401603, -927.7965183664448, -360.274539788645, -713.4714610529072, -311.134286947024, -74.23420615551547, -1162.1454151438504, -403.75589708961826, -748.2451893210485, -1086.7450481345643, -1189.5061317524317, -1095.6422988236932, -1269.4657836840154, -268.1435202650095, -453.0372132141015, -407.87889621545565, -961.5144441144797, -1063.3916033284097], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 112, 150, 44, 150, 54, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 97, 150, 113, 150, 58, 62, 69, 150, 150, 150, 104, 150, 150, 86, 39, 150, 150, 150, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 110, 48, 150, 150, 57, 150, 150, 150, 69, 44, 150, 150, 33, 150, 150, 53, 150, 150, 150, 97, 150, 61, 124, 150, 150, 112, 150, 150, 82, 150, 96, 139, 112, 52, 150, 122, 150, 150, 150, 150, 150, 105, 145, 150, 150, 150], "policy_policy_0_reward": [-1001.5944853741444, -761.8971197504445, -913.1152139165064, -1281.6143053483345, -838.8874146834603, -655.1592342285755, -978.774891197736, -484.4750358529028, -552.0085225570256, -25.367656304761343, -565.4793792124452, -144.28550814052977, -690.8861234489407, -1235.4653799432392, -289.7531347419419, -1284.1646186806015, -868.1214117830075, -1157.1302431738218, -1141.9594686943071, -887.9659483359271, -1268.1877854416075, -867.8507350321509, -973.1847591384292, -315.14086692980686, -1105.4442149961842, -518.177411664716, -1101.1972355798878, -184.58461114965186, -185.52762010607012, -88.81361433267051, -939.3843017914141, -1027.7184775380574, -1140.4543974568953, -484.06457546223055, -1071.2855216669032, -935.1253518504301, -169.42161356457044, -28.748234473757407, -1057.9306016441576, -823.8640417992871, -907.240605200498, -1052.2802067796679, -24.75398612404603, -678.2145661806354, -1022.5932048735004, -818.9712331355714, -1391.084695067046, -853.5103911902069, -1218.0349503647499, -591.1150473866907, -759.0439554867571, -361.6501353469204, -1100.4051287187367, -1025.0905559470891, -562.6466381104516, -110.32449062251926, -749.9774465202364, -980.1604480882771, -145.5561550960676, -659.9399897084187, -943.1188859043277, -1100.868505570145, -106.75469806914445, -87.50901585860656, -657.252973825607, -705.6902878366391, -26.46384842176901, -1296.40676876115, -622.2957117015166, -135.68685872364208, -1014.2655148784634, -1038.8903974918983, -468.56990718274267, -465.64680465554693, -589.4312206825397, -114.4700761755947, -604.6441790327879, -573.7357803490432, -655.7427996913782, -606.6725477918422, -1165.5046209218578, -844.1942681384201, -146.56125829401603, -927.7965183664448, -360.274539788645, -713.4714610529072, -311.134286947024, -74.23420615551547, -1162.1454151438504, -403.75589708961826, -748.2451893210485, -1086.7450481345643, -1189.5061317524317, -1095.6422988236932, -1269.4657836840154, -268.1435202650095, -453.0372132141015, -407.87889621545565, -961.5144441144797, -1063.3916033284097]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5606894704402783, "mean_inference_ms": 1.6848617099984182, "mean_action_processing_ms": 0.28288423815008285, "mean_env_wait_ms": 3.469655297281323, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012583255767822266, "StateBufferConnector_ms": 0.008424758911132812, "ViewRequirementAgentConnector_ms": 0.19045233726501465}, "num_episodes": 31, "episode_return_max": -24.75398612404603, "episode_return_min": -1391.084695067046, "episode_return_mean": -715.2356428029151, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.4731557286592, "num_env_steps_trained_throughput_per_sec": 299.4731557286592, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 13204.252, "restore_workers_time_ms": 0.029, "training_step_time_ms": 13204.181, "sample_time_ms": 1155.0, "learn_time_ms": 11984.419, "learn_throughput": 333.767, "synch_weights_time_ms": 63.967}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00001", "date": "2024-08-04_05-34-49", "timestamp": 1722729889, "time_this_iter_s": 13.369243621826172, "time_total_s": 105.73312473297119, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16eeab00>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 105.73312473297119, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 17.678947368421053, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 196.89506860574087, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 3.0874336447566746, "policy_loss": -0.00667255338000056, "vf_loss": 3.0914888833959897, "vf_explained_var": 0.9863362026090423, "kl": 0.020377306900915458, "entropy": 1.4581472576906285, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -24.75398612404603, "episode_reward_min": -1391.084695067046, "episode_reward_mean": -730.3583011698723, "episode_len_mean": 128.88, "episode_media": {}, "episodes_timesteps_total": 12888, "policy_reward_min": {"policy_0": -1391.084695067046}, "policy_reward_max": {"policy_0": -24.75398612404603}, "policy_reward_mean": {"policy_0": -730.3583011698723}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-88.81361433267051, -939.3843017914141, -1027.7184775380574, -1140.4543974568953, -484.06457546223055, -1071.2855216669032, -935.1253518504301, -169.42161356457044, -28.748234473757407, -1057.9306016441576, -823.8640417992871, -907.240605200498, -1052.2802067796679, -24.75398612404603, -678.2145661806354, -1022.5932048735004, -818.9712331355714, -1391.084695067046, -853.5103911902069, -1218.0349503647499, -591.1150473866907, -759.0439554867571, -361.6501353469204, -1100.4051287187367, -1025.0905559470891, -562.6466381104516, -110.32449062251926, -749.9774465202364, -980.1604480882771, -145.5561550960676, -659.9399897084187, -943.1188859043277, -1100.868505570145, -106.75469806914445, -87.50901585860656, -657.252973825607, -705.6902878366391, -26.46384842176901, -1296.40676876115, -622.2957117015166, -135.68685872364208, -1014.2655148784634, -1038.8903974918983, -468.56990718274267, -465.64680465554693, -589.4312206825397, -114.4700761755947, -604.6441790327879, -573.7357803490432, -655.7427996913782, -606.6725477918422, -1165.5046209218578, -844.1942681384201, -146.56125829401603, -927.7965183664448, -360.274539788645, -713.4714610529072, -311.134286947024, -74.23420615551547, -1162.1454151438504, -403.75589708961826, -748.2451893210485, -1086.7450481345643, -1189.5061317524317, -1095.6422988236932, -1269.4657836840154, -268.1435202650095, -453.0372132141015, -407.87889621545565, -961.5144441144797, -1063.3916033284097, -925.3849426227367, -735.8437532260516, -1018.5240264729373, -956.6941043868237, -1081.9135453666206, -729.2551328547881, -778.262005347457, -1030.3161243611555, -409.35075528986704, -958.0714523476704, -375.4023900656976, -999.4680442255411, -1043.523059290489, -1375.4039536194032, -26.44992838255653, -74.6701323797025, -1270.772585423954, -358.13880068711364, -1288.1448140480527, -645.0107088528526, -106.79289838102274, -1256.1231262965614, -826.4158538608267, -130.37996061512717, -1332.5198584733814, -999.0995249865615, -1223.811905146581, -489.0042088085882, -1344.9185762827565], "episode_lengths": [69, 150, 150, 150, 104, 150, 150, 86, 39, 150, 150, 150, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 103, 150, 150, 110, 48, 150, 150, 57, 150, 150, 150, 69, 44, 150, 150, 33, 150, 150, 53, 150, 150, 150, 97, 150, 61, 124, 150, 150, 112, 150, 150, 82, 150, 96, 139, 112, 52, 150, 122, 150, 150, 150, 150, 150, 105, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 44, 56, 150, 87, 150, 150, 62, 150, 150, 75, 150, 150, 150, 127, 150], "policy_policy_0_reward": [-88.81361433267051, -939.3843017914141, -1027.7184775380574, -1140.4543974568953, -484.06457546223055, -1071.2855216669032, -935.1253518504301, -169.42161356457044, -28.748234473757407, -1057.9306016441576, -823.8640417992871, -907.240605200498, -1052.2802067796679, -24.75398612404603, -678.2145661806354, -1022.5932048735004, -818.9712331355714, -1391.084695067046, -853.5103911902069, -1218.0349503647499, -591.1150473866907, -759.0439554867571, -361.6501353469204, -1100.4051287187367, -1025.0905559470891, -562.6466381104516, -110.32449062251926, -749.9774465202364, -980.1604480882771, -145.5561550960676, -659.9399897084187, -943.1188859043277, -1100.868505570145, -106.75469806914445, -87.50901585860656, -657.252973825607, -705.6902878366391, -26.46384842176901, -1296.40676876115, -622.2957117015166, -135.68685872364208, -1014.2655148784634, -1038.8903974918983, -468.56990718274267, -465.64680465554693, -589.4312206825397, -114.4700761755947, -604.6441790327879, -573.7357803490432, -655.7427996913782, -606.6725477918422, -1165.5046209218578, -844.1942681384201, -146.56125829401603, -927.7965183664448, -360.274539788645, -713.4714610529072, -311.134286947024, -74.23420615551547, -1162.1454151438504, -403.75589708961826, -748.2451893210485, -1086.7450481345643, -1189.5061317524317, -1095.6422988236932, -1269.4657836840154, -268.1435202650095, -453.0372132141015, -407.87889621545565, -961.5144441144797, -1063.3916033284097, -925.3849426227367, -735.8437532260516, -1018.5240264729373, -956.6941043868237, -1081.9135453666206, -729.2551328547881, -778.262005347457, -1030.3161243611555, -409.35075528986704, -958.0714523476704, -375.4023900656976, -999.4680442255411, -1043.523059290489, -1375.4039536194032, -26.44992838255653, -74.6701323797025, -1270.772585423954, -358.13880068711364, -1288.1448140480527, -645.0107088528526, -106.79289838102274, -1256.1231262965614, -826.4158538608267, -130.37996061512717, -1332.5198584733814, -999.0995249865615, -1223.811905146581, -489.0042088085882, -1344.9185762827565]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5587311155244798, "mean_inference_ms": 1.68180656667457, "mean_action_processing_ms": 0.2816187276926726, "mean_env_wait_ms": 3.466961872006518, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012404918670654297, "StateBufferConnector_ms": 0.00825953483581543, "ViewRequirementAgentConnector_ms": 0.19192075729370117}, "num_episodes": 29, "episode_return_max": -24.75398612404603, "episode_return_min": -1391.084695067046, "episode_return_mean": -730.3583011698723, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.69976918498173, "num_env_steps_trained_throughput_per_sec": 298.69976918498173, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 13225.045, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13224.975, "sample_time_ms": 1153.809, "learn_time_ms": 12005.801, "learn_throughput": 333.172, "synch_weights_time_ms": 64.575}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00001", "date": "2024-08-04_05-35-02", "timestamp": 1722729902, "time_this_iter_s": 13.404238224029541, "time_total_s": 119.13736295700073, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5cb80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 119.13736295700073, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.099999999999998, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 228.10345537463823, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.638251035784682, "policy_loss": -0.007307583266325916, "vf_loss": 2.6431983653455973, "vf_explained_var": 0.9648404948413372, "kl": 0.012068532468826266, "entropy": 1.2603175695985556, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -3.7414285825769364, "episode_reward_min": -1375.4039536194032, "episode_reward_mean": -718.9001289227173, "episode_len_mean": 130.36, "episode_media": {}, "episodes_timesteps_total": 13036, "policy_reward_min": {"policy_0": -1375.4039536194032}, "policy_reward_max": {"policy_0": -3.7414285825769364}, "policy_reward_mean": {"policy_0": -718.9001289227173}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-943.1188859043277, -1100.868505570145, -106.75469806914445, -87.50901585860656, -657.252973825607, -705.6902878366391, -26.46384842176901, -1296.40676876115, -622.2957117015166, -135.68685872364208, -1014.2655148784634, -1038.8903974918983, -468.56990718274267, -465.64680465554693, -589.4312206825397, -114.4700761755947, -604.6441790327879, -573.7357803490432, -655.7427996913782, -606.6725477918422, -1165.5046209218578, -844.1942681384201, -146.56125829401603, -927.7965183664448, -360.274539788645, -713.4714610529072, -311.134286947024, -74.23420615551547, -1162.1454151438504, -403.75589708961826, -748.2451893210485, -1086.7450481345643, -1189.5061317524317, -1095.6422988236932, -1269.4657836840154, -268.1435202650095, -453.0372132141015, -407.87889621545565, -961.5144441144797, -1063.3916033284097, -925.3849426227367, -735.8437532260516, -1018.5240264729373, -956.6941043868237, -1081.9135453666206, -729.2551328547881, -778.262005347457, -1030.3161243611555, -409.35075528986704, -958.0714523476704, -375.4023900656976, -999.4680442255411, -1043.523059290489, -1375.4039536194032, -26.44992838255653, -74.6701323797025, -1270.772585423954, -358.13880068711364, -1288.1448140480527, -645.0107088528526, -106.79289838102274, -1256.1231262965614, -826.4158538608267, -130.37996061512717, -1332.5198584733814, -999.0995249865615, -1223.811905146581, -489.0042088085882, -1344.9185762827565, -314.043773175278, -286.3640877663643, -868.6676636108602, -1341.737979544555, -282.79765113615537, -182.0786411296409, -1185.774487107879, -3.7414285825769364, -451.47325146659983, -659.4989018220209, -978.1769698838709, -809.0805962419163, -938.3205502118547, -630.5302652243369, -1209.7219216296926, -638.990817732383, -223.09094776524768, -919.8459742233454, -991.4363490666099, -598.6858922706703, -620.5740366636046, -684.6301543952335, -702.3974701574797, -678.1412051166913, -369.1326608233647, -535.8513654677231, -894.2601036412897, -886.1785122784648, -708.2541705267905, -1211.8498670626234, -828.2596410878203], "episode_lengths": [150, 150, 69, 44, 150, 150, 33, 150, 150, 53, 150, 150, 150, 97, 150, 61, 124, 150, 150, 112, 150, 150, 82, 150, 96, 139, 112, 52, 150, 122, 150, 150, 150, 150, 150, 105, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 44, 56, 150, 87, 150, 150, 62, 150, 150, 75, 150, 150, 150, 127, 150, 102, 91, 150, 150, 76, 71, 150, 35, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 121, 150, 150, 150, 150, 87, 150, 150, 150, 145, 150, 150], "policy_policy_0_reward": [-943.1188859043277, -1100.868505570145, -106.75469806914445, -87.50901585860656, -657.252973825607, -705.6902878366391, -26.46384842176901, -1296.40676876115, -622.2957117015166, -135.68685872364208, -1014.2655148784634, -1038.8903974918983, -468.56990718274267, -465.64680465554693, -589.4312206825397, -114.4700761755947, -604.6441790327879, -573.7357803490432, -655.7427996913782, -606.6725477918422, -1165.5046209218578, -844.1942681384201, -146.56125829401603, -927.7965183664448, -360.274539788645, -713.4714610529072, -311.134286947024, -74.23420615551547, -1162.1454151438504, -403.75589708961826, -748.2451893210485, -1086.7450481345643, -1189.5061317524317, -1095.6422988236932, -1269.4657836840154, -268.1435202650095, -453.0372132141015, -407.87889621545565, -961.5144441144797, -1063.3916033284097, -925.3849426227367, -735.8437532260516, -1018.5240264729373, -956.6941043868237, -1081.9135453666206, -729.2551328547881, -778.262005347457, -1030.3161243611555, -409.35075528986704, -958.0714523476704, -375.4023900656976, -999.4680442255411, -1043.523059290489, -1375.4039536194032, -26.44992838255653, -74.6701323797025, -1270.772585423954, -358.13880068711364, -1288.1448140480527, -645.0107088528526, -106.79289838102274, -1256.1231262965614, -826.4158538608267, -130.37996061512717, -1332.5198584733814, -999.0995249865615, -1223.811905146581, -489.0042088085882, -1344.9185762827565, -314.043773175278, -286.3640877663643, -868.6676636108602, -1341.737979544555, -282.79765113615537, -182.0786411296409, -1185.774487107879, -3.7414285825769364, -451.47325146659983, -659.4989018220209, -978.1769698838709, -809.0805962419163, -938.3205502118547, -630.5302652243369, -1209.7219216296926, -638.990817732383, -223.09094776524768, -919.8459742233454, -991.4363490666099, -598.6858922706703, -620.5740366636046, -684.6301543952335, -702.3974701574797, -678.1412051166913, -369.1326608233647, -535.8513654677231, -894.2601036412897, -886.1785122784648, -708.2541705267905, -1211.8498670626234, -828.2596410878203]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5579772051336321, "mean_inference_ms": 1.6817909897909626, "mean_action_processing_ms": 0.2805751015152662, "mean_env_wait_ms": 3.47092821505424, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01215219497680664, "StateBufferConnector_ms": 0.008208274841308594, "ViewRequirementAgentConnector_ms": 0.191680908203125}, "num_episodes": 31, "episode_return_max": -3.7414285825769364, "episode_return_min": -1375.4039536194032, "episode_return_mean": -718.9001289227173, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.3365542727324, "num_env_steps_trained_throughput_per_sec": 303.3365542727324, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 13221.209, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13221.139, "sample_time_ms": 1160.298, "learn_time_ms": 11995.232, "learn_throughput": 333.466, "synch_weights_time_ms": 64.823}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00001", "date": "2024-08-04_05-35-16", "timestamp": 1722729916, "time_this_iter_s": 13.19944977760315, "time_total_s": 132.33681273460388, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5df30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 132.33681273460388, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 17.58947368421053, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 210.41513219078382, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.877815460165342, "policy_loss": -0.006242846648092382, "vf_loss": 2.8813079190750917, "vf_explained_var": 0.9755654408906896, "kl": 0.013640105853452659, "entropy": 1.3416458146025738, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -3.7414285825769364, "episode_reward_min": -1375.4039536194032, "episode_reward_mean": -745.3663136533844, "episode_len_mean": 134.21, "episode_media": {}, "episodes_timesteps_total": 13421, "policy_reward_min": {"policy_0": -1375.4039536194032}, "policy_reward_max": {"policy_0": -3.7414285825769364}, "policy_reward_mean": {"policy_0": -745.3663136533844}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1086.7450481345643, -1189.5061317524317, -1095.6422988236932, -1269.4657836840154, -268.1435202650095, -453.0372132141015, -407.87889621545565, -961.5144441144797, -1063.3916033284097, -925.3849426227367, -735.8437532260516, -1018.5240264729373, -956.6941043868237, -1081.9135453666206, -729.2551328547881, -778.262005347457, -1030.3161243611555, -409.35075528986704, -958.0714523476704, -375.4023900656976, -999.4680442255411, -1043.523059290489, -1375.4039536194032, -26.44992838255653, -74.6701323797025, -1270.772585423954, -358.13880068711364, -1288.1448140480527, -645.0107088528526, -106.79289838102274, -1256.1231262965614, -826.4158538608267, -130.37996061512717, -1332.5198584733814, -999.0995249865615, -1223.811905146581, -489.0042088085882, -1344.9185762827565, -314.043773175278, -286.3640877663643, -868.6676636108602, -1341.737979544555, -282.79765113615537, -182.0786411296409, -1185.774487107879, -3.7414285825769364, -451.47325146659983, -659.4989018220209, -978.1769698838709, -809.0805962419163, -938.3205502118547, -630.5302652243369, -1209.7219216296926, -638.990817732383, -223.09094776524768, -919.8459742233454, -991.4363490666099, -598.6858922706703, -620.5740366636046, -684.6301543952335, -702.3974701574797, -678.1412051166913, -369.1326608233647, -535.8513654677231, -894.2601036412897, -886.1785122784648, -708.2541705267905, -1211.8498670626234, -828.2596410878203, -1261.080954722507, -159.97439127585062, -758.8445178511536, -732.2462229092889, -276.4703888795959, -1361.7047619037278, -1233.4411783766827, -681.1623964819888, -1067.618607821024, -818.2544062233661, -1073.54782406789, -833.7423350109549, -405.542804549832, -613.9010799980881, -166.3492945239202, -549.6197076406962, -843.9522992366248, -958.3100568945483, -662.5787349325058, -748.5837109157667, -1136.4846689611538, -642.7164719967972, -849.5668481554287, -247.73870708217893, -632.1525772964574, -524.6586104471397, -786.3228807671327, -56.772260926050144, -166.14102011166156, -566.3766910833681, -502.19650584706403], "episode_lengths": [150, 150, 150, 150, 105, 145, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 131, 150, 150, 150, 150, 150, 44, 56, 150, 87, 150, 150, 62, 150, 150, 75, 150, 150, 150, 127, 150, 102, 91, 150, 150, 76, 71, 150, 35, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 121, 150, 150, 150, 150, 87, 150, 150, 150, 145, 150, 150, 150, 54, 150, 145, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 115, 134, 150, 150, 47, 83, 116, 110], "policy_policy_0_reward": [-1086.7450481345643, -1189.5061317524317, -1095.6422988236932, -1269.4657836840154, -268.1435202650095, -453.0372132141015, -407.87889621545565, -961.5144441144797, -1063.3916033284097, -925.3849426227367, -735.8437532260516, -1018.5240264729373, -956.6941043868237, -1081.9135453666206, -729.2551328547881, -778.262005347457, -1030.3161243611555, -409.35075528986704, -958.0714523476704, -375.4023900656976, -999.4680442255411, -1043.523059290489, -1375.4039536194032, -26.44992838255653, -74.6701323797025, -1270.772585423954, -358.13880068711364, -1288.1448140480527, -645.0107088528526, -106.79289838102274, -1256.1231262965614, -826.4158538608267, -130.37996061512717, -1332.5198584733814, -999.0995249865615, -1223.811905146581, -489.0042088085882, -1344.9185762827565, -314.043773175278, -286.3640877663643, -868.6676636108602, -1341.737979544555, -282.79765113615537, -182.0786411296409, -1185.774487107879, -3.7414285825769364, -451.47325146659983, -659.4989018220209, -978.1769698838709, -809.0805962419163, -938.3205502118547, -630.5302652243369, -1209.7219216296926, -638.990817732383, -223.09094776524768, -919.8459742233454, -991.4363490666099, -598.6858922706703, -620.5740366636046, -684.6301543952335, -702.3974701574797, -678.1412051166913, -369.1326608233647, -535.8513654677231, -894.2601036412897, -886.1785122784648, -708.2541705267905, -1211.8498670626234, -828.2596410878203, -1261.080954722507, -159.97439127585062, -758.8445178511536, -732.2462229092889, -276.4703888795959, -1361.7047619037278, -1233.4411783766827, -681.1623964819888, -1067.618607821024, -818.2544062233661, -1073.54782406789, -833.7423350109549, -405.542804549832, -613.9010799980881, -166.3492945239202, -549.6197076406962, -843.9522992366248, -958.3100568945483, -662.5787349325058, -748.5837109157667, -1136.4846689611538, -642.7164719967972, -849.5668481554287, -247.73870708217893, -632.1525772964574, -524.6586104471397, -786.3228807671327, -56.772260926050144, -166.14102011166156, -566.3766910833681, -502.19650584706403]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569859241782904, "mean_inference_ms": 1.680498642190029, "mean_action_processing_ms": 0.2799261055527437, "mean_env_wait_ms": 3.469249623683853, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012155771255493164, "StateBufferConnector_ms": 0.008166313171386719, "ViewRequirementAgentConnector_ms": 0.19115519523620605}, "num_episodes": 31, "episode_return_max": -3.7414285825769364, "episode_return_min": -1375.4039536194032, "episode_return_mean": -745.3663136533844, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.8492733781313, "num_env_steps_trained_throughput_per_sec": 306.8492733781313, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 13211.93, "restore_workers_time_ms": 0.028, "training_step_time_ms": 13211.861, "sample_time_ms": 1154.95, "learn_time_ms": 11990.581, "learn_throughput": 333.595, "synch_weights_time_ms": 65.543}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00001", "date": "2024-08-04_05-35-29", "timestamp": 1722729929, "time_this_iter_s": 13.047167778015137, "time_total_s": 145.38398051261902, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5eb90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 145.38398051261902, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 17.452631578947365, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 216.67761701742808, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.886004650965333, "policy_loss": -0.005278006225125864, "vf_loss": 2.889513891811172, "vf_explained_var": 0.9588661558305224, "kl": 0.010006059368364125, "entropy": 1.2330435557911794, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -3.7414285825769364, "episode_reward_min": -1361.7047619037278, "episode_reward_mean": -661.7990896525567, "episode_len_mean": 127.98, "episode_media": {}, "episodes_timesteps_total": 12798, "policy_reward_min": {"policy_0": -1361.7047619037278}, "policy_reward_max": {"policy_0": -3.7414285825769364}, "policy_reward_mean": {"policy_0": -661.7990896525567}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-314.043773175278, -286.3640877663643, -868.6676636108602, -1341.737979544555, -282.79765113615537, -182.0786411296409, -1185.774487107879, -3.7414285825769364, -451.47325146659983, -659.4989018220209, -978.1769698838709, -809.0805962419163, -938.3205502118547, -630.5302652243369, -1209.7219216296926, -638.990817732383, -223.09094776524768, -919.8459742233454, -991.4363490666099, -598.6858922706703, -620.5740366636046, -684.6301543952335, -702.3974701574797, -678.1412051166913, -369.1326608233647, -535.8513654677231, -894.2601036412897, -886.1785122784648, -708.2541705267905, -1211.8498670626234, -828.2596410878203, -1261.080954722507, -159.97439127585062, -758.8445178511536, -732.2462229092889, -276.4703888795959, -1361.7047619037278, -1233.4411783766827, -681.1623964819888, -1067.618607821024, -818.2544062233661, -1073.54782406789, -833.7423350109549, -405.542804549832, -613.9010799980881, -166.3492945239202, -549.6197076406962, -843.9522992366248, -958.3100568945483, -662.5787349325058, -748.5837109157667, -1136.4846689611538, -642.7164719967972, -849.5668481554287, -247.73870708217893, -632.1525772964574, -524.6586104471397, -786.3228807671327, -56.772260926050144, -166.14102011166156, -566.3766910833681, -502.19650584706403, -261.0414476953614, -81.90000542111046, -151.36718613957584, -355.8991249397164, -703.3172414913499, -968.8120192369274, -186.9087498985108, -911.1234127917945, -792.6477148411115, -721.7184061559257, -291.9273261439197, -1050.4117629135174, -31.24538080124914, -256.4494860659908, -255.15077326192335, -819.8175554377841, -944.355024350134, -361.2410662996832, -848.0996104577945, -1087.386487317625, -599.152616342351, -430.40979681758597, -301.29804922156376, -1135.6460940846773, -593.8267872512895, -716.6462834211808, -1039.362533760781, -442.6379889914312, -1097.034842599602, -200.71992291507547, -76.78940648363023, -987.8400886943836, -507.1065236749343, -1143.7177192900153, -951.7067627615969, -513.978232929585, -317.80390442413733, -1091.771376227453], "episode_lengths": [102, 91, 150, 150, 76, 71, 150, 35, 150, 150, 150, 150, 150, 150, 150, 150, 80, 150, 150, 121, 150, 150, 150, 150, 87, 150, 150, 150, 145, 150, 150, 150, 54, 150, 145, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 115, 134, 150, 150, 47, 83, 116, 110, 72, 61, 58, 99, 150, 150, 71, 150, 150, 150, 79, 150, 34, 75, 82, 150, 150, 88, 150, 150, 150, 94, 102, 150, 150, 150, 150, 102, 150, 88, 51, 150, 150, 150, 150, 150, 103, 150], "policy_policy_0_reward": [-314.043773175278, -286.3640877663643, -868.6676636108602, -1341.737979544555, -282.79765113615537, -182.0786411296409, -1185.774487107879, -3.7414285825769364, -451.47325146659983, -659.4989018220209, -978.1769698838709, -809.0805962419163, -938.3205502118547, -630.5302652243369, -1209.7219216296926, -638.990817732383, -223.09094776524768, -919.8459742233454, -991.4363490666099, -598.6858922706703, -620.5740366636046, -684.6301543952335, -702.3974701574797, -678.1412051166913, -369.1326608233647, -535.8513654677231, -894.2601036412897, -886.1785122784648, -708.2541705267905, -1211.8498670626234, -828.2596410878203, -1261.080954722507, -159.97439127585062, -758.8445178511536, -732.2462229092889, -276.4703888795959, -1361.7047619037278, -1233.4411783766827, -681.1623964819888, -1067.618607821024, -818.2544062233661, -1073.54782406789, -833.7423350109549, -405.542804549832, -613.9010799980881, -166.3492945239202, -549.6197076406962, -843.9522992366248, -958.3100568945483, -662.5787349325058, -748.5837109157667, -1136.4846689611538, -642.7164719967972, -849.5668481554287, -247.73870708217893, -632.1525772964574, -524.6586104471397, -786.3228807671327, -56.772260926050144, -166.14102011166156, -566.3766910833681, -502.19650584706403, -261.0414476953614, -81.90000542111046, -151.36718613957584, -355.8991249397164, -703.3172414913499, -968.8120192369274, -186.9087498985108, -911.1234127917945, -792.6477148411115, -721.7184061559257, -291.9273261439197, -1050.4117629135174, -31.24538080124914, -256.4494860659908, -255.15077326192335, -819.8175554377841, -944.355024350134, -361.2410662996832, -848.0996104577945, -1087.386487317625, -599.152616342351, -430.40979681758597, -301.29804922156376, -1135.6460940846773, -593.8267872512895, -716.6462834211808, -1039.362533760781, -442.6379889914312, -1097.034842599602, -200.71992291507547, -76.78940648363023, -987.8400886943836, -507.1065236749343, -1143.7177192900153, -951.7067627615969, -513.978232929585, -317.80390442413733, -1091.771376227453]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.556790405098237, "mean_inference_ms": 1.6787289765575013, "mean_action_processing_ms": 0.2790025559127956, "mean_env_wait_ms": 3.469930988274659, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012100458145141602, "StateBufferConnector_ms": 0.008165836334228516, "ViewRequirementAgentConnector_ms": 0.1913306713104248}, "num_episodes": 38, "episode_return_max": -3.7414285825769364, "episode_return_min": -1361.7047619037278, "episode_return_mean": -661.7990896525567, "episodes_this_iter": 38}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 379.13590261848987, "num_env_steps_trained_throughput_per_sec": 379.13590261848987, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12942.938, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12942.864, "sample_time_ms": 1153.103, "learn_time_ms": 11723.15, "learn_throughput": 341.205, "synch_weights_time_ms": 65.824}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00001", "date": "2024-08-04_05-35-39", "timestamp": 1722729939, "time_this_iter_s": 10.561718463897705, "time_total_s": 155.94569897651672, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5f490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 155.94569897651672, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 19.36, "ram_util_percent": 27.800000000000004}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 197.94222235679626, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.0232597726086774, "policy_loss": -0.011301937090562812, "vf_loss": 3.0324382919818165, "vf_explained_var": 0.9623555016393462, "kl": 0.011299104420549592, "entropy": 1.2663077658663193, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -31.24538080124914, "episode_reward_min": -1361.7047619037278, "episode_reward_mean": -607.8176879411612, "episode_len_mean": 124.02, "episode_media": {}, "episodes_timesteps_total": 12402, "policy_reward_min": {"policy_0": -1361.7047619037278}, "policy_reward_max": {"policy_0": -31.24538080124914}, "policy_reward_mean": {"policy_0": -607.8176879411612}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1261.080954722507, -159.97439127585062, -758.8445178511536, -732.2462229092889, -276.4703888795959, -1361.7047619037278, -1233.4411783766827, -681.1623964819888, -1067.618607821024, -818.2544062233661, -1073.54782406789, -833.7423350109549, -405.542804549832, -613.9010799980881, -166.3492945239202, -549.6197076406962, -843.9522992366248, -958.3100568945483, -662.5787349325058, -748.5837109157667, -1136.4846689611538, -642.7164719967972, -849.5668481554287, -247.73870708217893, -632.1525772964574, -524.6586104471397, -786.3228807671327, -56.772260926050144, -166.14102011166156, -566.3766910833681, -502.19650584706403, -261.0414476953614, -81.90000542111046, -151.36718613957584, -355.8991249397164, -703.3172414913499, -968.8120192369274, -186.9087498985108, -911.1234127917945, -792.6477148411115, -721.7184061559257, -291.9273261439197, -1050.4117629135174, -31.24538080124914, -256.4494860659908, -255.15077326192335, -819.8175554377841, -944.355024350134, -361.2410662996832, -848.0996104577945, -1087.386487317625, -599.152616342351, -430.40979681758597, -301.29804922156376, -1135.6460940846773, -593.8267872512895, -716.6462834211808, -1039.362533760781, -442.6379889914312, -1097.034842599602, -200.71992291507547, -76.78940648363023, -987.8400886943836, -507.1065236749343, -1143.7177192900153, -951.7067627615969, -513.978232929585, -317.80390442413733, -1091.771376227453, -1045.3699398697322, -441.0934462831331, -289.6868220857481, -415.810541082275, -899.2238886612365, -127.79723100278741, -228.5620973245922, -239.02147769407003, -706.1841930635547, -345.24895878100233, -917.7809976166723, -743.9539312984481, -668.877248285289, -1016.4309944356227, -269.27336436308434, -171.21510125354138, -170.61072179005674, -570.8668155420587, -622.6008764389225, -406.84425641937924, -171.23502796410722, -911.7559138882341, -1080.18646502886, -854.6509701861673, -242.2901774906296, -199.37729271939386, -665.1316955546405, -956.7968371893628, -83.84873682489959, -194.50899825154778, -579.2121472843429], "episode_lengths": [150, 54, 150, 145, 119, 150, 150, 150, 150, 150, 150, 150, 150, 150, 58, 150, 150, 150, 150, 150, 150, 150, 150, 115, 134, 150, 150, 47, 83, 116, 110, 72, 61, 58, 99, 150, 150, 71, 150, 150, 150, 79, 150, 34, 75, 82, 150, 150, 88, 150, 150, 150, 94, 102, 150, 150, 150, 150, 102, 150, 88, 51, 150, 150, 150, 150, 150, 103, 150, 150, 98, 82, 145, 150, 90, 80, 69, 150, 89, 150, 150, 150, 150, 80, 78, 90, 150, 140, 150, 88, 150, 150, 150, 81, 138, 131, 150, 44, 89, 150], "policy_policy_0_reward": [-1261.080954722507, -159.97439127585062, -758.8445178511536, -732.2462229092889, -276.4703888795959, -1361.7047619037278, -1233.4411783766827, -681.1623964819888, -1067.618607821024, -818.2544062233661, -1073.54782406789, -833.7423350109549, -405.542804549832, -613.9010799980881, -166.3492945239202, -549.6197076406962, -843.9522992366248, -958.3100568945483, -662.5787349325058, -748.5837109157667, -1136.4846689611538, -642.7164719967972, -849.5668481554287, -247.73870708217893, -632.1525772964574, -524.6586104471397, -786.3228807671327, -56.772260926050144, -166.14102011166156, -566.3766910833681, -502.19650584706403, -261.0414476953614, -81.90000542111046, -151.36718613957584, -355.8991249397164, -703.3172414913499, -968.8120192369274, -186.9087498985108, -911.1234127917945, -792.6477148411115, -721.7184061559257, -291.9273261439197, -1050.4117629135174, -31.24538080124914, -256.4494860659908, -255.15077326192335, -819.8175554377841, -944.355024350134, -361.2410662996832, -848.0996104577945, -1087.386487317625, -599.152616342351, -430.40979681758597, -301.29804922156376, -1135.6460940846773, -593.8267872512895, -716.6462834211808, -1039.362533760781, -442.6379889914312, -1097.034842599602, -200.71992291507547, -76.78940648363023, -987.8400886943836, -507.1065236749343, -1143.7177192900153, -951.7067627615969, -513.978232929585, -317.80390442413733, -1091.771376227453, -1045.3699398697322, -441.0934462831331, -289.6868220857481, -415.810541082275, -899.2238886612365, -127.79723100278741, -228.5620973245922, -239.02147769407003, -706.1841930635547, -345.24895878100233, -917.7809976166723, -743.9539312984481, -668.877248285289, -1016.4309944356227, -269.27336436308434, -171.21510125354138, -170.61072179005674, -570.8668155420587, -622.6008764389225, -406.84425641937924, -171.23502796410722, -911.7559138882341, -1080.18646502886, -854.6509701861673, -242.2901774906296, -199.37729271939386, -665.1316955546405, -956.7968371893628, -83.84873682489959, -194.50899825154778, -579.2121472843429]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5564494499694737, "mean_inference_ms": 1.676001501813979, "mean_action_processing_ms": 0.27837747312608324, "mean_env_wait_ms": 3.4625842287896926, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011880159378051758, "StateBufferConnector_ms": 0.007980585098266602, "ViewRequirementAgentConnector_ms": 0.18924164772033691}, "num_episodes": 31, "episode_return_max": -31.24538080124914, "episode_return_min": -1361.7047619037278, "episode_return_mean": -607.8176879411612, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.4274851003409, "num_env_steps_trained_throughput_per_sec": 298.4274851003409, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12928.615, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12928.54, "sample_time_ms": 1132.244, "learn_time_ms": 11728.263, "learn_throughput": 341.056, "synch_weights_time_ms": 67.235}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00001", "date": "2024-08-04_05-35-53", "timestamp": 1722729953, "time_this_iter_s": 13.415213108062744, "time_total_s": 169.36091208457947, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16eebc70>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 169.36091208457947, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 17.410526315789475, "ram_util_percent": 27.8}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 161.16705211997032, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.479310542469223, "policy_loss": -0.013176477567564385, "vf_loss": 2.4890944797545673, "vf_explained_var": 0.9877777251725396, "kl": 0.015376216421160894, "entropy": 1.2203239519149065, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -31.24538080124914, "episode_reward_min": -1143.7177192900153, "episode_reward_mean": -564.3997834496399, "episode_len_mean": 121.44, "episode_media": {}, "episodes_timesteps_total": 12144, "policy_reward_min": {"policy_0": -1143.7177192900153}, "policy_reward_max": {"policy_0": -31.24538080124914}, "policy_reward_mean": {"policy_0": -564.3997834496399}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-502.19650584706403, -261.0414476953614, -81.90000542111046, -151.36718613957584, -355.8991249397164, -703.3172414913499, -968.8120192369274, -186.9087498985108, -911.1234127917945, -792.6477148411115, -721.7184061559257, -291.9273261439197, -1050.4117629135174, -31.24538080124914, -256.4494860659908, -255.15077326192335, -819.8175554377841, -944.355024350134, -361.2410662996832, -848.0996104577945, -1087.386487317625, -599.152616342351, -430.40979681758597, -301.29804922156376, -1135.6460940846773, -593.8267872512895, -716.6462834211808, -1039.362533760781, -442.6379889914312, -1097.034842599602, -200.71992291507547, -76.78940648363023, -987.8400886943836, -507.1065236749343, -1143.7177192900153, -951.7067627615969, -513.978232929585, -317.80390442413733, -1091.771376227453, -1045.3699398697322, -441.0934462831331, -289.6868220857481, -415.810541082275, -899.2238886612365, -127.79723100278741, -228.5620973245922, -239.02147769407003, -706.1841930635547, -345.24895878100233, -917.7809976166723, -743.9539312984481, -668.877248285289, -1016.4309944356227, -269.27336436308434, -171.21510125354138, -170.61072179005674, -570.8668155420587, -622.6008764389225, -406.84425641937924, -171.23502796410722, -911.7559138882341, -1080.18646502886, -854.6509701861673, -242.2901774906296, -199.37729271939386, -665.1316955546405, -956.7968371893628, -83.84873682489959, -194.50899825154778, -579.2121472843429, -285.5646692054522, -994.7798632963213, -42.738342810216956, -285.9426283207245, -671.881568240863, -243.9768735831051, -236.04522070333098, -459.7872609039339, -64.31886045804133, -813.6508528658485, -1123.3272580210783, -432.3218819299826, -532.1135538348285, -182.11321975786765, -227.02087649937613, -1112.7669913017778, -217.26568568303665, -625.5287350462447, -792.6792407720126, -632.9320863532016, -547.7737852622636, -984.3168917897751, -890.5418993169437, -278.2111976614466, -460.76863567909726, -876.0851657217258, -382.4506985248745, -937.2639835792417, -546.0483931020975, -593.8496416665514], "episode_lengths": [110, 72, 61, 58, 99, 150, 150, 71, 150, 150, 150, 79, 150, 34, 75, 82, 150, 150, 88, 150, 150, 150, 94, 102, 150, 150, 150, 150, 102, 150, 88, 51, 150, 150, 150, 150, 150, 103, 150, 150, 98, 82, 145, 150, 90, 80, 69, 150, 89, 150, 150, 150, 150, 80, 78, 90, 150, 140, 150, 88, 150, 150, 150, 81, 138, 131, 150, 44, 89, 150, 127, 150, 42, 91, 149, 127, 101, 143, 47, 150, 150, 150, 150, 76, 65, 150, 75, 133, 150, 150, 150, 150, 150, 73, 150, 150, 114, 150, 150, 150], "policy_policy_0_reward": [-502.19650584706403, -261.0414476953614, -81.90000542111046, -151.36718613957584, -355.8991249397164, -703.3172414913499, -968.8120192369274, -186.9087498985108, -911.1234127917945, -792.6477148411115, -721.7184061559257, -291.9273261439197, -1050.4117629135174, -31.24538080124914, -256.4494860659908, -255.15077326192335, -819.8175554377841, -944.355024350134, -361.2410662996832, -848.0996104577945, -1087.386487317625, -599.152616342351, -430.40979681758597, -301.29804922156376, -1135.6460940846773, -593.8267872512895, -716.6462834211808, -1039.362533760781, -442.6379889914312, -1097.034842599602, -200.71992291507547, -76.78940648363023, -987.8400886943836, -507.1065236749343, -1143.7177192900153, -951.7067627615969, -513.978232929585, -317.80390442413733, -1091.771376227453, -1045.3699398697322, -441.0934462831331, -289.6868220857481, -415.810541082275, -899.2238886612365, -127.79723100278741, -228.5620973245922, -239.02147769407003, -706.1841930635547, -345.24895878100233, -917.7809976166723, -743.9539312984481, -668.877248285289, -1016.4309944356227, -269.27336436308434, -171.21510125354138, -170.61072179005674, -570.8668155420587, -622.6008764389225, -406.84425641937924, -171.23502796410722, -911.7559138882341, -1080.18646502886, -854.6509701861673, -242.2901774906296, -199.37729271939386, -665.1316955546405, -956.7968371893628, -83.84873682489959, -194.50899825154778, -579.2121472843429, -285.5646692054522, -994.7798632963213, -42.738342810216956, -285.9426283207245, -671.881568240863, -243.9768735831051, -236.04522070333098, -459.7872609039339, -64.31886045804133, -813.6508528658485, -1123.3272580210783, -432.3218819299826, -532.1135538348285, -182.11321975786765, -227.02087649937613, -1112.7669913017778, -217.26568568303665, -625.5287350462447, -792.6792407720126, -632.9320863532016, -547.7737852622636, -984.3168917897751, -890.5418993169437, -278.2111976614466, -460.76863567909726, -876.0851657217258, -382.4506985248745, -937.2639835792417, -546.0483931020975, -593.8496416665514]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5562662376602967, "mean_inference_ms": 1.6756415594350793, "mean_action_processing_ms": 0.2780225210568597, "mean_env_wait_ms": 3.4604494713654264, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011966943740844727, "StateBufferConnector_ms": 0.00792241096496582, "ViewRequirementAgentConnector_ms": 0.18869853019714355}, "num_episodes": 30, "episode_return_max": -31.24538080124914, "episode_return_min": -1143.7177192900153, "episode_return_mean": -564.3997834496399, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.57217796372504, "num_env_steps_trained_throughput_per_sec": 301.57217796372504, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12941.373, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12941.297, "sample_time_ms": 1128.172, "learn_time_ms": 11745.679, "learn_throughput": 340.551, "synch_weights_time_ms": 66.645}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00001", "date": "2024-08-04_05-36-06", "timestamp": 1722729966, "time_this_iter_s": 13.276455402374268, "time_total_s": 182.63736748695374, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5cb80>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 182.63736748695374, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 17.373684210526317, "ram_util_percent": 27.86842105263158}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 214.4929491341114, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.4356718848148984, "policy_loss": -0.017970015289029105, "vf_loss": 2.4502731220175824, "vf_explained_var": 0.9936678696423769, "kl": 0.015889466817498032, "entropy": 1.3980592517803112, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -42.738342810216956, "episode_reward_min": -1270.9601379076719, "episode_reward_mean": -589.8921838995211, "episode_len_mean": 126.76, "episode_media": {}, "episodes_timesteps_total": 12676, "policy_reward_min": {"policy_0": -1270.9601379076719}, "policy_reward_max": {"policy_0": -42.738342810216956}, "policy_reward_mean": {"policy_0": -589.8921838995211}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1097.034842599602, -200.71992291507547, -76.78940648363023, -987.8400886943836, -507.1065236749343, -1143.7177192900153, -951.7067627615969, -513.978232929585, -317.80390442413733, -1091.771376227453, -1045.3699398697322, -441.0934462831331, -289.6868220857481, -415.810541082275, -899.2238886612365, -127.79723100278741, -228.5620973245922, -239.02147769407003, -706.1841930635547, -345.24895878100233, -917.7809976166723, -743.9539312984481, -668.877248285289, -1016.4309944356227, -269.27336436308434, -171.21510125354138, -170.61072179005674, -570.8668155420587, -622.6008764389225, -406.84425641937924, -171.23502796410722, -911.7559138882341, -1080.18646502886, -854.6509701861673, -242.2901774906296, -199.37729271939386, -665.1316955546405, -956.7968371893628, -83.84873682489959, -194.50899825154778, -579.2121472843429, -285.5646692054522, -994.7798632963213, -42.738342810216956, -285.9426283207245, -671.881568240863, -243.9768735831051, -236.04522070333098, -459.7872609039339, -64.31886045804133, -813.6508528658485, -1123.3272580210783, -432.3218819299826, -532.1135538348285, -182.11321975786765, -227.02087649937613, -1112.7669913017778, -217.26568568303665, -625.5287350462447, -792.6792407720126, -632.9320863532016, -547.7737852622636, -984.3168917897751, -890.5418993169437, -278.2111976614466, -460.76863567909726, -876.0851657217258, -382.4506985248745, -937.2639835792417, -546.0483931020975, -593.8496416665514, -216.49730202234818, -700.1445910878722, -906.8610570546699, -43.14062179990537, -981.8997136205069, -447.4679237396589, -1176.4118883838637, -911.6101046716482, -522.4256601148344, -409.36473780604445, -887.177313724522, -1270.9601379076719, -1012.2493065538907, -1000.754063215637, -417.8582639410214, -358.11084719410843, -1169.4423876736519, -269.11541748654685, -697.715683208528, -493.49177558437316, -900.8861955758384, -162.71725811208154, -332.89400699150036, -761.949992453619, -215.38420689375374, -793.9250349511988, -836.0476517903546, -334.80789871222584, -1159.9254401151732], "episode_lengths": [150, 88, 51, 150, 150, 150, 150, 150, 103, 150, 150, 98, 82, 145, 150, 90, 80, 69, 150, 89, 150, 150, 150, 150, 80, 78, 90, 150, 140, 150, 88, 150, 150, 150, 81, 138, 131, 150, 44, 89, 150, 127, 150, 42, 91, 149, 127, 101, 143, 47, 150, 150, 150, 150, 76, 65, 150, 75, 133, 150, 150, 150, 150, 150, 73, 150, 150, 114, 150, 150, 150, 75, 150, 150, 51, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 114, 150, 150, 128, 148, 144, 150, 83, 104, 150, 96, 150, 150, 150, 150], "policy_policy_0_reward": [-1097.034842599602, -200.71992291507547, -76.78940648363023, -987.8400886943836, -507.1065236749343, -1143.7177192900153, -951.7067627615969, -513.978232929585, -317.80390442413733, -1091.771376227453, -1045.3699398697322, -441.0934462831331, -289.6868220857481, -415.810541082275, -899.2238886612365, -127.79723100278741, -228.5620973245922, -239.02147769407003, -706.1841930635547, -345.24895878100233, -917.7809976166723, -743.9539312984481, -668.877248285289, -1016.4309944356227, -269.27336436308434, -171.21510125354138, -170.61072179005674, -570.8668155420587, -622.6008764389225, -406.84425641937924, -171.23502796410722, -911.7559138882341, -1080.18646502886, -854.6509701861673, -242.2901774906296, -199.37729271939386, -665.1316955546405, -956.7968371893628, -83.84873682489959, -194.50899825154778, -579.2121472843429, -285.5646692054522, -994.7798632963213, -42.738342810216956, -285.9426283207245, -671.881568240863, -243.9768735831051, -236.04522070333098, -459.7872609039339, -64.31886045804133, -813.6508528658485, -1123.3272580210783, -432.3218819299826, -532.1135538348285, -182.11321975786765, -227.02087649937613, -1112.7669913017778, -217.26568568303665, -625.5287350462447, -792.6792407720126, -632.9320863532016, -547.7737852622636, -984.3168917897751, -890.5418993169437, -278.2111976614466, -460.76863567909726, -876.0851657217258, -382.4506985248745, -937.2639835792417, -546.0483931020975, -593.8496416665514, -216.49730202234818, -700.1445910878722, -906.8610570546699, -43.14062179990537, -981.8997136205069, -447.4679237396589, -1176.4118883838637, -911.6101046716482, -522.4256601148344, -409.36473780604445, -887.177313724522, -1270.9601379076719, -1012.2493065538907, -1000.754063215637, -417.8582639410214, -358.11084719410843, -1169.4423876736519, -269.11541748654685, -697.715683208528, -493.49177558437316, -900.8861955758384, -162.71725811208154, -332.89400699150036, -761.949992453619, -215.38420689375374, -793.9250349511988, -836.0476517903546, -334.80789871222584, -1159.9254401151732]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5560340323173731, "mean_inference_ms": 1.6758972016952114, "mean_action_processing_ms": 0.27789306307549266, "mean_env_wait_ms": 3.455998975360364, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01209402084350586, "StateBufferConnector_ms": 0.007871627807617188, "ViewRequirementAgentConnector_ms": 0.18722891807556152}, "num_episodes": 29, "episode_return_max": -42.738342810216956, "episode_return_min": -1270.9601379076719, "episode_return_mean": -589.8921838995211, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 312.33452296435286, "num_env_steps_trained_throughput_per_sec": 312.33452296435286, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12888.56, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12888.487, "sample_time_ms": 1125.634, "learn_time_ms": 11696.449, "learn_throughput": 341.984, "synch_weights_time_ms": 65.615}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00001", "date": "2024-08-04_05-36-19", "timestamp": 1722729979, "time_this_iter_s": 12.818955898284912, "time_total_s": 195.45632338523865, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5f1c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 195.45632338523865, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 17.822222222222223, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 197.83198651472728, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.5678928198913735, "policy_loss": -0.015617006537892546, "vf_loss": 2.579392982895176, "vf_explained_var": 0.992472667247057, "kl": 0.018264095129719257, "entropy": 1.3623888651529947, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -42.738342810216956, "episode_reward_min": -1330.9838069596221, "episode_reward_mean": -616.4841252143224, "episode_len_mean": 129.11, "episode_media": {}, "episodes_timesteps_total": 12911, "policy_reward_min": {"policy_0": -1330.9838069596221}, "policy_reward_max": {"policy_0": -42.738342810216956}, "policy_reward_mean": {"policy_0": -616.4841252143224}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-171.23502796410722, -911.7559138882341, -1080.18646502886, -854.6509701861673, -242.2901774906296, -199.37729271939386, -665.1316955546405, -956.7968371893628, -83.84873682489959, -194.50899825154778, -579.2121472843429, -285.5646692054522, -994.7798632963213, -42.738342810216956, -285.9426283207245, -671.881568240863, -243.9768735831051, -236.04522070333098, -459.7872609039339, -64.31886045804133, -813.6508528658485, -1123.3272580210783, -432.3218819299826, -532.1135538348285, -182.11321975786765, -227.02087649937613, -1112.7669913017778, -217.26568568303665, -625.5287350462447, -792.6792407720126, -632.9320863532016, -547.7737852622636, -984.3168917897751, -890.5418993169437, -278.2111976614466, -460.76863567909726, -876.0851657217258, -382.4506985248745, -937.2639835792417, -546.0483931020975, -593.8496416665514, -216.49730202234818, -700.1445910878722, -906.8610570546699, -43.14062179990537, -981.8997136205069, -447.4679237396589, -1176.4118883838637, -911.6101046716482, -522.4256601148344, -409.36473780604445, -887.177313724522, -1270.9601379076719, -1012.2493065538907, -1000.754063215637, -417.8582639410214, -358.11084719410843, -1169.4423876736519, -269.11541748654685, -697.715683208528, -493.49177558437316, -900.8861955758384, -162.71725811208154, -332.89400699150036, -761.949992453619, -215.38420689375374, -793.9250349511988, -836.0476517903546, -334.80789871222584, -1159.9254401151732, -1207.6722732895437, -791.1035448263075, -1106.714428645366, -1043.5358445764207, -274.32231160067323, -773.2701524153176, -1002.2506995997426, -231.3027591038769, -1330.9838069596221, -197.80778905683454, -1330.9667654259695, -665.7311674181965, -234.59881736821592, -917.3687459377346, -44.619458699941816, -276.4849002930787, -862.4392211791331, -404.70270841633084, -323.9496275274689, -346.2194540745285, -864.5451962914777, -846.8065437856704, -711.5672503599658, -669.9408918417664, -839.5672697651144, -297.7264507117729, -114.36669587621317, -396.2367210093145, -596.5381048280478, -1140.776213888097], "episode_lengths": [88, 150, 150, 150, 81, 138, 131, 150, 44, 89, 150, 127, 150, 42, 91, 149, 127, 101, 143, 47, 150, 150, 150, 150, 76, 65, 150, 75, 133, 150, 150, 150, 150, 150, 73, 150, 150, 114, 150, 150, 150, 75, 150, 150, 51, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 114, 150, 150, 128, 148, 144, 150, 83, 104, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 92, 150, 66, 150, 150, 72, 150, 46, 150, 150, 132, 150, 104, 150, 150, 150, 150, 150, 86, 81, 150, 150, 150], "policy_policy_0_reward": [-171.23502796410722, -911.7559138882341, -1080.18646502886, -854.6509701861673, -242.2901774906296, -199.37729271939386, -665.1316955546405, -956.7968371893628, -83.84873682489959, -194.50899825154778, -579.2121472843429, -285.5646692054522, -994.7798632963213, -42.738342810216956, -285.9426283207245, -671.881568240863, -243.9768735831051, -236.04522070333098, -459.7872609039339, -64.31886045804133, -813.6508528658485, -1123.3272580210783, -432.3218819299826, -532.1135538348285, -182.11321975786765, -227.02087649937613, -1112.7669913017778, -217.26568568303665, -625.5287350462447, -792.6792407720126, -632.9320863532016, -547.7737852622636, -984.3168917897751, -890.5418993169437, -278.2111976614466, -460.76863567909726, -876.0851657217258, -382.4506985248745, -937.2639835792417, -546.0483931020975, -593.8496416665514, -216.49730202234818, -700.1445910878722, -906.8610570546699, -43.14062179990537, -981.8997136205069, -447.4679237396589, -1176.4118883838637, -911.6101046716482, -522.4256601148344, -409.36473780604445, -887.177313724522, -1270.9601379076719, -1012.2493065538907, -1000.754063215637, -417.8582639410214, -358.11084719410843, -1169.4423876736519, -269.11541748654685, -697.715683208528, -493.49177558437316, -900.8861955758384, -162.71725811208154, -332.89400699150036, -761.949992453619, -215.38420689375374, -793.9250349511988, -836.0476517903546, -334.80789871222584, -1159.9254401151732, -1207.6722732895437, -791.1035448263075, -1106.714428645366, -1043.5358445764207, -274.32231160067323, -773.2701524153176, -1002.2506995997426, -231.3027591038769, -1330.9838069596221, -197.80778905683454, -1330.9667654259695, -665.7311674181965, -234.59881736821592, -917.3687459377346, -44.619458699941816, -276.4849002930787, -862.4392211791331, -404.70270841633084, -323.9496275274689, -346.2194540745285, -864.5451962914777, -846.8065437856704, -711.5672503599658, -669.9408918417664, -839.5672697651144, -297.7264507117729, -114.36669587621317, -396.2367210093145, -596.5381048280478, -1140.776213888097]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5557435672450317, "mean_inference_ms": 1.677495711221135, "mean_action_processing_ms": 0.27756823983235657, "mean_env_wait_ms": 3.4572912514762693, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012221574783325195, "StateBufferConnector_ms": 0.008266448974609375, "ViewRequirementAgentConnector_ms": 0.18878436088562012}, "num_episodes": 30, "episode_return_max": -42.738342810216956, "episode_return_min": -1330.9838069596221, "episode_return_mean": -616.4841252143224, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.31563270669096, "num_env_steps_trained_throughput_per_sec": 303.31563270669096, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12906.333, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12906.26, "sample_time_ms": 1123.937, "learn_time_ms": 11715.845, "learn_throughput": 341.418, "synch_weights_time_ms": 65.701}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00001", "date": "2024-08-04_05-36-32", "timestamp": 1722729992, "time_this_iter_s": 13.199654340744019, "time_total_s": 208.65597772598267, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5cc10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 208.65597772598267, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.694736842105264, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 179.12039273579916, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 3.0077287817994756, "policy_loss": -0.009246579675527755, "vf_loss": 3.013596943269173, "vf_explained_var": 0.978612557426095, "kl": 0.01563294228726592, "entropy": 1.3114647292842467, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -25.85661116926784, "episode_reward_min": -1336.9562216055067, "episode_reward_mean": -624.3712630148682, "episode_len_mean": 125.81, "episode_media": {}, "episodes_timesteps_total": 12581, "policy_reward_min": {"policy_0": -1336.9562216055067}, "policy_reward_max": {"policy_0": -25.85661116926784}, "policy_reward_mean": {"policy_0": -624.3712630148682}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-876.0851657217258, -382.4506985248745, -937.2639835792417, -546.0483931020975, -593.8496416665514, -216.49730202234818, -700.1445910878722, -906.8610570546699, -43.14062179990537, -981.8997136205069, -447.4679237396589, -1176.4118883838637, -911.6101046716482, -522.4256601148344, -409.36473780604445, -887.177313724522, -1270.9601379076719, -1012.2493065538907, -1000.754063215637, -417.8582639410214, -358.11084719410843, -1169.4423876736519, -269.11541748654685, -697.715683208528, -493.49177558437316, -900.8861955758384, -162.71725811208154, -332.89400699150036, -761.949992453619, -215.38420689375374, -793.9250349511988, -836.0476517903546, -334.80789871222584, -1159.9254401151732, -1207.6722732895437, -791.1035448263075, -1106.714428645366, -1043.5358445764207, -274.32231160067323, -773.2701524153176, -1002.2506995997426, -231.3027591038769, -1330.9838069596221, -197.80778905683454, -1330.9667654259695, -665.7311674181965, -234.59881736821592, -917.3687459377346, -44.619458699941816, -276.4849002930787, -862.4392211791331, -404.70270841633084, -323.9496275274689, -346.2194540745285, -864.5451962914777, -846.8065437856704, -711.5672503599658, -669.9408918417664, -839.5672697651144, -297.7264507117729, -114.36669587621317, -396.2367210093145, -596.5381048280478, -1140.776213888097, -257.4784351030104, -51.764195890477076, -348.1856591973006, -155.0302225799941, -926.8126144156049, -446.24216865997636, -321.73335301452863, -1106.5941182722825, -204.03200035271254, -110.75335823047338, -77.06276876922875, -451.2197594061057, -875.7481589185503, -651.8888013887722, -880.2633884261779, -259.11417823625106, -134.35856442829882, -1185.6639834448151, -1334.591635578821, -91.64899857074823, -57.61167580254529, -994.4482033557939, -1331.0284866132006, -244.64185240631423, -411.55198998576554, -96.66056366802299, -121.66816678310829, -25.85661116926784, -1308.2359026752733, -1336.9562216055067, -592.2848786922561, -435.2202537670547, -625.0389746038753, -1036.553605655777, -178.57993357850782, -1199.552438487126], "episode_lengths": [150, 114, 150, 150, 150, 75, 150, 150, 51, 150, 150, 150, 150, 150, 116, 150, 150, 150, 150, 114, 150, 150, 128, 148, 144, 150, 83, 104, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 92, 150, 66, 150, 150, 72, 150, 46, 150, 150, 132, 150, 104, 150, 150, 150, 150, 150, 86, 81, 150, 150, 150, 97, 46, 106, 72, 150, 147, 81, 150, 62, 73, 63, 150, 150, 150, 150, 113, 68, 150, 150, 62, 49, 150, 150, 96, 150, 55, 99, 39, 150, 150, 150, 117, 137, 150, 58, 150], "policy_policy_0_reward": [-876.0851657217258, -382.4506985248745, -937.2639835792417, -546.0483931020975, -593.8496416665514, -216.49730202234818, -700.1445910878722, -906.8610570546699, -43.14062179990537, -981.8997136205069, -447.4679237396589, -1176.4118883838637, -911.6101046716482, -522.4256601148344, -409.36473780604445, -887.177313724522, -1270.9601379076719, -1012.2493065538907, -1000.754063215637, -417.8582639410214, -358.11084719410843, -1169.4423876736519, -269.11541748654685, -697.715683208528, -493.49177558437316, -900.8861955758384, -162.71725811208154, -332.89400699150036, -761.949992453619, -215.38420689375374, -793.9250349511988, -836.0476517903546, -334.80789871222584, -1159.9254401151732, -1207.6722732895437, -791.1035448263075, -1106.714428645366, -1043.5358445764207, -274.32231160067323, -773.2701524153176, -1002.2506995997426, -231.3027591038769, -1330.9838069596221, -197.80778905683454, -1330.9667654259695, -665.7311674181965, -234.59881736821592, -917.3687459377346, -44.619458699941816, -276.4849002930787, -862.4392211791331, -404.70270841633084, -323.9496275274689, -346.2194540745285, -864.5451962914777, -846.8065437856704, -711.5672503599658, -669.9408918417664, -839.5672697651144, -297.7264507117729, -114.36669587621317, -396.2367210093145, -596.5381048280478, -1140.776213888097, -257.4784351030104, -51.764195890477076, -348.1856591973006, -155.0302225799941, -926.8126144156049, -446.24216865997636, -321.73335301452863, -1106.5941182722825, -204.03200035271254, -110.75335823047338, -77.06276876922875, -451.2197594061057, -875.7481589185503, -651.8888013887722, -880.2633884261779, -259.11417823625106, -134.35856442829882, -1185.6639834448151, -1334.591635578821, -91.64899857074823, -57.61167580254529, -994.4482033557939, -1331.0284866132006, -244.64185240631423, -411.55198998576554, -96.66056366802299, -121.66816678310829, -25.85661116926784, -1308.2359026752733, -1336.9562216055067, -592.2848786922561, -435.2202537670547, -625.0389746038753, -1036.553605655777, -178.57993357850782, -1199.552438487126]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550469517132498, "mean_inference_ms": 1.6752866815727154, "mean_action_processing_ms": 0.2769697739774076, "mean_env_wait_ms": 3.4533281846705974, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012163639068603516, "StateBufferConnector_ms": 0.008427858352661133, "ViewRequirementAgentConnector_ms": 0.19326210021972656}, "num_episodes": 36, "episode_return_max": -25.85661116926784, "episode_return_min": -1336.9562216055067, "episode_return_mean": -624.3712630148682, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 295.7061071998654, "num_env_steps_trained_throughput_per_sec": 295.7061071998654, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12970.97, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12970.898, "sample_time_ms": 1127.435, "learn_time_ms": 11778.06, "learn_throughput": 339.615, "synch_weights_time_ms": 64.622}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00001", "date": "2024-08-04_05-36-46", "timestamp": 1722730006, "time_this_iter_s": 13.54111647605896, "time_total_s": 222.19709420204163, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5f910>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 222.19709420204163, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 17.4, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 194.15421054959296, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.776773030931751, "policy_loss": -0.0030503369523406337, "vf_loss": 2.77706589239339, "vf_explained_var": 0.9680349847301841, "kl": 0.01397476446036309, "entropy": 1.4349696453660727, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -25.85661116926784, "episode_reward_min": -1336.9562216055067, "episode_reward_mean": -628.31101267984, "episode_len_mean": 124.99, "episode_media": {}, "episodes_timesteps_total": 12499, "policy_reward_min": {"policy_0": -1336.9562216055067}, "policy_reward_max": {"policy_0": -25.85661116926784}, "policy_reward_mean": {"policy_0": -628.31101267984}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-836.0476517903546, -334.80789871222584, -1159.9254401151732, -1207.6722732895437, -791.1035448263075, -1106.714428645366, -1043.5358445764207, -274.32231160067323, -773.2701524153176, -1002.2506995997426, -231.3027591038769, -1330.9838069596221, -197.80778905683454, -1330.9667654259695, -665.7311674181965, -234.59881736821592, -917.3687459377346, -44.619458699941816, -276.4849002930787, -862.4392211791331, -404.70270841633084, -323.9496275274689, -346.2194540745285, -864.5451962914777, -846.8065437856704, -711.5672503599658, -669.9408918417664, -839.5672697651144, -297.7264507117729, -114.36669587621317, -396.2367210093145, -596.5381048280478, -1140.776213888097, -257.4784351030104, -51.764195890477076, -348.1856591973006, -155.0302225799941, -926.8126144156049, -446.24216865997636, -321.73335301452863, -1106.5941182722825, -204.03200035271254, -110.75335823047338, -77.06276876922875, -451.2197594061057, -875.7481589185503, -651.8888013887722, -880.2633884261779, -259.11417823625106, -134.35856442829882, -1185.6639834448151, -1334.591635578821, -91.64899857074823, -57.61167580254529, -994.4482033557939, -1331.0284866132006, -244.64185240631423, -411.55198998576554, -96.66056366802299, -121.66816678310829, -25.85661116926784, -1308.2359026752733, -1336.9562216055067, -592.2848786922561, -435.2202537670547, -625.0389746038753, -1036.553605655777, -178.57993357850782, -1199.552438487126, -888.9340536436601, -571.3362217837853, -894.1706720980466, -428.5023143615594, -44.93661509695261, -646.172318047103, -206.7571836417922, -987.6599823375979, -987.178351869866, -150.13924713489786, -550.6331948622369, -1009.378655072913, -50.70582692360042, -584.4775092196948, -385.5149846448296, -873.668402158538, -368.55521709118284, -1021.3562165329472, -864.2449753469418, -365.5403523011765, -663.5263463309794, -116.72587586000473, -583.6932880622472, -1233.2704884898246, -1214.7169672404373, -731.6770869930562, -722.650053916132, -307.6248543620514, -1073.5708895255648, -941.6538844906165, -1321.156311420742], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 89, 150, 150, 92, 150, 66, 150, 150, 72, 150, 46, 150, 150, 132, 150, 104, 150, 150, 150, 150, 150, 86, 81, 150, 150, 150, 97, 46, 106, 72, 150, 147, 81, 150, 62, 73, 63, 150, 150, 150, 150, 113, 68, 150, 150, 62, 49, 150, 150, 96, 150, 55, 99, 39, 150, 150, 150, 117, 137, 150, 58, 150, 150, 132, 150, 150, 53, 150, 91, 150, 150, 80, 150, 150, 55, 150, 112, 150, 131, 150, 150, 150, 121, 71, 141, 150, 150, 145, 150, 109, 150, 150, 150], "policy_policy_0_reward": [-836.0476517903546, -334.80789871222584, -1159.9254401151732, -1207.6722732895437, -791.1035448263075, -1106.714428645366, -1043.5358445764207, -274.32231160067323, -773.2701524153176, -1002.2506995997426, -231.3027591038769, -1330.9838069596221, -197.80778905683454, -1330.9667654259695, -665.7311674181965, -234.59881736821592, -917.3687459377346, -44.619458699941816, -276.4849002930787, -862.4392211791331, -404.70270841633084, -323.9496275274689, -346.2194540745285, -864.5451962914777, -846.8065437856704, -711.5672503599658, -669.9408918417664, -839.5672697651144, -297.7264507117729, -114.36669587621317, -396.2367210093145, -596.5381048280478, -1140.776213888097, -257.4784351030104, -51.764195890477076, -348.1856591973006, -155.0302225799941, -926.8126144156049, -446.24216865997636, -321.73335301452863, -1106.5941182722825, -204.03200035271254, -110.75335823047338, -77.06276876922875, -451.2197594061057, -875.7481589185503, -651.8888013887722, -880.2633884261779, -259.11417823625106, -134.35856442829882, -1185.6639834448151, -1334.591635578821, -91.64899857074823, -57.61167580254529, -994.4482033557939, -1331.0284866132006, -244.64185240631423, -411.55198998576554, -96.66056366802299, -121.66816678310829, -25.85661116926784, -1308.2359026752733, -1336.9562216055067, -592.2848786922561, -435.2202537670547, -625.0389746038753, -1036.553605655777, -178.57993357850782, -1199.552438487126, -888.9340536436601, -571.3362217837853, -894.1706720980466, -428.5023143615594, -44.93661509695261, -646.172318047103, -206.7571836417922, -987.6599823375979, -987.178351869866, -150.13924713489786, -550.6331948622369, -1009.378655072913, -50.70582692360042, -584.4775092196948, -385.5149846448296, -873.668402158538, -368.55521709118284, -1021.3562165329472, -864.2449753469418, -365.5403523011765, -663.5263463309794, -116.72587586000473, -583.6932880622472, -1233.2704884898246, -1214.7169672404373, -731.6770869930562, -722.650053916132, -307.6248543620514, -1073.5708895255648, -941.6538844906165, -1321.156311420742]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548041789236164, "mean_inference_ms": 1.674276816513392, "mean_action_processing_ms": 0.2767875946363384, "mean_env_wait_ms": 3.454468158744632, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011963367462158203, "StateBufferConnector_ms": 0.00837564468383789, "ViewRequirementAgentConnector_ms": 0.19285321235656738}, "num_episodes": 31, "episode_return_max": -25.85661116926784, "episode_return_min": -1336.9562216055067, "episode_return_mean": -628.31101267984, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.91183667258707, "num_env_steps_trained_throughput_per_sec": 299.91183667258707, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12969.017, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12968.943, "sample_time_ms": 1123.709, "learn_time_ms": 11778.62, "learn_throughput": 339.598, "synch_weights_time_ms": 65.84}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00001", "date": "2024-08-04_05-36-59", "timestamp": 1722730019, "time_this_iter_s": 13.350455045700073, "time_total_s": 235.5475492477417, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f641f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 235.5475492477417, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.55263157894737, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 214.70905879934628, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.4604094070071976, "policy_loss": -0.01092713773396099, "vf_loss": 2.4685583719362816, "vf_explained_var": 0.9885888891294599, "kl": 0.01406699255667263, "entropy": 1.4419226185729106, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -25.85661116926784, "episode_reward_min": -1378.6536949707354, "episode_reward_mean": -584.821430100096, "episode_len_mean": 120.91, "episode_media": {}, "episodes_timesteps_total": 12091, "policy_reward_min": {"policy_0": -1378.6536949707354}, "policy_reward_max": {"policy_0": -25.85661116926784}, "policy_reward_mean": {"policy_0": -584.821430100096}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-155.0302225799941, -926.8126144156049, -446.24216865997636, -321.73335301452863, -1106.5941182722825, -204.03200035271254, -110.75335823047338, -77.06276876922875, -451.2197594061057, -875.7481589185503, -651.8888013887722, -880.2633884261779, -259.11417823625106, -134.35856442829882, -1185.6639834448151, -1334.591635578821, -91.64899857074823, -57.61167580254529, -994.4482033557939, -1331.0284866132006, -244.64185240631423, -411.55198998576554, -96.66056366802299, -121.66816678310829, -25.85661116926784, -1308.2359026752733, -1336.9562216055067, -592.2848786922561, -435.2202537670547, -625.0389746038753, -1036.553605655777, -178.57993357850782, -1199.552438487126, -888.9340536436601, -571.3362217837853, -894.1706720980466, -428.5023143615594, -44.93661509695261, -646.172318047103, -206.7571836417922, -987.6599823375979, -987.178351869866, -150.13924713489786, -550.6331948622369, -1009.378655072913, -50.70582692360042, -584.4775092196948, -385.5149846448296, -873.668402158538, -368.55521709118284, -1021.3562165329472, -864.2449753469418, -365.5403523011765, -663.5263463309794, -116.72587586000473, -583.6932880622472, -1233.2704884898246, -1214.7169672404373, -731.6770869930562, -722.650053916132, -307.6248543620514, -1073.5708895255648, -941.6538844906165, -1321.156311420742, -382.4658529819875, -1100.4901772497312, -964.5995987468663, -1378.6536949707354, -1202.3106997406521, -844.9597451297473, -921.4229639944815, -36.99627001377633, -57.43181551912504, -795.6896759701298, -48.29051969692804, -395.77278478808296, -144.14548350869106, -737.9590693712038, -271.30708900977794, -216.59801741553974, -243.7418410125954, -682.3716330697963, -831.9962059762224, -1140.3061355132932, -338.5564383547403, -298.13675983605884, -584.7859951788023, -296.2751708974324, -441.2709066497449, -162.46507117824822, -169.2069759825202, -186.91186768592593, -328.44442288224724, -127.48230256328753, -862.7610762031098, -208.76947514674666, -412.40312753335405, -653.6531681054629, -963.7346183232567, -51.00018740558213], "episode_lengths": [72, 150, 147, 81, 150, 62, 73, 63, 150, 150, 150, 150, 113, 68, 150, 150, 62, 49, 150, 150, 96, 150, 55, 99, 39, 150, 150, 150, 117, 137, 150, 58, 150, 150, 132, 150, 150, 53, 150, 91, 150, 150, 80, 150, 150, 55, 150, 112, 150, 131, 150, 150, 150, 121, 71, 141, 150, 150, 145, 150, 109, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 50, 52, 150, 47, 141, 58, 150, 73, 126, 131, 150, 150, 150, 125, 135, 125, 76, 150, 94, 90, 60, 132, 70, 150, 74, 150, 150, 150, 51], "policy_policy_0_reward": [-155.0302225799941, -926.8126144156049, -446.24216865997636, -321.73335301452863, -1106.5941182722825, -204.03200035271254, -110.75335823047338, -77.06276876922875, -451.2197594061057, -875.7481589185503, -651.8888013887722, -880.2633884261779, -259.11417823625106, -134.35856442829882, -1185.6639834448151, -1334.591635578821, -91.64899857074823, -57.61167580254529, -994.4482033557939, -1331.0284866132006, -244.64185240631423, -411.55198998576554, -96.66056366802299, -121.66816678310829, -25.85661116926784, -1308.2359026752733, -1336.9562216055067, -592.2848786922561, -435.2202537670547, -625.0389746038753, -1036.553605655777, -178.57993357850782, -1199.552438487126, -888.9340536436601, -571.3362217837853, -894.1706720980466, -428.5023143615594, -44.93661509695261, -646.172318047103, -206.7571836417922, -987.6599823375979, -987.178351869866, -150.13924713489786, -550.6331948622369, -1009.378655072913, -50.70582692360042, -584.4775092196948, -385.5149846448296, -873.668402158538, -368.55521709118284, -1021.3562165329472, -864.2449753469418, -365.5403523011765, -663.5263463309794, -116.72587586000473, -583.6932880622472, -1233.2704884898246, -1214.7169672404373, -731.6770869930562, -722.650053916132, -307.6248543620514, -1073.5708895255648, -941.6538844906165, -1321.156311420742, -382.4658529819875, -1100.4901772497312, -964.5995987468663, -1378.6536949707354, -1202.3106997406521, -844.9597451297473, -921.4229639944815, -36.99627001377633, -57.43181551912504, -795.6896759701298, -48.29051969692804, -395.77278478808296, -144.14548350869106, -737.9590693712038, -271.30708900977794, -216.59801741553974, -243.7418410125954, -682.3716330697963, -831.9962059762224, -1140.3061355132932, -338.5564383547403, -298.13675983605884, -584.7859951788023, -296.2751708974324, -441.2709066497449, -162.46507117824822, -169.2069759825202, -186.91186768592593, -328.44442288224724, -127.48230256328753, -862.7610762031098, -208.76947514674666, -412.40312753335405, -653.6531681054629, -963.7346183232567, -51.00018740558213]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550378416058566, "mean_inference_ms": 1.6735881260640288, "mean_action_processing_ms": 0.27649817788555436, "mean_env_wait_ms": 3.455627239015276, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012151718139648438, "StateBufferConnector_ms": 0.008070230484008789, "ViewRequirementAgentConnector_ms": 0.1931900978088379}, "num_episodes": 36, "episode_return_max": -25.85661116926784, "episode_return_min": -1378.6536949707354, "episode_return_mean": -584.821430100096, "episodes_this_iter": 36}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 338.10201440468944, "num_env_steps_trained_throughput_per_sec": 338.10201440468944, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12812.955, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12812.878, "sample_time_ms": 1119.289, "learn_time_ms": 11625.492, "learn_throughput": 344.071, "synch_weights_time_ms": 67.307}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00001", "date": "2024-08-04_05-37-11", "timestamp": 1722730031, "time_this_iter_s": 11.844264268875122, "time_total_s": 247.39181351661682, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5c160>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 247.39181351661682, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.447058823529414, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 227.738153642416, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.3597821284085514, "policy_loss": -0.012582089858672893, "vf_loss": 2.368999687830607, "vf_explained_var": 0.9886357379456361, "kl": 0.015583913742860507, "entropy": 1.310645082592964, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -19.662749089313106, "episode_reward_min": -1378.6536949707354, "episode_reward_mean": -607.8032488998643, "episode_len_mean": 123.97, "episode_media": {}, "episodes_timesteps_total": 12397, "policy_reward_min": {"policy_0": -1378.6536949707354}, "policy_reward_max": {"policy_0": -19.662749089313106}, "policy_reward_mean": {"policy_0": -607.8032488998643}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1036.553605655777, -178.57993357850782, -1199.552438487126, -888.9340536436601, -571.3362217837853, -894.1706720980466, -428.5023143615594, -44.93661509695261, -646.172318047103, -206.7571836417922, -987.6599823375979, -987.178351869866, -150.13924713489786, -550.6331948622369, -1009.378655072913, -50.70582692360042, -584.4775092196948, -385.5149846448296, -873.668402158538, -368.55521709118284, -1021.3562165329472, -864.2449753469418, -365.5403523011765, -663.5263463309794, -116.72587586000473, -583.6932880622472, -1233.2704884898246, -1214.7169672404373, -731.6770869930562, -722.650053916132, -307.6248543620514, -1073.5708895255648, -941.6538844906165, -1321.156311420742, -382.4658529819875, -1100.4901772497312, -964.5995987468663, -1378.6536949707354, -1202.3106997406521, -844.9597451297473, -921.4229639944815, -36.99627001377633, -57.43181551912504, -795.6896759701298, -48.29051969692804, -395.77278478808296, -144.14548350869106, -737.9590693712038, -271.30708900977794, -216.59801741553974, -243.7418410125954, -682.3716330697963, -831.9962059762224, -1140.3061355132932, -338.5564383547403, -298.13675983605884, -584.7859951788023, -296.2751708974324, -441.2709066497449, -162.46507117824822, -169.2069759825202, -186.91186768592593, -328.44442288224724, -127.48230256328753, -862.7610762031098, -208.76947514674666, -412.40312753335405, -653.6531681054629, -963.7346183232567, -51.00018740558213, -472.44552012733794, -952.238456921232, -292.8006193151898, -1066.330276116612, -1165.9417789441861, -1069.1273008919768, -170.10929460536664, -1149.3102200851492, -85.07522334319607, -850.6678363925867, -1132.7515098461492, -796.0881130947179, -781.0436670906386, -914.5183449149938, -276.106848266905, -146.71604508718622, -339.74999831712165, -870.4896149112368, -249.0727582154486, -1087.5933689060828, -532.6949620671724, -1143.138793505051, -980.3883959204794, -643.6736057733079, -205.29595934855809, -167.0832261696355, -19.662749089313106, -492.9174156617947, -989.7593741804748, -49.352456689064276], "episode_lengths": [150, 58, 150, 150, 132, 150, 150, 53, 150, 91, 150, 150, 80, 150, 150, 55, 150, 112, 150, 131, 150, 150, 150, 121, 71, 141, 150, 150, 145, 150, 109, 150, 150, 150, 99, 150, 150, 150, 150, 150, 150, 50, 52, 150, 47, 141, 58, 150, 73, 126, 131, 150, 150, 150, 125, 135, 125, 76, 150, 94, 90, 60, 132, 70, 150, 74, 150, 150, 150, 51, 150, 150, 109, 150, 150, 150, 64, 150, 71, 150, 150, 141, 150, 150, 75, 69, 117, 150, 101, 150, 150, 150, 150, 150, 87, 98, 45, 150, 150, 62], "policy_policy_0_reward": [-1036.553605655777, -178.57993357850782, -1199.552438487126, -888.9340536436601, -571.3362217837853, -894.1706720980466, -428.5023143615594, -44.93661509695261, -646.172318047103, -206.7571836417922, -987.6599823375979, -987.178351869866, -150.13924713489786, -550.6331948622369, -1009.378655072913, -50.70582692360042, -584.4775092196948, -385.5149846448296, -873.668402158538, -368.55521709118284, -1021.3562165329472, -864.2449753469418, -365.5403523011765, -663.5263463309794, -116.72587586000473, -583.6932880622472, -1233.2704884898246, -1214.7169672404373, -731.6770869930562, -722.650053916132, -307.6248543620514, -1073.5708895255648, -941.6538844906165, -1321.156311420742, -382.4658529819875, -1100.4901772497312, -964.5995987468663, -1378.6536949707354, -1202.3106997406521, -844.9597451297473, -921.4229639944815, -36.99627001377633, -57.43181551912504, -795.6896759701298, -48.29051969692804, -395.77278478808296, -144.14548350869106, -737.9590693712038, -271.30708900977794, -216.59801741553974, -243.7418410125954, -682.3716330697963, -831.9962059762224, -1140.3061355132932, -338.5564383547403, -298.13675983605884, -584.7859951788023, -296.2751708974324, -441.2709066497449, -162.46507117824822, -169.2069759825202, -186.91186768592593, -328.44442288224724, -127.48230256328753, -862.7610762031098, -208.76947514674666, -412.40312753335405, -653.6531681054629, -963.7346183232567, -51.00018740558213, -472.44552012733794, -952.238456921232, -292.8006193151898, -1066.330276116612, -1165.9417789441861, -1069.1273008919768, -170.10929460536664, -1149.3102200851492, -85.07522334319607, -850.6678363925867, -1132.7515098461492, -796.0881130947179, -781.0436670906386, -914.5183449149938, -276.106848266905, -146.71604508718622, -339.74999831712165, -870.4896149112368, -249.0727582154486, -1087.5933689060828, -532.6949620671724, -1143.138793505051, -980.3883959204794, -643.6736057733079, -205.29595934855809, -167.0832261696355, -19.662749089313106, -492.9174156617947, -989.7593741804748, -49.352456689064276]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548707669103732, "mean_inference_ms": 1.6727010282026173, "mean_action_processing_ms": 0.27641320507231665, "mean_env_wait_ms": 3.453195900980037, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012019872665405273, "StateBufferConnector_ms": 0.008069515228271484, "ViewRequirementAgentConnector_ms": 0.19173336029052734}, "num_episodes": 30, "episode_return_max": -19.662749089313106, "episode_return_min": -1378.6536949707354, "episode_return_mean": -607.8032488998643, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 459.6607978772531, "num_env_steps_trained_throughput_per_sec": 459.6607978772531, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12364.494, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12364.417, "sample_time_ms": 1110.256, "learn_time_ms": 11184.167, "learn_throughput": 357.648, "synch_weights_time_ms": 69.18}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00001", "date": "2024-08-04_05-37-20", "timestamp": 1722730040, "time_this_iter_s": 8.716017246246338, "time_total_s": 256.10783076286316, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5c0d0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 256.10783076286316, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 21.74166666666667, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 167.0851988375187, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.802911290898919, "policy_loss": -0.011340389658289495, "vf_loss": 2.810807492956519, "vf_explained_var": 0.9872531026601792, "kl": 0.015749463577503793, "entropy": 1.2806471634656191, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -10.323102322218572, "episode_reward_min": -1378.6536949707354, "episode_reward_mean": -565.0441256776692, "episode_len_mean": 120.72, "episode_media": {}, "episodes_timesteps_total": 12072, "policy_reward_min": {"policy_0": -1378.6536949707354}, "policy_reward_max": {"policy_0": -10.323102322218572}, "policy_reward_mean": {"policy_0": -565.0441256776692}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-941.6538844906165, -1321.156311420742, -382.4658529819875, -1100.4901772497312, -964.5995987468663, -1378.6536949707354, -1202.3106997406521, -844.9597451297473, -921.4229639944815, -36.99627001377633, -57.43181551912504, -795.6896759701298, -48.29051969692804, -395.77278478808296, -144.14548350869106, -737.9590693712038, -271.30708900977794, -216.59801741553974, -243.7418410125954, -682.3716330697963, -831.9962059762224, -1140.3061355132932, -338.5564383547403, -298.13675983605884, -584.7859951788023, -296.2751708974324, -441.2709066497449, -162.46507117824822, -169.2069759825202, -186.91186768592593, -328.44442288224724, -127.48230256328753, -862.7610762031098, -208.76947514674666, -412.40312753335405, -653.6531681054629, -963.7346183232567, -51.00018740558213, -472.44552012733794, -952.238456921232, -292.8006193151898, -1066.330276116612, -1165.9417789441861, -1069.1273008919768, -170.10929460536664, -1149.3102200851492, -85.07522334319607, -850.6678363925867, -1132.7515098461492, -796.0881130947179, -781.0436670906386, -914.5183449149938, -276.106848266905, -146.71604508718622, -339.74999831712165, -870.4896149112368, -249.0727582154486, -1087.5933689060828, -532.6949620671724, -1143.138793505051, -980.3883959204794, -643.6736057733079, -205.29595934855809, -167.0832261696355, -19.662749089313106, -492.9174156617947, -989.7593741804748, -49.352456689064276, -355.98614597612806, -10.323102322218572, -127.49577407490354, -1235.1119439996987, -225.13267766503418, -621.6748080478199, -298.0259436857418, -967.7181217985503, -773.4701306278868, -43.71705883213579, -247.1824300345161, -1112.161668090561, -361.5416878513356, -564.2065369700385, -812.5127993554867, -732.6108607591582, -614.3293389715719, -465.4595836989403, -51.33262985803698, -141.70549581036494, -643.7663138111086, -141.42519563585057, -1121.2993452460105, -121.31794742524565, -1231.8738972426029, -495.6990653059577, -30.403211858967445, -731.7059143880498, -402.433710408673, -888.6574077730157, -999.297901929833, -96.51315099605206], "episode_lengths": [150, 150, 99, 150, 150, 150, 150, 150, 150, 50, 52, 150, 47, 141, 58, 150, 73, 126, 131, 150, 150, 150, 125, 135, 125, 76, 150, 94, 90, 60, 132, 70, 150, 74, 150, 150, 150, 51, 150, 150, 109, 150, 150, 150, 64, 150, 71, 150, 150, 141, 150, 150, 75, 69, 117, 150, 101, 150, 150, 150, 150, 150, 87, 98, 45, 150, 150, 62, 123, 36, 85, 150, 137, 150, 148, 150, 150, 50, 85, 150, 150, 150, 150, 150, 150, 101, 49, 82, 150, 56, 150, 82, 150, 150, 45, 150, 130, 150, 150, 65], "policy_policy_0_reward": [-941.6538844906165, -1321.156311420742, -382.4658529819875, -1100.4901772497312, -964.5995987468663, -1378.6536949707354, -1202.3106997406521, -844.9597451297473, -921.4229639944815, -36.99627001377633, -57.43181551912504, -795.6896759701298, -48.29051969692804, -395.77278478808296, -144.14548350869106, -737.9590693712038, -271.30708900977794, -216.59801741553974, -243.7418410125954, -682.3716330697963, -831.9962059762224, -1140.3061355132932, -338.5564383547403, -298.13675983605884, -584.7859951788023, -296.2751708974324, -441.2709066497449, -162.46507117824822, -169.2069759825202, -186.91186768592593, -328.44442288224724, -127.48230256328753, -862.7610762031098, -208.76947514674666, -412.40312753335405, -653.6531681054629, -963.7346183232567, -51.00018740558213, -472.44552012733794, -952.238456921232, -292.8006193151898, -1066.330276116612, -1165.9417789441861, -1069.1273008919768, -170.10929460536664, -1149.3102200851492, -85.07522334319607, -850.6678363925867, -1132.7515098461492, -796.0881130947179, -781.0436670906386, -914.5183449149938, -276.106848266905, -146.71604508718622, -339.74999831712165, -870.4896149112368, -249.0727582154486, -1087.5933689060828, -532.6949620671724, -1143.138793505051, -980.3883959204794, -643.6736057733079, -205.29595934855809, -167.0832261696355, -19.662749089313106, -492.9174156617947, -989.7593741804748, -49.352456689064276, -355.98614597612806, -10.323102322218572, -127.49577407490354, -1235.1119439996987, -225.13267766503418, -621.6748080478199, -298.0259436857418, -967.7181217985503, -773.4701306278868, -43.71705883213579, -247.1824300345161, -1112.161668090561, -361.5416878513356, -564.2065369700385, -812.5127993554867, -732.6108607591582, -614.3293389715719, -465.4595836989403, -51.33262985803698, -141.70549581036494, -643.7663138111086, -141.42519563585057, -1121.2993452460105, -121.31794742524565, -1231.8738972426029, -495.6990653059577, -30.403211858967445, -731.7059143880498, -402.433710408673, -888.6574077730157, -999.297901929833, -96.51315099605206]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5551343754023044, "mean_inference_ms": 1.672936184823473, "mean_action_processing_ms": 0.2761728188565662, "mean_env_wait_ms": 3.454501853870789, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012123823165893555, "StateBufferConnector_ms": 0.008030414581298828, "ViewRequirementAgentConnector_ms": 0.19151878356933594}, "num_episodes": 32, "episode_return_max": -10.323102322218572, "episode_return_min": -1378.6536949707354, "episode_return_mean": -565.0441256776692, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.85456933843017, "num_env_steps_trained_throughput_per_sec": 296.85456933843017, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12408.384, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12408.306, "sample_time_ms": 1130.268, "learn_time_ms": 11208.423, "learn_throughput": 356.874, "synch_weights_time_ms": 68.801}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00001", "date": "2024-08-04_05-37-33", "timestamp": 1722730053, "time_this_iter_s": 13.488295793533325, "time_total_s": 269.5961265563965, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5ee60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 269.5961265563965, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.410000000000004, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 194.31842772960664, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.7370766485730806, "policy_loss": -0.008766270942578558, "vf_loss": 2.742804558078448, "vf_explained_var": 0.9816471969087919, "kl": 0.014127582751552837, "entropy": 1.1999047393600146, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -10.323102322218572, "episode_reward_min": -1235.1119439996987, "episode_reward_mean": -561.6900420142279, "episode_len_mean": 122.34, "episode_media": {}, "episodes_timesteps_total": 12234, "policy_reward_min": {"policy_0": -1235.1119439996987}, "policy_reward_max": {"policy_0": -10.323102322218572}, "policy_reward_mean": {"policy_0": -561.6900420142279}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-412.40312753335405, -653.6531681054629, -963.7346183232567, -51.00018740558213, -472.44552012733794, -952.238456921232, -292.8006193151898, -1066.330276116612, -1165.9417789441861, -1069.1273008919768, -170.10929460536664, -1149.3102200851492, -85.07522334319607, -850.6678363925867, -1132.7515098461492, -796.0881130947179, -781.0436670906386, -914.5183449149938, -276.106848266905, -146.71604508718622, -339.74999831712165, -870.4896149112368, -249.0727582154486, -1087.5933689060828, -532.6949620671724, -1143.138793505051, -980.3883959204794, -643.6736057733079, -205.29595934855809, -167.0832261696355, -19.662749089313106, -492.9174156617947, -989.7593741804748, -49.352456689064276, -355.98614597612806, -10.323102322218572, -127.49577407490354, -1235.1119439996987, -225.13267766503418, -621.6748080478199, -298.0259436857418, -967.7181217985503, -773.4701306278868, -43.71705883213579, -247.1824300345161, -1112.161668090561, -361.5416878513356, -564.2065369700385, -812.5127993554867, -732.6108607591582, -614.3293389715719, -465.4595836989403, -51.33262985803698, -141.70549581036494, -643.7663138111086, -141.42519563585057, -1121.2993452460105, -121.31794742524565, -1231.8738972426029, -495.6990653059577, -30.403211858967445, -731.7059143880498, -402.433710408673, -888.6574077730157, -999.297901929833, -96.51315099605206, -1089.607719816508, -1056.13194644835, -939.4502032267047, -359.1935806940466, -226.56158302624868, -585.6331080709159, -610.6698678469334, -982.6312931403286, -129.67962923423244, -493.20899054044406, -864.5337793825291, -290.3251012360372, -408.8307010638357, -497.67440672543745, -836.0080018950374, -17.092447192385293, -1088.4743074040305, -724.9610344118275, -678.8786596182302, -817.0365235867815, -714.7397560015071, -45.092161117361094, -283.79664210098457, -118.49578007931586, -715.1980088048265, -309.47813438883946, -257.07558356769243, -477.5584502866996, -116.25779080516075, -1200.52936566335, -423.1822549365502, -509.9621284673981, -440.4764321613793, -21.552192863560727], "episode_lengths": [150, 150, 150, 51, 150, 150, 109, 150, 150, 150, 64, 150, 71, 150, 150, 141, 150, 150, 75, 69, 117, 150, 101, 150, 150, 150, 150, 150, 87, 98, 45, 150, 150, 62, 123, 36, 85, 150, 137, 150, 148, 150, 150, 50, 85, 150, 150, 150, 150, 150, 150, 101, 49, 82, 150, 56, 150, 82, 150, 150, 45, 150, 130, 150, 150, 65, 150, 150, 150, 150, 104, 150, 150, 150, 70, 150, 150, 109, 129, 150, 150, 43, 150, 150, 129, 150, 150, 44, 95, 72, 150, 112, 94, 114, 74, 150, 140, 150, 97, 44], "policy_policy_0_reward": [-412.40312753335405, -653.6531681054629, -963.7346183232567, -51.00018740558213, -472.44552012733794, -952.238456921232, -292.8006193151898, -1066.330276116612, -1165.9417789441861, -1069.1273008919768, -170.10929460536664, -1149.3102200851492, -85.07522334319607, -850.6678363925867, -1132.7515098461492, -796.0881130947179, -781.0436670906386, -914.5183449149938, -276.106848266905, -146.71604508718622, -339.74999831712165, -870.4896149112368, -249.0727582154486, -1087.5933689060828, -532.6949620671724, -1143.138793505051, -980.3883959204794, -643.6736057733079, -205.29595934855809, -167.0832261696355, -19.662749089313106, -492.9174156617947, -989.7593741804748, -49.352456689064276, -355.98614597612806, -10.323102322218572, -127.49577407490354, -1235.1119439996987, -225.13267766503418, -621.6748080478199, -298.0259436857418, -967.7181217985503, -773.4701306278868, -43.71705883213579, -247.1824300345161, -1112.161668090561, -361.5416878513356, -564.2065369700385, -812.5127993554867, -732.6108607591582, -614.3293389715719, -465.4595836989403, -51.33262985803698, -141.70549581036494, -643.7663138111086, -141.42519563585057, -1121.2993452460105, -121.31794742524565, -1231.8738972426029, -495.6990653059577, -30.403211858967445, -731.7059143880498, -402.433710408673, -888.6574077730157, -999.297901929833, -96.51315099605206, -1089.607719816508, -1056.13194644835, -939.4502032267047, -359.1935806940466, -226.56158302624868, -585.6331080709159, -610.6698678469334, -982.6312931403286, -129.67962923423244, -493.20899054044406, -864.5337793825291, -290.3251012360372, -408.8307010638357, -497.67440672543745, -836.0080018950374, -17.092447192385293, -1088.4743074040305, -724.9610344118275, -678.8786596182302, -817.0365235867815, -714.7397560015071, -45.092161117361094, -283.79664210098457, -118.49578007931586, -715.1980088048265, -309.47813438883946, -257.07558356769243, -477.5584502866996, -116.25779080516075, -1200.52936566335, -423.1822549365502, -509.9621284673981, -440.4764321613793, -21.552192863560727]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548615194155149, "mean_inference_ms": 1.6743913634343408, "mean_action_processing_ms": 0.2761367509287745, "mean_env_wait_ms": 3.4553468381839743, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01209568977355957, "StateBufferConnector_ms": 0.008074760437011719, "ViewRequirementAgentConnector_ms": 0.19277620315551758}, "num_episodes": 34, "episode_return_max": -10.323102322218572, "episode_return_min": -1235.1119439996987, "episode_return_mean": -561.6900420142279, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 299.26395250938253, "num_env_steps_trained_throughput_per_sec": 299.26395250938253, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12689.966, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12689.89, "sample_time_ms": 1131.617, "learn_time_ms": 11489.249, "learn_throughput": 348.152, "synch_weights_time_ms": 68.21}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00001", "date": "2024-08-04_05-37-47", "timestamp": 1722730067, "time_this_iter_s": 13.379610538482666, "time_total_s": 282.97573709487915, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5e680>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 282.97573709487915, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 17.37894736842106, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 232.69851671457292, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.527938209970792, "policy_loss": -0.00801645490185668, "vf_loss": 2.5324769455939533, "vf_explained_var": 0.9886007824291786, "kl": 0.015912906221941154, "entropy": 1.2961579259485005, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -10.323102322218572, "episode_reward_min": -1379.8759092618059, "episode_reward_mean": -551.6529617475139, "episode_len_mean": 123.35, "episode_media": {}, "episodes_timesteps_total": 12335, "policy_reward_min": {"policy_0": -1379.8759092618059}, "policy_reward_max": {"policy_0": -10.323102322218572}, "policy_reward_mean": {"policy_0": -551.6529617475139}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-167.0832261696355, -19.662749089313106, -492.9174156617947, -989.7593741804748, -49.352456689064276, -355.98614597612806, -10.323102322218572, -127.49577407490354, -1235.1119439996987, -225.13267766503418, -621.6748080478199, -298.0259436857418, -967.7181217985503, -773.4701306278868, -43.71705883213579, -247.1824300345161, -1112.161668090561, -361.5416878513356, -564.2065369700385, -812.5127993554867, -732.6108607591582, -614.3293389715719, -465.4595836989403, -51.33262985803698, -141.70549581036494, -643.7663138111086, -141.42519563585057, -1121.2993452460105, -121.31794742524565, -1231.8738972426029, -495.6990653059577, -30.403211858967445, -731.7059143880498, -402.433710408673, -888.6574077730157, -999.297901929833, -96.51315099605206, -1089.607719816508, -1056.13194644835, -939.4502032267047, -359.1935806940466, -226.56158302624868, -585.6331080709159, -610.6698678469334, -982.6312931403286, -129.67962923423244, -493.20899054044406, -864.5337793825291, -290.3251012360372, -408.8307010638357, -497.67440672543745, -836.0080018950374, -17.092447192385293, -1088.4743074040305, -724.9610344118275, -678.8786596182302, -817.0365235867815, -714.7397560015071, -45.092161117361094, -283.79664210098457, -118.49578007931586, -715.1980088048265, -309.47813438883946, -257.07558356769243, -477.5584502866996, -116.25779080516075, -1200.52936566335, -423.1822549365502, -509.9621284673981, -440.4764321613793, -21.552192863560727, -732.9242513296424, -1172.0688450781504, -104.61388078818838, -330.5974179849025, -894.4648202413551, -764.0601235186012, -141.5088635764649, -259.72916942509914, -521.4783173230039, -409.5215348717306, -554.509105980218, -464.2138601836024, -1310.2903437000198, -863.0108846248438, -497.736806233846, -809.3081341561734, -1201.969359514304, -567.8346913682728, -421.39919406822054, -685.8191023083125, -1379.8759092618059, -153.41095198966252, -826.150672290415, -442.8787603877542, -1148.115833103622, -702.7029679856397, -456.01880344101755, -551.1181021072656, -83.12087986200564], "episode_lengths": [98, 45, 150, 150, 62, 123, 36, 85, 150, 137, 150, 148, 150, 150, 50, 85, 150, 150, 150, 150, 150, 150, 101, 49, 82, 150, 56, 150, 82, 150, 150, 45, 150, 130, 150, 150, 65, 150, 150, 150, 150, 104, 150, 150, 150, 70, 150, 150, 109, 129, 150, 150, 43, 150, 150, 129, 150, 150, 44, 95, 72, 150, 112, 94, 114, 74, 150, 140, 150, 97, 44, 150, 150, 70, 99, 150, 150, 67, 107, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 82, 150, 137, 150, 150, 119, 150, 77], "policy_policy_0_reward": [-167.0832261696355, -19.662749089313106, -492.9174156617947, -989.7593741804748, -49.352456689064276, -355.98614597612806, -10.323102322218572, -127.49577407490354, -1235.1119439996987, -225.13267766503418, -621.6748080478199, -298.0259436857418, -967.7181217985503, -773.4701306278868, -43.71705883213579, -247.1824300345161, -1112.161668090561, -361.5416878513356, -564.2065369700385, -812.5127993554867, -732.6108607591582, -614.3293389715719, -465.4595836989403, -51.33262985803698, -141.70549581036494, -643.7663138111086, -141.42519563585057, -1121.2993452460105, -121.31794742524565, -1231.8738972426029, -495.6990653059577, -30.403211858967445, -731.7059143880498, -402.433710408673, -888.6574077730157, -999.297901929833, -96.51315099605206, -1089.607719816508, -1056.13194644835, -939.4502032267047, -359.1935806940466, -226.56158302624868, -585.6331080709159, -610.6698678469334, -982.6312931403286, -129.67962923423244, -493.20899054044406, -864.5337793825291, -290.3251012360372, -408.8307010638357, -497.67440672543745, -836.0080018950374, -17.092447192385293, -1088.4743074040305, -724.9610344118275, -678.8786596182302, -817.0365235867815, -714.7397560015071, -45.092161117361094, -283.79664210098457, -118.49578007931586, -715.1980088048265, -309.47813438883946, -257.07558356769243, -477.5584502866996, -116.25779080516075, -1200.52936566335, -423.1822549365502, -509.9621284673981, -440.4764321613793, -21.552192863560727, -732.9242513296424, -1172.0688450781504, -104.61388078818838, -330.5974179849025, -894.4648202413551, -764.0601235186012, -141.5088635764649, -259.72916942509914, -521.4783173230039, -409.5215348717306, -554.509105980218, -464.2138601836024, -1310.2903437000198, -863.0108846248438, -497.736806233846, -809.3081341561734, -1201.969359514304, -567.8346913682728, -421.39919406822054, -685.8191023083125, -1379.8759092618059, -153.41095198966252, -826.150672290415, -442.8787603877542, -1148.115833103622, -702.7029679856397, -456.01880344101755, -551.1181021072656, -83.12087986200564]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5548955371680396, "mean_inference_ms": 1.6751866217924984, "mean_action_processing_ms": 0.27606108186234496, "mean_env_wait_ms": 3.4586926317736286, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012337684631347656, "StateBufferConnector_ms": 0.008190155029296875, "ViewRequirementAgentConnector_ms": 0.19595646858215332}, "num_episodes": 29, "episode_return_max": -10.323102322218572, "episode_return_min": -1379.8759092618059, "episode_return_mean": -551.6529617475139, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.87496283712795, "num_env_steps_trained_throughput_per_sec": 297.87496283712795, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12692.452, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12692.377, "sample_time_ms": 1133.456, "learn_time_ms": 11490.992, "learn_throughput": 348.099, "synch_weights_time_ms": 67.126}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00001", "date": "2024-08-04_05-38-00", "timestamp": 1722730080, "time_this_iter_s": 13.441985368728638, "time_total_s": 296.4177224636078, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f64a60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 296.4177224636078, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 17.599999999999998, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 183.46749192674955, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.4936471158638596, "policy_loss": -0.009425019142023908, "vf_loss": 2.4993909444659947, "vf_explained_var": 0.9808754285176595, "kl": 0.016232204677392777, "entropy": 1.1884703053161503, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -17.092447192385293, "episode_reward_min": -1379.8759092618059, "episode_reward_mean": -581.9336650470018, "episode_len_mean": 126.99, "episode_media": {}, "episodes_timesteps_total": 12699, "policy_reward_min": {"policy_0": -1379.8759092618059}, "policy_reward_max": {"policy_0": -17.092447192385293}, "policy_reward_mean": {"policy_0": -581.9336650470018}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-731.7059143880498, -402.433710408673, -888.6574077730157, -999.297901929833, -96.51315099605206, -1089.607719816508, -1056.13194644835, -939.4502032267047, -359.1935806940466, -226.56158302624868, -585.6331080709159, -610.6698678469334, -982.6312931403286, -129.67962923423244, -493.20899054044406, -864.5337793825291, -290.3251012360372, -408.8307010638357, -497.67440672543745, -836.0080018950374, -17.092447192385293, -1088.4743074040305, -724.9610344118275, -678.8786596182302, -817.0365235867815, -714.7397560015071, -45.092161117361094, -283.79664210098457, -118.49578007931586, -715.1980088048265, -309.47813438883946, -257.07558356769243, -477.5584502866996, -116.25779080516075, -1200.52936566335, -423.1822549365502, -509.9621284673981, -440.4764321613793, -21.552192863560727, -732.9242513296424, -1172.0688450781504, -104.61388078818838, -330.5974179849025, -894.4648202413551, -764.0601235186012, -141.5088635764649, -259.72916942509914, -521.4783173230039, -409.5215348717306, -554.509105980218, -464.2138601836024, -1310.2903437000198, -863.0108846248438, -497.736806233846, -809.3081341561734, -1201.969359514304, -567.8346913682728, -421.39919406822054, -685.8191023083125, -1379.8759092618059, -153.41095198966252, -826.150672290415, -442.8787603877542, -1148.115833103622, -702.7029679856397, -456.01880344101755, -551.1181021072656, -83.12087986200564, -1224.8167867182533, -76.88872096540753, -711.5675911953001, -410.87038382676275, -236.10142072543704, -279.5738727136413, -796.4214068086461, -343.796669486368, -625.1819767033878, -516.4893799723134, -1025.1261870073188, -838.0991467704029, -630.236478369374, -808.4977270751774, -809.581484413011, -559.7703786260466, -148.55866177376262, -592.5253990975912, -714.9918548348664, -644.7095132207531, -178.97696419444722, -1039.9365807172949, -289.3963963240173, -782.7265894453291, -87.55704871474575, -898.2885064746074, -341.05691791331, -820.2247542014009, -1174.1662081971274, -56.71907688849944, -297.87952865185713, -333.5956546684955], "episode_lengths": [150, 130, 150, 150, 65, 150, 150, 150, 150, 104, 150, 150, 150, 70, 150, 150, 109, 129, 150, 150, 43, 150, 150, 129, 150, 150, 44, 95, 72, 150, 112, 94, 114, 74, 150, 140, 150, 97, 44, 150, 150, 70, 99, 150, 150, 67, 107, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 82, 150, 137, 150, 150, 119, 150, 77, 150, 59, 150, 150, 96, 81, 138, 110, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 146, 72, 150, 105, 150, 64, 150, 114, 150, 150, 59, 150, 100], "policy_policy_0_reward": [-731.7059143880498, -402.433710408673, -888.6574077730157, -999.297901929833, -96.51315099605206, -1089.607719816508, -1056.13194644835, -939.4502032267047, -359.1935806940466, -226.56158302624868, -585.6331080709159, -610.6698678469334, -982.6312931403286, -129.67962923423244, -493.20899054044406, -864.5337793825291, -290.3251012360372, -408.8307010638357, -497.67440672543745, -836.0080018950374, -17.092447192385293, -1088.4743074040305, -724.9610344118275, -678.8786596182302, -817.0365235867815, -714.7397560015071, -45.092161117361094, -283.79664210098457, -118.49578007931586, -715.1980088048265, -309.47813438883946, -257.07558356769243, -477.5584502866996, -116.25779080516075, -1200.52936566335, -423.1822549365502, -509.9621284673981, -440.4764321613793, -21.552192863560727, -732.9242513296424, -1172.0688450781504, -104.61388078818838, -330.5974179849025, -894.4648202413551, -764.0601235186012, -141.5088635764649, -259.72916942509914, -521.4783173230039, -409.5215348717306, -554.509105980218, -464.2138601836024, -1310.2903437000198, -863.0108846248438, -497.736806233846, -809.3081341561734, -1201.969359514304, -567.8346913682728, -421.39919406822054, -685.8191023083125, -1379.8759092618059, -153.41095198966252, -826.150672290415, -442.8787603877542, -1148.115833103622, -702.7029679856397, -456.01880344101755, -551.1181021072656, -83.12087986200564, -1224.8167867182533, -76.88872096540753, -711.5675911953001, -410.87038382676275, -236.10142072543704, -279.5738727136413, -796.4214068086461, -343.796669486368, -625.1819767033878, -516.4893799723134, -1025.1261870073188, -838.0991467704029, -630.236478369374, -808.4977270751774, -809.581484413011, -559.7703786260466, -148.55866177376262, -592.5253990975912, -714.9918548348664, -644.7095132207531, -178.97696419444722, -1039.9365807172949, -289.3963963240173, -782.7265894453291, -87.55704871474575, -898.2885064746074, -341.05691791331, -820.2247542014009, -1174.1662081971274, -56.71907688849944, -297.87952865185713, -333.5956546684955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5550731549420171, "mean_inference_ms": 1.6758380410880573, "mean_action_processing_ms": 0.27615267053435966, "mean_env_wait_ms": 3.4607567195964357, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012137889862060547, "StateBufferConnector_ms": 0.008224248886108398, "ViewRequirementAgentConnector_ms": 0.20271611213684082}, "num_episodes": 32, "episode_return_max": -17.092447192385293, "episode_return_min": -1379.8759092618059, "episode_return_mean": -581.9336650470018, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 352.66094465167356, "num_env_steps_trained_throughput_per_sec": 352.66094465167356, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12500.304, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12500.229, "sample_time_ms": 1135.057, "learn_time_ms": 11296.655, "learn_throughput": 354.087, "synch_weights_time_ms": 67.717}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00001", "date": "2024-08-04_05-38-12", "timestamp": 1722730092, "time_this_iter_s": 11.353355407714844, "time_total_s": 307.77107787132263, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f64940>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 307.77107787132263, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 19.3875, "ram_util_percent": 27.9}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 193.2856004347404, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 2.6455109971265, "policy_loss": -0.007906605459478062, "vf_loss": 2.6501791197806597, "vf_explained_var": 0.9875839028507472, "kl": 0.0151055044144717, "entropy": 1.2931665811687707, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -35.42379809609338, "episode_reward_min": -1379.8759092618059, "episode_reward_mean": -576.0317450995115, "episode_len_mean": 123.22, "episode_media": {}, "episodes_timesteps_total": 12322, "policy_reward_min": {"policy_0": -1379.8759092618059}, "policy_reward_max": {"policy_0": -35.42379809609338}, "policy_reward_mean": {"policy_0": -576.0317450995115}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-732.9242513296424, -1172.0688450781504, -104.61388078818838, -330.5974179849025, -894.4648202413551, -764.0601235186012, -141.5088635764649, -259.72916942509914, -521.4783173230039, -409.5215348717306, -554.509105980218, -464.2138601836024, -1310.2903437000198, -863.0108846248438, -497.736806233846, -809.3081341561734, -1201.969359514304, -567.8346913682728, -421.39919406822054, -685.8191023083125, -1379.8759092618059, -153.41095198966252, -826.150672290415, -442.8787603877542, -1148.115833103622, -702.7029679856397, -456.01880344101755, -551.1181021072656, -83.12087986200564, -1224.8167867182533, -76.88872096540753, -711.5675911953001, -410.87038382676275, -236.10142072543704, -279.5738727136413, -796.4214068086461, -343.796669486368, -625.1819767033878, -516.4893799723134, -1025.1261870073188, -838.0991467704029, -630.236478369374, -808.4977270751774, -809.581484413011, -559.7703786260466, -148.55866177376262, -592.5253990975912, -714.9918548348664, -644.7095132207531, -178.97696419444722, -1039.9365807172949, -289.3963963240173, -782.7265894453291, -87.55704871474575, -898.2885064746074, -341.05691791331, -820.2247542014009, -1174.1662081971274, -56.71907688849944, -297.87952865185713, -333.5956546684955, -877.2880914093571, -658.9800053852999, -680.4634776596042, -970.2914991225381, -992.6104238777525, -380.5271199873, -261.50974347355054, -123.83353780823684, -639.5744963027349, -595.0406044663638, -237.15381521274762, -418.37263512852616, -983.4248933823233, -1300.7953582049995, -927.3264190679499, -806.3794232165063, -1056.0725054999357, -307.8157280063445, -228.95544812235272, -553.3051213134944, -117.64804799322157, -217.36468528948095, -245.25204065191429, -167.7683365257157, -176.14981486692466, -35.42379809609338, -1208.3092628063534, -726.5454183375365, -102.25115479436667, -810.8899351308313, -1116.2123613235108, -122.261231684597, -195.85130022850183, -218.60167530339598, -64.18118752114954, -863.196340163261, -214.67721631618073, -1109.304870863158, -146.7846320079436], "episode_lengths": [150, 150, 70, 99, 150, 150, 67, 107, 150, 127, 150, 150, 150, 150, 150, 150, 150, 150, 101, 150, 150, 82, 150, 137, 150, 150, 119, 150, 77, 150, 59, 150, 150, 96, 81, 138, 110, 150, 150, 150, 150, 150, 150, 150, 150, 54, 150, 150, 146, 72, 150, 105, 150, 64, 150, 114, 150, 150, 59, 150, 100, 150, 150, 150, 150, 150, 92, 96, 65, 150, 138, 70, 125, 150, 150, 150, 150, 150, 101, 89, 150, 71, 83, 79, 80, 81, 47, 150, 126, 71, 150, 150, 72, 93, 95, 53, 150, 88, 150, 73], "policy_policy_0_reward": [-732.9242513296424, -1172.0688450781504, -104.61388078818838, -330.5974179849025, -894.4648202413551, -764.0601235186012, -141.5088635764649, -259.72916942509914, -521.4783173230039, -409.5215348717306, -554.509105980218, -464.2138601836024, -1310.2903437000198, -863.0108846248438, -497.736806233846, -809.3081341561734, -1201.969359514304, -567.8346913682728, -421.39919406822054, -685.8191023083125, -1379.8759092618059, -153.41095198966252, -826.150672290415, -442.8787603877542, -1148.115833103622, -702.7029679856397, -456.01880344101755, -551.1181021072656, -83.12087986200564, -1224.8167867182533, -76.88872096540753, -711.5675911953001, -410.87038382676275, -236.10142072543704, -279.5738727136413, -796.4214068086461, -343.796669486368, -625.1819767033878, -516.4893799723134, -1025.1261870073188, -838.0991467704029, -630.236478369374, -808.4977270751774, -809.581484413011, -559.7703786260466, -148.55866177376262, -592.5253990975912, -714.9918548348664, -644.7095132207531, -178.97696419444722, -1039.9365807172949, -289.3963963240173, -782.7265894453291, -87.55704871474575, -898.2885064746074, -341.05691791331, -820.2247542014009, -1174.1662081971274, -56.71907688849944, -297.87952865185713, -333.5956546684955, -877.2880914093571, -658.9800053852999, -680.4634776596042, -970.2914991225381, -992.6104238777525, -380.5271199873, -261.50974347355054, -123.83353780823684, -639.5744963027349, -595.0406044663638, -237.15381521274762, -418.37263512852616, -983.4248933823233, -1300.7953582049995, -927.3264190679499, -806.3794232165063, -1056.0725054999357, -307.8157280063445, -228.95544812235272, -553.3051213134944, -117.64804799322157, -217.36468528948095, -245.25204065191429, -167.7683365257157, -176.14981486692466, -35.42379809609338, -1208.3092628063534, -726.5454183375365, -102.25115479436667, -810.8899351308313, -1116.2123613235108, -122.261231684597, -195.85130022850183, -218.60167530339598, -64.18118752114954, -863.196340163261, -214.67721631618073, -1109.304870863158, -146.7846320079436]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549896345454696, "mean_inference_ms": 1.6738801452418144, "mean_action_processing_ms": 0.27585290419950836, "mean_env_wait_ms": 3.457835613328637, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012203216552734375, "StateBufferConnector_ms": 0.008289575576782227, "ViewRequirementAgentConnector_ms": 0.20876765251159668}, "num_episodes": 39, "episode_return_max": -35.42379809609338, "episode_return_min": -1379.8759092618059, "episode_return_mean": -576.0317450995115, "episodes_this_iter": 39}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.97204977887367, "num_env_steps_trained_throughput_per_sec": 298.97204977887367, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12557.543, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12557.468, "sample_time_ms": 1135.133, "learn_time_ms": 11352.94, "learn_throughput": 352.332, "synch_weights_time_ms": 68.59}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00001", "date": "2024-08-04_05-38-25", "timestamp": 1722730105, "time_this_iter_s": 13.390937089920044, "time_total_s": 321.1620149612427, "pid": 569403, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.93, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a16f5f250>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.93, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 321.1620149612427, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 17.505263157894735, "ram_util_percent": 27.899999999999995}}
