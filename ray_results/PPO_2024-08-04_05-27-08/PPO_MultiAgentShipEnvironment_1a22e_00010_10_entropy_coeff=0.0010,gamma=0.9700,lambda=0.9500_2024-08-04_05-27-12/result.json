{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9135026641500493, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.76350152293841, "policy_loss": -0.007525401304883416, "vf_loss": 9.770383688807488, "vf_explained_var": 0.004331932341059049, "kl": 0.010219336913117634, "entropy": 1.4006247293204068, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -89.3687830559323, "episode_reward_min": -1306.1973431758613, "episode_reward_mean": -846.1382087898729, "episode_len_mean": 135.56, "episode_media": {}, "episodes_timesteps_total": 3389, "policy_reward_min": {"policy_0": -1306.1973431758613}, "policy_reward_max": {"policy_0": -89.3687830559323}, "policy_reward_mean": {"policy_0": -846.1382087898729}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1306.1973431758613, -1259.4966285396831, -1044.7963011991465, -1219.135803263414, -1100.4297674309805, -830.6825783421234, -768.6047366966604, -1169.370328114195, -1055.1914043329477, -626.8601653207108, -89.3687830559323, -367.5662519370714, -897.4677290071328, -1010.6006906966953, -774.0784227611485, -976.3203977714534, -1075.5332751851925, -834.9529883831864, -330.53965021548265, -641.4203120954033, -1115.8675612626005, -168.80022294930671, -381.93730912863396, -989.3079767831056, -1118.9285920987581], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 94, 150, 150, 130, 150, 150, 150, 103, 150, 150, 69, 89, 150, 150], "policy_policy_0_reward": [-1306.1973431758613, -1259.4966285396831, -1044.7963011991465, -1219.135803263414, -1100.4297674309805, -830.6825783421234, -768.6047366966604, -1169.370328114195, -1055.1914043329477, -626.8601653207108, -89.3687830559323, -367.5662519370714, -897.4677290071328, -1010.6006906966953, -774.0784227611485, -976.3203977714534, -1075.5332751851925, -834.9529883831864, -330.53965021548265, -641.4203120954033, -1115.8675612626005, -168.80022294930671, -381.93730912863396, -989.3079767831056, -1118.9285920987581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5730060057491309, "mean_inference_ms": 1.6779131743708269, "mean_action_processing_ms": 0.280660708823619, "mean_env_wait_ms": 3.4178756691943644, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011681556701660156, "StateBufferConnector_ms": 0.03010845184326172, "ViewRequirementAgentConnector_ms": 0.18623733520507812}, "num_episodes": 25, "episode_return_max": -89.3687830559323, "episode_return_min": -1306.1973431758613, "episode_return_mean": -846.1382087898729, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 332.2567655623316, "num_env_steps_trained_throughput_per_sec": 332.2567655623316, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12038.893, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12038.825, "sample_time_ms": 1121.551, "learn_time_ms": 10857.687, "learn_throughput": 368.403, "synch_weights_time_ms": 58.833}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00010", "date": "2024-08-04_06-23-47", "timestamp": 1722732827, "time_this_iter_s": 12.050714254379272, "time_total_s": 12.050714254379272, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f18040>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.050714254379272, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.82222222222222, "ram_util_percent": 27.89444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8698275270250936, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.807479642828305, "policy_loss": -0.004829231829110843, "vf_loss": 9.811823506156603, "vf_explained_var": -0.0023438207184274993, "kl": 0.009626085035339809, "entropy": 1.439825497319301, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -89.3687830559323, "episode_reward_min": -1487.6393549851773, "episode_reward_mean": -869.2973795830843, "episode_len_mean": 138.42, "episode_media": {}, "episodes_timesteps_total": 6921, "policy_reward_min": {"policy_0": -1487.6393549851773}, "policy_reward_max": {"policy_0": -89.3687830559323}, "policy_reward_mean": {"policy_0": -869.2973795830843}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1306.1973431758613, -1259.4966285396831, -1044.7963011991465, -1219.135803263414, -1100.4297674309805, -830.6825783421234, -768.6047366966604, -1169.370328114195, -1055.1914043329477, -626.8601653207108, -89.3687830559323, -367.5662519370714, -897.4677290071328, -1010.6006906966953, -774.0784227611485, -976.3203977714534, -1075.5332751851925, -834.9529883831864, -330.53965021548265, -641.4203120954033, -1115.8675612626005, -168.80022294930671, -381.93730912863396, -989.3079767831056, -1118.9285920987581, -903.3754907406167, -888.9269133240223, -430.3738429654967, -338.35925708199966, -721.6651157056797, -462.3591106470623, -956.7210081956266, -681.7266604403931, -991.3745004482046, -1406.4512327739437, -813.710894539668, -897.7367256554006, -1261.4013621358133, -1174.1474114597888, -953.928443551331, -915.4300413274979, -970.6696768409627, -885.2569852490766, -345.5408647543029, -461.6370178275013, -1388.8617963631084, -1112.7987932697959, -851.4689388125711, -1009.8523203123502, -1487.6393549851773], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 94, 150, 150, 130, 150, 150, 150, 103, 150, 150, 69, 89, 150, 150, 150, 150, 99, 88, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-1306.1973431758613, -1259.4966285396831, -1044.7963011991465, -1219.135803263414, -1100.4297674309805, -830.6825783421234, -768.6047366966604, -1169.370328114195, -1055.1914043329477, -626.8601653207108, -89.3687830559323, -367.5662519370714, -897.4677290071328, -1010.6006906966953, -774.0784227611485, -976.3203977714534, -1075.5332751851925, -834.9529883831864, -330.53965021548265, -641.4203120954033, -1115.8675612626005, -168.80022294930671, -381.93730912863396, -989.3079767831056, -1118.9285920987581, -903.3754907406167, -888.9269133240223, -430.3738429654967, -338.35925708199966, -721.6651157056797, -462.3591106470623, -956.7210081956266, -681.7266604403931, -991.3745004482046, -1406.4512327739437, -813.710894539668, -897.7367256554006, -1261.4013621358133, -1174.1474114597888, -953.928443551331, -915.4300413274979, -970.6696768409627, -885.2569852490766, -345.5408647543029, -461.6370178275013, -1388.8617963631084, -1112.7987932697959, -851.4689388125711, -1009.8523203123502, -1487.6393549851773]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5671282542105833, "mean_inference_ms": 1.6723155617787515, "mean_action_processing_ms": 0.2804488003798169, "mean_env_wait_ms": 3.4138713213261234, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.014229774475097656, "StateBufferConnector_ms": 0.019250869750976562, "ViewRequirementAgentConnector_ms": 0.18365955352783203}, "num_episodes": 25, "episode_return_max": -89.3687830559323, "episode_return_min": -1487.6393549851773, "episode_return_mean": -869.2973795830843, "episodes_this_iter": 25}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.74380128551854, "num_env_steps_trained_throughput_per_sec": 310.74380128551854, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 12455.623, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12455.552, "sample_time_ms": 1128.116, "learn_time_ms": 11268.807, "learn_throughput": 354.962, "synch_weights_time_ms": 57.879}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00010", "date": "2024-08-04_06-24-00", "timestamp": 1722732840, "time_this_iter_s": 12.884373903274536, "time_total_s": 24.93508815765381, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f19750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 24.93508815765381, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.17222222222222, "ram_util_percent": 27.899999999999995}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.9296766368361811, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.72168612976869, "policy_loss": -0.008125867939088493, "vf_loss": 9.72862524986267, "vf_explained_var": 0.022395273856818675, "kl": 0.013039655152654935, "entropy": 1.421141880378127, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -23.512668412719286, "episode_reward_min": -1487.6393549851773, "episode_reward_mean": -765.1034157274371, "episode_len_mean": 127.60714285714286, "episode_media": {}, "episodes_timesteps_total": 10719, "policy_reward_min": {"policy_0": -1487.6393549851773}, "policy_reward_max": {"policy_0": -23.512668412719286}, "policy_reward_mean": {"policy_0": -765.1034157274371}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1306.1973431758613, -1259.4966285396831, -1044.7963011991465, -1219.135803263414, -1100.4297674309805, -830.6825783421234, -768.6047366966604, -1169.370328114195, -1055.1914043329477, -626.8601653207108, -89.3687830559323, -367.5662519370714, -897.4677290071328, -1010.6006906966953, -774.0784227611485, -976.3203977714534, -1075.5332751851925, -834.9529883831864, -330.53965021548265, -641.4203120954033, -1115.8675612626005, -168.80022294930671, -381.93730912863396, -989.3079767831056, -1118.9285920987581, -903.3754907406167, -888.9269133240223, -430.3738429654967, -338.35925708199966, -721.6651157056797, -462.3591106470623, -956.7210081956266, -681.7266604403931, -991.3745004482046, -1406.4512327739437, -813.710894539668, -897.7367256554006, -1261.4013621358133, -1174.1474114597888, -953.928443551331, -915.4300413274979, -970.6696768409627, -885.2569852490766, -345.5408647543029, -461.6370178275013, -1388.8617963631084, -1112.7987932697959, -851.4689388125711, -1009.8523203123502, -1487.6393549851773, -283.40958485608274, -778.3496862080763, -1293.17119270696, -1037.2962824728243, -873.5853075309384, -541.3959718517851, -221.53403735802436, -950.5345672716583, -1111.0581243428087, -1021.1686339296928, -118.74194231479375, -1100.4054984124527, -1228.6769652666767, -345.6206970748536, -825.5097904339332, -115.55353222929651, -1106.6791663796332, -1040.1491918574447, -23.512668412719286, -1139.674639786186, -1313.151281580657, -155.48764082676723, -823.9608932026766, -81.50871011638107, -173.05586902905264, -170.80141790894353, -55.598309966871795, -137.82999588697373, -893.7756588290301, -143.44656330525743, -1275.5434295590758, -96.94911283604803, -151.57308618570474, -175.10849202021876], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 54, 94, 150, 150, 130, 150, 150, 150, 103, 150, 150, 69, 89, 150, 150, 150, 150, 99, 88, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 91, 150, 150, 150, 150, 113, 66, 150, 150, 150, 71, 150, 150, 95, 150, 70, 150, 150, 38, 150, 150, 57, 150, 67, 83, 88, 54, 64, 150, 71, 150, 64, 76, 80], "policy_policy_0_reward": [-1306.1973431758613, -1259.4966285396831, -1044.7963011991465, -1219.135803263414, -1100.4297674309805, -830.6825783421234, -768.6047366966604, -1169.370328114195, -1055.1914043329477, -626.8601653207108, -89.3687830559323, -367.5662519370714, -897.4677290071328, -1010.6006906966953, -774.0784227611485, -976.3203977714534, -1075.5332751851925, -834.9529883831864, -330.53965021548265, -641.4203120954033, -1115.8675612626005, -168.80022294930671, -381.93730912863396, -989.3079767831056, -1118.9285920987581, -903.3754907406167, -888.9269133240223, -430.3738429654967, -338.35925708199966, -721.6651157056797, -462.3591106470623, -956.7210081956266, -681.7266604403931, -991.3745004482046, -1406.4512327739437, -813.710894539668, -897.7367256554006, -1261.4013621358133, -1174.1474114597888, -953.928443551331, -915.4300413274979, -970.6696768409627, -885.2569852490766, -345.5408647543029, -461.6370178275013, -1388.8617963631084, -1112.7987932697959, -851.4689388125711, -1009.8523203123502, -1487.6393549851773, -283.40958485608274, -778.3496862080763, -1293.17119270696, -1037.2962824728243, -873.5853075309384, -541.3959718517851, -221.53403735802436, -950.5345672716583, -1111.0581243428087, -1021.1686339296928, -118.74194231479375, -1100.4054984124527, -1228.6769652666767, -345.6206970748536, -825.5097904339332, -115.55353222929651, -1106.6791663796332, -1040.1491918574447, -23.512668412719286, -1139.674639786186, -1313.151281580657, -155.48764082676723, -823.9608932026766, -81.50871011638107, -173.05586902905264, -170.80141790894353, -55.598309966871795, -137.82999588697373, -893.7756588290301, -143.44656330525743, -1275.5434295590758, -96.94911283604803, -151.57308618570474, -175.10849202021876]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5657734391745813, "mean_inference_ms": 1.675773321778212, "mean_action_processing_ms": 0.2812919839487018, "mean_env_wait_ms": 3.4241184646270812, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013430345626104446, "StateBufferConnector_ms": 0.01484922000340053, "ViewRequirementAgentConnector_ms": 0.18442840803237187}, "num_episodes": 34, "episode_return_max": -23.512668412719286, "episode_return_min": -1487.6393549851773, "episode_return_mean": -765.1034157274371, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 311.1065230634109, "num_env_steps_trained_throughput_per_sec": 311.1065230634109, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12589.53, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12589.453, "sample_time_ms": 1119.694, "learn_time_ms": 11408.237, "learn_throughput": 350.624, "synch_weights_time_ms": 60.774}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00010", "date": "2024-08-04_06-24-13", "timestamp": 1722732853, "time_this_iter_s": 12.870915412902832, "time_total_s": 37.80600357055664, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1b010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 37.80600357055664, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 18.22222222222222, "ram_util_percent": 27.91111111111111}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0862454482354225, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.709478957454364, "policy_loss": -0.009924394993383127, "vf_loss": 9.71829426685969, "vf_explained_var": 0.03268420708676179, "kl": 0.013119450739971701, "entropy": 1.5148764178156853, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -5.7080068423439565, "episode_reward_min": -1487.6393549851773, "episode_reward_mean": -748.8302506641988, "episode_len_mean": 125.27, "episode_media": {}, "episodes_timesteps_total": 12527, "policy_reward_min": {"policy_0": -1487.6393549851773}, "policy_reward_max": {"policy_0": -5.7080068423439565}, "policy_reward_mean": {"policy_0": -748.8302506641988}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-774.0784227611485, -976.3203977714534, -1075.5332751851925, -834.9529883831864, -330.53965021548265, -641.4203120954033, -1115.8675612626005, -168.80022294930671, -381.93730912863396, -989.3079767831056, -1118.9285920987581, -903.3754907406167, -888.9269133240223, -430.3738429654967, -338.35925708199966, -721.6651157056797, -462.3591106470623, -956.7210081956266, -681.7266604403931, -991.3745004482046, -1406.4512327739437, -813.710894539668, -897.7367256554006, -1261.4013621358133, -1174.1474114597888, -953.928443551331, -915.4300413274979, -970.6696768409627, -885.2569852490766, -345.5408647543029, -461.6370178275013, -1388.8617963631084, -1112.7987932697959, -851.4689388125711, -1009.8523203123502, -1487.6393549851773, -283.40958485608274, -778.3496862080763, -1293.17119270696, -1037.2962824728243, -873.5853075309384, -541.3959718517851, -221.53403735802436, -950.5345672716583, -1111.0581243428087, -1021.1686339296928, -118.74194231479375, -1100.4054984124527, -1228.6769652666767, -345.6206970748536, -825.5097904339332, -115.55353222929651, -1106.6791663796332, -1040.1491918574447, -23.512668412719286, -1139.674639786186, -1313.151281580657, -155.48764082676723, -823.9608932026766, -81.50871011638107, -173.05586902905264, -170.80141790894353, -55.598309966871795, -137.82999588697373, -893.7756588290301, -143.44656330525743, -1275.5434295590758, -96.94911283604803, -151.57308618570474, -175.10849202021876, -1096.3607338695392, -1176.9824766423874, -1424.6388202729, -295.80770561302626, -5.7080068423439565, -50.222576098398065, -923.5207211447865, -1182.4883906445807, -1047.7399812090282, -1101.1726485487882, -1001.4047862405646, -833.7748352390118, -22.44398315618452, -1106.1594390427545, -1034.1047755323473, -321.42682420703915, -974.0319753188799, -178.60447241416398, -960.0245600357417, -918.9690963782983, -1122.8419959312105, -1086.591241164702, -1092.4410598643046, -73.99831775592666, -149.44795934332626, -297.6748903734837, -1119.3728908285975, -756.2035458268695, -1114.0296419698993, -891.9183049186211], "episode_lengths": [130, 150, 150, 150, 103, 150, 150, 69, 89, 150, 150, 150, 150, 99, 88, 150, 102, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 91, 150, 150, 150, 150, 113, 66, 150, 150, 150, 71, 150, 150, 95, 150, 70, 150, 150, 38, 150, 150, 57, 150, 67, 83, 88, 54, 64, 150, 71, 150, 64, 76, 80, 150, 150, 150, 79, 37, 53, 150, 150, 150, 150, 150, 150, 41, 150, 150, 113, 150, 79, 150, 150, 150, 150, 150, 60, 70, 87, 150, 137, 150, 150], "policy_policy_0_reward": [-774.0784227611485, -976.3203977714534, -1075.5332751851925, -834.9529883831864, -330.53965021548265, -641.4203120954033, -1115.8675612626005, -168.80022294930671, -381.93730912863396, -989.3079767831056, -1118.9285920987581, -903.3754907406167, -888.9269133240223, -430.3738429654967, -338.35925708199966, -721.6651157056797, -462.3591106470623, -956.7210081956266, -681.7266604403931, -991.3745004482046, -1406.4512327739437, -813.710894539668, -897.7367256554006, -1261.4013621358133, -1174.1474114597888, -953.928443551331, -915.4300413274979, -970.6696768409627, -885.2569852490766, -345.5408647543029, -461.6370178275013, -1388.8617963631084, -1112.7987932697959, -851.4689388125711, -1009.8523203123502, -1487.6393549851773, -283.40958485608274, -778.3496862080763, -1293.17119270696, -1037.2962824728243, -873.5853075309384, -541.3959718517851, -221.53403735802436, -950.5345672716583, -1111.0581243428087, -1021.1686339296928, -118.74194231479375, -1100.4054984124527, -1228.6769652666767, -345.6206970748536, -825.5097904339332, -115.55353222929651, -1106.6791663796332, -1040.1491918574447, -23.512668412719286, -1139.674639786186, -1313.151281580657, -155.48764082676723, -823.9608932026766, -81.50871011638107, -173.05586902905264, -170.80141790894353, -55.598309966871795, -137.82999588697373, -893.7756588290301, -143.44656330525743, -1275.5434295590758, -96.94911283604803, -151.57308618570474, -175.10849202021876, -1096.3607338695392, -1176.9824766423874, -1424.6388202729, -295.80770561302626, -5.7080068423439565, -50.222576098398065, -923.5207211447865, -1182.4883906445807, -1047.7399812090282, -1101.1726485487882, -1001.4047862405646, -833.7748352390118, -22.44398315618452, -1106.1594390427545, -1034.1047755323473, -321.42682420703915, -974.0319753188799, -178.60447241416398, -960.0245600357417, -918.9690963782983, -1122.8419959312105, -1086.591241164702, -1092.4410598643046, -73.99831775592666, -149.44795934332626, -297.6748903734837, -1119.3728908285975, -756.2035458268695, -1114.0296419698993, -891.9183049186211]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5616893100892881, "mean_inference_ms": 1.6732976550504108, "mean_action_processing_ms": 0.2809761192506488, "mean_env_wait_ms": 3.4196599434114567, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01397705078125, "StateBufferConnector_ms": 0.013908863067626953, "ViewRequirementAgentConnector_ms": 0.18694067001342773}, "num_episodes": 30, "episode_return_max": -5.7080068423439565, "episode_return_min": -1487.6393549851773, "episode_return_mean": -748.8302506641988, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 387.9633699955578, "num_env_steps_trained_throughput_per_sec": 387.9633699955578, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12019.714, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12019.634, "sample_time_ms": 1114.548, "learn_time_ms": 10844.258, "learn_throughput": 368.859, "synch_weights_time_ms": 60.079}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00010", "date": "2024-08-04_06-24-23", "timestamp": 1722732863, "time_this_iter_s": 10.322245836257935, "time_total_s": 48.128249406814575, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f18a60>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 48.128249406814575, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 19.833333333333336, "ram_util_percent": 27.986666666666668}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 2.444155443149308, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.398331838846207, "policy_loss": -0.013569650766051685, "vf_loss": 9.40950690805912, "vf_explained_var": 0.11356554993738731, "kl": 0.01891520812638798, "entropy": 1.388459183399876, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -5.7080068423439565, "episode_reward_min": -1487.6393549851773, "episode_reward_mean": -727.1654316470549, "episode_len_mean": 121.76, "episode_media": {}, "episodes_timesteps_total": 12176, "policy_reward_min": {"policy_0": -1487.6393549851773}, "policy_reward_max": {"policy_0": -5.7080068423439565}, "policy_reward_mean": {"policy_0": -727.1654316470549}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1388.8617963631084, -1112.7987932697959, -851.4689388125711, -1009.8523203123502, -1487.6393549851773, -283.40958485608274, -778.3496862080763, -1293.17119270696, -1037.2962824728243, -873.5853075309384, -541.3959718517851, -221.53403735802436, -950.5345672716583, -1111.0581243428087, -1021.1686339296928, -118.74194231479375, -1100.4054984124527, -1228.6769652666767, -345.6206970748536, -825.5097904339332, -115.55353222929651, -1106.6791663796332, -1040.1491918574447, -23.512668412719286, -1139.674639786186, -1313.151281580657, -155.48764082676723, -823.9608932026766, -81.50871011638107, -173.05586902905264, -170.80141790894353, -55.598309966871795, -137.82999588697373, -893.7756588290301, -143.44656330525743, -1275.5434295590758, -96.94911283604803, -151.57308618570474, -175.10849202021876, -1096.3607338695392, -1176.9824766423874, -1424.6388202729, -295.80770561302626, -5.7080068423439565, -50.222576098398065, -923.5207211447865, -1182.4883906445807, -1047.7399812090282, -1101.1726485487882, -1001.4047862405646, -833.7748352390118, -22.44398315618452, -1106.1594390427545, -1034.1047755323473, -321.42682420703915, -974.0319753188799, -178.60447241416398, -960.0245600357417, -918.9690963782983, -1122.8419959312105, -1086.591241164702, -1092.4410598643046, -73.99831775592666, -149.44795934332626, -297.6748903734837, -1119.3728908285975, -756.2035458268695, -1114.0296419698993, -891.9183049186211, -1080.5540834209048, -896.1451980954098, -1031.7585791940544, -1442.6154499212194, -214.23404265520307, -247.9065416051283, -1011.2649992882835, -113.32364797914909, -397.8213039091613, -1033.2671845457285, -973.798455520748, -1279.314941477461, -1442.895135941037, -906.8102802968343, -165.9347841397427, -614.8679902805189, -351.9507302671062, -267.339453859479, -1317.2629082685394, -912.7221085773266, -242.29655971864815, -89.87052965651809, -1271.9826320579057, -1293.9230346073352, -146.90466020418214, -1061.5668948188802, -403.5928982347685, -919.1061087869712, -87.86931929348992, -410.98565713356635, -1072.1112488289868], "episode_lengths": [150, 150, 150, 150, 150, 91, 150, 150, 150, 150, 113, 66, 150, 150, 150, 71, 150, 150, 95, 150, 70, 150, 150, 38, 150, 150, 57, 150, 67, 83, 88, 54, 64, 150, 71, 150, 64, 76, 80, 150, 150, 150, 79, 37, 53, 150, 150, 150, 150, 150, 150, 41, 150, 150, 113, 150, 79, 150, 150, 150, 150, 150, 60, 70, 87, 150, 137, 150, 150, 150, 150, 150, 150, 96, 97, 150, 51, 150, 150, 150, 150, 150, 150, 84, 150, 105, 76, 150, 150, 73, 71, 150, 150, 69, 150, 99, 150, 53, 148, 150], "policy_policy_0_reward": [-1388.8617963631084, -1112.7987932697959, -851.4689388125711, -1009.8523203123502, -1487.6393549851773, -283.40958485608274, -778.3496862080763, -1293.17119270696, -1037.2962824728243, -873.5853075309384, -541.3959718517851, -221.53403735802436, -950.5345672716583, -1111.0581243428087, -1021.1686339296928, -118.74194231479375, -1100.4054984124527, -1228.6769652666767, -345.6206970748536, -825.5097904339332, -115.55353222929651, -1106.6791663796332, -1040.1491918574447, -23.512668412719286, -1139.674639786186, -1313.151281580657, -155.48764082676723, -823.9608932026766, -81.50871011638107, -173.05586902905264, -170.80141790894353, -55.598309966871795, -137.82999588697373, -893.7756588290301, -143.44656330525743, -1275.5434295590758, -96.94911283604803, -151.57308618570474, -175.10849202021876, -1096.3607338695392, -1176.9824766423874, -1424.6388202729, -295.80770561302626, -5.7080068423439565, -50.222576098398065, -923.5207211447865, -1182.4883906445807, -1047.7399812090282, -1101.1726485487882, -1001.4047862405646, -833.7748352390118, -22.44398315618452, -1106.1594390427545, -1034.1047755323473, -321.42682420703915, -974.0319753188799, -178.60447241416398, -960.0245600357417, -918.9690963782983, -1122.8419959312105, -1086.591241164702, -1092.4410598643046, -73.99831775592666, -149.44795934332626, -297.6748903734837, -1119.3728908285975, -756.2035458268695, -1114.0296419698993, -891.9183049186211, -1080.5540834209048, -896.1451980954098, -1031.7585791940544, -1442.6154499212194, -214.23404265520307, -247.9065416051283, -1011.2649992882835, -113.32364797914909, -397.8213039091613, -1033.2671845457285, -973.798455520748, -1279.314941477461, -1442.895135941037, -906.8102802968343, -165.9347841397427, -614.8679902805189, -351.9507302671062, -267.339453859479, -1317.2629082685394, -912.7221085773266, -242.29655971864815, -89.87052965651809, -1271.9826320579057, -1293.9230346073352, -146.90466020418214, -1061.5668948188802, -403.5928982347685, -919.1061087869712, -87.86931929348992, -410.98565713356635, -1072.1112488289868]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5606300753735134, "mean_inference_ms": 1.680511623660482, "mean_action_processing_ms": 0.28198226210848104, "mean_env_wait_ms": 3.438408662219642, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013157844543457031, "StateBufferConnector_ms": 0.00843501091003418, "ViewRequirementAgentConnector_ms": 0.18808817863464355}, "num_episodes": 31, "episode_return_max": -5.7080068423439565, "episode_return_min": -1487.6393549851773, "episode_return_mean": -727.1654316470549, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 351.9804482906426, "num_env_steps_trained_throughput_per_sec": 351.9804482906426, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 11888.627, "restore_workers_time_ms": 0.034, "training_step_time_ms": 11888.549, "sample_time_ms": 1136.672, "learn_time_ms": 10685.499, "learn_throughput": 374.339, "synch_weights_time_ms": 65.605}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00010", "date": "2024-08-04_06-24-35", "timestamp": 1722732875, "time_this_iter_s": 11.377614259719849, "time_total_s": 59.505863666534424, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f19750>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 59.505863666534424, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 19.681250000000002, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.125328043786188, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.45021558602651, "policy_loss": -0.008519913456014667, "vf_loss": 9.457510488231977, "vf_explained_var": 0.17550349459052086, "kl": 0.013226861641669535, "entropy": 1.4203324973583222, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -5.7080068423439565, "episode_reward_min": -1442.895135941037, "episode_reward_mean": -692.1749290779361, "episode_len_mean": 122.24, "episode_media": {}, "episodes_timesteps_total": 12224, "policy_reward_min": {"policy_0": -1442.895135941037}, "policy_reward_max": {"policy_0": -5.7080068423439565}, "policy_reward_mean": {"policy_0": -692.1749290779361}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-137.82999588697373, -893.7756588290301, -143.44656330525743, -1275.5434295590758, -96.94911283604803, -151.57308618570474, -175.10849202021876, -1096.3607338695392, -1176.9824766423874, -1424.6388202729, -295.80770561302626, -5.7080068423439565, -50.222576098398065, -923.5207211447865, -1182.4883906445807, -1047.7399812090282, -1101.1726485487882, -1001.4047862405646, -833.7748352390118, -22.44398315618452, -1106.1594390427545, -1034.1047755323473, -321.42682420703915, -974.0319753188799, -178.60447241416398, -960.0245600357417, -918.9690963782983, -1122.8419959312105, -1086.591241164702, -1092.4410598643046, -73.99831775592666, -149.44795934332626, -297.6748903734837, -1119.3728908285975, -756.2035458268695, -1114.0296419698993, -891.9183049186211, -1080.5540834209048, -896.1451980954098, -1031.7585791940544, -1442.6154499212194, -214.23404265520307, -247.9065416051283, -1011.2649992882835, -113.32364797914909, -397.8213039091613, -1033.2671845457285, -973.798455520748, -1279.314941477461, -1442.895135941037, -906.8102802968343, -165.9347841397427, -614.8679902805189, -351.9507302671062, -267.339453859479, -1317.2629082685394, -912.7221085773266, -242.29655971864815, -89.87052965651809, -1271.9826320579057, -1293.9230346073352, -146.90466020418214, -1061.5668948188802, -403.5928982347685, -919.1061087869712, -87.86931929348992, -410.98565713356635, -1072.1112488289868, -154.2426594836862, -173.69309744528869, -1112.7040953785054, -1015.6638514591189, -918.0408974222273, -606.8573508584419, -1322.3485776640975, -188.69488014795317, -785.4760442588877, -330.83337611669384, -85.43093346752242, -521.3438649064724, -1027.6293394369532, -821.378410470378, -1153.075474722944, -44.47060116562228, -516.5703412133183, -692.6907864105756, -781.9378277451993, -781.2962514630668, -428.64205019221225, -221.34567181047987, -231.08608818283386, -527.7406765141964, -171.48403742695052, -122.21813359219259, -904.9217777120436, -977.8652286372142, -685.8095986751089, -770.3552862993292, -1160.409093713341, -1044.906246166449], "episode_lengths": [64, 150, 71, 150, 64, 76, 80, 150, 150, 150, 79, 37, 53, 150, 150, 150, 150, 150, 150, 41, 150, 150, 113, 150, 79, 150, 150, 150, 150, 150, 60, 70, 87, 150, 137, 150, 150, 150, 150, 150, 150, 96, 97, 150, 51, 150, 150, 150, 150, 150, 150, 84, 150, 105, 76, 150, 150, 73, 71, 150, 150, 69, 150, 99, 150, 53, 148, 150, 62, 65, 150, 150, 150, 150, 150, 95, 150, 107, 71, 111, 150, 150, 150, 49, 129, 150, 150, 150, 150, 79, 83, 108, 69, 63, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-137.82999588697373, -893.7756588290301, -143.44656330525743, -1275.5434295590758, -96.94911283604803, -151.57308618570474, -175.10849202021876, -1096.3607338695392, -1176.9824766423874, -1424.6388202729, -295.80770561302626, -5.7080068423439565, -50.222576098398065, -923.5207211447865, -1182.4883906445807, -1047.7399812090282, -1101.1726485487882, -1001.4047862405646, -833.7748352390118, -22.44398315618452, -1106.1594390427545, -1034.1047755323473, -321.42682420703915, -974.0319753188799, -178.60447241416398, -960.0245600357417, -918.9690963782983, -1122.8419959312105, -1086.591241164702, -1092.4410598643046, -73.99831775592666, -149.44795934332626, -297.6748903734837, -1119.3728908285975, -756.2035458268695, -1114.0296419698993, -891.9183049186211, -1080.5540834209048, -896.1451980954098, -1031.7585791940544, -1442.6154499212194, -214.23404265520307, -247.9065416051283, -1011.2649992882835, -113.32364797914909, -397.8213039091613, -1033.2671845457285, -973.798455520748, -1279.314941477461, -1442.895135941037, -906.8102802968343, -165.9347841397427, -614.8679902805189, -351.9507302671062, -267.339453859479, -1317.2629082685394, -912.7221085773266, -242.29655971864815, -89.87052965651809, -1271.9826320579057, -1293.9230346073352, -146.90466020418214, -1061.5668948188802, -403.5928982347685, -919.1061087869712, -87.86931929348992, -410.98565713356635, -1072.1112488289868, -154.2426594836862, -173.69309744528869, -1112.7040953785054, -1015.6638514591189, -918.0408974222273, -606.8573508584419, -1322.3485776640975, -188.69488014795317, -785.4760442588877, -330.83337611669384, -85.43093346752242, -521.3438649064724, -1027.6293394369532, -821.378410470378, -1153.075474722944, -44.47060116562228, -516.5703412133183, -692.6907864105756, -781.9378277451993, -781.2962514630668, -428.64205019221225, -221.34567181047987, -231.08608818283386, -527.7406765141964, -171.48403742695052, -122.21813359219259, -904.9217777120436, -977.8652286372142, -685.8095986751089, -770.3552862993292, -1160.409093713341, -1044.906246166449]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5605344942563996, "mean_inference_ms": 1.687024028881658, "mean_action_processing_ms": 0.2824576000806566, "mean_env_wait_ms": 3.4451191693154044, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01323246955871582, "StateBufferConnector_ms": 0.008514642715454102, "ViewRequirementAgentConnector_ms": 0.19086050987243652}, "num_episodes": 32, "episode_return_max": -5.7080068423439565, "episode_return_min": -1442.895135941037, "episode_return_mean": -692.1749290779361, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 296.4055918296498, "num_env_steps_trained_throughput_per_sec": 296.4055918296498, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 12156.363, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12156.28, "sample_time_ms": 1156.973, "learn_time_ms": 10930.001, "learn_throughput": 365.965, "synch_weights_time_ms": 68.532}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00010", "date": "2024-08-04_06-24-48", "timestamp": 1722732888, "time_this_iter_s": 13.507420539855957, "time_total_s": 73.01328420639038, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1b010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 73.01328420639038, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 17.73, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.298228990472853, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.574068678418795, "policy_loss": -0.011980842579214368, "vf_loss": 9.584457404414813, "vf_explained_var": 0.2874152445544799, "kl": 0.015079981040131927, "entropy": 1.4238859395186105, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -2.1976049334670886, "episode_reward_min": -1442.895135941037, "episode_reward_mean": -682.1723208490481, "episode_len_mean": 124.8, "episode_media": {}, "episodes_timesteps_total": 12480, "policy_reward_min": {"policy_0": -1442.895135941037}, "policy_reward_max": {"policy_0": -2.1976049334670886}, "policy_reward_mean": {"policy_0": -682.1723208490481}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-297.6748903734837, -1119.3728908285975, -756.2035458268695, -1114.0296419698993, -891.9183049186211, -1080.5540834209048, -896.1451980954098, -1031.7585791940544, -1442.6154499212194, -214.23404265520307, -247.9065416051283, -1011.2649992882835, -113.32364797914909, -397.8213039091613, -1033.2671845457285, -973.798455520748, -1279.314941477461, -1442.895135941037, -906.8102802968343, -165.9347841397427, -614.8679902805189, -351.9507302671062, -267.339453859479, -1317.2629082685394, -912.7221085773266, -242.29655971864815, -89.87052965651809, -1271.9826320579057, -1293.9230346073352, -146.90466020418214, -1061.5668948188802, -403.5928982347685, -919.1061087869712, -87.86931929348992, -410.98565713356635, -1072.1112488289868, -154.2426594836862, -173.69309744528869, -1112.7040953785054, -1015.6638514591189, -918.0408974222273, -606.8573508584419, -1322.3485776640975, -188.69488014795317, -785.4760442588877, -330.83337611669384, -85.43093346752242, -521.3438649064724, -1027.6293394369532, -821.378410470378, -1153.075474722944, -44.47060116562228, -516.5703412133183, -692.6907864105756, -781.9378277451993, -781.2962514630668, -428.64205019221225, -221.34567181047987, -231.08608818283386, -527.7406765141964, -171.48403742695052, -122.21813359219259, -904.9217777120436, -977.8652286372142, -685.8095986751089, -770.3552862993292, -1160.409093713341, -1044.906246166449, -765.6381394531588, -210.61279802993704, -639.7124478509118, -439.74532015793505, -1197.8665590838666, -5.114723779556484, -963.1630895039502, -914.0933509356033, -859.1221478901003, -936.9521295648887, -2.1976049334670886, -1008.3667520570162, -1106.1667630207835, -1277.2473529425113, -539.7128309467481, -641.1136826554881, -1214.0348395616738, -248.1833304257292, -387.1600332313838, -29.58152659043205, -971.9489987612982, -1007.3960272114441, -5.428815436266167, -934.905601560579, -939.9909859421068, -802.5227484385059, -262.2122431085457, -816.5995047521392, -417.4782843757812, -855.4990931262257, -307.2070288862161, -347.89814402948525], "episode_lengths": [87, 150, 137, 150, 150, 150, 150, 150, 150, 96, 97, 150, 51, 150, 150, 150, 150, 150, 150, 84, 150, 105, 76, 150, 150, 73, 71, 150, 150, 69, 150, 99, 150, 53, 148, 150, 62, 65, 150, 150, 150, 150, 150, 95, 150, 107, 71, 111, 150, 150, 150, 49, 129, 150, 150, 150, 150, 79, 83, 108, 69, 63, 150, 150, 150, 150, 150, 150, 143, 70, 150, 150, 150, 36, 150, 150, 150, 150, 29, 150, 150, 150, 107, 150, 150, 150, 150, 47, 150, 150, 34, 150, 150, 150, 110, 150, 91, 150, 90, 86], "policy_policy_0_reward": [-297.6748903734837, -1119.3728908285975, -756.2035458268695, -1114.0296419698993, -891.9183049186211, -1080.5540834209048, -896.1451980954098, -1031.7585791940544, -1442.6154499212194, -214.23404265520307, -247.9065416051283, -1011.2649992882835, -113.32364797914909, -397.8213039091613, -1033.2671845457285, -973.798455520748, -1279.314941477461, -1442.895135941037, -906.8102802968343, -165.9347841397427, -614.8679902805189, -351.9507302671062, -267.339453859479, -1317.2629082685394, -912.7221085773266, -242.29655971864815, -89.87052965651809, -1271.9826320579057, -1293.9230346073352, -146.90466020418214, -1061.5668948188802, -403.5928982347685, -919.1061087869712, -87.86931929348992, -410.98565713356635, -1072.1112488289868, -154.2426594836862, -173.69309744528869, -1112.7040953785054, -1015.6638514591189, -918.0408974222273, -606.8573508584419, -1322.3485776640975, -188.69488014795317, -785.4760442588877, -330.83337611669384, -85.43093346752242, -521.3438649064724, -1027.6293394369532, -821.378410470378, -1153.075474722944, -44.47060116562228, -516.5703412133183, -692.6907864105756, -781.9378277451993, -781.2962514630668, -428.64205019221225, -221.34567181047987, -231.08608818283386, -527.7406765141964, -171.48403742695052, -122.21813359219259, -904.9217777120436, -977.8652286372142, -685.8095986751089, -770.3552862993292, -1160.409093713341, -1044.906246166449, -765.6381394531588, -210.61279802993704, -639.7124478509118, -439.74532015793505, -1197.8665590838666, -5.114723779556484, -963.1630895039502, -914.0933509356033, -859.1221478901003, -936.9521295648887, -2.1976049334670886, -1008.3667520570162, -1106.1667630207835, -1277.2473529425113, -539.7128309467481, -641.1136826554881, -1214.0348395616738, -248.1833304257292, -387.1600332313838, -29.58152659043205, -971.9489987612982, -1007.3960272114441, -5.428815436266167, -934.905601560579, -939.9909859421068, -802.5227484385059, -262.2122431085457, -816.5995047521392, -417.4782843757812, -855.4990931262257, -307.2070288862161, -347.89814402948525]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.559745140344295, "mean_inference_ms": 1.6908648301509053, "mean_action_processing_ms": 0.2830855344816984, "mean_env_wait_ms": 3.456882002059733, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012698173522949219, "StateBufferConnector_ms": 0.008490324020385742, "ViewRequirementAgentConnector_ms": 0.19251775741577148}, "num_episodes": 32, "episode_return_max": -2.1976049334670886, "episode_return_min": -1442.895135941037, "episode_return_mean": -682.1723208490481, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.09987482861504, "num_env_steps_trained_throughput_per_sec": 310.09987482861504, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 12262.465, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12262.384, "sample_time_ms": 1153.282, "learn_time_ms": 11038.841, "learn_throughput": 362.357, "synch_weights_time_ms": 69.457}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00010", "date": "2024-08-04_06-25-01", "timestamp": 1722732901, "time_this_iter_s": 12.908690929412842, "time_total_s": 85.92197513580322, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1b0a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 85.92197513580322, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.09444444444445, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.347575752188762, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.313806527853012, "policy_loss": -0.008831294478053071, "vf_loss": 9.320936338106792, "vf_explained_var": 0.32798781848202146, "kl": 0.015737381140570512, "entropy": 1.445980262135466, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": -2.1976049334670886, "episode_reward_min": -1411.285234555411, "episode_reward_mean": -693.6206493466084, "episode_len_mean": 127.14, "episode_media": {}, "episodes_timesteps_total": 12714, "policy_reward_min": {"policy_0": -1411.285234555411}, "policy_reward_max": {"policy_0": -2.1976049334670886}, "policy_reward_mean": {"policy_0": -693.6206493466084}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-146.90466020418214, -1061.5668948188802, -403.5928982347685, -919.1061087869712, -87.86931929348992, -410.98565713356635, -1072.1112488289868, -154.2426594836862, -173.69309744528869, -1112.7040953785054, -1015.6638514591189, -918.0408974222273, -606.8573508584419, -1322.3485776640975, -188.69488014795317, -785.4760442588877, -330.83337611669384, -85.43093346752242, -521.3438649064724, -1027.6293394369532, -821.378410470378, -1153.075474722944, -44.47060116562228, -516.5703412133183, -692.6907864105756, -781.9378277451993, -781.2962514630668, -428.64205019221225, -221.34567181047987, -231.08608818283386, -527.7406765141964, -171.48403742695052, -122.21813359219259, -904.9217777120436, -977.8652286372142, -685.8095986751089, -770.3552862993292, -1160.409093713341, -1044.906246166449, -765.6381394531588, -210.61279802993704, -639.7124478509118, -439.74532015793505, -1197.8665590838666, -5.114723779556484, -963.1630895039502, -914.0933509356033, -859.1221478901003, -936.9521295648887, -2.1976049334670886, -1008.3667520570162, -1106.1667630207835, -1277.2473529425113, -539.7128309467481, -641.1136826554881, -1214.0348395616738, -248.1833304257292, -387.1600332313838, -29.58152659043205, -971.9489987612982, -1007.3960272114441, -5.428815436266167, -934.905601560579, -939.9909859421068, -802.5227484385059, -262.2122431085457, -816.5995047521392, -417.4782843757812, -855.4990931262257, -307.2070288862161, -347.89814402948525, -1003.7048962054478, -376.9662417316371, -166.45567525164276, -877.7956092236681, -1182.166161190908, -247.3345054868328, -452.8920464561209, -1265.3940552093807, -290.964861658759, -839.3871033391753, -1248.1656059598286, -1216.760995689343, -1411.285234555411, -858.7390638632942, -584.6813134813495, -1321.67821055646, -1149.4103472464196, -619.0989654881649, -475.7284056718251, -92.2789670692293, -964.775980479548, -955.1814266779953, -1077.517505657429, -693.5611992937465, -1199.5254776848994, -134.35372045905032, -1347.9632840271245, -746.2693450379661, -1123.8564943043073], "episode_lengths": [69, 150, 99, 150, 53, 148, 150, 62, 65, 150, 150, 150, 150, 150, 95, 150, 107, 71, 111, 150, 150, 150, 49, 129, 150, 150, 150, 150, 79, 83, 108, 69, 63, 150, 150, 150, 150, 150, 150, 143, 70, 150, 150, 150, 36, 150, 150, 150, 150, 29, 150, 150, 150, 107, 150, 150, 150, 150, 47, 150, 150, 34, 150, 150, 150, 110, 150, 91, 150, 90, 86, 150, 150, 80, 150, 150, 108, 101, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 88, 150, 150, 150, 150, 150, 93, 150, 150, 150], "policy_policy_0_reward": [-146.90466020418214, -1061.5668948188802, -403.5928982347685, -919.1061087869712, -87.86931929348992, -410.98565713356635, -1072.1112488289868, -154.2426594836862, -173.69309744528869, -1112.7040953785054, -1015.6638514591189, -918.0408974222273, -606.8573508584419, -1322.3485776640975, -188.69488014795317, -785.4760442588877, -330.83337611669384, -85.43093346752242, -521.3438649064724, -1027.6293394369532, -821.378410470378, -1153.075474722944, -44.47060116562228, -516.5703412133183, -692.6907864105756, -781.9378277451993, -781.2962514630668, -428.64205019221225, -221.34567181047987, -231.08608818283386, -527.7406765141964, -171.48403742695052, -122.21813359219259, -904.9217777120436, -977.8652286372142, -685.8095986751089, -770.3552862993292, -1160.409093713341, -1044.906246166449, -765.6381394531588, -210.61279802993704, -639.7124478509118, -439.74532015793505, -1197.8665590838666, -5.114723779556484, -963.1630895039502, -914.0933509356033, -859.1221478901003, -936.9521295648887, -2.1976049334670886, -1008.3667520570162, -1106.1667630207835, -1277.2473529425113, -539.7128309467481, -641.1136826554881, -1214.0348395616738, -248.1833304257292, -387.1600332313838, -29.58152659043205, -971.9489987612982, -1007.3960272114441, -5.428815436266167, -934.905601560579, -939.9909859421068, -802.5227484385059, -262.2122431085457, -816.5995047521392, -417.4782843757812, -855.4990931262257, -307.2070288862161, -347.89814402948525, -1003.7048962054478, -376.9662417316371, -166.45567525164276, -877.7956092236681, -1182.166161190908, -247.3345054868328, -452.8920464561209, -1265.3940552093807, -290.964861658759, -839.3871033391753, -1248.1656059598286, -1216.760995689343, -1411.285234555411, -858.7390638632942, -584.6813134813495, -1321.67821055646, -1149.4103472464196, -619.0989654881649, -475.7284056718251, -92.2789670692293, -964.775980479548, -955.1814266779953, -1077.517505657429, -693.5611992937465, -1199.5254776848994, -134.35372045905032, -1347.9632840271245, -746.2693450379661, -1123.8564943043073]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5594748564484251, "mean_inference_ms": 1.692740411884674, "mean_action_processing_ms": 0.2825899104470636, "mean_env_wait_ms": 3.465166674479646, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012416362762451172, "StateBufferConnector_ms": 0.008309125900268555, "ViewRequirementAgentConnector_ms": 0.1910703182220459}, "num_episodes": 29, "episode_return_max": -2.1976049334670886, "episode_return_min": -1411.285234555411, "episode_return_mean": -693.6206493466084, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.79026314377234, "num_env_steps_trained_throughput_per_sec": 304.79026314377234, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12370.132, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12370.049, "sample_time_ms": 1148.869, "learn_time_ms": 11149.878, "learn_throughput": 358.748, "synch_weights_time_ms": 70.502}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00010", "date": "2024-08-04_06-25-14", "timestamp": 1722732914, "time_this_iter_s": 13.13608980178833, "time_total_s": 99.05806493759155, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1b490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 99.05806493759155, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.015789473684208, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.605223080453773, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.3455566128095, "policy_loss": -0.016668722930383715, "vf_loss": 9.360193044940631, "vf_explained_var": 0.33490785453468563, "kl": 0.01737136234874773, "entropy": 1.4419737936307986, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": -2.1976049334670886, "episode_reward_min": -1454.7187263873054, "episode_reward_mean": -767.3035327757374, "episode_len_mean": 131.43, "episode_media": {}, "episodes_timesteps_total": 13143, "policy_reward_min": {"policy_0": -1454.7187263873054}, "policy_reward_max": {"policy_0": -2.1976049334670886}, "policy_reward_mean": {"policy_0": -767.3035327757374}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-904.9217777120436, -977.8652286372142, -685.8095986751089, -770.3552862993292, -1160.409093713341, -1044.906246166449, -765.6381394531588, -210.61279802993704, -639.7124478509118, -439.74532015793505, -1197.8665590838666, -5.114723779556484, -963.1630895039502, -914.0933509356033, -859.1221478901003, -936.9521295648887, -2.1976049334670886, -1008.3667520570162, -1106.1667630207835, -1277.2473529425113, -539.7128309467481, -641.1136826554881, -1214.0348395616738, -248.1833304257292, -387.1600332313838, -29.58152659043205, -971.9489987612982, -1007.3960272114441, -5.428815436266167, -934.905601560579, -939.9909859421068, -802.5227484385059, -262.2122431085457, -816.5995047521392, -417.4782843757812, -855.4990931262257, -307.2070288862161, -347.89814402948525, -1003.7048962054478, -376.9662417316371, -166.45567525164276, -877.7956092236681, -1182.166161190908, -247.3345054868328, -452.8920464561209, -1265.3940552093807, -290.964861658759, -839.3871033391753, -1248.1656059598286, -1216.760995689343, -1411.285234555411, -858.7390638632942, -584.6813134813495, -1321.67821055646, -1149.4103472464196, -619.0989654881649, -475.7284056718251, -92.2789670692293, -964.775980479548, -955.1814266779953, -1077.517505657429, -693.5611992937465, -1199.5254776848994, -134.35372045905032, -1347.9632840271245, -746.2693450379661, -1123.8564943043073, -607.2602407269482, -1099.7627645312289, -1454.7187263873054, -18.283324246957186, -1277.4250520882015, -1061.132856849615, -177.68119841893574, -963.4750392518234, -95.3133546766709, -1249.2346716039199, -473.91780137930647, -271.49097529532827, -1222.851475696046, -1031.067027840025, -1134.3943986780946, -498.19784654413695, -282.29112881681124, -829.24077062131, -1333.9788420005377, -1041.0205227068523, -1137.7811997582971, -205.9868926693555, -213.11799817004098, -1412.8851459710002, -496.3193895776212, -395.7452350403355, -592.9693551405624, -845.3492170241851, -1165.2478501252062, -173.002128474319, -1104.7847684482706, -1376.663461160562, -964.7297892497581], "episode_lengths": [150, 150, 150, 150, 150, 150, 143, 70, 150, 150, 150, 36, 150, 150, 150, 150, 29, 150, 150, 150, 107, 150, 150, 150, 150, 47, 150, 150, 34, 150, 150, 150, 110, 150, 91, 150, 90, 86, 150, 150, 80, 150, 150, 108, 101, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 88, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 41, 150, 150, 67, 150, 46, 150, 146, 82, 150, 150, 150, 150, 100, 150, 150, 150, 150, 127, 74, 150, 150, 96, 150, 150, 150, 60, 150, 150, 150], "policy_policy_0_reward": [-904.9217777120436, -977.8652286372142, -685.8095986751089, -770.3552862993292, -1160.409093713341, -1044.906246166449, -765.6381394531588, -210.61279802993704, -639.7124478509118, -439.74532015793505, -1197.8665590838666, -5.114723779556484, -963.1630895039502, -914.0933509356033, -859.1221478901003, -936.9521295648887, -2.1976049334670886, -1008.3667520570162, -1106.1667630207835, -1277.2473529425113, -539.7128309467481, -641.1136826554881, -1214.0348395616738, -248.1833304257292, -387.1600332313838, -29.58152659043205, -971.9489987612982, -1007.3960272114441, -5.428815436266167, -934.905601560579, -939.9909859421068, -802.5227484385059, -262.2122431085457, -816.5995047521392, -417.4782843757812, -855.4990931262257, -307.2070288862161, -347.89814402948525, -1003.7048962054478, -376.9662417316371, -166.45567525164276, -877.7956092236681, -1182.166161190908, -247.3345054868328, -452.8920464561209, -1265.3940552093807, -290.964861658759, -839.3871033391753, -1248.1656059598286, -1216.760995689343, -1411.285234555411, -858.7390638632942, -584.6813134813495, -1321.67821055646, -1149.4103472464196, -619.0989654881649, -475.7284056718251, -92.2789670692293, -964.775980479548, -955.1814266779953, -1077.517505657429, -693.5611992937465, -1199.5254776848994, -134.35372045905032, -1347.9632840271245, -746.2693450379661, -1123.8564943043073, -607.2602407269482, -1099.7627645312289, -1454.7187263873054, -18.283324246957186, -1277.4250520882015, -1061.132856849615, -177.68119841893574, -963.4750392518234, -95.3133546766709, -1249.2346716039199, -473.91780137930647, -271.49097529532827, -1222.851475696046, -1031.067027840025, -1134.3943986780946, -498.19784654413695, -282.29112881681124, -829.24077062131, -1333.9788420005377, -1041.0205227068523, -1137.7811997582971, -205.9868926693555, -213.11799817004098, -1412.8851459710002, -496.3193895776212, -395.7452350403355, -592.9693551405624, -845.3492170241851, -1165.2478501252062, -173.002128474319, -1104.7847684482706, -1376.663461160562, -964.7297892497581]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5575891652050672, "mean_inference_ms": 1.6915962020937712, "mean_action_processing_ms": 0.28168517048208175, "mean_env_wait_ms": 3.469411175768936, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011818408966064453, "StateBufferConnector_ms": 0.007980108261108398, "ViewRequirementAgentConnector_ms": 0.1887831687927246}, "num_episodes": 33, "episode_return_max": -2.1976049334670886, "episode_return_min": -1454.7187263873054, "episode_return_mean": -767.3035327757374, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.07877049650983, "num_env_steps_trained_throughput_per_sec": 313.07877049650983, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12415.267, "restore_workers_time_ms": 0.036, "training_step_time_ms": 12415.184, "sample_time_ms": 1144.633, "learn_time_ms": 11198.887, "learn_throughput": 357.178, "synch_weights_time_ms": 70.851}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00010", "date": "2024-08-04_06-25-27", "timestamp": 1722732927, "time_this_iter_s": 12.789429426193237, "time_total_s": 111.84749436378479, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f196c0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 111.84749436378479, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.172222222222224, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.111772412620485, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.397179886698723, "policy_loss": -0.01605432764918078, "vf_loss": 9.410518837968509, "vf_explained_var": 0.40139980024347705, "kl": 0.020734943035677134, "entropy": 1.4315893727044264, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": -5.428815436266167, "episode_reward_min": -1454.7187263873054, "episode_reward_mean": -782.3456905151517, "episode_len_mean": 134.25, "episode_media": {}, "episodes_timesteps_total": 13425, "policy_reward_min": {"policy_0": -1454.7187263873054}, "policy_reward_max": {"policy_0": -5.428815436266167}, "policy_reward_mean": {"policy_0": -782.3456905151517}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1007.3960272114441, -5.428815436266167, -934.905601560579, -939.9909859421068, -802.5227484385059, -262.2122431085457, -816.5995047521392, -417.4782843757812, -855.4990931262257, -307.2070288862161, -347.89814402948525, -1003.7048962054478, -376.9662417316371, -166.45567525164276, -877.7956092236681, -1182.166161190908, -247.3345054868328, -452.8920464561209, -1265.3940552093807, -290.964861658759, -839.3871033391753, -1248.1656059598286, -1216.760995689343, -1411.285234555411, -858.7390638632942, -584.6813134813495, -1321.67821055646, -1149.4103472464196, -619.0989654881649, -475.7284056718251, -92.2789670692293, -964.775980479548, -955.1814266779953, -1077.517505657429, -693.5611992937465, -1199.5254776848994, -134.35372045905032, -1347.9632840271245, -746.2693450379661, -1123.8564943043073, -607.2602407269482, -1099.7627645312289, -1454.7187263873054, -18.283324246957186, -1277.4250520882015, -1061.132856849615, -177.68119841893574, -963.4750392518234, -95.3133546766709, -1249.2346716039199, -473.91780137930647, -271.49097529532827, -1222.851475696046, -1031.067027840025, -1134.3943986780946, -498.19784654413695, -282.29112881681124, -829.24077062131, -1333.9788420005377, -1041.0205227068523, -1137.7811997582971, -205.9868926693555, -213.11799817004098, -1412.8851459710002, -496.3193895776212, -395.7452350403355, -592.9693551405624, -845.3492170241851, -1165.2478501252062, -173.002128474319, -1104.7847684482706, -1376.663461160562, -964.7297892497581, -762.1139778677712, -492.54716985131415, -336.98553215703515, -969.3698478493113, -1204.6704837623718, -386.1379519107292, -1055.0001757506411, -624.7091570606251, -980.8140921218719, -1248.8409162664175, -1045.0360363047744, -996.654980447519, -559.8626160615623, -998.2457914656013, -642.3585821234993, -476.25302742053935, -765.5554843144071, -287.58335293186934, -899.0047736721111, -1224.0283648563116, -682.5068304827851, -999.6630929520431, -211.1152780750013, -725.0117741494688, -949.8372410164908, -846.13075727671, -1036.1801383725406], "episode_lengths": [150, 34, 150, 150, 150, 110, 150, 91, 150, 90, 86, 150, 150, 80, 150, 150, 108, 101, 150, 84, 150, 150, 150, 150, 150, 150, 150, 150, 150, 107, 88, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 41, 150, 150, 67, 150, 46, 150, 146, 82, 150, 150, 150, 150, 100, 150, 150, 150, 150, 127, 74, 150, 150, 96, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 94, 133, 150, 139, 150], "policy_policy_0_reward": [-1007.3960272114441, -5.428815436266167, -934.905601560579, -939.9909859421068, -802.5227484385059, -262.2122431085457, -816.5995047521392, -417.4782843757812, -855.4990931262257, -307.2070288862161, -347.89814402948525, -1003.7048962054478, -376.9662417316371, -166.45567525164276, -877.7956092236681, -1182.166161190908, -247.3345054868328, -452.8920464561209, -1265.3940552093807, -290.964861658759, -839.3871033391753, -1248.1656059598286, -1216.760995689343, -1411.285234555411, -858.7390638632942, -584.6813134813495, -1321.67821055646, -1149.4103472464196, -619.0989654881649, -475.7284056718251, -92.2789670692293, -964.775980479548, -955.1814266779953, -1077.517505657429, -693.5611992937465, -1199.5254776848994, -134.35372045905032, -1347.9632840271245, -746.2693450379661, -1123.8564943043073, -607.2602407269482, -1099.7627645312289, -1454.7187263873054, -18.283324246957186, -1277.4250520882015, -1061.132856849615, -177.68119841893574, -963.4750392518234, -95.3133546766709, -1249.2346716039199, -473.91780137930647, -271.49097529532827, -1222.851475696046, -1031.067027840025, -1134.3943986780946, -498.19784654413695, -282.29112881681124, -829.24077062131, -1333.9788420005377, -1041.0205227068523, -1137.7811997582971, -205.9868926693555, -213.11799817004098, -1412.8851459710002, -496.3193895776212, -395.7452350403355, -592.9693551405624, -845.3492170241851, -1165.2478501252062, -173.002128474319, -1104.7847684482706, -1376.663461160562, -964.7297892497581, -762.1139778677712, -492.54716985131415, -336.98553215703515, -969.3698478493113, -1204.6704837623718, -386.1379519107292, -1055.0001757506411, -624.7091570606251, -980.8140921218719, -1248.8409162664175, -1045.0360363047744, -996.654980447519, -559.8626160615623, -998.2457914656013, -642.3585821234993, -476.25302742053935, -765.5554843144071, -287.58335293186934, -899.0047736721111, -1224.0283648563116, -682.5068304827851, -999.6630929520431, -211.1152780750013, -725.0117741494688, -949.8372410164908, -846.13075727671, -1036.1801383725406]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5567541981250332, "mean_inference_ms": 1.6896306819251998, "mean_action_processing_ms": 0.28078492154184787, "mean_env_wait_ms": 3.465487967929434, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01141214370727539, "StateBufferConnector_ms": 0.007668733596801758, "ViewRequirementAgentConnector_ms": 0.1844642162322998}, "num_episodes": 27, "episode_return_max": -5.428815436266167, "episode_return_min": -1454.7187263873054, "episode_return_mean": -782.3456905151517, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 362.29204457121637, "num_env_steps_trained_throughput_per_sec": 362.29204457121637, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12277.823, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12277.742, "sample_time_ms": 1141.079, "learn_time_ms": 11066.105, "learn_throughput": 361.464, "synch_weights_time_ms": 69.749}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00010", "date": "2024-08-04_06-25-38", "timestamp": 1722732938, "time_this_iter_s": 11.05225682258606, "time_total_s": 122.89975118637085, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f4a710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 122.89975118637085, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 19.237499999999997, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.807430895604194, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.275497434536616, "policy_loss": -0.010567195850793116, "vf_loss": 9.282374708851178, "vf_explained_var": 0.41166782366732757, "kl": 0.017195555082071223, "entropy": 1.468737431243062, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": -18.283324246957186, "episode_reward_min": -1463.2395756769981, "episode_reward_mean": -828.5374446411311, "episode_len_mean": 137.79, "episode_media": {}, "episodes_timesteps_total": 13779, "policy_reward_min": {"policy_0": -1463.2395756769981}, "policy_reward_max": {"policy_0": -18.283324246957186}, "policy_reward_mean": {"policy_0": -828.5374446411311}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-92.2789670692293, -964.775980479548, -955.1814266779953, -1077.517505657429, -693.5611992937465, -1199.5254776848994, -134.35372045905032, -1347.9632840271245, -746.2693450379661, -1123.8564943043073, -607.2602407269482, -1099.7627645312289, -1454.7187263873054, -18.283324246957186, -1277.4250520882015, -1061.132856849615, -177.68119841893574, -963.4750392518234, -95.3133546766709, -1249.2346716039199, -473.91780137930647, -271.49097529532827, -1222.851475696046, -1031.067027840025, -1134.3943986780946, -498.19784654413695, -282.29112881681124, -829.24077062131, -1333.9788420005377, -1041.0205227068523, -1137.7811997582971, -205.9868926693555, -213.11799817004098, -1412.8851459710002, -496.3193895776212, -395.7452350403355, -592.9693551405624, -845.3492170241851, -1165.2478501252062, -173.002128474319, -1104.7847684482706, -1376.663461160562, -964.7297892497581, -762.1139778677712, -492.54716985131415, -336.98553215703515, -969.3698478493113, -1204.6704837623718, -386.1379519107292, -1055.0001757506411, -624.7091570606251, -980.8140921218719, -1248.8409162664175, -1045.0360363047744, -996.654980447519, -559.8626160615623, -998.2457914656013, -642.3585821234993, -476.25302742053935, -765.5554843144071, -287.58335293186934, -899.0047736721111, -1224.0283648563116, -682.5068304827851, -999.6630929520431, -211.1152780750013, -725.0117741494688, -949.8372410164908, -846.13075727671, -1036.1801383725406, -921.6418112694042, -906.4429809721204, -805.4623215277899, -1085.788658501861, -717.6963558238667, -836.3828400568307, -876.7359378887512, -207.71200828608775, -48.519468975090504, -1234.1091281723216, -1463.2395756769981, -853.5035912434239, -1071.039591716974, -1003.8522743217823, -57.1438653499279, -941.02067156341, -993.3649181869664, -1394.3994068649665, -988.6979421209901, -735.3965730988003, -1089.9847401852567, -1034.6905222751168, -1211.3015072507926, -1111.5240848028411, -482.84815884267005, -873.0875754436993, -715.915652975358, -1186.2205377092534, -1026.5388632601282, -1030.6616233674624], "episode_lengths": [88, 150, 150, 150, 150, 150, 93, 150, 150, 150, 150, 150, 150, 41, 150, 150, 67, 150, 46, 150, 146, 82, 150, 150, 150, 150, 100, 150, 150, 150, 150, 127, 74, 150, 150, 96, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 94, 133, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 83, 55, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150], "policy_policy_0_reward": [-92.2789670692293, -964.775980479548, -955.1814266779953, -1077.517505657429, -693.5611992937465, -1199.5254776848994, -134.35372045905032, -1347.9632840271245, -746.2693450379661, -1123.8564943043073, -607.2602407269482, -1099.7627645312289, -1454.7187263873054, -18.283324246957186, -1277.4250520882015, -1061.132856849615, -177.68119841893574, -963.4750392518234, -95.3133546766709, -1249.2346716039199, -473.91780137930647, -271.49097529532827, -1222.851475696046, -1031.067027840025, -1134.3943986780946, -498.19784654413695, -282.29112881681124, -829.24077062131, -1333.9788420005377, -1041.0205227068523, -1137.7811997582971, -205.9868926693555, -213.11799817004098, -1412.8851459710002, -496.3193895776212, -395.7452350403355, -592.9693551405624, -845.3492170241851, -1165.2478501252062, -173.002128474319, -1104.7847684482706, -1376.663461160562, -964.7297892497581, -762.1139778677712, -492.54716985131415, -336.98553215703515, -969.3698478493113, -1204.6704837623718, -386.1379519107292, -1055.0001757506411, -624.7091570606251, -980.8140921218719, -1248.8409162664175, -1045.0360363047744, -996.654980447519, -559.8626160615623, -998.2457914656013, -642.3585821234993, -476.25302742053935, -765.5554843144071, -287.58335293186934, -899.0047736721111, -1224.0283648563116, -682.5068304827851, -999.6630929520431, -211.1152780750013, -725.0117741494688, -949.8372410164908, -846.13075727671, -1036.1801383725406, -921.6418112694042, -906.4429809721204, -805.4623215277899, -1085.788658501861, -717.6963558238667, -836.3828400568307, -876.7359378887512, -207.71200828608775, -48.519468975090504, -1234.1091281723216, -1463.2395756769981, -853.5035912434239, -1071.039591716974, -1003.8522743217823, -57.1438653499279, -941.02067156341, -993.3649181869664, -1394.3994068649665, -988.6979421209901, -735.3965730988003, -1089.9847401852567, -1034.6905222751168, -1211.3015072507926, -1111.5240848028411, -482.84815884267005, -873.0875754436993, -715.915652975358, -1186.2205377092534, -1026.5388632601282, -1030.6616233674624]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5555571486889025, "mean_inference_ms": 1.6843893579627762, "mean_action_processing_ms": 0.27947074982927655, "mean_env_wait_ms": 3.458378540736048, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011309385299682617, "StateBufferConnector_ms": 0.007636547088623047, "ViewRequirementAgentConnector_ms": 0.186478853225708}, "num_episodes": 30, "episode_return_max": -18.283324246957186, "episode_return_min": -1463.2395756769981, "episode_return_mean": -828.5374446411311, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.35178727415456, "num_env_steps_trained_throughput_per_sec": 308.35178727415456, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12371.155, "restore_workers_time_ms": 0.035, "training_step_time_ms": 12371.073, "sample_time_ms": 1140.692, "learn_time_ms": 11157.547, "learn_throughput": 358.502, "synch_weights_time_ms": 72.024}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00010", "date": "2024-08-04_06-25-51", "timestamp": 1722732951, "time_this_iter_s": 12.987655401229858, "time_total_s": 135.8874065876007, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f4a320>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 135.8874065876007, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.144444444444446, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.374011000866691, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.03787539800008, "policy_loss": -0.011998543834488373, "vf_loss": 9.046515695750713, "vf_explained_var": 0.5819093998521566, "kl": 0.01576497812957315, "entropy": 1.3712654809157054, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -48.519468975090504, "episode_reward_min": -1463.2395756769981, "episode_reward_mean": -800.9619792919607, "episode_len_mean": 139.76, "episode_media": {}, "episodes_timesteps_total": 13976, "policy_reward_min": {"policy_0": -1463.2395756769981}, "policy_reward_max": {"policy_0": -48.519468975090504}, "policy_reward_mean": {"policy_0": -800.9619792919607}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-829.24077062131, -1333.9788420005377, -1041.0205227068523, -1137.7811997582971, -205.9868926693555, -213.11799817004098, -1412.8851459710002, -496.3193895776212, -395.7452350403355, -592.9693551405624, -845.3492170241851, -1165.2478501252062, -173.002128474319, -1104.7847684482706, -1376.663461160562, -964.7297892497581, -762.1139778677712, -492.54716985131415, -336.98553215703515, -969.3698478493113, -1204.6704837623718, -386.1379519107292, -1055.0001757506411, -624.7091570606251, -980.8140921218719, -1248.8409162664175, -1045.0360363047744, -996.654980447519, -559.8626160615623, -998.2457914656013, -642.3585821234993, -476.25302742053935, -765.5554843144071, -287.58335293186934, -899.0047736721111, -1224.0283648563116, -682.5068304827851, -999.6630929520431, -211.1152780750013, -725.0117741494688, -949.8372410164908, -846.13075727671, -1036.1801383725406, -921.6418112694042, -906.4429809721204, -805.4623215277899, -1085.788658501861, -717.6963558238667, -836.3828400568307, -876.7359378887512, -207.71200828608775, -48.519468975090504, -1234.1091281723216, -1463.2395756769981, -853.5035912434239, -1071.039591716974, -1003.8522743217823, -57.1438653499279, -941.02067156341, -993.3649181869664, -1394.3994068649665, -988.6979421209901, -735.3965730988003, -1089.9847401852567, -1034.6905222751168, -1211.3015072507926, -1111.5240848028411, -482.84815884267005, -873.0875754436993, -715.915652975358, -1186.2205377092534, -1026.5388632601282, -1030.6616233674624, -833.8663021345619, -639.0764922199685, -503.9269460967937, -136.09807917668803, -862.4641912044841, -1125.6398654027082, -195.466810688849, -539.6322993698996, -923.4123752528267, -778.0344302498858, -762.533272021077, -113.41751763944848, -574.1852369260715, -1015.5329480133654, -492.29813934560445, -997.3218683767225, -776.0134579534407, -1198.073567290119, -775.7071737484592, -1003.7404929046834, -889.3606157606359, -261.1077602125618, -1107.3096822026803, -423.28214224383515, -326.2816892668419, -697.7509139688149, -544.700479134574], "episode_lengths": [150, 150, 150, 150, 127, 74, 150, 150, 96, 150, 150, 150, 60, 150, 150, 150, 150, 150, 150, 150, 150, 94, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 104, 150, 150, 150, 150, 94, 133, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 83, 55, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 145, 150, 150, 73, 150, 150, 98, 150, 150, 139, 150, 60, 150, 150, 150, 150, 142, 150, 150, 150, 150, 105, 150, 150, 98, 150, 150], "policy_policy_0_reward": [-829.24077062131, -1333.9788420005377, -1041.0205227068523, -1137.7811997582971, -205.9868926693555, -213.11799817004098, -1412.8851459710002, -496.3193895776212, -395.7452350403355, -592.9693551405624, -845.3492170241851, -1165.2478501252062, -173.002128474319, -1104.7847684482706, -1376.663461160562, -964.7297892497581, -762.1139778677712, -492.54716985131415, -336.98553215703515, -969.3698478493113, -1204.6704837623718, -386.1379519107292, -1055.0001757506411, -624.7091570606251, -980.8140921218719, -1248.8409162664175, -1045.0360363047744, -996.654980447519, -559.8626160615623, -998.2457914656013, -642.3585821234993, -476.25302742053935, -765.5554843144071, -287.58335293186934, -899.0047736721111, -1224.0283648563116, -682.5068304827851, -999.6630929520431, -211.1152780750013, -725.0117741494688, -949.8372410164908, -846.13075727671, -1036.1801383725406, -921.6418112694042, -906.4429809721204, -805.4623215277899, -1085.788658501861, -717.6963558238667, -836.3828400568307, -876.7359378887512, -207.71200828608775, -48.519468975090504, -1234.1091281723216, -1463.2395756769981, -853.5035912434239, -1071.039591716974, -1003.8522743217823, -57.1438653499279, -941.02067156341, -993.3649181869664, -1394.3994068649665, -988.6979421209901, -735.3965730988003, -1089.9847401852567, -1034.6905222751168, -1211.3015072507926, -1111.5240848028411, -482.84815884267005, -873.0875754436993, -715.915652975358, -1186.2205377092534, -1026.5388632601282, -1030.6616233674624, -833.8663021345619, -639.0764922199685, -503.9269460967937, -136.09807917668803, -862.4641912044841, -1125.6398654027082, -195.466810688849, -539.6322993698996, -923.4123752528267, -778.0344302498858, -762.533272021077, -113.41751763944848, -574.1852369260715, -1015.5329480133654, -492.29813934560445, -997.3218683767225, -776.0134579534407, -1198.073567290119, -775.7071737484592, -1003.7404929046834, -889.3606157606359, -261.1077602125618, -1107.3096822026803, -423.28214224383515, -326.2816892668419, -697.7509139688149, -544.700479134574]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5542851631523956, "mean_inference_ms": 1.6823564709909247, "mean_action_processing_ms": 0.27853152812277476, "mean_env_wait_ms": 3.454997692241901, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011306285858154297, "StateBufferConnector_ms": 0.007665395736694336, "ViewRequirementAgentConnector_ms": 0.18712186813354492}, "num_episodes": 27, "episode_return_max": -48.519468975090504, "episode_return_min": -1463.2395756769981, "episode_return_mean": -800.9619792919607, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.4384403696968, "num_env_steps_trained_throughput_per_sec": 297.4384403696968, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 12428.737, "restore_workers_time_ms": 0.034, "training_step_time_ms": 12428.656, "sample_time_ms": 1149.448, "learn_time_ms": 11206.063, "learn_throughput": 356.95, "synch_weights_time_ms": 72.333}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00010", "date": "2024-08-04_06-26-05", "timestamp": 1722732965, "time_this_iter_s": 13.461093425750732, "time_total_s": 149.34850001335144, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f4b640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 149.34850001335144, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 18.042105263157897, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 11.6012666101257, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.97277301599582, "policy_loss": -0.010288864435763875, "vf_loss": 8.979848501582941, "vf_explained_var": 0.5165768324087063, "kl": 0.01527100954129614, "entropy": 1.3679147680600485, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -48.519468975090504, "episode_reward_min": -1463.2395756769981, "episode_reward_mean": -773.8925559871382, "episode_len_mean": 138.46, "episode_media": {}, "episodes_timesteps_total": 13846, "policy_reward_min": {"policy_0": -1463.2395756769981}, "policy_reward_max": {"policy_0": -48.519468975090504}, "policy_reward_mean": {"policy_0": -773.8925559871382}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-998.2457914656013, -642.3585821234993, -476.25302742053935, -765.5554843144071, -287.58335293186934, -899.0047736721111, -1224.0283648563116, -682.5068304827851, -999.6630929520431, -211.1152780750013, -725.0117741494688, -949.8372410164908, -846.13075727671, -1036.1801383725406, -921.6418112694042, -906.4429809721204, -805.4623215277899, -1085.788658501861, -717.6963558238667, -836.3828400568307, -876.7359378887512, -207.71200828608775, -48.519468975090504, -1234.1091281723216, -1463.2395756769981, -853.5035912434239, -1071.039591716974, -1003.8522743217823, -57.1438653499279, -941.02067156341, -993.3649181869664, -1394.3994068649665, -988.6979421209901, -735.3965730988003, -1089.9847401852567, -1034.6905222751168, -1211.3015072507926, -1111.5240848028411, -482.84815884267005, -873.0875754436993, -715.915652975358, -1186.2205377092534, -1026.5388632601282, -1030.6616233674624, -833.8663021345619, -639.0764922199685, -503.9269460967937, -136.09807917668803, -862.4641912044841, -1125.6398654027082, -195.466810688849, -539.6322993698996, -923.4123752528267, -778.0344302498858, -762.533272021077, -113.41751763944848, -574.1852369260715, -1015.5329480133654, -492.29813934560445, -997.3218683767225, -776.0134579534407, -1198.073567290119, -775.7071737484592, -1003.7404929046834, -889.3606157606359, -261.1077602125618, -1107.3096822026803, -423.28214224383515, -326.2816892668419, -697.7509139688149, -544.700479134574, -369.2374410298305, -1037.0206112058515, -771.6459823350767, -273.5896563221279, -259.1324768335158, -474.0769901655139, -1341.396193045161, -225.83796655710836, -400.5411876514216, -52.36603967542782, -612.3008507033926, -472.05522175833215, -1313.0327705250736, -1098.28086942525, -1270.653938613619, -993.9244391805026, -1058.156829361178, -1147.630008200775, -915.1163727839419, -456.9476126644358, -988.9692393273554, -1345.3800676582805, -571.810809723004, -867.8784885106257, -522.9230186451701, -397.42276019089417, -128.47205710296777, -887.102344954733, -991.7209289173273], "episode_lengths": [150, 150, 150, 150, 104, 150, 150, 150, 150, 94, 133, 150, 139, 150, 150, 150, 150, 150, 150, 150, 150, 83, 55, 150, 150, 150, 150, 150, 62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 145, 150, 150, 73, 150, 150, 98, 150, 150, 139, 150, 60, 150, 150, 150, 150, 142, 150, 150, 150, 150, 105, 150, 150, 98, 150, 150, 150, 150, 150, 74, 103, 150, 150, 74, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 81, 150, 150], "policy_policy_0_reward": [-998.2457914656013, -642.3585821234993, -476.25302742053935, -765.5554843144071, -287.58335293186934, -899.0047736721111, -1224.0283648563116, -682.5068304827851, -999.6630929520431, -211.1152780750013, -725.0117741494688, -949.8372410164908, -846.13075727671, -1036.1801383725406, -921.6418112694042, -906.4429809721204, -805.4623215277899, -1085.788658501861, -717.6963558238667, -836.3828400568307, -876.7359378887512, -207.71200828608775, -48.519468975090504, -1234.1091281723216, -1463.2395756769981, -853.5035912434239, -1071.039591716974, -1003.8522743217823, -57.1438653499279, -941.02067156341, -993.3649181869664, -1394.3994068649665, -988.6979421209901, -735.3965730988003, -1089.9847401852567, -1034.6905222751168, -1211.3015072507926, -1111.5240848028411, -482.84815884267005, -873.0875754436993, -715.915652975358, -1186.2205377092534, -1026.5388632601282, -1030.6616233674624, -833.8663021345619, -639.0764922199685, -503.9269460967937, -136.09807917668803, -862.4641912044841, -1125.6398654027082, -195.466810688849, -539.6322993698996, -923.4123752528267, -778.0344302498858, -762.533272021077, -113.41751763944848, -574.1852369260715, -1015.5329480133654, -492.29813934560445, -997.3218683767225, -776.0134579534407, -1198.073567290119, -775.7071737484592, -1003.7404929046834, -889.3606157606359, -261.1077602125618, -1107.3096822026803, -423.28214224383515, -326.2816892668419, -697.7509139688149, -544.700479134574, -369.2374410298305, -1037.0206112058515, -771.6459823350767, -273.5896563221279, -259.1324768335158, -474.0769901655139, -1341.396193045161, -225.83796655710836, -400.5411876514216, -52.36603967542782, -612.3008507033926, -472.05522175833215, -1313.0327705250736, -1098.28086942525, -1270.653938613619, -993.9244391805026, -1058.156829361178, -1147.630008200775, -915.1163727839419, -456.9476126644358, -988.9692393273554, -1345.3800676582805, -571.810809723004, -867.8784885106257, -522.9230186451701, -397.42276019089417, -128.47205710296777, -887.102344954733, -991.7209289173273]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553476326088765, "mean_inference_ms": 1.6805919875611075, "mean_action_processing_ms": 0.27795279484271657, "mean_env_wait_ms": 3.4580031968686726, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011459589004516602, "StateBufferConnector_ms": 0.007822751998901367, "ViewRequirementAgentConnector_ms": 0.19183826446533203}, "num_episodes": 29, "episode_return_max": -48.519468975090504, "episode_return_min": -1463.2395756769981, "episode_return_mean": -773.8925559871382, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 402.9024355627365, "num_env_steps_trained_throughput_per_sec": 402.9024355627365, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12135.8, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12135.721, "sample_time_ms": 1152.853, "learn_time_ms": 10910.741, "learn_throughput": 366.611, "synch_weights_time_ms": 71.311}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00010", "date": "2024-08-04_06-26-15", "timestamp": 1722732975, "time_this_iter_s": 9.940467834472656, "time_total_s": 159.2889678478241, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1b520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 159.2889678478241, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.986666666666668, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.125613921135663, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.887038673460484, "policy_loss": -0.012549625669392602, "vf_loss": 8.89543563425541, "vf_explained_var": 0.6326066865275304, "kl": 0.018207044407305764, "entropy": 1.3094387808193764, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -52.36603967542782, "episode_reward_min": -1394.3994068649665, "episode_reward_mean": -734.227089498061, "episode_len_mean": 139.13, "episode_media": {}, "episodes_timesteps_total": 13913, "policy_reward_min": {"policy_0": -1394.3994068649665}, "policy_reward_max": {"policy_0": -52.36603967542782}, "policy_reward_mean": {"policy_0": -734.227089498061}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-57.1438653499279, -941.02067156341, -993.3649181869664, -1394.3994068649665, -988.6979421209901, -735.3965730988003, -1089.9847401852567, -1034.6905222751168, -1211.3015072507926, -1111.5240848028411, -482.84815884267005, -873.0875754436993, -715.915652975358, -1186.2205377092534, -1026.5388632601282, -1030.6616233674624, -833.8663021345619, -639.0764922199685, -503.9269460967937, -136.09807917668803, -862.4641912044841, -1125.6398654027082, -195.466810688849, -539.6322993698996, -923.4123752528267, -778.0344302498858, -762.533272021077, -113.41751763944848, -574.1852369260715, -1015.5329480133654, -492.29813934560445, -997.3218683767225, -776.0134579534407, -1198.073567290119, -775.7071737484592, -1003.7404929046834, -889.3606157606359, -261.1077602125618, -1107.3096822026803, -423.28214224383515, -326.2816892668419, -697.7509139688149, -544.700479134574, -369.2374410298305, -1037.0206112058515, -771.6459823350767, -273.5896563221279, -259.1324768335158, -474.0769901655139, -1341.396193045161, -225.83796655710836, -400.5411876514216, -52.36603967542782, -612.3008507033926, -472.05522175833215, -1313.0327705250736, -1098.28086942525, -1270.653938613619, -993.9244391805026, -1058.156829361178, -1147.630008200775, -915.1163727839419, -456.9476126644358, -988.9692393273554, -1345.3800676582805, -571.810809723004, -867.8784885106257, -522.9230186451701, -397.42276019089417, -128.47205710296777, -887.102344954733, -991.7209289173273, -439.0350622620352, -681.8308207896805, -470.55210707525055, -642.1473052549541, -454.5855212079027, -555.6915780942545, -382.6089584773388, -292.4694328669916, -164.8036753673465, -800.0621236106658, -976.2487960151618, -1364.9609070380704, -1001.2293537333794, -594.9124246845472, -795.264641981336, -493.460317598025, -1260.25719931767, -503.2726569078353, -163.17664667180847, -1093.8324644491172, -657.4742833336405, -548.9540518734283, -1143.9509426613256, -982.5123993312151, -613.947166394909, -332.96990535148944, -840.2003666158986, -558.6432756696703], "episode_lengths": [62, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 150, 145, 150, 150, 73, 150, 150, 98, 150, 150, 139, 150, 60, 150, 150, 150, 150, 142, 150, 150, 150, 150, 105, 150, 150, 98, 150, 150, 150, 150, 150, 74, 103, 150, 150, 74, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 81, 150, 150, 150, 150, 120, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 110, 150, 150], "policy_policy_0_reward": [-57.1438653499279, -941.02067156341, -993.3649181869664, -1394.3994068649665, -988.6979421209901, -735.3965730988003, -1089.9847401852567, -1034.6905222751168, -1211.3015072507926, -1111.5240848028411, -482.84815884267005, -873.0875754436993, -715.915652975358, -1186.2205377092534, -1026.5388632601282, -1030.6616233674624, -833.8663021345619, -639.0764922199685, -503.9269460967937, -136.09807917668803, -862.4641912044841, -1125.6398654027082, -195.466810688849, -539.6322993698996, -923.4123752528267, -778.0344302498858, -762.533272021077, -113.41751763944848, -574.1852369260715, -1015.5329480133654, -492.29813934560445, -997.3218683767225, -776.0134579534407, -1198.073567290119, -775.7071737484592, -1003.7404929046834, -889.3606157606359, -261.1077602125618, -1107.3096822026803, -423.28214224383515, -326.2816892668419, -697.7509139688149, -544.700479134574, -369.2374410298305, -1037.0206112058515, -771.6459823350767, -273.5896563221279, -259.1324768335158, -474.0769901655139, -1341.396193045161, -225.83796655710836, -400.5411876514216, -52.36603967542782, -612.3008507033926, -472.05522175833215, -1313.0327705250736, -1098.28086942525, -1270.653938613619, -993.9244391805026, -1058.156829361178, -1147.630008200775, -915.1163727839419, -456.9476126644358, -988.9692393273554, -1345.3800676582805, -571.810809723004, -867.8784885106257, -522.9230186451701, -397.42276019089417, -128.47205710296777, -887.102344954733, -991.7209289173273, -439.0350622620352, -681.8308207896805, -470.55210707525055, -642.1473052549541, -454.5855212079027, -555.6915780942545, -382.6089584773388, -292.4694328669916, -164.8036753673465, -800.0621236106658, -976.2487960151618, -1364.9609070380704, -1001.2293537333794, -594.9124246845472, -795.264641981336, -493.460317598025, -1260.25719931767, -503.2726569078353, -163.17664667180847, -1093.8324644491172, -657.4742833336405, -548.9540518734283, -1143.9509426613256, -982.5123993312151, -613.947166394909, -332.96990535148944, -840.2003666158986, -558.6432756696703]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530643060352869, "mean_inference_ms": 1.68000314478966, "mean_action_processing_ms": 0.27757334838951875, "mean_env_wait_ms": 3.4588352108929543, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01166391372680664, "StateBufferConnector_ms": 0.007823467254638672, "ViewRequirementAgentConnector_ms": 0.19271039962768555}, "num_episodes": 28, "episode_return_max": -52.36603967542782, "episode_return_min": -1394.3994068649665, "episode_return_mean": -734.227089498061, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.8828604865851, "num_env_steps_trained_throughput_per_sec": 304.8828604865851, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12416.754, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12416.675, "sample_time_ms": 1156.106, "learn_time_ms": 11187.089, "learn_throughput": 357.555, "synch_weights_time_ms": 72.655}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00010", "date": "2024-08-04_06-26-28", "timestamp": 1722732988, "time_this_iter_s": 13.131327867507935, "time_total_s": 172.42029571533203, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237270f520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 172.42029571533203, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.216666666666665, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 17.620372402668, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.662330051759879, "policy_loss": -0.018013019256371384, "vf_loss": 8.675613448023796, "vf_explained_var": 0.5325440020610889, "kl": 0.020676451564198336, "entropy": 1.4732972828050455, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -52.36603967542782, "episode_reward_min": -1366.9242718141952, "episode_reward_mean": -725.4462601352783, "episode_len_mean": 139.79, "episode_media": {}, "episodes_timesteps_total": 13979, "policy_reward_min": {"policy_0": -1366.9242718141952}, "policy_reward_max": {"policy_0": -52.36603967542782}, "policy_reward_mean": {"policy_0": -725.4462601352783}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-997.3218683767225, -776.0134579534407, -1198.073567290119, -775.7071737484592, -1003.7404929046834, -889.3606157606359, -261.1077602125618, -1107.3096822026803, -423.28214224383515, -326.2816892668419, -697.7509139688149, -544.700479134574, -369.2374410298305, -1037.0206112058515, -771.6459823350767, -273.5896563221279, -259.1324768335158, -474.0769901655139, -1341.396193045161, -225.83796655710836, -400.5411876514216, -52.36603967542782, -612.3008507033926, -472.05522175833215, -1313.0327705250736, -1098.28086942525, -1270.653938613619, -993.9244391805026, -1058.156829361178, -1147.630008200775, -915.1163727839419, -456.9476126644358, -988.9692393273554, -1345.3800676582805, -571.810809723004, -867.8784885106257, -522.9230186451701, -397.42276019089417, -128.47205710296777, -887.102344954733, -991.7209289173273, -439.0350622620352, -681.8308207896805, -470.55210707525055, -642.1473052549541, -454.5855212079027, -555.6915780942545, -382.6089584773388, -292.4694328669916, -164.8036753673465, -800.0621236106658, -976.2487960151618, -1364.9609070380704, -1001.2293537333794, -594.9124246845472, -795.264641981336, -493.460317598025, -1260.25719931767, -503.2726569078353, -163.17664667180847, -1093.8324644491172, -657.4742833336405, -548.9540518734283, -1143.9509426613256, -982.5123993312151, -613.947166394909, -332.96990535148944, -840.2003666158986, -558.6432756696703, -927.5100182897299, -675.4674238940846, -752.060806637993, -1246.7364922985787, -948.1559987011029, -532.3293653875759, -663.1075522756364, -916.3434395608485, -712.1693320815798, -495.77695615453894, -664.4447377474194, -464.13146655463294, -533.0506738730506, -593.3150734473818, -1132.2163618455609, -91.06543195562004, -711.0932268317262, -901.8655523745059, -889.5213111751332, -219.45101605516675, -645.868072019863, -1270.5075496956522, -200.22131643743384, -382.08795392459314, -1180.2630242469165, -792.072730848955, -1278.2733828172534, -382.7724875077317, -1366.9242718141952, -1101.4116851173335, -820.0839011898353], "episode_lengths": [150, 142, 150, 150, 150, 150, 105, 150, 150, 98, 150, 150, 150, 150, 150, 74, 103, 150, 150, 74, 150, 44, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 81, 150, 150, 150, 150, 120, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 122, 150, 69, 150, 150, 150, 83, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 139], "policy_policy_0_reward": [-997.3218683767225, -776.0134579534407, -1198.073567290119, -775.7071737484592, -1003.7404929046834, -889.3606157606359, -261.1077602125618, -1107.3096822026803, -423.28214224383515, -326.2816892668419, -697.7509139688149, -544.700479134574, -369.2374410298305, -1037.0206112058515, -771.6459823350767, -273.5896563221279, -259.1324768335158, -474.0769901655139, -1341.396193045161, -225.83796655710836, -400.5411876514216, -52.36603967542782, -612.3008507033926, -472.05522175833215, -1313.0327705250736, -1098.28086942525, -1270.653938613619, -993.9244391805026, -1058.156829361178, -1147.630008200775, -915.1163727839419, -456.9476126644358, -988.9692393273554, -1345.3800676582805, -571.810809723004, -867.8784885106257, -522.9230186451701, -397.42276019089417, -128.47205710296777, -887.102344954733, -991.7209289173273, -439.0350622620352, -681.8308207896805, -470.55210707525055, -642.1473052549541, -454.5855212079027, -555.6915780942545, -382.6089584773388, -292.4694328669916, -164.8036753673465, -800.0621236106658, -976.2487960151618, -1364.9609070380704, -1001.2293537333794, -594.9124246845472, -795.264641981336, -493.460317598025, -1260.25719931767, -503.2726569078353, -163.17664667180847, -1093.8324644491172, -657.4742833336405, -548.9540518734283, -1143.9509426613256, -982.5123993312151, -613.947166394909, -332.96990535148944, -840.2003666158986, -558.6432756696703, -927.5100182897299, -675.4674238940846, -752.060806637993, -1246.7364922985787, -948.1559987011029, -532.3293653875759, -663.1075522756364, -916.3434395608485, -712.1693320815798, -495.77695615453894, -664.4447377474194, -464.13146655463294, -533.0506738730506, -593.3150734473818, -1132.2163618455609, -91.06543195562004, -711.0932268317262, -901.8655523745059, -889.5213111751332, -219.45101605516675, -645.868072019863, -1270.5075496956522, -200.22131643743384, -382.08795392459314, -1180.2630242469165, -792.072730848955, -1278.2733828172534, -382.7724875077317, -1366.9242718141952, -1101.4116851173335, -820.0839011898353]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5530191691505234, "mean_inference_ms": 1.676627394193732, "mean_action_processing_ms": 0.2771333206199852, "mean_env_wait_ms": 3.4595244361821487, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01182246208190918, "StateBufferConnector_ms": 0.0077915191650390625, "ViewRequirementAgentConnector_ms": 0.1961205005645752}, "num_episodes": 31, "episode_return_max": -52.36603967542782, "episode_return_min": -1366.9242718141952, "episode_return_mean": -725.4462601352783, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 380.90655819699134, "num_env_steps_trained_throughput_per_sec": 380.90655819699134, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12330.453, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12330.375, "sample_time_ms": 1148.217, "learn_time_ms": 11111.644, "learn_throughput": 359.983, "synch_weights_time_ms": 69.696}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00010", "date": "2024-08-04_06-26-38", "timestamp": 1722732998, "time_this_iter_s": 10.514814853668213, "time_total_s": 182.93511056900024, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b0111ea0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 182.93511056900024, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 19.933333333333334, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 20.8182843764623, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.736940987904866, "policy_loss": -0.011424951941201774, "vf_loss": 8.742595072090626, "vf_explained_var": 0.6175053020939231, "kl": 0.0156779195394241, "entropy": 1.2842124480754138, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -81.74523498815643, "episode_reward_min": -1407.0953771720199, "episode_reward_mean": -707.9731987966195, "episode_len_mean": 136.81, "episode_media": {}, "episodes_timesteps_total": 13681, "policy_reward_min": {"policy_0": -1407.0953771720199}, "policy_reward_max": {"policy_0": -81.74523498815643}, "policy_reward_mean": {"policy_0": -707.9731987966195}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-915.1163727839419, -456.9476126644358, -988.9692393273554, -1345.3800676582805, -571.810809723004, -867.8784885106257, -522.9230186451701, -397.42276019089417, -128.47205710296777, -887.102344954733, -991.7209289173273, -439.0350622620352, -681.8308207896805, -470.55210707525055, -642.1473052549541, -454.5855212079027, -555.6915780942545, -382.6089584773388, -292.4694328669916, -164.8036753673465, -800.0621236106658, -976.2487960151618, -1364.9609070380704, -1001.2293537333794, -594.9124246845472, -795.264641981336, -493.460317598025, -1260.25719931767, -503.2726569078353, -163.17664667180847, -1093.8324644491172, -657.4742833336405, -548.9540518734283, -1143.9509426613256, -982.5123993312151, -613.947166394909, -332.96990535148944, -840.2003666158986, -558.6432756696703, -927.5100182897299, -675.4674238940846, -752.060806637993, -1246.7364922985787, -948.1559987011029, -532.3293653875759, -663.1075522756364, -916.3434395608485, -712.1693320815798, -495.77695615453894, -664.4447377474194, -464.13146655463294, -533.0506738730506, -593.3150734473818, -1132.2163618455609, -91.06543195562004, -711.0932268317262, -901.8655523745059, -889.5213111751332, -219.45101605516675, -645.868072019863, -1270.5075496956522, -200.22131643743384, -382.08795392459314, -1180.2630242469165, -792.072730848955, -1278.2733828172534, -382.7724875077317, -1366.9242718141952, -1101.4116851173335, -820.0839011898353, -1216.4263126694643, -1407.0953771720199, -81.74523498815643, -1147.6352319731889, -1274.3103111890632, -1007.5778645242867, -727.0179224165271, -582.9107597587215, -648.0672899803563, -162.7026480891893, -129.49931312932856, -741.4224470570725, -931.991208773733, -513.5799359036464, -566.0574557467595, -878.4888787339073, -170.71584134881394, -762.2505687561003, -695.4873980666679, -1118.5886741866934, -565.4459536414197, -1040.0083529875853, -376.1808527164539, -1195.7827609654892, -532.0060574935429, -356.77376493969774, -277.90944226589727, -97.51548436725821, -152.8244060575475, -1066.2054318880455], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 95, 81, 150, 150, 150, 150, 120, 150, 150, 150, 150, 150, 64, 150, 150, 150, 150, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 122, 150, 69, 150, 150, 150, 83, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 56, 150, 150, 150, 150, 150, 150, 60, 49, 150, 150, 150, 127, 150, 66, 150, 150, 150, 150, 150, 99, 150, 150, 150, 74, 51, 60, 150], "policy_policy_0_reward": [-915.1163727839419, -456.9476126644358, -988.9692393273554, -1345.3800676582805, -571.810809723004, -867.8784885106257, -522.9230186451701, -397.42276019089417, -128.47205710296777, -887.102344954733, -991.7209289173273, -439.0350622620352, -681.8308207896805, -470.55210707525055, -642.1473052549541, -454.5855212079027, -555.6915780942545, -382.6089584773388, -292.4694328669916, -164.8036753673465, -800.0621236106658, -976.2487960151618, -1364.9609070380704, -1001.2293537333794, -594.9124246845472, -795.264641981336, -493.460317598025, -1260.25719931767, -503.2726569078353, -163.17664667180847, -1093.8324644491172, -657.4742833336405, -548.9540518734283, -1143.9509426613256, -982.5123993312151, -613.947166394909, -332.96990535148944, -840.2003666158986, -558.6432756696703, -927.5100182897299, -675.4674238940846, -752.060806637993, -1246.7364922985787, -948.1559987011029, -532.3293653875759, -663.1075522756364, -916.3434395608485, -712.1693320815798, -495.77695615453894, -664.4447377474194, -464.13146655463294, -533.0506738730506, -593.3150734473818, -1132.2163618455609, -91.06543195562004, -711.0932268317262, -901.8655523745059, -889.5213111751332, -219.45101605516675, -645.868072019863, -1270.5075496956522, -200.22131643743384, -382.08795392459314, -1180.2630242469165, -792.072730848955, -1278.2733828172534, -382.7724875077317, -1366.9242718141952, -1101.4116851173335, -820.0839011898353, -1216.4263126694643, -1407.0953771720199, -81.74523498815643, -1147.6352319731889, -1274.3103111890632, -1007.5778645242867, -727.0179224165271, -582.9107597587215, -648.0672899803563, -162.7026480891893, -129.49931312932856, -741.4224470570725, -931.991208773733, -513.5799359036464, -566.0574557467595, -878.4888787339073, -170.71584134881394, -762.2505687561003, -695.4873980666679, -1118.5886741866934, -565.4459536414197, -1040.0083529875853, -376.1808527164539, -1195.7827609654892, -532.0060574935429, -356.77376493969774, -277.90944226589727, -97.51548436725821, -152.8244060575475, -1066.2054318880455]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5528180039223883, "mean_inference_ms": 1.6762550839310322, "mean_action_processing_ms": 0.2770291904454916, "mean_env_wait_ms": 3.4616345739732086, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011748552322387695, "StateBufferConnector_ms": 0.007685661315917969, "ViewRequirementAgentConnector_ms": 0.1944417953491211}, "num_episodes": 30, "episode_return_max": -81.74523498815643, "episode_return_min": -1407.0953771720199, "episode_return_mean": -707.9731987966195, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 298.801729127333, "num_env_steps_trained_throughput_per_sec": 298.801729127333, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12319.631, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12319.556, "sample_time_ms": 1139.539, "learn_time_ms": 11111.686, "learn_throughput": 359.981, "synch_weights_time_ms": 67.505}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00010", "date": "2024-08-04_06-26-52", "timestamp": 1722733012, "time_this_iter_s": 13.39929986000061, "time_total_s": 196.33441042900085, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f4aef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 196.33441042900085, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 17.878947368421056, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.742124603937068, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.597513816754024, "policy_loss": -0.012221680114453192, "vf_loss": 8.60419486562411, "vf_explained_var": 0.5210654588416219, "kl": 0.015268611635777536, "entropy": 1.3302293244749308, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -81.74523498815643, "episode_reward_min": -1466.1508431142292, "episode_reward_mean": -692.9606792007797, "episode_len_mean": 131.84, "episode_media": {}, "episodes_timesteps_total": 13184, "policy_reward_min": {"policy_0": -1466.1508431142292}, "policy_reward_max": {"policy_0": -81.74523498815643}, "policy_reward_mean": {"policy_0": -692.9606792007797}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-548.9540518734283, -1143.9509426613256, -982.5123993312151, -613.947166394909, -332.96990535148944, -840.2003666158986, -558.6432756696703, -927.5100182897299, -675.4674238940846, -752.060806637993, -1246.7364922985787, -948.1559987011029, -532.3293653875759, -663.1075522756364, -916.3434395608485, -712.1693320815798, -495.77695615453894, -664.4447377474194, -464.13146655463294, -533.0506738730506, -593.3150734473818, -1132.2163618455609, -91.06543195562004, -711.0932268317262, -901.8655523745059, -889.5213111751332, -219.45101605516675, -645.868072019863, -1270.5075496956522, -200.22131643743384, -382.08795392459314, -1180.2630242469165, -792.072730848955, -1278.2733828172534, -382.7724875077317, -1366.9242718141952, -1101.4116851173335, -820.0839011898353, -1216.4263126694643, -1407.0953771720199, -81.74523498815643, -1147.6352319731889, -1274.3103111890632, -1007.5778645242867, -727.0179224165271, -582.9107597587215, -648.0672899803563, -162.7026480891893, -129.49931312932856, -741.4224470570725, -931.991208773733, -513.5799359036464, -566.0574557467595, -878.4888787339073, -170.71584134881394, -762.2505687561003, -695.4873980666679, -1118.5886741866934, -565.4459536414197, -1040.0083529875853, -376.1808527164539, -1195.7827609654892, -532.0060574935429, -356.77376493969774, -277.90944226589727, -97.51548436725821, -152.8244060575475, -1066.2054318880455, -1260.3316986944328, -1031.8811955714216, -1466.1508431142292, -1334.3727709283573, -479.14962030053897, -216.02038985522867, -744.0341067177509, -343.8942235077687, -192.69194075918412, -553.4724252784054, -679.503919275202, -734.5049422816134, -281.97536521826225, -235.67715769770112, -854.2343462809503, -1216.683467671293, -558.9286849870065, -952.1100112882432, -114.51189763708784, -803.6684919948052, -592.6453805463094, -197.91921412991343, -777.6225001500019, -117.01199448556125, -217.06060381884922, -533.8546849098856, -252.27280174192902, -468.81861000693635, -693.5205197921605, -1059.3305399443573, -645.7116276665926, -750.8020413797927], "episode_lengths": [150, 150, 150, 150, 110, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 146, 150, 150, 122, 150, 69, 150, 150, 150, 83, 150, 150, 79, 150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 56, 150, 150, 150, 150, 150, 150, 60, 49, 150, 150, 150, 127, 150, 66, 150, 150, 150, 150, 150, 99, 150, 150, 150, 74, 51, 60, 150, 150, 150, 150, 150, 113, 68, 150, 99, 65, 124, 150, 150, 150, 72, 150, 150, 150, 150, 58, 150, 150, 67, 150, 55, 74, 150, 71, 150, 128, 150, 150, 150], "policy_policy_0_reward": [-548.9540518734283, -1143.9509426613256, -982.5123993312151, -613.947166394909, -332.96990535148944, -840.2003666158986, -558.6432756696703, -927.5100182897299, -675.4674238940846, -752.060806637993, -1246.7364922985787, -948.1559987011029, -532.3293653875759, -663.1075522756364, -916.3434395608485, -712.1693320815798, -495.77695615453894, -664.4447377474194, -464.13146655463294, -533.0506738730506, -593.3150734473818, -1132.2163618455609, -91.06543195562004, -711.0932268317262, -901.8655523745059, -889.5213111751332, -219.45101605516675, -645.868072019863, -1270.5075496956522, -200.22131643743384, -382.08795392459314, -1180.2630242469165, -792.072730848955, -1278.2733828172534, -382.7724875077317, -1366.9242718141952, -1101.4116851173335, -820.0839011898353, -1216.4263126694643, -1407.0953771720199, -81.74523498815643, -1147.6352319731889, -1274.3103111890632, -1007.5778645242867, -727.0179224165271, -582.9107597587215, -648.0672899803563, -162.7026480891893, -129.49931312932856, -741.4224470570725, -931.991208773733, -513.5799359036464, -566.0574557467595, -878.4888787339073, -170.71584134881394, -762.2505687561003, -695.4873980666679, -1118.5886741866934, -565.4459536414197, -1040.0083529875853, -376.1808527164539, -1195.7827609654892, -532.0060574935429, -356.77376493969774, -277.90944226589727, -97.51548436725821, -152.8244060575475, -1066.2054318880455, -1260.3316986944328, -1031.8811955714216, -1466.1508431142292, -1334.3727709283573, -479.14962030053897, -216.02038985522867, -744.0341067177509, -343.8942235077687, -192.69194075918412, -553.4724252784054, -679.503919275202, -734.5049422816134, -281.97536521826225, -235.67715769770112, -854.2343462809503, -1216.683467671293, -558.9286849870065, -952.1100112882432, -114.51189763708784, -803.6684919948052, -592.6453805463094, -197.91921412991343, -777.6225001500019, -117.01199448556125, -217.06060381884922, -533.8546849098856, -252.27280174192902, -468.81861000693635, -693.5205197921605, -1059.3305399443573, -645.7116276665926, -750.8020413797927]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5531920960752494, "mean_inference_ms": 1.676237940970247, "mean_action_processing_ms": 0.27677780753598147, "mean_env_wait_ms": 3.4635042326218546, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011749267578125, "StateBufferConnector_ms": 0.007683515548706055, "ViewRequirementAgentConnector_ms": 0.1937999725341797}, "num_episodes": 32, "episode_return_max": -81.74523498815643, "episode_return_min": -1466.1508431142292, "episode_return_mean": -692.9606792007797, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 301.3740752832699, "num_env_steps_trained_throughput_per_sec": 301.3740752832699, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12356.978, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12356.903, "sample_time_ms": 1150.885, "learn_time_ms": 11138.507, "learn_throughput": 359.115, "synch_weights_time_ms": 66.706}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00010", "date": "2024-08-04_06-27-05", "timestamp": 1722733025, "time_this_iter_s": 13.287165403366089, "time_total_s": 209.62157583236694, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f49510>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 209.62157583236694, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.08421052631579, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 16.21270113562544, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.893126242359479, "policy_loss": -0.01598814363145114, "vf_loss": 8.902617969612281, "vf_explained_var": 0.4331799500932296, "kl": 0.018068404117063144, "entropy": 1.6343500620375078, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -81.74523498815643, "episode_reward_min": -1466.1508431142292, "episode_reward_mean": -715.777437526891, "episode_len_mean": 131.22, "episode_media": {}, "episodes_timesteps_total": 13122, "policy_reward_min": {"policy_0": -1466.1508431142292}, "policy_reward_max": {"policy_0": -81.74523498815643}, "policy_reward_mean": {"policy_0": -715.777437526891}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-382.08795392459314, -1180.2630242469165, -792.072730848955, -1278.2733828172534, -382.7724875077317, -1366.9242718141952, -1101.4116851173335, -820.0839011898353, -1216.4263126694643, -1407.0953771720199, -81.74523498815643, -1147.6352319731889, -1274.3103111890632, -1007.5778645242867, -727.0179224165271, -582.9107597587215, -648.0672899803563, -162.7026480891893, -129.49931312932856, -741.4224470570725, -931.991208773733, -513.5799359036464, -566.0574557467595, -878.4888787339073, -170.71584134881394, -762.2505687561003, -695.4873980666679, -1118.5886741866934, -565.4459536414197, -1040.0083529875853, -376.1808527164539, -1195.7827609654892, -532.0060574935429, -356.77376493969774, -277.90944226589727, -97.51548436725821, -152.8244060575475, -1066.2054318880455, -1260.3316986944328, -1031.8811955714216, -1466.1508431142292, -1334.3727709283573, -479.14962030053897, -216.02038985522867, -744.0341067177509, -343.8942235077687, -192.69194075918412, -553.4724252784054, -679.503919275202, -734.5049422816134, -281.97536521826225, -235.67715769770112, -854.2343462809503, -1216.683467671293, -558.9286849870065, -952.1100112882432, -114.51189763708784, -803.6684919948052, -592.6453805463094, -197.91921412991343, -777.6225001500019, -117.01199448556125, -217.06060381884922, -533.8546849098856, -252.27280174192902, -468.81861000693635, -693.5205197921605, -1059.3305399443573, -645.7116276665926, -750.8020413797927, -1044.9592286656464, -1113.94301995961, -977.6299508744789, -213.96297573190796, -1047.9582962576706, -1061.8039005642147, -963.4955764747515, -754.9702792278183, -542.0313951525836, -769.5118261587962, -1371.599686545954, -1396.3392427656024, -1313.203990180963, -681.5837350695077, -266.9499302703925, -593.6917228943536, -507.5746698361743, -800.9384755574125, -855.4642999723461, -953.029618920449, -373.72409142669215, -120.08448948846171, -320.5002108113657, -435.10615464653046, -585.7938607761407, -333.05258673356263, -933.3740394073219, -1141.9882956564302, -799.2284971351495, -1215.7690686416065], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 139, 150, 150, 56, 150, 150, 150, 150, 150, 150, 60, 49, 150, 150, 150, 127, 150, 66, 150, 150, 150, 150, 150, 99, 150, 150, 150, 74, 51, 60, 150, 150, 150, 150, 150, 113, 68, 150, 99, 65, 124, 150, 150, 150, 72, 150, 150, 150, 150, 58, 150, 150, 67, 150, 55, 74, 150, 71, 150, 128, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 57, 95, 150, 150, 96, 150, 150, 150, 150], "policy_policy_0_reward": [-382.08795392459314, -1180.2630242469165, -792.072730848955, -1278.2733828172534, -382.7724875077317, -1366.9242718141952, -1101.4116851173335, -820.0839011898353, -1216.4263126694643, -1407.0953771720199, -81.74523498815643, -1147.6352319731889, -1274.3103111890632, -1007.5778645242867, -727.0179224165271, -582.9107597587215, -648.0672899803563, -162.7026480891893, -129.49931312932856, -741.4224470570725, -931.991208773733, -513.5799359036464, -566.0574557467595, -878.4888787339073, -170.71584134881394, -762.2505687561003, -695.4873980666679, -1118.5886741866934, -565.4459536414197, -1040.0083529875853, -376.1808527164539, -1195.7827609654892, -532.0060574935429, -356.77376493969774, -277.90944226589727, -97.51548436725821, -152.8244060575475, -1066.2054318880455, -1260.3316986944328, -1031.8811955714216, -1466.1508431142292, -1334.3727709283573, -479.14962030053897, -216.02038985522867, -744.0341067177509, -343.8942235077687, -192.69194075918412, -553.4724252784054, -679.503919275202, -734.5049422816134, -281.97536521826225, -235.67715769770112, -854.2343462809503, -1216.683467671293, -558.9286849870065, -952.1100112882432, -114.51189763708784, -803.6684919948052, -592.6453805463094, -197.91921412991343, -777.6225001500019, -117.01199448556125, -217.06060381884922, -533.8546849098856, -252.27280174192902, -468.81861000693635, -693.5205197921605, -1059.3305399443573, -645.7116276665926, -750.8020413797927, -1044.9592286656464, -1113.94301995961, -977.6299508744789, -213.96297573190796, -1047.9582962576706, -1061.8039005642147, -963.4955764747515, -754.9702792278183, -542.0313951525836, -769.5118261587962, -1371.599686545954, -1396.3392427656024, -1313.203990180963, -681.5837350695077, -266.9499302703925, -593.6917228943536, -507.5746698361743, -800.9384755574125, -855.4642999723461, -953.029618920449, -373.72409142669215, -120.08448948846171, -320.5002108113657, -435.10615464653046, -585.7938607761407, -333.05258673356263, -933.3740394073219, -1141.9882956564302, -799.2284971351495, -1215.7690686416065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5537374191035231, "mean_inference_ms": 1.677721185826918, "mean_action_processing_ms": 0.2766108555069112, "mean_env_wait_ms": 3.46841755972365, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011607646942138672, "StateBufferConnector_ms": 0.007765531539916992, "ViewRequirementAgentConnector_ms": 0.19615936279296875}, "num_episodes": 30, "episode_return_max": -81.74523498815643, "episode_return_min": -1466.1508431142292, "episode_return_mean": -715.777437526891, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 309.1469199011141, "num_env_steps_trained_throughput_per_sec": 309.1469199011141, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12338.483, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12338.41, "sample_time_ms": 1153.329, "learn_time_ms": 11118.379, "learn_throughput": 359.765, "synch_weights_time_ms": 65.899}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00010", "date": "2024-08-04_06-27-18", "timestamp": 1722733038, "time_this_iter_s": 12.950497388839722, "time_total_s": 222.57207322120667, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f4a7a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 222.57207322120667, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 17.910526315789472, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.915783906479678, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.230092928310235, "policy_loss": -0.01069474489922868, "vf_loss": 8.234820593893527, "vf_explained_var": 0.6404209981982907, "kl": 0.016236010780933913, "entropy": 1.339094758220017, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -45.04556263720479, "episode_reward_min": -1511.3533411900064, "episode_reward_mean": -716.0239378208219, "episode_len_mean": 131.46, "episode_media": {}, "episodes_timesteps_total": 13146, "policy_reward_min": {"policy_0": -1511.3533411900064}, "policy_reward_max": {"policy_0": -45.04556263720479}, "policy_reward_mean": {"policy_0": -716.0239378208219}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1118.5886741866934, -565.4459536414197, -1040.0083529875853, -376.1808527164539, -1195.7827609654892, -532.0060574935429, -356.77376493969774, -277.90944226589727, -97.51548436725821, -152.8244060575475, -1066.2054318880455, -1260.3316986944328, -1031.8811955714216, -1466.1508431142292, -1334.3727709283573, -479.14962030053897, -216.02038985522867, -744.0341067177509, -343.8942235077687, -192.69194075918412, -553.4724252784054, -679.503919275202, -734.5049422816134, -281.97536521826225, -235.67715769770112, -854.2343462809503, -1216.683467671293, -558.9286849870065, -952.1100112882432, -114.51189763708784, -803.6684919948052, -592.6453805463094, -197.91921412991343, -777.6225001500019, -117.01199448556125, -217.06060381884922, -533.8546849098856, -252.27280174192902, -468.81861000693635, -693.5205197921605, -1059.3305399443573, -645.7116276665926, -750.8020413797927, -1044.9592286656464, -1113.94301995961, -977.6299508744789, -213.96297573190796, -1047.9582962576706, -1061.8039005642147, -963.4955764747515, -754.9702792278183, -542.0313951525836, -769.5118261587962, -1371.599686545954, -1396.3392427656024, -1313.203990180963, -681.5837350695077, -266.9499302703925, -593.6917228943536, -507.5746698361743, -800.9384755574125, -855.4642999723461, -953.029618920449, -373.72409142669215, -120.08448948846171, -320.5002108113657, -435.10615464653046, -585.7938607761407, -333.05258673356263, -933.3740394073219, -1141.9882956564302, -799.2284971351495, -1215.7690686416065, -1043.0778008489485, -564.9544518337077, -1244.840356966526, -827.4465990730779, -825.5194266679376, -641.2257615478052, -541.14009296546, -115.86172932209874, -647.9522497736842, -642.7692551758344, -1336.9507707258144, -858.6659415532603, -150.40002037895476, -1117.9252985253481, -45.04556263720479, -1032.6413329952697, -791.7024637015678, -514.7049381754377, -1000.3575461350256, -1271.4257337690722, -1511.3533411900064, -650.4295717507697, -804.447377873674, -1182.509233187159, -709.5968340586194, -301.5360508325707, -599.041725472065], "episode_lengths": [150, 150, 150, 99, 150, 150, 150, 74, 51, 60, 150, 150, 150, 150, 150, 113, 68, 150, 99, 65, 124, 150, 150, 150, 72, 150, 150, 150, 150, 58, 150, 150, 67, 150, 55, 74, 150, 71, 150, 128, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 57, 95, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 54, 150, 150, 150, 150, 73, 150, 41, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 83, 150], "policy_policy_0_reward": [-1118.5886741866934, -565.4459536414197, -1040.0083529875853, -376.1808527164539, -1195.7827609654892, -532.0060574935429, -356.77376493969774, -277.90944226589727, -97.51548436725821, -152.8244060575475, -1066.2054318880455, -1260.3316986944328, -1031.8811955714216, -1466.1508431142292, -1334.3727709283573, -479.14962030053897, -216.02038985522867, -744.0341067177509, -343.8942235077687, -192.69194075918412, -553.4724252784054, -679.503919275202, -734.5049422816134, -281.97536521826225, -235.67715769770112, -854.2343462809503, -1216.683467671293, -558.9286849870065, -952.1100112882432, -114.51189763708784, -803.6684919948052, -592.6453805463094, -197.91921412991343, -777.6225001500019, -117.01199448556125, -217.06060381884922, -533.8546849098856, -252.27280174192902, -468.81861000693635, -693.5205197921605, -1059.3305399443573, -645.7116276665926, -750.8020413797927, -1044.9592286656464, -1113.94301995961, -977.6299508744789, -213.96297573190796, -1047.9582962576706, -1061.8039005642147, -963.4955764747515, -754.9702792278183, -542.0313951525836, -769.5118261587962, -1371.599686545954, -1396.3392427656024, -1313.203990180963, -681.5837350695077, -266.9499302703925, -593.6917228943536, -507.5746698361743, -800.9384755574125, -855.4642999723461, -953.029618920449, -373.72409142669215, -120.08448948846171, -320.5002108113657, -435.10615464653046, -585.7938607761407, -333.05258673356263, -933.3740394073219, -1141.9882956564302, -799.2284971351495, -1215.7690686416065, -1043.0778008489485, -564.9544518337077, -1244.840356966526, -827.4465990730779, -825.5194266679376, -641.2257615478052, -541.14009296546, -115.86172932209874, -647.9522497736842, -642.7692551758344, -1336.9507707258144, -858.6659415532603, -150.40002037895476, -1117.9252985253481, -45.04556263720479, -1032.6413329952697, -791.7024637015678, -514.7049381754377, -1000.3575461350256, -1271.4257337690722, -1511.3533411900064, -650.4295717507697, -804.447377873674, -1182.509233187159, -709.5968340586194, -301.5360508325707, -599.041725472065]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553553920753747, "mean_inference_ms": 1.6759662005325768, "mean_action_processing_ms": 0.27602757531922983, "mean_env_wait_ms": 3.4672447147913177, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0117950439453125, "StateBufferConnector_ms": 0.007901668548583984, "ViewRequirementAgentConnector_ms": 0.19397759437561035}, "num_episodes": 27, "episode_return_max": -45.04556263720479, "episode_return_min": -1511.3533411900064, "episode_return_mean": -716.0239378208219, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 320.60014688139967, "num_env_steps_trained_throughput_per_sec": 320.60014688139967, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12308.509, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12308.438, "sample_time_ms": 1153.617, "learn_time_ms": 11088.635, "learn_throughput": 360.73, "synch_weights_time_ms": 65.397}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00010", "date": "2024-08-04_06-27-31", "timestamp": 1722733051, "time_this_iter_s": 12.490416049957275, "time_total_s": 235.06248927116394, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f49e10>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 235.06248927116394, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.37222222222222, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 29.153500861426195, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.047448865572612, "policy_loss": -0.00913072309049312, "vf_loss": 8.051528920233249, "vf_explained_var": 0.6159908865268032, "kl": 0.01408354752344773, "entropy": 1.2869426228726903, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -45.04556263720479, "episode_reward_min": -1516.890183256416, "episode_reward_mean": -710.5049296750092, "episode_len_mean": 134.53, "episode_media": {}, "episodes_timesteps_total": 13453, "policy_reward_min": {"policy_0": -1516.890183256416}, "policy_reward_max": {"policy_0": -45.04556263720479}, "policy_reward_mean": {"policy_0": -710.5049296750092}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-114.51189763708784, -803.6684919948052, -592.6453805463094, -197.91921412991343, -777.6225001500019, -117.01199448556125, -217.06060381884922, -533.8546849098856, -252.27280174192902, -468.81861000693635, -693.5205197921605, -1059.3305399443573, -645.7116276665926, -750.8020413797927, -1044.9592286656464, -1113.94301995961, -977.6299508744789, -213.96297573190796, -1047.9582962576706, -1061.8039005642147, -963.4955764747515, -754.9702792278183, -542.0313951525836, -769.5118261587962, -1371.599686545954, -1396.3392427656024, -1313.203990180963, -681.5837350695077, -266.9499302703925, -593.6917228943536, -507.5746698361743, -800.9384755574125, -855.4642999723461, -953.029618920449, -373.72409142669215, -120.08448948846171, -320.5002108113657, -435.10615464653046, -585.7938607761407, -333.05258673356263, -933.3740394073219, -1141.9882956564302, -799.2284971351495, -1215.7690686416065, -1043.0778008489485, -564.9544518337077, -1244.840356966526, -827.4465990730779, -825.5194266679376, -641.2257615478052, -541.14009296546, -115.86172932209874, -647.9522497736842, -642.7692551758344, -1336.9507707258144, -858.6659415532603, -150.40002037895476, -1117.9252985253481, -45.04556263720479, -1032.6413329952697, -791.7024637015678, -514.7049381754377, -1000.3575461350256, -1271.4257337690722, -1511.3533411900064, -650.4295717507697, -804.447377873674, -1182.509233187159, -709.5968340586194, -301.5360508325707, -599.041725472065, -960.2880888543484, -488.02253427518104, -1445.8164181198335, -798.4507213072224, -358.63285535014217, -762.6542088521841, -407.11955119833885, -483.92638830161894, -779.0837475625165, -565.8960809836784, -144.6709536182546, -635.3609388581632, -590.0278983489331, -273.12352664429864, -635.28862397792, -508.611357025769, -1084.9731962453632, -497.221066690362, -582.2955247095413, -299.26575660393803, -1108.757735968637, -1516.890183256416, -593.4637506061401, -635.4479160452152, -554.1941890667731, -607.3426927057258, -871.031695742499, -620.3372052999969, -554.7626701369495], "episode_lengths": [58, 150, 150, 67, 150, 55, 74, 150, 71, 150, 128, 150, 150, 150, 150, 150, 150, 65, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 84, 150, 150, 150, 150, 150, 150, 57, 95, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 54, 150, 150, 150, 150, 73, 150, 41, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 83, 150, 150, 150, 150, 150, 105, 130, 150, 103, 150, 114, 76, 150, 150, 73, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-114.51189763708784, -803.6684919948052, -592.6453805463094, -197.91921412991343, -777.6225001500019, -117.01199448556125, -217.06060381884922, -533.8546849098856, -252.27280174192902, -468.81861000693635, -693.5205197921605, -1059.3305399443573, -645.7116276665926, -750.8020413797927, -1044.9592286656464, -1113.94301995961, -977.6299508744789, -213.96297573190796, -1047.9582962576706, -1061.8039005642147, -963.4955764747515, -754.9702792278183, -542.0313951525836, -769.5118261587962, -1371.599686545954, -1396.3392427656024, -1313.203990180963, -681.5837350695077, -266.9499302703925, -593.6917228943536, -507.5746698361743, -800.9384755574125, -855.4642999723461, -953.029618920449, -373.72409142669215, -120.08448948846171, -320.5002108113657, -435.10615464653046, -585.7938607761407, -333.05258673356263, -933.3740394073219, -1141.9882956564302, -799.2284971351495, -1215.7690686416065, -1043.0778008489485, -564.9544518337077, -1244.840356966526, -827.4465990730779, -825.5194266679376, -641.2257615478052, -541.14009296546, -115.86172932209874, -647.9522497736842, -642.7692551758344, -1336.9507707258144, -858.6659415532603, -150.40002037895476, -1117.9252985253481, -45.04556263720479, -1032.6413329952697, -791.7024637015678, -514.7049381754377, -1000.3575461350256, -1271.4257337690722, -1511.3533411900064, -650.4295717507697, -804.447377873674, -1182.509233187159, -709.5968340586194, -301.5360508325707, -599.041725472065, -960.2880888543484, -488.02253427518104, -1445.8164181198335, -798.4507213072224, -358.63285535014217, -762.6542088521841, -407.11955119833885, -483.92638830161894, -779.0837475625165, -565.8960809836784, -144.6709536182546, -635.3609388581632, -590.0278983489331, -273.12352664429864, -635.28862397792, -508.611357025769, -1084.9731962453632, -497.221066690362, -582.2955247095413, -299.26575660393803, -1108.757735968637, -1516.890183256416, -593.4637506061401, -635.4479160452152, -554.1941890667731, -607.3426927057258, -871.031695742499, -620.3372052999969, -554.7626701369495]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5535039298978502, "mean_inference_ms": 1.675920393372043, "mean_action_processing_ms": 0.27583088883852475, "mean_env_wait_ms": 3.4679541900990336, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011965751647949219, "StateBufferConnector_ms": 0.007861852645874023, "ViewRequirementAgentConnector_ms": 0.1965484619140625}, "num_episodes": 29, "episode_return_max": -45.04556263720479, "episode_return_min": -1516.890183256416, "episode_return_mean": -710.5049296750092, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.30507767037244, "num_env_steps_trained_throughput_per_sec": 297.30507767037244, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12549.847, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12549.775, "sample_time_ms": 1165.175, "learn_time_ms": 11317.739, "learn_throughput": 353.427, "synch_weights_time_ms": 66.026}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00010", "date": "2024-08-04_06-27-44", "timestamp": 1722733064, "time_this_iter_s": 13.46799373626709, "time_total_s": 248.53048300743103, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f49480>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 248.53048300743103, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 17.926315789473684, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 35.22574936946233, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.293432147800923, "policy_loss": -0.013462162010546308, "vf_loss": 8.30075333515803, "vf_explained_var": 0.6650107976670067, "kl": 0.016797035364088705, "entropy": 1.4177211858332157, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -45.04556263720479, "episode_reward_min": -1516.890183256416, "episode_reward_mean": -726.88569086594, "episode_len_mean": 136.63, "episode_media": {}, "episodes_timesteps_total": 13663, "policy_reward_min": {"policy_0": -1516.890183256416}, "policy_reward_max": {"policy_0": -45.04556263720479}, "policy_reward_mean": {"policy_0": -726.88569086594}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-593.6917228943536, -507.5746698361743, -800.9384755574125, -855.4642999723461, -953.029618920449, -373.72409142669215, -120.08448948846171, -320.5002108113657, -435.10615464653046, -585.7938607761407, -333.05258673356263, -933.3740394073219, -1141.9882956564302, -799.2284971351495, -1215.7690686416065, -1043.0778008489485, -564.9544518337077, -1244.840356966526, -827.4465990730779, -825.5194266679376, -641.2257615478052, -541.14009296546, -115.86172932209874, -647.9522497736842, -642.7692551758344, -1336.9507707258144, -858.6659415532603, -150.40002037895476, -1117.9252985253481, -45.04556263720479, -1032.6413329952697, -791.7024637015678, -514.7049381754377, -1000.3575461350256, -1271.4257337690722, -1511.3533411900064, -650.4295717507697, -804.447377873674, -1182.509233187159, -709.5968340586194, -301.5360508325707, -599.041725472065, -960.2880888543484, -488.02253427518104, -1445.8164181198335, -798.4507213072224, -358.63285535014217, -762.6542088521841, -407.11955119833885, -483.92638830161894, -779.0837475625165, -565.8960809836784, -144.6709536182546, -635.3609388581632, -590.0278983489331, -273.12352664429864, -635.28862397792, -508.611357025769, -1084.9731962453632, -497.221066690362, -582.2955247095413, -299.26575660393803, -1108.757735968637, -1516.890183256416, -593.4637506061401, -635.4479160452152, -554.1941890667731, -607.3426927057258, -871.031695742499, -620.3372052999969, -554.7626701369495, -1336.245585781322, -1068.8658380412976, -1349.4007301253125, -399.75409500892744, -1207.290187467351, -801.9024350180578, -386.8913246167686, -873.7583208565973, -803.8950513657235, -784.2463803203593, -1123.5261534425372, -483.4500701438639, -1276.1059712575207, -641.3629077766133, -819.1006920643354, -837.0747902615169, -452.2471727540792, -690.880539173437, -844.4444505152187, -101.46088787792945, -296.0622939010715, -58.514221666995205, -677.9337340249289, -643.2857855248715, -1129.2288924727357, -1233.875115065891, -605.7507472945448, -695.4893473160968, -760.7263400612362], "episode_lengths": [150, 150, 150, 150, 150, 150, 57, 95, 150, 150, 96, 150, 150, 150, 150, 150, 150, 150, 150, 150, 125, 150, 54, 150, 150, 150, 150, 73, 150, 41, 150, 150, 150, 150, 150, 150, 150, 145, 150, 150, 83, 150, 150, 150, 150, 150, 105, 130, 150, 103, 150, 114, 76, 150, 150, 73, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 81, 57, 150, 130, 150, 150, 150, 150, 133], "policy_policy_0_reward": [-593.6917228943536, -507.5746698361743, -800.9384755574125, -855.4642999723461, -953.029618920449, -373.72409142669215, -120.08448948846171, -320.5002108113657, -435.10615464653046, -585.7938607761407, -333.05258673356263, -933.3740394073219, -1141.9882956564302, -799.2284971351495, -1215.7690686416065, -1043.0778008489485, -564.9544518337077, -1244.840356966526, -827.4465990730779, -825.5194266679376, -641.2257615478052, -541.14009296546, -115.86172932209874, -647.9522497736842, -642.7692551758344, -1336.9507707258144, -858.6659415532603, -150.40002037895476, -1117.9252985253481, -45.04556263720479, -1032.6413329952697, -791.7024637015678, -514.7049381754377, -1000.3575461350256, -1271.4257337690722, -1511.3533411900064, -650.4295717507697, -804.447377873674, -1182.509233187159, -709.5968340586194, -301.5360508325707, -599.041725472065, -960.2880888543484, -488.02253427518104, -1445.8164181198335, -798.4507213072224, -358.63285535014217, -762.6542088521841, -407.11955119833885, -483.92638830161894, -779.0837475625165, -565.8960809836784, -144.6709536182546, -635.3609388581632, -590.0278983489331, -273.12352664429864, -635.28862397792, -508.611357025769, -1084.9731962453632, -497.221066690362, -582.2955247095413, -299.26575660393803, -1108.757735968637, -1516.890183256416, -593.4637506061401, -635.4479160452152, -554.1941890667731, -607.3426927057258, -871.031695742499, -620.3372052999969, -554.7626701369495, -1336.245585781322, -1068.8658380412976, -1349.4007301253125, -399.75409500892744, -1207.290187467351, -801.9024350180578, -386.8913246167686, -873.7583208565973, -803.8950513657235, -784.2463803203593, -1123.5261534425372, -483.4500701438639, -1276.1059712575207, -641.3629077766133, -819.1006920643354, -837.0747902615169, -452.2471727540792, -690.880539173437, -844.4444505152187, -101.46088787792945, -296.0622939010715, -58.514221666995205, -677.9337340249289, -643.2857855248715, -1129.2288924727357, -1233.875115065891, -605.7507472945448, -695.4893473160968, -760.7263400612362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.553307904412342, "mean_inference_ms": 1.6762163190084345, "mean_action_processing_ms": 0.27573136112918856, "mean_env_wait_ms": 3.4707885091617294, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011761903762817383, "StateBufferConnector_ms": 0.007968425750732422, "ViewRequirementAgentConnector_ms": 0.19765233993530273}, "num_episodes": 29, "episode_return_max": -45.04556263720479, "episode_return_min": -1516.890183256416, "episode_return_mean": -726.88569086594, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 303.4476816141378, "num_env_steps_trained_throughput_per_sec": 303.4476816141378, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12570.811, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12570.739, "sample_time_ms": 1166.007, "learn_time_ms": 11339.432, "learn_throughput": 352.751, "synch_weights_time_ms": 64.468}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00010", "date": "2024-08-04_06-27-58", "timestamp": 1722733078, "time_this_iter_s": 13.193921327590942, "time_total_s": 261.724404335022, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f48ca0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 261.724404335022, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 18.15, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 33.70630482484897, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.591677284737428, "policy_loss": -0.01635883242027679, "vf_loss": 7.601037297646204, "vf_explained_var": 0.6549529960379005, "kl": 0.01888767696673315, "entropy": 1.5006180562078952, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -33.04069391180208, "episode_reward_min": -1516.890183256416, "episode_reward_mean": -737.6869515974317, "episode_len_mean": 136.47, "episode_media": {}, "episodes_timesteps_total": 13647, "policy_reward_min": {"policy_0": -1516.890183256416}, "policy_reward_max": {"policy_0": -33.04069391180208}, "policy_reward_mean": {"policy_0": -737.6869515974317}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-791.7024637015678, -514.7049381754377, -1000.3575461350256, -1271.4257337690722, -1511.3533411900064, -650.4295717507697, -804.447377873674, -1182.509233187159, -709.5968340586194, -301.5360508325707, -599.041725472065, -960.2880888543484, -488.02253427518104, -1445.8164181198335, -798.4507213072224, -358.63285535014217, -762.6542088521841, -407.11955119833885, -483.92638830161894, -779.0837475625165, -565.8960809836784, -144.6709536182546, -635.3609388581632, -590.0278983489331, -273.12352664429864, -635.28862397792, -508.611357025769, -1084.9731962453632, -497.221066690362, -582.2955247095413, -299.26575660393803, -1108.757735968637, -1516.890183256416, -593.4637506061401, -635.4479160452152, -554.1941890667731, -607.3426927057258, -871.031695742499, -620.3372052999969, -554.7626701369495, -1336.245585781322, -1068.8658380412976, -1349.4007301253125, -399.75409500892744, -1207.290187467351, -801.9024350180578, -386.8913246167686, -873.7583208565973, -803.8950513657235, -784.2463803203593, -1123.5261534425372, -483.4500701438639, -1276.1059712575207, -641.3629077766133, -819.1006920643354, -837.0747902615169, -452.2471727540792, -690.880539173437, -844.4444505152187, -101.46088787792945, -296.0622939010715, -58.514221666995205, -677.9337340249289, -643.2857855248715, -1129.2288924727357, -1233.875115065891, -605.7507472945448, -695.4893473160968, -760.7263400612362, -956.7416615314382, -683.3850243681177, -834.4392071374624, -655.8571759014733, -380.34115530594283, -945.2271673758751, -915.8236184180432, -250.52087439483128, -969.3079018117774, -33.04069391180208, -204.31240144840868, -948.029352250485, -553.6475026130338, -1207.0903470864387, -581.1694450174502, -119.8550460389336, -523.5802165795944, -543.9628652613686, -946.3236442845578, -254.07564876562148, -1157.095059748681, -1043.4152225585515, -688.4131766779377, -1231.9065027014988, -703.98729603347, -1343.0559770790467, -717.5654946286396, -1255.6284685634178, -686.0891671429749, -755.771017762224, -596.2044736450296], "episode_lengths": [150, 150, 150, 150, 150, 150, 145, 150, 150, 83, 150, 150, 150, 150, 150, 105, 130, 150, 103, 150, 114, 76, 150, 150, 73, 150, 150, 150, 150, 150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 81, 57, 150, 130, 150, 150, 150, 150, 133, 150, 150, 150, 150, 87, 145, 150, 79, 150, 47, 65, 150, 150, 150, 150, 49, 128, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-791.7024637015678, -514.7049381754377, -1000.3575461350256, -1271.4257337690722, -1511.3533411900064, -650.4295717507697, -804.447377873674, -1182.509233187159, -709.5968340586194, -301.5360508325707, -599.041725472065, -960.2880888543484, -488.02253427518104, -1445.8164181198335, -798.4507213072224, -358.63285535014217, -762.6542088521841, -407.11955119833885, -483.92638830161894, -779.0837475625165, -565.8960809836784, -144.6709536182546, -635.3609388581632, -590.0278983489331, -273.12352664429864, -635.28862397792, -508.611357025769, -1084.9731962453632, -497.221066690362, -582.2955247095413, -299.26575660393803, -1108.757735968637, -1516.890183256416, -593.4637506061401, -635.4479160452152, -554.1941890667731, -607.3426927057258, -871.031695742499, -620.3372052999969, -554.7626701369495, -1336.245585781322, -1068.8658380412976, -1349.4007301253125, -399.75409500892744, -1207.290187467351, -801.9024350180578, -386.8913246167686, -873.7583208565973, -803.8950513657235, -784.2463803203593, -1123.5261534425372, -483.4500701438639, -1276.1059712575207, -641.3629077766133, -819.1006920643354, -837.0747902615169, -452.2471727540792, -690.880539173437, -844.4444505152187, -101.46088787792945, -296.0622939010715, -58.514221666995205, -677.9337340249289, -643.2857855248715, -1129.2288924727357, -1233.875115065891, -605.7507472945448, -695.4893473160968, -760.7263400612362, -956.7416615314382, -683.3850243681177, -834.4392071374624, -655.8571759014733, -380.34115530594283, -945.2271673758751, -915.8236184180432, -250.52087439483128, -969.3079018117774, -33.04069391180208, -204.31240144840868, -948.029352250485, -553.6475026130338, -1207.0903470864387, -581.1694450174502, -119.8550460389336, -523.5802165795944, -543.9628652613686, -946.3236442845578, -254.07564876562148, -1157.095059748681, -1043.4152225585515, -688.4131766779377, -1231.9065027014988, -703.98729603347, -1343.0559770790467, -717.5654946286396, -1255.6284685634178, -686.0891671429749, -755.771017762224, -596.2044736450296]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532719905669711, "mean_inference_ms": 1.6758811439272654, "mean_action_processing_ms": 0.2755729024304786, "mean_env_wait_ms": 3.4756724937466954, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01245570182800293, "StateBufferConnector_ms": 0.008048534393310547, "ViewRequirementAgentConnector_ms": 0.19960474967956543}, "num_episodes": 31, "episode_return_max": -33.04069391180208, "episode_return_min": -1516.890183256416, "episode_return_mean": -737.6869515974317, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.2736229582299, "num_env_steps_trained_throughput_per_sec": 313.2736229582299, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12502.835, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12502.762, "sample_time_ms": 1157.483, "learn_time_ms": 11278.784, "learn_throughput": 354.648, "synch_weights_time_ms": 65.658}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00010", "date": "2024-08-04_06-28-10", "timestamp": 1722733090, "time_this_iter_s": 12.781043291091919, "time_total_s": 274.5054476261139, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01a70a0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 274.5054476261139, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 18.099999999999998, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 40.548741069436076, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.457079650958379, "policy_loss": -0.008423365431372076, "vf_loss": 7.460132514437039, "vf_explained_var": 0.6773857739443581, "kl": 0.01481405381831188, "entropy": 1.2958279657488068, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -18.390106790643646, "episode_reward_min": -1516.890183256416, "episode_reward_mean": -758.486097446369, "episode_len_mean": 137.35, "episode_media": {}, "episodes_timesteps_total": 13735, "policy_reward_min": {"policy_0": -1516.890183256416}, "policy_reward_max": {"policy_0": -18.390106790643646}, "policy_reward_mean": {"policy_0": -758.486097446369}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-582.2955247095413, -299.26575660393803, -1108.757735968637, -1516.890183256416, -593.4637506061401, -635.4479160452152, -554.1941890667731, -607.3426927057258, -871.031695742499, -620.3372052999969, -554.7626701369495, -1336.245585781322, -1068.8658380412976, -1349.4007301253125, -399.75409500892744, -1207.290187467351, -801.9024350180578, -386.8913246167686, -873.7583208565973, -803.8950513657235, -784.2463803203593, -1123.5261534425372, -483.4500701438639, -1276.1059712575207, -641.3629077766133, -819.1006920643354, -837.0747902615169, -452.2471727540792, -690.880539173437, -844.4444505152187, -101.46088787792945, -296.0622939010715, -58.514221666995205, -677.9337340249289, -643.2857855248715, -1129.2288924727357, -1233.875115065891, -605.7507472945448, -695.4893473160968, -760.7263400612362, -956.7416615314382, -683.3850243681177, -834.4392071374624, -655.8571759014733, -380.34115530594283, -945.2271673758751, -915.8236184180432, -250.52087439483128, -969.3079018117774, -33.04069391180208, -204.31240144840868, -948.029352250485, -553.6475026130338, -1207.0903470864387, -581.1694450174502, -119.8550460389336, -523.5802165795944, -543.9628652613686, -946.3236442845578, -254.07564876562148, -1157.095059748681, -1043.4152225585515, -688.4131766779377, -1231.9065027014988, -703.98729603347, -1343.0559770790467, -717.5654946286396, -1255.6284685634178, -686.0891671429749, -755.771017762224, -596.2044736450296, -669.3886058380378, -1380.667700496719, -1147.871064503503, -608.2835502283159, -613.787336593599, -199.6560311471208, -1302.5751408308365, -1050.8335359735609, -913.7268617258422, -1374.6392590726377, -587.5997295111174, -677.0491605148164, -632.773027240513, -613.3502348552412, -1085.224243151112, -18.390106790643646, -761.2028568012304, -842.6737038407072, -1095.9426618749746, -377.3994439956162, -484.6585185581805, -594.3984080494031, -1367.250408030965, -952.38473289472, -1199.2268932614757, -822.1666343565131, -249.16804183170555, -671.8186922461754, -542.0809730385067], "episode_lengths": [150, 81, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 115, 150, 150, 97, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 49, 81, 57, 150, 130, 150, 150, 150, 150, 133, 150, 150, 150, 150, 87, 145, 150, 79, 150, 47, 65, 150, 150, 150, 150, 49, 128, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 36, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 83, 150, 150], "policy_policy_0_reward": [-582.2955247095413, -299.26575660393803, -1108.757735968637, -1516.890183256416, -593.4637506061401, -635.4479160452152, -554.1941890667731, -607.3426927057258, -871.031695742499, -620.3372052999969, -554.7626701369495, -1336.245585781322, -1068.8658380412976, -1349.4007301253125, -399.75409500892744, -1207.290187467351, -801.9024350180578, -386.8913246167686, -873.7583208565973, -803.8950513657235, -784.2463803203593, -1123.5261534425372, -483.4500701438639, -1276.1059712575207, -641.3629077766133, -819.1006920643354, -837.0747902615169, -452.2471727540792, -690.880539173437, -844.4444505152187, -101.46088787792945, -296.0622939010715, -58.514221666995205, -677.9337340249289, -643.2857855248715, -1129.2288924727357, -1233.875115065891, -605.7507472945448, -695.4893473160968, -760.7263400612362, -956.7416615314382, -683.3850243681177, -834.4392071374624, -655.8571759014733, -380.34115530594283, -945.2271673758751, -915.8236184180432, -250.52087439483128, -969.3079018117774, -33.04069391180208, -204.31240144840868, -948.029352250485, -553.6475026130338, -1207.0903470864387, -581.1694450174502, -119.8550460389336, -523.5802165795944, -543.9628652613686, -946.3236442845578, -254.07564876562148, -1157.095059748681, -1043.4152225585515, -688.4131766779377, -1231.9065027014988, -703.98729603347, -1343.0559770790467, -717.5654946286396, -1255.6284685634178, -686.0891671429749, -755.771017762224, -596.2044736450296, -669.3886058380378, -1380.667700496719, -1147.871064503503, -608.2835502283159, -613.787336593599, -199.6560311471208, -1302.5751408308365, -1050.8335359735609, -913.7268617258422, -1374.6392590726377, -587.5997295111174, -677.0491605148164, -632.773027240513, -613.3502348552412, -1085.224243151112, -18.390106790643646, -761.2028568012304, -842.6737038407072, -1095.9426618749746, -377.3994439956162, -484.6585185581805, -594.3984080494031, -1367.250408030965, -952.38473289472, -1199.2268932614757, -822.1666343565131, -249.16804183170555, -671.8186922461754, -542.0809730385067]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5535475842898933, "mean_inference_ms": 1.6769851260202173, "mean_action_processing_ms": 0.27569873044886095, "mean_env_wait_ms": 3.480876824057855, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012231111526489258, "StateBufferConnector_ms": 0.008046627044677734, "ViewRequirementAgentConnector_ms": 0.19868183135986328}, "num_episodes": 29, "episode_return_max": -18.390106790643646, "episode_return_min": -1516.890183256416, "episode_return_mean": -758.486097446369, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 306.0270668399235, "num_env_steps_trained_throughput_per_sec": 306.0270668399235, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12817.112, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12817.038, "sample_time_ms": 1155.352, "learn_time_ms": 11593.045, "learn_throughput": 345.034, "synch_weights_time_ms": 67.803}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00010", "date": "2024-08-04_06-28-23", "timestamp": 1722733103, "time_this_iter_s": 13.083994150161743, "time_total_s": 287.58944177627563, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370fb85e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 287.58944177627563, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.32777777777778, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 41.119549609224, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.708386393884818, "policy_loss": -0.006170504713857857, "vf_loss": 7.708859678606192, "vf_explained_var": 0.6603069406623642, "kl": 0.016123246609155727, "entropy": 1.5582425842682521, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -18.390106790643646, "episode_reward_min": -1413.4907613862763, "episode_reward_mean": -716.5222623347306, "episode_len_mean": 134.85, "episode_media": {}, "episodes_timesteps_total": 13485, "policy_reward_min": {"policy_0": -1413.4907613862763}, "policy_reward_max": {"policy_0": -18.390106790643646}, "policy_reward_mean": {"policy_0": -716.5222623347306}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-690.880539173437, -844.4444505152187, -101.46088787792945, -296.0622939010715, -58.514221666995205, -677.9337340249289, -643.2857855248715, -1129.2288924727357, -1233.875115065891, -605.7507472945448, -695.4893473160968, -760.7263400612362, -956.7416615314382, -683.3850243681177, -834.4392071374624, -655.8571759014733, -380.34115530594283, -945.2271673758751, -915.8236184180432, -250.52087439483128, -969.3079018117774, -33.04069391180208, -204.31240144840868, -948.029352250485, -553.6475026130338, -1207.0903470864387, -581.1694450174502, -119.8550460389336, -523.5802165795944, -543.9628652613686, -946.3236442845578, -254.07564876562148, -1157.095059748681, -1043.4152225585515, -688.4131766779377, -1231.9065027014988, -703.98729603347, -1343.0559770790467, -717.5654946286396, -1255.6284685634178, -686.0891671429749, -755.771017762224, -596.2044736450296, -669.3886058380378, -1380.667700496719, -1147.871064503503, -608.2835502283159, -613.787336593599, -199.6560311471208, -1302.5751408308365, -1050.8335359735609, -913.7268617258422, -1374.6392590726377, -587.5997295111174, -677.0491605148164, -632.773027240513, -613.3502348552412, -1085.224243151112, -18.390106790643646, -761.2028568012304, -842.6737038407072, -1095.9426618749746, -377.3994439956162, -484.6585185581805, -594.3984080494031, -1367.250408030965, -952.38473289472, -1199.2268932614757, -822.1666343565131, -249.16804183170555, -671.8186922461754, -542.0809730385067, -551.66776116821, -886.8974284945726, -1080.3084405893544, -1077.9902725151042, -44.60924735362281, -684.7092869296368, -132.21011094600837, -412.003685197426, -641.8106580288428, -568.0355197786089, -715.8494054703954, -580.6437382000599, -612.5791958863142, -796.3184443249223, -672.6398832546915, -1413.4907613862763, -630.0897323316561, -319.5808106648249, -1119.0600036317494, -372.7717480780296, -289.2220714254437, -558.2744365410844, -700.7728741631998, -673.7905654631219, -582.2816729594902, -901.39970268901, -553.219237062688, -820.2968207458362], "episode_lengths": [150, 150, 49, 81, 57, 150, 130, 150, 150, 150, 150, 133, 150, 150, 150, 150, 87, 145, 150, 79, 150, 47, 65, 150, 150, 150, 150, 49, 128, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 36, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 83, 150, 150, 123, 150, 150, 150, 51, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 87, 77, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-690.880539173437, -844.4444505152187, -101.46088787792945, -296.0622939010715, -58.514221666995205, -677.9337340249289, -643.2857855248715, -1129.2288924727357, -1233.875115065891, -605.7507472945448, -695.4893473160968, -760.7263400612362, -956.7416615314382, -683.3850243681177, -834.4392071374624, -655.8571759014733, -380.34115530594283, -945.2271673758751, -915.8236184180432, -250.52087439483128, -969.3079018117774, -33.04069391180208, -204.31240144840868, -948.029352250485, -553.6475026130338, -1207.0903470864387, -581.1694450174502, -119.8550460389336, -523.5802165795944, -543.9628652613686, -946.3236442845578, -254.07564876562148, -1157.095059748681, -1043.4152225585515, -688.4131766779377, -1231.9065027014988, -703.98729603347, -1343.0559770790467, -717.5654946286396, -1255.6284685634178, -686.0891671429749, -755.771017762224, -596.2044736450296, -669.3886058380378, -1380.667700496719, -1147.871064503503, -608.2835502283159, -613.787336593599, -199.6560311471208, -1302.5751408308365, -1050.8335359735609, -913.7268617258422, -1374.6392590726377, -587.5997295111174, -677.0491605148164, -632.773027240513, -613.3502348552412, -1085.224243151112, -18.390106790643646, -761.2028568012304, -842.6737038407072, -1095.9426618749746, -377.3994439956162, -484.6585185581805, -594.3984080494031, -1367.250408030965, -952.38473289472, -1199.2268932614757, -822.1666343565131, -249.16804183170555, -671.8186922461754, -542.0809730385067, -551.66776116821, -886.8974284945726, -1080.3084405893544, -1077.9902725151042, -44.60924735362281, -684.7092869296368, -132.21011094600837, -412.003685197426, -641.8106580288428, -568.0355197786089, -715.8494054703954, -580.6437382000599, -612.5791958863142, -796.3184443249223, -672.6398832546915, -1413.4907613862763, -630.0897323316561, -319.5808106648249, -1119.0600036317494, -372.7717480780296, -289.2220714254437, -558.2744365410844, -700.7728741631998, -673.7905654631219, -582.2816729594902, -901.39970268901, -553.219237062688, -820.2968207458362]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5536315811158062, "mean_inference_ms": 1.6749970153197733, "mean_action_processing_ms": 0.2754057054397104, "mean_env_wait_ms": 3.4804423972343144, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012183666229248047, "StateBufferConnector_ms": 0.00801706314086914, "ViewRequirementAgentConnector_ms": 0.19441747665405273}, "num_episodes": 28, "episode_return_max": -18.390106790643646, "episode_return_min": -1413.4907613862763, "episode_return_mean": -716.5222623347306, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.33456681304773, "num_env_steps_trained_throughput_per_sec": 305.33456681304773, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12815.171, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12815.098, "sample_time_ms": 1160.287, "learn_time_ms": 11587.249, "learn_throughput": 345.207, "synch_weights_time_ms": 66.732}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00010", "date": "2024-08-04_06-28-37", "timestamp": 1722733117, "time_this_iter_s": 13.114094257354736, "time_total_s": 300.70353603363037, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370f1be20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 300.70353603363037, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.157894736842106, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 56.152905223766965, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.3384443640708925, "policy_loss": -0.008437970238446724, "vf_loss": 7.341679725547632, "vf_explained_var": 0.6848504588007926, "kl": 0.014909622277264157, "entropy": 1.5067254794140656, "entropy_coeff": 0.0010000000000000005}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -18.390106790643646, "episode_reward_min": -1542.9676985972142, "episode_reward_mean": -791.4000454042938, "episode_len_mean": 139.8, "episode_media": {}, "episodes_timesteps_total": 13980, "policy_reward_min": {"policy_0": -1542.9676985972142}, "policy_reward_max": {"policy_0": -18.390106790643646}, "policy_reward_mean": {"policy_0": -791.4000454042938}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-523.5802165795944, -543.9628652613686, -946.3236442845578, -254.07564876562148, -1157.095059748681, -1043.4152225585515, -688.4131766779377, -1231.9065027014988, -703.98729603347, -1343.0559770790467, -717.5654946286396, -1255.6284685634178, -686.0891671429749, -755.771017762224, -596.2044736450296, -669.3886058380378, -1380.667700496719, -1147.871064503503, -608.2835502283159, -613.787336593599, -199.6560311471208, -1302.5751408308365, -1050.8335359735609, -913.7268617258422, -1374.6392590726377, -587.5997295111174, -677.0491605148164, -632.773027240513, -613.3502348552412, -1085.224243151112, -18.390106790643646, -761.2028568012304, -842.6737038407072, -1095.9426618749746, -377.3994439956162, -484.6585185581805, -594.3984080494031, -1367.250408030965, -952.38473289472, -1199.2268932614757, -822.1666343565131, -249.16804183170555, -671.8186922461754, -542.0809730385067, -551.66776116821, -886.8974284945726, -1080.3084405893544, -1077.9902725151042, -44.60924735362281, -684.7092869296368, -132.21011094600837, -412.003685197426, -641.8106580288428, -568.0355197786089, -715.8494054703954, -580.6437382000599, -612.5791958863142, -796.3184443249223, -672.6398832546915, -1413.4907613862763, -630.0897323316561, -319.5808106648249, -1119.0600036317494, -372.7717480780296, -289.2220714254437, -558.2744365410844, -700.7728741631998, -673.7905654631219, -582.2816729594902, -901.39970268901, -553.219237062688, -820.2968207458362, -1250.7257486211265, -1174.5417598556637, -261.0274772963688, -1171.3803909439296, -609.8676919309743, -1105.7060967034338, -765.8438294546249, -642.700348696859, -711.5979063769208, -756.3094543816616, -1354.1539524664292, -1014.0610758415266, -1470.0538372464262, -223.442334150783, -1542.9676985972142, -567.6040749468915, -1187.731261217584, -158.07452241863317, -671.174412334364, -855.7221047354107, -612.0602722415114, -946.0949542639864, -1506.8193925271585, -1228.9985102951098, -1258.9719221239986, -873.4233773847164, -947.3220945878243, -595.8427348216522], "episode_lengths": [128, 150, 150, 75, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 36, 150, 150, 150, 98, 150, 150, 150, 150, 150, 150, 83, 150, 150, 123, 150, 150, 150, 51, 150, 69, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 86, 150, 87, 77, 150, 150, 150, 150, 150, 150, 150, 150, 150, 83, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 67, 150, 150, 150, 67, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-523.5802165795944, -543.9628652613686, -946.3236442845578, -254.07564876562148, -1157.095059748681, -1043.4152225585515, -688.4131766779377, -1231.9065027014988, -703.98729603347, -1343.0559770790467, -717.5654946286396, -1255.6284685634178, -686.0891671429749, -755.771017762224, -596.2044736450296, -669.3886058380378, -1380.667700496719, -1147.871064503503, -608.2835502283159, -613.787336593599, -199.6560311471208, -1302.5751408308365, -1050.8335359735609, -913.7268617258422, -1374.6392590726377, -587.5997295111174, -677.0491605148164, -632.773027240513, -613.3502348552412, -1085.224243151112, -18.390106790643646, -761.2028568012304, -842.6737038407072, -1095.9426618749746, -377.3994439956162, -484.6585185581805, -594.3984080494031, -1367.250408030965, -952.38473289472, -1199.2268932614757, -822.1666343565131, -249.16804183170555, -671.8186922461754, -542.0809730385067, -551.66776116821, -886.8974284945726, -1080.3084405893544, -1077.9902725151042, -44.60924735362281, -684.7092869296368, -132.21011094600837, -412.003685197426, -641.8106580288428, -568.0355197786089, -715.8494054703954, -580.6437382000599, -612.5791958863142, -796.3184443249223, -672.6398832546915, -1413.4907613862763, -630.0897323316561, -319.5808106648249, -1119.0600036317494, -372.7717480780296, -289.2220714254437, -558.2744365410844, -700.7728741631998, -673.7905654631219, -582.2816729594902, -901.39970268901, -553.219237062688, -820.2968207458362, -1250.7257486211265, -1174.5417598556637, -261.0274772963688, -1171.3803909439296, -609.8676919309743, -1105.7060967034338, -765.8438294546249, -642.700348696859, -711.5979063769208, -756.3094543816616, -1354.1539524664292, -1014.0610758415266, -1470.0538372464262, -223.442334150783, -1542.9676985972142, -567.6040749468915, -1187.731261217584, -158.07452241863317, -671.174412334364, -855.7221047354107, -612.0602722415114, -946.0949542639864, -1506.8193925271585, -1228.9985102951098, -1258.9719221239986, -873.4233773847164, -947.3220945878243, -595.8427348216522]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5541045928754895, "mean_inference_ms": 1.6758846359317996, "mean_action_processing_ms": 0.27553229215084657, "mean_env_wait_ms": 3.481118672649501, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01195383071899414, "StateBufferConnector_ms": 0.007900238037109375, "ViewRequirementAgentConnector_ms": 0.19243669509887695}, "num_episodes": 28, "episode_return_max": -18.390106790643646, "episode_return_min": -1542.9676985972142, "episode_return_mean": -791.4000454042938, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.3391838057942, "num_env_steps_trained_throughput_per_sec": 308.3391838057942, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 13062.318, "restore_workers_time_ms": 0.031, "training_step_time_ms": 13062.242, "sample_time_ms": 1164.031, "learn_time_ms": 11830.732, "learn_throughput": 338.102, "synch_weights_time_ms": 66.652}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00010", "date": "2024-08-04_06-28-50", "timestamp": 1722733130, "time_this_iter_s": 12.985233545303345, "time_total_s": 313.6887695789337, "pid": 584158, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923b01a6b90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.001, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.95, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 313.6887695789337, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.18421052631579, "ram_util_percent": 28.0}}
