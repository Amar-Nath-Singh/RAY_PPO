{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 0.8751213543427487, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.787468966841697, "policy_loss": -0.0036335418893334768, "vf_loss": 9.804322156310082, "vf_explained_var": -0.04385688578089078, "kl": 0.005670743715419728, "entropy": 1.4353776494661967, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 480.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "env_runners": {"episode_reward_max": -96.01603340821775, "episode_reward_min": -1365.9838100690151, "episode_reward_mean": -868.5493002563336, "episode_len_mean": 135.7826086956522, "episode_media": {}, "episodes_timesteps_total": 3123, "policy_reward_min": {"policy_0": -1365.9838100690151}, "policy_reward_max": {"policy_0": -96.01603340821775}, "policy_reward_mean": {"policy_0": -868.5493002563336}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1191.9177416353086, -705.4359380741182, -1032.3510965521443, -627.538097583657, -1084.7323877755634, -1295.0541242991542, -1183.2405742797375, -787.7504412675196, -1323.6645404922426, -96.01603340821775, -956.9546500443333, -156.90574800673994, -798.6846328682497, -872.6949911611829, -1324.560535157865, -337.9986408213993, -456.1901856870076, -727.3347818136032, -1198.6112133167478, -736.9782873843906, -1048.7512000541954, -667.284254143282, -1365.9838100690151], "episode_lengths": [150, 134, 150, 150, 150, 150, 150, 150, 150, 69, 150, 57, 150, 150, 150, 84, 104, 150, 150, 145, 150, 130, 150], "policy_policy_0_reward": [-1191.9177416353086, -705.4359380741182, -1032.3510965521443, -627.538097583657, -1084.7323877755634, -1295.0541242991542, -1183.2405742797375, -787.7504412675196, -1323.6645404922426, -96.01603340821775, -956.9546500443333, -156.90574800673994, -798.6846328682497, -872.6949911611829, -1324.560535157865, -337.9986408213993, -456.1901856870076, -727.3347818136032, -1198.6112133167478, -736.9782873843906, -1048.7512000541954, -667.284254143282, -1365.9838100690151]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5772487926748687, "mean_inference_ms": 1.6785592948410832, "mean_action_processing_ms": 0.2776711092793883, "mean_env_wait_ms": 3.388127057142293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011484519295070482, "StateBufferConnector_ms": 0.008344650268554688, "ViewRequirementAgentConnector_ms": 0.17931979635487433}, "num_episodes": 23, "episode_return_max": -96.01603340821775, "episode_return_min": -1365.9838100690151, "episode_return_mean": -868.5493002563336, "episodes_this_iter": 23}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000, "num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.1378634432709, "num_env_steps_trained_throughput_per_sec": 310.1378634432709, "timesteps_total": 4000, "num_env_steps_sampled_lifetime": 4000, "num_agent_steps_sampled_lifetime": 4000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 4000, "timers": {"training_iteration_time_ms": 12897.5, "restore_workers_time_ms": 0.025, "training_step_time_ms": 12897.433, "sample_time_ms": 1107.367, "learn_time_ms": 11716.834, "learn_throughput": 341.389, "synch_weights_time_ms": 72.302}, "counters": {"num_env_steps_sampled": 4000, "num_env_steps_trained": 4000, "num_agent_steps_sampled": 4000, "num_agent_steps_trained": 4000}, "done": false, "training_iteration": 1, "trial_id": "1a22e_00017", "date": "2024-08-04_07-02-25", "timestamp": 1722735145, "time_this_iter_s": 12.907844543457031, "time_total_s": 12.907844543457031, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370724820>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 12.907844543457031, "iterations_since_restore": 1, "perf": {"cpu_util_percent": 17.710526315789473, "ram_util_percent": 27.989473684210523}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.115537855370591, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.676653103033702, "policy_loss": -0.006490701178942497, "vf_loss": 9.695092138648032, "vf_explained_var": 0.03504291052619616, "kl": 0.011810435968739815, "entropy": 1.431041290735205, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 1440.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "env_runners": {"episode_reward_max": -66.90245895898249, "episode_reward_min": -1365.9838100690151, "episode_reward_mean": -741.1123479918668, "episode_len_mean": 126.01923076923077, "episode_media": {}, "episodes_timesteps_total": 6553, "policy_reward_min": {"policy_0": -1365.9838100690151}, "policy_reward_max": {"policy_0": -66.90245895898249}, "policy_reward_mean": {"policy_0": -741.1123479918668}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1191.9177416353086, -705.4359380741182, -1032.3510965521443, -627.538097583657, -1084.7323877755634, -1295.0541242991542, -1183.2405742797375, -787.7504412675196, -1323.6645404922426, -96.01603340821775, -956.9546500443333, -156.90574800673994, -798.6846328682497, -872.6949911611829, -1324.560535157865, -337.9986408213993, -456.1901856870076, -727.3347818136032, -1198.6112133167478, -736.9782873843906, -1048.7512000541954, -667.284254143282, -1365.9838100690151, -950.601304506503, -793.5753645027323, -233.42771564624434, -790.4564801720364, -810.1797296002582, -1006.2195012159066, -948.9612802441005, -996.5594470340791, -826.322191514363, -1210.7397325965148, -1128.3137200950084, -878.8158528459862, -144.2703339643119, -535.267129125758, -66.90245895898249, -285.10809790524274, -205.9646999633909, -1202.7717424525588, -181.02681429842116, -467.3460199829509, -91.99332858879285, -544.110903937974, -94.8265814680821, -1224.405201731547, -96.18645146761959, -880.8145436108845, -113.79468040407434, -653.2973532297437, -1198.949528617343], "episode_lengths": [150, 134, 150, 150, 150, 150, 150, 150, 150, 69, 150, 57, 150, 150, 150, 84, 104, 150, 150, 145, 150, 130, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 113, 58, 89, 73, 150, 73, 105, 59, 150, 50, 150, 44, 150, 69, 135, 150], "policy_policy_0_reward": [-1191.9177416353086, -705.4359380741182, -1032.3510965521443, -627.538097583657, -1084.7323877755634, -1295.0541242991542, -1183.2405742797375, -787.7504412675196, -1323.6645404922426, -96.01603340821775, -956.9546500443333, -156.90574800673994, -798.6846328682497, -872.6949911611829, -1324.560535157865, -337.9986408213993, -456.1901856870076, -727.3347818136032, -1198.6112133167478, -736.9782873843906, -1048.7512000541954, -667.284254143282, -1365.9838100690151, -950.601304506503, -793.5753645027323, -233.42771564624434, -790.4564801720364, -810.1797296002582, -1006.2195012159066, -948.9612802441005, -996.5594470340791, -826.322191514363, -1210.7397325965148, -1128.3137200950084, -878.8158528459862, -144.2703339643119, -535.267129125758, -66.90245895898249, -285.10809790524274, -205.9646999633909, -1202.7717424525588, -181.02681429842116, -467.3460199829509, -91.99332858879285, -544.110903937974, -94.8265814680821, -1224.405201731547, -96.18645146761959, -880.8145436108845, -113.79468040407434, -653.2973532297437, -1198.949528617343]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5722021055926974, "mean_inference_ms": 1.6663702200954302, "mean_action_processing_ms": 0.2759660440459232, "mean_env_wait_ms": 3.3749051155259293, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013701273844792293, "StateBufferConnector_ms": 0.00852529819195087, "ViewRequirementAgentConnector_ms": 0.18326044082641602}, "num_episodes": 29, "episode_return_max": -66.90245895898249, "episode_return_min": -1365.9838100690151, "episode_return_mean": -741.1123479918668, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000, "num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.63861658479794, "num_env_steps_trained_throughput_per_sec": 304.63861658479794, "timesteps_total": 8000, "num_env_steps_sampled_lifetime": 8000, "num_agent_steps_sampled_lifetime": 8000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 8000, "timers": {"training_iteration_time_ms": 13013.911, "restore_workers_time_ms": 0.025, "training_step_time_ms": 13013.847, "sample_time_ms": 1107.476, "learn_time_ms": 11828.014, "learn_throughput": 338.18, "synch_weights_time_ms": 77.491}, "counters": {"num_env_steps_sampled": 8000, "num_env_steps_trained": 8000, "num_agent_steps_sampled": 8000, "num_agent_steps_trained": 8000}, "done": false, "training_iteration": 2, "trial_id": "1a22e_00017", "date": "2024-08-04_07-02-38", "timestamp": 1722735158, "time_this_iter_s": 13.14316177368164, "time_total_s": 26.051006317138672, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370726170>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 26.051006317138672, "iterations_since_restore": 2, "perf": {"cpu_util_percent": 18.22105263157895, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.0318615091964602, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.794510604937871, "policy_loss": -0.005520975678033817, "vf_loss": 9.812554958462716, "vf_explained_var": 0.05514694278438886, "kl": 0.01007181596147196, "entropy": 1.4537756762156884, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 2400.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "env_runners": {"episode_reward_max": -19.655790626485476, "episode_reward_min": -1388.6643623435518, "episode_reward_mean": -732.907508341356, "episode_len_mean": 125.73493975903614, "episode_media": {}, "episodes_timesteps_total": 10436, "policy_reward_min": {"policy_0": -1388.6643623435518}, "policy_reward_max": {"policy_0": -19.655790626485476}, "policy_reward_mean": {"policy_0": -732.907508341356}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1191.9177416353086, -705.4359380741182, -1032.3510965521443, -627.538097583657, -1084.7323877755634, -1295.0541242991542, -1183.2405742797375, -787.7504412675196, -1323.6645404922426, -96.01603340821775, -956.9546500443333, -156.90574800673994, -798.6846328682497, -872.6949911611829, -1324.560535157865, -337.9986408213993, -456.1901856870076, -727.3347818136032, -1198.6112133167478, -736.9782873843906, -1048.7512000541954, -667.284254143282, -1365.9838100690151, -950.601304506503, -793.5753645027323, -233.42771564624434, -790.4564801720364, -810.1797296002582, -1006.2195012159066, -948.9612802441005, -996.5594470340791, -826.322191514363, -1210.7397325965148, -1128.3137200950084, -878.8158528459862, -144.2703339643119, -535.267129125758, -66.90245895898249, -285.10809790524274, -205.9646999633909, -1202.7717424525588, -181.02681429842116, -467.3460199829509, -91.99332858879285, -544.110903937974, -94.8265814680821, -1224.405201731547, -96.18645146761959, -880.8145436108845, -113.79468040407434, -653.2973532297437, -1198.949528617343, -1015.0934135743946, -961.4833816660323, -562.294173805399, -1035.7401285487488, -1180.453181759079, -710.3578410438655, -558.829147380509, -159.61253908548102, -650.8566711120233, -1241.0976723863755, -592.4729687926401, -217.01622135040787, -1067.148155112002, -1210.8613400238823, -1104.4068379980147, -197.00811962032526, -859.1069737911081, -817.5053896123222, -19.655790626485476, -503.4698946724622, -1388.6643623435518, -60.28774384489504, -292.8477106515668, -348.05510508997116, -822.449714004747, -944.5504426633745, -755.9070956958567, -225.45556979926187, -668.0539517915565, -947.8572022240248, -1174.882356685099], "episode_lengths": [150, 134, 150, 150, 150, 150, 150, 150, 150, 69, 150, 57, 150, 150, 150, 84, 104, 150, 150, 145, 150, 130, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 113, 58, 89, 73, 150, 73, 105, 59, 150, 50, 150, 44, 150, 69, 135, 150, 150, 150, 115, 150, 150, 150, 150, 82, 150, 150, 150, 71, 150, 150, 150, 76, 150, 150, 40, 106, 150, 45, 78, 86, 149, 150, 136, 69, 130, 150, 150], "policy_policy_0_reward": [-1191.9177416353086, -705.4359380741182, -1032.3510965521443, -627.538097583657, -1084.7323877755634, -1295.0541242991542, -1183.2405742797375, -787.7504412675196, -1323.6645404922426, -96.01603340821775, -956.9546500443333, -156.90574800673994, -798.6846328682497, -872.6949911611829, -1324.560535157865, -337.9986408213993, -456.1901856870076, -727.3347818136032, -1198.6112133167478, -736.9782873843906, -1048.7512000541954, -667.284254143282, -1365.9838100690151, -950.601304506503, -793.5753645027323, -233.42771564624434, -790.4564801720364, -810.1797296002582, -1006.2195012159066, -948.9612802441005, -996.5594470340791, -826.322191514363, -1210.7397325965148, -1128.3137200950084, -878.8158528459862, -144.2703339643119, -535.267129125758, -66.90245895898249, -285.10809790524274, -205.9646999633909, -1202.7717424525588, -181.02681429842116, -467.3460199829509, -91.99332858879285, -544.110903937974, -94.8265814680821, -1224.405201731547, -96.18645146761959, -880.8145436108845, -113.79468040407434, -653.2973532297437, -1198.949528617343, -1015.0934135743946, -961.4833816660323, -562.294173805399, -1035.7401285487488, -1180.453181759079, -710.3578410438655, -558.829147380509, -159.61253908548102, -650.8566711120233, -1241.0976723863755, -592.4729687926401, -217.01622135040787, -1067.148155112002, -1210.8613400238823, -1104.4068379980147, -197.00811962032526, -859.1069737911081, -817.5053896123222, -19.655790626485476, -503.4698946724622, -1388.6643623435518, -60.28774384489504, -292.8477106515668, -348.05510508997116, -822.449714004747, -944.5504426633745, -755.9070956958567, -225.45556979926187, -668.0539517915565, -947.8572022240248, -1174.882356685099]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5714418958721661, "mean_inference_ms": 1.678285231359506, "mean_action_processing_ms": 0.27593050186618545, "mean_env_wait_ms": 3.393860411118312, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013287670641060335, "StateBufferConnector_ms": 0.00866809523249247, "ViewRequirementAgentConnector_ms": 0.1857691500560347}, "num_episodes": 31, "episode_return_max": -19.655790626485476, "episode_return_min": -1388.6643623435518, "episode_return_mean": -732.907508341356, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000, "num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 382.60617241603506, "num_env_steps_trained_throughput_per_sec": 382.60617241603506, "timesteps_total": 12000, "num_env_steps_sampled_lifetime": 12000, "num_agent_steps_sampled_lifetime": 12000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 12000, "timers": {"training_iteration_time_ms": 12160.817, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12160.746, "sample_time_ms": 1154.95, "learn_time_ms": 10932.2, "learn_throughput": 365.892, "synch_weights_time_ms": 72.742}, "counters": {"num_env_steps_sampled": 12000, "num_env_steps_trained": 12000, "num_agent_steps_sampled": 12000, "num_agent_steps_trained": 12000}, "done": false, "training_iteration": 3, "trial_id": "1a22e_00017", "date": "2024-08-04_07-02-48", "timestamp": 1722735168, "time_this_iter_s": 10.466544389724731, "time_total_s": 36.5175507068634, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370727ac0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 36.5175507068634, "iterations_since_restore": 3, "perf": {"cpu_util_percent": 20.233333333333334, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 1.5501995110263427, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.663969930013021, "policy_loss": -0.011611326785835747, "vf_loss": 9.687383199731508, "vf_explained_var": 0.08921964882562558, "kl": 0.014548979383471305, "entropy": 1.4711752973496914, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 3360.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "env_runners": {"episode_reward_max": -19.655790626485476, "episode_reward_min": -1388.6643623435518, "episode_reward_mean": -742.0971262698882, "episode_len_mean": 126.44, "episode_media": {}, "episodes_timesteps_total": 12644, "policy_reward_min": {"policy_0": -1388.6643623435518}, "policy_reward_max": {"policy_0": -19.655790626485476}, "policy_reward_mean": {"policy_0": -742.0971262698882}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-798.6846328682497, -872.6949911611829, -1324.560535157865, -337.9986408213993, -456.1901856870076, -727.3347818136032, -1198.6112133167478, -736.9782873843906, -1048.7512000541954, -667.284254143282, -1365.9838100690151, -950.601304506503, -793.5753645027323, -233.42771564624434, -790.4564801720364, -810.1797296002582, -1006.2195012159066, -948.9612802441005, -996.5594470340791, -826.322191514363, -1210.7397325965148, -1128.3137200950084, -878.8158528459862, -144.2703339643119, -535.267129125758, -66.90245895898249, -285.10809790524274, -205.9646999633909, -1202.7717424525588, -181.02681429842116, -467.3460199829509, -91.99332858879285, -544.110903937974, -94.8265814680821, -1224.405201731547, -96.18645146761959, -880.8145436108845, -113.79468040407434, -653.2973532297437, -1198.949528617343, -1015.0934135743946, -961.4833816660323, -562.294173805399, -1035.7401285487488, -1180.453181759079, -710.3578410438655, -558.829147380509, -159.61253908548102, -650.8566711120233, -1241.0976723863755, -592.4729687926401, -217.01622135040787, -1067.148155112002, -1210.8613400238823, -1104.4068379980147, -197.00811962032526, -859.1069737911081, -817.5053896123222, -19.655790626485476, -503.4698946724622, -1388.6643623435518, -60.28774384489504, -292.8477106515668, -348.05510508997116, -822.449714004747, -944.5504426633745, -755.9070956958567, -225.45556979926187, -668.0539517915565, -947.8572022240248, -1174.882356685099, -525.683948792901, -1336.3390144315888, -1020.7721551487367, -407.8974327235502, -1255.510734387388, -67.14114165604684, -1065.4032465794285, -1337.839375555095, -895.1166441585087, -1139.9783536338352, -1064.7681046123241, -561.0750948659804, -244.42730643252514, -200.27029272062677, -1020.2905475487507, -229.89685415290904, -730.340281398642, -1172.1229466127534, -1168.3852713888807, -1169.3166798287768, -920.9709847431618, -972.9951288684323, -1147.9090137642622, -600.4008006055576, -24.00199116837028, -954.5057733426582, -612.7152198199769, -1007.2353835650603, -966.6410855683016], "episode_lengths": [150, 150, 150, 84, 104, 150, 150, 145, 150, 130, 150, 150, 150, 100, 150, 150, 150, 150, 150, 150, 150, 150, 150, 62, 113, 58, 89, 73, 150, 73, 105, 59, 150, 50, 150, 44, 150, 69, 135, 150, 150, 150, 115, 150, 150, 150, 150, 82, 150, 150, 150, 71, 150, 150, 150, 76, 150, 150, 40, 106, 150, 45, 78, 86, 149, 150, 136, 69, 130, 150, 150, 112, 150, 150, 121, 150, 44, 150, 150, 150, 150, 150, 123, 74, 91, 150, 71, 150, 150, 150, 150, 150, 150, 150, 144, 38, 150, 150, 150, 150], "policy_policy_0_reward": [-798.6846328682497, -872.6949911611829, -1324.560535157865, -337.9986408213993, -456.1901856870076, -727.3347818136032, -1198.6112133167478, -736.9782873843906, -1048.7512000541954, -667.284254143282, -1365.9838100690151, -950.601304506503, -793.5753645027323, -233.42771564624434, -790.4564801720364, -810.1797296002582, -1006.2195012159066, -948.9612802441005, -996.5594470340791, -826.322191514363, -1210.7397325965148, -1128.3137200950084, -878.8158528459862, -144.2703339643119, -535.267129125758, -66.90245895898249, -285.10809790524274, -205.9646999633909, -1202.7717424525588, -181.02681429842116, -467.3460199829509, -91.99332858879285, -544.110903937974, -94.8265814680821, -1224.405201731547, -96.18645146761959, -880.8145436108845, -113.79468040407434, -653.2973532297437, -1198.949528617343, -1015.0934135743946, -961.4833816660323, -562.294173805399, -1035.7401285487488, -1180.453181759079, -710.3578410438655, -558.829147380509, -159.61253908548102, -650.8566711120233, -1241.0976723863755, -592.4729687926401, -217.01622135040787, -1067.148155112002, -1210.8613400238823, -1104.4068379980147, -197.00811962032526, -859.1069737911081, -817.5053896123222, -19.655790626485476, -503.4698946724622, -1388.6643623435518, -60.28774384489504, -292.8477106515668, -348.05510508997116, -822.449714004747, -944.5504426633745, -755.9070956958567, -225.45556979926187, -668.0539517915565, -947.8572022240248, -1174.882356685099, -525.683948792901, -1336.3390144315888, -1020.7721551487367, -407.8974327235502, -1255.510734387388, -67.14114165604684, -1065.4032465794285, -1337.839375555095, -895.1166441585087, -1139.9783536338352, -1064.7681046123241, -561.0750948659804, -244.42730643252514, -200.27029272062677, -1020.2905475487507, -229.89685415290904, -730.340281398642, -1172.1229466127534, -1168.3852713888807, -1169.3166798287768, -920.9709847431618, -972.9951288684323, -1147.9090137642622, -600.4008006055576, -24.00199116837028, -954.5057733426582, -612.7152198199769, -1007.2353835650603, -966.6410855683016]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5690564532164849, "mean_inference_ms": 1.6805396208827217, "mean_action_processing_ms": 0.2758140761419059, "mean_env_wait_ms": 3.401476012407139, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013754129409790039, "StateBufferConnector_ms": 0.008777379989624023, "ViewRequirementAgentConnector_ms": 0.18946051597595215}, "num_episodes": 29, "episode_return_max": -19.655790626485476, "episode_return_min": -1388.6643623435518, "episode_return_mean": -742.0971262698882, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000, "num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 313.73220162557453, "num_env_steps_trained_throughput_per_sec": 313.73220162557453, "timesteps_total": 16000, "num_env_steps_sampled_lifetime": 16000, "num_agent_steps_sampled_lifetime": 16000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 16000, "timers": {"training_iteration_time_ms": 12308.047, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12307.978, "sample_time_ms": 1147.264, "learn_time_ms": 11090.916, "learn_throughput": 360.656, "synch_weights_time_ms": 68.948}, "counters": {"num_env_steps_sampled": 16000, "num_env_steps_trained": 16000, "num_agent_steps_sampled": 16000, "num_agent_steps_trained": 16000}, "done": false, "training_iteration": 4, "trial_id": "1a22e_00017", "date": "2024-08-04_07-03-01", "timestamp": 1722735181, "time_this_iter_s": 12.76166296005249, "time_total_s": 49.279213666915894, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370727a30>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 49.279213666915894, "iterations_since_restore": 4, "perf": {"cpu_util_percent": 18.788888888888888, "ram_util_percent": 28.0}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 3.1280398569380243, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.488475239276886, "policy_loss": -0.006830938659065092, "vf_loss": 9.508313070734342, "vf_explained_var": 0.14970994076381128, "kl": 0.010559674915324042, "entropy": 1.5118831855555375, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 4320.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "env_runners": {"episode_reward_max": -19.655790626485476, "episode_reward_min": -1474.2039527409843, "episode_reward_mean": -746.3296971232307, "episode_len_mean": 125.7, "episode_media": {}, "episodes_timesteps_total": 12570, "policy_reward_min": {"policy_0": -1474.2039527409843}, "policy_reward_max": {"policy_0": -19.655790626485476}, "policy_reward_mean": {"policy_0": -746.3296971232307}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1224.405201731547, -96.18645146761959, -880.8145436108845, -113.79468040407434, -653.2973532297437, -1198.949528617343, -1015.0934135743946, -961.4833816660323, -562.294173805399, -1035.7401285487488, -1180.453181759079, -710.3578410438655, -558.829147380509, -159.61253908548102, -650.8566711120233, -1241.0976723863755, -592.4729687926401, -217.01622135040787, -1067.148155112002, -1210.8613400238823, -1104.4068379980147, -197.00811962032526, -859.1069737911081, -817.5053896123222, -19.655790626485476, -503.4698946724622, -1388.6643623435518, -60.28774384489504, -292.8477106515668, -348.05510508997116, -822.449714004747, -944.5504426633745, -755.9070956958567, -225.45556979926187, -668.0539517915565, -947.8572022240248, -1174.882356685099, -525.683948792901, -1336.3390144315888, -1020.7721551487367, -407.8974327235502, -1255.510734387388, -67.14114165604684, -1065.4032465794285, -1337.839375555095, -895.1166441585087, -1139.9783536338352, -1064.7681046123241, -561.0750948659804, -244.42730643252514, -200.27029272062677, -1020.2905475487507, -229.89685415290904, -730.340281398642, -1172.1229466127534, -1168.3852713888807, -1169.3166798287768, -920.9709847431618, -972.9951288684323, -1147.9090137642622, -600.4008006055576, -24.00199116837028, -954.5057733426582, -612.7152198199769, -1007.2353835650603, -966.6410855683016, -1109.5725120945308, -1029.5625962410513, -1326.3626687587807, -635.0501605174577, -936.2195619211727, -215.93646815377843, -1109.9125899184044, -163.022762728125, -1474.2039527409843, -343.86264043384614, -261.541237852338, -512.9616241360042, -982.8381591861704, -127.25143714972687, -1182.6124902425022, -23.79979471707774, -851.6976068830669, -608.2352278034417, -1069.0125767189281, -926.4099846112612, -1085.8096958233316, -1072.5210550994443, -1188.8468748383873, -348.38274372730524, -121.30802014020416, -794.6936025940406, -389.91205256053286, -612.5404369371252, -122.56045388004098, -351.35183256248894, -977.5415743239439, -61.573151638069845, -1249.0796516939931, -1085.9028498037999], "episode_lengths": [150, 44, 150, 69, 135, 150, 150, 150, 115, 150, 150, 150, 150, 82, 150, 150, 150, 71, 150, 150, 150, 76, 150, 150, 40, 106, 150, 45, 78, 86, 149, 150, 136, 69, 130, 150, 150, 112, 150, 150, 121, 150, 44, 150, 150, 150, 150, 150, 123, 74, 91, 150, 71, 150, 150, 150, 150, 150, 150, 150, 144, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 55, 150, 86, 95, 150, 150, 52, 150, 35, 150, 150, 150, 150, 150, 150, 150, 104, 55, 150, 104, 133, 60, 120, 150, 51, 150, 150], "policy_policy_0_reward": [-1224.405201731547, -96.18645146761959, -880.8145436108845, -113.79468040407434, -653.2973532297437, -1198.949528617343, -1015.0934135743946, -961.4833816660323, -562.294173805399, -1035.7401285487488, -1180.453181759079, -710.3578410438655, -558.829147380509, -159.61253908548102, -650.8566711120233, -1241.0976723863755, -592.4729687926401, -217.01622135040787, -1067.148155112002, -1210.8613400238823, -1104.4068379980147, -197.00811962032526, -859.1069737911081, -817.5053896123222, -19.655790626485476, -503.4698946724622, -1388.6643623435518, -60.28774384489504, -292.8477106515668, -348.05510508997116, -822.449714004747, -944.5504426633745, -755.9070956958567, -225.45556979926187, -668.0539517915565, -947.8572022240248, -1174.882356685099, -525.683948792901, -1336.3390144315888, -1020.7721551487367, -407.8974327235502, -1255.510734387388, -67.14114165604684, -1065.4032465794285, -1337.839375555095, -895.1166441585087, -1139.9783536338352, -1064.7681046123241, -561.0750948659804, -244.42730643252514, -200.27029272062677, -1020.2905475487507, -229.89685415290904, -730.340281398642, -1172.1229466127534, -1168.3852713888807, -1169.3166798287768, -920.9709847431618, -972.9951288684323, -1147.9090137642622, -600.4008006055576, -24.00199116837028, -954.5057733426582, -612.7152198199769, -1007.2353835650603, -966.6410855683016, -1109.5725120945308, -1029.5625962410513, -1326.3626687587807, -635.0501605174577, -936.2195619211727, -215.93646815377843, -1109.9125899184044, -163.022762728125, -1474.2039527409843, -343.86264043384614, -261.541237852338, -512.9616241360042, -982.8381591861704, -127.25143714972687, -1182.6124902425022, -23.79979471707774, -851.6976068830669, -608.2352278034417, -1069.0125767189281, -926.4099846112612, -1085.8096958233316, -1072.5210550994443, -1188.8468748383873, -348.38274372730524, -121.30802014020416, -794.6936025940406, -389.91205256053286, -612.5404369371252, -122.56045388004098, -351.35183256248894, -977.5415743239439, -61.573151638069845, -1249.0796516939931, -1085.9028498037999]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5677485114199274, "mean_inference_ms": 1.6909385829217232, "mean_action_processing_ms": 0.27741848043272266, "mean_env_wait_ms": 3.432384439587155, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012972831726074219, "StateBufferConnector_ms": 0.00884389877319336, "ViewRequirementAgentConnector_ms": 0.1976759433746338}, "num_episodes": 34, "episode_return_max": -19.655790626485476, "episode_return_min": -1474.2039527409843, "episode_return_mean": -746.3296971232307, "episodes_this_iter": 34}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000, "num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 436.02808143746813, "num_env_steps_trained_throughput_per_sec": 436.02808143746813, "timesteps_total": 20000, "num_env_steps_sampled_lifetime": 20000, "num_agent_steps_sampled_lifetime": 20000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 20000, "timers": {"training_iteration_time_ms": 11681.184, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11681.116, "sample_time_ms": 1142.245, "learn_time_ms": 10471.987, "learn_throughput": 381.971, "synch_weights_time_ms": 66.044}, "counters": {"num_env_steps_sampled": 20000, "num_env_steps_trained": 20000, "num_agent_steps_sampled": 20000, "num_agent_steps_trained": 20000}, "done": false, "training_iteration": 5, "trial_id": "1a22e_00017", "date": "2024-08-04_07-03-10", "timestamp": 1722735190, "time_this_iter_s": 9.187788963317871, "time_total_s": 58.467002630233765, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237077dab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 58.467002630233765, "iterations_since_restore": 5, "perf": {"cpu_util_percent": 21.276923076923076, "ram_util_percent": 28.00769230769231}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.058105770498514, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.39291147987048, "policy_loss": -0.011108782487281133, "vf_loss": 9.415074025591215, "vf_explained_var": 0.18070226560036343, "kl": 0.014669114544979796, "entropy": 1.3987560406327249, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 5280.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "env_runners": {"episode_reward_max": -23.79979471707774, "episode_reward_min": -1474.2039527409843, "episode_reward_mean": -747.9441175541388, "episode_len_mean": 124.98, "episode_media": {}, "episodes_timesteps_total": 12498, "policy_reward_min": {"policy_0": -1474.2039527409843}, "policy_reward_max": {"policy_0": -23.79979471707774}, "policy_reward_mean": {"policy_0": -747.9441175541388}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-944.5504426633745, -755.9070956958567, -225.45556979926187, -668.0539517915565, -947.8572022240248, -1174.882356685099, -525.683948792901, -1336.3390144315888, -1020.7721551487367, -407.8974327235502, -1255.510734387388, -67.14114165604684, -1065.4032465794285, -1337.839375555095, -895.1166441585087, -1139.9783536338352, -1064.7681046123241, -561.0750948659804, -244.42730643252514, -200.27029272062677, -1020.2905475487507, -229.89685415290904, -730.340281398642, -1172.1229466127534, -1168.3852713888807, -1169.3166798287768, -920.9709847431618, -972.9951288684323, -1147.9090137642622, -600.4008006055576, -24.00199116837028, -954.5057733426582, -612.7152198199769, -1007.2353835650603, -966.6410855683016, -1109.5725120945308, -1029.5625962410513, -1326.3626687587807, -635.0501605174577, -936.2195619211727, -215.93646815377843, -1109.9125899184044, -163.022762728125, -1474.2039527409843, -343.86264043384614, -261.541237852338, -512.9616241360042, -982.8381591861704, -127.25143714972687, -1182.6124902425022, -23.79979471707774, -851.6976068830669, -608.2352278034417, -1069.0125767189281, -926.4099846112612, -1085.8096958233316, -1072.5210550994443, -1188.8468748383873, -348.38274372730524, -121.30802014020416, -794.6936025940406, -389.91205256053286, -612.5404369371252, -122.56045388004098, -351.35183256248894, -977.5415743239439, -61.573151638069845, -1249.0796516939931, -1085.9028498037999, -128.750926651894, -424.30741209205354, -637.7232357456401, -140.0926578583835, -685.684216525658, -1022.5944754940841, -287.0572680740918, -185.42715816566513, -1324.197270371985, -254.4553804788021, -343.73501942966436, -934.7446171371944, -1320.6650567661823, -579.5607520155147, -84.2610104488699, -1011.9026294167195, -290.34971813464483, -111.02667397104659, -1204.8605955885887, -1329.801355187598, -1106.4496707672488, -1069.2965072710922, -108.74090763415771, -1171.7991903659904, -1143.5458937486849, -931.0122370675015, -517.9990598333432, -787.6446344647026, -340.4020342779644, -1202.7173350794624, -1224.859379983898], "episode_lengths": [150, 136, 69, 130, 150, 150, 112, 150, 150, 121, 150, 44, 150, 150, 150, 150, 150, 123, 74, 91, 150, 71, 150, 150, 150, 150, 150, 150, 150, 144, 38, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 55, 150, 86, 95, 150, 150, 52, 150, 35, 150, 150, 150, 150, 150, 150, 150, 104, 55, 150, 104, 133, 60, 120, 150, 51, 150, 150, 65, 98, 150, 52, 150, 150, 74, 61, 150, 85, 94, 150, 150, 150, 66, 150, 76, 71, 150, 150, 150, 150, 69, 150, 150, 150, 105, 150, 108, 150, 150], "policy_policy_0_reward": [-944.5504426633745, -755.9070956958567, -225.45556979926187, -668.0539517915565, -947.8572022240248, -1174.882356685099, -525.683948792901, -1336.3390144315888, -1020.7721551487367, -407.8974327235502, -1255.510734387388, -67.14114165604684, -1065.4032465794285, -1337.839375555095, -895.1166441585087, -1139.9783536338352, -1064.7681046123241, -561.0750948659804, -244.42730643252514, -200.27029272062677, -1020.2905475487507, -229.89685415290904, -730.340281398642, -1172.1229466127534, -1168.3852713888807, -1169.3166798287768, -920.9709847431618, -972.9951288684323, -1147.9090137642622, -600.4008006055576, -24.00199116837028, -954.5057733426582, -612.7152198199769, -1007.2353835650603, -966.6410855683016, -1109.5725120945308, -1029.5625962410513, -1326.3626687587807, -635.0501605174577, -936.2195619211727, -215.93646815377843, -1109.9125899184044, -163.022762728125, -1474.2039527409843, -343.86264043384614, -261.541237852338, -512.9616241360042, -982.8381591861704, -127.25143714972687, -1182.6124902425022, -23.79979471707774, -851.6976068830669, -608.2352278034417, -1069.0125767189281, -926.4099846112612, -1085.8096958233316, -1072.5210550994443, -1188.8468748383873, -348.38274372730524, -121.30802014020416, -794.6936025940406, -389.91205256053286, -612.5404369371252, -122.56045388004098, -351.35183256248894, -977.5415743239439, -61.573151638069845, -1249.0796516939931, -1085.9028498037999, -128.750926651894, -424.30741209205354, -637.7232357456401, -140.0926578583835, -685.684216525658, -1022.5944754940841, -287.0572680740918, -185.42715816566513, -1324.197270371985, -254.4553804788021, -343.73501942966436, -934.7446171371944, -1320.6650567661823, -579.5607520155147, -84.2610104488699, -1011.9026294167195, -290.34971813464483, -111.02667397104659, -1204.8605955885887, -1329.801355187598, -1106.4496707672488, -1069.2965072710922, -108.74090763415771, -1171.7991903659904, -1143.5458937486849, -931.0122370675015, -517.9990598333432, -787.6446344647026, -340.4020342779644, -1202.7173350794624, -1224.859379983898]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5653171862641694, "mean_inference_ms": 1.6855853383458776, "mean_action_processing_ms": 0.2783778116789668, "mean_env_wait_ms": 3.4380949389212443, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.013269662857055664, "StateBufferConnector_ms": 0.008678913116455078, "ViewRequirementAgentConnector_ms": 0.196122407913208}, "num_episodes": 31, "episode_return_max": -23.79979471707774, "episode_return_min": -1474.2039527409843, "episode_return_mean": -747.9441175541388, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000, "num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.78424173036694, "num_env_steps_trained_throughput_per_sec": 305.78424173036694, "timesteps_total": 24000, "num_env_steps_sampled_lifetime": 24000, "num_agent_steps_sampled_lifetime": 24000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 24000, "timers": {"training_iteration_time_ms": 11914.508, "restore_workers_time_ms": 0.026, "training_step_time_ms": 11914.441, "sample_time_ms": 1138.08, "learn_time_ms": 10710.183, "learn_throughput": 373.476, "synch_weights_time_ms": 65.338}, "counters": {"num_env_steps_sampled": 24000, "num_env_steps_trained": 24000, "num_agent_steps_sampled": 24000, "num_agent_steps_trained": 24000}, "done": false, "training_iteration": 6, "trial_id": "1a22e_00017", "date": "2024-08-04_07-03-23", "timestamp": 1722735203, "time_this_iter_s": 13.092878341674805, "time_total_s": 71.55988097190857, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237077eef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 71.55988097190857, "iterations_since_restore": 6, "perf": {"cpu_util_percent": 18.866666666666667, "ram_util_percent": 28.044444444444444}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.070738042891025, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.251365793744723, "policy_loss": -0.010357037811869911, "vf_loss": 9.275156781077385, "vf_explained_var": 0.22088261997948092, "kl": 0.013480724171677144, "entropy": 1.6130119189620018, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 6240.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "env_runners": {"episode_reward_max": -4.813337932834998, "episode_reward_min": -1474.2039527409843, "episode_reward_mean": -699.9546568485187, "episode_len_mean": 122.86, "episode_media": {}, "episodes_timesteps_total": 12286, "policy_reward_min": {"policy_0": -1474.2039527409843}, "policy_reward_max": {"policy_0": -4.813337932834998}, "policy_reward_mean": {"policy_0": -699.9546568485187}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1007.2353835650603, -966.6410855683016, -1109.5725120945308, -1029.5625962410513, -1326.3626687587807, -635.0501605174577, -936.2195619211727, -215.93646815377843, -1109.9125899184044, -163.022762728125, -1474.2039527409843, -343.86264043384614, -261.541237852338, -512.9616241360042, -982.8381591861704, -127.25143714972687, -1182.6124902425022, -23.79979471707774, -851.6976068830669, -608.2352278034417, -1069.0125767189281, -926.4099846112612, -1085.8096958233316, -1072.5210550994443, -1188.8468748383873, -348.38274372730524, -121.30802014020416, -794.6936025940406, -389.91205256053286, -612.5404369371252, -122.56045388004098, -351.35183256248894, -977.5415743239439, -61.573151638069845, -1249.0796516939931, -1085.9028498037999, -128.750926651894, -424.30741209205354, -637.7232357456401, -140.0926578583835, -685.684216525658, -1022.5944754940841, -287.0572680740918, -185.42715816566513, -1324.197270371985, -254.4553804788021, -343.73501942966436, -934.7446171371944, -1320.6650567661823, -579.5607520155147, -84.2610104488699, -1011.9026294167195, -290.34971813464483, -111.02667397104659, -1204.8605955885887, -1329.801355187598, -1106.4496707672488, -1069.2965072710922, -108.74090763415771, -1171.7991903659904, -1143.5458937486849, -931.0122370675015, -517.9990598333432, -787.6446344647026, -340.4020342779644, -1202.7173350794624, -1224.859379983898, -1034.8110925248143, -620.2148262531127, -1179.76479001959, -340.6376997164323, -242.78410621181442, -28.950998738903333, -993.7858898994245, -372.5670891050165, -1186.9780426900452, -892.156363266425, -18.4753858801608, -880.2129801110374, -29.797337691038532, -1083.1021918421275, -350.8344587193497, -4.813337932834998, -109.1493989921838, -395.7470370433056, -769.8376791191045, -1261.9774378158666, -656.8429133533425, -1230.3436253849557, -912.415900119643, -688.8853019539239, -229.65932936637162, -986.8588262144946, -88.14214534455087, -997.476205694574, -391.4224046588865, -737.693301546856, -747.5895544450323, -924.740350414549, -1375.1668851690579], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 71, 150, 55, 150, 86, 95, 150, 150, 52, 150, 35, 150, 150, 150, 150, 150, 150, 150, 104, 55, 150, 104, 133, 60, 120, 150, 51, 150, 150, 65, 98, 150, 52, 150, 150, 74, 61, 150, 85, 94, 150, 150, 150, 66, 150, 76, 71, 150, 150, 150, 150, 69, 150, 150, 150, 105, 150, 108, 150, 150, 150, 150, 150, 149, 90, 52, 150, 110, 150, 150, 42, 150, 37, 150, 87, 31, 62, 140, 150, 150, 150, 150, 150, 150, 115, 150, 57, 150, 119, 150, 150, 150, 150], "policy_policy_0_reward": [-1007.2353835650603, -966.6410855683016, -1109.5725120945308, -1029.5625962410513, -1326.3626687587807, -635.0501605174577, -936.2195619211727, -215.93646815377843, -1109.9125899184044, -163.022762728125, -1474.2039527409843, -343.86264043384614, -261.541237852338, -512.9616241360042, -982.8381591861704, -127.25143714972687, -1182.6124902425022, -23.79979471707774, -851.6976068830669, -608.2352278034417, -1069.0125767189281, -926.4099846112612, -1085.8096958233316, -1072.5210550994443, -1188.8468748383873, -348.38274372730524, -121.30802014020416, -794.6936025940406, -389.91205256053286, -612.5404369371252, -122.56045388004098, -351.35183256248894, -977.5415743239439, -61.573151638069845, -1249.0796516939931, -1085.9028498037999, -128.750926651894, -424.30741209205354, -637.7232357456401, -140.0926578583835, -685.684216525658, -1022.5944754940841, -287.0572680740918, -185.42715816566513, -1324.197270371985, -254.4553804788021, -343.73501942966436, -934.7446171371944, -1320.6650567661823, -579.5607520155147, -84.2610104488699, -1011.9026294167195, -290.34971813464483, -111.02667397104659, -1204.8605955885887, -1329.801355187598, -1106.4496707672488, -1069.2965072710922, -108.74090763415771, -1171.7991903659904, -1143.5458937486849, -931.0122370675015, -517.9990598333432, -787.6446344647026, -340.4020342779644, -1202.7173350794624, -1224.859379983898, -1034.8110925248143, -620.2148262531127, -1179.76479001959, -340.6376997164323, -242.78410621181442, -28.950998738903333, -993.7858898994245, -372.5670891050165, -1186.9780426900452, -892.156363266425, -18.4753858801608, -880.2129801110374, -29.797337691038532, -1083.1021918421275, -350.8344587193497, -4.813337932834998, -109.1493989921838, -395.7470370433056, -769.8376791191045, -1261.9774378158666, -656.8429133533425, -1230.3436253849557, -912.415900119643, -688.8853019539239, -229.65932936637162, -986.8588262144946, -88.14214534455087, -997.476205694574, -391.4224046588865, -737.693301546856, -747.5895544450323, -924.740350414549, -1375.1668851690579]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5639343585587645, "mean_inference_ms": 1.6836326336852145, "mean_action_processing_ms": 0.27865628213487914, "mean_env_wait_ms": 3.443722026203302, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012792587280273438, "StateBufferConnector_ms": 0.008411169052124023, "ViewRequirementAgentConnector_ms": 0.19557428359985352}, "num_episodes": 33, "episode_return_max": -4.813337932834998, "episode_return_min": -1474.2039527409843, "episode_return_mean": -699.9546568485187, "episodes_this_iter": 33}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000, "num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 330.0914924238416, "num_env_steps_trained_throughput_per_sec": 330.0914924238416, "timesteps_total": 28000, "num_env_steps_sampled_lifetime": 28000, "num_agent_steps_sampled_lifetime": 28000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 28000, "timers": {"training_iteration_time_ms": 11943.559, "restore_workers_time_ms": 0.027, "training_step_time_ms": 11943.491, "sample_time_ms": 1132.404, "learn_time_ms": 10744.329, "learn_throughput": 372.289, "synch_weights_time_ms": 65.855}, "counters": {"num_env_steps_sampled": 28000, "num_env_steps_trained": 28000, "num_agent_steps_sampled": 28000, "num_agent_steps_trained": 28000}, "done": false, "training_iteration": 7, "trial_id": "1a22e_00017", "date": "2024-08-04_07-03-36", "timestamp": 1722735216, "time_this_iter_s": 12.131268978118896, "time_total_s": 83.69114995002747, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370727400>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 83.69114995002747, "iterations_since_restore": 7, "perf": {"cpu_util_percent": 18.744444444444444, "ram_util_percent": 28.06666666666667}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 4.466434732886652, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.297845330834388, "policy_loss": -0.013619297920376994, "vf_loss": 9.323393362760545, "vf_explained_var": 0.2973959021270275, "kl": 0.016907596259663184, "entropy": 1.5310271188616753, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 7200.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "env_runners": {"episode_reward_max": 2.6695680787507534, "episode_reward_min": -1428.8854020890833, "episode_reward_mean": -719.0160713247726, "episode_len_mean": 125.37, "episode_media": {}, "episodes_timesteps_total": 12537, "policy_reward_min": {"policy_0": -1428.8854020890833}, "policy_reward_max": {"policy_0": 2.6695680787507534}, "policy_reward_mean": {"policy_0": -719.0160713247726}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1085.9028498037999, -128.750926651894, -424.30741209205354, -637.7232357456401, -140.0926578583835, -685.684216525658, -1022.5944754940841, -287.0572680740918, -185.42715816566513, -1324.197270371985, -254.4553804788021, -343.73501942966436, -934.7446171371944, -1320.6650567661823, -579.5607520155147, -84.2610104488699, -1011.9026294167195, -290.34971813464483, -111.02667397104659, -1204.8605955885887, -1329.801355187598, -1106.4496707672488, -1069.2965072710922, -108.74090763415771, -1171.7991903659904, -1143.5458937486849, -931.0122370675015, -517.9990598333432, -787.6446344647026, -340.4020342779644, -1202.7173350794624, -1224.859379983898, -1034.8110925248143, -620.2148262531127, -1179.76479001959, -340.6376997164323, -242.78410621181442, -28.950998738903333, -993.7858898994245, -372.5670891050165, -1186.9780426900452, -892.156363266425, -18.4753858801608, -880.2129801110374, -29.797337691038532, -1083.1021918421275, -350.8344587193497, -4.813337932834998, -109.1493989921838, -395.7470370433056, -769.8376791191045, -1261.9774378158666, -656.8429133533425, -1230.3436253849557, -912.415900119643, -688.8853019539239, -229.65932936637162, -986.8588262144946, -88.14214534455087, -997.476205694574, -391.4224046588865, -737.693301546856, -747.5895544450323, -924.740350414549, -1375.1668851690579, -910.9017504774716, -1428.8854020890833, -1072.34380750202, -1115.9712745792415, -64.94948148833736, -1296.540093398034, -56.98686357839751, -1226.5568140197404, -1115.674976328714, -692.3063654447966, -1049.5654370173788, -562.0762993145815, -432.37203322226253, -138.16620506807254, -90.56476362191266, -485.2113408017989, -266.6590846291911, -561.4719420206703, -1070.1618446323007, -1035.6791359156493, -550.5686342215462, -1079.992602187095, -1330.359000112199, -1275.5126864091053, -1293.50786405284, -53.73747045513897, -986.9616506778616, -318.2015178703516, 2.6695680787507534, -1164.8034224229707, -1030.811248999606, -478.472058960667, -886.9982320552401, -1269.726611627757, -756.1767682630145], "episode_lengths": [150, 65, 98, 150, 52, 150, 150, 74, 61, 150, 85, 94, 150, 150, 150, 66, 150, 76, 71, 150, 150, 150, 150, 69, 150, 150, 150, 105, 150, 108, 150, 150, 150, 150, 150, 149, 90, 52, 150, 110, 150, 150, 42, 150, 37, 150, 87, 31, 62, 140, 150, 150, 150, 150, 150, 150, 115, 150, 57, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 61, 150, 150, 150, 150, 150, 102, 77, 57, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 31, 150, 150, 143, 150, 150, 150], "policy_policy_0_reward": [-1085.9028498037999, -128.750926651894, -424.30741209205354, -637.7232357456401, -140.0926578583835, -685.684216525658, -1022.5944754940841, -287.0572680740918, -185.42715816566513, -1324.197270371985, -254.4553804788021, -343.73501942966436, -934.7446171371944, -1320.6650567661823, -579.5607520155147, -84.2610104488699, -1011.9026294167195, -290.34971813464483, -111.02667397104659, -1204.8605955885887, -1329.801355187598, -1106.4496707672488, -1069.2965072710922, -108.74090763415771, -1171.7991903659904, -1143.5458937486849, -931.0122370675015, -517.9990598333432, -787.6446344647026, -340.4020342779644, -1202.7173350794624, -1224.859379983898, -1034.8110925248143, -620.2148262531127, -1179.76479001959, -340.6376997164323, -242.78410621181442, -28.950998738903333, -993.7858898994245, -372.5670891050165, -1186.9780426900452, -892.156363266425, -18.4753858801608, -880.2129801110374, -29.797337691038532, -1083.1021918421275, -350.8344587193497, -4.813337932834998, -109.1493989921838, -395.7470370433056, -769.8376791191045, -1261.9774378158666, -656.8429133533425, -1230.3436253849557, -912.415900119643, -688.8853019539239, -229.65932936637162, -986.8588262144946, -88.14214534455087, -997.476205694574, -391.4224046588865, -737.693301546856, -747.5895544450323, -924.740350414549, -1375.1668851690579, -910.9017504774716, -1428.8854020890833, -1072.34380750202, -1115.9712745792415, -64.94948148833736, -1296.540093398034, -56.98686357839751, -1226.5568140197404, -1115.674976328714, -692.3063654447966, -1049.5654370173788, -562.0762993145815, -432.37203322226253, -138.16620506807254, -90.56476362191266, -485.2113408017989, -266.6590846291911, -561.4719420206703, -1070.1618446323007, -1035.6791359156493, -550.5686342215462, -1079.992602187095, -1330.359000112199, -1275.5126864091053, -1293.50786405284, -53.73747045513897, -986.9616506778616, -318.2015178703516, 2.6695680787507534, -1164.8034224229707, -1030.811248999606, -478.472058960667, -886.9982320552401, -1269.726611627757, -756.1767682630145]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5632434880952123, "mean_inference_ms": 1.6768773132842094, "mean_action_processing_ms": 0.27813041600437083, "mean_env_wait_ms": 3.4431481509485864, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012674331665039062, "StateBufferConnector_ms": 0.008085489273071289, "ViewRequirementAgentConnector_ms": 0.18782305717468262}, "num_episodes": 35, "episode_return_max": 2.6695680787507534, "episode_return_min": -1428.8854020890833, "episode_return_mean": -719.0160713247726, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000, "num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 310.338083619582, "num_env_steps_trained_throughput_per_sec": 310.338083619582, "timesteps_total": 32000, "num_env_steps_sampled_lifetime": 32000, "num_agent_steps_sampled_lifetime": 32000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 32000, "timers": {"training_iteration_time_ms": 12061.762, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12061.694, "sample_time_ms": 1132.005, "learn_time_ms": 10863.019, "learn_throughput": 368.222, "synch_weights_time_ms": 65.779}, "counters": {"num_env_steps_sampled": 32000, "num_env_steps_trained": 32000, "num_agent_steps_sampled": 32000, "num_agent_steps_trained": 32000}, "done": false, "training_iteration": 8, "trial_id": "1a22e_00017", "date": "2024-08-04_07-03-49", "timestamp": 1722735229, "time_this_iter_s": 12.901468276977539, "time_total_s": 96.592618227005, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370726c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 96.592618227005, "iterations_since_restore": 8, "perf": {"cpu_util_percent": 18.633333333333333, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 6.340823448076844, "cur_kl_coeff": 0.20000000000000004, "cur_lr": 0.0010000000000000005, "total_loss": 9.26331405142943, "policy_loss": -0.01595660224944974, "vf_loss": 9.289717828730742, "vf_explained_var": 0.3748300664126873, "kl": 0.022463068297292922, "entropy": 1.4939829946806034, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 8160.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "env_runners": {"episode_reward_max": 2.6695680787507534, "episode_reward_min": -1428.8854020890833, "episode_reward_mean": -700.9978010276919, "episode_len_mean": 126.32, "episode_media": {}, "episodes_timesteps_total": 12632, "policy_reward_min": {"policy_0": -1428.8854020890833}, "policy_reward_max": {"policy_0": 2.6695680787507534}, "policy_reward_mean": {"policy_0": -700.9978010276919}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-787.6446344647026, -340.4020342779644, -1202.7173350794624, -1224.859379983898, -1034.8110925248143, -620.2148262531127, -1179.76479001959, -340.6376997164323, -242.78410621181442, -28.950998738903333, -993.7858898994245, -372.5670891050165, -1186.9780426900452, -892.156363266425, -18.4753858801608, -880.2129801110374, -29.797337691038532, -1083.1021918421275, -350.8344587193497, -4.813337932834998, -109.1493989921838, -395.7470370433056, -769.8376791191045, -1261.9774378158666, -656.8429133533425, -1230.3436253849557, -912.415900119643, -688.8853019539239, -229.65932936637162, -986.8588262144946, -88.14214534455087, -997.476205694574, -391.4224046588865, -737.693301546856, -747.5895544450323, -924.740350414549, -1375.1668851690579, -910.9017504774716, -1428.8854020890833, -1072.34380750202, -1115.9712745792415, -64.94948148833736, -1296.540093398034, -56.98686357839751, -1226.5568140197404, -1115.674976328714, -692.3063654447966, -1049.5654370173788, -562.0762993145815, -432.37203322226253, -138.16620506807254, -90.56476362191266, -485.2113408017989, -266.6590846291911, -561.4719420206703, -1070.1618446323007, -1035.6791359156493, -550.5686342215462, -1079.992602187095, -1330.359000112199, -1275.5126864091053, -1293.50786405284, -53.73747045513897, -986.9616506778616, -318.2015178703516, 2.6695680787507534, -1164.8034224229707, -1030.811248999606, -478.472058960667, -886.9982320552401, -1269.726611627757, -756.1767682630145, -1182.624886592368, -204.5676195799863, -1162.5077076740815, -153.68209298875726, -118.87348159905389, -193.29506041073034, -786.9687828939615, -1185.1753170819013, -672.8405186304561, -153.429936294375, -362.38965609158623, -47.30905428641097, -700.2405942699405, -439.38706139668267, -836.476477331759, -581.0262765739375, -1001.2000554162097, -617.1498816718462, -1165.2946439931663, -46.848696148703496, -1198.4097443722535, -399.2458917726276, -1112.0163187396643, -874.2800320005108, -606.0107579201672, -1064.9707727930374, -315.5313183586437, -452.3640794552236], "episode_lengths": [150, 108, 150, 150, 150, 150, 150, 149, 90, 52, 150, 110, 150, 150, 42, 150, 37, 150, 87, 31, 62, 140, 150, 150, 150, 150, 150, 150, 115, 150, 57, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 61, 150, 150, 150, 150, 150, 102, 77, 57, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 31, 150, 150, 143, 150, 150, 150, 150, 71, 150, 75, 83, 76, 150, 150, 144, 85, 85, 52, 150, 123, 150, 150, 150, 150, 150, 36, 150, 150, 150, 150, 150, 150, 80, 101], "policy_policy_0_reward": [-787.6446344647026, -340.4020342779644, -1202.7173350794624, -1224.859379983898, -1034.8110925248143, -620.2148262531127, -1179.76479001959, -340.6376997164323, -242.78410621181442, -28.950998738903333, -993.7858898994245, -372.5670891050165, -1186.9780426900452, -892.156363266425, -18.4753858801608, -880.2129801110374, -29.797337691038532, -1083.1021918421275, -350.8344587193497, -4.813337932834998, -109.1493989921838, -395.7470370433056, -769.8376791191045, -1261.9774378158666, -656.8429133533425, -1230.3436253849557, -912.415900119643, -688.8853019539239, -229.65932936637162, -986.8588262144946, -88.14214534455087, -997.476205694574, -391.4224046588865, -737.693301546856, -747.5895544450323, -924.740350414549, -1375.1668851690579, -910.9017504774716, -1428.8854020890833, -1072.34380750202, -1115.9712745792415, -64.94948148833736, -1296.540093398034, -56.98686357839751, -1226.5568140197404, -1115.674976328714, -692.3063654447966, -1049.5654370173788, -562.0762993145815, -432.37203322226253, -138.16620506807254, -90.56476362191266, -485.2113408017989, -266.6590846291911, -561.4719420206703, -1070.1618446323007, -1035.6791359156493, -550.5686342215462, -1079.992602187095, -1330.359000112199, -1275.5126864091053, -1293.50786405284, -53.73747045513897, -986.9616506778616, -318.2015178703516, 2.6695680787507534, -1164.8034224229707, -1030.811248999606, -478.472058960667, -886.9982320552401, -1269.726611627757, -756.1767682630145, -1182.624886592368, -204.5676195799863, -1162.5077076740815, -153.68209298875726, -118.87348159905389, -193.29506041073034, -786.9687828939615, -1185.1753170819013, -672.8405186304561, -153.429936294375, -362.38965609158623, -47.30905428641097, -700.2405942699405, -439.38706139668267, -836.476477331759, -581.0262765739375, -1001.2000554162097, -617.1498816718462, -1165.2946439931663, -46.848696148703496, -1198.4097443722535, -399.2458917726276, -1112.0163187396643, -874.2800320005108, -606.0107579201672, -1064.9707727930374, -315.5313183586437, -452.3640794552236]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5626244115343783, "mean_inference_ms": 1.6750669632417878, "mean_action_processing_ms": 0.27745316023996913, "mean_env_wait_ms": 3.4479078135014727, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012119054794311523, "StateBufferConnector_ms": 0.007903814315795898, "ViewRequirementAgentConnector_ms": 0.18855810165405273}, "num_episodes": 28, "episode_return_max": 2.6695680787507534, "episode_return_min": -1428.8854020890833, "episode_return_mean": -700.9978010276919, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000, "num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 307.4419942288803, "num_env_steps_trained_throughput_per_sec": 307.4419942288803, "timesteps_total": 36000, "num_env_steps_sampled_lifetime": 36000, "num_agent_steps_sampled_lifetime": 36000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 36000, "timers": {"training_iteration_time_ms": 12167.188, "restore_workers_time_ms": 0.027, "training_step_time_ms": 12167.12, "sample_time_ms": 1126.884, "learn_time_ms": 10973.936, "learn_throughput": 364.5, "synch_weights_time_ms": 65.417}, "counters": {"num_env_steps_sampled": 36000, "num_env_steps_trained": 36000, "num_agent_steps_sampled": 36000, "num_agent_steps_trained": 36000}, "done": false, "training_iteration": 9, "trial_id": "1a22e_00017", "date": "2024-08-04_07-04-02", "timestamp": 1722735242, "time_this_iter_s": 13.022427320480347, "time_total_s": 109.61504554748535, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237077dfc0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 109.61504554748535, "iterations_since_restore": 9, "perf": {"cpu_util_percent": 18.342105263157894, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 5.247071791999042, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.327069109678268, "policy_loss": -0.011591414399057006, "vf_loss": 9.350619743267695, "vf_explained_var": 0.37783177799234785, "kl": 0.01580821348543395, "entropy": 1.670166535054644, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 9120.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "env_runners": {"episode_reward_max": 2.6695680787507534, "episode_reward_min": -1428.8854020890833, "episode_reward_mean": -716.0769488259275, "episode_len_mean": 129.04, "episode_media": {}, "episodes_timesteps_total": 12904, "policy_reward_min": {"policy_0": -1428.8854020890833}, "policy_reward_max": {"policy_0": 2.6695680787507534}, "policy_reward_mean": {"policy_0": -716.0769488259275}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-229.65932936637162, -986.8588262144946, -88.14214534455087, -997.476205694574, -391.4224046588865, -737.693301546856, -747.5895544450323, -924.740350414549, -1375.1668851690579, -910.9017504774716, -1428.8854020890833, -1072.34380750202, -1115.9712745792415, -64.94948148833736, -1296.540093398034, -56.98686357839751, -1226.5568140197404, -1115.674976328714, -692.3063654447966, -1049.5654370173788, -562.0762993145815, -432.37203322226253, -138.16620506807254, -90.56476362191266, -485.2113408017989, -266.6590846291911, -561.4719420206703, -1070.1618446323007, -1035.6791359156493, -550.5686342215462, -1079.992602187095, -1330.359000112199, -1275.5126864091053, -1293.50786405284, -53.73747045513897, -986.9616506778616, -318.2015178703516, 2.6695680787507534, -1164.8034224229707, -1030.811248999606, -478.472058960667, -886.9982320552401, -1269.726611627757, -756.1767682630145, -1182.624886592368, -204.5676195799863, -1162.5077076740815, -153.68209298875726, -118.87348159905389, -193.29506041073034, -786.9687828939615, -1185.1753170819013, -672.8405186304561, -153.429936294375, -362.38965609158623, -47.30905428641097, -700.2405942699405, -439.38706139668267, -836.476477331759, -581.0262765739375, -1001.2000554162097, -617.1498816718462, -1165.2946439931663, -46.848696148703496, -1198.4097443722535, -399.2458917726276, -1112.0163187396643, -874.2800320005108, -606.0107579201672, -1064.9707727930374, -315.5313183586437, -452.3640794552236, -361.2364864919601, -816.3065706024955, -541.1433355063259, -267.4327196766861, -1102.96026919497, -1213.1143495694912, -902.7288453674805, -710.5755167011849, -514.3575698578837, -1255.7149635303963, -1087.221657802217, -451.79537715447566, -113.14350131889627, -422.4223569815012, -792.1832368447235, -1063.7534678976963, -1234.6305015789687, -1227.2284009217803, -922.3035708569313, -1114.8542009096036, -358.23026341454516, -74.71388570550789, -166.94634974890678, -332.99310634340924, -1043.2349845585966, -653.719742112714, -1064.2837074147678, -539.3951099499118], "episode_lengths": [115, 150, 57, 150, 119, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 61, 150, 150, 150, 150, 150, 102, 77, 57, 150, 78, 150, 150, 150, 150, 150, 150, 150, 150, 59, 150, 150, 31, 150, 150, 143, 150, 150, 150, 150, 71, 150, 75, 83, 76, 150, 150, 144, 85, 85, 52, 150, 123, 150, 150, 150, 150, 150, 36, 150, 150, 150, 150, 150, 150, 80, 101, 98, 150, 150, 127, 150, 150, 150, 127, 150, 150, 150, 143, 66, 100, 150, 150, 150, 150, 150, 150, 130, 72, 87, 108, 150, 122, 150, 150], "policy_policy_0_reward": [-229.65932936637162, -986.8588262144946, -88.14214534455087, -997.476205694574, -391.4224046588865, -737.693301546856, -747.5895544450323, -924.740350414549, -1375.1668851690579, -910.9017504774716, -1428.8854020890833, -1072.34380750202, -1115.9712745792415, -64.94948148833736, -1296.540093398034, -56.98686357839751, -1226.5568140197404, -1115.674976328714, -692.3063654447966, -1049.5654370173788, -562.0762993145815, -432.37203322226253, -138.16620506807254, -90.56476362191266, -485.2113408017989, -266.6590846291911, -561.4719420206703, -1070.1618446323007, -1035.6791359156493, -550.5686342215462, -1079.992602187095, -1330.359000112199, -1275.5126864091053, -1293.50786405284, -53.73747045513897, -986.9616506778616, -318.2015178703516, 2.6695680787507534, -1164.8034224229707, -1030.811248999606, -478.472058960667, -886.9982320552401, -1269.726611627757, -756.1767682630145, -1182.624886592368, -204.5676195799863, -1162.5077076740815, -153.68209298875726, -118.87348159905389, -193.29506041073034, -786.9687828939615, -1185.1753170819013, -672.8405186304561, -153.429936294375, -362.38965609158623, -47.30905428641097, -700.2405942699405, -439.38706139668267, -836.476477331759, -581.0262765739375, -1001.2000554162097, -617.1498816718462, -1165.2946439931663, -46.848696148703496, -1198.4097443722535, -399.2458917726276, -1112.0163187396643, -874.2800320005108, -606.0107579201672, -1064.9707727930374, -315.5313183586437, -452.3640794552236, -361.2364864919601, -816.3065706024955, -541.1433355063259, -267.4327196766861, -1102.96026919497, -1213.1143495694912, -902.7288453674805, -710.5755167011849, -514.3575698578837, -1255.7149635303963, -1087.221657802217, -451.79537715447566, -113.14350131889627, -422.4223569815012, -792.1832368447235, -1063.7534678976963, -1234.6305015789687, -1227.2284009217803, -922.3035708569313, -1114.8542009096036, -358.23026341454516, -74.71388570550789, -166.94634974890678, -332.99310634340924, -1043.2349845585966, -653.719742112714, -1064.2837074147678, -539.3951099499118]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5613424318627187, "mean_inference_ms": 1.672772251035869, "mean_action_processing_ms": 0.2768498299821959, "mean_env_wait_ms": 3.4458007842666687, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012189388275146484, "StateBufferConnector_ms": 0.007820606231689453, "ViewRequirementAgentConnector_ms": 0.18946027755737305}, "num_episodes": 28, "episode_return_max": 2.6695680787507534, "episode_return_min": -1428.8854020890833, "episode_return_mean": -716.0769488259275, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000, "num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 326.23430415033255, "num_env_steps_trained_throughput_per_sec": 326.23430415033255, "timesteps_total": 40000, "num_env_steps_sampled_lifetime": 40000, "num_agent_steps_sampled_lifetime": 40000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 40000, "timers": {"training_iteration_time_ms": 12176.583, "restore_workers_time_ms": 0.028, "training_step_time_ms": 12176.513, "sample_time_ms": 1128.694, "learn_time_ms": 10980.643, "learn_throughput": 364.277, "synch_weights_time_ms": 66.291}, "counters": {"num_env_steps_sampled": 40000, "num_env_steps_trained": 40000, "num_agent_steps_sampled": 40000, "num_agent_steps_trained": 40000}, "done": false, "training_iteration": 10, "trial_id": "1a22e_00017", "date": "2024-08-04_07-04-14", "timestamp": 1722735254, "time_this_iter_s": 12.273992776870728, "time_total_s": 121.88903832435608, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237077f490>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 121.88903832435608, "iterations_since_restore": 10, "perf": {"cpu_util_percent": 19.029411764705884, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.691112280388674, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.2879973868529, "policy_loss": -0.005589313904056326, "vf_loss": 9.305438930789629, "vf_explained_var": 0.37374664669235547, "kl": 0.014636286154374538, "entropy": 1.6243100145210823, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 10080.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "env_runners": {"episode_reward_max": 2.6695680787507534, "episode_reward_min": -1406.0471898628266, "episode_reward_mean": -738.0583775281905, "episode_len_mean": 130.64, "episode_media": {}, "episodes_timesteps_total": 13064, "policy_reward_min": {"policy_0": -1406.0471898628266}, "policy_reward_max": {"policy_0": 2.6695680787507534}, "policy_reward_mean": {"policy_0": -738.0583775281905}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-986.9616506778616, -318.2015178703516, 2.6695680787507534, -1164.8034224229707, -1030.811248999606, -478.472058960667, -886.9982320552401, -1269.726611627757, -756.1767682630145, -1182.624886592368, -204.5676195799863, -1162.5077076740815, -153.68209298875726, -118.87348159905389, -193.29506041073034, -786.9687828939615, -1185.1753170819013, -672.8405186304561, -153.429936294375, -362.38965609158623, -47.30905428641097, -700.2405942699405, -439.38706139668267, -836.476477331759, -581.0262765739375, -1001.2000554162097, -617.1498816718462, -1165.2946439931663, -46.848696148703496, -1198.4097443722535, -399.2458917726276, -1112.0163187396643, -874.2800320005108, -606.0107579201672, -1064.9707727930374, -315.5313183586437, -452.3640794552236, -361.2364864919601, -816.3065706024955, -541.1433355063259, -267.4327196766861, -1102.96026919497, -1213.1143495694912, -902.7288453674805, -710.5755167011849, -514.3575698578837, -1255.7149635303963, -1087.221657802217, -451.79537715447566, -113.14350131889627, -422.4223569815012, -792.1832368447235, -1063.7534678976963, -1234.6305015789687, -1227.2284009217803, -922.3035708569313, -1114.8542009096036, -358.23026341454516, -74.71388570550789, -166.94634974890678, -332.99310634340924, -1043.2349845585966, -653.719742112714, -1064.2837074147678, -539.3951099499118, -825.7760831277312, -1152.4842876755833, -1228.5211141074562, -1172.2091418842745, -855.9229009223468, -1219.1676751924947, -1154.3454623498212, -386.8904925115836, -1149.799772127373, -412.712930895896, -1406.0471898628266, -902.8423587920602, -891.2171334432567, -1350.2294114695394, -1172.1359394993308, -229.0859029270385, -93.09275339989865, -600.2951323176596, -1073.8897221938487, -992.9768926758807, -139.45129439182597, -411.04111482293985, -816.6985807948737, -1202.2908281814987, -390.0037638426131, -430.8041170886973, -1068.051979397454, -81.9753460869962, -1214.9117311447426, -177.8214518357631, -620.0232667467549, -511.3496061454523, -1286.52279164823, -937.4024344236383, -1375.6244417408955], "episode_lengths": [150, 150, 31, 150, 150, 143, 150, 150, 150, 150, 71, 150, 75, 83, 76, 150, 150, 144, 85, 85, 52, 150, 123, 150, 150, 150, 150, 150, 36, 150, 150, 150, 150, 150, 150, 80, 101, 98, 150, 150, 127, 150, 150, 150, 127, 150, 150, 150, 143, 66, 100, 150, 150, 150, 150, 150, 150, 130, 72, 87, 108, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 76, 64, 150, 150, 150, 64, 127, 150, 150, 150, 150, 150, 51, 150, 65, 150, 103, 150, 150, 150], "policy_policy_0_reward": [-986.9616506778616, -318.2015178703516, 2.6695680787507534, -1164.8034224229707, -1030.811248999606, -478.472058960667, -886.9982320552401, -1269.726611627757, -756.1767682630145, -1182.624886592368, -204.5676195799863, -1162.5077076740815, -153.68209298875726, -118.87348159905389, -193.29506041073034, -786.9687828939615, -1185.1753170819013, -672.8405186304561, -153.429936294375, -362.38965609158623, -47.30905428641097, -700.2405942699405, -439.38706139668267, -836.476477331759, -581.0262765739375, -1001.2000554162097, -617.1498816718462, -1165.2946439931663, -46.848696148703496, -1198.4097443722535, -399.2458917726276, -1112.0163187396643, -874.2800320005108, -606.0107579201672, -1064.9707727930374, -315.5313183586437, -452.3640794552236, -361.2364864919601, -816.3065706024955, -541.1433355063259, -267.4327196766861, -1102.96026919497, -1213.1143495694912, -902.7288453674805, -710.5755167011849, -514.3575698578837, -1255.7149635303963, -1087.221657802217, -451.79537715447566, -113.14350131889627, -422.4223569815012, -792.1832368447235, -1063.7534678976963, -1234.6305015789687, -1227.2284009217803, -922.3035708569313, -1114.8542009096036, -358.23026341454516, -74.71388570550789, -166.94634974890678, -332.99310634340924, -1043.2349845585966, -653.719742112714, -1064.2837074147678, -539.3951099499118, -825.7760831277312, -1152.4842876755833, -1228.5211141074562, -1172.2091418842745, -855.9229009223468, -1219.1676751924947, -1154.3454623498212, -386.8904925115836, -1149.799772127373, -412.712930895896, -1406.0471898628266, -902.8423587920602, -891.2171334432567, -1350.2294114695394, -1172.1359394993308, -229.0859029270385, -93.09275339989865, -600.2951323176596, -1073.8897221938487, -992.9768926758807, -139.45129439182597, -411.04111482293985, -816.6985807948737, -1202.2908281814987, -390.0037638426131, -430.8041170886973, -1068.051979397454, -81.9753460869962, -1214.9117311447426, -177.8214518357631, -620.0232667467549, -511.3496061454523, -1286.52279164823, -937.4024344236383, -1375.6244417408955]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5589066676744029, "mean_inference_ms": 1.6722716060479734, "mean_action_processing_ms": 0.27679225661929824, "mean_env_wait_ms": 3.4502028800638866, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012449264526367188, "StateBufferConnector_ms": 0.008118391036987305, "ViewRequirementAgentConnector_ms": 0.19576120376586914}, "num_episodes": 35, "episode_return_max": 2.6695680787507534, "episode_return_min": -1406.0471898628266, "episode_return_mean": -738.0583775281905, "episodes_this_iter": 35}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000, "num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 302.95638065739877, "num_env_steps_trained_throughput_per_sec": 302.95638065739877, "timesteps_total": 44000, "num_env_steps_sampled_lifetime": 44000, "num_agent_steps_sampled_lifetime": 44000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 44000, "timers": {"training_iteration_time_ms": 12207.157, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12207.083, "sample_time_ms": 1129.58, "learn_time_ms": 11010.297, "learn_throughput": 363.296, "synch_weights_time_ms": 66.327}, "counters": {"num_env_steps_sampled": 44000, "num_env_steps_trained": 44000, "num_agent_steps_sampled": 44000, "num_agent_steps_trained": 44000}, "done": false, "training_iteration": 11, "trial_id": "1a22e_00017", "date": "2024-08-04_07-04-27", "timestamp": 1722735267, "time_this_iter_s": 13.215545415878296, "time_total_s": 135.10458374023438, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370726c20>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 135.10458374023438, "iterations_since_restore": 11, "perf": {"cpu_util_percent": 18.205263157894734, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 7.816107374057173, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.385458351174991, "policy_loss": -0.011299318366218359, "vf_loss": 9.40972547630469, "vf_explained_var": 0.36219317130744455, "kl": 0.015301060618215463, "entropy": 1.755812998364369, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 11040.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "env_runners": {"episode_reward_max": -9.478252511116208, "episode_reward_min": -1504.5824515937609, "episode_reward_mean": -779.0205513342387, "episode_len_mean": 130.94, "episode_media": {}, "episodes_timesteps_total": 13094, "policy_reward_min": {"policy_0": -1504.5824515937609}, "policy_reward_max": {"policy_0": -9.478252511116208}, "policy_reward_mean": {"policy_0": -779.0205513342387}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1165.2946439931663, -46.848696148703496, -1198.4097443722535, -399.2458917726276, -1112.0163187396643, -874.2800320005108, -606.0107579201672, -1064.9707727930374, -315.5313183586437, -452.3640794552236, -361.2364864919601, -816.3065706024955, -541.1433355063259, -267.4327196766861, -1102.96026919497, -1213.1143495694912, -902.7288453674805, -710.5755167011849, -514.3575698578837, -1255.7149635303963, -1087.221657802217, -451.79537715447566, -113.14350131889627, -422.4223569815012, -792.1832368447235, -1063.7534678976963, -1234.6305015789687, -1227.2284009217803, -922.3035708569313, -1114.8542009096036, -358.23026341454516, -74.71388570550789, -166.94634974890678, -332.99310634340924, -1043.2349845585966, -653.719742112714, -1064.2837074147678, -539.3951099499118, -825.7760831277312, -1152.4842876755833, -1228.5211141074562, -1172.2091418842745, -855.9229009223468, -1219.1676751924947, -1154.3454623498212, -386.8904925115836, -1149.799772127373, -412.712930895896, -1406.0471898628266, -902.8423587920602, -891.2171334432567, -1350.2294114695394, -1172.1359394993308, -229.0859029270385, -93.09275339989865, -600.2951323176596, -1073.8897221938487, -992.9768926758807, -139.45129439182597, -411.04111482293985, -816.6985807948737, -1202.2908281814987, -390.0037638426131, -430.8041170886973, -1068.051979397454, -81.9753460869962, -1214.9117311447426, -177.8214518357631, -620.0232667467549, -511.3496061454523, -1286.52279164823, -937.4024344236383, -1375.6244417408955, -221.20272059028773, -329.72282387842176, -601.8351903592988, -1319.2013052000534, -820.5234337230046, -1504.5824515937609, -881.4698558117609, -1197.566284990465, -1116.5344117450666, -1089.3009762455692, -32.152676933637615, -447.4765410050748, -1086.15221368609, -68.67105690074172, -663.0232364733674, -1337.936555042846, -909.2542302109686, -9.478252511116208, -18.055828202863655, -1384.4689382827398, -1332.769005590815, -1180.5402495232518, -908.5306945136851, -246.3493898363132, -771.7693771374422, -1389.477874331418, -516.7982098674988], "episode_lengths": [150, 36, 150, 150, 150, 150, 150, 150, 80, 101, 98, 150, 150, 127, 150, 150, 150, 127, 150, 150, 150, 143, 66, 100, 150, 150, 150, 150, 150, 150, 130, 72, 87, 108, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 76, 64, 150, 150, 150, 64, 127, 150, 150, 150, 150, 150, 51, 150, 65, 150, 103, 150, 150, 150, 123, 115, 128, 150, 150, 150, 150, 150, 150, 150, 41, 150, 150, 41, 150, 150, 150, 34, 35, 150, 150, 150, 150, 68, 150, 150, 113], "policy_policy_0_reward": [-1165.2946439931663, -46.848696148703496, -1198.4097443722535, -399.2458917726276, -1112.0163187396643, -874.2800320005108, -606.0107579201672, -1064.9707727930374, -315.5313183586437, -452.3640794552236, -361.2364864919601, -816.3065706024955, -541.1433355063259, -267.4327196766861, -1102.96026919497, -1213.1143495694912, -902.7288453674805, -710.5755167011849, -514.3575698578837, -1255.7149635303963, -1087.221657802217, -451.79537715447566, -113.14350131889627, -422.4223569815012, -792.1832368447235, -1063.7534678976963, -1234.6305015789687, -1227.2284009217803, -922.3035708569313, -1114.8542009096036, -358.23026341454516, -74.71388570550789, -166.94634974890678, -332.99310634340924, -1043.2349845585966, -653.719742112714, -1064.2837074147678, -539.3951099499118, -825.7760831277312, -1152.4842876755833, -1228.5211141074562, -1172.2091418842745, -855.9229009223468, -1219.1676751924947, -1154.3454623498212, -386.8904925115836, -1149.799772127373, -412.712930895896, -1406.0471898628266, -902.8423587920602, -891.2171334432567, -1350.2294114695394, -1172.1359394993308, -229.0859029270385, -93.09275339989865, -600.2951323176596, -1073.8897221938487, -992.9768926758807, -139.45129439182597, -411.04111482293985, -816.6985807948737, -1202.2908281814987, -390.0037638426131, -430.8041170886973, -1068.051979397454, -81.9753460869962, -1214.9117311447426, -177.8214518357631, -620.0232667467549, -511.3496061454523, -1286.52279164823, -937.4024344236383, -1375.6244417408955, -221.20272059028773, -329.72282387842176, -601.8351903592988, -1319.2013052000534, -820.5234337230046, -1504.5824515937609, -881.4698558117609, -1197.566284990465, -1116.5344117450666, -1089.3009762455692, -32.152676933637615, -447.4765410050748, -1086.15221368609, -68.67105690074172, -663.0232364733674, -1337.936555042846, -909.2542302109686, -9.478252511116208, -18.055828202863655, -1384.4689382827398, -1332.769005590815, -1180.5402495232518, -908.5306945136851, -246.3493898363132, -771.7693771374422, -1389.477874331418, -516.7982098674988]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5569959917763245, "mean_inference_ms": 1.6716623503585923, "mean_action_processing_ms": 0.27673551516435624, "mean_env_wait_ms": 3.4563151832351595, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.01224660873413086, "StateBufferConnector_ms": 0.008173227310180664, "ViewRequirementAgentConnector_ms": 0.19736766815185547}, "num_episodes": 27, "episode_return_max": -9.478252511116208, "episode_return_min": -1504.5824515937609, "episode_return_mean": -779.0205513342387, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000, "num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 364.2689759449002, "num_env_steps_trained_throughput_per_sec": 364.2689759449002, "timesteps_total": 48000, "num_env_steps_sampled_lifetime": 48000, "num_agent_steps_sampled_lifetime": 48000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 48000, "timers": {"training_iteration_time_ms": 11992.216, "restore_workers_time_ms": 0.03, "training_step_time_ms": 11992.141, "sample_time_ms": 1134.532, "learn_time_ms": 10793.119, "learn_throughput": 370.606, "synch_weights_time_ms": 63.608}, "counters": {"num_env_steps_sampled": 48000, "num_env_steps_trained": 48000, "num_agent_steps_sampled": 48000, "num_agent_steps_trained": 48000}, "done": false, "training_iteration": 12, "trial_id": "1a22e_00017", "date": "2024-08-04_07-04-38", "timestamp": 1722735278, "time_this_iter_s": 10.993377923965454, "time_total_s": 146.09796166419983, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237077fd90>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 146.09796166419983, "iterations_since_restore": 12, "perf": {"cpu_util_percent": 20.00625, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.252932926391562, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.30152257134517, "policy_loss": -0.013260250740374128, "vf_loss": 9.327048601706823, "vf_explained_var": 0.3915892939393719, "kl": 0.016739962595526472, "entropy": 1.7287761109570663, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12000.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "env_runners": {"episode_reward_max": -9.478252511116208, "episode_reward_min": -1523.4511139540416, "episode_reward_mean": -788.6365513441878, "episode_len_mean": 131.52, "episode_media": {}, "episodes_timesteps_total": 13152, "policy_reward_min": {"policy_0": -1523.4511139540416}, "policy_reward_max": {"policy_0": -9.478252511116208}, "policy_reward_mean": {"policy_0": -788.6365513441878}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-74.71388570550789, -166.94634974890678, -332.99310634340924, -1043.2349845585966, -653.719742112714, -1064.2837074147678, -539.3951099499118, -825.7760831277312, -1152.4842876755833, -1228.5211141074562, -1172.2091418842745, -855.9229009223468, -1219.1676751924947, -1154.3454623498212, -386.8904925115836, -1149.799772127373, -412.712930895896, -1406.0471898628266, -902.8423587920602, -891.2171334432567, -1350.2294114695394, -1172.1359394993308, -229.0859029270385, -93.09275339989865, -600.2951323176596, -1073.8897221938487, -992.9768926758807, -139.45129439182597, -411.04111482293985, -816.6985807948737, -1202.2908281814987, -390.0037638426131, -430.8041170886973, -1068.051979397454, -81.9753460869962, -1214.9117311447426, -177.8214518357631, -620.0232667467549, -511.3496061454523, -1286.52279164823, -937.4024344236383, -1375.6244417408955, -221.20272059028773, -329.72282387842176, -601.8351903592988, -1319.2013052000534, -820.5234337230046, -1504.5824515937609, -881.4698558117609, -1197.566284990465, -1116.5344117450666, -1089.3009762455692, -32.152676933637615, -447.4765410050748, -1086.15221368609, -68.67105690074172, -663.0232364733674, -1337.936555042846, -909.2542302109686, -9.478252511116208, -18.055828202863655, -1384.4689382827398, -1332.769005590815, -1180.5402495232518, -908.5306945136851, -246.3493898363132, -771.7693771374422, -1389.477874331418, -516.7982098674988, -696.0956062779763, -1195.0161496017608, -735.9250764172612, -348.0010267004362, -347.17041984158953, -1179.865699529798, -110.3625172288279, -729.3164324992745, -1200.8209685504432, -80.01844845472854, -167.61611002372194, -741.1496876466632, -1115.8522267654137, -1095.7759661345995, -1523.4511139540416, -1253.8510165290977, -581.8398784828754, -806.9348592170645, -1294.2886098651927, -1344.8719029969814, -824.7338991732598, -1054.5939685638177, -567.15406831327, -890.632542334782, -551.4279563361728, -1088.3923583009016, -1004.3176828609232, -380.73925056677984, -235.0405940613315, -142.84169483867964, -1381.811686661466], "episode_lengths": [72, 87, 108, 150, 122, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 99, 150, 150, 150, 150, 150, 76, 64, 150, 150, 150, 64, 127, 150, 150, 150, 150, 150, 51, 150, 65, 150, 103, 150, 150, 150, 123, 115, 128, 150, 150, 150, 150, 150, 150, 150, 41, 150, 150, 41, 150, 150, 150, 34, 35, 150, 150, 150, 150, 68, 150, 150, 113, 150, 150, 129, 150, 150, 150, 75, 150, 150, 50, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 72, 150], "policy_policy_0_reward": [-74.71388570550789, -166.94634974890678, -332.99310634340924, -1043.2349845585966, -653.719742112714, -1064.2837074147678, -539.3951099499118, -825.7760831277312, -1152.4842876755833, -1228.5211141074562, -1172.2091418842745, -855.9229009223468, -1219.1676751924947, -1154.3454623498212, -386.8904925115836, -1149.799772127373, -412.712930895896, -1406.0471898628266, -902.8423587920602, -891.2171334432567, -1350.2294114695394, -1172.1359394993308, -229.0859029270385, -93.09275339989865, -600.2951323176596, -1073.8897221938487, -992.9768926758807, -139.45129439182597, -411.04111482293985, -816.6985807948737, -1202.2908281814987, -390.0037638426131, -430.8041170886973, -1068.051979397454, -81.9753460869962, -1214.9117311447426, -177.8214518357631, -620.0232667467549, -511.3496061454523, -1286.52279164823, -937.4024344236383, -1375.6244417408955, -221.20272059028773, -329.72282387842176, -601.8351903592988, -1319.2013052000534, -820.5234337230046, -1504.5824515937609, -881.4698558117609, -1197.566284990465, -1116.5344117450666, -1089.3009762455692, -32.152676933637615, -447.4765410050748, -1086.15221368609, -68.67105690074172, -663.0232364733674, -1337.936555042846, -909.2542302109686, -9.478252511116208, -18.055828202863655, -1384.4689382827398, -1332.769005590815, -1180.5402495232518, -908.5306945136851, -246.3493898363132, -771.7693771374422, -1389.477874331418, -516.7982098674988, -696.0956062779763, -1195.0161496017608, -735.9250764172612, -348.0010267004362, -347.17041984158953, -1179.865699529798, -110.3625172288279, -729.3164324992745, -1200.8209685504432, -80.01844845472854, -167.61611002372194, -741.1496876466632, -1115.8522267654137, -1095.7759661345995, -1523.4511139540416, -1253.8510165290977, -581.8398784828754, -806.9348592170645, -1294.2886098651927, -1344.8719029969814, -824.7338991732598, -1054.5939685638177, -567.15406831327, -890.632542334782, -551.4279563361728, -1088.3923583009016, -1004.3176828609232, -380.73925056677984, -235.0405940613315, -142.84169483867964, -1381.811686661466]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5558424760578982, "mean_inference_ms": 1.672737404018621, "mean_action_processing_ms": 0.2768579330831742, "mean_env_wait_ms": 3.464551905550055, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012349843978881836, "StateBufferConnector_ms": 0.008185148239135742, "ViewRequirementAgentConnector_ms": 0.19804763793945312}, "num_episodes": 31, "episode_return_max": -9.478252511116208, "episode_return_min": -1523.4511139540416, "episode_return_mean": -788.6365513441878, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000, "num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 305.56844652364225, "num_env_steps_trained_throughput_per_sec": 305.56844652364225, "timesteps_total": 52000, "num_env_steps_sampled_lifetime": 52000, "num_agent_steps_sampled_lifetime": 52000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 52000, "timers": {"training_iteration_time_ms": 12255.79, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12255.717, "sample_time_ms": 1126.847, "learn_time_ms": 11064.601, "learn_throughput": 361.513, "synch_weights_time_ms": 63.389}, "counters": {"num_env_steps_sampled": 52000, "num_env_steps_trained": 52000, "num_agent_steps_sampled": 52000, "num_agent_steps_trained": 52000}, "done": false, "training_iteration": 13, "trial_id": "1a22e_00017", "date": "2024-08-04_07-04-51", "timestamp": 1722735291, "time_this_iter_s": 13.10299825668335, "time_total_s": 159.20095992088318, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237077f520>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 159.20095992088318, "iterations_since_restore": 13, "perf": {"cpu_util_percent": 19.016666666666666, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 8.090111748998364, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.29197425643603, "policy_loss": -0.015227588361206775, "vf_loss": 9.319292453924815, "vf_explained_var": 0.49853792091210686, "kl": 0.01814798574002149, "entropy": 1.753499028707544, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 12960.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "env_runners": {"episode_reward_max": -9.478252511116208, "episode_reward_min": -1523.4511139540416, "episode_reward_mean": -813.1449260462457, "episode_len_mean": 132.71, "episode_media": {}, "episodes_timesteps_total": 13271, "policy_reward_min": {"policy_0": -1523.4511139540416}, "policy_reward_max": {"policy_0": -9.478252511116208}, "policy_reward_mean": {"policy_0": -813.1449260462457}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-390.0037638426131, -430.8041170886973, -1068.051979397454, -81.9753460869962, -1214.9117311447426, -177.8214518357631, -620.0232667467549, -511.3496061454523, -1286.52279164823, -937.4024344236383, -1375.6244417408955, -221.20272059028773, -329.72282387842176, -601.8351903592988, -1319.2013052000534, -820.5234337230046, -1504.5824515937609, -881.4698558117609, -1197.566284990465, -1116.5344117450666, -1089.3009762455692, -32.152676933637615, -447.4765410050748, -1086.15221368609, -68.67105690074172, -663.0232364733674, -1337.936555042846, -909.2542302109686, -9.478252511116208, -18.055828202863655, -1384.4689382827398, -1332.769005590815, -1180.5402495232518, -908.5306945136851, -246.3493898363132, -771.7693771374422, -1389.477874331418, -516.7982098674988, -696.0956062779763, -1195.0161496017608, -735.9250764172612, -348.0010267004362, -347.17041984158953, -1179.865699529798, -110.3625172288279, -729.3164324992745, -1200.8209685504432, -80.01844845472854, -167.61611002372194, -741.1496876466632, -1115.8522267654137, -1095.7759661345995, -1523.4511139540416, -1253.8510165290977, -581.8398784828754, -806.9348592170645, -1294.2886098651927, -1344.8719029969814, -824.7338991732598, -1054.5939685638177, -567.15406831327, -890.632542334782, -551.4279563361728, -1088.3923583009016, -1004.3176828609232, -380.73925056677984, -235.0405940613315, -142.84169483867964, -1381.811686661466, -623.4036295952959, -793.0148825538603, -1338.935179206427, -705.4267278474607, -728.6176345580218, -1282.7278778204814, -435.84709203523545, -1325.662992311025, -1056.1561225545333, -23.712052232530148, -15.307610056825611, -490.761340907597, -1128.8208783912962, -1193.9511514042954, -567.8460320026758, -166.35636252926312, -1473.7455926715872, -1165.1289571257237, -1070.389992569929, -1250.741204029028, -747.2878819143763, -1164.1424360572273, -626.9935105615958, -1055.9505004962614, -1120.8535413808597, -1418.7219520208398, -1060.0163544172192, -1090.783097467517, -896.82056988721, -120.95545239406849, -1026.169862606368], "episode_lengths": [150, 150, 150, 51, 150, 65, 150, 103, 150, 150, 150, 123, 115, 128, 150, 150, 150, 150, 150, 150, 150, 41, 150, 150, 41, 150, 150, 150, 34, 35, 150, 150, 150, 150, 68, 150, 150, 113, 150, 150, 129, 150, 150, 150, 75, 150, 150, 50, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 72, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 41, 47, 113, 150, 150, 123, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150], "policy_policy_0_reward": [-390.0037638426131, -430.8041170886973, -1068.051979397454, -81.9753460869962, -1214.9117311447426, -177.8214518357631, -620.0232667467549, -511.3496061454523, -1286.52279164823, -937.4024344236383, -1375.6244417408955, -221.20272059028773, -329.72282387842176, -601.8351903592988, -1319.2013052000534, -820.5234337230046, -1504.5824515937609, -881.4698558117609, -1197.566284990465, -1116.5344117450666, -1089.3009762455692, -32.152676933637615, -447.4765410050748, -1086.15221368609, -68.67105690074172, -663.0232364733674, -1337.936555042846, -909.2542302109686, -9.478252511116208, -18.055828202863655, -1384.4689382827398, -1332.769005590815, -1180.5402495232518, -908.5306945136851, -246.3493898363132, -771.7693771374422, -1389.477874331418, -516.7982098674988, -696.0956062779763, -1195.0161496017608, -735.9250764172612, -348.0010267004362, -347.17041984158953, -1179.865699529798, -110.3625172288279, -729.3164324992745, -1200.8209685504432, -80.01844845472854, -167.61611002372194, -741.1496876466632, -1115.8522267654137, -1095.7759661345995, -1523.4511139540416, -1253.8510165290977, -581.8398784828754, -806.9348592170645, -1294.2886098651927, -1344.8719029969814, -824.7338991732598, -1054.5939685638177, -567.15406831327, -890.632542334782, -551.4279563361728, -1088.3923583009016, -1004.3176828609232, -380.73925056677984, -235.0405940613315, -142.84169483867964, -1381.811686661466, -623.4036295952959, -793.0148825538603, -1338.935179206427, -705.4267278474607, -728.6176345580218, -1282.7278778204814, -435.84709203523545, -1325.662992311025, -1056.1561225545333, -23.712052232530148, -15.307610056825611, -490.761340907597, -1128.8208783912962, -1193.9511514042954, -567.8460320026758, -166.35636252926312, -1473.7455926715872, -1165.1289571257237, -1070.389992569929, -1250.741204029028, -747.2878819143763, -1164.1424360572273, -626.9935105615958, -1055.9505004962614, -1120.8535413808597, -1418.7219520208398, -1060.0163544172192, -1090.783097467517, -896.82056988721, -120.95545239406849, -1026.169862606368]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5556796034467156, "mean_inference_ms": 1.671917403821636, "mean_action_processing_ms": 0.27665542442519003, "mean_env_wait_ms": 3.4748635053572885, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011966466903686523, "StateBufferConnector_ms": 0.008105754852294922, "ViewRequirementAgentConnector_ms": 0.1966249942779541}, "num_episodes": 31, "episode_return_max": -9.478252511116208, "episode_return_min": -1523.4511139540416, "episode_return_mean": -813.1449260462457, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000, "num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.20581115429445, "num_env_steps_trained_throughput_per_sec": 308.20581115429445, "timesteps_total": 56000, "num_env_steps_sampled_lifetime": 56000, "num_agent_steps_sampled_lifetime": 56000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 56000, "timers": {"training_iteration_time_ms": 12278.651, "restore_workers_time_ms": 0.029, "training_step_time_ms": 12278.578, "sample_time_ms": 1129.382, "learn_time_ms": 11083.984, "learn_throughput": 360.881, "synch_weights_time_ms": 64.329}, "counters": {"num_env_steps_sampled": 56000, "num_env_steps_trained": 56000, "num_agent_steps_sampled": 56000, "num_agent_steps_trained": 56000}, "done": false, "training_iteration": 14, "trial_id": "1a22e_00017", "date": "2024-08-04_07-05-05", "timestamp": 1722735305, "time_this_iter_s": 12.990456581115723, "time_total_s": 172.1914165019989, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237077e0e0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 172.1914165019989, "iterations_since_restore": 14, "perf": {"cpu_util_percent": 18.19473684210526, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 13.457803582648436, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 9.031848101317882, "policy_loss": -0.01595083555293968, "vf_loss": 9.05812727312247, "vf_explained_var": 0.48416942947854597, "kl": 0.0199980637004046, "entropy": 1.6327754067877929, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 13920.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "env_runners": {"episode_reward_max": -9.478252511116208, "episode_reward_min": -1523.4511139540416, "episode_reward_mean": -775.6518374260529, "episode_len_mean": 132.17, "episode_media": {}, "episodes_timesteps_total": 13217, "policy_reward_min": {"policy_0": -1523.4511139540416}, "policy_reward_max": {"policy_0": -9.478252511116208}, "policy_reward_mean": {"policy_0": -775.6518374260529}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-9.478252511116208, -18.055828202863655, -1384.4689382827398, -1332.769005590815, -1180.5402495232518, -908.5306945136851, -246.3493898363132, -771.7693771374422, -1389.477874331418, -516.7982098674988, -696.0956062779763, -1195.0161496017608, -735.9250764172612, -348.0010267004362, -347.17041984158953, -1179.865699529798, -110.3625172288279, -729.3164324992745, -1200.8209685504432, -80.01844845472854, -167.61611002372194, -741.1496876466632, -1115.8522267654137, -1095.7759661345995, -1523.4511139540416, -1253.8510165290977, -581.8398784828754, -806.9348592170645, -1294.2886098651927, -1344.8719029969814, -824.7338991732598, -1054.5939685638177, -567.15406831327, -890.632542334782, -551.4279563361728, -1088.3923583009016, -1004.3176828609232, -380.73925056677984, -235.0405940613315, -142.84169483867964, -1381.811686661466, -623.4036295952959, -793.0148825538603, -1338.935179206427, -705.4267278474607, -728.6176345580218, -1282.7278778204814, -435.84709203523545, -1325.662992311025, -1056.1561225545333, -23.712052232530148, -15.307610056825611, -490.761340907597, -1128.8208783912962, -1193.9511514042954, -567.8460320026758, -166.35636252926312, -1473.7455926715872, -1165.1289571257237, -1070.389992569929, -1250.741204029028, -747.2878819143763, -1164.1424360572273, -626.9935105615958, -1055.9505004962614, -1120.8535413808597, -1418.7219520208398, -1060.0163544172192, -1090.783097467517, -896.82056988721, -120.95545239406849, -1026.169862606368, -928.7293970086878, -605.7284620650584, -1224.494412370704, -345.0477410420373, -318.9110368064637, -546.9608157931613, -48.35744359830535, -309.49322394586835, -452.74364365423844, -800.8111790181366, -39.016924743802825, -426.68450431918075, -1348.2279734459796, -254.17198063143817, -1016.5377916200599, -1034.1759721922626, -872.4250889788273, -30.894081765320003, -1030.4552209639842, -644.6595165228086, -489.3058499435565, -978.875860027442, -1061.9969175352476, -836.3714665301334, -242.14848511733584, -478.1068625695603, -489.89210170852186, -1116.5640785542598], "episode_lengths": [34, 35, 150, 150, 150, 150, 68, 150, 150, 113, 150, 150, 129, 150, 150, 150, 75, 150, 150, 50, 55, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 85, 72, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 41, 47, 113, 150, 150, 123, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 121, 150, 150, 150, 150, 53, 86, 150, 150, 45, 150, 150, 72, 150, 150, 150, 47, 150, 150, 101, 150, 150, 150, 88, 150, 150, 150], "policy_policy_0_reward": [-9.478252511116208, -18.055828202863655, -1384.4689382827398, -1332.769005590815, -1180.5402495232518, -908.5306945136851, -246.3493898363132, -771.7693771374422, -1389.477874331418, -516.7982098674988, -696.0956062779763, -1195.0161496017608, -735.9250764172612, -348.0010267004362, -347.17041984158953, -1179.865699529798, -110.3625172288279, -729.3164324992745, -1200.8209685504432, -80.01844845472854, -167.61611002372194, -741.1496876466632, -1115.8522267654137, -1095.7759661345995, -1523.4511139540416, -1253.8510165290977, -581.8398784828754, -806.9348592170645, -1294.2886098651927, -1344.8719029969814, -824.7338991732598, -1054.5939685638177, -567.15406831327, -890.632542334782, -551.4279563361728, -1088.3923583009016, -1004.3176828609232, -380.73925056677984, -235.0405940613315, -142.84169483867964, -1381.811686661466, -623.4036295952959, -793.0148825538603, -1338.935179206427, -705.4267278474607, -728.6176345580218, -1282.7278778204814, -435.84709203523545, -1325.662992311025, -1056.1561225545333, -23.712052232530148, -15.307610056825611, -490.761340907597, -1128.8208783912962, -1193.9511514042954, -567.8460320026758, -166.35636252926312, -1473.7455926715872, -1165.1289571257237, -1070.389992569929, -1250.741204029028, -747.2878819143763, -1164.1424360572273, -626.9935105615958, -1055.9505004962614, -1120.8535413808597, -1418.7219520208398, -1060.0163544172192, -1090.783097467517, -896.82056988721, -120.95545239406849, -1026.169862606368, -928.7293970086878, -605.7284620650584, -1224.494412370704, -345.0477410420373, -318.9110368064637, -546.9608157931613, -48.35744359830535, -309.49322394586835, -452.74364365423844, -800.8111790181366, -39.016924743802825, -426.68450431918075, -1348.2279734459796, -254.17198063143817, -1016.5377916200599, -1034.1759721922626, -872.4250889788273, -30.894081765320003, -1030.4552209639842, -644.6595165228086, -489.3058499435565, -978.875860027442, -1061.9969175352476, -836.3714665301334, -242.14848511733584, -478.1068625695603, -489.89210170852186, -1116.5640785542598]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5549460744166282, "mean_inference_ms": 1.671181071151877, "mean_action_processing_ms": 0.2763208222951099, "mean_env_wait_ms": 3.4778650734461447, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012136220932006836, "StateBufferConnector_ms": 0.007931709289550781, "ViewRequirementAgentConnector_ms": 0.1951889991760254}, "num_episodes": 28, "episode_return_max": -9.478252511116208, "episode_return_min": -1523.4511139540416, "episode_return_mean": -775.6518374260529, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000, "num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.5976945088136, "num_env_steps_trained_throughput_per_sec": 314.5976945088136, "timesteps_total": 60000, "num_env_steps_sampled_lifetime": 60000, "num_agent_steps_sampled_lifetime": 60000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 60000, "timers": {"training_iteration_time_ms": 12632.745, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12632.667, "sample_time_ms": 1130.693, "learn_time_ms": 11435.835, "learn_throughput": 349.778, "synch_weights_time_ms": 65.25}, "counters": {"num_env_steps_sampled": 60000, "num_env_steps_trained": 60000, "num_agent_steps_sampled": 60000, "num_agent_steps_trained": 60000}, "done": false, "training_iteration": 15, "trial_id": "1a22e_00017", "date": "2024-08-04_07-05-17", "timestamp": 1722735317, "time_this_iter_s": 12.72635531425476, "time_total_s": 184.91777181625366, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370879ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 184.91777181625366, "iterations_since_restore": 15, "perf": {"cpu_util_percent": 18.67777777777778, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 18.063718373080096, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.910058470567067, "policy_loss": -0.01037594359901656, "vf_loss": 8.932513485352198, "vf_explained_var": 0.49934648387134073, "kl": 0.01656813927981299, "entropy": 1.7049513957152764, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 14880.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "env_runners": {"episode_reward_max": -15.307610056825611, "episode_reward_min": -1473.7455926715872, "episode_reward_mean": -756.3932076206189, "episode_len_mean": 135.06, "episode_media": {}, "episodes_timesteps_total": 13506, "policy_reward_min": {"policy_0": -1473.7455926715872}, "policy_reward_max": {"policy_0": -15.307610056825611}, "policy_reward_mean": {"policy_0": -756.3932076206189}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-567.15406831327, -890.632542334782, -551.4279563361728, -1088.3923583009016, -1004.3176828609232, -380.73925056677984, -235.0405940613315, -142.84169483867964, -1381.811686661466, -623.4036295952959, -793.0148825538603, -1338.935179206427, -705.4267278474607, -728.6176345580218, -1282.7278778204814, -435.84709203523545, -1325.662992311025, -1056.1561225545333, -23.712052232530148, -15.307610056825611, -490.761340907597, -1128.8208783912962, -1193.9511514042954, -567.8460320026758, -166.35636252926312, -1473.7455926715872, -1165.1289571257237, -1070.389992569929, -1250.741204029028, -747.2878819143763, -1164.1424360572273, -626.9935105615958, -1055.9505004962614, -1120.8535413808597, -1418.7219520208398, -1060.0163544172192, -1090.783097467517, -896.82056988721, -120.95545239406849, -1026.169862606368, -928.7293970086878, -605.7284620650584, -1224.494412370704, -345.0477410420373, -318.9110368064637, -546.9608157931613, -48.35744359830535, -309.49322394586835, -452.74364365423844, -800.8111790181366, -39.016924743802825, -426.68450431918075, -1348.2279734459796, -254.17198063143817, -1016.5377916200599, -1034.1759721922626, -872.4250889788273, -30.894081765320003, -1030.4552209639842, -644.6595165228086, -489.3058499435565, -978.875860027442, -1061.9969175352476, -836.3714665301334, -242.14848511733584, -478.1068625695603, -489.89210170852186, -1116.5640785542598, -1260.9591550713508, -1236.8061136460858, -546.6052512499716, -84.58025677353609, -1248.4820185092742, -1460.5588403030904, -245.44962217277683, -537.0762366130947, -1457.2081977070006, -499.61574663019934, -467.1433103008738, -1469.6524865675099, -153.74446285073017, -544.5371524852465, -1257.0718302330397, -924.1456653277404, -545.5148872746958, -1008.1287943587748, -678.0129966820178, -1232.7486738266182, -454.99187424273384, -574.7668217386141, -153.93377856332958, -739.9595153901539, -400.7636968221974, -499.78955276436443, -250.182130837282, -545.2078594907476, -606.0364429030452, -716.4385681132286, -1102.7160446308865, -1357.0984396283675], "episode_lengths": [150, 150, 150, 150, 150, 150, 85, 72, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 41, 47, 113, 150, 150, 123, 103, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 121, 150, 150, 150, 150, 53, 86, 150, 150, 45, 150, 150, 72, 150, 150, 150, 47, 150, 150, 101, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 41, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 140, 150, 150, 74, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-567.15406831327, -890.632542334782, -551.4279563361728, -1088.3923583009016, -1004.3176828609232, -380.73925056677984, -235.0405940613315, -142.84169483867964, -1381.811686661466, -623.4036295952959, -793.0148825538603, -1338.935179206427, -705.4267278474607, -728.6176345580218, -1282.7278778204814, -435.84709203523545, -1325.662992311025, -1056.1561225545333, -23.712052232530148, -15.307610056825611, -490.761340907597, -1128.8208783912962, -1193.9511514042954, -567.8460320026758, -166.35636252926312, -1473.7455926715872, -1165.1289571257237, -1070.389992569929, -1250.741204029028, -747.2878819143763, -1164.1424360572273, -626.9935105615958, -1055.9505004962614, -1120.8535413808597, -1418.7219520208398, -1060.0163544172192, -1090.783097467517, -896.82056988721, -120.95545239406849, -1026.169862606368, -928.7293970086878, -605.7284620650584, -1224.494412370704, -345.0477410420373, -318.9110368064637, -546.9608157931613, -48.35744359830535, -309.49322394586835, -452.74364365423844, -800.8111790181366, -39.016924743802825, -426.68450431918075, -1348.2279734459796, -254.17198063143817, -1016.5377916200599, -1034.1759721922626, -872.4250889788273, -30.894081765320003, -1030.4552209639842, -644.6595165228086, -489.3058499435565, -978.875860027442, -1061.9969175352476, -836.3714665301334, -242.14848511733584, -478.1068625695603, -489.89210170852186, -1116.5640785542598, -1260.9591550713508, -1236.8061136460858, -546.6052512499716, -84.58025677353609, -1248.4820185092742, -1460.5588403030904, -245.44962217277683, -537.0762366130947, -1457.2081977070006, -499.61574663019934, -467.1433103008738, -1469.6524865675099, -153.74446285073017, -544.5371524852465, -1257.0718302330397, -924.1456653277404, -545.5148872746958, -1008.1287943587748, -678.0129966820178, -1232.7486738266182, -454.99187424273384, -574.7668217386141, -153.93377856332958, -739.9595153901539, -400.7636968221974, -499.78955276436443, -250.182130837282, -545.2078594907476, -606.0364429030452, -716.4385681132286, -1102.7160446308865, -1357.0984396283675]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5545271887944805, "mean_inference_ms": 1.6697665980415943, "mean_action_processing_ms": 0.276154982288692, "mean_env_wait_ms": 3.4828239718447493, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012076377868652344, "StateBufferConnector_ms": 0.00786280632019043, "ViewRequirementAgentConnector_ms": 0.20938730239868164}, "num_episodes": 32, "episode_return_max": -15.307610056825611, "episode_return_min": -1473.7455926715872, "episode_return_mean": -756.3932076206189, "episodes_this_iter": 32}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000, "num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 348.4644478412327, "num_env_steps_trained_throughput_per_sec": 348.4644478412327, "timesteps_total": 64000, "num_env_steps_sampled_lifetime": 64000, "num_agent_steps_sampled_lifetime": 64000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 64000, "timers": {"training_iteration_time_ms": 12472.527, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12472.448, "sample_time_ms": 1144.431, "learn_time_ms": 11261.082, "learn_throughput": 355.206, "synch_weights_time_ms": 66.05}, "counters": {"num_env_steps_sampled": 64000, "num_env_steps_trained": 64000, "num_agent_steps_sampled": 64000, "num_agent_steps_trained": 64000}, "done": false, "training_iteration": 16, "trial_id": "1a22e_00017", "date": "2024-08-04_07-05-29", "timestamp": 1722735329, "time_this_iter_s": 11.490955829620361, "time_total_s": 196.40872764587402, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370726dd0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 196.40872764587402, "iterations_since_restore": 16, "perf": {"cpu_util_percent": 19.247058823529414, "ram_util_percent": 28.1}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 21.01321749414007, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.703462943434715, "policy_loss": -0.013688584123156034, "vf_loss": 8.727478821078936, "vf_explained_var": 0.6089334516475599, "kl": 0.018071225655618642, "entropy": 1.574863879630963, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 15840.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "env_runners": {"episode_reward_max": -30.894081765320003, "episode_reward_min": -1486.1182371749458, "episode_reward_mean": -737.1235376638231, "episode_len_mean": 134.49, "episode_media": {}, "episodes_timesteps_total": 13449, "policy_reward_min": {"policy_0": -1486.1182371749458}, "policy_reward_max": {"policy_0": -30.894081765320003}, "policy_reward_mean": {"policy_0": -737.1235376638231}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-626.9935105615958, -1055.9505004962614, -1120.8535413808597, -1418.7219520208398, -1060.0163544172192, -1090.783097467517, -896.82056988721, -120.95545239406849, -1026.169862606368, -928.7293970086878, -605.7284620650584, -1224.494412370704, -345.0477410420373, -318.9110368064637, -546.9608157931613, -48.35744359830535, -309.49322394586835, -452.74364365423844, -800.8111790181366, -39.016924743802825, -426.68450431918075, -1348.2279734459796, -254.17198063143817, -1016.5377916200599, -1034.1759721922626, -872.4250889788273, -30.894081765320003, -1030.4552209639842, -644.6595165228086, -489.3058499435565, -978.875860027442, -1061.9969175352476, -836.3714665301334, -242.14848511733584, -478.1068625695603, -489.89210170852186, -1116.5640785542598, -1260.9591550713508, -1236.8061136460858, -546.6052512499716, -84.58025677353609, -1248.4820185092742, -1460.5588403030904, -245.44962217277683, -537.0762366130947, -1457.2081977070006, -499.61574663019934, -467.1433103008738, -1469.6524865675099, -153.74446285073017, -544.5371524852465, -1257.0718302330397, -924.1456653277404, -545.5148872746958, -1008.1287943587748, -678.0129966820178, -1232.7486738266182, -454.99187424273384, -574.7668217386141, -153.93377856332958, -739.9595153901539, -400.7636968221974, -499.78955276436443, -250.182130837282, -545.2078594907476, -606.0364429030452, -716.4385681132286, -1102.7160446308865, -1357.0984396283675, -1150.1912223991376, -1222.8803757176508, -107.56526344457076, -914.9218010359664, -428.66506974700457, -602.1630903417948, -624.0403483323709, -1204.9705845739074, -978.5899387930257, -1388.6990666871327, -132.72626871394198, -552.9202567303662, -1100.7096178005297, -386.64925728239336, -1265.3241701429556, -813.6458420734086, -1066.8079164035425, -78.57796595145967, -528.3693091092035, -532.847423045324, -839.412447757568, -1001.6542693680287, -836.7560065717247, -1125.8933621305011, -560.0466342847167, -1486.1182371749458, -132.3303337643317, -855.4395185366147, -793.3274031232576, -190.9062036404503, -160.2252642915818], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 121, 150, 150, 150, 150, 53, 86, 150, 150, 45, 150, 150, 72, 150, 150, 150, 47, 150, 150, 101, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 41, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 140, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 60, 64], "policy_policy_0_reward": [-626.9935105615958, -1055.9505004962614, -1120.8535413808597, -1418.7219520208398, -1060.0163544172192, -1090.783097467517, -896.82056988721, -120.95545239406849, -1026.169862606368, -928.7293970086878, -605.7284620650584, -1224.494412370704, -345.0477410420373, -318.9110368064637, -546.9608157931613, -48.35744359830535, -309.49322394586835, -452.74364365423844, -800.8111790181366, -39.016924743802825, -426.68450431918075, -1348.2279734459796, -254.17198063143817, -1016.5377916200599, -1034.1759721922626, -872.4250889788273, -30.894081765320003, -1030.4552209639842, -644.6595165228086, -489.3058499435565, -978.875860027442, -1061.9969175352476, -836.3714665301334, -242.14848511733584, -478.1068625695603, -489.89210170852186, -1116.5640785542598, -1260.9591550713508, -1236.8061136460858, -546.6052512499716, -84.58025677353609, -1248.4820185092742, -1460.5588403030904, -245.44962217277683, -537.0762366130947, -1457.2081977070006, -499.61574663019934, -467.1433103008738, -1469.6524865675099, -153.74446285073017, -544.5371524852465, -1257.0718302330397, -924.1456653277404, -545.5148872746958, -1008.1287943587748, -678.0129966820178, -1232.7486738266182, -454.99187424273384, -574.7668217386141, -153.93377856332958, -739.9595153901539, -400.7636968221974, -499.78955276436443, -250.182130837282, -545.2078594907476, -606.0364429030452, -716.4385681132286, -1102.7160446308865, -1357.0984396283675, -1150.1912223991376, -1222.8803757176508, -107.56526344457076, -914.9218010359664, -428.66506974700457, -602.1630903417948, -624.0403483323709, -1204.9705845739074, -978.5899387930257, -1388.6990666871327, -132.72626871394198, -552.9202567303662, -1100.7096178005297, -386.64925728239336, -1265.3241701429556, -813.6458420734086, -1066.8079164035425, -78.57796595145967, -528.3693091092035, -532.847423045324, -839.412447757568, -1001.6542693680287, -836.7560065717247, -1125.8933621305011, -560.0466342847167, -1486.1182371749458, -132.3303337643317, -855.4395185366147, -793.3274031232576, -190.9062036404503, -160.2252642915818]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538935762872585, "mean_inference_ms": 1.6700799508377948, "mean_action_processing_ms": 0.276541498768254, "mean_env_wait_ms": 3.4887107455068667, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012050151824951172, "StateBufferConnector_ms": 0.007816314697265625, "ViewRequirementAgentConnector_ms": 0.20911026000976562}, "num_episodes": 31, "episode_return_max": -30.894081765320003, "episode_return_min": -1486.1182371749458, "episode_return_mean": -737.1235376638231, "episodes_this_iter": 31}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000, "num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 297.0640930060518, "num_env_steps_trained_throughput_per_sec": 297.0640930060518, "timesteps_total": 68000, "num_env_steps_sampled_lifetime": 68000, "num_agent_steps_sampled_lifetime": 68000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 68000, "timers": {"training_iteration_time_ms": 12607.252, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12607.174, "sample_time_ms": 1161.378, "learn_time_ms": 11378.528, "learn_throughput": 351.539, "synch_weights_time_ms": 66.425}, "counters": {"num_env_steps_sampled": 68000, "num_env_steps_trained": 68000, "num_agent_steps_sampled": 68000, "num_agent_steps_trained": 68000}, "done": false, "training_iteration": 17, "trial_id": "1a22e_00017", "date": "2024-08-04_07-05-42", "timestamp": 1722735342, "time_this_iter_s": 13.478552103042603, "time_total_s": 209.88727974891663, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370726cb0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 209.88727974891663, "iterations_since_restore": 17, "perf": {"cpu_util_percent": 18.442105263157895, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.563462686662874, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.85148700972398, "policy_loss": -0.00782433913652009, "vf_loss": 8.86937968581915, "vf_explained_var": 0.6473715079948306, "kl": 0.01822419424791711, "entropy": 1.5535618325074514, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 16800.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "env_runners": {"episode_reward_max": -5.569662808628192, "episode_reward_min": -1486.1182371749458, "episode_reward_mean": -715.3284279911792, "episode_len_mean": 132.84, "episode_media": {}, "episodes_timesteps_total": 13284, "policy_reward_min": {"policy_0": -1486.1182371749458}, "policy_reward_max": {"policy_0": -5.569662808628192}, "policy_reward_mean": {"policy_0": -715.3284279911792}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-489.3058499435565, -978.875860027442, -1061.9969175352476, -836.3714665301334, -242.14848511733584, -478.1068625695603, -489.89210170852186, -1116.5640785542598, -1260.9591550713508, -1236.8061136460858, -546.6052512499716, -84.58025677353609, -1248.4820185092742, -1460.5588403030904, -245.44962217277683, -537.0762366130947, -1457.2081977070006, -499.61574663019934, -467.1433103008738, -1469.6524865675099, -153.74446285073017, -544.5371524852465, -1257.0718302330397, -924.1456653277404, -545.5148872746958, -1008.1287943587748, -678.0129966820178, -1232.7486738266182, -454.99187424273384, -574.7668217386141, -153.93377856332958, -739.9595153901539, -400.7636968221974, -499.78955276436443, -250.182130837282, -545.2078594907476, -606.0364429030452, -716.4385681132286, -1102.7160446308865, -1357.0984396283675, -1150.1912223991376, -1222.8803757176508, -107.56526344457076, -914.9218010359664, -428.66506974700457, -602.1630903417948, -624.0403483323709, -1204.9705845739074, -978.5899387930257, -1388.6990666871327, -132.72626871394198, -552.9202567303662, -1100.7096178005297, -386.64925728239336, -1265.3241701429556, -813.6458420734086, -1066.8079164035425, -78.57796595145967, -528.3693091092035, -532.847423045324, -839.412447757568, -1001.6542693680287, -836.7560065717247, -1125.8933621305011, -560.0466342847167, -1486.1182371749458, -132.3303337643317, -855.4395185366147, -793.3274031232576, -190.9062036404503, -160.2252642915818, -429.73272350049854, -1185.0848574284507, -254.6702139051604, -973.301852501157, -180.45845975777533, -259.0721970937431, -1072.789583732846, -695.0284247023791, -925.1370852020574, -844.1248167071018, -1266.7101692762217, -550.3573298582126, -601.0956124975147, -553.5605062020677, -449.36720212389923, -147.10802351489886, -867.4862822589745, -243.7490228236163, -1427.1315232412103, -112.30194351217628, -230.93260518657425, -1221.4612312013057, -392.66952186166714, -1484.1562301768506, -262.8934199177635, -807.0642391980148, -470.6190472110169, -602.6464970520739, -5.569662808628192], "episode_lengths": [101, 150, 150, 150, 88, 150, 150, 150, 150, 150, 150, 41, 150, 150, 150, 150, 150, 150, 150, 150, 82, 150, 150, 150, 150, 150, 150, 150, 150, 150, 61, 140, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 60, 64, 150, 150, 84, 150, 57, 76, 150, 150, 150, 150, 150, 150, 150, 150, 119, 96, 150, 75, 150, 79, 90, 150, 136, 150, 82, 150, 150, 150, 36], "policy_policy_0_reward": [-489.3058499435565, -978.875860027442, -1061.9969175352476, -836.3714665301334, -242.14848511733584, -478.1068625695603, -489.89210170852186, -1116.5640785542598, -1260.9591550713508, -1236.8061136460858, -546.6052512499716, -84.58025677353609, -1248.4820185092742, -1460.5588403030904, -245.44962217277683, -537.0762366130947, -1457.2081977070006, -499.61574663019934, -467.1433103008738, -1469.6524865675099, -153.74446285073017, -544.5371524852465, -1257.0718302330397, -924.1456653277404, -545.5148872746958, -1008.1287943587748, -678.0129966820178, -1232.7486738266182, -454.99187424273384, -574.7668217386141, -153.93377856332958, -739.9595153901539, -400.7636968221974, -499.78955276436443, -250.182130837282, -545.2078594907476, -606.0364429030452, -716.4385681132286, -1102.7160446308865, -1357.0984396283675, -1150.1912223991376, -1222.8803757176508, -107.56526344457076, -914.9218010359664, -428.66506974700457, -602.1630903417948, -624.0403483323709, -1204.9705845739074, -978.5899387930257, -1388.6990666871327, -132.72626871394198, -552.9202567303662, -1100.7096178005297, -386.64925728239336, -1265.3241701429556, -813.6458420734086, -1066.8079164035425, -78.57796595145967, -528.3693091092035, -532.847423045324, -839.412447757568, -1001.6542693680287, -836.7560065717247, -1125.8933621305011, -560.0466342847167, -1486.1182371749458, -132.3303337643317, -855.4395185366147, -793.3274031232576, -190.9062036404503, -160.2252642915818, -429.73272350049854, -1185.0848574284507, -254.6702139051604, -973.301852501157, -180.45845975777533, -259.0721970937431, -1072.789583732846, -695.0284247023791, -925.1370852020574, -844.1248167071018, -1266.7101692762217, -550.3573298582126, -601.0956124975147, -553.5605062020677, -449.36720212389923, -147.10802351489886, -867.4862822589745, -243.7490228236163, -1427.1315232412103, -112.30194351217628, -230.93260518657425, -1221.4612312013057, -392.66952186166714, -1484.1562301768506, -262.8934199177635, -807.0642391980148, -470.6190472110169, -602.6464970520739, -5.569662808628192]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5538834627232243, "mean_inference_ms": 1.6720263036944238, "mean_action_processing_ms": 0.27722193838183323, "mean_env_wait_ms": 3.4976381514892045, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012030839920043945, "StateBufferConnector_ms": 0.007875680923461914, "ViewRequirementAgentConnector_ms": 0.20834898948669434}, "num_episodes": 29, "episode_return_max": -5.569662808628192, "episode_return_min": -1486.1182371749458, "episode_return_mean": -715.3284279911792, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000, "num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 300.049625498106, "num_env_steps_trained_throughput_per_sec": 300.049625498106, "timesteps_total": 72000, "num_env_steps_sampled_lifetime": 72000, "num_agent_steps_sampled_lifetime": 72000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 72000, "timers": {"training_iteration_time_ms": 12651.448, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12651.369, "sample_time_ms": 1166.577, "learn_time_ms": 11417.014, "learn_throughput": 350.354, "synch_weights_time_ms": 66.935}, "counters": {"num_env_steps_sampled": 72000, "num_env_steps_trained": 72000, "num_agent_steps_sampled": 72000, "num_agent_steps_trained": 72000}, "done": false, "training_iteration": 18, "trial_id": "1a22e_00017", "date": "2024-08-04_07-05-56", "timestamp": 1722735356, "time_this_iter_s": 13.343945026397705, "time_total_s": 223.23122477531433, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370879ab0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 223.23122477531433, "iterations_since_restore": 18, "perf": {"cpu_util_percent": 18.336842105263155, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 22.791714276373387, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.716101282338302, "policy_loss": -0.011575955883017741, "vf_loss": 8.738585616151491, "vf_explained_var": 0.6358546209832032, "kl": 0.01912493369248601, "entropy": 1.6645871416976055, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 17760.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "env_runners": {"episode_reward_max": -5.569662808628192, "episode_reward_min": -1486.1182371749458, "episode_reward_mean": -698.2183415381742, "episode_len_mean": 130.2, "episode_media": {}, "episodes_timesteps_total": 13020, "policy_reward_min": {"policy_0": -1486.1182371749458}, "policy_reward_max": {"policy_0": -5.569662808628192}, "policy_reward_mean": {"policy_0": -698.2183415381742}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-153.93377856332958, -739.9595153901539, -400.7636968221974, -499.78955276436443, -250.182130837282, -545.2078594907476, -606.0364429030452, -716.4385681132286, -1102.7160446308865, -1357.0984396283675, -1150.1912223991376, -1222.8803757176508, -107.56526344457076, -914.9218010359664, -428.66506974700457, -602.1630903417948, -624.0403483323709, -1204.9705845739074, -978.5899387930257, -1388.6990666871327, -132.72626871394198, -552.9202567303662, -1100.7096178005297, -386.64925728239336, -1265.3241701429556, -813.6458420734086, -1066.8079164035425, -78.57796595145967, -528.3693091092035, -532.847423045324, -839.412447757568, -1001.6542693680287, -836.7560065717247, -1125.8933621305011, -560.0466342847167, -1486.1182371749458, -132.3303337643317, -855.4395185366147, -793.3274031232576, -190.9062036404503, -160.2252642915818, -429.73272350049854, -1185.0848574284507, -254.6702139051604, -973.301852501157, -180.45845975777533, -259.0721970937431, -1072.789583732846, -695.0284247023791, -925.1370852020574, -844.1248167071018, -1266.7101692762217, -550.3573298582126, -601.0956124975147, -553.5605062020677, -449.36720212389923, -147.10802351489886, -867.4862822589745, -243.7490228236163, -1427.1315232412103, -112.30194351217628, -230.93260518657425, -1221.4612312013057, -392.66952186166714, -1484.1562301768506, -262.8934199177635, -807.0642391980148, -470.6190472110169, -602.6464970520739, -5.569662808628192, -662.5283719252028, -1062.368351142632, -801.9727334518435, -1070.6337611180427, -1281.8803687964637, -562.1136478121639, -1258.768413326929, -502.96328369462344, -104.8500739240149, -1125.1372613280691, -914.5756425117627, -1134.4802697838281, -661.063565247388, -28.87246243587321, -1140.2736827648798, -34.03967902403965, -1067.2793780990958, -945.5001916073206, -453.81876455934764, -956.5267557616808, -901.7236982214544, -576.9628375090288, -46.55824224605717, -180.91525606942255, -291.31879345925853, -1217.896450694784, -476.7677732137969, -523.7841792684932, -784.4197459878623, -1100.0597362651883], "episode_lengths": [61, 140, 150, 150, 74, 150, 150, 150, 150, 150, 150, 150, 56, 150, 150, 150, 150, 150, 150, 150, 55, 150, 150, 150, 150, 150, 150, 61, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 60, 64, 150, 150, 84, 150, 57, 76, 150, 150, 150, 150, 150, 150, 150, 150, 119, 96, 150, 75, 150, 79, 90, 150, 136, 150, 82, 150, 150, 150, 36, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 47, 150, 49, 150, 150, 110, 150, 150, 115, 62, 63, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-153.93377856332958, -739.9595153901539, -400.7636968221974, -499.78955276436443, -250.182130837282, -545.2078594907476, -606.0364429030452, -716.4385681132286, -1102.7160446308865, -1357.0984396283675, -1150.1912223991376, -1222.8803757176508, -107.56526344457076, -914.9218010359664, -428.66506974700457, -602.1630903417948, -624.0403483323709, -1204.9705845739074, -978.5899387930257, -1388.6990666871327, -132.72626871394198, -552.9202567303662, -1100.7096178005297, -386.64925728239336, -1265.3241701429556, -813.6458420734086, -1066.8079164035425, -78.57796595145967, -528.3693091092035, -532.847423045324, -839.412447757568, -1001.6542693680287, -836.7560065717247, -1125.8933621305011, -560.0466342847167, -1486.1182371749458, -132.3303337643317, -855.4395185366147, -793.3274031232576, -190.9062036404503, -160.2252642915818, -429.73272350049854, -1185.0848574284507, -254.6702139051604, -973.301852501157, -180.45845975777533, -259.0721970937431, -1072.789583732846, -695.0284247023791, -925.1370852020574, -844.1248167071018, -1266.7101692762217, -550.3573298582126, -601.0956124975147, -553.5605062020677, -449.36720212389923, -147.10802351489886, -867.4862822589745, -243.7490228236163, -1427.1315232412103, -112.30194351217628, -230.93260518657425, -1221.4612312013057, -392.66952186166714, -1484.1562301768506, -262.8934199177635, -807.0642391980148, -470.6190472110169, -602.6464970520739, -5.569662808628192, -662.5283719252028, -1062.368351142632, -801.9727334518435, -1070.6337611180427, -1281.8803687964637, -562.1136478121639, -1258.768413326929, -502.96328369462344, -104.8500739240149, -1125.1372613280691, -914.5756425117627, -1134.4802697838281, -661.063565247388, -28.87246243587321, -1140.2736827648798, -34.03967902403965, -1067.2793780990958, -945.5001916073206, -453.81876455934764, -956.5267557616808, -901.7236982214544, -576.9628375090288, -46.55824224605717, -180.91525606942255, -291.31879345925853, -1217.896450694784, -476.7677732137969, -523.7841792684932, -784.4197459878623, -1100.0597362651883]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532614113502942, "mean_inference_ms": 1.6721997880334027, "mean_action_processing_ms": 0.27755952418582047, "mean_env_wait_ms": 3.4993546162372366, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011708259582519531, "StateBufferConnector_ms": 0.007856130599975586, "ViewRequirementAgentConnector_ms": 0.19142580032348633}, "num_episodes": 30, "episode_return_max": -5.569662808628192, "episode_return_min": -1486.1182371749458, "episode_return_mean": -698.2183415381742, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000, "num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 304.7479545076396, "num_env_steps_trained_throughput_per_sec": 304.7479545076396, "timesteps_total": 76000, "num_env_steps_sampled_lifetime": 76000, "num_agent_steps_sampled_lifetime": 76000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 76000, "timers": {"training_iteration_time_ms": 12662.95, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12662.869, "sample_time_ms": 1173.737, "learn_time_ms": 11421.693, "learn_throughput": 350.211, "synch_weights_time_ms": 66.556}, "counters": {"num_env_steps_sampled": 76000, "num_env_steps_trained": 76000, "num_agent_steps_sampled": 76000, "num_agent_steps_trained": 76000}, "done": false, "training_iteration": 19, "trial_id": "1a22e_00017", "date": "2024-08-04_07-06-09", "timestamp": 1722735369, "time_this_iter_s": 13.138251543045044, "time_total_s": 236.36947631835938, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237077f640>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 236.36947631835938, "iterations_since_restore": 19, "perf": {"cpu_util_percent": 18.55263157894737, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 25.419360615809758, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.552186644574006, "policy_loss": -0.017063882579289688, "vf_loss": 8.580347490807375, "vf_explained_var": 0.6203680289288361, "kl": 0.01960766754024616, "entropy": 1.6979251503944397, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 18720.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "env_runners": {"episode_reward_max": -5.569662808628192, "episode_reward_min": -1486.1182371749458, "episode_reward_mean": -663.9995815566293, "episode_len_mean": 130.7, "episode_media": {}, "episodes_timesteps_total": 13070, "policy_reward_min": {"policy_0": -1486.1182371749458}, "policy_reward_max": {"policy_0": -5.569662808628192}, "policy_reward_mean": {"policy_0": -663.9995815566293}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-528.3693091092035, -532.847423045324, -839.412447757568, -1001.6542693680287, -836.7560065717247, -1125.8933621305011, -560.0466342847167, -1486.1182371749458, -132.3303337643317, -855.4395185366147, -793.3274031232576, -190.9062036404503, -160.2252642915818, -429.73272350049854, -1185.0848574284507, -254.6702139051604, -973.301852501157, -180.45845975777533, -259.0721970937431, -1072.789583732846, -695.0284247023791, -925.1370852020574, -844.1248167071018, -1266.7101692762217, -550.3573298582126, -601.0956124975147, -553.5605062020677, -449.36720212389923, -147.10802351489886, -867.4862822589745, -243.7490228236163, -1427.1315232412103, -112.30194351217628, -230.93260518657425, -1221.4612312013057, -392.66952186166714, -1484.1562301768506, -262.8934199177635, -807.0642391980148, -470.6190472110169, -602.6464970520739, -5.569662808628192, -662.5283719252028, -1062.368351142632, -801.9727334518435, -1070.6337611180427, -1281.8803687964637, -562.1136478121639, -1258.768413326929, -502.96328369462344, -104.8500739240149, -1125.1372613280691, -914.5756425117627, -1134.4802697838281, -661.063565247388, -28.87246243587321, -1140.2736827648798, -34.03967902403965, -1067.2793780990958, -945.5001916073206, -453.81876455934764, -956.5267557616808, -901.7236982214544, -576.9628375090288, -46.55824224605717, -180.91525606942255, -291.31879345925853, -1217.896450694784, -476.7677732137969, -523.7841792684932, -784.4197459878623, -1100.0597362651883, -448.75873177328685, -783.8949622834872, -439.71125400815964, -135.5853322847801, -1437.5009939265533, -427.84379562766964, -715.4767168917524, -501.093727184558, -440.25492049489105, -520.3359876737145, -68.1654650172821, -59.224914583409095, -561.2771739052725, -971.6615771429634, -782.7624087884319, -644.9681527167259, -1021.1251468743433, -712.3255169736858, -526.2594921038401, -1403.378364600876, -463.74893519211787, -501.9184181979753, -552.8586585047912, -375.7824232803507, -1134.295644228824, -585.520920096829, -331.9432596500592, -422.625193153649], "episode_lengths": [150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 60, 64, 150, 150, 84, 150, 57, 76, 150, 150, 150, 150, 150, 150, 150, 150, 119, 96, 150, 75, 150, 79, 90, 150, 136, 150, 82, 150, 150, 150, 36, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 47, 150, 49, 150, 150, 110, 150, 150, 115, 62, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 123, 150, 150, 150, 60, 55, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 132, 106, 150], "policy_policy_0_reward": [-528.3693091092035, -532.847423045324, -839.412447757568, -1001.6542693680287, -836.7560065717247, -1125.8933621305011, -560.0466342847167, -1486.1182371749458, -132.3303337643317, -855.4395185366147, -793.3274031232576, -190.9062036404503, -160.2252642915818, -429.73272350049854, -1185.0848574284507, -254.6702139051604, -973.301852501157, -180.45845975777533, -259.0721970937431, -1072.789583732846, -695.0284247023791, -925.1370852020574, -844.1248167071018, -1266.7101692762217, -550.3573298582126, -601.0956124975147, -553.5605062020677, -449.36720212389923, -147.10802351489886, -867.4862822589745, -243.7490228236163, -1427.1315232412103, -112.30194351217628, -230.93260518657425, -1221.4612312013057, -392.66952186166714, -1484.1562301768506, -262.8934199177635, -807.0642391980148, -470.6190472110169, -602.6464970520739, -5.569662808628192, -662.5283719252028, -1062.368351142632, -801.9727334518435, -1070.6337611180427, -1281.8803687964637, -562.1136478121639, -1258.768413326929, -502.96328369462344, -104.8500739240149, -1125.1372613280691, -914.5756425117627, -1134.4802697838281, -661.063565247388, -28.87246243587321, -1140.2736827648798, -34.03967902403965, -1067.2793780990958, -945.5001916073206, -453.81876455934764, -956.5267557616808, -901.7236982214544, -576.9628375090288, -46.55824224605717, -180.91525606942255, -291.31879345925853, -1217.896450694784, -476.7677732137969, -523.7841792684932, -784.4197459878623, -1100.0597362651883, -448.75873177328685, -783.8949622834872, -439.71125400815964, -135.5853322847801, -1437.5009939265533, -427.84379562766964, -715.4767168917524, -501.093727184558, -440.25492049489105, -520.3359876737145, -68.1654650172821, -59.224914583409095, -561.2771739052725, -971.6615771429634, -782.7624087884319, -644.9681527167259, -1021.1251468743433, -712.3255169736858, -526.2594921038401, -1403.378364600876, -463.74893519211787, -501.9184181979753, -552.8586585047912, -375.7824232803507, -1134.295644228824, -585.520920096829, -331.9432596500592, -422.625193153649]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5534558927605511, "mean_inference_ms": 1.6728513263356377, "mean_action_processing_ms": 0.277546551640104, "mean_env_wait_ms": 3.498312815787794, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011864423751831055, "StateBufferConnector_ms": 0.007972478866577148, "ViewRequirementAgentConnector_ms": 0.19188833236694336}, "num_episodes": 28, "episode_return_max": -5.569662808628192, "episode_return_min": -1486.1182371749458, "episode_return_mean": -663.9995815566293, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000, "num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.63625682996326, "num_env_steps_trained_throughput_per_sec": 308.63625682996326, "timesteps_total": 80000, "num_env_steps_sampled_lifetime": 80000, "num_agent_steps_sampled_lifetime": 80000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 80000, "timers": {"training_iteration_time_ms": 12732.861, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12732.782, "sample_time_ms": 1173.712, "learn_time_ms": 11492.947, "learn_throughput": 348.04, "synch_weights_time_ms": 65.251}, "counters": {"num_env_steps_sampled": 80000, "num_env_steps_trained": 80000, "num_agent_steps_sampled": 80000, "num_agent_steps_trained": 80000}, "done": false, "training_iteration": 20, "trial_id": "1a22e_00017", "date": "2024-08-04_07-06-22", "timestamp": 1722735382, "time_this_iter_s": 12.972243547439575, "time_total_s": 249.34171986579895, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237080aef0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 249.34171986579895, "iterations_since_restore": 20, "perf": {"cpu_util_percent": 18.672222222222224, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 30.842542375375828, "cur_kl_coeff": 0.29999999999999993, "cur_lr": 0.0010000000000000005, "total_loss": 8.41635794242223, "policy_loss": -0.010275946317900282, "vf_loss": 8.438252895077069, "vf_explained_var": 0.5673708484818538, "kl": 0.02314639124345682, "entropy": 1.856292120863994, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 19680.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "env_runners": {"episode_reward_max": -5.569662808628192, "episode_reward_min": -1528.8481789276034, "episode_reward_mean": -718.4909857833234, "episode_len_mean": 134.5, "episode_media": {}, "episodes_timesteps_total": 13450, "policy_reward_min": {"policy_0": -1528.8481789276034}, "policy_reward_max": {"policy_0": -5.569662808628192}, "policy_reward_mean": {"policy_0": -718.4909857833234}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-867.4862822589745, -243.7490228236163, -1427.1315232412103, -112.30194351217628, -230.93260518657425, -1221.4612312013057, -392.66952186166714, -1484.1562301768506, -262.8934199177635, -807.0642391980148, -470.6190472110169, -602.6464970520739, -5.569662808628192, -662.5283719252028, -1062.368351142632, -801.9727334518435, -1070.6337611180427, -1281.8803687964637, -562.1136478121639, -1258.768413326929, -502.96328369462344, -104.8500739240149, -1125.1372613280691, -914.5756425117627, -1134.4802697838281, -661.063565247388, -28.87246243587321, -1140.2736827648798, -34.03967902403965, -1067.2793780990958, -945.5001916073206, -453.81876455934764, -956.5267557616808, -901.7236982214544, -576.9628375090288, -46.55824224605717, -180.91525606942255, -291.31879345925853, -1217.896450694784, -476.7677732137969, -523.7841792684932, -784.4197459878623, -1100.0597362651883, -448.75873177328685, -783.8949622834872, -439.71125400815964, -135.5853322847801, -1437.5009939265533, -427.84379562766964, -715.4767168917524, -501.093727184558, -440.25492049489105, -520.3359876737145, -68.1654650172821, -59.224914583409095, -561.2771739052725, -971.6615771429634, -782.7624087884319, -644.9681527167259, -1021.1251468743433, -712.3255169736858, -526.2594921038401, -1403.378364600876, -463.74893519211787, -501.9184181979753, -552.8586585047912, -375.7824232803507, -1134.295644228824, -585.520920096829, -331.9432596500592, -422.625193153649, -665.2991705086957, -525.6020213137432, -652.3331358188796, -749.1858141246289, -308.0961556389035, -1047.2282657377937, -1035.436243320837, -764.7412402560284, -1058.2848973404234, -1390.2595733891637, -1393.214547718279, -1002.9574709707113, -1002.0222187144253, -629.4359290890465, -423.4582458778091, -1038.295496722545, -68.6998122364134, -609.038662094299, -732.4684103626709, -701.8812154942567, -483.4265974387686, -1150.309426225551, -1379.6832848818103, -446.65322172357907, -922.8646021428791, -1193.828958031291, -697.0158067039707, -1528.8481789276034, -1279.497290666643], "episode_lengths": [150, 75, 150, 79, 90, 150, 136, 150, 82, 150, 150, 150, 36, 150, 150, 150, 150, 150, 150, 150, 150, 52, 150, 150, 150, 150, 47, 150, 49, 150, 150, 110, 150, 150, 115, 62, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 123, 150, 150, 150, 60, 55, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 132, 106, 150, 150, 150, 150, 150, 81, 150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150], "policy_policy_0_reward": [-867.4862822589745, -243.7490228236163, -1427.1315232412103, -112.30194351217628, -230.93260518657425, -1221.4612312013057, -392.66952186166714, -1484.1562301768506, -262.8934199177635, -807.0642391980148, -470.6190472110169, -602.6464970520739, -5.569662808628192, -662.5283719252028, -1062.368351142632, -801.9727334518435, -1070.6337611180427, -1281.8803687964637, -562.1136478121639, -1258.768413326929, -502.96328369462344, -104.8500739240149, -1125.1372613280691, -914.5756425117627, -1134.4802697838281, -661.063565247388, -28.87246243587321, -1140.2736827648798, -34.03967902403965, -1067.2793780990958, -945.5001916073206, -453.81876455934764, -956.5267557616808, -901.7236982214544, -576.9628375090288, -46.55824224605717, -180.91525606942255, -291.31879345925853, -1217.896450694784, -476.7677732137969, -523.7841792684932, -784.4197459878623, -1100.0597362651883, -448.75873177328685, -783.8949622834872, -439.71125400815964, -135.5853322847801, -1437.5009939265533, -427.84379562766964, -715.4767168917524, -501.093727184558, -440.25492049489105, -520.3359876737145, -68.1654650172821, -59.224914583409095, -561.2771739052725, -971.6615771429634, -782.7624087884319, -644.9681527167259, -1021.1251468743433, -712.3255169736858, -526.2594921038401, -1403.378364600876, -463.74893519211787, -501.9184181979753, -552.8586585047912, -375.7824232803507, -1134.295644228824, -585.520920096829, -331.9432596500592, -422.625193153649, -665.2991705086957, -525.6020213137432, -652.3331358188796, -749.1858141246289, -308.0961556389035, -1047.2282657377937, -1035.436243320837, -764.7412402560284, -1058.2848973404234, -1390.2595733891637, -1393.214547718279, -1002.9574709707113, -1002.0222187144253, -629.4359290890465, -423.4582458778091, -1038.295496722545, -68.6998122364134, -609.038662094299, -732.4684103626709, -701.8812154942567, -483.4265974387686, -1150.309426225551, -1379.6832848818103, -446.65322172357907, -922.8646021428791, -1193.828958031291, -697.0158067039707, -1528.8481789276034, -1279.497290666643]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533700905968306, "mean_inference_ms": 1.67273197196202, "mean_action_processing_ms": 0.2771339847175292, "mean_env_wait_ms": 3.500757294555218, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.011974096298217773, "StateBufferConnector_ms": 0.007982492446899414, "ViewRequirementAgentConnector_ms": 0.19391942024230957}, "num_episodes": 29, "episode_return_max": -5.569662808628192, "episode_return_min": -1528.8481789276034, "episode_return_mean": -718.4909857833234, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000, "num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.02303476646136, "num_env_steps_trained_throughput_per_sec": 308.02303476646136, "timesteps_total": 84000, "num_env_steps_sampled_lifetime": 84000, "num_agent_steps_sampled_lifetime": 84000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 84000, "timers": {"training_iteration_time_ms": 12711.143, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12711.066, "sample_time_ms": 1176.879, "learn_time_ms": 11467.313, "learn_throughput": 348.818, "synch_weights_time_ms": 66.004}, "counters": {"num_env_steps_sampled": 84000, "num_env_steps_trained": 84000, "num_agent_steps_sampled": 84000, "num_agent_steps_trained": 84000}, "done": false, "training_iteration": 21, "trial_id": "1a22e_00017", "date": "2024-08-04_07-06-35", "timestamp": 1722735395, "time_this_iter_s": 12.99913740158081, "time_total_s": 262.34085726737976, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x79237077c700>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 262.34085726737976, "iterations_since_restore": 21, "perf": {"cpu_util_percent": 17.76111111111111, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 23.20596601019303, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.51578484326601, "policy_loss": -0.010515231838993108, "vf_loss": 8.536748852332433, "vf_explained_var": 0.6288745679582158, "kl": 0.01867360697603244, "entropy": 1.8851883324484031, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 20640.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "env_runners": {"episode_reward_max": -41.56680101180433, "episode_reward_min": -1528.8481789276034, "episode_reward_mean": -717.977337679981, "episode_len_mean": 136.77, "episode_media": {}, "episodes_timesteps_total": 13677, "policy_reward_min": {"policy_0": -1528.8481789276034}, "policy_reward_max": {"policy_0": -41.56680101180433}, "policy_reward_mean": {"policy_0": -717.977337679981}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-945.5001916073206, -453.81876455934764, -956.5267557616808, -901.7236982214544, -576.9628375090288, -46.55824224605717, -180.91525606942255, -291.31879345925853, -1217.896450694784, -476.7677732137969, -523.7841792684932, -784.4197459878623, -1100.0597362651883, -448.75873177328685, -783.8949622834872, -439.71125400815964, -135.5853322847801, -1437.5009939265533, -427.84379562766964, -715.4767168917524, -501.093727184558, -440.25492049489105, -520.3359876737145, -68.1654650172821, -59.224914583409095, -561.2771739052725, -971.6615771429634, -782.7624087884319, -644.9681527167259, -1021.1251468743433, -712.3255169736858, -526.2594921038401, -1403.378364600876, -463.74893519211787, -501.9184181979753, -552.8586585047912, -375.7824232803507, -1134.295644228824, -585.520920096829, -331.9432596500592, -422.625193153649, -665.2991705086957, -525.6020213137432, -652.3331358188796, -749.1858141246289, -308.0961556389035, -1047.2282657377937, -1035.436243320837, -764.7412402560284, -1058.2848973404234, -1390.2595733891637, -1393.214547718279, -1002.9574709707113, -1002.0222187144253, -629.4359290890465, -423.4582458778091, -1038.295496722545, -68.6998122364134, -609.038662094299, -732.4684103626709, -701.8812154942567, -483.4265974387686, -1150.309426225551, -1379.6832848818103, -446.65322172357907, -922.8646021428791, -1193.828958031291, -697.0158067039707, -1528.8481789276034, -1279.497290666643, -672.8925500006018, -1054.7194963550678, -573.4124947414485, -609.5922539448637, -802.1717962323135, -1126.9831976718583, -436.31751386086034, -653.1477045238232, -521.9550208507627, -1199.8056690249732, -1416.5626772748492, -41.56680101180433, -493.3719367456703, -514.4178573021853, -1283.841462180958, -57.90134901337839, -66.84621671512, -496.8093970663961, -1114.3145892452314, -1077.5186027437564, -489.1528880433534, -1468.833637397489, -628.2365105123464, -1133.3283934965473, -78.1574036632485, -125.71051027768667, -936.6141673019392, -593.0821960785828, -1087.731538615427, -736.1215306099349], "episode_lengths": [150, 110, 150, 150, 115, 62, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 57, 150, 150, 123, 150, 150, 150, 60, 55, 150, 150, 150, 150, 150, 150, 150, 150, 114, 150, 150, 150, 150, 132, 106, 150, 150, 150, 150, 150, 81, 150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 56, 66, 150, 150, 150, 150, 150, 150, 150, 41, 63, 150, 150, 150, 150], "policy_policy_0_reward": [-945.5001916073206, -453.81876455934764, -956.5267557616808, -901.7236982214544, -576.9628375090288, -46.55824224605717, -180.91525606942255, -291.31879345925853, -1217.896450694784, -476.7677732137969, -523.7841792684932, -784.4197459878623, -1100.0597362651883, -448.75873177328685, -783.8949622834872, -439.71125400815964, -135.5853322847801, -1437.5009939265533, -427.84379562766964, -715.4767168917524, -501.093727184558, -440.25492049489105, -520.3359876737145, -68.1654650172821, -59.224914583409095, -561.2771739052725, -971.6615771429634, -782.7624087884319, -644.9681527167259, -1021.1251468743433, -712.3255169736858, -526.2594921038401, -1403.378364600876, -463.74893519211787, -501.9184181979753, -552.8586585047912, -375.7824232803507, -1134.295644228824, -585.520920096829, -331.9432596500592, -422.625193153649, -665.2991705086957, -525.6020213137432, -652.3331358188796, -749.1858141246289, -308.0961556389035, -1047.2282657377937, -1035.436243320837, -764.7412402560284, -1058.2848973404234, -1390.2595733891637, -1393.214547718279, -1002.9574709707113, -1002.0222187144253, -629.4359290890465, -423.4582458778091, -1038.295496722545, -68.6998122364134, -609.038662094299, -732.4684103626709, -701.8812154942567, -483.4265974387686, -1150.309426225551, -1379.6832848818103, -446.65322172357907, -922.8646021428791, -1193.828958031291, -697.0158067039707, -1528.8481789276034, -1279.497290666643, -672.8925500006018, -1054.7194963550678, -573.4124947414485, -609.5922539448637, -802.1717962323135, -1126.9831976718583, -436.31751386086034, -653.1477045238232, -521.9550208507627, -1199.8056690249732, -1416.5626772748492, -41.56680101180433, -493.3719367456703, -514.4178573021853, -1283.841462180958, -57.90134901337839, -66.84621671512, -496.8093970663961, -1114.3145892452314, -1077.5186027437564, -489.1528880433534, -1468.833637397489, -628.2365105123464, -1133.3283934965473, -78.1574036632485, -125.71051027768667, -936.6141673019392, -593.0821960785828, -1087.731538615427, -736.1215306099349]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5533005804875619, "mean_inference_ms": 1.6735958038076222, "mean_action_processing_ms": 0.2769470804385265, "mean_env_wait_ms": 3.504608771539105, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012402772903442383, "StateBufferConnector_ms": 0.007955789566040039, "ViewRequirementAgentConnector_ms": 0.194594144821167}, "num_episodes": 30, "episode_return_max": -41.56680101180433, "episode_return_min": -1528.8481789276034, "episode_return_mean": -717.977337679981, "episodes_this_iter": 30}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000, "num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 447.2617427489253, "num_env_steps_trained_throughput_per_sec": 447.2617427489253, "timesteps_total": 88000, "num_env_steps_sampled_lifetime": 88000, "num_agent_steps_sampled_lifetime": 88000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 88000, "timers": {"training_iteration_time_ms": 12507.385, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12507.307, "sample_time_ms": 1188.994, "learn_time_ms": 11252.579, "learn_throughput": 355.474, "synch_weights_time_ms": 64.87}, "counters": {"num_env_steps_sampled": 88000, "num_env_steps_trained": 88000, "num_agent_steps_sampled": 88000, "num_agent_steps_trained": 88000}, "done": false, "training_iteration": 22, "trial_id": "1a22e_00017", "date": "2024-08-04_07-06-44", "timestamp": 1722735404, "time_this_iter_s": 8.95694613456726, "time_total_s": 271.297803401947, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708e2830>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 271.297803401947, "iterations_since_restore": 22, "perf": {"cpu_util_percent": 21.738461538461536, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 28.928910648326077, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.296548509597779, "policy_loss": -0.009413771682981556, "vf_loss": 8.316761705776056, "vf_explained_var": 0.5436249336848656, "kl": 0.015446868841172573, "entropy": 1.7750517872472604, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 21600.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "env_runners": {"episode_reward_max": -41.56680101180433, "episode_reward_min": -1528.8481789276034, "episode_reward_mean": -791.0943567853573, "episode_len_mean": 141.45, "episode_media": {}, "episodes_timesteps_total": 14145, "policy_reward_min": {"policy_0": -1528.8481789276034}, "policy_reward_max": {"policy_0": -41.56680101180433}, "policy_reward_mean": {"policy_0": -791.0943567853573}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1021.1251468743433, -712.3255169736858, -526.2594921038401, -1403.378364600876, -463.74893519211787, -501.9184181979753, -552.8586585047912, -375.7824232803507, -1134.295644228824, -585.520920096829, -331.9432596500592, -422.625193153649, -665.2991705086957, -525.6020213137432, -652.3331358188796, -749.1858141246289, -308.0961556389035, -1047.2282657377937, -1035.436243320837, -764.7412402560284, -1058.2848973404234, -1390.2595733891637, -1393.214547718279, -1002.9574709707113, -1002.0222187144253, -629.4359290890465, -423.4582458778091, -1038.295496722545, -68.6998122364134, -609.038662094299, -732.4684103626709, -701.8812154942567, -483.4265974387686, -1150.309426225551, -1379.6832848818103, -446.65322172357907, -922.8646021428791, -1193.828958031291, -697.0158067039707, -1528.8481789276034, -1279.497290666643, -672.8925500006018, -1054.7194963550678, -573.4124947414485, -609.5922539448637, -802.1717962323135, -1126.9831976718583, -436.31751386086034, -653.1477045238232, -521.9550208507627, -1199.8056690249732, -1416.5626772748492, -41.56680101180433, -493.3719367456703, -514.4178573021853, -1283.841462180958, -57.90134901337839, -66.84621671512, -496.8093970663961, -1114.3145892452314, -1077.5186027437564, -489.1528880433534, -1468.833637397489, -628.2365105123464, -1133.3283934965473, -78.1574036632485, -125.71051027768667, -936.6141673019392, -593.0821960785828, -1087.731538615427, -736.1215306099349, -1440.912565981379, -1354.102972828129, -1304.5459267858905, -812.8471901673598, -1266.8087163870393, -677.4696144331128, -1349.0942937327004, -689.3432831038896, -436.4204916674558, -518.1431738521464, -729.9486454103318, -355.1928530241412, -740.6409985169786, -746.6911145729165, -1137.6958722194533, -1228.5668100464052, -505.07053451622403, -1295.5279574271406, -609.6206322065009, -678.8556302049334, -576.2426616787236, -676.8183935882336, -1154.3484883575597, -640.4987959643285, -1322.6229673586297, -713.881245389087, -726.0029276557641, -379.8846991682639, -638.6709934595317], "episode_lengths": [150, 150, 150, 150, 114, 150, 150, 150, 150, 132, 106, 150, 150, 150, 150, 150, 81, 150, 150, 133, 150, 150, 150, 150, 150, 150, 150, 150, 64, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 56, 66, 150, 150, 150, 150, 150, 150, 150, 41, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150], "policy_policy_0_reward": [-1021.1251468743433, -712.3255169736858, -526.2594921038401, -1403.378364600876, -463.74893519211787, -501.9184181979753, -552.8586585047912, -375.7824232803507, -1134.295644228824, -585.520920096829, -331.9432596500592, -422.625193153649, -665.2991705086957, -525.6020213137432, -652.3331358188796, -749.1858141246289, -308.0961556389035, -1047.2282657377937, -1035.436243320837, -764.7412402560284, -1058.2848973404234, -1390.2595733891637, -1393.214547718279, -1002.9574709707113, -1002.0222187144253, -629.4359290890465, -423.4582458778091, -1038.295496722545, -68.6998122364134, -609.038662094299, -732.4684103626709, -701.8812154942567, -483.4265974387686, -1150.309426225551, -1379.6832848818103, -446.65322172357907, -922.8646021428791, -1193.828958031291, -697.0158067039707, -1528.8481789276034, -1279.497290666643, -672.8925500006018, -1054.7194963550678, -573.4124947414485, -609.5922539448637, -802.1717962323135, -1126.9831976718583, -436.31751386086034, -653.1477045238232, -521.9550208507627, -1199.8056690249732, -1416.5626772748492, -41.56680101180433, -493.3719367456703, -514.4178573021853, -1283.841462180958, -57.90134901337839, -66.84621671512, -496.8093970663961, -1114.3145892452314, -1077.5186027437564, -489.1528880433534, -1468.833637397489, -628.2365105123464, -1133.3283934965473, -78.1574036632485, -125.71051027768667, -936.6141673019392, -593.0821960785828, -1087.731538615427, -736.1215306099349, -1440.912565981379, -1354.102972828129, -1304.5459267858905, -812.8471901673598, -1266.8087163870393, -677.4696144331128, -1349.0942937327004, -689.3432831038896, -436.4204916674558, -518.1431738521464, -729.9486454103318, -355.1928530241412, -740.6409985169786, -746.6911145729165, -1137.6958722194533, -1228.5668100464052, -505.07053451622403, -1295.5279574271406, -609.6206322065009, -678.8556302049334, -576.2426616787236, -676.8183935882336, -1154.3484883575597, -640.4987959643285, -1322.6229673586297, -713.881245389087, -726.0029276557641, -379.8846991682639, -638.6709934595317]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5532353078981799, "mean_inference_ms": 1.6720910979559023, "mean_action_processing_ms": 0.2769421490886315, "mean_env_wait_ms": 3.5054716632927376, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.0127105712890625, "StateBufferConnector_ms": 0.007978200912475586, "ViewRequirementAgentConnector_ms": 0.19472074508666992}, "num_episodes": 29, "episode_return_max": -41.56680101180433, "episode_return_min": -1528.8481789276034, "episode_return_mean": -791.0943567853573, "episodes_this_iter": 29}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000, "num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 315.98096522174865, "num_env_steps_trained_throughput_per_sec": 315.98096522174865, "timesteps_total": 92000, "num_env_steps_sampled_lifetime": 92000, "num_agent_steps_sampled_lifetime": 92000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 92000, "timers": {"training_iteration_time_ms": 12464.248, "restore_workers_time_ms": 0.031, "training_step_time_ms": 12464.17, "sample_time_ms": 1186.12, "learn_time_ms": 11213.002, "learn_throughput": 356.729, "synch_weights_time_ms": 64.193}, "counters": {"num_env_steps_sampled": 92000, "num_env_steps_trained": 92000, "num_agent_steps_sampled": 92000, "num_agent_steps_trained": 92000}, "done": false, "training_iteration": 23, "trial_id": "1a22e_00017", "date": "2024-08-04_07-06-57", "timestamp": 1722735417, "time_this_iter_s": 12.671624898910522, "time_total_s": 283.96942830085754, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792a1739f010>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 283.96942830085754, "iterations_since_restore": 23, "perf": {"cpu_util_percent": 18.48888888888889, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 36.97179451187451, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 8.299674671391646, "policy_loss": -0.016033552377484737, "vf_loss": 8.32716654886802, "vf_explained_var": 0.6769647909328341, "kl": 0.018382194109714572, "entropy": 1.9730272201200327, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 22560.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "env_runners": {"episode_reward_max": -41.56680101180433, "episode_reward_min": -1528.8481789276034, "episode_reward_mean": -817.876049661915, "episode_len_mean": 142.4, "episode_media": {}, "episodes_timesteps_total": 14240, "policy_reward_min": {"policy_0": -1528.8481789276034}, "policy_reward_max": {"policy_0": -41.56680101180433}, "policy_reward_mean": {"policy_0": -817.876049661915}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-68.6998122364134, -609.038662094299, -732.4684103626709, -701.8812154942567, -483.4265974387686, -1150.309426225551, -1379.6832848818103, -446.65322172357907, -922.8646021428791, -1193.828958031291, -697.0158067039707, -1528.8481789276034, -1279.497290666643, -672.8925500006018, -1054.7194963550678, -573.4124947414485, -609.5922539448637, -802.1717962323135, -1126.9831976718583, -436.31751386086034, -653.1477045238232, -521.9550208507627, -1199.8056690249732, -1416.5626772748492, -41.56680101180433, -493.3719367456703, -514.4178573021853, -1283.841462180958, -57.90134901337839, -66.84621671512, -496.8093970663961, -1114.3145892452314, -1077.5186027437564, -489.1528880433534, -1468.833637397489, -628.2365105123464, -1133.3283934965473, -78.1574036632485, -125.71051027768667, -936.6141673019392, -593.0821960785828, -1087.731538615427, -736.1215306099349, -1440.912565981379, -1354.102972828129, -1304.5459267858905, -812.8471901673598, -1266.8087163870393, -677.4696144331128, -1349.0942937327004, -689.3432831038896, -436.4204916674558, -518.1431738521464, -729.9486454103318, -355.1928530241412, -740.6409985169786, -746.6911145729165, -1137.6958722194533, -1228.5668100464052, -505.07053451622403, -1295.5279574271406, -609.6206322065009, -678.8556302049334, -576.2426616787236, -676.8183935882336, -1154.3484883575597, -640.4987959643285, -1322.6229673586297, -713.881245389087, -726.0029276557641, -379.8846991682639, -638.6709934595317, -1472.360093171123, -595.9403288738827, -1215.7806960883242, -469.8186594488808, -1365.849326996374, -615.5641048497424, -1080.358877757876, -1101.1206576726693, -563.748873996225, -1369.2573824592107, -364.84657250257527, -361.5073556749468, -513.7765939890973, -1308.3288764286174, -1014.0372044658005, -1352.512879485692, -578.6105855538327, -1119.471596760821, -871.578094568382, -823.3396200158188, -752.8116965311056, -961.9718025657314, -529.0058123309326, -197.06589506665443, -1142.7770244344358, -681.523285487253, -917.5376827474372, -1055.3001071315744], "episode_lengths": [64, 150, 129, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 47, 150, 150, 150, 56, 66, 150, 150, 150, 150, 150, 150, 150, 41, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150], "policy_policy_0_reward": [-68.6998122364134, -609.038662094299, -732.4684103626709, -701.8812154942567, -483.4265974387686, -1150.309426225551, -1379.6832848818103, -446.65322172357907, -922.8646021428791, -1193.828958031291, -697.0158067039707, -1528.8481789276034, -1279.497290666643, -672.8925500006018, -1054.7194963550678, -573.4124947414485, -609.5922539448637, -802.1717962323135, -1126.9831976718583, -436.31751386086034, -653.1477045238232, -521.9550208507627, -1199.8056690249732, -1416.5626772748492, -41.56680101180433, -493.3719367456703, -514.4178573021853, -1283.841462180958, -57.90134901337839, -66.84621671512, -496.8093970663961, -1114.3145892452314, -1077.5186027437564, -489.1528880433534, -1468.833637397489, -628.2365105123464, -1133.3283934965473, -78.1574036632485, -125.71051027768667, -936.6141673019392, -593.0821960785828, -1087.731538615427, -736.1215306099349, -1440.912565981379, -1354.102972828129, -1304.5459267858905, -812.8471901673598, -1266.8087163870393, -677.4696144331128, -1349.0942937327004, -689.3432831038896, -436.4204916674558, -518.1431738521464, -729.9486454103318, -355.1928530241412, -740.6409985169786, -746.6911145729165, -1137.6958722194533, -1228.5668100464052, -505.07053451622403, -1295.5279574271406, -609.6206322065009, -678.8556302049334, -576.2426616787236, -676.8183935882336, -1154.3484883575597, -640.4987959643285, -1322.6229673586297, -713.881245389087, -726.0029276557641, -379.8846991682639, -638.6709934595317, -1472.360093171123, -595.9403288738827, -1215.7806960883242, -469.8186594488808, -1365.849326996374, -615.5641048497424, -1080.358877757876, -1101.1206576726693, -563.748873996225, -1369.2573824592107, -364.84657250257527, -361.5073556749468, -513.7765939890973, -1308.3288764286174, -1014.0372044658005, -1352.512879485692, -578.6105855538327, -1119.471596760821, -871.578094568382, -823.3396200158188, -752.8116965311056, -961.9718025657314, -529.0058123309326, -197.06589506665443, -1142.7770244344358, -681.523285487253, -917.5376827474372, -1055.3001071315744]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5529554157796889, "mean_inference_ms": 1.6731164043888915, "mean_action_processing_ms": 0.2770012610016157, "mean_env_wait_ms": 3.5125520082400157, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012765645980834961, "StateBufferConnector_ms": 0.007946252822875977, "ViewRequirementAgentConnector_ms": 0.19536781311035156}, "num_episodes": 28, "episode_return_max": -41.56680101180433, "episode_return_min": -1528.8481789276034, "episode_return_mean": -817.876049661915, "episodes_this_iter": 28}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000, "num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 308.7611149671758, "num_env_steps_trained_throughput_per_sec": 308.7611149671758, "timesteps_total": 96000, "num_env_steps_sampled_lifetime": 96000, "num_agent_steps_sampled_lifetime": 96000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 96000, "timers": {"training_iteration_time_ms": 12461.914, "restore_workers_time_ms": 0.032, "training_step_time_ms": 12461.835, "sample_time_ms": 1190.311, "learn_time_ms": 11206.865, "learn_throughput": 356.924, "synch_weights_time_ms": 63.804}, "counters": {"num_env_steps_sampled": 96000, "num_env_steps_trained": 96000, "num_agent_steps_sampled": 96000, "num_agent_steps_trained": 96000}, "done": false, "training_iteration": 24, "trial_id": "1a22e_00017", "date": "2024-08-04_07-07-10", "timestamp": 1722735430, "time_this_iter_s": 12.967534065246582, "time_total_s": 296.9369623661041, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x7923708e37f0>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 296.9369623661041, "iterations_since_restore": 24, "perf": {"cpu_util_percent": 18.700000000000003, "ram_util_percent": 28.100000000000005}}
{"custom_metrics": {}, "episode_media": {}, "info": {"learner": {"policy_0": {"learner_stats": {"allreduce_latency": 0.0, "grad_gnorm": 37.53145086020231, "cur_kl_coeff": 0.4500000000000001, "cur_lr": 0.0010000000000000005, "total_loss": 7.877718334893386, "policy_loss": -0.011494602702441625, "vf_loss": 7.899686894317468, "vf_explained_var": 0.642942330489556, "kl": 0.016257087968188037, "entropy": 1.7789632003754376, "entropy_coeff": 0.01}, "model": {}, "custom_metrics": {}, "num_agent_steps_trained": 125.0, "num_grad_updates_lifetime": 23520.5, "diff_num_grad_updates_vs_sampler_policy": 479.5}}, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "env_runners": {"episode_reward_max": -51.68314283025419, "episode_reward_min": -1472.360093171123, "episode_reward_mean": -812.8516255347662, "episode_len_mean": 141.93, "episode_media": {}, "episodes_timesteps_total": 14193, "policy_reward_min": {"policy_0": -1472.360093171123}, "policy_reward_max": {"policy_0": -51.68314283025419}, "policy_reward_mean": {"policy_0": -812.8516255347662}, "custom_metrics": {}, "hist_stats": {"episode_reward": [-1283.841462180958, -57.90134901337839, -66.84621671512, -496.8093970663961, -1114.3145892452314, -1077.5186027437564, -489.1528880433534, -1468.833637397489, -628.2365105123464, -1133.3283934965473, -78.1574036632485, -125.71051027768667, -936.6141673019392, -593.0821960785828, -1087.731538615427, -736.1215306099349, -1440.912565981379, -1354.102972828129, -1304.5459267858905, -812.8471901673598, -1266.8087163870393, -677.4696144331128, -1349.0942937327004, -689.3432831038896, -436.4204916674558, -518.1431738521464, -729.9486454103318, -355.1928530241412, -740.6409985169786, -746.6911145729165, -1137.6958722194533, -1228.5668100464052, -505.07053451622403, -1295.5279574271406, -609.6206322065009, -678.8556302049334, -576.2426616787236, -676.8183935882336, -1154.3484883575597, -640.4987959643285, -1322.6229673586297, -713.881245389087, -726.0029276557641, -379.8846991682639, -638.6709934595317, -1472.360093171123, -595.9403288738827, -1215.7806960883242, -469.8186594488808, -1365.849326996374, -615.5641048497424, -1080.358877757876, -1101.1206576726693, -563.748873996225, -1369.2573824592107, -364.84657250257527, -361.5073556749468, -513.7765939890973, -1308.3288764286174, -1014.0372044658005, -1352.512879485692, -578.6105855538327, -1119.471596760821, -871.578094568382, -823.3396200158188, -752.8116965311056, -961.9718025657314, -529.0058123309326, -197.06589506665443, -1142.7770244344358, -681.523285487253, -917.5376827474372, -1055.3001071315744, -364.7826767895399, -550.1528278168544, -935.1790110163959, -696.029266406632, -1242.340216306924, -308.60724621359816, -605.6602108792176, -1284.7021752648316, -1322.1520003548103, -928.6793998435528, -557.3492715439222, -521.1435450144152, -1103.4253107768282, -506.0433206516339, -1291.7544891360933, -1224.3491112193285, -991.7549059378147, -402.1636420407278, -675.4746519825336, -457.4733204033147, -1073.0086984867928, -428.8889472662491, -1323.754823363398, -196.74159467072744, -1299.3568667937118, -51.68314283025419, -466.03935074585854], "episode_lengths": [150, 56, 66, 150, 150, 150, 150, 150, 150, 150, 41, 63, 150, 150, 150, 150, 150, 150, 150, 150, 150, 128, 150, 150, 150, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 95, 150, 150, 150, 150, 140, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 71, 150, 150, 150, 150, 150, 150, 150, 124, 150, 106, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 150, 147, 150, 150, 150, 150, 75, 150, 41, 150], "policy_policy_0_reward": [-1283.841462180958, -57.90134901337839, -66.84621671512, -496.8093970663961, -1114.3145892452314, -1077.5186027437564, -489.1528880433534, -1468.833637397489, -628.2365105123464, -1133.3283934965473, -78.1574036632485, -125.71051027768667, -936.6141673019392, -593.0821960785828, -1087.731538615427, -736.1215306099349, -1440.912565981379, -1354.102972828129, -1304.5459267858905, -812.8471901673598, -1266.8087163870393, -677.4696144331128, -1349.0942937327004, -689.3432831038896, -436.4204916674558, -518.1431738521464, -729.9486454103318, -355.1928530241412, -740.6409985169786, -746.6911145729165, -1137.6958722194533, -1228.5668100464052, -505.07053451622403, -1295.5279574271406, -609.6206322065009, -678.8556302049334, -576.2426616787236, -676.8183935882336, -1154.3484883575597, -640.4987959643285, -1322.6229673586297, -713.881245389087, -726.0029276557641, -379.8846991682639, -638.6709934595317, -1472.360093171123, -595.9403288738827, -1215.7806960883242, -469.8186594488808, -1365.849326996374, -615.5641048497424, -1080.358877757876, -1101.1206576726693, -563.748873996225, -1369.2573824592107, -364.84657250257527, -361.5073556749468, -513.7765939890973, -1308.3288764286174, -1014.0372044658005, -1352.512879485692, -578.6105855538327, -1119.471596760821, -871.578094568382, -823.3396200158188, -752.8116965311056, -961.9718025657314, -529.0058123309326, -197.06589506665443, -1142.7770244344358, -681.523285487253, -917.5376827474372, -1055.3001071315744, -364.7826767895399, -550.1528278168544, -935.1790110163959, -696.029266406632, -1242.340216306924, -308.60724621359816, -605.6602108792176, -1284.7021752648316, -1322.1520003548103, -928.6793998435528, -557.3492715439222, -521.1435450144152, -1103.4253107768282, -506.0433206516339, -1291.7544891360933, -1224.3491112193285, -991.7549059378147, -402.1636420407278, -675.4746519825336, -457.4733204033147, -1073.0086984867928, -428.8889472662491, -1323.754823363398, -196.74159467072744, -1299.3568667937118, -51.68314283025419, -466.03935074585854]}, "sampler_perf": {"mean_raw_obs_processing_ms": 0.5526105275819865, "mean_inference_ms": 1.6730813111259732, "mean_action_processing_ms": 0.27679881526703815, "mean_env_wait_ms": 3.514744664018346, "mean_env_render_ms": 0.0}, "num_faulty_episodes": 0, "connector_metrics": {"ObsPreprocessorConnector_ms": 0.012502908706665039, "StateBufferConnector_ms": 0.007808685302734375, "ViewRequirementAgentConnector_ms": 0.18991732597351074}, "num_episodes": 27, "episode_return_max": -51.68314283025419, "episode_return_min": -1472.360093171123, "episode_return_mean": -812.8516255347662, "episodes_this_iter": 27}, "num_healthy_workers": 23, "num_in_flight_async_sample_reqs": 0, "num_remote_worker_restarts": 0, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000, "num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_env_steps_sampled_this_iter": 4000, "num_env_steps_trained_this_iter": 4000, "num_env_steps_sampled_throughput_per_sec": 314.1273203406589, "num_env_steps_trained_throughput_per_sec": 314.1273203406589, "timesteps_total": 100000, "num_env_steps_sampled_lifetime": 100000, "num_agent_steps_sampled_lifetime": 100000, "num_steps_trained_this_iter": 4000, "agent_timesteps_total": 100000, "timers": {"training_iteration_time_ms": 12463.817, "restore_workers_time_ms": 0.03, "training_step_time_ms": 12463.742, "sample_time_ms": 1190.91, "learn_time_ms": 11206.771, "learn_throughput": 356.927, "synch_weights_time_ms": 65.213}, "counters": {"num_env_steps_sampled": 100000, "num_env_steps_trained": 100000, "num_agent_steps_sampled": 100000, "num_agent_steps_trained": 100000}, "done": true, "training_iteration": 25, "trial_id": "1a22e_00017", "date": "2024-08-04_07-07-23", "timestamp": 1722735443, "time_this_iter_s": 12.745749950408936, "time_total_s": 309.68271231651306, "pid": 595431, "hostname": "mav-lab-invento", "node_ip": "10.42.131.54", "config": {"extra_python_environs_for_driver": {}, "extra_python_environs_for_worker": {}, "placement_strategy": "PACK", "num_gpus": 1, "_fake_gpus": false, "eager_tracing": true, "eager_max_retraces": 20, "tf_session_args": {"intra_op_parallelism_threads": 2, "inter_op_parallelism_threads": 2, "gpu_options": {"allow_growth": true}, "log_device_placement": false, "device_count": {"CPU": 1}, "allow_soft_placement": true}, "local_tf_session_args": {"intra_op_parallelism_threads": 8, "inter_op_parallelism_threads": 8}, "torch_compile_learner": false, "torch_compile_learner_what_to_compile": "forward_train", "torch_compile_learner_dynamo_backend": "inductor", "torch_compile_learner_dynamo_mode": null, "torch_compile_worker": false, "torch_compile_worker_dynamo_backend": "onnxrt", "torch_compile_worker_dynamo_mode": null, "enable_rl_module_and_learner": false, "enable_env_runner_and_connector_v2": false, "env": "<class 'multi_agent_env.MultiAgentShipEnvironment'>", "env_config": {"num_agents": 1, "wind_flag": 0, "wind_speed": 0, "wind_dir": 0, "wave_flag": 0, "wave_height": 0, "wave_period": 0, "wave_dir": 0, "max_steps": 150, "render_mode": null}, "observation_space": null, "action_space": null, "clip_rewards": null, "normalize_actions": true, "clip_actions": false, "_is_atari": null, "env_task_fn": null, "render_env": false, "action_mask_key": "action_mask", "env_runner_cls": null, "num_envs_per_env_runner": 1, "custom_resources_per_env_runner": {}, "validate_env_runners_after_construction": true, "sample_timeout_s": 60.0, "_env_to_module_connector": null, "add_default_connectors_to_env_to_module_pipeline": true, "_module_to_env_connector": null, "add_default_connectors_to_module_to_env_pipeline": true, "episode_lookback_horizon": 1, "rollout_fragment_length": "auto", "batch_mode": "truncate_episodes", "compress_observations": false, "remote_worker_envs": false, "remote_env_batch_wait_ms": 0, "enable_tf1_exec_eagerly": false, "sample_collector": "<class 'ray.rllib.evaluation.collectors.simple_list_collector.SimpleListCollector'>", "preprocessor_pref": "deepmind", "observation_filter": "NoFilter", "update_worker_filter_stats": true, "use_worker_filter_stats": true, "enable_connectors": true, "sampler_perf_stats_ema_coef": null, "local_gpu_idx": 0, "gamma": 0.97, "lr": 0.001, "grad_clip": null, "grad_clip_by": "global_norm", "train_batch_size": 4000, "train_batch_size_per_learner": null, "model": {"_disable_preprocessor_api": false, "_disable_action_flattening": false, "fcnet_hiddens": [128, 128], "fcnet_activation": "tanh", "fcnet_weights_initializer": null, "fcnet_weights_initializer_config": null, "fcnet_bias_initializer": null, "fcnet_bias_initializer_config": null, "conv_filters": null, "conv_activation": "relu", "conv_kernel_initializer": null, "conv_kernel_initializer_config": null, "conv_bias_initializer": null, "conv_bias_initializer_config": null, "conv_transpose_kernel_initializer": null, "conv_transpose_kernel_initializer_config": null, "conv_transpose_bias_initializer": null, "conv_transpose_bias_initializer_config": null, "post_fcnet_hiddens": [], "post_fcnet_activation": "relu", "post_fcnet_weights_initializer": null, "post_fcnet_weights_initializer_config": null, "post_fcnet_bias_initializer": null, "post_fcnet_bias_initializer_config": null, "free_log_std": false, "no_final_linear": false, "vf_share_layers": false, "use_lstm": false, "max_seq_len": 20, "lstm_cell_size": 256, "lstm_use_prev_action": false, "lstm_use_prev_reward": false, "lstm_weights_initializer": null, "lstm_weights_initializer_config": null, "lstm_bias_initializer": null, "lstm_bias_initializer_config": null, "_time_major": false, "use_attention": false, "attention_num_transformer_units": 1, "attention_dim": 64, "attention_num_heads": 1, "attention_head_dim": 32, "attention_memory_inference": 50, "attention_memory_training": 50, "attention_position_wise_mlp_dim": 32, "attention_init_gru_gate_bias": 2.0, "attention_use_n_prev_actions": 0, "attention_use_n_prev_rewards": 0, "framestack": true, "dim": 84, "grayscale": false, "zero_mean": true, "custom_model": null, "custom_model_config": {}, "custom_action_dist": null, "custom_preprocessor": null, "encoder_latent_dim": null, "always_check_shapes": false, "lstm_use_prev_action_reward": -1, "_use_default_native_models": -1}, "_learner_connector": null, "add_default_connectors_to_learner_pipeline": true, "optimizer": {}, "max_requests_in_flight_per_sampler_worker": 2, "_learner_class": null, "explore": true, "exploration_config": {"type": "StochasticSampling"}, "algorithm_config_overrides_per_module": {}, "_per_module_overrides": {}, "count_steps_by": "env_steps", "policy_map_capacity": 100, "policy_mapping_fn": "<function policy_mapping_fn at 0x792370726710>", "policies_to_train": ["policy_0"], "policy_states_are_swappable": false, "observation_fn": null, "input_config": {}, "actions_in_input_normalized": false, "postprocess_inputs": false, "shuffle_buffer_size": 0, "output": null, "output_config": {}, "output_compress_columns": ["obs", "new_obs"], "output_max_file_size": 67108864, "offline_sampling": false, "evaluation_interval": null, "evaluation_duration": 10, "evaluation_duration_unit": "episodes", "evaluation_sample_timeout_s": 120.0, "evaluation_parallel_to_training": false, "evaluation_force_reset_envs_before_iteration": true, "evaluation_config": null, "off_policy_estimation_methods": {}, "ope_split_batch_by_episode": true, "evaluation_num_env_runners": 0, "always_attach_evaluation_results": true, "in_evaluation": false, "sync_filters_on_rollout_workers_timeout_s": 10.0, "keep_per_episode_custom_metrics": false, "metrics_episode_collection_timeout_s": 60.0, "metrics_num_episodes_for_smoothing": 100, "min_time_s_per_iteration": null, "min_train_timesteps_per_iteration": 0, "min_sample_timesteps_per_iteration": 0, "export_native_model_files": false, "checkpoint_trainable_policies_only": false, "logger_creator": null, "logger_config": null, "log_level": "WARN", "log_sys_usage": true, "fake_sampler": false, "seed": null, "_run_training_always_in_thread": false, "_evaluation_parallel_to_training_wo_thread": false, "ignore_env_runner_failures": false, "recreate_failed_env_runners": false, "max_num_env_runner_restarts": 1000, "delay_between_env_runner_restarts_s": 60.0, "restart_failed_sub_environments": false, "num_consecutive_env_runner_failures_tolerance": 100, "env_runner_health_probe_timeout_s": 30, "env_runner_restore_timeout_s": 1800, "_model_config_dict": {}, "_rl_module_spec": null, "_AlgorithmConfig__prior_exploration_config": null, "_tf_policy_handles_more_than_one_loss": false, "_disable_preprocessor_api": false, "_disable_action_flattening": false, "_disable_initialize_loss_from_dummy_batch": false, "_dont_auto_sync_env_runner_states": false, "simple_optimizer": true, "timesteps_per_iteration": 7500, "policy_map_cache": -1, "worker_cls": -1, "synchronize_filters": -1, "enable_async_evaluation": -1, "custom_async_evaluation_function": -1, "_enable_rl_module_api": -1, "auto_wrap_old_gym_envs": -1, "disable_env_checking": -1, "replay_sequence_length": null, "_disable_execution_plan_api": -1, "lr_schedule": null, "use_critic": true, "use_gae": true, "use_kl_loss": true, "kl_coeff": 0.2, "kl_target": 0.01, "sgd_minibatch_size": 128, "mini_batch_size_per_learner": null, "num_sgd_iter": 30, "shuffle_sequences": true, "vf_loss_coeff": 1.0, "entropy_coeff": 0.01, "entropy_coeff_schedule": null, "clip_param": 0.2, "vf_clip_param": 10.0, "vf_share_layers": -1, "__stdout_file__": null, "__stderr_file__": null, "lambda": 0.97, "input": "sampler", "policies": {"policy_0": [null, "Box([-100.          -3.1415927 -100.          -1.       ], [100.          3.1415927 100.          1.       ], (4,), float32)", "Box(-3.141592653589793, 3.141592653589793, (1,), float64)", {}]}, "callbacks": "<class 'ray.rllib.algorithms.callbacks.DefaultCallbacks'>", "create_env_on_driver": false, "custom_eval_function": null, "framework": "torch", "num_cpus_for_driver": 1, "num_workers": 23, "num_cpus_per_worker": 1, "num_gpus_per_worker": 0, "num_learner_workers": 0, "num_cpus_per_learner_worker": 1, "num_gpus_per_learner_worker": 0}, "time_since_restore": 309.68271231651306, "iterations_since_restore": 25, "perf": {"cpu_util_percent": 18.305263157894736, "ram_util_percent": 28.100000000000005}}
